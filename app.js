/*! For license information please see main.18422c80.js.LICENSE.txt */
!function(){var e={123:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var a=typeof n;if("string"===a||"number"===a)e.push(n);else if(Array.isArray(n)){if(n.length){var o=i.apply(null,n);o&&e.push(o)}}else if("object"===a){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)r.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},463:function(e){e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var r=n(1),i=function(){function e(e,t,n){void 0===e&&(e=NaN),void 0===t&&(t=NaN),void 0===n&&(n=!1),this._minFPS=t,this._maxFPS=e,this._timeScale=1,this._currentTick=0,this._currentTime=0,this._tickDeltaTime=0,this._isRunning=!1,this._maxInterval=isNaN(this._minFPS)?NaN:1e3/this._minFPS,this._minInterval=isNaN(this._maxFPS)?NaN:1e3/this._maxFPS,this._onResume=new r.default,this._onPause=new r.default,this._onTick=new r.default,this._onTickOncePerFrame=new r.default,n||this.resume()}return e.prototype.updateOnce=function(e){e(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},e.prototype.resume=function(){this._isRunning||(this._isRunning=!0,this._lastTimeUpdated=this.getTimer(),this._onResume.dispatch(),this.animateOnce())},e.prototype.pause=function(){this._isRunning&&(this._isRunning=!1,this._onPause.dispatch(),window.cancelAnimationFrame(this._animationFrameHandle))},e.prototype.dispose=function(){this.pause(),this._onResume.removeAll(),this._onPause.removeAll(),this._onTick.removeAll()},Object.defineProperty(e.prototype,"currentTick",{get:function(){return this._currentTick},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTimeSeconds",{get:function(){return this._currentTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tickDeltaTimeSeconds",{get:function(){return this._tickDeltaTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeScale",{get:function(){return this._timeScale},set:function(e){this._timeScale!==e&&(this._timeScale=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onResume",{get:function(){return this._onResume},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onPause",{get:function(){return this._onPause},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onTick",{get:function(){return this._onTick},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onTickOncePerFrame",{get:function(){return this._onTickOncePerFrame},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRunning",{get:function(){return this._isRunning},enumerable:!0,configurable:!0}),e.prototype.animateOnce=function(){var e=this;this._animationFrameHandle=window.requestAnimationFrame((function(){return e.onFrame()}))},e.prototype.onFrame=function(){if(this._now=this.getTimer(),this._frameDeltaTime=this._now-this._lastTimeUpdated,isNaN(this._minInterval)||this._frameDeltaTime>=this._minInterval)if(isNaN(this._maxInterval))this.update(this._frameDeltaTime*this._timeScale,!0),this._lastTimeUpdated=this._now;else for(this._interval=Math.min(this._frameDeltaTime,this._maxInterval);this._now>=this._lastTimeUpdated+this._interval;)this.update(this._interval*this._timeScale,this._now<=this._lastTimeUpdated+2*this._maxInterval),this._lastTimeUpdated+=this._interval;this._isRunning&&this.animateOnce()},e.prototype.update=function(e,t){void 0===t&&(t=!0),this._currentTick++,this._currentTime+=e,this._tickDeltaTime=e,this._onTick.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick),t&&this._onTickOncePerFrame.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},e.prototype.getTimer=function(){return Date.now()},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},function(e,t,n){!function(t,n){e.exports=n()}(0,(function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t){"use strict";var n=function(){function e(){this.functions=[]}return e.prototype.add=function(e){return-1===this.functions.indexOf(e)&&(this.functions.push(e),!0)},e.prototype.remove=function(e){var t=this.functions.indexOf(e);return t>-1&&(this.functions.splice(t,1),!0)},e.prototype.removeAll=function(){return this.functions.length>0&&(this.functions.length=0,!0)},e.prototype.dispatch=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.functions.concat().forEach((function(t){t.apply(void 0,e)}))},Object.defineProperty(e.prototype,"numItems",{get:function(){return this.functions.length},enumerable:!0,configurable:!0}),e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=n}])}))}])},993:function(e){"use strict";e.exports=function(e,t,n,r,i,a,o,s){if(!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,r,i,a,o,s],c=0;(u=new Error(t.replace(/%s/g,(function(){return l[c++]})))).name="Invariant Violation"}throw u.framesToPop=1,u}}},729:function(e,t,n){"use strict";var r=n(165);function i(){}function a(){}a.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,a,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:i};return n.PropTypes=n,n}},192:function(e,t,n){e.exports=n(729)()},165:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},534:function(e,t,n){"use strict";var r=n(313),i=n(224);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function u(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},p={};function A(e,t,n,r,i,a,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){v[e]=new A(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];v[t]=new A(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){v[e]=new A(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){v[e]=new A(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){v[e]=new A(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){v[e]=new A(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){v[e]=new A(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){v[e]=new A(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){v[e]=new A(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function g(e){return e[1].toUpperCase()}function y(e,t,n,r){var i=v.hasOwnProperty(t)?v[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(p,e)||!h.call(d,e)&&(f.test(e)?p[e]=!0:(d[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,g);v[t]=new A(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,g);v[t]=new A(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,g);v[t]=new A(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){v[e]=new A(e,1,!1,e.toLowerCase(),null,!1,!1)})),v.xlinkHref=new A("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){v[e]=new A(e,1,!1,e.toLowerCase(),null,!0,!0)}));var _=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),x=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),k=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),N=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var I=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=L&&e[L]||e["@@iterator"])?e:null}var O,U=Object.assign;function B(e){if(void 0===O)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);O=t&&t[1]||""}return"\n"+O+e}var F=!1;function z(e,t){if(!e||F)return"";F=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var i=l.stack.split("\n"),a=r.stack.split("\n"),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||i[o]!==a[s]){var u="\n"+i[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=o&&0<=s);break}}}finally{F=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?B(e):""}function V(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function q(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case w:return"Fragment";case x:return"Portal";case S:return"Profiler";case T:return"StrictMode";case C:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case M:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:q(e.type)||"Memo";case N:t=e._payload,e=e._init;try{return q(e(t))}catch(n){}}return null}function j(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q(t);case 8:return t===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function G(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return U({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function K(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=G(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Z(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function J(e,t){Z(e,t);var n=G(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,G(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+G(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return U({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:G(n)}}function ae(e,t){var n=G(t.value),r=G(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ce,he=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ce(e,t)}))}:ce);function fe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function Ae(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||de.hasOwnProperty(e)&&de[e]?(""+t).trim():t+"px"}function ve(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=Ae(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(de).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),de[t]=de[e]}))}));var me=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ge(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _e=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var xe=null,we=null,Te=null;function Se(e){if(e=yi(e)){if("function"!==typeof xe)throw Error(a(280));var t=e.stateNode;t&&(t=bi(t),xe(e.stateNode,e.type,t))}}function Ee(e){we?Te?Te.push(e):Te=[e]:we=e}function ke(){if(we){var e=we,t=Te;if(Te=we=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Me(e,t){return e(t)}function Ce(){}var Re=!1;function Pe(e,t,n){if(Re)return e(t,n);Re=!0;try{return Me(e,t,n)}finally{Re=!1,(null!==we||null!==Te)&&(Ce(),ke())}}function Ne(e,t){var n=e.stateNode;if(null===n)return null;var r=bi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Ie=!1;if(c)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Ie=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(ce){Ie=!1}function De(e,t,n,r,i,a,o,s,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var Oe=!1,Ue=null,Be=!1,Fe=null,ze={onError:function(e){Oe=!0,Ue=e}};function Ve(e,t,n,r,i,a,o,s,u){Oe=!1,Ue=null,De.apply(ze,arguments)}function qe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function je(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ge(e){if(qe(e)!==e)throw Error(a(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=qe(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return Ge(i),e;if(o===r)return Ge(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,u=i.child;u;){if(u===n){s=!0,n=i,r=o;break}if(u===r){s=!0,r=i,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=i;break}if(u===r){s=!0,r=o,n=i;break}u=u.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var Xe=i.unstable_scheduleCallback,Qe=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Ke=i.unstable_requestPaint,Ze=i.unstable_now,Je=i.unstable_getCurrentPriorityLevel,$e=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,at=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ut|0)|0},st=Math.log,ut=Math.LN2;var lt=64,ct=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ft(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~i;0!==s?r=ht(s):0!==(a&=o)&&(r=ht(a))}else 0!==(o=n&~i)?r=ht(o):0!==a&&(r=ht(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(a=t&-t)||16===i&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function dt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function At(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function vt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function gt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var yt=0;function _t(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,xt,wt,Tt,St,Et=!1,kt=[],Mt=null,Ct=null,Rt=null,Pt=new Map,Nt=new Map,It=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":Mt=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nt.delete(t.pointerId)}}function Ot(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=yi(t))&&xt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ut(e){var t=gi(e.target);if(null!==t){var n=qe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=je(n)))return e.blockedOn=t,void St(e.priority,(function(){wt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=yi(n))&&xt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);_e=r,n.target.dispatchEvent(r),_e=null,t.shift()}return!0}function Ft(e,t,n){Bt(e)&&n.delete(t)}function zt(){Et=!1,null!==Mt&&Bt(Mt)&&(Mt=null),null!==Ct&&Bt(Ct)&&(Ct=null),null!==Rt&&Bt(Rt)&&(Rt=null),Pt.forEach(Ft),Nt.forEach(Ft)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,zt)))}function qt(e){function t(t){return Vt(t,e)}if(0<kt.length){Vt(kt[0],e);for(var n=1;n<kt.length;n++){var r=kt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Mt&&Vt(Mt,e),null!==Ct&&Vt(Ct,e),null!==Rt&&Vt(Rt,e),Pt.forEach(t),Nt.forEach(t),n=0;n<It.length;n++)(r=It[n]).blockedOn===e&&(r.blockedOn=null);for(;0<It.length&&null===(n=It[0]).blockedOn;)Ut(n),null===n.blockedOn&&It.shift()}var jt=_.ReactCurrentBatchConfig,Gt=!0;function Ht(e,t,n,r){var i=yt,a=jt.transition;jt.transition=null;try{yt=1,Xt(e,t,n,r)}finally{yt=i,jt.transition=a}}function Wt(e,t,n,r){var i=yt,a=jt.transition;jt.transition=null;try{yt=4,Xt(e,t,n,r)}finally{yt=i,jt.transition=a}}function Xt(e,t,n,r){if(Gt){var i=Yt(e,t,n,r);if(null===i)Gr(e,t,r,Qt,n),Dt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Mt=Ot(Mt,e,t,n,r,i),!0;case"dragenter":return Ct=Ot(Ct,e,t,n,r,i),!0;case"mouseover":return Rt=Ot(Rt,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Pt.set(a,Ot(Pt.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Nt.set(a,Ot(Nt.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Dt(e,r),4&t&&-1<Lt.indexOf(e)){for(;null!==i;){var a=yi(i);if(null!==a&&bt(a),null===(a=Yt(e,t,n,r))&&Gr(e,t,r,Qt,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else Gr(e,t,r,null,n)}}var Qt=null;function Yt(e,t,n,r){if(Qt=null,null!==(e=gi(e=be(r))))if(null===(t=qe(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=je(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Zt=null,Jt=null,$t=null;function en(){if($t)return $t;var e,t,n=Jt,r=n.length,i="value"in Zt?Zt.value:Zt.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[a-t];t++);return $t=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,i,a){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return U(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,un,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=an(ln),hn=U({},ln,{view:0,detail:0}),fn=an(hn),dn=U({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(on=e.screenX-un.screenX,sn=e.screenY-un.screenY):sn=on=0,un=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),pn=an(dn),An=an(U({},dn,{dataTransfer:0})),vn=an(U({},hn,{relatedTarget:0})),mn=an(U({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),gn=U({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yn=an(gn),_n=an(U({},ln,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wn[e])&&!!t[e]}function Sn(){return Tn}var En=U({},hn,{key:function(e){if(e.key){var t=bn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?xn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),kn=an(En),Mn=an(U({},dn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Cn=an(U({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),Rn=an(U({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=U({},dn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Nn=an(Pn),In=[9,13,27,32],Ln=c&&"CompositionEvent"in window,Dn=null;c&&"documentMode"in document&&(Dn=document.documentMode);var On=c&&"TextEvent"in window&&!Dn,Un=c&&(!Ln||Dn&&8<Dn&&11>=Dn),Bn=String.fromCharCode(32),Fn=!1;function zn(e,t){switch(e){case"keyup":return-1!==In.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var qn=!1;var jn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!jn[e.type]:"textarea"===t}function Hn(e,t,n,r){Ee(r),0<(t=Wr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Wn=null,Xn=null;function Qn(e){Br(e,0)}function Yn(e){if(X(_i(e)))return e}function Kn(e,t){if("change"===e)return t}var Zn=!1;if(c){var Jn;if(c){var $n="oninput"in document;if(!$n){var er=document.createElement("div");er.setAttribute("oninput","return;"),$n="function"===typeof er.oninput}Jn=$n}else Jn=!1;Zn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Wn&&(Wn.detachEvent("onpropertychange",nr),Xn=Wn=null)}function nr(e){if("value"===e.propertyName&&Yn(Xn)){var t=[];Hn(t,Xn,e,be(e)),Pe(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Xn=n,(Wn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Xn)}function ar(e,t){if("click"===e)return Yn(t)}function or(e,t){if("input"===e||"change"===e)return Yn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ur(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!sr(e[i],t[i]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function dr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=fr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&dr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=void 0===r.end?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=cr(n,a);var o=cr(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Ar=c&&"documentMode"in document&&11>=document.documentMode,vr=null,mr=null,gr=null,yr=!1;function _r(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;yr||null==vr||vr!==Q(r)||("selectionStart"in(r=vr)&&dr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},gr&&ur(gr,r)||(gr=r,0<(r=Wr(mr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=vr)))}function br(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var xr={animationend:br("Animation","AnimationEnd"),animationiteration:br("Animation","AnimationIteration"),animationstart:br("Animation","AnimationStart"),transitionend:br("Transition","TransitionEnd")},wr={},Tr={};function Sr(e){if(wr[e])return wr[e];if(!xr[e])return e;var t,n=xr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Tr)return wr[e]=n[t];return e}c&&(Tr=document.createElement("div").style,"AnimationEvent"in window||(delete xr.animationend.animation,delete xr.animationiteration.animation,delete xr.animationstart.animation),"TransitionEvent"in window||delete xr.transitionend.transition);var Er=Sr("animationend"),kr=Sr("animationiteration"),Mr=Sr("animationstart"),Cr=Sr("transitionend"),Rr=new Map,Pr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nr(e,t){Rr.set(e,t),u(t,[e])}for(var Ir=0;Ir<Pr.length;Ir++){var Lr=Pr[Ir];Nr(Lr.toLowerCase(),"on"+(Lr[0].toUpperCase()+Lr.slice(1)))}Nr(Er,"onAnimationEnd"),Nr(kr,"onAnimationIteration"),Nr(Mr,"onAnimationStart"),Nr("dblclick","onDoubleClick"),Nr("focusin","onFocus"),Nr("focusout","onBlur"),Nr(Cr,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Or=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dr));function Ur(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,s,u,l){if(Ve.apply(this,arguments),Oe){if(!Oe)throw Error(a(198));var c=Ue;Oe=!1,Ue=null,Be||(Be=!0,Fe=c)}}(r,t,void 0,e),e.currentTarget=null}function Br(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==a&&i.isPropagationStopped())break e;Ur(i,s,l),a=u}else for(o=0;o<r.length;o++){if(u=(s=r[o]).instance,l=s.currentTarget,s=s.listener,u!==a&&i.isPropagationStopped())break e;Ur(i,s,l),a=u}}}if(Be)throw e=Fe,Be=!1,Fe=null,e}function Fr(e,t){var n=t[Ai];void 0===n&&(n=t[Ai]=new Set);var r=e+"__bubble";n.has(r)||(jr(t,e,2,!1),n.add(r))}function zr(e,t,n){var r=0;t&&(r|=4),jr(n,e,r,t)}var Vr="_reactListening"+Math.random().toString(36).slice(2);function qr(e){if(!e[Vr]){e[Vr]=!0,o.forEach((function(t){"selectionchange"!==t&&(Or.has(t)||zr(t,!1,e),zr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vr]||(t[Vr]=!0,zr("selectionchange",!1,t))}}function jr(e,t,n,r){switch(Kt(t)){case 1:var i=Ht;break;case 4:i=Wt;break;default:i=Xt}n=i.bind(null,t,n,e),i=void 0,!Ie||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Gr(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var u=o.tag;if((3===u||4===u)&&((u=o.stateNode.containerInfo)===i||8===u.nodeType&&u.parentNode===i))return;o=o.return}for(;null!==s;){if(null===(o=gi(s)))return;if(5===(u=o.tag)||6===u){r=a=o;continue e}s=s.parentNode}}r=r.return}Pe((function(){var r=a,i=be(n),o=[];e:{var s=Rr.get(e);if(void 0!==s){var u=cn,l=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":u=kn;break;case"focusin":l="focus",u=vn;break;case"focusout":l="blur",u=vn;break;case"beforeblur":case"afterblur":u=vn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=An;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Cn;break;case Er:case kr:case Mr:u=mn;break;case Cr:u=Rn;break;case"scroll":u=fn;break;case"wheel":u=Nn;break;case"copy":case"cut":case"paste":u=yn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=Mn}var c=0!==(4&t),h=!c&&"scroll"===e,f=c?null!==s?s+"Capture":null:s;c=[];for(var d,p=r;null!==p;){var A=(d=p).stateNode;if(5===d.tag&&null!==A&&(d=A,null!==f&&(null!=(A=Ne(p,f))&&c.push(Hr(p,A,d)))),h)break;p=p.return}0<c.length&&(s=new u(s,l,null,n,i),o.push({event:s,listeners:c}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===_e||!(l=n.relatedTarget||n.fromElement)||!gi(l)&&!l[pi])&&(u||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(l=(l=n.relatedTarget||n.toElement)?gi(l):null)&&(l!==(h=qe(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(u=null,l=r),u!==l)){if(c=pn,A="onMouseLeave",f="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(c=Mn,A="onPointerLeave",f="onPointerEnter",p="pointer"),h=null==u?s:_i(u),d=null==l?s:_i(l),(s=new c(A,p+"leave",u,n,i)).target=h,s.relatedTarget=d,A=null,gi(i)===r&&((c=new c(f,p+"enter",l,n,i)).target=d,c.relatedTarget=h,A=c),h=A,u&&l)e:{for(f=l,p=0,d=c=u;d;d=Xr(d))p++;for(d=0,A=f;A;A=Xr(A))d++;for(;0<p-d;)c=Xr(c),p--;for(;0<d-p;)f=Xr(f),d--;for(;p--;){if(c===f||null!==f&&c===f.alternate)break e;c=Xr(c),f=Xr(f)}c=null}else c=null;null!==u&&Qr(o,s,u,c,!1),null!==l&&null!==h&&Qr(o,h,l,c,!0)}if("select"===(u=(s=r?_i(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var v=Kn;else if(Gn(s))if(Zn)v=or;else{v=ir;var m=rr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(v=ar);switch(v&&(v=v(e,r))?Hn(o,v,n,i):(m&&m(e,s,r),"focusout"===e&&(m=s._wrapperState)&&m.controlled&&"number"===s.type&&ee(s,"number",s.value)),m=r?_i(r):window,e){case"focusin":(Gn(m)||"true"===m.contentEditable)&&(vr=m,mr=r,gr=null);break;case"focusout":gr=mr=vr=null;break;case"mousedown":yr=!0;break;case"contextmenu":case"mouseup":case"dragend":yr=!1,_r(o,n,i);break;case"selectionchange":if(Ar)break;case"keydown":case"keyup":_r(o,n,i)}var g;if(Ln)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else qn?zn(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(Un&&"ko"!==n.locale&&(qn||"onCompositionStart"!==y?"onCompositionEnd"===y&&qn&&(g=en()):(Jt="value"in(Zt=i)?Zt.value:Zt.textContent,qn=!0)),0<(m=Wr(r,y)).length&&(y=new _n(y,e,null,n,i),o.push({event:y,listeners:m}),g?y.data=g:null!==(g=Vn(n))&&(y.data=g))),(g=On?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(Fn=!0,Bn);case"textInput":return(e=t.data)===Bn&&Fn?null:e;default:return null}}(e,n):function(e,t){if(qn)return"compositionend"===e||!Ln&&zn(e,t)?(e=en(),$t=Jt=Zt=null,qn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Wr(r,"onBeforeInput")).length&&(i=new _n("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=g))}Br(o,t)}))}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Ne(e,n))&&r.unshift(Hr(e,a,i)),null!=(a=Ne(e,t))&&r.push(Hr(e,a,i))),e=e.return}return r}function Xr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,i){for(var a=t._reactName,o=[];null!==n&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==l&&(s=l,i?null!=(u=Ne(n,a))&&o.unshift(Hr(n,u,s)):i||null!=(u=Ne(n,a))&&o.push(Hr(n,u,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Yr=/\r\n?/g,Kr=/\u0000|\uFFFD/g;function Zr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Kr,"")}function Jr(e,t,n){if(t=Zr(t),Zr(e)!==t&&n)throw Error(a(425))}function $r(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(e){return ai.resolve(null).then(e).catch(si)}:ri;function si(e){setTimeout((function(){throw e}))}function ui(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void qt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);qt(t)}function li(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ci(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),fi="__reactFiber$"+hi,di="__reactProps$"+hi,pi="__reactContainer$"+hi,Ai="__reactEvents$"+hi,vi="__reactListeners$"+hi,mi="__reactHandles$"+hi;function gi(e){var t=e[fi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[fi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ci(e);null!==e;){if(n=e[fi])return n;e=ci(e)}return t}n=(e=n).parentNode}return null}function yi(e){return!(e=e[fi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function _i(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function bi(e){return e[di]||null}var xi=[],wi=-1;function Ti(e){return{current:e}}function Si(e){0>wi||(e.current=xi[wi],xi[wi]=null,wi--)}function Ei(e,t){wi++,xi[wi]=e.current,e.current=t}var ki={},Mi=Ti(ki),Ci=Ti(!1),Ri=ki;function Pi(e,t){var n=e.type.contextTypes;if(!n)return ki;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ni(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ii(){Si(Ci),Si(Mi)}function Li(e,t,n){if(Mi.current!==ki)throw Error(a(168));Ei(Mi,t),Ei(Ci,n)}function Di(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(a(108,j(e)||"Unknown",i));return U({},n,r)}function Oi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ki,Ri=Mi.current,Ei(Mi,e),Ei(Ci,Ci.current),!0}function Ui(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Di(e,t,Ri),r.__reactInternalMemoizedMergedChildContext=e,Si(Ci),Si(Mi),Ei(Mi,e)):Si(Ci),Ei(Ci,n)}var Bi=null,Fi=!1,zi=!1;function Vi(e){null===Bi?Bi=[e]:Bi.push(e)}function qi(){if(!zi&&null!==Bi){zi=!0;var e=0,t=yt;try{var n=Bi;for(yt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Bi=null,Fi=!1}catch(i){throw null!==Bi&&(Bi=Bi.slice(e+1)),Xe($e,qi),i}finally{yt=t,zi=!1}}return null}var ji=[],Gi=0,Hi=null,Wi=0,Xi=[],Qi=0,Yi=null,Ki=1,Zi="";function Ji(e,t){ji[Gi++]=Wi,ji[Gi++]=Hi,Hi=e,Wi=t}function $i(e,t,n){Xi[Qi++]=Ki,Xi[Qi++]=Zi,Xi[Qi++]=Yi,Yi=e;var r=Ki;e=Zi;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var a=32-ot(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ki=1<<32-ot(t)+i|n<<i|r,Zi=a+e}else Ki=1<<a|n<<i|r,Zi=e}function ea(e){null!==e.return&&(Ji(e,1),$i(e,1,0))}function ta(e){for(;e===Hi;)Hi=ji[--Gi],ji[Gi]=null,Wi=ji[--Gi],ji[Gi]=null;for(;e===Yi;)Yi=Xi[--Qi],Xi[Qi]=null,Zi=Xi[--Qi],Xi[Qi]=null,Ki=Xi[--Qi],Xi[Qi]=null}var na=null,ra=null,ia=!1,aa=null;function oa(e,t){var n=Pl(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function sa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ra=li(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ra=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yi?{id:Ki,overflow:Zi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Pl(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ra=null,!0);default:return!1}}function ua(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function la(e){if(ia){var t=ra;if(t){var n=t;if(!sa(e,t)){if(ua(e))throw Error(a(418));t=li(n.nextSibling);var r=na;t&&sa(e,t)?oa(r,n):(e.flags=-4097&e.flags|2,ia=!1,na=e)}}else{if(ua(e))throw Error(a(418));e.flags=-4097&e.flags|2,ia=!1,na=e}}}function ca(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function ha(e){if(e!==na)return!1;if(!ia)return ca(e),ia=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ra)){if(ua(e))throw fa(),Error(a(418));for(;t;)oa(e,t),t=li(t.nextSibling)}if(ca(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ra=li(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ra=null}}else ra=na?li(e.stateNode.nextSibling):null;return!0}function fa(){for(var e=ra;e;)e=li(e.nextSibling)}function da(){ra=na=null,ia=!1}function pa(e){null===aa?aa=[e]:aa.push(e)}var Aa=_.ReactCurrentBatchConfig;function va(e,t){if(e&&e.defaultProps){for(var n in t=U({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var ma=Ti(null),ga=null,ya=null,_a=null;function ba(){_a=ya=ga=null}function xa(e){var t=ma.current;Si(ma),e._currentValue=t}function wa(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ta(e,t){ga=e,_a=ya=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(_s=!0),e.firstContext=null)}function Sa(e){var t=e._currentValue;if(_a!==e)if(e={context:e,memoizedValue:t,next:null},null===ya){if(null===ga)throw Error(a(308));ya=e,ga.dependencies={lanes:0,firstContext:e}}else ya=ya.next=e;return t}var Ea=null;function ka(e){null===Ea?Ea=[e]:Ea.push(e)}function Ma(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,ka(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ca(e,r)}function Ca(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ra=!1;function Pa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Na(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ia(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function La(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Mu)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ca(e,n)}return null===(i=r.interleaved)?(t.next=t,ka(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ca(e,n)}function Da(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}function Oa(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ua(e,t,n,r){var i=e.updateQueue;Ra=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var u=s,l=u.next;u.next=null,null===o?a=l:o.next=l,o=u;var c=e.alternate;null!==c&&((s=(c=c.updateQueue).lastBaseUpdate)!==o&&(null===s?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(null!==a){var h=i.baseState;for(o=0,c=l=u=null,s=a;;){var f=s.lane,d=s.eventTime;if((r&f)===f){null!==c&&(c=c.next={eventTime:d,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,A=s;switch(f=t,d=n,A.tag){case 1:if("function"===typeof(p=A.payload)){h=p.call(d,h,f);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(f="function"===typeof(p=A.payload)?p.call(d,h,f):p)||void 0===f)break e;h=U({},h,f);break e;case 2:Ra=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(f=i.effects)?i.effects=[s]:f.push(s))}else d={eventTime:d,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===c?(l=c=d,u=h):c=c.next=d,o|=f;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(f=s).next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}if(null===c&&(u=h),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=c,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Ou|=o,e.lanes=o,e.memoizedState=h}}function Ba(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var Fa=(new r.Component).refs;function za(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:U({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Va={isMounted:function(e){return!!(e=e._reactInternals)&&qe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=el(),i=tl(e),a=Ia(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=La(e,a,i))&&(nl(t,e,i,r),Da(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=el(),i=tl(e),a=Ia(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=La(e,a,i))&&(nl(t,e,i,r),Da(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=el(),r=tl(e),i=Ia(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=La(e,i,r))&&(nl(t,e,r,n),Da(t,e,r))}};function qa(e,t,n,r,i,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(i,a))}function ja(e,t,n){var r=!1,i=ki,a=t.contextType;return"object"===typeof a&&null!==a?a=Sa(a):(i=Ni(t)?Ri:Mi.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Pi(e,i):ki),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Va,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Ga(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Va.enqueueReplaceState(t,t.state,null)}function Ha(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=Fa,Pa(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=Sa(a):(a=Ni(t)?Ri:Mi.current,i.context=Pi(e,a)),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(za(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Va.enqueueReplaceState(i,i.state,null),Ua(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Wa(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;t===Fa&&(t=i.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function Xa(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Qa(e){return(0,e._init)(e._payload)}function Ya(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Il(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Ul(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function l(e,t,n,r){var a=n.type;return a===w?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===N&&Qa(a)===t.type)?((r=i(t,n.props)).ref=Wa(e,t,n),r.return=e,r):((r=Ll(n.type,n.key,n.props,null,e.mode,r)).ref=Wa(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bl(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,a){return null===t||7!==t.tag?((t=Dl(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function f(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Ul(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(n=Ll(t.type,t.key,t.props,null,e.mode,n)).ref=Wa(e,null,t),n.return=e,n;case x:return(t=Bl(t,e.mode,n)).return=e,t;case N:return f(e,(0,t._init)(t._payload),n)}if(te(t)||D(t))return(t=Dl(t,e.mode,n,null)).return=e,t;Xa(e,t)}return null}function d(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===i?l(e,t,n,r):null;case x:return n.key===i?c(e,t,n,r):null;case N:return d(e,t,(i=n._init)(n._payload),r)}if(te(n)||D(n))return null!==i?null:h(e,t,n,r,null);Xa(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case b:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i);case x:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case N:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||D(r))return h(t,e=e.get(n)||null,r,i,null);Xa(t,r)}return null}function A(i,a,s,u){for(var l=null,c=null,h=a,A=a=0,v=null;null!==h&&A<s.length;A++){h.index>A?(v=h,h=null):v=h.sibling;var m=d(i,h,s[A],u);if(null===m){null===h&&(h=v);break}e&&h&&null===m.alternate&&t(i,h),a=o(m,a,A),null===c?l=m:c.sibling=m,c=m,h=v}if(A===s.length)return n(i,h),ia&&Ji(i,A),l;if(null===h){for(;A<s.length;A++)null!==(h=f(i,s[A],u))&&(a=o(h,a,A),null===c?l=h:c.sibling=h,c=h);return ia&&Ji(i,A),l}for(h=r(i,h);A<s.length;A++)null!==(v=p(h,i,A,s[A],u))&&(e&&null!==v.alternate&&h.delete(null===v.key?A:v.key),a=o(v,a,A),null===c?l=v:c.sibling=v,c=v);return e&&h.forEach((function(e){return t(i,e)})),ia&&Ji(i,A),l}function v(i,s,u,l){var c=D(u);if("function"!==typeof c)throw Error(a(150));if(null==(u=c.call(u)))throw Error(a(151));for(var h=c=null,A=s,v=s=0,m=null,g=u.next();null!==A&&!g.done;v++,g=u.next()){A.index>v?(m=A,A=null):m=A.sibling;var y=d(i,A,g.value,l);if(null===y){null===A&&(A=m);break}e&&A&&null===y.alternate&&t(i,A),s=o(y,s,v),null===h?c=y:h.sibling=y,h=y,A=m}if(g.done)return n(i,A),ia&&Ji(i,v),c;if(null===A){for(;!g.done;v++,g=u.next())null!==(g=f(i,g.value,l))&&(s=o(g,s,v),null===h?c=g:h.sibling=g,h=g);return ia&&Ji(i,v),c}for(A=r(i,A);!g.done;v++,g=u.next())null!==(g=p(A,i,v,g.value,l))&&(e&&null!==g.alternate&&A.delete(null===g.key?v:g.key),s=o(g,s,v),null===h?c=g:h.sibling=g,h=g);return e&&A.forEach((function(e){return t(i,e)})),ia&&Ji(i,v),c}return function e(r,a,o,u){if("object"===typeof o&&null!==o&&o.type===w&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case b:e:{for(var l=o.key,c=a;null!==c;){if(c.key===l){if((l=o.type)===w){if(7===c.tag){n(r,c.sibling),(a=i(c,o.props.children)).return=r,r=a;break e}}else if(c.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===N&&Qa(l)===c.type){n(r,c.sibling),(a=i(c,o.props)).ref=Wa(r,c,o),a.return=r,r=a;break e}n(r,c);break}t(r,c),c=c.sibling}o.type===w?((a=Dl(o.props.children,r.mode,u,o.key)).return=r,r=a):((u=Ll(o.type,o.key,o.props,null,r.mode,u)).ref=Wa(r,a,o),u.return=r,r=u)}return s(r);case x:e:{for(c=o.key;null!==a;){if(a.key===c){if(4===a.tag&&a.stateNode.containerInfo===o.containerInfo&&a.stateNode.implementation===o.implementation){n(r,a.sibling),(a=i(a,o.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Bl(o,r.mode,u)).return=r,r=a}return s(r);case N:return e(r,a,(c=o._init)(o._payload),u)}if(te(o))return A(r,a,o,u);if(D(o))return v(r,a,o,u);Xa(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==a&&6===a.tag?(n(r,a.sibling),(a=i(a,o)).return=r,r=a):(n(r,a),(a=Ul(o,r.mode,u)).return=r,r=a),s(r)):n(r,a)}}var Ka=Ya(!0),Za=Ya(!1),Ja={},$a=Ti(Ja),eo=Ti(Ja),to=Ti(Ja);function no(e){if(e===Ja)throw Error(a(174));return e}function ro(e,t){switch(Ei(to,t),Ei(eo,e),Ei($a,Ja),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Si($a),Ei($a,t)}function io(){Si($a),Si(eo),Si(to)}function ao(e){no(to.current);var t=no($a.current),n=ue(t,e.type);t!==n&&(Ei(eo,e),Ei($a,n))}function oo(e){eo.current===e&&(Si($a),Si(eo))}var so=Ti(0);function uo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var lo=[];function co(){for(var e=0;e<lo.length;e++)lo[e]._workInProgressVersionPrimary=null;lo.length=0}var ho=_.ReactCurrentDispatcher,fo=_.ReactCurrentBatchConfig,po=0,Ao=null,vo=null,mo=null,go=!1,yo=!1,_o=0,bo=0;function xo(){throw Error(a(321))}function wo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function To(e,t,n,r,i,o){if(po=o,Ao=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ho.current=null===e||null===e.memoizedState?ss:us,e=n(r,i),yo){o=0;do{if(yo=!1,_o=0,25<=o)throw Error(a(301));o+=1,mo=vo=null,t.updateQueue=null,ho.current=ls,e=n(r,i)}while(yo)}if(ho.current=os,t=null!==vo&&null!==vo.next,po=0,mo=vo=Ao=null,go=!1,t)throw Error(a(300));return e}function So(){var e=0!==_o;return _o=0,e}function Eo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===mo?Ao.memoizedState=mo=e:mo=mo.next=e,mo}function ko(){if(null===vo){var e=Ao.alternate;e=null!==e?e.memoizedState:null}else e=vo.next;var t=null===mo?Ao.memoizedState:mo.next;if(null!==t)mo=t,vo=e;else{if(null===e)throw Error(a(310));e={memoizedState:(vo=e).memoizedState,baseState:vo.baseState,baseQueue:vo.baseQueue,queue:vo.queue,next:null},null===mo?Ao.memoizedState=mo=e:mo=mo.next=e}return mo}function Mo(e,t){return"function"===typeof t?t(e):t}function Co(e){var t=ko(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=vo,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var u=s=null,l=null,c=o;do{var h=c.lane;if((po&h)===h)null!==l&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var f={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===l?(u=l=f,s=r):l=l.next=f,Ao.lanes|=h,Ou|=h}c=c.next}while(null!==c&&c!==o);null===l?s=r:l.next=u,sr(r,t.memoizedState)||(_s=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,Ao.lanes|=o,Ou|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ro(e){var t=ko(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=e(o,s.action),s=s.next}while(s!==i);sr(o,t.memoizedState)||(_s=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Po(){}function No(e,t){var n=Ao,r=ko(),i=t(),o=!sr(r.memoizedState,i);if(o&&(r.memoizedState=i,_s=!0),r=r.queue,Go(Do.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==mo&&1&mo.memoizedState.tag){if(n.flags|=2048,Fo(9,Lo.bind(null,n,r,i,t),void 0,null),null===Cu)throw Error(a(349));0!==(30&po)||Io(n,t,i)}return i}function Io(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Ao.updateQueue)?(t={lastEffect:null,stores:null},Ao.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Lo(e,t,n,r){t.value=n,t.getSnapshot=r,Oo(t)&&Uo(e)}function Do(e,t,n){return n((function(){Oo(t)&&Uo(e)}))}function Oo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Uo(e){var t=Ca(e,1);null!==t&&nl(t,e,1,-1)}function Bo(e){var t=Eo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mo,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,Ao,e),[t.memoizedState,e]}function Fo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Ao.updateQueue)?(t={lastEffect:null,stores:null},Ao.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function zo(){return ko().memoizedState}function Vo(e,t,n,r){var i=Eo();Ao.flags|=e,i.memoizedState=Fo(1|t,n,void 0,void 0===r?null:r)}function qo(e,t,n,r){var i=ko();r=void 0===r?null:r;var a=void 0;if(null!==vo){var o=vo.memoizedState;if(a=o.destroy,null!==r&&wo(r,o.deps))return void(i.memoizedState=Fo(t,n,a,r))}Ao.flags|=e,i.memoizedState=Fo(1|t,n,a,r)}function jo(e,t){return Vo(8390656,8,e,t)}function Go(e,t){return qo(2048,8,e,t)}function Ho(e,t){return qo(4,2,e,t)}function Wo(e,t){return qo(4,4,e,t)}function Xo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Qo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,qo(4,4,Xo.bind(null,t,e),n)}function Yo(){}function Ko(e,t){var n=ko();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&wo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Zo(e,t){var n=ko();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&wo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Jo(e,t,n){return 0===(21&po)?(e.baseState&&(e.baseState=!1,_s=!0),e.memoizedState=n):(sr(n,t)||(n=At(),Ao.lanes|=n,Ou|=n,e.baseState=!0),t)}function $o(e,t){var n=yt;yt=0!==n&&4>n?n:4,e(!0);var r=fo.transition;fo.transition={};try{e(!1),t()}finally{yt=n,fo.transition=r}}function es(){return ko().memoizedState}function ts(e,t,n){var r=tl(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(e))is(t,n);else if(null!==(n=Ma(e,t,n,r))){nl(n,e,r,el()),as(n,t,r)}}function ns(e,t,n){var r=tl(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(e))is(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=a(o,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,o)){var u=t.interleaved;return null===u?(i.next=i,ka(t)):(i.next=u.next,u.next=i),void(t.interleaved=i)}}catch(l){}null!==(n=Ma(e,t,i,r))&&(nl(n,e,r,i=el()),as(n,t,r))}}function rs(e){var t=e.alternate;return e===Ao||null!==t&&t===Ao}function is(e,t){yo=go=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function as(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}var os={readContext:Sa,useCallback:xo,useContext:xo,useEffect:xo,useImperativeHandle:xo,useInsertionEffect:xo,useLayoutEffect:xo,useMemo:xo,useReducer:xo,useRef:xo,useState:xo,useDebugValue:xo,useDeferredValue:xo,useTransition:xo,useMutableSource:xo,useSyncExternalStore:xo,useId:xo,unstable_isNewReconciler:!1},ss={readContext:Sa,useCallback:function(e,t){return Eo().memoizedState=[e,void 0===t?null:t],e},useContext:Sa,useEffect:jo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Vo(4194308,4,Xo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Vo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Vo(4,2,e,t)},useMemo:function(e,t){var n=Eo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Eo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ts.bind(null,Ao,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Eo().memoizedState=e},useState:Bo,useDebugValue:Yo,useDeferredValue:function(e){return Eo().memoizedState=e},useTransition:function(){var e=Bo(!1),t=e[0];return e=$o.bind(null,e[1]),Eo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ao,i=Eo();if(ia){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Cu)throw Error(a(349));0!==(30&po)||Io(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,jo(Do.bind(null,r,o,e),[e]),r.flags|=2048,Fo(9,Lo.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Eo(),t=Cu.identifierPrefix;if(ia){var n=Zi;t=":"+t+"R"+(n=(Ki&~(1<<32-ot(Ki)-1)).toString(32)+n),0<(n=_o++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=bo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},us={readContext:Sa,useCallback:Ko,useContext:Sa,useEffect:Go,useImperativeHandle:Qo,useInsertionEffect:Ho,useLayoutEffect:Wo,useMemo:Zo,useReducer:Co,useRef:zo,useState:function(){return Co(Mo)},useDebugValue:Yo,useDeferredValue:function(e){return Jo(ko(),vo.memoizedState,e)},useTransition:function(){return[Co(Mo)[0],ko().memoizedState]},useMutableSource:Po,useSyncExternalStore:No,useId:es,unstable_isNewReconciler:!1},ls={readContext:Sa,useCallback:Ko,useContext:Sa,useEffect:Go,useImperativeHandle:Qo,useInsertionEffect:Ho,useLayoutEffect:Wo,useMemo:Zo,useReducer:Ro,useRef:zo,useState:function(){return Ro(Mo)},useDebugValue:Yo,useDeferredValue:function(e){var t=ko();return null===vo?t.memoizedState=e:Jo(t,vo.memoizedState,e)},useTransition:function(){return[Ro(Mo)[0],ko().memoizedState]},useMutableSource:Po,useSyncExternalStore:No,useId:es,unstable_isNewReconciler:!1};function cs(e,t){try{var n="",r=t;do{n+=V(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i,digest:null}}function hs(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function fs(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ds="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=Ia(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Gu||(Gu=!0,Hu=r),fs(0,t)},n}function As(e,t,n){(n=Ia(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){fs(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){fs(0,t),"function"!==typeof r&&(null===Wu?Wu=new Set([this]):Wu.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function vs(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ds;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Sl.bind(null,e,t,n),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function gs(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ia(-1,1)).tag=2,La(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ys=_.ReactCurrentOwner,_s=!1;function bs(e,t,n,r){t.child=null===e?Za(t,null,n,r):Ka(t,e.child,n,r)}function xs(e,t,n,r,i){n=n.render;var a=t.ref;return Ta(t,i),r=To(e,t,n,r,a,i),n=So(),null===e||_s?(ia&&n&&ea(t),t.flags|=1,bs(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Gs(e,t,i))}function ws(e,t,n,r,i){if(null===e){var a=n.type;return"function"!==typeof a||Nl(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Ll(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Ts(e,t,a,r,i))}if(a=e.child,0===(e.lanes&i)){var o=a.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(o,r)&&e.ref===t.ref)return Gs(e,t,i)}return t.flags|=1,(e=Il(a,r)).ref=t.ref,e.return=t,t.child=e}function Ts(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(ur(a,r)&&e.ref===t.ref){if(_s=!1,t.pendingProps=r=a,0===(e.lanes&i))return t.lanes=e.lanes,Gs(e,t,i);0!==(131072&e.flags)&&(_s=!0)}}return ks(e,t,n,r,i)}function Ss(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ei(Iu,Nu),Nu|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ei(Iu,Nu),Nu|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Ei(Iu,Nu),Nu|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ei(Iu,Nu),Nu|=r;return bs(e,t,i,n),t.child}function Es(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ks(e,t,n,r,i){var a=Ni(n)?Ri:Mi.current;return a=Pi(t,a),Ta(t,i),n=To(e,t,n,r,a,i),r=So(),null===e||_s?(ia&&r&&ea(t),t.flags|=1,bs(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Gs(e,t,i))}function Ms(e,t,n,r,i){if(Ni(n)){var a=!0;Oi(t)}else a=!1;if(Ta(t,i),null===t.stateNode)js(e,t),ja(t,n,r),Ha(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var u=o.context,l=n.contextType;"object"===typeof l&&null!==l?l=Sa(l):l=Pi(t,l=Ni(n)?Ri:Mi.current);var c=n.getDerivedStateFromProps,h="function"===typeof c||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||u!==l)&&Ga(t,o,r,l),Ra=!1;var f=t.memoizedState;o.state=f,Ua(t,r,o,i),u=t.memoizedState,s!==r||f!==u||Ci.current||Ra?("function"===typeof c&&(za(t,n,c,r),u=t.memoizedState),(s=Ra||qa(t,n,s,r,f,u,l))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=l,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Na(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:va(t.type,s),o.props=l,h=t.pendingProps,f=o.context,"object"===typeof(u=n.contextType)&&null!==u?u=Sa(u):u=Pi(t,u=Ni(n)?Ri:Mi.current);var d=n.getDerivedStateFromProps;(c="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==h||f!==u)&&Ga(t,o,r,u),Ra=!1,f=t.memoizedState,o.state=f,Ua(t,r,o,i);var p=t.memoizedState;s!==h||f!==p||Ci.current||Ra?("function"===typeof d&&(za(t,n,d,r),p=t.memoizedState),(l=Ra||qa(t,n,l,r,f,p,u)||!1)?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,u)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=u,r=l):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Cs(e,t,n,r,a,i)}function Cs(e,t,n,r,i,a){Es(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Ui(t,n,!1),Gs(e,t,a);r=t.stateNode,ys.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Ka(t,e.child,null,a),t.child=Ka(t,null,s,a)):bs(e,t,s,a),t.memoizedState=r.state,i&&Ui(t,n,!0),t.child}function Rs(e){var t=e.stateNode;t.pendingContext?Li(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Li(0,t.context,!1),ro(e,t.containerInfo)}function Ps(e,t,n,r,i){return da(),pa(i),t.flags|=256,bs(e,t,n,r),t.child}var Ns,Is,Ls,Ds={dehydrated:null,treeContext:null,retryLane:0};function Os(e){return{baseLanes:e,cachePool:null,transitions:null}}function Us(e,t,n){var r,i=t.pendingProps,o=so.current,s=!1,u=0!==(128&t.flags);if((r=u)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ei(so,1&o),null===e)return la(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(u=i.children,e=i.fallback,s?(i=t.mode,s=t.child,u={mode:"hidden",children:u},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=u):s=Ol(u,i,0,null),e=Dl(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Os(n),t.memoizedState=Ds,e):Bs(t,u));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,s){if(n)return 256&t.flags?(t.flags&=-257,Fs(e,t,s,r=hs(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Ol({mode:"visible",children:r.children},i,0,null),(o=Dl(o,i,s,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Ka(t,e.child,null,s),t.child.memoizedState=Os(s),t.memoizedState=Ds,o);if(0===(1&t.mode))return Fs(e,t,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var u=r.dgst;return r=u,Fs(e,t,s,r=hs(o=Error(a(419)),r,void 0))}if(u=0!==(s&e.childLanes),_s||u){if(null!==(r=Cu)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|s))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Ca(e,i),nl(r,e,i,-1))}return Al(),Fs(e,t,s,r=hs(Error(a(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=kl.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,ra=li(i.nextSibling),na=t,ia=!0,aa=null,null!==e&&(Xi[Qi++]=Ki,Xi[Qi++]=Zi,Xi[Qi++]=Yi,Ki=e.id,Zi=e.overflow,Yi=t),t=Bs(t,r.children),t.flags|=4096,t)}(e,t,u,i,r,o,n);if(s){s=i.fallback,u=t.mode,r=(o=e.child).sibling;var l={mode:"hidden",children:i.children};return 0===(1&u)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=l,t.deletions=null):(i=Il(o,l)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=Il(r,s):(s=Dl(s,u,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,u=null===(u=e.child.memoizedState)?Os(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=e.childLanes&~n,t.memoizedState=Ds,i}return e=(s=e.child).sibling,i=Il(s,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Bs(e,t){return(t=Ol({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Fs(e,t,n,r){return null!==r&&pa(r),Ka(t,e.child,null,n),(e=Bs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),wa(e.return,t,n)}function Vs(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function qs(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(bs(e,t,r.children,n),0!==(2&(r=so.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zs(e,n,t);else if(19===e.tag)zs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ei(so,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===uo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Vs(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===uo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Vs(t,!0,n,null,a);break;case"together":Vs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function js(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ou|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Il(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Il(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Hs(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ws(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Xs(e,t,n){var r=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ws(t),null;case 1:case 17:return Ni(t.type)&&Ii(),Ws(t),null;case 3:return r=t.stateNode,io(),Si(Ci),Si(Mi),co(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ha(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(ol(aa),aa=null))),Ws(t),null;case 5:oo(t);var i=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)Is(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Ws(t),null}if(e=no($a.current),ha(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[fi]=t,r[di]=o,e=0!==(1&t.mode),n){case"dialog":Fr("cancel",r),Fr("close",r);break;case"iframe":case"object":case"embed":Fr("load",r);break;case"video":case"audio":for(i=0;i<Dr.length;i++)Fr(Dr[i],r);break;case"source":Fr("error",r);break;case"img":case"image":case"link":Fr("error",r),Fr("load",r);break;case"details":Fr("toggle",r);break;case"input":K(r,o),Fr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Fr("invalid",r);break;case"textarea":ie(r,o),Fr("invalid",r)}for(var u in ge(n,o),i=null,o)if(o.hasOwnProperty(u)){var l=o[u];"children"===u?"string"===typeof l?r.textContent!==l&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,l,e),i=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,l,e),i=["children",""+l]):s.hasOwnProperty(u)&&null!=l&&"onScroll"===u&&Fr("scroll",r)}switch(n){case"input":W(r),$(r,o,!0);break;case"textarea":W(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=$r)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{u=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[fi]=t,e[di]=r,Ns(e,t),t.stateNode=e;e:{switch(u=ye(n,r),n){case"dialog":Fr("cancel",e),Fr("close",e),i=r;break;case"iframe":case"object":case"embed":Fr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Dr.length;i++)Fr(Dr[i],e);i=r;break;case"source":Fr("error",e),i=r;break;case"img":case"image":case"link":Fr("error",e),Fr("load",e),i=r;break;case"details":Fr("toggle",e),i=r;break;case"input":K(e,r),i=Y(e,r),Fr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=U({},r,{value:void 0}),Fr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Fr("invalid",e)}for(o in ge(n,i),l=i)if(l.hasOwnProperty(o)){var c=l[o];"style"===o?ve(e,c):"dangerouslySetInnerHTML"===o?null!=(c=c?c.__html:void 0)&&he(e,c):"children"===o?"string"===typeof c?("textarea"!==n||""!==c)&&fe(e,c):"number"===typeof c&&fe(e,""+c):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=c&&"onScroll"===o&&Fr("scroll",e):null!=c&&y(e,o,c,u))}switch(n){case"input":W(e),$(e,r,!1);break;case"textarea":W(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+G(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=$r)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ws(t),null;case 6:if(e&&null!=t.stateNode)Ls(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=no(to.current),no($a.current),ha(t)){if(r=t.stateNode,n=t.memoizedProps,r[fi]=t,(o=r.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[fi]=t,t.stateNode=r}return Ws(t),null;case 13:if(Si(so),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ia&&null!==ra&&0!==(1&t.mode)&&0===(128&t.flags))fa(),da(),t.flags|=98560,o=!1;else if(o=ha(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(a(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(a(317));o[fi]=t}else da(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ws(t),o=!1}else null!==aa&&(ol(aa),aa=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&so.current)?0===Lu&&(Lu=3):Al())),null!==t.updateQueue&&(t.flags|=4),Ws(t),null);case 4:return io(),null===e&&qr(t.stateNode.containerInfo),Ws(t),null;case 10:return xa(t.type._context),Ws(t),null;case 19:if(Si(so),null===(o=t.memoizedState))return Ws(t),null;if(r=0!==(128&t.flags),null===(u=o.rendering))if(r)Hs(o,!1);else{if(0!==Lu||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=uo(e))){for(t.flags|=128,Hs(o,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(u=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,e=u.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ei(so,1&so.current|2),t.child}e=e.sibling}null!==o.tail&&Ze()>qu&&(t.flags|=128,r=!0,Hs(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=uo(u))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Hs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!u.alternate&&!ia)return Ws(t),null}else 2*Ze()-o.renderingStartTime>qu&&1073741824!==n&&(t.flags|=128,r=!0,Hs(o,!1),t.lanes=4194304);o.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=o.last)?n.sibling=u:t.child=u,o.last=u)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ze(),t.sibling=null,n=so.current,Ei(so,r?1&n|2:1&n),t):(Ws(t),null);case 22:case 23:return hl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Nu)&&(Ws(t),6&t.subtreeFlags&&(t.flags|=8192)):Ws(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Qs(e,t){switch(ta(t),t.tag){case 1:return Ni(t.type)&&Ii(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return io(),Si(Ci),Si(Mi),co(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(Si(so),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));da()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Si(so),null;case 4:return io(),null;case 10:return xa(t.type._context),null;case 22:case 23:return hl(),null;default:return null}}Ns=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Is=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,no($a.current);var a,o=null;switch(n){case"input":i=Y(e,i),r=Y(e,r),o=[];break;case"select":i=U({},i,{value:void 0}),r=U({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=$r)}for(c in ge(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var u=i[c];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(s.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var l=r[c];if(u=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&l!==u&&(null!=l||null!=u))if("style"===c)if(u){for(a in u)!u.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&u[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(o||(o=[]),o.push(c,n)),n=l;else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,u=u?u.__html:void 0,null!=l&&u!==l&&(o=o||[]).push(c,l)):"children"===c?"string"!==typeof l&&"number"!==typeof l||(o=o||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(s.hasOwnProperty(c)?(null!=l&&"onScroll"===c&&Fr("scroll",e),o||u===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(t.updateQueue=c)&&(t.flags|=4)}},Ls=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ys=!1,Ks=!1,Zs="function"===typeof WeakSet?WeakSet:Set,Js=null;function $s(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Tl(e,t,r)}else n.current=null}function eu(e,t,n){try{n()}catch(r){Tl(e,t,r)}}var tu=!1;function nu(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&eu(t,n,a)}i=i.next}while(i!==r)}}function ru(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function iu(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function au(e){var t=e.alternate;null!==t&&(e.alternate=null,au(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fi],delete t[di],delete t[Ai],delete t[vi],delete t[mi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ou(e){return 5===e.tag||3===e.tag||4===e.tag}function su(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ou(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function uu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$r));else if(4!==r&&null!==(e=e.child))for(uu(e,t,n),e=e.sibling;null!==e;)uu(e,t,n),e=e.sibling}function lu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(lu(e,t,n),e=e.sibling;null!==e;)lu(e,t,n),e=e.sibling}var cu=null,hu=!1;function fu(e,t,n){for(n=n.child;null!==n;)du(e,t,n),n=n.sibling}function du(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,n)}catch(s){}switch(n.tag){case 5:Ks||$s(n,t);case 6:var r=cu,i=hu;cu=null,fu(e,t,n),hu=i,null!==(cu=r)&&(hu?(e=cu,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):cu.removeChild(n.stateNode));break;case 18:null!==cu&&(hu?(e=cu,n=n.stateNode,8===e.nodeType?ui(e.parentNode,n):1===e.nodeType&&ui(e,n),qt(e)):ui(cu,n.stateNode));break;case 4:r=cu,i=hu,cu=n.stateNode.containerInfo,hu=!0,fu(e,t,n),cu=r,hu=i;break;case 0:case 11:case 14:case 15:if(!Ks&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,void 0!==o&&(0!==(2&a)||0!==(4&a))&&eu(n,t,o),i=i.next}while(i!==r)}fu(e,t,n);break;case 1:if(!Ks&&($s(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Tl(n,t,s)}fu(e,t,n);break;case 21:fu(e,t,n);break;case 22:1&n.mode?(Ks=(r=Ks)||null!==n.memoizedState,fu(e,t,n),Ks=r):fu(e,t,n);break;default:fu(e,t,n)}}function pu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Zs),t.forEach((function(t){var r=Ml.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function Au(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:cu=u.stateNode,hu=!1;break e;case 3:case 4:cu=u.stateNode.containerInfo,hu=!0;break e}u=u.return}if(null===cu)throw Error(a(160));du(o,s,i),cu=null,hu=!1;var l=i.alternate;null!==l&&(l.return=null),i.return=null}catch(c){Tl(i,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vu(t,e),t=t.sibling}function vu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Au(t,e),mu(e),4&r){try{nu(3,e,e.return),ru(3,e)}catch(v){Tl(e,e.return,v)}try{nu(5,e,e.return)}catch(v){Tl(e,e.return,v)}}break;case 1:Au(t,e),mu(e),512&r&&null!==n&&$s(n,n.return);break;case 5:if(Au(t,e),mu(e),512&r&&null!==n&&$s(n,n.return),32&e.flags){var i=e.stateNode;try{fe(i,"")}catch(v){Tl(e,e.return,v)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,u=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===u&&"radio"===o.type&&null!=o.name&&Z(i,o),ye(u,s);var c=ye(u,o);for(s=0;s<l.length;s+=2){var h=l[s],f=l[s+1];"style"===h?ve(i,f):"dangerouslySetInnerHTML"===h?he(i,f):"children"===h?fe(i,f):y(i,h,f,c)}switch(u){case"input":J(i,o);break;case"textarea":ae(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):d!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[di]=o}catch(v){Tl(e,e.return,v)}}break;case 6:if(Au(t,e),mu(e),4&r){if(null===e.stateNode)throw Error(a(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(v){Tl(e,e.return,v)}}break;case 3:if(Au(t,e),mu(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{qt(t.containerInfo)}catch(v){Tl(e,e.return,v)}break;case 4:default:Au(t,e),mu(e);break;case 13:Au(t,e),mu(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(Vu=Ze())),4&r&&pu(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Ks=(c=Ks)||h,Au(t,e),Ks=c):Au(t,e),mu(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!h&&0!==(1&e.mode))for(Js=e,h=e.child;null!==h;){for(f=Js=h;null!==Js;){switch(p=(d=Js).child,d.tag){case 0:case 11:case 14:case 15:nu(4,d,d.return);break;case 1:$s(d,d.return);var A=d.stateNode;if("function"===typeof A.componentWillUnmount){r=d,n=d.return;try{t=r,A.props=t.memoizedProps,A.state=t.memoizedState,A.componentWillUnmount()}catch(v){Tl(r,n,v)}}break;case 5:$s(d,d.return);break;case 22:if(null!==d.memoizedState){bu(f);continue}}null!==p?(p.return=d,Js=p):bu(f)}h=h.sibling}e:for(h=null,f=e;;){if(5===f.tag){if(null===h){h=f;try{i=f.stateNode,c?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(u=f.stateNode,s=void 0!==(l=f.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,u.style.display=Ae("display",s))}catch(v){Tl(e,e.return,v)}}}else if(6===f.tag){if(null===h)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(v){Tl(e,e.return,v)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Au(t,e),mu(e),4&r&&pu(e);case 21:}}function mu(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ou(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(fe(i,""),r.flags&=-33),lu(e,su(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;uu(e,su(e),o);break;default:throw Error(a(161))}}catch(s){Tl(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function gu(e,t,n){Js=e,yu(e,t,n)}function yu(e,t,n){for(var r=0!==(1&e.mode);null!==Js;){var i=Js,a=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Ys;if(!o){var s=i.alternate,u=null!==s&&null!==s.memoizedState||Ks;s=Ys;var l=Ks;if(Ys=o,(Ks=u)&&!l)for(Js=i;null!==Js;)u=(o=Js).child,22===o.tag&&null!==o.memoizedState?xu(i):null!==u?(u.return=o,Js=u):xu(i);for(;null!==a;)Js=a,yu(a,t,n),a=a.sibling;Js=i,Ys=s,Ks=l}_u(e)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,Js=a):_u(e)}}function _u(e){for(;null!==Js;){var t=Js;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ks||ru(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ks)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:va(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Ba(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ba(t,s,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var h=c.memoizedState;if(null!==h){var f=h.dehydrated;null!==f&&qt(f)}}}break;default:throw Error(a(163))}Ks||512&t.flags&&iu(t)}catch(d){Tl(t,t.return,d)}}if(t===e){Js=null;break}if(null!==(n=t.sibling)){n.return=t.return,Js=n;break}Js=t.return}}function bu(e){for(;null!==Js;){var t=Js;if(t===e){Js=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Js=n;break}Js=t.return}}function xu(e){for(;null!==Js;){var t=Js;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ru(4,t)}catch(u){Tl(t,n,u)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(u){Tl(t,i,u)}}var a=t.return;try{iu(t)}catch(u){Tl(t,a,u)}break;case 5:var o=t.return;try{iu(t)}catch(u){Tl(t,o,u)}}}catch(u){Tl(t,t.return,u)}if(t===e){Js=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Js=s;break}Js=t.return}}var wu,Tu=Math.ceil,Su=_.ReactCurrentDispatcher,Eu=_.ReactCurrentOwner,ku=_.ReactCurrentBatchConfig,Mu=0,Cu=null,Ru=null,Pu=0,Nu=0,Iu=Ti(0),Lu=0,Du=null,Ou=0,Uu=0,Bu=0,Fu=null,zu=null,Vu=0,qu=1/0,ju=null,Gu=!1,Hu=null,Wu=null,Xu=!1,Qu=null,Yu=0,Ku=0,Zu=null,Ju=-1,$u=0;function el(){return 0!==(6&Mu)?Ze():-1!==Ju?Ju:Ju=Ze()}function tl(e){return 0===(1&e.mode)?1:0!==(2&Mu)&&0!==Pu?Pu&-Pu:null!==Aa.transition?(0===$u&&($u=At()),$u):0!==(e=yt)?e:e=void 0===(e=window.event)?16:Kt(e.type)}function nl(e,t,n,r){if(50<Ku)throw Ku=0,Zu=null,Error(a(185));mt(e,n,r),0!==(2&Mu)&&e===Cu||(e===Cu&&(0===(2&Mu)&&(Uu|=n),4===Lu&&sl(e,Pu)),rl(e,r),1===n&&0===Mu&&0===(1&t.mode)&&(qu=Ze()+500,Fi&&qi()))}function rl(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-ot(a),s=1<<o,u=i[o];-1===u?0!==(s&n)&&0===(s&r)||(i[o]=dt(s,t)):u<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var r=ft(e,e===Cu?Pu:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Fi=!0,Vi(e)}(ul.bind(null,e)):Vi(ul.bind(null,e)),oi((function(){0===(6&Mu)&&qi()})),n=null;else{switch(_t(r)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Cl(n,il.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function il(e,t){if(Ju=-1,$u=0,0!==(6&Mu))throw Error(a(327));var n=e.callbackNode;if(xl()&&e.callbackNode!==n)return null;var r=ft(e,e===Cu?Pu:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vl(e,r);else{t=r;var i=Mu;Mu|=2;var o=pl();for(Cu===e&&Pu===t||(ju=null,qu=Ze()+500,fl(e,t));;)try{gl();break}catch(u){dl(e,u)}ba(),Su.current=o,Mu=i,null!==Ru?t=0:(Cu=null,Pu=0,t=Lu)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=al(e,i))),1===t)throw n=Du,fl(e,0),sl(e,r),rl(e,Ze()),n;if(6===t)sl(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!sr(a(),i))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=vl(e,r))&&(0!==(o=pt(e))&&(r=o,t=al(e,o))),1===t))throw n=Du,fl(e,0),sl(e,r),rl(e,Ze()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:bl(e,zu,ju);break;case 3:if(sl(e,r),(130023424&r)===r&&10<(t=Vu+500-Ze())){if(0!==ft(e,0))break;if(((i=e.suspendedLanes)&r)!==r){el(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(bl.bind(null,e,zu,ju),t);break}bl(e,zu,ju);break;case 4:if(sl(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-ot(r);o=1<<s,(s=t[s])>i&&(i=s),r&=~o}if(r=i,10<(r=(120>(r=Ze()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Tu(r/1960))-r)){e.timeoutHandle=ri(bl.bind(null,e,zu,ju),r);break}bl(e,zu,ju);break;default:throw Error(a(329))}}}return rl(e,Ze()),e.callbackNode===n?il.bind(null,e):null}function al(e,t){var n=Fu;return e.current.memoizedState.isDehydrated&&(fl(e,t).flags|=256),2!==(e=vl(e,t))&&(t=zu,zu=n,null!==t&&ol(t)),e}function ol(e){null===zu?zu=e:zu.push.apply(zu,e)}function sl(e,t){for(t&=~Bu,t&=~Uu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function ul(e){if(0!==(6&Mu))throw Error(a(327));xl();var t=ft(e,0);if(0===(1&t))return rl(e,Ze()),null;var n=vl(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=al(e,r))}if(1===n)throw n=Du,fl(e,0),sl(e,t),rl(e,Ze()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bl(e,zu,ju),rl(e,Ze()),null}function ll(e,t){var n=Mu;Mu|=1;try{return e(t)}finally{0===(Mu=n)&&(qu=Ze()+500,Fi&&qi())}}function cl(e){null!==Qu&&0===Qu.tag&&0===(6&Mu)&&xl();var t=Mu;Mu|=1;var n=ku.transition,r=yt;try{if(ku.transition=null,yt=1,e)return e()}finally{yt=r,ku.transition=n,0===(6&(Mu=t))&&qi()}}function hl(){Nu=Iu.current,Si(Iu)}function fl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Ru)for(n=Ru.return;null!==n;){var r=n;switch(ta(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ii();break;case 3:io(),Si(Ci),Si(Mi),co();break;case 5:oo(r);break;case 4:io();break;case 13:case 19:Si(so);break;case 10:xa(r.type._context);break;case 22:case 23:hl()}n=n.return}if(Cu=e,Ru=e=Il(e.current,null),Pu=Nu=t,Lu=0,Du=null,Bu=Uu=Ou=0,zu=Fu=null,null!==Ea){for(t=0;t<Ea.length;t++)if(null!==(r=(n=Ea[t]).interleaved)){n.interleaved=null;var i=r.next,a=n.pending;if(null!==a){var o=a.next;a.next=i,r.next=o}n.pending=r}Ea=null}return e}function dl(e,t){for(;;){var n=Ru;try{if(ba(),ho.current=os,go){for(var r=Ao.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}go=!1}if(po=0,mo=vo=Ao=null,yo=!1,_o=0,Eu.current=null,null===n||null===n.return){Lu=1,Du=t,Ru=null;break}e:{var o=e,s=n.return,u=n,l=t;if(t=Pu,u.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var c=l,h=u,f=h.tag;if(0===(1&h.mode)&&(0===f||11===f||15===f)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=ms(s);if(null!==p){p.flags&=-257,gs(p,s,u,0,t),1&p.mode&&vs(o,c,t),l=c;var A=(t=p).updateQueue;if(null===A){var v=new Set;v.add(l),t.updateQueue=v}else A.add(l);break e}if(0===(1&t)){vs(o,c,t),Al();break e}l=Error(a(426))}else if(ia&&1&u.mode){var m=ms(s);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),gs(m,s,u,0,t),pa(cs(l,u));break e}}o=l=cs(l,u),4!==Lu&&(Lu=2),null===Fu?Fu=[o]:Fu.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Oa(o,ps(0,l,t));break e;case 1:u=l;var g=o.type,y=o.stateNode;if(0===(128&o.flags)&&("function"===typeof g.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Wu||!Wu.has(y)))){o.flags|=65536,t&=-t,o.lanes|=t,Oa(o,As(o,u,t));break e}}o=o.return}while(null!==o)}_l(n)}catch(_){t=_,Ru===n&&null!==n&&(Ru=n=n.return);continue}break}}function pl(){var e=Su.current;return Su.current=os,null===e?os:e}function Al(){0!==Lu&&3!==Lu&&2!==Lu||(Lu=4),null===Cu||0===(268435455&Ou)&&0===(268435455&Uu)||sl(Cu,Pu)}function vl(e,t){var n=Mu;Mu|=2;var r=pl();for(Cu===e&&Pu===t||(ju=null,fl(e,t));;)try{ml();break}catch(i){dl(e,i)}if(ba(),Mu=n,Su.current=r,null!==Ru)throw Error(a(261));return Cu=null,Pu=0,Lu}function ml(){for(;null!==Ru;)yl(Ru)}function gl(){for(;null!==Ru&&!Ye();)yl(Ru)}function yl(e){var t=wu(e.alternate,e,Nu);e.memoizedProps=e.pendingProps,null===t?_l(e):Ru=t,Eu.current=null}function _l(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Xs(n,t,Nu)))return void(Ru=n)}else{if(null!==(n=Qs(n,t)))return n.flags&=32767,void(Ru=n);if(null===e)return Lu=6,void(Ru=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ru=t);Ru=t=e}while(null!==t);0===Lu&&(Lu=5)}function bl(e,t,n){var r=yt,i=ku.transition;try{ku.transition=null,yt=1,function(e,t,n,r){do{xl()}while(null!==Qu);if(0!==(6&Mu))throw Error(a(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}(e,o),e===Cu&&(Ru=Cu=null,Pu=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Xu||(Xu=!0,Cl(tt,(function(){return xl(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=ku.transition,ku.transition=null;var s=yt;yt=1;var u=Mu;Mu|=4,Eu.current=null,function(e,t){if(ei=Gt,dr(e=fr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(b){n=null;break e}var s=0,u=-1,l=-1,c=0,h=0,f=e,d=null;t:for(;;){for(var p;f!==n||0!==i&&3!==f.nodeType||(u=s+i),f!==o||0!==r&&3!==f.nodeType||(l=s+r),3===f.nodeType&&(s+=f.nodeValue.length),null!==(p=f.firstChild);)d=f,f=p;for(;;){if(f===e)break t;if(d===n&&++c===i&&(u=s),d===o&&++h===r&&(l=s),null!==(p=f.nextSibling))break;d=(f=d).parentNode}f=p}n=-1===u||-1===l?null:{start:u,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Gt=!1,Js=t;null!==Js;)if(e=(t=Js).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Js=e;else for(;null!==Js;){t=Js;try{var A=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==A){var v=A.memoizedProps,m=A.memoizedState,g=t.stateNode,y=g.getSnapshotBeforeUpdate(t.elementType===t.type?v:va(t.type,v),m);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var _=t.stateNode.containerInfo;1===_.nodeType?_.textContent="":9===_.nodeType&&_.documentElement&&_.removeChild(_.documentElement);break;default:throw Error(a(163))}}catch(b){Tl(t,t.return,b)}if(null!==(e=t.sibling)){e.return=t.return,Js=e;break}Js=t.return}A=tu,tu=!1}(e,n),vu(n,e),pr(ti),Gt=!!ei,ti=ei=null,e.current=n,gu(n,e,i),Ke(),Mu=u,yt=s,ku.transition=o}else e.current=n;if(Xu&&(Xu=!1,Qu=e,Yu=i),o=e.pendingLanes,0===o&&(Wu=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rl(e,Ze()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Gu)throw Gu=!1,e=Hu,Hu=null,e;0!==(1&Yu)&&0!==e.tag&&xl(),o=e.pendingLanes,0!==(1&o)?e===Zu?Ku++:(Ku=0,Zu=e):Ku=0,qi()}(e,t,n,r)}finally{ku.transition=i,yt=r}return null}function xl(){if(null!==Qu){var e=_t(Yu),t=ku.transition,n=yt;try{if(ku.transition=null,yt=16>e?16:e,null===Qu)var r=!1;else{if(e=Qu,Qu=null,Yu=0,0!==(6&Mu))throw Error(a(331));var i=Mu;for(Mu|=4,Js=e.current;null!==Js;){var o=Js,s=o.child;if(0!==(16&Js.flags)){var u=o.deletions;if(null!==u){for(var l=0;l<u.length;l++){var c=u[l];for(Js=c;null!==Js;){var h=Js;switch(h.tag){case 0:case 11:case 15:nu(8,h,o)}var f=h.child;if(null!==f)f.return=h,Js=f;else for(;null!==Js;){var d=(h=Js).sibling,p=h.return;if(au(h),h===c){Js=null;break}if(null!==d){d.return=p,Js=d;break}Js=p}}}var A=o.alternate;if(null!==A){var v=A.child;if(null!==v){A.child=null;do{var m=v.sibling;v.sibling=null,v=m}while(null!==v)}}Js=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Js=s;else e:for(;null!==Js;){if(0!==(2048&(o=Js).flags))switch(o.tag){case 0:case 11:case 15:nu(9,o,o.return)}var g=o.sibling;if(null!==g){g.return=o.return,Js=g;break e}Js=o.return}}var y=e.current;for(Js=y;null!==Js;){var _=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==_)_.return=s,Js=_;else e:for(s=y;null!==Js;){if(0!==(2048&(u=Js).flags))try{switch(u.tag){case 0:case 11:case 15:ru(9,u)}}catch(x){Tl(u,u.return,x)}if(u===s){Js=null;break e}var b=u.sibling;if(null!==b){b.return=u.return,Js=b;break e}Js=u.return}}if(Mu=i,qi(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(x){}r=!0}return r}finally{yt=n,ku.transition=t}}return!1}function wl(e,t,n){e=La(e,t=ps(0,t=cs(n,t),1),1),t=el(),null!==e&&(mt(e,1,t),rl(e,t))}function Tl(e,t,n){if(3===e.tag)wl(e,e,n);else for(;null!==t;){if(3===t.tag){wl(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Wu||!Wu.has(r))){t=La(t,e=As(t,e=cs(n,e),1),1),e=el(),null!==t&&(mt(t,1,e),rl(t,e));break}}t=t.return}}function Sl(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=el(),e.pingedLanes|=e.suspendedLanes&n,Cu===e&&(Pu&n)===n&&(4===Lu||3===Lu&&(130023424&Pu)===Pu&&500>Ze()-Vu?fl(e,0):Bu|=n),rl(e,t)}function El(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=el();null!==(e=Ca(e,t))&&(mt(e,t,n),rl(e,n))}function kl(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),El(e,n)}function Ml(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),El(e,n)}function Cl(e,t){return Xe(e,t)}function Rl(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pl(e,t,n,r){return new Rl(e,t,n,r)}function Nl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Il(e,t){var n=e.alternate;return null===n?((n=Pl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ll(e,t,n,r,i,o){var s=2;if(r=e,"function"===typeof e)Nl(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case w:return Dl(n.children,i,o,t);case T:s=8,i|=8;break;case S:return(e=Pl(12,n,t,2|i)).elementType=S,e.lanes=o,e;case C:return(e=Pl(13,n,t,i)).elementType=C,e.lanes=o,e;case R:return(e=Pl(19,n,t,i)).elementType=R,e.lanes=o,e;case I:return Ol(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case E:s=10;break e;case k:s=9;break e;case M:s=11;break e;case P:s=14;break e;case N:s=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Pl(s,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Dl(e,t,n,r){return(e=Pl(7,e,r,t)).lanes=n,e}function Ol(e,t,n,r){return(e=Pl(22,e,r,t)).elementType=I,e.lanes=n,e.stateNode={isHidden:!1},e}function Ul(e,t,n){return(e=Pl(6,e,null,t)).lanes=n,e}function Bl(e,t,n){return(t=Pl(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Fl(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vt(0),this.expirationTimes=vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function zl(e,t,n,r,i,a,o,s,u){return e=new Fl(e,t,n,s,u),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Pl(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pa(a),e}function Vl(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function ql(e){if(!e)return ki;e:{if(qe(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ni(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Ni(n))return Di(e,n,t)}return t}function jl(e,t,n,r,i,a,o,s,u){return(e=zl(n,r,!0,e,0,a,0,s,u)).context=ql(null),n=e.current,(a=Ia(r=el(),i=tl(n))).callback=void 0!==t&&null!==t?t:null,La(n,a,i),e.current.lanes=i,mt(e,i,r),rl(e,r),e}function Gl(e,t,n,r){var i=t.current,a=el(),o=tl(i);return n=ql(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ia(a,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=La(i,t,o))&&(nl(e,i,o,a),Da(e,i,o)),o}function Hl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Xl(e,t){Wl(e,t),(e=e.alternate)&&Wl(e,t)}wu=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ci.current)_s=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return _s=!1,function(e,t,n){switch(t.tag){case 3:Rs(t),da();break;case 5:ao(t);break;case 1:Ni(t.type)&&Oi(t);break;case 4:ro(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ei(ma,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ei(so,1&so.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Us(e,t,n):(Ei(so,1&so.current),null!==(e=Gs(e,t,n))?e.sibling:null);Ei(so,1&so.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return qs(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ei(so,so.current),r)break;return null;case 22:case 23:return t.lanes=0,Ss(e,t,n)}return Gs(e,t,n)}(e,t,n);_s=0!==(131072&e.flags)}else _s=!1,ia&&0!==(1048576&t.flags)&&$i(t,Wi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;js(e,t),e=t.pendingProps;var i=Pi(t,Mi.current);Ta(t,n),i=To(null,t,r,e,i,n);var o=So();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ni(r)?(o=!0,Oi(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Pa(t),i.updater=Va,t.stateNode=i,i._reactInternals=t,Ha(t,r,e,n),t=Cs(null,t,r,!0,o,n)):(t.tag=0,ia&&o&&ea(t),bs(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(js(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Nl(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===M)return 11;if(e===P)return 14}return 2}(r),e=va(r,e),i){case 0:t=ks(null,t,r,e,n);break e;case 1:t=Ms(null,t,r,e,n);break e;case 11:t=xs(null,t,r,e,n);break e;case 14:t=ws(null,t,r,va(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,ks(e,t,r,i=t.elementType===r?i:va(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ms(e,t,r,i=t.elementType===r?i:va(r,i),n);case 3:e:{if(Rs(t),null===e)throw Error(a(387));r=t.pendingProps,i=(o=t.memoizedState).element,Na(e,t),Ua(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ps(e,t,r,n,i=cs(Error(a(423)),t));break e}if(r!==i){t=Ps(e,t,r,n,i=cs(Error(a(424)),t));break e}for(ra=li(t.stateNode.containerInfo.firstChild),na=t,ia=!0,aa=null,n=Za(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(da(),r===i){t=Gs(e,t,n);break e}bs(e,t,r,n)}t=t.child}return t;case 5:return ao(t),null===e&&la(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==o&&ni(r,o)&&(t.flags|=32),Es(e,t),bs(e,t,s,n),t.child;case 6:return null===e&&la(t),null;case 13:return Us(e,t,n);case 4:return ro(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ka(t,null,r,n):bs(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,xs(e,t,r,i=t.elementType===r?i:va(r,i),n);case 7:return bs(e,t,t.pendingProps,n),t.child;case 8:case 12:return bs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,Ei(ma,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===i.children&&!Ci.current){t=Gs(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var u=o.dependencies;if(null!==u){s=o.child;for(var l=u.firstContext;null!==l;){if(l.context===r){if(1===o.tag){(l=Ia(-1,n&-n)).tag=2;var c=o.updateQueue;if(null!==c){var h=(c=c.shared).pending;null===h?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),wa(o.return,n,t),u.lanes|=n;break}l=l.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(a(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),wa(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}bs(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ta(t,n),r=r(i=Sa(i)),t.flags|=1,bs(e,t,r,n),t.child;case 14:return i=va(r=t.type,t.pendingProps),ws(e,t,r,i=va(r.type,i),n);case 15:return Ts(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:va(r,i),js(e,t),t.tag=1,Ni(r)?(e=!0,Oi(t)):e=!1,Ta(t,n),ja(t,r,i),Ha(t,r,i,n),Cs(null,t,r,!0,e,n);case 19:return qs(e,t,n);case 22:return Ss(e,t,n)}throw Error(a(156,t.tag))};var Ql="function"===typeof reportError?reportError:function(e){console.error(e)};function Yl(e){this._internalRoot=e}function Kl(e){this._internalRoot=e}function Zl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $l(){}function ec(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if("function"===typeof i){var s=i;i=function(){var e=Hl(o);s.call(e)}}Gl(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var a=r;r=function(){var e=Hl(o);a.call(e)}}var o=jl(t,r,e,0,null,!1,0,"",$l);return e._reactRootContainer=o,e[pi]=o.current,qr(8===e.nodeType?e.parentNode:e),cl(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var s=r;r=function(){var e=Hl(u);s.call(e)}}var u=zl(e,0,!1,null,0,!1,0,"",$l);return e._reactRootContainer=u,e[pi]=u.current,qr(8===e.nodeType?e.parentNode:e),cl((function(){Gl(t,u,n,r)})),u}(n,t,e,i,r);return Hl(o)}Kl.prototype.render=Yl.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Gl(e,t,null,null)},Kl.prototype.unmount=Yl.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cl((function(){Gl(null,e,null,null)})),t[pi]=null}},Kl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<It.length&&0!==t&&t<It[n].priority;n++);It.splice(n,0,e),0===n&&Ut(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(gt(t,1|n),rl(t,Ze()),0===(6&Mu)&&(qu=Ze()+500,qi()))}break;case 13:cl((function(){var t=Ca(e,1);if(null!==t){var n=el();nl(t,e,1,n)}})),Xl(e,1)}},xt=function(e){if(13===e.tag){var t=Ca(e,134217728);if(null!==t)nl(t,e,134217728,el());Xl(e,134217728)}},wt=function(e){if(13===e.tag){var t=tl(e),n=Ca(e,t);if(null!==n)nl(n,e,t,el());Xl(e,t)}},Tt=function(){return yt},St=function(e,t){var n=yt;try{return yt=e,t()}finally{yt=n}},xe=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=bi(r);if(!i)throw Error(a(90));X(r),J(r,i)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Me=ll,Ce=cl;var tc={usingClientEntryPoint:!1,Events:[yi,_i,bi,Ee,ke,ll]},nc={findFiberByHostInstance:gi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rc={bundleType:nc.bundleType,version:nc.version,rendererPackageName:nc.rendererPackageName,rendererConfig:nc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:nc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ic=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ic.isDisabled&&ic.supportsFiber)try{it=ic.inject(rc),at=ic}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zl(t))throw Error(a(200));return Vl(e,t,null,n)},t.createRoot=function(e,t){if(!Zl(e))throw Error(a(299));var n=!1,r="",i=Ql;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=zl(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,qr(8===e.nodeType?e.parentNode:e),new Yl(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return cl(e)},t.hydrate=function(e,t,n){if(!Jl(t))throw Error(a(200));return ec(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Zl(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",s=Ql;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=jl(t,null,e,1,null!=n?n:null,i,0,o,s),e[pi]=t.current,qr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Kl(t)},t.render=function(e,t,n){if(!Jl(t))throw Error(a(200));return ec(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jl(e))throw Error(a(40));return!!e._reactRootContainer&&(cl((function(){ec(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=ll,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jl(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return ec(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},739:function(e,t,n){"use strict";var r=n(168);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},168:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(534)},939:function(e){var t="undefined"!==typeof Element,n="function"===typeof Map,r="function"===typeof Set,i="function"===typeof ArrayBuffer&&!!ArrayBuffer.isView;function a(e,o){if(e===o)return!0;if(e&&o&&"object"==typeof e&&"object"==typeof o){if(e.constructor!==o.constructor)return!1;var s,u,l,c;if(Array.isArray(e)){if((s=e.length)!=o.length)return!1;for(u=s;0!==u--;)if(!a(e[u],o[u]))return!1;return!0}if(n&&e instanceof Map&&o instanceof Map){if(e.size!==o.size)return!1;for(c=e.entries();!(u=c.next()).done;)if(!o.has(u.value[0]))return!1;for(c=e.entries();!(u=c.next()).done;)if(!a(u.value[1],o.get(u.value[0])))return!1;return!0}if(r&&e instanceof Set&&o instanceof Set){if(e.size!==o.size)return!1;for(c=e.entries();!(u=c.next()).done;)if(!o.has(u.value[0]))return!1;return!0}if(i&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(o)){if((s=e.length)!=o.length)return!1;for(u=s;0!==u--;)if(e[u]!==o[u])return!1;return!0}if(e.constructor===RegExp)return e.source===o.source&&e.flags===o.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===o.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===o.toString();if((s=(l=Object.keys(e)).length)!==Object.keys(o).length)return!1;for(u=s;0!==u--;)if(!Object.prototype.hasOwnProperty.call(o,l[u]))return!1;if(t&&e instanceof Element)return!1;for(u=s;0!==u--;)if(("_owner"!==l[u]&&"__v"!==l[u]&&"__o"!==l[u]||!e.$$typeof)&&!a(e[l[u]],o[l[u]]))return!1;return!0}return e!==e&&o!==o}e.exports=function(e,t){try{return a(e,t)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}}},918:function(e,t,n){"use strict";var r=n(313),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,a={},l=null,c=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,r)&&!u.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:l,ref:c,props:a,_owner:s.current}}t.Fragment=a,t.jsx=l,t.jsxs=l},306:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,v={};function m(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||p}function g(){}function y(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||p}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},g.prototype=m.prototype;var _=y.prototype=new g;_.constructor=y,A(_,m.prototype),_.isPureReactComponent=!0;var b=Array.isArray,x=Object.prototype.hasOwnProperty,w={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,r){var i,a={},o=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)x.call(t,i)&&!T.hasOwnProperty(i)&&(a[i]=t[i]);var u=arguments.length-2;if(1===u)a.children=r;else if(1<u){for(var l=Array(u),c=0;c<u;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(i in u=e.defaultProps)void 0===a[i]&&(a[i]=u[i]);return{$$typeof:n,type:e,key:o,ref:s,props:a,_owner:w.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var k=/\/+/g;function M(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function C(e,t,i,a,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return o=o(u=e),e=""===a?"."+M(u,0):a,b(o)?(i="",null!=e&&(i=e.replace(k,"$&/")+"/"),C(o,t,i,"",(function(e){return e}))):null!=o&&(E(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(k,"$&/")+"/")+e)),t.push(o)),1;if(u=0,a=""===a?".":a+":",b(e))for(var l=0;l<e.length;l++){var c=a+M(s=e[l],l);u+=C(s,t,i,c,o)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),l=0;!(s=e.next()).done;)u+=C(s=s.value,t,i,c=a+M(s,l++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function R(e,t,n){if(null==e)return e;var r=[],i=0;return C(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var N={current:null},I={transition:null},L={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:I,ReactCurrentOwner:w};t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=i,t.Profiler=o,t.PureComponent=y,t.StrictMode=a,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=A({},e.props),a=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=w.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(l in t)x.call(t,l)&&!T.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==u?u[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){u=Array(l);for(var c=0;c<l;c++)u[c]=arguments[c+2];i.children=u}return{$$typeof:n,type:e.type,key:a,ref:o,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=I.transition;I.transition={};try{e()}finally{I.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return N.current.useCallback(e,t)},t.useContext=function(e){return N.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return N.current.useDeferredValue(e)},t.useEffect=function(e,t){return N.current.useEffect(e,t)},t.useId=function(){return N.current.useId()},t.useImperativeHandle=function(e,t,n){return N.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return N.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return N.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return N.current.useMemo(e,t)},t.useReducer=function(e,t,n){return N.current.useReducer(e,t,n)},t.useRef=function(e){return N.current.useRef(e)},t.useState=function(e){return N.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return N.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return N.current.useTransition()},t.version="18.2.0"},313:function(e,t,n){"use strict";e.exports=n(306)},417:function(e,t,n){"use strict";e.exports=n(918)},95:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var s=2*(r+1)-1,u=e[s],l=s+1,c=e[l];if(0>a(u,n))l<i&&0>a(c,u)?(e[r]=c,e[l]=n,r=l):(e[r]=u,e[s]=n,r=s);else{if(!(l<i&&0>a(c,n)))break e;e[r]=c,e[l]=n,r=l}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var l=[],c=[],h=1,f=null,d=3,p=!1,A=!1,v=!1,m="function"===typeof setTimeout?setTimeout:null,g="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function _(e){for(var t=r(c);null!==t;){if(null===t.callback)i(c);else{if(!(t.startTime<=e))break;i(c),t.sortIndex=t.expirationTime,n(l,t)}t=r(c)}}function b(e){if(v=!1,_(e),!A)if(null!==r(l))A=!0,I(x);else{var t=r(c);null!==t&&L(b,t.startTime-e)}}function x(e,n){A=!1,v&&(v=!1,g(E),E=-1),p=!0;var a=d;try{for(_(n),f=r(l);null!==f&&(!(f.expirationTime>n)||e&&!C());){var o=f.callback;if("function"===typeof o){f.callback=null,d=f.priorityLevel;var s=o(f.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?f.callback=s:f===r(l)&&i(l),_(n)}else i(l);f=r(l)}if(null!==f)var u=!0;else{var h=r(c);null!==h&&L(b,h.startTime-n),u=!1}return u}finally{f=null,d=a,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var w,T=!1,S=null,E=-1,k=5,M=-1;function C(){return!(t.unstable_now()-M<k)}function R(){if(null!==S){var e=t.unstable_now();M=e;var n=!0;try{n=S(!0,e)}finally{n?w():(T=!1,S=null)}}else T=!1}if("function"===typeof y)w=function(){y(R)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,N=P.port2;P.port1.onmessage=R,w=function(){N.postMessage(null)}}else w=function(){m(R,0)};function I(e){S=e,T||(T=!0,w())}function L(e,n){E=m((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){A||p||(A=!0,I(x))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},t.unstable_scheduleCallback=function(e,i,a){var o=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?o+a:o:a=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>o?(e.sortIndex=a,n(c,e),null===r(l)&&e===r(c)&&(v?(g(E),E=-1):v=!0,L(b,a-o))):(e.sortIndex=s,n(l,e),A||p||(A=!0,I(x))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}},224:function(e,t,n){"use strict";e.exports=n(95)},767:function(e){e.exports=function(e,t,n,r){var i=n?n.call(r,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!==typeof e||!e||"object"!==typeof t||!t)return!1;var a=Object.keys(e),o=Object.keys(t);if(a.length!==o.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),u=0;u<a.length;u++){var l=a[u];if(!s(l))return!1;var c=e[l],h=t[l];if(!1===(i=n?n.call(r,c,h,l):void 0)||void 0===i&&c!==h)return!1}return!0}},249:function(e,t,n){var r;"undefined"!=typeof self&&self,e.exports=(r=n(313),function(){var e={7403:function(e,t,n){"use strict";n.d(t,{default:function(){return E}});var r=n(4087),i=n.n(r),a=function(e){return new RegExp(/<[a-z][\s\S]*>/i).test(e)},o=function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes},s=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},u="TYPE_CHARACTER",l="REMOVE_CHARACTER",c="REMOVE_ALL",h="REMOVE_LAST_VISIBLE_NODE",f="PAUSE_FOR",d="CALL_FUNCTION",p="ADD_HTML_TAG_ELEMENT",A="CHANGE_DELETE_SPEED",v="CHANGE_DELAY",m="CHANGE_CURSOR",g="PASTE_STRING",y="HTML_TAG";function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=function(){function e(t,n){var _=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),S(this,"state",{cursorAnimation:null,lastFrameTime:null,pauseUntil:null,eventQueue:[],eventLoop:null,eventLoopPaused:!1,reverseCalledEvents:[],calledEvents:[],visibleNodes:[],initialOptions:null,elements:{container:null,wrapper:document.createElement("span"),cursor:document.createElement("span")}}),S(this,"options",{strings:null,cursor:"|",delay:"natural",pauseFor:1500,deleteSpeed:"natural",loop:!1,autoStart:!1,devMode:!1,skipAddStyles:!1,wrapperClassName:"Typewriter__wrapper",cursorClassName:"Typewriter__cursor",stringSplitter:null,onCreateTextNode:null,onRemoveNode:null}),S(this,"setupWrapperElement",(function(){_.state.elements.container&&(_.state.elements.wrapper.className=_.options.wrapperClassName,_.state.elements.cursor.className=_.options.cursorClassName,_.state.elements.cursor.innerHTML=_.options.cursor,_.state.elements.container.innerHTML="",_.state.elements.container.appendChild(_.state.elements.wrapper),_.state.elements.container.appendChild(_.state.elements.cursor))})),S(this,"start",(function(){return _.state.eventLoopPaused=!1,_.runEventLoop(),_})),S(this,"pause",(function(){return _.state.eventLoopPaused=!0,_})),S(this,"stop",(function(){return _.state.eventLoop&&((0,r.cancel)(_.state.eventLoop),_.state.eventLoop=null),_})),S(this,"pauseFor",(function(e){return _.addEventToQueue(f,{ms:e}),_})),S(this,"typeOutAllStrings",(function(){return"string"==typeof _.options.strings?(_.typeString(_.options.strings).pauseFor(_.options.pauseFor),_):(_.options.strings.forEach((function(e){_.typeString(e).pauseFor(_.options.pauseFor).deleteAll(_.options.deleteSpeed)})),_)})),S(this,"typeString",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(a(e))return _.typeOutHTMLString(e,t);if(e){var n=(_.options||{}).stringSplitter,r="function"==typeof n?n(e):e.split("");_.typeCharacters(r,t)}return _})),S(this,"pasteString",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return a(e)?_.typeOutHTMLString(e,t,!0):(e&&_.addEventToQueue(g,{character:e,node:t}),_)})),S(this,"typeOutHTMLString",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,r=o(e);if(r.length>0)for(var i=0;i<r.length;i++){var a=r[i],s=a.innerHTML;a&&3!==a.nodeType?(a.innerHTML="",_.addEventToQueue(p,{node:a,parentNode:t}),n?_.pasteString(s,a):_.typeString(s,a)):a.textContent&&(n?_.pasteString(a.textContent,t):_.typeString(a.textContent,t))}return _})),S(this,"deleteAll",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"natural";return _.addEventToQueue(c,{speed:e}),_})),S(this,"changeDeleteSpeed",(function(e){if(!e)throw new Error("Must provide new delete speed");return _.addEventToQueue(A,{speed:e}),_})),S(this,"changeDelay",(function(e){if(!e)throw new Error("Must provide new delay");return _.addEventToQueue(v,{delay:e}),_})),S(this,"changeCursor",(function(e){if(!e)throw new Error("Must provide new cursor");return _.addEventToQueue(m,{cursor:e}),_})),S(this,"deleteChars",(function(e){if(!e)throw new Error("Must provide amount of characters to delete");for(var t=0;t<e;t++)_.addEventToQueue(l);return _})),S(this,"callFunction",(function(e,t){if(!e||"function"!=typeof e)throw new Error("Callbak must be a function");return _.addEventToQueue(d,{cb:e,thisArg:t}),_})),S(this,"typeCharacters",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e||!Array.isArray(e))throw new Error("Characters must be an array");return e.forEach((function(e){_.addEventToQueue(u,{character:e,node:t})})),_})),S(this,"removeCharacters",(function(e){if(!e||!Array.isArray(e))throw new Error("Characters must be an array");return e.forEach((function(){_.addEventToQueue(l)})),_})),S(this,"addEventToQueue",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return _.addEventToStateProperty(e,t,n,"eventQueue")})),S(this,"addReverseCalledEvent",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return _.options.loop?_.addEventToStateProperty(e,t,n,"reverseCalledEvents"):_})),S(this,"addEventToStateProperty",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i={eventName:e,eventArgs:t||{}};return _.state[r]=n?[i].concat(x(_.state[r])):[].concat(x(_.state[r]),[i]),_})),S(this,"runEventLoop",(function(){_.state.lastFrameTime||(_.state.lastFrameTime=Date.now());var e=Date.now(),t=e-_.state.lastFrameTime;if(!_.state.eventQueue.length){if(!_.options.loop)return;_.state.eventQueue=x(_.state.calledEvents),_.state.calledEvents=[],_.options=b({},_.state.initialOptions)}if(_.state.eventLoop=i()(_.runEventLoop),!_.state.eventLoopPaused){if(_.state.pauseUntil){if(e<_.state.pauseUntil)return;_.state.pauseUntil=null}var n,r=x(_.state.eventQueue),a=r.shift();if(!(t<=(n=a.eventName===h||a.eventName===l?"natural"===_.options.deleteSpeed?s(40,80):_.options.deleteSpeed:"natural"===_.options.delay?s(120,160):_.options.delay))){var o=a.eventName,w=a.eventArgs;switch(_.logInDevMode({currentEvent:a,state:_.state,delay:n}),o){case g:case u:var T=w.character,S=w.node,E=document.createTextNode(T),k=E;_.options.onCreateTextNode&&"function"==typeof _.options.onCreateTextNode&&(k=_.options.onCreateTextNode(T,E)),k&&(S?S.appendChild(k):_.state.elements.wrapper.appendChild(k)),_.state.visibleNodes=[].concat(x(_.state.visibleNodes),[{type:"TEXT_NODE",character:T,node:k}]);break;case l:r.unshift({eventName:h,eventArgs:{removingCharacterNode:!0}});break;case f:var M=a.eventArgs.ms;_.state.pauseUntil=Date.now()+parseInt(M);break;case d:var C=a.eventArgs,R=C.cb,P=C.thisArg;R.call(P,{elements:_.state.elements});break;case p:var N=a.eventArgs,I=N.node,L=N.parentNode;L?L.appendChild(I):_.state.elements.wrapper.appendChild(I),_.state.visibleNodes=[].concat(x(_.state.visibleNodes),[{type:y,node:I,parentNode:L||_.state.elements.wrapper}]);break;case c:var D=_.state.visibleNodes,O=w.speed,U=[];O&&U.push({eventName:A,eventArgs:{speed:O,temp:!0}});for(var B=0,F=D.length;B<F;B++)U.push({eventName:h,eventArgs:{removingCharacterNode:!1}});O&&U.push({eventName:A,eventArgs:{speed:_.options.deleteSpeed,temp:!0}}),r.unshift.apply(r,U);break;case h:var z=a.eventArgs.removingCharacterNode;if(_.state.visibleNodes.length){var V=_.state.visibleNodes.pop(),q=V.type,j=V.node,G=V.character;_.options.onRemoveNode&&"function"==typeof _.options.onRemoveNode&&_.options.onRemoveNode({node:j,character:G}),j&&j.parentNode.removeChild(j),q===y&&z&&r.unshift({eventName:h,eventArgs:{}})}break;case A:_.options.deleteSpeed=a.eventArgs.speed;break;case v:_.options.delay=a.eventArgs.delay;break;case m:_.options.cursor=a.eventArgs.cursor,_.state.elements.cursor.innerHTML=a.eventArgs.cursor}_.options.loop&&(a.eventName===h||a.eventArgs&&a.eventArgs.temp||(_.state.calledEvents=[].concat(x(_.state.calledEvents),[a]))),_.state.eventQueue=r,_.state.lastFrameTime=e}}})),t)if("string"==typeof t){var w=document.querySelector(t);if(!w)throw new Error("Could not find container element");this.state.elements.container=w}else this.state.elements.container=t;n&&(this.options=b(b({},this.options),n)),this.state.initialOptions=b({},this.options),this.init()}var t,n;return t=e,(n=[{key:"init",value:function(){var e,t;this.setupWrapperElement(),this.addEventToQueue(m,{cursor:this.options.cursor},!0),this.addEventToQueue(c,null,!0),!window||window.___TYPEWRITER_JS_STYLES_ADDED___||this.options.skipAddStyles||(e=".Typewriter__cursor{-webkit-animation:Typewriter-cursor 1s infinite;animation:Typewriter-cursor 1s infinite;margin-left:1px}@-webkit-keyframes Typewriter-cursor{0%{opacity:0}50%{opacity:1}100%{opacity:0}}@keyframes Typewriter-cursor{0%{opacity:0}50%{opacity:1}100%{opacity:0}}",(t=document.createElement("style")).appendChild(document.createTextNode(e)),document.head.appendChild(t),window.___TYPEWRITER_JS_STYLES_ADDED___=!0),!0===this.options.autoStart&&this.options.strings&&this.typeOutAllStrings().start()}},{key:"logInDevMode",value:function(e){this.options.devMode&&console.log(e)}}])&&T(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},8552:function(e,t,n){var r=n(852)(n(5639),"DataView");e.exports=r},1989:function(e,t,n){var r=n(1789),i=n(401),a=n(7667),o=n(1327),s=n(1866);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=a,u.prototype.has=o,u.prototype.set=s,e.exports=u},8407:function(e,t,n){var r=n(7040),i=n(4125),a=n(2117),o=n(7518),s=n(4705);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=a,u.prototype.has=o,u.prototype.set=s,e.exports=u},7071:function(e,t,n){var r=n(852)(n(5639),"Map");e.exports=r},3369:function(e,t,n){var r=n(4785),i=n(1285),a=n(6e3),o=n(9916),s=n(5265);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=a,u.prototype.has=o,u.prototype.set=s,e.exports=u},3818:function(e,t,n){var r=n(852)(n(5639),"Promise");e.exports=r},8525:function(e,t,n){var r=n(852)(n(5639),"Set");e.exports=r},8668:function(e,t,n){var r=n(3369),i=n(619),a=n(2385);function o(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}o.prototype.add=o.prototype.push=i,o.prototype.has=a,e.exports=o},6384:function(e,t,n){var r=n(8407),i=n(7465),a=n(3779),o=n(7599),s=n(4758),u=n(4309);function l(e){var t=this.__data__=new r(e);this.size=t.size}l.prototype.clear=i,l.prototype.delete=a,l.prototype.get=o,l.prototype.has=s,l.prototype.set=u,e.exports=l},2705:function(e,t,n){var r=n(5639).Symbol;e.exports=r},1149:function(e,t,n){var r=n(5639).Uint8Array;e.exports=r},577:function(e,t,n){var r=n(852)(n(5639),"WeakMap");e.exports=r},4963:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a}},4636:function(e,t,n){var r=n(2545),i=n(5694),a=n(1469),o=n(4144),s=n(5776),u=n(6719),l=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=a(e),c=!n&&i(e),h=!n&&!c&&o(e),f=!n&&!c&&!h&&u(e),d=n||c||h||f,p=d?r(e.length,String):[],A=p.length;for(var v in e)!t&&!l.call(e,v)||d&&("length"==v||h&&("offset"==v||"parent"==v)||f&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||s(v,A))||p.push(v);return p}},2488:function(e){e.exports=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}},2908:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},8470:function(e,t,n){var r=n(7813);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},8866:function(e,t,n){var r=n(2488),i=n(1469);e.exports=function(e,t,n){var a=t(e);return i(e)?a:r(a,n(e))}},4239:function(e,t,n){var r=n(2705),i=n(9607),a=n(2333),o=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?i(e):a(e)}},9454:function(e,t,n){var r=n(4239),i=n(7005);e.exports=function(e){return i(e)&&"[object Arguments]"==r(e)}},939:function(e,t,n){var r=n(2492),i=n(7005);e.exports=function e(t,n,a,o,s){return t===n||(null==t||null==n||!i(t)&&!i(n)?t!=t&&n!=n:r(t,n,a,o,e,s))}},2492:function(e,t,n){var r=n(6384),i=n(7114),a=n(8351),o=n(6096),s=n(4160),u=n(1469),l=n(4144),c=n(6719),h="[object Arguments]",f="[object Array]",d="[object Object]",p=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,A,v,m){var g=u(e),y=u(t),_=g?f:s(e),b=y?f:s(t),x=(_=_==h?d:_)==d,w=(b=b==h?d:b)==d,T=_==b;if(T&&l(e)){if(!l(t))return!1;g=!0,x=!1}if(T&&!x)return m||(m=new r),g||c(e)?i(e,t,n,A,v,m):a(e,t,_,n,A,v,m);if(!(1&n)){var S=x&&p.call(e,"__wrapped__"),E=w&&p.call(t,"__wrapped__");if(S||E){var k=S?e.value():e,M=E?t.value():t;return m||(m=new r),v(k,M,n,A,m)}}return!!T&&(m||(m=new r),o(e,t,n,A,v,m))}},8458:function(e,t,n){var r=n(3560),i=n(5346),a=n(3218),o=n(346),s=/^\[object .+?Constructor\]$/,u=Function.prototype,l=Object.prototype,c=u.toString,h=l.hasOwnProperty,f=RegExp("^"+c.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!a(e)||i(e))&&(r(e)?f:s).test(o(e))}},8749:function(e,t,n){var r=n(4239),i=n(1780),a=n(7005),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,e.exports=function(e){return a(e)&&i(e.length)&&!!o[r(e)]}},280:function(e,t,n){var r=n(5726),i=n(6916),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))a.call(e,n)&&"constructor"!=n&&t.push(n);return t}},2545:function(e){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},1717:function(e){e.exports=function(e){return function(t){return e(t)}}},4757:function(e){e.exports=function(e,t){return e.has(t)}},4429:function(e,t,n){var r=n(5639)["__core-js_shared__"];e.exports=r},7114:function(e,t,n){var r=n(8668),i=n(2908),a=n(4757);e.exports=function(e,t,n,o,s,u){var l=1&n,c=e.length,h=t.length;if(c!=h&&!(l&&h>c))return!1;var f=u.get(e),d=u.get(t);if(f&&d)return f==t&&d==e;var p=-1,A=!0,v=2&n?new r:void 0;for(u.set(e,t),u.set(t,e);++p<c;){var m=e[p],g=t[p];if(o)var y=l?o(g,m,p,t,e,u):o(m,g,p,e,t,u);if(void 0!==y){if(y)continue;A=!1;break}if(v){if(!i(t,(function(e,t){if(!a(v,t)&&(m===e||s(m,e,n,o,u)))return v.push(t)}))){A=!1;break}}else if(m!==g&&!s(m,g,n,o,u)){A=!1;break}}return u.delete(e),u.delete(t),A}},8351:function(e,t,n){var r=n(2705),i=n(1149),a=n(7813),o=n(7114),s=n(8776),u=n(1814),l=r?r.prototype:void 0,c=l?l.valueOf:void 0;e.exports=function(e,t,n,r,l,h,f){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!h(new i(e),new i(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var d=s;case"[object Set]":var p=1&r;if(d||(d=u),e.size!=t.size&&!p)return!1;var A=f.get(e);if(A)return A==t;r|=2,f.set(e,t);var v=o(d(e),d(t),r,l,h,f);return f.delete(e),v;case"[object Symbol]":if(c)return c.call(e)==c.call(t)}return!1}},6096:function(e,t,n){var r=n(8234),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,a,o,s){var u=1&n,l=r(e),c=l.length;if(c!=r(t).length&&!u)return!1;for(var h=c;h--;){var f=l[h];if(!(u?f in t:i.call(t,f)))return!1}var d=s.get(e),p=s.get(t);if(d&&p)return d==t&&p==e;var A=!0;s.set(e,t),s.set(t,e);for(var v=u;++h<c;){var m=e[f=l[h]],g=t[f];if(a)var y=u?a(g,m,f,t,e,s):a(m,g,f,e,t,s);if(!(void 0===y?m===g||o(m,g,n,a,s):y)){A=!1;break}v||(v="constructor"==f)}if(A&&!v){var _=e.constructor,b=t.constructor;_==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof b&&b instanceof b||(A=!1)}return s.delete(e),s.delete(t),A}},1957:function(e,t,n){var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},8234:function(e,t,n){var r=n(8866),i=n(9551),a=n(3674);e.exports=function(e){return r(e,a,i)}},5050:function(e,t,n){var r=n(7019);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},852:function(e,t,n){var r=n(8458),i=n(7801);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},9607:function(e,t,n){var r=n(2705),i=Object.prototype,a=i.hasOwnProperty,o=i.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=a.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var i=o.call(e);return r&&(t?e[s]=n:delete e[s]),i}},9551:function(e,t,n){var r=n(4963),i=n(479),a=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,s=o?function(e){return null==e?[]:(e=Object(e),r(o(e),(function(t){return a.call(e,t)})))}:i;e.exports=s},4160:function(e,t,n){var r=n(8552),i=n(7071),a=n(3818),o=n(8525),s=n(577),u=n(4239),l=n(346),c="[object Map]",h="[object Promise]",f="[object Set]",d="[object WeakMap]",p="[object DataView]",A=l(r),v=l(i),m=l(a),g=l(o),y=l(s),_=u;(r&&_(new r(new ArrayBuffer(1)))!=p||i&&_(new i)!=c||a&&_(a.resolve())!=h||o&&_(new o)!=f||s&&_(new s)!=d)&&(_=function(e){var t=u(e),n="[object Object]"==t?e.constructor:void 0,r=n?l(n):"";if(r)switch(r){case A:return p;case v:return c;case m:return h;case g:return f;case y:return d}return t}),e.exports=_},7801:function(e){e.exports=function(e,t){return null==e?void 0:e[t]}},1789:function(e,t,n){var r=n(4536);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},401:function(e){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},7667:function(e,t,n){var r=n(4536),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},1327:function(e,t,n){var r=n(4536),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},1866:function(e,t,n){var r=n(4536);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},5776:function(e){var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var r=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&t.test(e))&&e>-1&&e%1==0&&e<n}},7019:function(e){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},5346:function(e,t,n){var r,i=n(4429),a=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!a&&a in e}},5726:function(e){var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},7040:function(e){e.exports=function(){this.__data__=[],this.size=0}},4125:function(e,t,n){var r=n(8470),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():i.call(t,n,1),--this.size,0))}},2117:function(e,t,n){var r=n(8470);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},7518:function(e,t,n){var r=n(8470);e.exports=function(e){return r(this.__data__,e)>-1}},4705:function(e,t,n){var r=n(8470);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},4785:function(e,t,n){var r=n(1989),i=n(8407),a=n(7071);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(a||i),string:new r}}},1285:function(e,t,n){var r=n(5050);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},6e3:function(e,t,n){var r=n(5050);e.exports=function(e){return r(this,e).get(e)}},9916:function(e,t,n){var r=n(5050);e.exports=function(e){return r(this,e).has(e)}},5265:function(e,t,n){var r=n(5050);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},8776:function(e){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},4536:function(e,t,n){var r=n(852)(Object,"create");e.exports=r},6916:function(e,t,n){var r=n(5569)(Object.keys,Object);e.exports=r},1167:function(e,t,n){e=n.nmd(e);var r=n(1957),i=t&&!t.nodeType&&t,a=i&&e&&!e.nodeType&&e,o=a&&a.exports===i&&r.process,s=function(){try{return a&&a.require&&a.require("util").types||o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=s},2333:function(e){var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},5569:function(e){e.exports=function(e,t){return function(n){return e(t(n))}}},5639:function(e,t,n){var r=n(1957),i="object"==typeof self&&self&&self.Object===Object&&self,a=r||i||Function("return this")();e.exports=a},619:function(e){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},2385:function(e){e.exports=function(e){return this.__data__.has(e)}},1814:function(e){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},7465:function(e,t,n){var r=n(8407);e.exports=function(){this.__data__=new r,this.size=0}},3779:function(e){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},7599:function(e){e.exports=function(e){return this.__data__.get(e)}},4758:function(e){e.exports=function(e){return this.__data__.has(e)}},4309:function(e,t,n){var r=n(8407),i=n(7071),a=n(3369);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var o=n.__data__;if(!i||o.length<199)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new a(o)}return n.set(e,t),this.size=n.size,this}},346:function(e){var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},7813:function(e){e.exports=function(e,t){return e===t||e!=e&&t!=t}},5694:function(e,t,n){var r=n(9454),i=n(7005),a=Object.prototype,o=a.hasOwnProperty,s=a.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(e){return i(e)&&o.call(e,"callee")&&!s.call(e,"callee")};e.exports=u},1469:function(e){var t=Array.isArray;e.exports=t},8612:function(e,t,n){var r=n(3560),i=n(1780);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},4144:function(e,t,n){e=n.nmd(e);var r=n(5639),i=n(5062),a=t&&!t.nodeType&&t,o=a&&e&&!e.nodeType&&e,s=o&&o.exports===a?r.Buffer:void 0,u=(s?s.isBuffer:void 0)||i;e.exports=u},8446:function(e,t,n){var r=n(939);e.exports=function(e,t){return r(e,t)}},3560:function(e,t,n){var r=n(4239),i=n(3218);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},1780:function(e){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},3218:function(e){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},7005:function(e){e.exports=function(e){return null!=e&&"object"==typeof e}},6719:function(e,t,n){var r=n(8749),i=n(1717),a=n(1167),o=a&&a.isTypedArray,s=o?i(o):r;e.exports=s},3674:function(e,t,n){var r=n(4636),i=n(280),a=n(8612);e.exports=function(e){return a(e)?r(e):i(e)}},479:function(e){e.exports=function(){return[]}},5062:function(e){e.exports=function(){return!1}},75:function(e){(function(){var t,n,r,i,a,o;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(e.exports=function(){return(t()-a)/1e6},n=process.hrtime,i=(t=function(){var e;return 1e9*(e=n())[0]+e[1]})(),o=1e9*process.uptime(),a=i-o):Date.now?(e.exports=function(){return Date.now()-r},r=Date.now()):(e.exports=function(){return(new Date).getTime()-r},r=(new Date).getTime())}).call(this)},4087:function(e,t,n){for(var r=n(75),i="undefined"==typeof window?n.g:window,a=["moz","webkit"],o="AnimationFrame",s=i["request"+o],u=i["cancel"+o]||i["cancelRequest"+o],l=0;!s&&l<a.length;l++)s=i[a[l]+"Request"+o],u=i[a[l]+"Cancel"+o]||i[a[l]+"CancelRequest"+o];if(!s||!u){var c=0,h=0,f=[];s=function(e){if(0===f.length){var t=r(),n=Math.max(0,16.666666666666668-(t-c));c=n+t,setTimeout((function(){var e=f.slice(0);f.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(c)}catch(e){setTimeout((function(){throw e}),0)}}),Math.round(n))}return f.push({handle:++h,callback:e,cancelled:!1}),h},u=function(e){for(var t=0;t<f.length;t++)f[t].handle===e&&(f[t].cancelled=!0)}}e.exports=function(e){return s.call(i,e)},e.exports.cancel=function(){u.apply(i,arguments)},e.exports.polyfill=function(e){e||(e=i),e.requestAnimationFrame=s,e.cancelAnimationFrame=u}},8156:function(e){"use strict";e.exports=r}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(r){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e};var i={};return function(){"use strict";n.d(i,{default:function(){return v}});var e=n(8156),t=n.n(e),r=n(7403),a=n(8446),o=n.n(a);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function h(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(v,e);var n,i,a,s,A=(a=v,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(a);if(s){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return h(this,e)});function v(){var e;u(this,v);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return p(f(e=A.call.apply(A,[this].concat(n))),"state",{instance:null}),e}return n=v,(i=[{key:"componentDidMount",value:function(){var e=this,t=new r.default(this.typewriter,this.props.options);this.setState({instance:t},(function(){var n=e.props.onInit;n&&n(t)}))}},{key:"componentDidUpdate",value:function(e){o()(this.props.options,e.options)||this.setState({instance:new r.default(this.typewriter,this.props.options)})}},{key:"componentWillUnmount",value:function(){this.state.instance&&this.state.instance.stop()}},{key:"render",value:function(){var e=this,n=this.props.component;return t().createElement(n,{ref:function(t){return e.typewriter=t},className:"Typewriter","data-testid":"typewriter-wrapper"})}}])&&l(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),v}(e.Component);A.defaultProps={component:"div"};var v=A}(),i.default}())}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var a=Object.create(null);n.r(a);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){o[e]=function(){return r[e]}}));return o.default=function(){return r},n.d(a,o),a}}(),n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){"use strict";var e={};n.r(e),n.d(e,{computeMikkTSpaceTangents:function(){return Kp},computeMorphedAttributes:function(){return oA},deepCloneAttribute:function(){return $p},deinterleaveAttribute:function(){return tA},deinterleaveGeometry:function(){return nA},estimateBytesUsed:function(){return rA},interleaveAttributes:function(){return eA},mergeAttributes:function(){return Jp},mergeGeometries:function(){return Zp},mergeGroups:function(){return sA},mergeVertices:function(){return iA},toCreasedNormals:function(){return uA},toTrianglesDrawMode:function(){return aA}});var t,r=n(313),i=n.t(r,2),a=n(739);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function u(e,t){if(e){if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function l(e){return function(e){if(Array.isArray(e))return o(e)}(e)||s(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function f(e){var t=function(e,t){if("object"!==h(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===h(t)?t:String(t)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function p(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function A(e,t){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},A(e,t)}function v(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A(e,t)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function g(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(p0){return!1}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e,t){if(t&&("object"===h(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}function b(e){var t=g();return function(){var n,r=m(e);if(t){var i=m(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _(this,n)}}function x(e){if(Array.isArray(e))return e}function w(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function T(e,t){return x(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(e,t)||u(e,t)||w()}function S(e,t,n){return S=g()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&A(i,n.prototype),i},S.apply(null,arguments)}function E(e){var t="function"===typeof Map?new Map:void 0;return E=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return S(e,arguments,m(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),A(r,e)},E(e)}function k(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=u(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function M(){return M=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},M.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(t||(t={}));var C,R="popstate";function P(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function N(e){return{usr:e.state,key:e.key}}function I(e,t,n,r){return void 0===n&&(n=null),M({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?D(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function L(e){var t=e.pathname,n=void 0===t?"/":t,r=e.search,i=void 0===r?"":r,a=e.hash,o=void 0===a?"":a;return i&&"?"!==i&&(n+="?"===i.charAt(0)?i:"?"+i),o&&"#"!==o&&(n+="#"===o.charAt(0)?o:"#"+o),n}function D(e){var t={};if(e){var n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));var r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function O(e){var t="undefined"!==typeof window&&"undefined"!==typeof window.location&&"null"!==window.location.origin?window.location.origin:window.location.href,n="string"===typeof e?e:L(e);return P(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}function U(e,n,r,i){void 0===i&&(i={});var a=i,o=a.window,s=void 0===o?document.defaultView:o,u=a.v5Compat,l=void 0!==u&&u,c=s.history,h=t.Pop,f=null;function d(){h=t.Pop,f&&f({action:h,location:p.location})}var p={get action(){return h},get location(){return e(s,c)},listen:function(e){if(f)throw new Error("A history only accepts one active listener");return s.addEventListener(R,d),f=e,function(){s.removeEventListener(R,d),f=null}},createHref:function(e){return n(s,e)},encodeLocation:function(e){var t=O("string"===typeof e?e:L(e));return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,n){h=t.Push;var i=I(p.location,e,n);r&&r(i,e);var a=N(i),o=p.createHref(i);try{c.pushState(a,"",o)}catch(u){s.location.assign(o)}l&&f&&f({action:h,location:p.location})},replace:function(e,n){h=t.Replace;var i=I(p.location,e,n);r&&r(i,e);var a=N(i),o=p.createHref(i);c.replaceState(a,"",o),l&&f&&f({action:h,location:p.location})},go:function(e){return c.go(e)}};return p}function B(e,t,n){void 0===n&&(n="/");var r=X(("string"===typeof t?D(t):t).pathname||"/",n);if(null==r)return null;var i=F(e);!function(e){e.sort((function(e,t){return e.score!==t.score?t.score-e.score:function(e,t){var n=e.length===t.length&&e.slice(0,-1).every((function(e,n){return e===t[n]}));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((function(e){return e.childrenIndex})),t.routesMeta.map((function(e){return e.childrenIndex})))}))}(i);for(var a=null,o=0;null==a&&o<i.length;++o)a=G(i[o],W(r));return a}function F(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");var i=function(e,i,a){var o={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};o.relativePath.startsWith("/")&&(P(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));var s=J([r,o.relativePath]),u=n.concat(o);e.children&&e.children.length>0&&(P(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),F(e.children,t,u,s)),(null!=e.path||e.index)&&t.push({path:s,score:j(s,e.index),routesMeta:u})};return e.forEach((function(e,t){var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?")){var r,a=k(z(e.path));try{for(a.s();!(r=a.n()).done;){var o=r.value;i(e,t,o)}}catch(s){a.e(s)}finally{a.f()}}else i(e,t)})),t}function z(e){var t=e.split("/");if(0===t.length)return[];var n,r=x(n=t)||s(n)||u(n)||w(),i=r[0],a=r.slice(1),o=i.endsWith("?"),c=i.replace(/\?$/,"");if(0===a.length)return o?[c,""]:[c];var h=z(a.join("/")),f=[];return f.push.apply(f,l(h.map((function(e){return""===e?c:[c,e].join("/")})))),o&&f.push.apply(f,l(h)),f.map((function(t){return e.startsWith("/")&&""===t?"/":t}))}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(C||(C={}));var V=/^:\w+$/,q=function(e){return"*"===e};function j(e,t){var n=e.split("/"),r=n.length;return n.some(q)&&(r+=-2),t&&(r+=2),n.filter((function(e){return!q(e)})).reduce((function(e,t){return e+(V.test(t)?3:""===t?1:10)}),r)}function G(e,t){for(var n=e.routesMeta,r={},i="/",a=[],o=0;o<n.length;++o){var s=n[o],u=o===n.length-1,l="/"===i?t:t.slice(i.length)||"/",c=H({path:s.relativePath,caseSensitive:s.caseSensitive,end:u},l);if(!c)return null;Object.assign(r,c.params);var h=s.route;a.push({params:r,pathname:J([i,c.pathname]),pathnameBase:$(J([i,c.pathnameBase])),route:h}),"/"!==c.pathnameBase&&(i=J([i,c.pathnameBase]))}return a}function H(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});var n=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);Q("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');var r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(function(e,t){return r.push(t),"/([^\\/]+)"}));e.endsWith("*")?(r.push("*"),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");var a=new RegExp(i,t?void 0:"i");return[a,r]}(e.path,e.caseSensitive,e.end),r=T(n,2),i=r[0],a=r[1],o=t.match(i);if(!o)return null;var s=o[0],u=s.replace(/(.)\/+$/,"$1"),l=o.slice(1),c=a.reduce((function(e,t,n){if("*"===t){var r=l[n]||"";u=s.slice(0,s.length-r.length).replace(/(.)\/+$/,"$1")}return e[t]=function(e,t){try{return decodeURIComponent(e)}catch(n){return Q(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+n+")."),e}}(l[n]||"",t),e}),{});return{params:c,pathname:s,pathnameBase:u,pattern:e}}function W(e){try{return decodeURI(e)}catch(t){return Q(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function X(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;var n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function Q(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(p0){}}}function Y(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function K(e){return e.filter((function(e,t){return 0===t||e.route.path&&e.route.path.length>0}))}function Z(e,t,n,r){var i;void 0===r&&(r=!1),"string"===typeof e?i=D(e):(P(!(i=M({},e)).pathname||!i.pathname.includes("?"),Y("?","pathname","search",i)),P(!i.pathname||!i.pathname.includes("#"),Y("#","pathname","hash",i)),P(!i.search||!i.search.includes("#"),Y("#","search","hash",i)));var a,o=""===e||""===i.pathname,s=o?"/":i.pathname;if(r||null==s)a=n;else{var u=t.length-1;if(s.startsWith("..")){for(var l=s.split("/");".."===l[0];)l.shift(),u-=1;i.pathname=l.join("/")}a=u>=0?t[u]:"/"}var c=function(e,t){void 0===t&&(t="/");var n="string"===typeof e?D(e):e,r=n.pathname,i=n.search,a=void 0===i?"":i,o=n.hash,s=void 0===o?"":o,u=r?r.startsWith("/")?r:function(e,t){var n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((function(e){".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(r,t):t;return{pathname:u,search:ee(a),hash:te(s)}}(i,a),h=s&&"/"!==s&&s.endsWith("/"),f=(o||"."===s)&&n.endsWith("/");return c.pathname.endsWith("/")||!h&&!f||(c.pathname+="/"),c}var J=function(e){return e.join("/").replace(/\/\/+/g,"/")},$=function(e){return e.replace(/\/+$/,"").replace(/^\/*/,"/")},ee=function(e){return e&&"?"!==e?e.startsWith("?")?e:"?"+e:""},te=function(e){return e&&"#"!==e?e.startsWith("#")?e:"#"+e:""},ne=function(e){v(n,e);var t=b(n);function n(){return c(this,n),t.apply(this,arguments)}return p(n)}(E(Error));var re=p((function e(t,n,r,i){c(this,e),void 0===i&&(i=!1),this.status=t,this.statusText=n||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}));function ie(e){return e instanceof re}var ae=["post","put","patch","delete"],oe=(new Set(ae),["get"].concat(ae));new Set(oe),new Set([301,302,303,307,308]),new Set([307,308]),"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;function se(){return se=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},se.apply(this,arguments)}var ue="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},le=r.useState,ce=r.useEffect,he=r.useLayoutEffect,fe=r.useDebugValue;function de(e){var t=e.getSnapshot,n=e.value;try{var r=t();return!ue(n,r)}catch(i){return!0}}"undefined"===typeof window||"undefined"===typeof window.document||window.document.createElement,i.useSyncExternalStore;var pe=r.createContext(null);var Ae=r.createContext(null);var ve=r.createContext(null);var me=r.createContext(null);var ge=r.createContext(null);var ye=r.createContext({outlet:null,matches:[]});var _e=r.createContext(null);function be(){return null!=r.useContext(ge)}function xe(){return be()||P(!1),r.useContext(ge).location}function we(){be()||P(!1);var e=r.useContext(me),t=e.basename,n=e.navigator,i=r.useContext(ye).matches,a=xe().pathname,o=JSON.stringify(K(i).map((function(e){return e.pathnameBase}))),s=r.useRef(!1);r.useEffect((function(){s.current=!0}));var u=r.useCallback((function(e,r){if(void 0===r&&(r={}),s.current)if("number"!==typeof e){var i=Z(e,JSON.parse(o),a,"path"===r.relative);"/"!==t&&(i.pathname="/"===i.pathname?t:J([t,i.pathname])),(r.replace?n.replace:n.push)(i,r.state,r)}else n.go(e)}),[t,n,o,a]);return u}function Te(e,t){var n=(void 0===t?{}:t).relative,i=r.useContext(ye).matches,a=xe().pathname,o=JSON.stringify(K(i).map((function(e){return e.pathnameBase})));return r.useMemo((function(){return Z(e,JSON.parse(o),a,"path"===n)}),[e,o,a,n])}function Se(){var e=function(){var e,t=r.useContext(_e),n=Pe(ke.UseRouteError),i=Ne(ke.UseRouteError);if(t)return t;return null==(e=n.errors)?void 0:e[i]}(),t=ie(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},o={padding:"2px 4px",backgroundColor:i};return r.createElement(r.Fragment,null,r.createElement("h2",null,"Unhandled Thrown Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),n?r.createElement("pre",{style:a},n):null,r.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),r.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own\xa0",r.createElement("code",{style:o},"errorElement")," props on\xa0",r.createElement("code",{style:o},"<Route>")))}var Ee,ke,Me=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,e)).state={location:e.location,error:e.error},r}return p(n,[{key:"componentDidCatch",value:function(e,t){console.error("React Router caught the following error during render",e,t)}},{key:"render",value:function(){return this.state.error?r.createElement(ye.Provider,{value:this.props.routeContext},r.createElement(_e.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}},{key:"getDerivedStateFromProps",value:function(e,t){return t.location!==e.location?{error:e.error,location:e.location}:{error:e.error||t.error,location:t.location}}}]),n}(r.Component);function Ce(e){var t=e.routeContext,n=e.match,i=e.children,a=r.useContext(pe);return a&&a.static&&a.staticContext&&n.route.errorElement&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),r.createElement(ye.Provider,{value:t},i)}function Re(e,t,n){if(void 0===t&&(t=[]),null==e){if(null==n||!n.errors)return null;e=n.matches}var i=e,a=null==n?void 0:n.errors;if(null!=a){var o=i.findIndex((function(e){return e.route.id&&(null==a?void 0:a[e.route.id])}));o>=0||P(!1),i=i.slice(0,Math.min(i.length,o+1))}return i.reduceRight((function(e,o,s){var u=o.route.id?null==a?void 0:a[o.route.id]:null,l=n?o.route.errorElement||r.createElement(Se,null):null,c=t.concat(i.slice(0,s+1)),h=function(){return r.createElement(Ce,{match:o,routeContext:{outlet:e,matches:c}},u?l:void 0!==o.route.element?o.route.element:e)};return n&&(o.route.errorElement||0===s)?r.createElement(Me,{location:n.location,component:l,error:u,children:h(),routeContext:{outlet:null,matches:c}}):h()}),null)}function Pe(e){var t=r.useContext(Ae);return t||P(!1),t}function Ne(e){var t=function(e){var t=r.useContext(ye);return t||P(!1),t}(),n=t.matches[t.matches.length-1];return n.route.id||P(!1),n.route.id}!function(e){e.UseRevalidator="useRevalidator"}(Ee||(Ee={})),function(e){e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator"}(ke||(ke={}));var Ie;function Le(e){P(!1)}function De(e){var n=e.basename,i=void 0===n?"/":n,a=e.children,o=void 0===a?null:a,s=e.location,u=e.navigationType,l=void 0===u?t.Pop:u,c=e.navigator,h=e.static,f=void 0!==h&&h;be()&&P(!1);var d=i.replace(/^\/*/,"/"),p=r.useMemo((function(){return{basename:d,navigator:c,static:f}}),[d,c,f]);"string"===typeof s&&(s=D(s));var A=s,v=A.pathname,m=void 0===v?"/":v,g=A.search,y=void 0===g?"":g,_=A.hash,b=void 0===_?"":_,x=A.state,w=void 0===x?null:x,T=A.key,S=void 0===T?"default":T,E=r.useMemo((function(){var e=X(m,d);return null==e?null:{pathname:e,search:y,hash:b,state:w,key:S}}),[d,m,y,b,w,S]);return null==E?null:r.createElement(me.Provider,{value:p},r.createElement(ge.Provider,{children:o,value:{location:E,navigationType:l}}))}function Oe(e){var n=e.children,i=e.location,a=r.useContext(pe);return function(e,n){be()||P(!1);var i,a=r.useContext(me).navigator,o=r.useContext(Ae),s=r.useContext(ye).matches,u=s[s.length-1],l=u?u.params:{},c=(u&&u.pathname,u?u.pathnameBase:"/"),h=(u&&u.route,xe());if(n){var f,d="string"===typeof n?D(n):n;"/"===c||(null==(f=d.pathname)?void 0:f.startsWith(c))||P(!1),i=d}else i=h;var p=i.pathname||"/",A=B(e,{pathname:"/"===c?p:p.slice(c.length)||"/"}),v=Re(A&&A.map((function(e){return Object.assign({},e,{params:Object.assign({},l,e.params),pathname:J([c,a.encodeLocation?a.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?c:J([c,a.encodeLocation?a.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})})),s,o||void 0);return n&&v?r.createElement(ge.Provider,{value:{location:se({pathname:"/",search:"",hash:"",state:null,key:"default"},i),navigationType:t.Pop}},v):v}(a&&!n?a.router.routes:Be(n),i)}!function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"}(Ie||(Ie={}));var Ue=new Promise((function(){}));r.Component;function Be(e,t){void 0===t&&(t=[]);var n=[];return r.Children.forEach(e,(function(e,i){if(r.isValidElement(e))if(e.type!==r.Fragment){e.type!==Le&&P(!1),e.props.index&&e.props.children&&P(!1);var a=[].concat(l(t),[i]),o={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,hasErrorBoundary:null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle};e.props.children&&(o.children=Be(e.props.children,a)),n.push(o)}else n.push.apply(n,Be(e.props.children,t))})),n}function Fe(){return Fe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fe.apply(this,arguments)}function ze(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}var Ve=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function qe(e){var t=e.basename,n=e.children,i=e.window,a=r.useRef();null==a.current&&(a.current=function(e){return void 0===e&&(e={}),U((function(e,t){var n=e.location;return I("",{pathname:n.pathname,search:n.search,hash:n.hash},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:L(t)}),null,e)}({window:i,v5Compat:!0}));var o=a.current,s=T(r.useState({action:o.action,location:o.location}),2),u=s[0],l=s[1];return r.useLayoutEffect((function(){return o.listen(l)}),[o]),r.createElement(De,{basename:t,children:n,location:u.location,navigationType:u.action,navigator:o})}var je=r.forwardRef((function(e,t){var n=e.onClick,i=e.relative,a=e.reloadDocument,o=e.replace,s=e.state,u=e.target,l=e.to,c=e.preventScrollReset,h=ze(e,Ve),f=function(e,t){var n=(void 0===t?{}:t).relative;be()||P(!1);var i=r.useContext(me),a=i.basename,o=i.navigator,s=Te(e,{relative:n}),u=s.hash,l=s.pathname,c=s.search,h=l;return"/"!==a&&(h="/"===l?a:J([a,l])),o.createHref({pathname:h,search:c,hash:u})}(l,{relative:i}),d=function(e,t){var n=void 0===t?{}:t,i=n.target,a=n.replace,o=n.state,s=n.preventScrollReset,u=n.relative,l=we(),c=xe(),h=Te(e,{relative:u});return r.useCallback((function(t){if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,i)){t.preventDefault();var n=void 0!==a?a:L(c)===L(h);l(e,{replace:n,state:o,preventScrollReset:s,relative:u})}}),[c,l,h,a,o,i,e,s,u])}(l,{replace:o,state:s,target:u,preventScrollReset:c,relative:i});return r.createElement("a",Fe({},h,{href:f,onClick:a?n:function(e){n&&n(e),e.defaultPrevented||d(e)},ref:t,target:u}))}));var Ge,He;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(Ge||(Ge={})),function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(He||(He={}));function We(e,t,n){return(t=f(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(n),!0).forEach((function(t){We(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ye=n(417);var Ke=function(e){return function(t){var n=xe(),i=we(),a=function(){var e=r.useContext(ye).matches,t=e[e.length-1];return t?t.params:{}}();return(0,Ye.jsx)(e,Qe(Qe({},t),{},{location:n,params:a,navigate:i}))}};function Ze(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Je(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(e,t)||et(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $e(e){return function(e){if(Array.isArray(e))return tt(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||et(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function et(e,t){if(e){if("string"===typeof e)return tt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tt(e,t):void 0}}function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var nt=function(e,t){var n=new Set(t);return Object.assign.apply(Object,[{}].concat($e(Object.entries(e).filter((function(e){var t=Je(e,1)[0];return!n.has(t)})).map((function(e){var t=Je(e,2);return Ze({},t[0],t[1])})))))};function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function it(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t);else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(e,t)||ot(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function at(e){return function(e){if(Array.isArray(e))return rt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ot(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ot(e,t){if(e){if("string"==typeof e)return rt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rt(e,t):void 0}}function st(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.useEffect,n=(0,r.useRef)(),i=(0,r.useRef)(!1),a=(0,r.useRef)(!1),o=(0,r.useState)(0),s=it(o,2);s[0];var u=s[1];i.current&&(a.current=!0),t((function(){return i.current||(n.current=e(),i.current=!0),u((function(e){return e+1})),function(){a.current&&n.current&&n.current()}}),[])}function ut(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(l){return void n(l)}s.done?t(u):Promise.resolve(u).then(r,i)}function lt(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){ut(a,r,i,o,s,"next",e)}function s(e){ut(a,r,i,o,s,"throw",e)}o(void 0)}))}}function ct(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}function ht(){return ht="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=ct(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},ht.apply(this,arguments)}function ft(){ft=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(C){u=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var a=t&&t.prototype instanceof d?t:d,o=Object.create(a.prototype),s=new E(i||[]);return r(o,"_invoke",{value:x(e,n,s)}),o}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(C){return{type:"throw",arg:C}}}e.wrap=l;var f={};function d(){}function p(){}function A(){}var v={};u(v,a,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(k([])));g&&g!==t&&n.call(g,a)&&(v=g);var y=A.prototype=d.prototype=Object.create(v);function _(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function i(r,a,o,s){var u=c(e[r],e,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==h(f)&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){i("next",e,o,s)}),(function(e){i("throw",e,o,s)})):t.resolve(f).then((function(e){l.value=e,o(l)}),(function(e){return i("throw",e,o,s)}))}s(u.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function x(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return M()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=w(o,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=c(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,f;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function k(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:M}}function M(){return{value:void 0,done:!0}}return p.prototype=A,r(y,"constructor",{value:A,configurable:!0}),r(A,"constructor",{value:p,configurable:!0}),p.displayName=u(A,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,A):(e.__proto__=A,u(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},_(b.prototype),u(b.prototype,o,(function(){return this})),e.AsyncIterator=b,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new b(l(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},_(y),u(y,s,"Generator"),u(y,a,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=k,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},e}var dt="175",pt=0,At=1,vt=2,mt=0,gt=1,yt=2,_t=3,bt=100,xt=200,wt=204,Tt=205,St=300,Et=301,kt=302,Mt=303,Ct=304,Rt=306,Pt=1e3,Nt=1001,It=1002,Lt=1003,Dt=1004,Ot=1005,Ut=1006,Bt=1007,Ft=1008,zt=1009,Vt=1010,qt=1011,jt=1012,Gt=1013,Ht=1014,Wt=1015,Xt=1016,Qt=1017,Yt=1018,Kt=1020,Zt=35902,Jt=1021,$t=1022,en=1023,tn=1024,nn=1025,rn=1026,an=1027,on=1028,sn=1029,un=1030,ln=1031,cn=1033,hn=33776,fn=33777,dn=33778,pn=33779,An=35840,vn=35841,mn=35842,gn=35843,yn=36196,_n=37492,bn=37496,xn=37808,wn=37809,Tn=37810,Sn=37811,En=37812,kn=37813,Mn=37814,Cn=37815,Rn=37816,Pn=37817,Nn=37818,In=37819,Ln=37820,Dn=37821,On=36492,Un=36494,Bn=36495,Fn=36283,zn=36284,Vn=36285,qn=36286,jn=2300,Gn=2301,Hn=2302,Wn=2400,Xn=2401,Qn=2402,Yn="",Kn="srgb",Zn="srgb-linear",Jn="linear",$n="srgb",er=7680,tr=513,nr=515,rr=35044,ir=35048,ar="300 es",or=2e3,sr=2001,ur=function(){function e(){c(this,e)}return p(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}},{key:"hasEventListener",value:function(e,t){var n=this._listeners;return void 0!==n&&(void 0!==n[e]&&-1!==n[e].indexOf(t))}},{key:"removeEventListener",value:function(e,t){var n=this._listeners;if(void 0!==n){var r=n[e];if(void 0!==r){var i=r.indexOf(t);-1!==i&&r.splice(i,1)}}}},{key:"dispatchEvent",value:function(e){var t=this._listeners;if(void 0!==t){var n=t[e.type];if(void 0!==n){e.target=this;for(var r=n.slice(0),i=0,a=r.length;i<a;i++)r[i].call(this,e);e.target=null}}}}]),e}(),lr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],cr=1234567,hr=Math.PI/180,fr=180/Math.PI;function dr(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(lr[255&e]+lr[e>>8&255]+lr[e>>16&255]+lr[e>>24&255]+"-"+lr[255&t]+lr[t>>8&255]+"-"+lr[t>>16&15|64]+lr[t>>24&255]+"-"+lr[63&n|128]+lr[n>>8&255]+"-"+lr[n>>16&255]+lr[n>>24&255]+lr[255&r]+lr[r>>8&255]+lr[r>>16&255]+lr[r>>24&255]).toLowerCase()}function pr(e,t,n){return Math.max(t,Math.min(n,e))}function Ar(e,t){return(e%t+t)%t}function vr(e,t,n){return(1-n)*e+n*t}function mr(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function gr(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}var yr={DEG2RAD:hr,RAD2DEG:fr,generateUUID:dr,clamp:pr,euclideanModulo:Ar,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:vr,damp:function(e,t,n,r){return vr(e,t,1-Math.exp(-n*r))},pingpong:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(Ar(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(cr=e);var t=cr+=1831565813;return t=Math.imul(t^t>>>15,1|t),(((t^=t+Math.imul(t^t>>>7,61|t))^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*hr},radToDeg:function(e){return e*fr},isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,i){var a=Math.cos,o=Math.sin,s=a(n/2),u=o(n/2),l=a((t+r)/2),c=o((t+r)/2),h=a((t-r)/2),f=o((t-r)/2),d=a((r-t)/2),p=o((r-t)/2);switch(i){case"XYX":e.set(s*c,u*h,u*f,s*l);break;case"YZY":e.set(u*f,s*c,u*h,s*l);break;case"ZXZ":e.set(u*h,u*f,s*c,s*l);break;case"XZX":e.set(s*c,u*p,u*d,s*l);break;case"YXY":e.set(u*d,s*c,u*p,s*l);break;case"ZYZ":e.set(u*p,u*d,s*c,s*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},normalize:gr,denormalize:mr},_r=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;c(this,t),t.prototype.isVector2=!0,this.x=e,this.y=n}return p(t,[{key:"width",get:function(){return this.x},set:function(e){this.x=e}},{key:"height",get:function(){return this.y},set:function(e){this.y=e}},{key:"set",value:function(e,t){return this.x=e,this.y=t,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}},{key:"clamp",value:function(e,t){return this.x=pr(this.x,e.x,t.x),this.y=pr(this.y,e.y,t.y),this}},{key:"clampScalar",value:function(e,t){return this.x=pr(this.x,e,t),this.y=pr(this.y,e,t),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(pr(n,e,t))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"roundToZero",value:function(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"cross",value:function(e){return this.x*e.y-this.y*e.x}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"angle",value:function(){var e=Math.atan2(-this.y,-this.x)+Math.PI;return e}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(pr(n,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}},{key:"fromBufferAttribute",value:function(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}},{key:"rotateAround",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this}},{key:Symbol.iterator,value:ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:case"end":return e.stop()}}),e,this)}))}]),t}(),br=function(){function e(t,n,r,i,a,o,s,u,l){c(this,e),e.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==t&&this.set(t,n,r,i,a,o,s,u,l)}return p(e,[{key:"set",value:function(e,t,n,r,i,a,o,s,u){var l=this.elements;return l[0]=e,l[1]=r,l[2]=o,l[3]=t,l[4]=i,l[5]=s,l[6]=n,l[7]=a,l[8]=u,this}},{key:"identity",value:function(){return this.set(1,0,0,0,1,0,0,0,1),this}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}},{key:"setFromMatrix4",value:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[3],s=n[6],u=n[1],l=n[4],c=n[7],h=n[2],f=n[5],d=n[8],p=r[0],A=r[3],v=r[6],m=r[1],g=r[4],y=r[7],_=r[2],b=r[5],x=r[8];return i[0]=a*p+o*m+s*_,i[3]=a*A+o*g+s*b,i[6]=a*v+o*y+s*x,i[1]=u*p+l*m+c*_,i[4]=u*A+l*g+c*b,i[7]=u*v+l*y+c*x,i[2]=h*p+f*m+d*_,i[5]=h*A+f*g+d*b,i[8]=h*v+f*y+d*x,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8];return t*a*l-t*o*u-n*i*l+n*o*s+r*i*u-r*a*s}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=l*a-o*u,h=o*s-l*i,f=u*i-a*s,d=t*c+n*h+r*f;if(0===d)return this.set(0,0,0,0,0,0,0,0,0);var p=1/d;return e[0]=c*p,e[1]=(r*u-l*n)*p,e[2]=(o*n-r*a)*p,e[3]=h*p,e[4]=(l*t-r*s)*p,e[5]=(r*i-o*t)*p,e[6]=f*p,e[7]=(n*s-u*t)*p,e[8]=(a*t-n*i)*p,this}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}},{key:"getNormalMatrix",value:function(e){return this.setFromMatrix4(e).invert().transpose()}},{key:"transposeIntoArray",value:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}},{key:"setUvTransform",value:function(e,t,n,r,i,a,o){var s=Math.cos(i),u=Math.sin(i);return this.set(n*s,n*u,-n*(s*a+u*o)+a+e,-r*u,r*s,-r*(-u*a+s*o)+o+t,0,0,1),this}},{key:"scale",value:function(e,t){return this.premultiply(xr.makeScale(e,t)),this}},{key:"rotate",value:function(e){return this.premultiply(xr.makeRotation(-e)),this}},{key:"translate",value:function(e,t){return this.premultiply(xr.makeTranslation(e,t)),this}},{key:"makeTranslation",value:function(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}},{key:"makeRotation",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}},{key:"makeScale",value:function(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<9;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}}]),e}(),xr=new br;function wr(e){for(var t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function Tr(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function Sr(){var e=Tr("canvas");return e.style.display="block",e}var Er={};function kr(e){e in Er||(Er[e]=!0,console.warn(e))}function Mr(e,t,n){return new Promise((function(r,i){setTimeout((function a(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:i();break;case e.TIMEOUT_EXPIRED:setTimeout(a,n);break;default:r()}}),n)}))}function Cr(e){var t=e.elements;t[2]=.5*t[2]+.5*t[3],t[6]=.5*t[6]+.5*t[7],t[10]=.5*t[10]+.5*t[11],t[14]=.5*t[14]+.5*t[15]}function Rr(e){var t=e.elements;-1===t[11]?(t[10]=-t[10]-1,t[14]=-t[14]):(t[10]=-t[10],t[14]=1-t[14])}var Pr=(new br).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Nr=(new br).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function Ir(){var e,t={enabled:!0,workingColorSpace:Zn,spaces:{},convert:function(e,t,n){return!1!==this.enabled&&t!==n&&t&&n?(this.spaces[t].transfer===$n&&(e.r=Or(e.r),e.g=Or(e.g),e.b=Or(e.b)),this.spaces[t].primaries!==this.spaces[n].primaries&&(e.applyMatrix3(this.spaces[t].toXYZ),e.applyMatrix3(this.spaces[n].fromXYZ)),this.spaces[n].transfer===$n&&(e.r=Ur(e.r),e.g=Ur(e.g),e.b=Ur(e.b)),e):e},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)},getPrimaries:function(e){return this.spaces[e].primaries},getTransfer:function(e){return e===Yn?Jn:this.spaces[e].transfer},getLuminanceCoefficients:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.workingColorSpace;return e.fromArray(this.spaces[t].luminanceCoefficients)},define:function(e){Object.assign(this.spaces,e)},_getMatrix:function(e,t,n){return e.copy(this.spaces[t].toXYZ).multiply(this.spaces[n].fromXYZ)},_getDrawingBufferColorSpace:function(e){return this.spaces[e].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.workingColorSpace;return this.spaces[e].workingColorSpaceConfig.unpackColorSpace}},n=[.64,.33,.3,.6,.15,.06],r=[.2126,.7152,.0722],i=[.3127,.329];return t.define((We(e={},Zn,{primaries:n,whitePoint:i,transfer:Jn,toXYZ:Pr,fromXYZ:Nr,luminanceCoefficients:r,workingColorSpaceConfig:{unpackColorSpace:Kn},outputColorSpaceConfig:{drawingBufferColorSpace:Kn}}),We(e,Kn,{primaries:n,whitePoint:i,transfer:$n,toXYZ:Pr,fromXYZ:Nr,luminanceCoefficients:r,outputColorSpaceConfig:{drawingBufferColorSpace:Kn}}),e)),t}var Lr,Dr=Ir();function Or(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Ur(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var Br=function(){function e(){c(this,e)}return p(e,null,[{key:"getDataURL",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png";if(/^data:/i.test(e.src))return e.src;if("undefined"===typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Lr&&(Lr=Tr("canvas")),Lr.width=e.width,Lr.height=e.height;var r=Lr.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Lr}return t.toDataURL(n)}},{key:"sRGBToLinear",value:function(e){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){var t=Tr("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);for(var r=n.getImageData(0,0,e.width,e.height),i=r.data,a=0;a<i.length;a++)i[a]=255*Or(i[a]/255);return n.putImageData(r,0,0),t}if(e.data){for(var o=e.data.slice(0),s=0;s<o.length;s++)o instanceof Uint8Array||o instanceof Uint8ClampedArray?o[s]=Math.floor(255*Or(o[s]/255)):o[s]=Or(o[s]);return{data:o,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}]),e}(),Fr=0,zr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;c(this,e),this.isSource=!0,Object.defineProperty(this,"id",{value:Fr++}),this.uuid=dr(),this.data=t,this.dataReady=!0,this.version=0}return p(e,[{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];var n={uuid:this.uuid,url:""},r=this.data;if(null!==r){var i;if(Array.isArray(r)){i=[];for(var a=0,o=r.length;a<o;a++)r[a].isDataTexture?i.push(Vr(r[a].image)):i.push(Vr(r[a]))}else i=Vr(r);n.url=i}return t||(e.images[this.uuid]=n),n}}]),e}();function Vr(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?Br.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var qr=0,jr=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.DEFAULT_IMAGE,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.DEFAULT_MAPPING,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Nt,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Nt,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ut,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ft,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:en,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:zt,f=arguments.length>8&&void 0!==arguments[8]?arguments[8]:n.DEFAULT_ANISOTROPY,d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:Yn;return c(this,n),(e=t.call(this)).isTexture=!0,Object.defineProperty(y(e),"id",{value:qr++}),e.uuid=dr(),e.name="",e.source=new zr(r),e.mipmaps=[],e.mapping=i,e.channel=0,e.wrapS=a,e.wrapT=o,e.magFilter=s,e.minFilter=u,e.anisotropy=f,e.format=l,e.internalFormat=null,e.type=h,e.offset=new _r(0,0),e.repeat=new _r(1,1),e.center=new _r(0,0),e.rotation=0,e.matrixAutoUpdate=!0,e.matrix=new br,e.generateMipmaps=!0,e.premultiplyAlpha=!1,e.flipY=!0,e.unpackAlignment=4,e.colorSpace=d,e.userData={},e.version=0,e.onUpdate=null,e.renderTarget=null,e.isRenderTargetTexture=!1,e.pmremVersion=0,e}return p(n,[{key:"image",get:function(){return this.source.data},set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.source.data=e}},{key:"updateMatrix",value:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"transformUv",value:function(e){if(this.mapping!==St)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Pt:e.x=e.x-Math.floor(e.x);break;case Nt:e.x=e.x<0?0:1;break;case It:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case Pt:e.y=e.y-Math.floor(e.y);break;case Nt:e.y=e.y<0?0:1;break;case It:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}},{key:"needsUpdate",set:function(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}},{key:"needsPMREMUpdate",set:function(e){!0===e&&this.pmremVersion++}}]),n}(ur);jr.DEFAULT_IMAGE=null,jr.DEFAULT_MAPPING=St,jr.DEFAULT_ANISOTROPY=1;var Gr=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;c(this,t),t.prototype.isVector4=!0,this.x=e,this.y=n,this.z=r,this.w=i}return p(t,[{key:"width",get:function(){return this.z},set:function(e){this.z=e}},{key:"height",get:function(){return this.w},set:function(e){this.w=e}},{key:"set",value:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setW",value:function(e){return this.w=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"setAxisAngleFromQuaternion",value:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}},{key:"setAxisAngleFromRotationMatrix",value:function(e){var t,n,r,i,a=.01,o=.1,s=e.elements,u=s[0],l=s[4],c=s[8],h=s[1],f=s[5],d=s[9],p=s[2],A=s[6],v=s[10];if(Math.abs(l-h)<a&&Math.abs(c-p)<a&&Math.abs(d-A)<a){if(Math.abs(l+h)<o&&Math.abs(c+p)<o&&Math.abs(d+A)<o&&Math.abs(u+f+v-3)<o)return this.set(1,0,0,0),this;t=Math.PI;var m=(u+1)/2,g=(f+1)/2,y=(v+1)/2,_=(l+h)/4,b=(c+p)/4,x=(d+A)/4;return m>g&&m>y?m<a?(n=0,r=.707106781,i=.707106781):(r=_/(n=Math.sqrt(m)),i=b/n):g>y?g<a?(n=.707106781,r=0,i=.707106781):(n=_/(r=Math.sqrt(g)),i=x/r):y<a?(n=.707106781,r=.707106781,i=0):(n=b/(i=Math.sqrt(y)),r=x/i),this.set(n,r,i,t),this}var w=Math.sqrt((A-d)*(A-d)+(c-p)*(c-p)+(h-l)*(h-l));return Math.abs(w)<.001&&(w=1),this.x=(A-d)/w,this.y=(c-p)/w,this.z=(h-l)/w,this.w=Math.acos((u+f+v-1)/2),this}},{key:"setFromMatrixPosition",value:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}},{key:"clamp",value:function(e,t){return this.x=pr(this.x,e.x,t.x),this.y=pr(this.y,e.y,t.y),this.z=pr(this.z,e.z,t.z),this.w=pr(this.w,e.w,t.w),this}},{key:"clampScalar",value:function(e,t){return this.x=pr(this.x,e,t),this.y=pr(this.y,e,t),this.z=pr(this.z,e,t),this.w=pr(this.w,e,t),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(pr(n,e,t))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}},{key:"roundToZero",value:function(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}},{key:"fromBufferAttribute",value:function(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}},{key:Symbol.iterator,value:ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:return e.next=6,this.z;case 6:return e.next=8,this.w;case 8:case"end":return e.stop()}}),e,this)}))}]),t}(),Hr=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};c(this,n),(e=t.call(this)).isRenderTarget=!0,e.width=r,e.height=i,e.depth=1,e.scissor=new Gr(0,0,r,i),e.scissorTest=!1,e.viewport=new Gr(0,0,r,i);var o={width:r,height:i,depth:1};a=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Ut,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},a);var s=new jr(o,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.colorSpace);s.flipY=!1,s.generateMipmaps=a.generateMipmaps,s.internalFormat=a.internalFormat,e.textures=[];for(var u=a.count,l=0;l<u;l++)e.textures[l]=s.clone(),e.textures[l].isRenderTargetTexture=!0,e.textures[l].renderTarget=y(e);return e.depthBuffer=a.depthBuffer,e.stencilBuffer=a.stencilBuffer,e.resolveDepthBuffer=a.resolveDepthBuffer,e.resolveStencilBuffer=a.resolveStencilBuffer,e._depthTexture=a.depthTexture,e.samples=a.samples,e}return p(n,[{key:"texture",get:function(){return this.textures[0]},set:function(e){this.textures[0]=e}},{key:"depthTexture",get:function(){return this._depthTexture},set:function(e){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==e&&(e.renderTarget=this),this._depthTexture=e}},{key:"setSize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(var r=0,i=this.textures.length;r<i;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(var t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;var r=Object.assign({},e.textures[t].image);this.textures[t].source=new zr(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(ur),Wr=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return c(this,n),(e=t.call(this,r,i,a)).isWebGLRenderTarget=!0,e}return p(n)}(Hr),Xr=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return c(this,n),(e=t.call(this,null)).isDataArrayTexture=!0,e.image={data:r,width:i,height:a,depth:o},e.magFilter=Lt,e.minFilter=Lt,e.wrapR=Nt,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e.layerUpdates=new Set,e}return p(n,[{key:"addLayerUpdate",value:function(e){this.layerUpdates.add(e)}},{key:"clearLayerUpdates",value:function(){this.layerUpdates.clear()}}]),n}(jr),Qr=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return c(this,n),(e=t.call(this,null)).isData3DTexture=!0,e.image={data:r,width:i,height:a,depth:o},e.magFilter=Lt,e.minFilter=Lt,e.wrapR=Nt,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e}return p(n)}(jr),Yr=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;c(this,t),this.isQuaternion=!0,this._x=e,this._y=n,this._z=r,this._w=i}return p(t,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._w)}},{key:"copy",value:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}},{key:"setFromEuler",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e._x,r=e._y,i=e._z,a=e._order,o=Math.cos,s=Math.sin,u=o(n/2),l=o(r/2),c=o(i/2),h=s(n/2),f=s(r/2),d=s(i/2);switch(a){case"XYZ":this._x=h*l*c+u*f*d,this._y=u*f*c-h*l*d,this._z=u*l*d+h*f*c,this._w=u*l*c-h*f*d;break;case"YXZ":this._x=h*l*c+u*f*d,this._y=u*f*c-h*l*d,this._z=u*l*d-h*f*c,this._w=u*l*c+h*f*d;break;case"ZXY":this._x=h*l*c-u*f*d,this._y=u*f*c+h*l*d,this._z=u*l*d+h*f*c,this._w=u*l*c-h*f*d;break;case"ZYX":this._x=h*l*c-u*f*d,this._y=u*f*c+h*l*d,this._z=u*l*d-h*f*c,this._w=u*l*c+h*f*d;break;case"YZX":this._x=h*l*c+u*f*d,this._y=u*f*c+h*l*d,this._z=u*l*d-h*f*c,this._w=u*l*c-h*f*d;break;case"XZY":this._x=h*l*c-u*f*d,this._y=u*f*c-h*l*d,this._z=u*l*d+h*f*c,this._w=u*l*c+h*f*d;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!0===t&&this._onChangeCallback(),this}},{key:"setFromAxisAngle",value:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],o=t[5],s=t[9],u=t[2],l=t[6],c=t[10],h=n+o+c;if(h>0){var f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(l-s)*f,this._y=(i-u)*f,this._z=(a-r)*f}else if(n>o&&n>c){var d=2*Math.sqrt(1+n-o-c);this._w=(l-s)/d,this._x=.25*d,this._y=(r+a)/d,this._z=(i+u)/d}else if(o>c){var p=2*Math.sqrt(1+o-n-c);this._w=(i-u)/p,this._x=(r+a)/p,this._y=.25*p,this._z=(s+l)/p}else{var A=2*Math.sqrt(1+c-n-o);this._w=(a-r)/A,this._x=(i+u)/A,this._y=(s+l)/A,this._z=.25*A}return this._onChangeCallback(),this}},{key:"setFromUnitVectors",value:function(e,t){var n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}},{key:"angleTo",value:function(e){return 2*Math.acos(Math.abs(pr(this.dot(e),-1,1)))}},{key:"rotateTowards",value:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}},{key:"dot",value:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}},{key:"lengthSq",value:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}},{key:"length",value:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}},{key:"normalize",value:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}},{key:"multiply",value:function(e){return this.multiplyQuaternions(this,e)}},{key:"premultiply",value:function(e){return this.multiplyQuaternions(e,this)}},{key:"multiplyQuaternions",value:function(e,t){var n=e._x,r=e._y,i=e._z,a=e._w,o=t._x,s=t._y,u=t._z,l=t._w;return this._x=n*l+a*o+r*u-i*s,this._y=r*l+a*s+i*o-n*u,this._z=i*l+a*u+n*s-r*o,this._w=a*l-n*o-r*s-i*u,this._onChangeCallback(),this}},{key:"slerp",value:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,a=this._w,o=a*e._w+n*e._x+r*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;var s=1-o*o;if(s<=Number.EPSILON){var u=1-t;return this._w=u*a+t*this._w,this._x=u*n+t*this._x,this._y=u*r+t*this._y,this._z=u*i+t*this._z,this.normalize(),this}var l=Math.sqrt(s),c=Math.atan2(l,o),h=Math.sin((1-t)*c)/l,f=Math.sin(t*c)/l;return this._w=a*h+this._w*f,this._x=n*h+this._x*f,this._y=r*h+this._y*f,this._z=i*h+this._z*f,this._onChangeCallback(),this}},{key:"slerpQuaternions",value:function(e,t,n){return this.copy(e).slerp(t,n)}},{key:"random",value:function(){var e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}},{key:"fromBufferAttribute",value:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}},{key:"toJSON",value:function(){return this.toArray()}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}},{key:Symbol.iterator,value:ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._x;case 2:return e.next=4,this._y;case 4:return e.next=6,this._z;case 6:return e.next=8,this._w;case 8:case"end":return e.stop()}}),e,this)}))}],[{key:"slerpFlat",value:function(e,t,n,r,i,a,o){var s=n[r+0],u=n[r+1],l=n[r+2],c=n[r+3],h=i[a+0],f=i[a+1],d=i[a+2],p=i[a+3];if(0===o)return e[t+0]=s,e[t+1]=u,e[t+2]=l,void(e[t+3]=c);if(1===o)return e[t+0]=h,e[t+1]=f,e[t+2]=d,void(e[t+3]=p);if(c!==p||s!==h||u!==f||l!==d){var A=1-o,v=s*h+u*f+l*d+c*p,m=v>=0?1:-1,g=1-v*v;if(g>Number.EPSILON){var y=Math.sqrt(g),_=Math.atan2(y,v*m);A=Math.sin(A*_)/y,o=Math.sin(o*_)/y}var b=o*m;if(s=s*A+h*b,u=u*A+f*b,l=l*A+d*b,c=c*A+p*b,A===1-o){var x=1/Math.sqrt(s*s+u*u+l*l+c*c);s*=x,u*=x,l*=x,c*=x}}e[t]=s,e[t+1]=u,e[t+2]=l,e[t+3]=c}},{key:"multiplyQuaternionsFlat",value:function(e,t,n,r,i,a){var o=n[r],s=n[r+1],u=n[r+2],l=n[r+3],c=i[a],h=i[a+1],f=i[a+2],d=i[a+3];return e[t]=o*d+l*c+s*f-u*h,e[t+1]=s*d+l*h+u*c-o*f,e[t+2]=u*d+l*f+o*h-s*c,e[t+3]=l*d-o*c-s*h-u*f,e}}]),t}(),Kr=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;c(this,t),t.prototype.isVector3=!0,this.x=e,this.y=n,this.z=r}return p(t,[{key:"set",value:function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"multiplyVectors",value:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}},{key:"applyEuler",value:function(e){return this.applyQuaternion(Jr.setFromEuler(e))}},{key:"applyAxisAngle",value:function(e,t){return this.applyQuaternion(Jr.setFromAxisAngle(e,t))}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}},{key:"applyNormalMatrix",value:function(e){return this.applyMatrix3(e).normalize()}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}},{key:"applyQuaternion",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=e.w,u=2*(a*r-o*n),l=2*(o*t-i*r),c=2*(i*n-a*t);return this.x=t+s*u+a*c-o*l,this.y=n+s*l+o*u-i*c,this.z=r+s*c+i*l-a*u,this}},{key:"project",value:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}},{key:"unproject",value:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}},{key:"transformDirection",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}},{key:"clamp",value:function(e,t){return this.x=pr(this.x,e.x,t.x),this.y=pr(this.y,e.y,t.y),this.z=pr(this.z,e.z,t.z),this}},{key:"clampScalar",value:function(e,t){return this.x=pr(this.x,e,t),this.y=pr(this.y,e,t),this.z=pr(this.z,e,t),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(pr(n,e,t))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}},{key:"cross",value:function(e){return this.crossVectors(this,e)}},{key:"crossVectors",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this}},{key:"projectOnVector",value:function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}},{key:"projectOnPlane",value:function(e){return Zr.copy(this).projectOnVector(e),this.sub(Zr)}},{key:"reflect",value:function(e){return this.sub(Zr.copy(e).multiplyScalar(2*this.dot(e)))}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(pr(n,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}},{key:"setFromSpherical",value:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}},{key:"setFromSphericalCoords",value:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}},{key:"setFromCylindrical",value:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}},{key:"setFromCylindricalCoords",value:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}},{key:"setFromMatrixPosition",value:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}},{key:"setFromMatrixColumn",value:function(e,t){return this.fromArray(e.elements,4*t)}},{key:"setFromMatrix3Column",value:function(e,t){return this.fromArray(e.elements,3*t)}},{key:"setFromEuler",value:function(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}},{key:"setFromColor",value:function(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}},{key:"fromBufferAttribute",value:function(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}},{key:"randomDirection",value:function(){var e=Math.random()*Math.PI*2,t=2*Math.random()-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}},{key:Symbol.iterator,value:ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:return e.next=6,this.z;case 6:case"end":return e.stop()}}),e,this)}))}]),t}(),Zr=new Kr,Jr=new Yr,$r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Kr(1/0,1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Kr(-1/0,-1/0,-1/0);c(this,e),this.isBox3=!0,this.min=t,this.max=n}return p(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromArray",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t+=3)this.expandByPoint(ti.fromArray(e,t));return this}},{key:"setFromBufferAttribute",value:function(e){this.makeEmpty();for(var t=0,n=e.count;t<n;t++)this.expandByPoint(ti.fromBufferAttribute(e,t));return this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=ti.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"setFromObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}},{key:"getCenter",value:function(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"expandByObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);var n=e.geometry;if(void 0!==n){var r=n.getAttribute("position");if(!0===t&&void 0!==r&&!0!==e.isInstancedMesh)for(var i=0,a=r.count;i<a;i++)!0===e.isMesh?e.getVertexPosition(i,ti):ti.fromBufferAttribute(r,i),ti.applyMatrix4(e.matrixWorld),this.expandByPoint(ti);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),ni.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),ni.copy(n.boundingBox)),ni.applyMatrix4(e.matrixWorld),this.union(ni)}for(var o=e.children,s=0,u=o.length;s<u;s++)this.expandByObject(o[s],t);return this}},{key:"containsPoint",value:function(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}},{key:"getParameter",value:function(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}},{key:"intersectsBox",value:function(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}},{key:"intersectsSphere",value:function(e){return this.clampPoint(e.center,ti),ti.distanceToSquared(e.center)<=e.radius*e.radius}},{key:"intersectsPlane",value:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}},{key:"intersectsTriangle",value:function(e){if(this.isEmpty())return!1;this.getCenter(li),ci.subVectors(this.max,li),ri.subVectors(e.a,li),ii.subVectors(e.b,li),ai.subVectors(e.c,li),oi.subVectors(ii,ri),si.subVectors(ai,ii),ui.subVectors(ri,ai);var t=[0,-oi.z,oi.y,0,-si.z,si.y,0,-ui.z,ui.y,oi.z,0,-oi.x,si.z,0,-si.x,ui.z,0,-ui.x,-oi.y,oi.x,0,-si.y,si.x,0,-ui.y,ui.x,0];return!!di(t,ri,ii,ai,ci)&&(!!di(t=[1,0,0,0,1,0,0,0,1],ri,ii,ai,ci)&&(hi.crossVectors(oi,si),di(t=[hi.x,hi.y,hi.z],ri,ii,ai,ci)))}},{key:"clampPoint",value:function(e,t){return t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return this.clampPoint(e,ti).distanceTo(e)}},{key:"getBoundingSphere",value:function(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(ti).length()),e}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"applyMatrix4",value:function(e){return this.isEmpty()||(ei[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ei[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ei[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ei[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ei[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ei[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ei[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ei[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ei)),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}(),ei=[new Kr,new Kr,new Kr,new Kr,new Kr,new Kr,new Kr,new Kr],ti=new Kr,ni=new $r,ri=new Kr,ii=new Kr,ai=new Kr,oi=new Kr,si=new Kr,ui=new Kr,li=new Kr,ci=new Kr,hi=new Kr,fi=new Kr;function di(e,t,n,r,i){for(var a=0,o=e.length-3;a<=o;a+=3){fi.fromArray(e,a);var s=i.x*Math.abs(fi.x)+i.y*Math.abs(fi.y)+i.z*Math.abs(fi.z),u=t.dot(fi),l=n.dot(fi),c=r.dot(fi);if(Math.max(-Math.max(u,l,c),Math.min(u,l,c))>s)return!1}return!0}var pi=new $r,Ai=new Kr,vi=new Kr,mi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Kr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;c(this,e),this.isSphere=!0,this.center=t,this.radius=n}return p(e,[{key:"set",value:function(e,t){return this.center.copy(e),this.radius=t,this}},{key:"setFromPoints",value:function(e,t){var n=this.center;void 0!==t?n.copy(t):pi.setFromPoints(e).getCenter(n);for(var r=0,i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}},{key:"copy",value:function(e){return this.center.copy(e.center),this.radius=e.radius,this}},{key:"isEmpty",value:function(){return this.radius<0}},{key:"makeEmpty",value:function(){return this.center.set(0,0,0),this.radius=-1,this}},{key:"containsPoint",value:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}},{key:"distanceToPoint",value:function(e){return e.distanceTo(this.center)-this.radius}},{key:"intersectsSphere",value:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}},{key:"intersectsBox",value:function(e){return e.intersectsSphere(this)}},{key:"intersectsPlane",value:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}},{key:"clampPoint",value:function(e,t){var n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}},{key:"getBoundingBox",value:function(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}},{key:"applyMatrix4",value:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}},{key:"translate",value:function(e){return this.center.add(e),this}},{key:"expandByPoint",value:function(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Ai.subVectors(e,this.center);var t=Ai.lengthSq();if(t>this.radius*this.radius){var n=Math.sqrt(t),r=.5*(n-this.radius);this.center.addScaledVector(Ai,r/n),this.radius+=r}return this}},{key:"union",value:function(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(vi.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Ai.copy(e.center).add(vi)),this.expandByPoint(Ai.copy(e.center).sub(vi))),this)}},{key:"equals",value:function(e){return e.center.equals(this.center)&&e.radius===this.radius}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),gi=new Kr,yi=new Kr,_i=new Kr,bi=new Kr,xi=new Kr,wi=new Kr,Ti=new Kr,Si=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Kr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Kr(0,0,-1);c(this,e),this.origin=t,this.direction=n}return p(e,[{key:"set",value:function(e,t){return this.origin.copy(e),this.direction.copy(t),this}},{key:"copy",value:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}},{key:"at",value:function(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}},{key:"lookAt",value:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this}},{key:"recast",value:function(e){return this.origin.copy(this.at(e,gi)),this}},{key:"closestPointToPoint",value:function(e,t){t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}},{key:"distanceToPoint",value:function(e){return Math.sqrt(this.distanceSqToPoint(e))}},{key:"distanceSqToPoint",value:function(e){var t=gi.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(gi.copy(this.origin).addScaledVector(this.direction,t),gi.distanceToSquared(e))}},{key:"distanceSqToSegment",value:function(e,t,n,r){yi.copy(e).add(t).multiplyScalar(.5),_i.copy(t).sub(e).normalize(),bi.copy(this.origin).sub(yi);var i,a,o,s,u=.5*e.distanceTo(t),l=-this.direction.dot(_i),c=bi.dot(this.direction),h=-bi.dot(_i),f=bi.lengthSq(),d=Math.abs(1-l*l);if(d>0)if(a=l*c-h,s=u*d,(i=l*h-c)>=0)if(a>=-s)if(a<=s){var p=1/d;o=(i*=p)*(i+l*(a*=p)+2*c)+a*(l*i+a+2*h)+f}else a=u,o=-(i=Math.max(0,-(l*a+c)))*i+a*(a+2*h)+f;else a=-u,o=-(i=Math.max(0,-(l*a+c)))*i+a*(a+2*h)+f;else a<=-s?o=-(i=Math.max(0,-(-l*u+c)))*i+(a=i>0?-u:Math.min(Math.max(-u,-h),u))*(a+2*h)+f:a<=s?(i=0,o=(a=Math.min(Math.max(-u,-h),u))*(a+2*h)+f):o=-(i=Math.max(0,-(l*u+c)))*i+(a=i>0?u:Math.min(Math.max(-u,-h),u))*(a+2*h)+f;else a=l>0?-u:u,o=-(i=Math.max(0,-(l*a+c)))*i+a*(a+2*h)+f;return n&&n.copy(this.origin).addScaledVector(this.direction,i),r&&r.copy(yi).addScaledVector(_i,a),o}},{key:"intersectSphere",value:function(e,t){gi.subVectors(e.center,this.origin);var n=gi.dot(this.direction),r=gi.dot(gi)-n*n,i=e.radius*e.radius;if(r>i)return null;var a=Math.sqrt(i-r),o=n-a,s=n+a;return s<0?null:o<0?this.at(s,t):this.at(o,t)}},{key:"intersectsSphere",value:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}},{key:"distanceToPlane",value:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}},{key:"intersectPlane",value:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}},{key:"intersectsPlane",value:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}},{key:"intersectBox",value:function(e,t){var n,r,i,a,o,s,u=1/this.direction.x,l=1/this.direction.y,c=1/this.direction.z,h=this.origin;return u>=0?(n=(e.min.x-h.x)*u,r=(e.max.x-h.x)*u):(n=(e.max.x-h.x)*u,r=(e.min.x-h.x)*u),l>=0?(i=(e.min.y-h.y)*l,a=(e.max.y-h.y)*l):(i=(e.max.y-h.y)*l,a=(e.min.y-h.y)*l),n>a||i>r?null:((i>n||isNaN(n))&&(n=i),(a<r||isNaN(r))&&(r=a),c>=0?(o=(e.min.z-h.z)*c,s=(e.max.z-h.z)*c):(o=(e.max.z-h.z)*c,s=(e.min.z-h.z)*c),n>s||o>r?null:((o>n||n!==n)&&(n=o),(s<r||r!==r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))}},{key:"intersectsBox",value:function(e){return null!==this.intersectBox(e,gi)}},{key:"intersectTriangle",value:function(e,t,n,r,i){xi.subVectors(t,e),wi.subVectors(n,e),Ti.crossVectors(xi,wi);var a,o=this.direction.dot(Ti);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}bi.subVectors(this.origin,e);var s=a*this.direction.dot(wi.crossVectors(bi,wi));if(s<0)return null;var u=a*this.direction.dot(xi.cross(bi));if(u<0)return null;if(s+u>o)return null;var l=-a*bi.dot(Ti);return l<0?null:this.at(l/o,i)}},{key:"applyMatrix4",value:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}},{key:"equals",value:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Ei=function(){function e(t,n,r,i,a,o,s,u,l,h,f,d,p,A,v,m){c(this,e),e.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,n,r,i,a,o,s,u,l,h,f,d,p,A,v,m)}return p(e,[{key:"set",value:function(e,t,n,r,i,a,o,s,u,l,c,h,f,d,p,A){var v=this.elements;return v[0]=e,v[4]=t,v[8]=n,v[12]=r,v[1]=i,v[5]=a,v[9]=o,v[13]=s,v[2]=u,v[6]=l,v[10]=c,v[14]=h,v[3]=f,v[7]=d,v[11]=p,v[15]=A,this}},{key:"identity",value:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"clone",value:function(){return(new e).fromArray(this.elements)}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}},{key:"copyPosition",value:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}},{key:"setFromMatrix3",value:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}},{key:"makeBasis",value:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}},{key:"extractRotation",value:function(e){var t=this.elements,n=e.elements,r=1/ki.setFromMatrixColumn(e,0).length(),i=1/ki.setFromMatrixColumn(e,1).length(),a=1/ki.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromEuler",value:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),u=Math.sin(r),l=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){var h=a*l,f=a*c,d=o*l,p=o*c;t[0]=s*l,t[4]=-s*c,t[8]=u,t[1]=f+d*u,t[5]=h-p*u,t[9]=-o*s,t[2]=p-h*u,t[6]=d+f*u,t[10]=a*s}else if("YXZ"===e.order){var A=s*l,v=s*c,m=u*l,g=u*c;t[0]=A+g*o,t[4]=m*o-v,t[8]=a*u,t[1]=a*c,t[5]=a*l,t[9]=-o,t[2]=v*o-m,t[6]=g+A*o,t[10]=a*s}else if("ZXY"===e.order){var y=s*l,_=s*c,b=u*l,x=u*c;t[0]=y-x*o,t[4]=-a*c,t[8]=b+_*o,t[1]=_+b*o,t[5]=a*l,t[9]=x-y*o,t[2]=-a*u,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){var w=a*l,T=a*c,S=o*l,E=o*c;t[0]=s*l,t[4]=S*u-T,t[8]=w*u+E,t[1]=s*c,t[5]=E*u+w,t[9]=T*u-S,t[2]=-u,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){var k=a*s,M=a*u,C=o*s,R=o*u;t[0]=s*l,t[4]=R-k*c,t[8]=C*c+M,t[1]=c,t[5]=a*l,t[9]=-o*l,t[2]=-u*l,t[6]=M*c+C,t[10]=k-R*c}else if("XZY"===e.order){var P=a*s,N=a*u,I=o*s,L=o*u;t[0]=s*l,t[4]=-c,t[8]=u*l,t[1]=P*c+L,t[5]=a*l,t[9]=N*c-I,t[2]=I*c-N,t[6]=o*l,t[10]=L*c+P}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromQuaternion",value:function(e){return this.compose(Ci,e,Ri)}},{key:"lookAt",value:function(e,t,n){var r=this.elements;return Ii.subVectors(e,t),0===Ii.lengthSq()&&(Ii.z=1),Ii.normalize(),Pi.crossVectors(n,Ii),0===Pi.lengthSq()&&(1===Math.abs(n.z)?Ii.x+=1e-4:Ii.z+=1e-4,Ii.normalize(),Pi.crossVectors(n,Ii)),Pi.normalize(),Ni.crossVectors(Ii,Pi),r[0]=Pi.x,r[4]=Ni.x,r[8]=Ii.x,r[1]=Pi.y,r[5]=Ni.y,r[9]=Ii.y,r[2]=Pi.z,r[6]=Ni.z,r[10]=Ii.z,this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[4],s=n[8],u=n[12],l=n[1],c=n[5],h=n[9],f=n[13],d=n[2],p=n[6],A=n[10],v=n[14],m=n[3],g=n[7],y=n[11],_=n[15],b=r[0],x=r[4],w=r[8],T=r[12],S=r[1],E=r[5],k=r[9],M=r[13],C=r[2],R=r[6],P=r[10],N=r[14],I=r[3],L=r[7],D=r[11],O=r[15];return i[0]=a*b+o*S+s*C+u*I,i[4]=a*x+o*E+s*R+u*L,i[8]=a*w+o*k+s*P+u*D,i[12]=a*T+o*M+s*N+u*O,i[1]=l*b+c*S+h*C+f*I,i[5]=l*x+c*E+h*R+f*L,i[9]=l*w+c*k+h*P+f*D,i[13]=l*T+c*M+h*N+f*O,i[2]=d*b+p*S+A*C+v*I,i[6]=d*x+p*E+A*R+v*L,i[10]=d*w+p*k+A*P+v*D,i[14]=d*T+p*M+A*N+v*O,i[3]=m*b+g*S+y*C+_*I,i[7]=m*x+g*E+y*R+_*L,i[11]=m*w+g*k+y*P+_*D,i[15]=m*T+g*M+y*N+_*O,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],u=e[13],l=e[2],c=e[6],h=e[10],f=e[14];return e[3]*(+i*s*c-r*u*c-i*o*h+n*u*h+r*o*f-n*s*f)+e[7]*(+t*s*f-t*u*h+i*a*h-r*a*f+r*u*l-i*s*l)+e[11]*(+t*u*c-t*o*f-i*a*c+n*a*f+i*o*l-n*u*l)+e[15]*(-r*o*l-t*s*c+t*o*h+r*a*c-n*a*h+n*s*l)}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}},{key:"setPosition",value:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=e[9],h=e[10],f=e[11],d=e[12],p=e[13],A=e[14],v=e[15],m=c*A*u-p*h*u+p*s*f-o*A*f-c*s*v+o*h*v,g=d*h*u-l*A*u-d*s*f+a*A*f+l*s*v-a*h*v,y=l*p*u-d*c*u+d*o*f-a*p*f-l*o*v+a*c*v,_=d*c*s-l*p*s-d*o*h+a*p*h+l*o*A-a*c*A,b=t*m+n*g+r*y+i*_;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var x=1/b;return e[0]=m*x,e[1]=(p*h*i-c*A*i-p*r*f+n*A*f+c*r*v-n*h*v)*x,e[2]=(o*A*i-p*s*i+p*r*u-n*A*u-o*r*v+n*s*v)*x,e[3]=(c*s*i-o*h*i-c*r*u+n*h*u+o*r*f-n*s*f)*x,e[4]=g*x,e[5]=(l*A*i-d*h*i+d*r*f-t*A*f-l*r*v+t*h*v)*x,e[6]=(d*s*i-a*A*i-d*r*u+t*A*u+a*r*v-t*s*v)*x,e[7]=(a*h*i-l*s*i+l*r*u-t*h*u-a*r*f+t*s*f)*x,e[8]=y*x,e[9]=(d*c*i-l*p*i-d*n*f+t*p*f+l*n*v-t*c*v)*x,e[10]=(a*p*i-d*o*i+d*n*u-t*p*u-a*n*v+t*o*v)*x,e[11]=(l*o*i-a*c*i-l*n*u+t*c*u+a*n*f-t*o*f)*x,e[12]=_*x,e[13]=(l*p*r-d*c*r+d*n*h-t*p*h-l*n*A+t*c*A)*x,e[14]=(d*o*r-a*p*r-d*n*s+t*p*s+a*n*A-t*o*A)*x,e[15]=(a*c*r-l*o*r+l*n*s-t*c*s-a*n*h+t*o*h)*x,this}},{key:"scale",value:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}},{key:"getMaxScaleOnAxis",value:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}},{key:"makeTranslation",value:function(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}},{key:"makeRotationX",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}},{key:"makeRotationY",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}},{key:"makeRotationZ",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}},{key:"makeRotationAxis",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,o=e.y,s=e.z,u=i*a,l=i*o;return this.set(u*a+n,u*o-r*s,u*s+r*o,0,u*o+r*s,l*o+n,l*s-r*a,0,u*s-r*o,l*s+r*a,i*s*s+n,0,0,0,0,1),this}},{key:"makeScale",value:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}},{key:"makeShear",value:function(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}},{key:"compose",value:function(e,t,n){var r=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,u=i+i,l=a+a,c=o+o,h=i*u,f=i*l,d=i*c,p=a*l,A=a*c,v=o*c,m=s*u,g=s*l,y=s*c,_=n.x,b=n.y,x=n.z;return r[0]=(1-(p+v))*_,r[1]=(f+y)*_,r[2]=(d-g)*_,r[3]=0,r[4]=(f-y)*b,r[5]=(1-(h+v))*b,r[6]=(A+m)*b,r[7]=0,r[8]=(d+g)*x,r[9]=(A-m)*x,r[10]=(1-(h+p))*x,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}},{key:"decompose",value:function(e,t,n){var r=this.elements,i=ki.set(r[0],r[1],r[2]).length(),a=ki.set(r[4],r[5],r[6]).length(),o=ki.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],Mi.copy(this);var s=1/i,u=1/a,l=1/o;return Mi.elements[0]*=s,Mi.elements[1]*=s,Mi.elements[2]*=s,Mi.elements[4]*=u,Mi.elements[5]*=u,Mi.elements[6]*=u,Mi.elements[8]*=l,Mi.elements[9]*=l,Mi.elements[10]*=l,t.setFromRotationMatrix(Mi),n.x=i,n.y=a,n.z=o,this}},{key:"makePerspective",value:function(e,t,n,r,i,a){var o,s,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:or,l=this.elements,c=2*i/(t-e),h=2*i/(n-r),f=(t+e)/(t-e),d=(n+r)/(n-r);if(u===or)o=-(a+i)/(a-i),s=-2*a*i/(a-i);else{if(u!==sr)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);o=-a/(a-i),s=-a*i/(a-i)}return l[0]=c,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=h,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=o,l[14]=s,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}},{key:"makeOrthographic",value:function(e,t,n,r,i,a){var o,s,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:or,l=this.elements,c=1/(t-e),h=1/(n-r),f=1/(a-i),d=(t+e)*c,p=(n+r)*h;if(u===or)o=(a+i)*f,s=-2*f;else{if(u!==sr)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);o=i*f,s=-1*f}return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*h,l[9]=0,l[13]=-p,l[2]=0,l[6]=0,l[10]=s,l[14]=-o,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<16;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}]),e}(),ki=new Kr,Mi=new Ei,Ci=new Kr(0,0,0),Ri=new Kr(1,1,1),Pi=new Kr,Ni=new Kr,Ii=new Kr,Li=new Ei,Di=new Yr,Oi=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.DEFAULT_ORDER;c(this,t),this.isEuler=!0,this._x=e,this._y=n,this._z=r,this._order=i}return p(t,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._order)}},{key:"copy",value:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.elements,i=r[0],a=r[4],o=r[8],s=r[1],u=r[5],l=r[9],c=r[2],h=r[6],f=r[10];switch(t){case"XYZ":this._y=Math.asin(pr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-l,f),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(h,u),this._z=0);break;case"YXZ":this._x=Math.asin(-pr(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(o,f),this._z=Math.atan2(s,u)):(this._y=Math.atan2(-c,i),this._z=0);break;case"ZXY":this._x=Math.asin(pr(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-c,f),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-pr(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(h,f),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(pr(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-l,u),this._y=Math.atan2(-c,i)):(this._x=0,this._y=Math.atan2(o,f));break;case"XZY":this._z=Math.asin(-pr(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,u),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-l,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}},{key:"setFromQuaternion",value:function(e,t,n){return Li.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Li,t,n)}},{key:"setFromVector3",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}},{key:"reorder",value:function(e){return Di.setFromEuler(this),this.setFromQuaternion(Di,e)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}},{key:"fromArray",value:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}},{key:Symbol.iterator,value:ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._x;case 2:return e.next=4,this._y;case 4:return e.next=6,this._z;case 6:return e.next=8,this._order;case 8:case"end":return e.stop()}}),e,this)}))}]),t}();Oi.DEFAULT_ORDER="XYZ";var Ui=function(){function e(){c(this,e),this.mask=1}return p(e,[{key:"set",value:function(e){this.mask=(1<<e|0)>>>0}},{key:"enable",value:function(e){this.mask|=1<<e|0}},{key:"enableAll",value:function(){this.mask=-1}},{key:"toggle",value:function(e){this.mask^=1<<e|0}},{key:"disable",value:function(e){this.mask&=~(1<<e|0)}},{key:"disableAll",value:function(){this.mask=0}},{key:"test",value:function(e){return 0!==(this.mask&e.mask)}},{key:"isEnabled",value:function(e){return 0!==(this.mask&(1<<e|0))}}]),e}(),Bi=0,Fi=new Kr,zi=new Yr,Vi=new Ei,qi=new Kr,ji=new Kr,Gi=new Kr,Hi=new Yr,Wi=new Kr(1,0,0),Xi=new Kr(0,1,0),Qi=new Kr(0,0,1),Yi={type:"added"},Ki={type:"removed"},Zi={type:"childadded",child:null},Ji={type:"childremoved",child:null},$i=function(e){v(n,e);var t=b(n);function n(){var e;c(this,n),(e=t.call(this)).isObject3D=!0,Object.defineProperty(y(e),"id",{value:Bi++}),e.uuid=dr(),e.name="",e.type="Object3D",e.parent=null,e.children=[],e.up=n.DEFAULT_UP.clone();var r=new Kr,i=new Oi,a=new Yr,o=new Kr(1,1,1);return i._onChange((function(){a.setFromEuler(i,!1)})),a._onChange((function(){i.setFromQuaternion(a,void 0,!1)})),Object.defineProperties(y(e),{position:{configurable:!0,enumerable:!0,value:r},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new Ei},normalMatrix:{value:new br}}),e.matrix=new Ei,e.matrixWorld=new Ei,e.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,e.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,e.matrixWorldNeedsUpdate=!1,e.layers=new Ui,e.visible=!0,e.castShadow=!1,e.receiveShadow=!1,e.frustumCulled=!0,e.renderOrder=0,e.animations=[],e.customDepthMaterial=void 0,e.customDistanceMaterial=void 0,e.userData={},e}return p(n,[{key:"onBeforeShadow",value:function(){}},{key:"onAfterShadow",value:function(){}},{key:"onBeforeRender",value:function(){}},{key:"onAfterRender",value:function(){}},{key:"applyMatrix4",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}},{key:"applyQuaternion",value:function(e){return this.quaternion.premultiply(e),this}},{key:"setRotationFromAxisAngle",value:function(e,t){this.quaternion.setFromAxisAngle(e,t)}},{key:"setRotationFromEuler",value:function(e){this.quaternion.setFromEuler(e,!0)}},{key:"setRotationFromMatrix",value:function(e){this.quaternion.setFromRotationMatrix(e)}},{key:"setRotationFromQuaternion",value:function(e){this.quaternion.copy(e)}},{key:"rotateOnAxis",value:function(e,t){return zi.setFromAxisAngle(e,t),this.quaternion.multiply(zi),this}},{key:"rotateOnWorldAxis",value:function(e,t){return zi.setFromAxisAngle(e,t),this.quaternion.premultiply(zi),this}},{key:"rotateX",value:function(e){return this.rotateOnAxis(Wi,e)}},{key:"rotateY",value:function(e){return this.rotateOnAxis(Xi,e)}},{key:"rotateZ",value:function(e){return this.rotateOnAxis(Qi,e)}},{key:"translateOnAxis",value:function(e,t){return Fi.copy(e).applyQuaternion(this.quaternion),this.position.add(Fi.multiplyScalar(t)),this}},{key:"translateX",value:function(e){return this.translateOnAxis(Wi,e)}},{key:"translateY",value:function(e){return this.translateOnAxis(Xi,e)}},{key:"translateZ",value:function(e){return this.translateOnAxis(Qi,e)}},{key:"localToWorld",value:function(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}},{key:"worldToLocal",value:function(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Vi.copy(this.matrixWorld).invert())}},{key:"lookAt",value:function(e,t,n){e.isVector3?qi.copy(e):qi.set(e,t,n);var r=this.parent;this.updateWorldMatrix(!0,!1),ji.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Vi.lookAt(ji,qi,this.up):Vi.lookAt(qi,ji,this.up),this.quaternion.setFromRotationMatrix(Vi),r&&(Vi.extractRotation(r.matrixWorld),zi.setFromRotationMatrix(Vi),this.quaternion.premultiply(zi.invert()))}},{key:"add",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Yi),Zi.child=e,this.dispatchEvent(Zi),Zi.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}},{key:"remove",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Ki),Ji.child=e,this.dispatchEvent(Ji),Ji.child=null),this}},{key:"removeFromParent",value:function(){var e=this.parent;return null!==e&&e.remove(this),this}},{key:"clear",value:function(){return this.remove.apply(this,l(this.children))}},{key:"attach",value:function(e){return this.updateWorldMatrix(!0,!1),Vi.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Vi.multiply(e.parent.matrixWorld)),e.applyMatrix4(Vi),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Yi),Zi.child=e,this.dispatchEvent(Zi),Zi.child=null,this}},{key:"getObjectById",value:function(e){return this.getObjectByProperty("id",e)}},{key:"getObjectByName",value:function(e){return this.getObjectByProperty("name",e)}},{key:"getObjectByProperty",value:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}},{key:"getObjectsByProperty",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[e]===t&&n.push(this);for(var r=this.children,i=0,a=r.length;i<a;i++)r[i].getObjectsByProperty(e,t,n);return n}},{key:"getWorldPosition",value:function(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}},{key:"getWorldQuaternion",value:function(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ji,e,Gi),e}},{key:"getWorldScale",value:function(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ji,Hi,e),e}},{key:"getWorldDirection",value:function(e){this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}},{key:"raycast",value:function(){}},{key:"traverse",value:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)}},{key:"traverseVisible",value:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}}},{key:"traverseAncestors",value:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}},{key:"updateMatrix",value:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}},{key:"updateMatrixWorld",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++){t[n].updateMatrixWorld(e)}}},{key:"updateWorldMatrix",value:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t)for(var r=this.children,i=0,a=r.length;i<a;i++){r[i].updateWorldMatrix(!1,!0)}}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map((function(e){return{boxInitialized:e.boxInitialized,boxMin:e.box.min.toArray(),boxMax:e.box.max.toArray(),sphereInitialized:e.sphereInitialized,sphereRadius:e.sphere.radius,sphereCenter:e.sphere.center.toArray()}})),r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),null!==this._colorsTexture&&(r.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),null!==this.boundingBox&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,u=o.length;s<u;s++){var l=o[s];i(e.shapes,l)}else i(e.shapes,o)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var c=[],h=0,f=this.material.length;h<f;h++)c.push(i(e.materials,this.material[h]));r.material=c}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(var d=0;d<this.children.length;d++)r.children.push(this.children[d].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(var p=0;p<this.animations.length;p++){var A=this.animations[p];r.animations.push(i(e.animations,A))}}if(t){var v=T(e.geometries),m=T(e.materials),g=T(e.textures),y=T(e.images),_=T(e.shapes),b=T(e.skeletons),x=T(e.animations),w=T(e.nodes);v.length>0&&(n.geometries=v),m.length>0&&(n.materials=m),g.length>0&&(n.textures=g),y.length>0&&(n.images=y),_.length>0&&(n.shapes=_),b.length>0&&(n.skeletons=b),x.length>0&&(n.animations=x),w.length>0&&(n.nodes=w)}return n.object=r,n;function T(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}}},{key:"clone",value:function(e){return(new this.constructor).copy(this,e)}},{key:"copy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}}]),n}(ur);$i.DEFAULT_UP=new Kr(0,1,0),$i.DEFAULT_MATRIX_AUTO_UPDATE=!0,$i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var ea=new Kr,ta=new Kr,na=new Kr,ra=new Kr,ia=new Kr,aa=new Kr,oa=new Kr,sa=new Kr,ua=new Kr,la=new Kr,ca=new Gr,ha=new Gr,fa=new Gr,da=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Kr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Kr,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Kr;c(this,e),this.a=t,this.b=n,this.c=r}return p(e,[{key:"set",value:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}},{key:"setFromPointsAndIndices",value:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}},{key:"setFromAttributeAndIndices",value:function(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}},{key:"getArea",value:function(){return ea.subVectors(this.c,this.b),ta.subVectors(this.a,this.b),.5*ea.cross(ta).length()}},{key:"getMidpoint",value:function(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}},{key:"getNormal",value:function(t){return e.getNormal(this.a,this.b,this.c,t)}},{key:"getPlane",value:function(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}},{key:"getBarycoord",value:function(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)}},{key:"getInterpolation",value:function(t,n,r,i,a){return e.getInterpolation(t,this.a,this.b,this.c,n,r,i,a)}},{key:"containsPoint",value:function(t){return e.containsPoint(t,this.a,this.b,this.c)}},{key:"isFrontFacing",value:function(t){return e.isFrontFacing(this.a,this.b,this.c,t)}},{key:"intersectsBox",value:function(e){return e.intersectsTriangle(this)}},{key:"closestPointToPoint",value:function(e,t){var n,r,i=this.a,a=this.b,o=this.c;ia.subVectors(a,i),aa.subVectors(o,i),sa.subVectors(e,i);var s=ia.dot(sa),u=aa.dot(sa);if(s<=0&&u<=0)return t.copy(i);ua.subVectors(e,a);var l=ia.dot(ua),c=aa.dot(ua);if(l>=0&&c<=l)return t.copy(a);var h=s*c-l*u;if(h<=0&&s>=0&&l<=0)return n=s/(s-l),t.copy(i).addScaledVector(ia,n);la.subVectors(e,o);var f=ia.dot(la),d=aa.dot(la);if(d>=0&&f<=d)return t.copy(o);var p=f*u-s*d;if(p<=0&&u>=0&&d<=0)return r=u/(u-d),t.copy(i).addScaledVector(aa,r);var A=l*d-f*c;if(A<=0&&c-l>=0&&f-d>=0)return oa.subVectors(o,a),r=(c-l)/(c-l+(f-d)),t.copy(a).addScaledVector(oa,r);var v=1/(A+p+h);return n=p*v,r=h*v,t.copy(i).addScaledVector(ia,n).addScaledVector(aa,r)}},{key:"equals",value:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}],[{key:"getNormal",value:function(e,t,n,r){r.subVectors(n,t),ea.subVectors(e,t),r.cross(ea);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}},{key:"getBarycoord",value:function(e,t,n,r,i){ea.subVectors(r,t),ta.subVectors(n,t),na.subVectors(e,t);var a=ea.dot(ea),o=ea.dot(ta),s=ea.dot(na),u=ta.dot(ta),l=ta.dot(na),c=a*u-o*o;if(0===c)return i.set(0,0,0),null;var h=1/c,f=(u*s-o*l)*h,d=(a*l-o*s)*h;return i.set(1-f-d,d,f)}},{key:"containsPoint",value:function(e,t,n,r){return null!==this.getBarycoord(e,t,n,r,ra)&&(ra.x>=0&&ra.y>=0&&ra.x+ra.y<=1)}},{key:"getInterpolation",value:function(e,t,n,r,i,a,o,s){return null===this.getBarycoord(e,t,n,r,ra)?(s.x=0,s.y=0,"z"in s&&(s.z=0),"w"in s&&(s.w=0),null):(s.setScalar(0),s.addScaledVector(i,ra.x),s.addScaledVector(a,ra.y),s.addScaledVector(o,ra.z),s)}},{key:"getInterpolatedAttribute",value:function(e,t,n,r,i,a){return ca.setScalar(0),ha.setScalar(0),fa.setScalar(0),ca.fromBufferAttribute(e,t),ha.fromBufferAttribute(e,n),fa.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(ca,i.x),a.addScaledVector(ha,i.y),a.addScaledVector(fa,i.z),a}},{key:"isFrontFacing",value:function(e,t,n,r){return ea.subVectors(n,t),ta.subVectors(e,t),ea.cross(ta).dot(r)<0}}]),e}(),pa={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Aa={h:0,s:0,l:0},va={h:0,s:0,l:0};function ma(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}var ga=function(e){function t(e,n,r){return c(this,t),this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,r)}return p(t,[{key:"set",value:function(e,t,n){if(void 0===t&&void 0===n){var r=e;r&&r.isColor?this.copy(r):"number"===typeof r?this.setHex(r):"string"===typeof r&&this.setStyle(r)}else this.setRGB(e,t,n);return this}},{key:"setScalar",value:function(e){return this.r=e,this.g=e,this.b=e,this}},{key:"setHex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kn;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Dr.toWorkingColorSpace(this,t),this}},{key:"setRGB",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Dr.workingColorSpace;return this.r=e,this.g=t,this.b=n,Dr.toWorkingColorSpace(this,r),this}},{key:"setHSL",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Dr.workingColorSpace;if(e=Ar(e,1),t=pr(t,0,1),n=pr(n,0,1),0===t)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+t):n+t-n*t,a=2*n-i;this.r=ma(a,i,e+1/3),this.g=ma(a,i,e),this.b=ma(a,i,e-1/3)}return Dr.toWorkingColorSpace(this,r),this}},{key:"setStyle",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kn;function r(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^(\w+)\(([^\)]*)\)/.exec(e)){var i,a=t[1],o=t[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,n);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,n);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){var s=t[1],u=s.length;if(3===u)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,n);if(6===u)return this.setHex(parseInt(s,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}},{key:"setColorName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kn,n=pa[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}},{key:"clone",value:function(){return new this.constructor(this.r,this.g,this.b)}},{key:"copy",value:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}},{key:"copySRGBToLinear",value:function(e){return this.r=Or(e.r),this.g=Or(e.g),this.b=Or(e.b),this}},{key:"copyLinearToSRGB",value:function(e){return this.r=Ur(e.r),this.g=Ur(e.g),this.b=Ur(e.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}},{key:"getHex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kn;return Dr.fromWorkingColorSpace(ya.copy(this),e),65536*Math.round(pr(255*ya.r,0,255))+256*Math.round(pr(255*ya.g,0,255))+Math.round(pr(255*ya.b,0,255))}},{key:"getHexString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kn;return("000000"+this.getHex(e).toString(16)).slice(-6)}},{key:"getHSL",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dr.workingColorSpace;Dr.fromWorkingColorSpace(ya.copy(this),t);var n,r,i=ya.r,a=ya.g,o=ya.b,s=Math.max(i,a,o),u=Math.min(i,a,o),l=(u+s)/2;if(u===s)n=0,r=0;else{var c=s-u;switch(r=l<=.5?c/(s+u):c/(2-s-u),s){case i:n=(a-o)/c+(a<o?6:0);break;case a:n=(o-i)/c+2;break;case o:n=(i-a)/c+4}n/=6}return e.h=n,e.s=r,e.l=l,e}},{key:"getRGB",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dr.workingColorSpace;return Dr.fromWorkingColorSpace(ya.copy(this),t),e.r=ya.r,e.g=ya.g,e.b=ya.b,e}},{key:"getStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kn;Dr.fromWorkingColorSpace(ya.copy(this),e);var t=ya.r,n=ya.g,r=ya.b;return e!==Kn?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(n.toFixed(3)," ").concat(r.toFixed(3),")"):"rgb(".concat(Math.round(255*t),",").concat(Math.round(255*n),",").concat(Math.round(255*r),")")}},{key:"offsetHSL",value:function(e,t,n){return this.getHSL(Aa),this.setHSL(Aa.h+e,Aa.s+t,Aa.l+n)}},{key:"add",value:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}},{key:"addColors",value:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}},{key:"addScalar",value:function(e){return this.r+=e,this.g+=e,this.b+=e,this}},{key:"sub",value:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}},{key:"multiply",value:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}},{key:"multiplyScalar",value:function(e){return this.r*=e,this.g*=e,this.b*=e,this}},{key:"lerp",value:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}},{key:"lerpColors",value:function(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}},{key:"lerpHSL",value:function(e,t){this.getHSL(Aa),e.getHSL(va);var n=vr(Aa.h,va.h,t),r=vr(Aa.s,va.s,t),i=vr(Aa.l,va.l,t);return this.setHSL(n,r,i),this}},{key:"setFromVector3",value:function(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}},{key:"applyMatrix3",value:function(e){var t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}},{key:"equals",value:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}},{key:"fromBufferAttribute",value:function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}},{key:"toJSON",value:function(){return this.getHex()}},{key:Symbol.iterator,value:ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.r;case 2:return e.next=4,this.g;case 4:return e.next=6,this.b;case 6:case"end":return e.stop()}}),e,this)}))}]),t}(),ya=new ga;ga.NAMES=pa;var _a=0,ba=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this)).isMaterial=!0,Object.defineProperty(y(e),"id",{value:_a++}),e.uuid=dr(),e.name="",e.type="Material",e.blending=1,e.side=0,e.vertexColors=!1,e.opacity=1,e.transparent=!1,e.alphaHash=!1,e.blendSrc=wt,e.blendDst=Tt,e.blendEquation=bt,e.blendSrcAlpha=null,e.blendDstAlpha=null,e.blendEquationAlpha=null,e.blendColor=new ga(0,0,0),e.blendAlpha=0,e.depthFunc=3,e.depthTest=!0,e.depthWrite=!0,e.stencilWriteMask=255,e.stencilFunc=519,e.stencilRef=0,e.stencilFuncMask=255,e.stencilFail=er,e.stencilZFail=er,e.stencilZPass=er,e.stencilWrite=!1,e.clippingPlanes=null,e.clipIntersection=!1,e.clipShadows=!1,e.shadowSide=null,e.colorWrite=!0,e.precision=null,e.polygonOffset=!1,e.polygonOffsetFactor=0,e.polygonOffsetUnits=0,e.dithering=!1,e.alphaToCoverage=!1,e.premultipliedAlpha=!1,e.forceSinglePass=!1,e.allowOverride=!0,e.visible=!0,e.toneMapped=!0,e.userData={},e.version=0,e._alphaTest=0,e}return p(n,[{key:"alphaTest",get:function(){return this._alphaTest},set:function(e){this._alphaTest>0!==e>0&&this.version++,this._alphaTest=e}},{key:"onBeforeRender",value:function(){}},{key:"onBeforeCompile",value:function(){}},{key:"customProgramCacheKey",value:function(){return this.onBeforeCompile.toString()}},{key:"setValues",value:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE.Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."))}else console.warn("THREE.Material: parameter '".concat(t,"' has value of undefined."))}}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),this.blendSrc!==wt&&(n.blendSrc=this.blendSrc),this.blendDst!==Tt&&(n.blendDst=this.blendDst),this.blendEquation!==bt&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==er&&(n.stencilFail=this.stencilFail),this.stencilZFail!==er&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==er&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){var i=r(e.textures),a=r(e.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"onBuild",value:function(){console.warn("Material: onBuild() has been removed.")}}]),n}(ur),xa=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshBasicMaterial=!0,r.type="MeshBasicMaterial",r.color=new ga(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.envMapRotation=new Oi,r.combine=0,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.fog=!0,r.setValues(e),r}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}]),n}(ba),wa=Ta();function Ta(){for(var e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),r=new Uint32Array(512),i=new Uint32Array(512),a=0;a<256;++a){var o=a-127;o<-27?(r[a]=0,r[256|a]=32768,i[a]=24,i[256|a]=24):o<-14?(r[a]=1024>>-o-14,r[256|a]=1024>>-o-14|32768,i[a]=-o-1,i[256|a]=-o-1):o<=15?(r[a]=o+15<<10,r[256|a]=o+15<<10|32768,i[a]=13,i[256|a]=13):o<128?(r[a]=31744,r[256|a]=64512,i[a]=24,i[256|a]=24):(r[a]=31744,r[256|a]=64512,i[a]=13,i[256|a]=13)}for(var s=new Uint32Array(2048),u=new Uint32Array(64),l=new Uint32Array(64),c=1;c<1024;++c){for(var h=c<<13,f=0;0===(8388608&h);)h<<=1,f-=8388608;h&=-8388609,f+=947912704,s[c]=h|f}for(var d=1024;d<2048;++d)s[d]=939524096+(d-1024<<13);for(var p=1;p<31;++p)u[p]=p<<23;u[31]=1199570944,u[32]=2147483648;for(var A=33;A<63;++A)u[A]=2147483648+(A-32<<23);u[63]=3347054592;for(var v=1;v<64;++v)32!==v&&(l[v]=1024);return{floatView:t,uint32View:n,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:u,offsetTable:l}}function Sa(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=pr(e,-65504,65504),wa.floatView[0]=e;var t=wa.uint32View[0],n=t>>23&511;return wa.baseTable[n]+((8388607&t)>>wa.shiftTable[n])}function Ea(e){var t=e>>10;return wa.uint32View[0]=wa.mantissaTable[wa.offsetTable[t]+(1023&e)]+wa.exponentTable[t],wa.floatView[0]}var ka=new Kr,Ma=new _r,Ca=0,Ra=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(c(this,e),Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Ca++}),this.name="",this.array=t,this.itemSize=n,this.count=void 0!==t?t.length/n:0,this.normalized=r,this.usage=rr,this.updateRanges=[],this.gpuType=Wt,this.version=0}return p(e,[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"addUpdateRange",value:function(e,t){this.updateRanges.push({start:e,count:t})}},{key:"clearUpdateRanges",value:function(){this.updateRanges.length=0}},{key:"copy",value:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}},{key:"copyAt",value:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}},{key:"copyArray",value:function(e){return this.array.set(e),this}},{key:"applyMatrix3",value:function(e){if(2===this.itemSize)for(var t=0,n=this.count;t<n;t++)Ma.fromBufferAttribute(this,t),Ma.applyMatrix3(e),this.setXY(t,Ma.x,Ma.y);else if(3===this.itemSize)for(var r=0,i=this.count;r<i;r++)ka.fromBufferAttribute(this,r),ka.applyMatrix3(e),this.setXYZ(r,ka.x,ka.y,ka.z);return this}},{key:"applyMatrix4",value:function(e){for(var t=0,n=this.count;t<n;t++)ka.fromBufferAttribute(this,t),ka.applyMatrix4(e),this.setXYZ(t,ka.x,ka.y,ka.z);return this}},{key:"applyNormalMatrix",value:function(e){for(var t=0,n=this.count;t<n;t++)ka.fromBufferAttribute(this,t),ka.applyNormalMatrix(e),this.setXYZ(t,ka.x,ka.y,ka.z);return this}},{key:"transformDirection",value:function(e){for(var t=0,n=this.count;t<n;t++)ka.fromBufferAttribute(this,t),ka.transformDirection(e),this.setXYZ(t,ka.x,ka.y,ka.z);return this}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}},{key:"getComponent",value:function(e,t){var n=this.array[e*this.itemSize+t];return this.normalized&&(n=mr(n,this.array)),n}},{key:"setComponent",value:function(e,t,n){return this.normalized&&(n=gr(n,this.array)),this.array[e*this.itemSize+t]=n,this}},{key:"getX",value:function(e){var t=this.array[e*this.itemSize];return this.normalized&&(t=mr(t,this.array)),t}},{key:"setX",value:function(e,t){return this.normalized&&(t=gr(t,this.array)),this.array[e*this.itemSize]=t,this}},{key:"getY",value:function(e){var t=this.array[e*this.itemSize+1];return this.normalized&&(t=mr(t,this.array)),t}},{key:"setY",value:function(e,t){return this.normalized&&(t=gr(t,this.array)),this.array[e*this.itemSize+1]=t,this}},{key:"getZ",value:function(e){var t=this.array[e*this.itemSize+2];return this.normalized&&(t=mr(t,this.array)),t}},{key:"setZ",value:function(e,t){return this.normalized&&(t=gr(t,this.array)),this.array[e*this.itemSize+2]=t,this}},{key:"getW",value:function(e){var t=this.array[e*this.itemSize+3];return this.normalized&&(t=mr(t,this.array)),t}},{key:"setW",value:function(e,t){return this.normalized&&(t=gr(t,this.array)),this.array[e*this.itemSize+3]=t,this}},{key:"setXY",value:function(e,t,n){return e*=this.itemSize,this.normalized&&(t=gr(t,this.array),n=gr(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}},{key:"setXYZ",value:function(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=gr(t,this.array),n=gr(n,this.array),r=gr(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}},{key:"setXYZW",value:function(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=gr(t,this.array),n=gr(n,this.array),r=gr(r,this.array),i=gr(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}},{key:"onUpload",value:function(e){return this.onUploadCallback=e,this}},{key:"clone",value:function(){return new this.constructor(this.array,this.itemSize).copy(this)}},{key:"toJSON",value:function(){var e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==rr&&(e.usage=this.usage),e}}]),e}(),Pa=function(e){v(n,e);var t=b(n);function n(e,r,i){return c(this,n),t.call(this,new Uint16Array(e),r,i)}return p(n)}(Ra),Na=function(e){v(n,e);var t=b(n);function n(e,r,i){return c(this,n),t.call(this,new Uint32Array(e),r,i)}return p(n)}(Ra),Ia=function(e){v(n,e);var t=b(n);function n(e,r,i){var a;return c(this,n),(a=t.call(this,new Uint16Array(e),r,i)).isFloat16BufferAttribute=!0,a}return p(n,[{key:"getX",value:function(e){var t=Ea(this.array[e*this.itemSize]);return this.normalized&&(t=mr(t,this.array)),t}},{key:"setX",value:function(e,t){return this.normalized&&(t=gr(t,this.array)),this.array[e*this.itemSize]=Sa(t),this}},{key:"getY",value:function(e){var t=Ea(this.array[e*this.itemSize+1]);return this.normalized&&(t=mr(t,this.array)),t}},{key:"setY",value:function(e,t){return this.normalized&&(t=gr(t,this.array)),this.array[e*this.itemSize+1]=Sa(t),this}},{key:"getZ",value:function(e){var t=Ea(this.array[e*this.itemSize+2]);return this.normalized&&(t=mr(t,this.array)),t}},{key:"setZ",value:function(e,t){return this.normalized&&(t=gr(t,this.array)),this.array[e*this.itemSize+2]=Sa(t),this}},{key:"getW",value:function(e){var t=Ea(this.array[e*this.itemSize+3]);return this.normalized&&(t=mr(t,this.array)),t}},{key:"setW",value:function(e,t){return this.normalized&&(t=gr(t,this.array)),this.array[e*this.itemSize+3]=Sa(t),this}},{key:"setXY",value:function(e,t,n){return e*=this.itemSize,this.normalized&&(t=gr(t,this.array),n=gr(n,this.array)),this.array[e+0]=Sa(t),this.array[e+1]=Sa(n),this}},{key:"setXYZ",value:function(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=gr(t,this.array),n=gr(n,this.array),r=gr(r,this.array)),this.array[e+0]=Sa(t),this.array[e+1]=Sa(n),this.array[e+2]=Sa(r),this}},{key:"setXYZW",value:function(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=gr(t,this.array),n=gr(n,this.array),r=gr(r,this.array),i=gr(i,this.array)),this.array[e+0]=Sa(t),this.array[e+1]=Sa(n),this.array[e+2]=Sa(r),this.array[e+3]=Sa(i),this}}]),n}(Ra),La=function(e){v(n,e);var t=b(n);function n(e,r,i){return c(this,n),t.call(this,new Float32Array(e),r,i)}return p(n)}(Ra),Da=0,Oa=new Ei,Ua=new $i,Ba=new Kr,Fa=new $r,za=new $r,Va=new Kr,qa=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this)).isBufferGeometry=!0,Object.defineProperty(y(e),"id",{value:Da++}),e.uuid=dr(),e.name="",e.type="BufferGeometry",e.index=null,e.indirect=null,e.attributes={},e.morphAttributes={},e.morphTargetsRelative=!1,e.groups=[],e.boundingBox=null,e.boundingSphere=null,e.drawRange={start:0,count:1/0},e.userData={},e}return p(n,[{key:"getIndex",value:function(){return this.index}},{key:"setIndex",value:function(e){return Array.isArray(e)?this.index=new(wr(e)?Na:Pa)(e,1):this.index=e,this}},{key:"setIndirect",value:function(e){return this.indirect=e,this}},{key:"getIndirect",value:function(){return this.indirect}},{key:"getAttribute",value:function(e){return this.attributes[e]}},{key:"setAttribute",value:function(e,t){return this.attributes[e]=t,this}},{key:"deleteAttribute",value:function(e){return delete this.attributes[e],this}},{key:"hasAttribute",value:function(e){return void 0!==this.attributes[e]}},{key:"addGroup",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}},{key:"clearGroups",value:function(){this.groups=[]}},{key:"setDrawRange",value:function(e,t){this.drawRange.start=e,this.drawRange.count=t}},{key:"applyMatrix4",value:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new br).getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}},{key:"applyQuaternion",value:function(e){return Oa.makeRotationFromQuaternion(e),this.applyMatrix4(Oa),this}},{key:"rotateX",value:function(e){return Oa.makeRotationX(e),this.applyMatrix4(Oa),this}},{key:"rotateY",value:function(e){return Oa.makeRotationY(e),this.applyMatrix4(Oa),this}},{key:"rotateZ",value:function(e){return Oa.makeRotationZ(e),this.applyMatrix4(Oa),this}},{key:"translate",value:function(e,t,n){return Oa.makeTranslation(e,t,n),this.applyMatrix4(Oa),this}},{key:"scale",value:function(e,t,n){return Oa.makeScale(e,t,n),this.applyMatrix4(Oa),this}},{key:"lookAt",value:function(e){return Ua.lookAt(e),Ua.updateMatrix(),this.applyMatrix4(Ua.matrix),this}},{key:"center",value:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ba).negate(),this.translate(Ba.x,Ba.y,Ba.z),this}},{key:"setFromPoints",value:function(e){var t=this.getAttribute("position");if(void 0===t){for(var n=[],r=0,i=e.length;r<i;r++){var a=e[r];n.push(a.x,a.y,a.z||0)}this.setAttribute("position",new La(n,3))}else{for(var o=Math.min(e.length,t.count),s=0;s<o;s++){var u=e[s];t.setXYZ(s,u.x,u.y,u.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}},{key:"computeBoundingBox",value:function(){null===this.boundingBox&&(this.boundingBox=new $r);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new Kr(-1/0,-1/0,-1/0),new Kr(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var i=t[n];Fa.setFromBufferAttribute(i),this.morphTargetsRelative?(Va.addVectors(this.boundingBox.min,Fa.min),this.boundingBox.expandByPoint(Va),Va.addVectors(this.boundingBox.max,Fa.max),this.boundingBox.expandByPoint(Va)):(this.boundingBox.expandByPoint(Fa.min),this.boundingBox.expandByPoint(Fa.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}},{key:"computeBoundingSphere",value:function(){null===this.boundingSphere&&(this.boundingSphere=new mi);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new Kr,1/0);if(e){var n=this.boundingSphere.center;if(Fa.setFromBufferAttribute(e),t)for(var r=0,i=t.length;r<i;r++){var a=t[r];za.setFromBufferAttribute(a),this.morphTargetsRelative?(Va.addVectors(Fa.min,za.min),Fa.expandByPoint(Va),Va.addVectors(Fa.max,za.max),Fa.expandByPoint(Va)):(Fa.expandByPoint(za.min),Fa.expandByPoint(za.max))}Fa.getCenter(n);for(var o=0,s=0,u=e.count;s<u;s++)Va.fromBufferAttribute(e,s),o=Math.max(o,n.distanceToSquared(Va));if(t)for(var l=0,c=t.length;l<c;l++)for(var h=t[l],f=this.morphTargetsRelative,d=0,p=h.count;d<p;d++)Va.fromBufferAttribute(h,d),f&&(Ba.fromBufferAttribute(e,d),Va.add(Ba)),o=Math.max(o,n.distanceToSquared(Va));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}},{key:"computeTangents",value:function(){var e=this.index,t=this.attributes;if(null!==e&&void 0!==t.position&&void 0!==t.normal&&void 0!==t.uv){var n=t.position,r=t.normal,i=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Ra(new Float32Array(4*n.count),4));for(var a=this.getAttribute("tangent"),o=[],s=[],u=0;u<n.count;u++)o[u]=new Kr,s[u]=new Kr;var l=new Kr,c=new Kr,h=new Kr,f=new _r,d=new _r,p=new _r,A=new Kr,v=new Kr,m=this.groups;0===m.length&&(m=[{start:0,count:e.count}]);for(var g=0,y=m.length;g<y;++g)for(var _=m[g],b=_.start,x=b,w=b+_.count;x<w;x+=3)L(e.getX(x+0),e.getX(x+1),e.getX(x+2));for(var T=new Kr,S=new Kr,E=new Kr,k=new Kr,M=0,C=m.length;M<C;++M)for(var R=m[M],P=R.start,N=P,I=P+R.count;N<I;N+=3)D(e.getX(N+0)),D(e.getX(N+1)),D(e.getX(N+2))}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function L(e,t,r){l.fromBufferAttribute(n,e),c.fromBufferAttribute(n,t),h.fromBufferAttribute(n,r),f.fromBufferAttribute(i,e),d.fromBufferAttribute(i,t),p.fromBufferAttribute(i,r),c.sub(l),h.sub(l),d.sub(f),p.sub(f);var a=1/(d.x*p.y-p.x*d.y);isFinite(a)&&(A.copy(c).multiplyScalar(p.y).addScaledVector(h,-d.y).multiplyScalar(a),v.copy(h).multiplyScalar(d.x).addScaledVector(c,-p.x).multiplyScalar(a),o[e].add(A),o[t].add(A),o[r].add(A),s[e].add(v),s[t].add(v),s[r].add(v))}function D(e){E.fromBufferAttribute(r,e),k.copy(E);var t=o[e];T.copy(t),T.sub(E.multiplyScalar(E.dot(t))).normalize(),S.crossVectors(k,t);var n=S.dot(s[e])<0?-1:1;a.setXYZW(e,T.x,T.y,T.z,n)}}},{key:"computeVertexNormals",value:function(){var e=this.index,t=this.getAttribute("position");if(void 0!==t){var n=this.getAttribute("normal");if(void 0===n)n=new Ra(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(var r=0,i=n.count;r<i;r++)n.setXYZ(r,0,0,0);var a=new Kr,o=new Kr,s=new Kr,u=new Kr,l=new Kr,c=new Kr,h=new Kr,f=new Kr;if(e)for(var d=0,p=e.count;d<p;d+=3){var A=e.getX(d+0),v=e.getX(d+1),m=e.getX(d+2);a.fromBufferAttribute(t,A),o.fromBufferAttribute(t,v),s.fromBufferAttribute(t,m),h.subVectors(s,o),f.subVectors(a,o),h.cross(f),u.fromBufferAttribute(n,A),l.fromBufferAttribute(n,v),c.fromBufferAttribute(n,m),u.add(h),l.add(h),c.add(h),n.setXYZ(A,u.x,u.y,u.z),n.setXYZ(v,l.x,l.y,l.z),n.setXYZ(m,c.x,c.y,c.z)}else for(var g=0,y=t.count;g<y;g+=3)a.fromBufferAttribute(t,g+0),o.fromBufferAttribute(t,g+1),s.fromBufferAttribute(t,g+2),h.subVectors(s,o),f.subVectors(a,o),h.cross(f),n.setXYZ(g+0,h.x,h.y,h.z),n.setXYZ(g+1,h.x,h.y,h.z),n.setXYZ(g+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}}},{key:"normalizeNormals",value:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)Va.fromBufferAttribute(e,t),Va.normalize(),e.setXYZ(t,Va.x,Va.y,Va.z)}},{key:"toNonIndexed",value:function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=e.normalized,a=new n.constructor(t.length*r),o=0,s=0,u=0,l=t.length;u<l;u++){o=e.isInterleavedBufferAttribute?t[u]*e.data.stride+e.offset:t[u]*r;for(var c=0;c<r;c++)a[s++]=n[o++]}return new Ra(a,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var t=new n,r=this.index.array,i=this.attributes;for(var a in i){var o=e(i[a],r);t.setAttribute(a,o)}var s=this.morphAttributes;for(var u in s){for(var l=[],c=s[u],h=0,f=c.length;h<f;h++){var d=e(c[h],r);l.push(d)}t.morphAttributes[u]=l}t.morphTargetsRelative=this.morphTargetsRelative;for(var p=this.groups,A=0,v=p.length;A<v;A++){var m=p[A];t.addGroup(m.start,m.count,m.materialIndex)}return t}},{key:"toJSON",value:function(){var e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var a in i){var o=i[a];e.data.attributes[a]=o.toJSON(e.data)}var s={},u=!1;for(var l in this.morphAttributes){for(var c=this.morphAttributes[l],h=[],f=0,d=c.length;f<d;f++){var p=c[f];h.push(p.toJSON(e.data))}h.length>0&&(s[l]=h,u=!0)}u&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);var A=this.groups;A.length>0&&(e.data.groups=JSON.parse(JSON.stringify(A)));var v=this.boundingSphere;return null!==v&&(e.data.boundingSphere={center:v.center.toArray(),radius:v.radius}),e}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var t={};this.name=e.name;var n=e.index;null!==n&&this.setIndex(n.clone());var r=e.attributes;for(var i in r){var a=r[i];this.setAttribute(i,a.clone(t))}var o=e.morphAttributes;for(var s in o){for(var u=[],l=o[s],c=0,h=l.length;c<h;c++)u.push(l[c].clone(t));this.morphAttributes[s]=u}this.morphTargetsRelative=e.morphTargetsRelative;for(var f=e.groups,d=0,p=f.length;d<p;d++){var A=f[d];this.addGroup(A.start,A.count,A.materialIndex)}var v=e.boundingBox;null!==v&&(this.boundingBox=v.clone());var m=e.boundingSphere;return null!==m&&(this.boundingSphere=m.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(ur),ja=new Ei,Ga=new Si,Ha=new mi,Wa=new Kr,Xa=new Kr,Qa=new Kr,Ya=new Kr,Ka=new Kr,Za=new Kr,Ja=new Kr,$a=new Kr,eo=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qa,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new xa;return c(this,n),(e=t.call(this)).isMesh=!0,e.type="Mesh",e.geometry=r,e.material=i,e.morphTargetDictionary=void 0,e.morphTargetInfluences=void 0,e.updateMorphTargets(),e}return p(n,[{key:"copy",value:function(e,t){return ht(m(n.prototype),"copy",this).call(this,e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}},{key:"updateMorphTargets",value:function(){var e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){var n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var r=0,i=n.length;r<i;r++){var a=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}},{key:"getVertexPosition",value:function(e,t){var n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);var o=this.morphTargetInfluences;if(i&&o){Za.set(0,0,0);for(var s=0,u=i.length;s<u;s++){var l=o[s],c=i[s];0!==l&&(Ka.fromBufferAttribute(c,e),a?Za.addScaledVector(Ka,l):Za.addScaledVector(Ka.sub(t),l))}t.add(Za)}return t}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r){if(null===n.boundingSphere&&n.computeBoundingSphere(),Ha.copy(n.boundingSphere),Ha.applyMatrix4(i),Ga.copy(e.ray).recast(e.near),!1===Ha.containsPoint(Ga.origin)){if(null===Ga.intersectSphere(Ha,Wa))return;if(Ga.origin.distanceToSquared(Wa)>Math.pow(e.far-e.near,2))return}ja.copy(i).invert(),Ga.copy(e.ray).applyMatrix4(ja),null!==n.boundingBox&&!1===Ga.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,Ga)}}},{key:"_computeIntersections",value:function(e,t,n){var r,i=this.geometry,a=this.material,o=i.index,s=i.attributes.position,u=i.attributes.uv,l=i.attributes.uv1,c=i.attributes.normal,h=i.groups,f=i.drawRange;if(null!==o)if(Array.isArray(a))for(var d=0,p=h.length;d<p;d++)for(var A=h[d],v=a[A.materialIndex],m=Math.max(A.start,f.start),g=Math.min(o.count,Math.min(A.start+A.count,f.start+f.count));m<g;m+=3){(r=to(this,v,e,n,u,l,c,o.getX(m),o.getX(m+1),o.getX(m+2)))&&(r.faceIndex=Math.floor(m/3),r.face.materialIndex=A.materialIndex,t.push(r))}else for(var y=Math.max(0,f.start),_=Math.min(o.count,f.start+f.count);y<_;y+=3){(r=to(this,a,e,n,u,l,c,o.getX(y),o.getX(y+1),o.getX(y+2)))&&(r.faceIndex=Math.floor(y/3),t.push(r))}else if(void 0!==s)if(Array.isArray(a))for(var b=0,x=h.length;b<x;b++)for(var w=h[b],T=a[w.materialIndex],S=Math.max(w.start,f.start),E=Math.min(s.count,Math.min(w.start+w.count,f.start+f.count));S<E;S+=3){(r=to(this,T,e,n,u,l,c,S,S+1,S+2))&&(r.faceIndex=Math.floor(S/3),r.face.materialIndex=w.materialIndex,t.push(r))}else for(var k=Math.max(0,f.start),M=Math.min(s.count,f.start+f.count);k<M;k+=3){(r=to(this,a,e,n,u,l,c,k,k+1,k+2))&&(r.faceIndex=Math.floor(k/3),t.push(r))}}}]),n}($i);function to(e,t,n,r,i,a,o,s,u,l){e.getVertexPosition(s,Xa),e.getVertexPosition(u,Qa),e.getVertexPosition(l,Ya);var c=function(e,t,n,r,i,a,o,s){if(null===(1===t.side?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,0===t.side,s)))return null;$a.copy(s),$a.applyMatrix4(e.matrixWorld);var u=n.ray.origin.distanceTo($a);return u<n.near||u>n.far?null:{distance:u,point:$a.clone(),object:e}}(e,t,n,r,Xa,Qa,Ya,Ja);if(c){var h=new Kr;da.getBarycoord(Ja,Xa,Qa,Ya,h),i&&(c.uv=da.getInterpolatedAttribute(i,s,u,l,h,new _r)),a&&(c.uv1=da.getInterpolatedAttribute(a,s,u,l,h,new _r)),o&&(c.normal=da.getInterpolatedAttribute(o,s,u,l,h,new Kr),c.normal.dot(r.direction)>0&&c.normal.multiplyScalar(-1));var f={a:s,b:u,c:l,normal:new Kr,materialIndex:0};da.getNormal(Xa,Qa,Ya,f.normal),c.face=f,c.barycoord=h}return c}var no=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;c(this,n),(e=t.call(this)).type="BoxGeometry",e.parameters={width:r,height:i,depth:a,widthSegments:o,heightSegments:s,depthSegments:u};var l=y(e);o=Math.floor(o),s=Math.floor(s),u=Math.floor(u);var h=[],f=[],d=[],p=[],A=0,v=0;function m(e,t,n,r,i,a,o,s,u,c,m){for(var g=a/u,y=o/c,_=a/2,b=o/2,x=s/2,w=u+1,T=c+1,S=0,E=0,k=new Kr,M=0;M<T;M++)for(var C=M*y-b,R=0;R<w;R++){var P=R*g-_;k[e]=P*r,k[t]=C*i,k[n]=x,f.push(k.x,k.y,k.z),k[e]=0,k[t]=0,k[n]=s>0?1:-1,d.push(k.x,k.y,k.z),p.push(R/u),p.push(1-M/c),S+=1}for(var N=0;N<c;N++)for(var I=0;I<u;I++){var L=A+I+w*N,D=A+I+w*(N+1),O=A+(I+1)+w*(N+1),U=A+(I+1)+w*N;h.push(L,D,U),h.push(D,O,U),E+=6}l.addGroup(v,E,m),v+=E,A+=S}return m("z","y","x",-1,-1,a,i,r,u,s,0),m("z","y","x",1,-1,a,i,-r,u,s,1),m("x","z","y",1,1,r,a,i,o,u,2),m("x","z","y",1,-1,r,a,-i,o,u,3),m("x","y","z",1,-1,r,i,a,o,s,4),m("x","y","z",-1,-1,r,i,-a,o,s,5),e.setIndex(h),e.setAttribute("position",new La(f,3)),e.setAttribute("normal",new La(d,3)),e.setAttribute("uv",new La(p,2)),e}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}]),n}(qa);function ro(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][r]=null):t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}function io(e){for(var t={},n=0;n<e.length;n++){var r=ro(e[n]);for(var i in r)t[i]=r[i]}return t}function ao(e){var t=e.getRenderTarget();return null===t?e.outputColorSpace:!0===t.isXRRenderTarget?t.texture.colorSpace:Dr.workingColorSpace}var oo={clone:ro,merge:io},so=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isShaderMaterial=!0,r.type="ShaderMaterial",r.defines={},r.uniforms={},r.uniformsGroups=[],r.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",r.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",r.linewidth=1,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.lights=!1,r.clipping=!1,r.forceSinglePass=!0,r.extensions={clipCullDistance:!1,multiDraw:!1},r.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},r.index0AttributeName=void 0,r.uniformsNeedUpdate=!1,r.glslVersion=null,void 0!==e&&r.setValues(e),r}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ro(e.uniforms),this.uniformsGroups=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}},{key:"toJSON",value:function(e){var t=ht(m(n.prototype),"toJSON",this).call(this,e);for(var r in t.glslVersion=this.glslVersion,t.uniforms={},this.uniforms){var i=this.uniforms[r].value;i&&i.isTexture?t.uniforms[r]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[r]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[r]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[r]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[r]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[r]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[r]={type:"m4",value:i.toArray()}:t.uniforms[r]={value:i}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;var a={};for(var o in this.extensions)!0===this.extensions[o]&&(a[o]=!0);return Object.keys(a).length>0&&(t.extensions=a),t}}]),n}(ba),uo=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this)).isCamera=!0,e.type="Camera",e.matrixWorldInverse=new Ei,e.projectionMatrix=new Ei,e.projectionMatrixInverse=new Ei,e.coordinateSystem=or,e}return p(n,[{key:"copy",value:function(e,t){return ht(m(n.prototype),"copy",this).call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}},{key:"getWorldDirection",value:function(e){return ht(m(n.prototype),"getWorldDirection",this).call(this,e).negate()}},{key:"updateMatrixWorld",value:function(e){ht(m(n.prototype),"updateMatrixWorld",this).call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"updateWorldMatrix",value:function(e,t){ht(m(n.prototype),"updateWorldMatrix",this).call(this,e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),n}($i),lo=new Kr,co=new _r,ho=new _r,fo=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;return c(this,n),(e=t.call(this)).isPerspectiveCamera=!0,e.type="PerspectiveCamera",e.fov=r,e.zoom=1,e.near=a,e.far=o,e.focus=10,e.aspect=i,e.view=null,e.filmGauge=35,e.filmOffset=0,e.updateProjectionMatrix(),e}return p(n,[{key:"copy",value:function(e,t){return ht(m(n.prototype),"copy",this).call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}},{key:"setFocalLength",value:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*fr*Math.atan(t),this.updateProjectionMatrix()}},{key:"getFocalLength",value:function(){var e=Math.tan(.5*hr*this.fov);return.5*this.getFilmHeight()/e}},{key:"getEffectiveFOV",value:function(){return 2*fr*Math.atan(Math.tan(.5*hr*this.fov)/this.zoom)}},{key:"getFilmWidth",value:function(){return this.filmGauge*Math.min(this.aspect,1)}},{key:"getFilmHeight",value:function(){return this.filmGauge/Math.max(this.aspect,1)}},{key:"getViewBounds",value:function(e,t,n){lo.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(lo.x,lo.y).multiplyScalar(-e/lo.z),lo.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(lo.x,lo.y).multiplyScalar(-e/lo.z)}},{key:"getViewSize",value:function(e,t){return this.getViewBounds(e,co,ho),t.subVectors(ho,co)}},{key:"setViewOffset",value:function(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=this.near,t=e*Math.tan(.5*hr*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/o,t-=a.offsetY*n/s,r*=a.width/o,n*=a.height/s}var u=this.filmOffset;0!==u&&(i+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var t=ht(m(n.prototype),"toJSON",this).call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}]),n}(uo),po=-90,Ao=function(e){v(n,e);var t=b(n);function n(e,r,i){var a;c(this,n),(a=t.call(this)).type="CubeCamera",a.renderTarget=i,a.coordinateSystem=null,a.activeMipmapLevel=0;var o=new fo(po,1,e,r);o.layers=a.layers,a.add(o);var s=new fo(po,1,e,r);s.layers=a.layers,a.add(s);var u=new fo(po,1,e,r);u.layers=a.layers,a.add(u);var l=new fo(po,1,e,r);l.layers=a.layers,a.add(l);var h=new fo(po,1,e,r);h.layers=a.layers,a.add(h);var f=new fo(po,1,e,r);return f.layers=a.layers,a.add(f),a}return p(n,[{key:"updateCoordinateSystem",value:function(){var e,t=this.coordinateSystem,n=this.children.concat(),r=T(n,6),i=r[0],a=r[1],o=r[2],s=r[3],u=r[4],l=r[5],c=k(n);try{for(c.s();!(e=c.n()).done;){var h=e.value;this.remove(h)}}catch(A){c.e(A)}finally{c.f()}if(t===or)i.up.set(0,1,0),i.lookAt(1,0,0),a.up.set(0,1,0),a.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),u.up.set(0,1,0),u.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else{if(t!==sr)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);i.up.set(0,-1,0),i.lookAt(-1,0,0),a.up.set(0,-1,0),a.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),u.up.set(0,-1,0),u.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1)}var f,d=k(n);try{for(d.s();!(f=d.n()).done;){var p=f.value;this.add(p),p.updateMatrixWorld()}}catch(A){d.e(A)}finally{d.f()}}},{key:"update",value:function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,r=this.activeMipmapLevel;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());var i=T(this.children,6),a=i[0],o=i[1],s=i[2],u=i[3],l=i[4],c=i[5],h=e.getRenderTarget(),f=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;var A=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,a),e.setRenderTarget(n,1,r),e.render(t,o),e.setRenderTarget(n,2,r),e.render(t,s),e.setRenderTarget(n,3,r),e.render(t,u),e.setRenderTarget(n,4,r),e.render(t,l),n.texture.generateMipmaps=A,e.setRenderTarget(n,5,r),e.render(t,c),e.setRenderTarget(h,f,d),e.xr.enabled=p,n.texture.needsPMREMUpdate=!0}}]),n}($i),vo=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Et,a=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0,h=arguments.length>7?arguments[7]:void 0,f=arguments.length>8?arguments[8]:void 0,d=arguments.length>9?arguments[9]:void 0;return c(this,n),(e=t.call(this,r,i,a,o,s,u,l,h,f,d)).isCubeTexture=!0,e.flipY=!1,e}return p(n,[{key:"images",get:function(){return this.image},set:function(e){this.image=e}}]),n}(jr),mo=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};c(this,n),(e=t.call(this,r,r,i)).isWebGLCubeRenderTarget=!0;var a={width:r,height:r,depth:1},o=[a,a,a,a,a,a];return e.texture=new vo(o,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),e.texture.isRenderTargetTexture=!0,e.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,e.texture.minFilter=void 0!==i.minFilter?i.minFilter:Ut,e}return p(n,[{key:"fromEquirectangularTexture",value:function(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",a=new no(5,5,5),o=new so({name:"CubemapFromEquirect",uniforms:ro(n),vertexShader:r,fragmentShader:i,side:1,blending:0});o.uniforms.tEquirect.value=t;var s=new eo(a,o),u=t.minFilter;return t.minFilter===Ft&&(t.minFilter=Ut),new Ao(1,10,this).update(e,s),t.minFilter=u,s.geometry.dispose(),s.material.dispose(),this}},{key:"clear",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=e.getRenderTarget(),a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}}]),n}(Wr),go=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this)).isGroup=!0,e.type="Group",e}return p(n)}($i),yo={type:"move"},_o=function(){function e(){c(this,e),this._targetRay=null,this._grip=null,this._hand=null}return p(e,[{key:"getHandSpace",value:function(){return null===this._hand&&(this._hand=new go,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}},{key:"getTargetRaySpace",value:function(){return null===this._targetRay&&(this._targetRay=new go,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Kr,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Kr),this._targetRay}},{key:"getGripSpace",value:function(){return null===this._grip&&(this._grip=new go,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Kr,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Kr),this._grip}},{key:"dispatchEvent",value:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}},{key:"connect",value:function(e){if(e&&e.hand){var t=this._hand;if(t){var n,r=k(e.hand.values());try{for(r.s();!(n=r.n()).done;){var i=n.value;this._getHandJoint(t,i)}}catch(a){r.e(a)}finally{r.f()}}}return this.dispatchEvent({type:"connected",data:e}),this}},{key:"disconnect",value:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}},{key:"update",value:function(e,t,n){var r=null,i=null,a=null,o=this._targetRay,s=this._grip,u=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(u&&e.hand){a=!0;var l,c=k(e.hand.values());try{for(c.s();!(l=c.n()).done;){var h=l.value,f=t.getJointPose(h,n),d=this._getHandJoint(u,h);null!==f&&(d.matrix.fromArray(f.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,d.jointRadius=f.radius),d.visible=null!==f}}catch(m){c.e(m)}finally{c.f()}var p=u.joints["index-finger-tip"],A=u.joints["thumb-tip"],v=p.position.distanceTo(A.position);u.inputState.pinching&&v>.025?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&v<=.015&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==s&&e.gripSpace&&null!==(i=t.getPose(e.gripSpace,n))&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,i.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(i.linearVelocity)):s.hasLinearVelocity=!1,i.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(i.angularVelocity)):s.hasAngularVelocity=!1);null!==o&&(null===(r=t.getPose(e.targetRaySpace,n))&&null!==i&&(r=i),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(yo)))}return null!==o&&(o.visible=null!==r),null!==s&&(s.visible=null!==i),null!==u&&(u.visible=null!==a),this}},{key:"_getHandJoint",value:function(e,t){if(void 0===e.joints[t.jointName]){var n=new go;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}]),e}(),bo=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this)).isScene=!0,e.type="Scene",e.background=null,e.environment=null,e.fog=null,e.backgroundBlurriness=0,e.backgroundIntensity=1,e.backgroundRotation=new Oi,e.environmentIntensity=1,e.environmentRotation=new Oi,e.overrideMaterial=null,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:y(e)})),e}return p(n,[{key:"copy",value:function(e,t){return ht(m(n.prototype),"copy",this).call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}},{key:"toJSON",value:function(e){var t=ht(m(n.prototype),"toJSON",this).call(this,e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}]),n}($i),xo=function(){function e(t,n){c(this,e),this.isInterleavedBuffer=!0,this.array=t,this.stride=n,this.count=void 0!==t?t.length/n:0,this.usage=rr,this.updateRanges=[],this.version=0,this.uuid=dr()}return p(e,[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"addUpdateRange",value:function(e,t){this.updateRanges.push({start:e,count:t})}},{key:"clearUpdateRanges",value:function(){this.updateRanges.length=0}},{key:"copy",value:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}},{key:"copyAt",value:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}},{key:"clone",value:function(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=dr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}},{key:"onUpload",value:function(e){return this.onUploadCallback=e,this}},{key:"toJSON",value:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=dr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}]),e}(),wo=new Kr,To=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];c(this,e),this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=n,this.offset=r,this.normalized=i}return p(e,[{key:"count",get:function(){return this.data.count}},{key:"array",get:function(){return this.data.array}},{key:"needsUpdate",set:function(e){this.data.needsUpdate=e}},{key:"applyMatrix4",value:function(e){for(var t=0,n=this.data.count;t<n;t++)wo.fromBufferAttribute(this,t),wo.applyMatrix4(e),this.setXYZ(t,wo.x,wo.y,wo.z);return this}},{key:"applyNormalMatrix",value:function(e){for(var t=0,n=this.count;t<n;t++)wo.fromBufferAttribute(this,t),wo.applyNormalMatrix(e),this.setXYZ(t,wo.x,wo.y,wo.z);return this}},{key:"transformDirection",value:function(e){for(var t=0,n=this.count;t<n;t++)wo.fromBufferAttribute(this,t),wo.transformDirection(e),this.setXYZ(t,wo.x,wo.y,wo.z);return this}},{key:"getComponent",value:function(e,t){var n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=mr(n,this.array)),n}},{key:"setComponent",value:function(e,t,n){return this.normalized&&(n=gr(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}},{key:"setX",value:function(e,t){return this.normalized&&(t=gr(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}},{key:"setY",value:function(e,t){return this.normalized&&(t=gr(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}},{key:"setZ",value:function(e,t){return this.normalized&&(t=gr(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}},{key:"setW",value:function(e,t){return this.normalized&&(t=gr(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}},{key:"getX",value:function(e){var t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=mr(t,this.array)),t}},{key:"getY",value:function(e){var t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=mr(t,this.array)),t}},{key:"getZ",value:function(e){var t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=mr(t,this.array)),t}},{key:"getW",value:function(e){var t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=mr(t,this.array)),t}},{key:"setXY",value:function(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=gr(t,this.array),n=gr(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}},{key:"setXYZ",value:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=gr(t,this.array),n=gr(n,this.array),r=gr(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}},{key:"setXYZW",value:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=gr(t,this.array),n=gr(n,this.array),r=gr(r,this.array),i=gr(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}},{key:"clone",value:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");for(var n=[],r=0;r<this.count;r++)for(var i=r*this.data.stride+this.offset,a=0;a<this.itemSize;a++)n.push(this.data.array[i+a]);return new Ra(new this.array.constructor(n),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new e(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}},{key:"toJSON",value:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,i=0;i<this.itemSize;i++)t.push(this.data.array[r+i]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}]),e}(),So=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isSpriteMaterial=!0,r.type="SpriteMaterial",r.color=new ga(16777215),r.map=null,r.alphaMap=null,r.rotation=0,r.sizeAttenuation=!0,r.transparent=!0,r.fog=!0,r.setValues(e),r}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}]),n}(ba);var Eo=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0,h=arguments.length>7?arguments[7]:void 0,f=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Lt,d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:Lt,p=arguments.length>10?arguments[10]:void 0,A=arguments.length>11?arguments[11]:void 0;return c(this,n),(e=t.call(this,null,u,l,h,f,d,o,s,p,A)).isDataTexture=!0,e.image={data:r,width:i,height:a},e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e}return p(n)}(jr),ko=function(e){v(n,e);var t=b(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return c(this,n),(a=t.call(this,e,r,i)).isInstancedBufferAttribute=!0,a.meshPerAttribute=o,a}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}},{key:"toJSON",value:function(){var e=ht(m(n.prototype),"toJSON",this).call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}]),n}(Ra),Mo=new Kr,Co=new Kr,Ro=new br,Po=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Kr(1,0,0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;c(this,e),this.isPlane=!0,this.normal=t,this.constant=n}return p(e,[{key:"set",value:function(e,t){return this.normal.copy(e),this.constant=t,this}},{key:"setComponents",value:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}},{key:"setFromNormalAndCoplanarPoint",value:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}},{key:"setFromCoplanarPoints",value:function(e,t,n){var r=Mo.subVectors(n,t).cross(Co.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}},{key:"copy",value:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this}},{key:"normalize",value:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(e){return this.normal.dot(e)+this.constant}},{key:"distanceToSphere",value:function(e){return this.distanceToPoint(e.center)-e.radius}},{key:"projectPoint",value:function(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}},{key:"intersectLine",value:function(e,t){var n=e.delta(Mo),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;var i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}},{key:"intersectsLine",value:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}},{key:"intersectsBox",value:function(e){return e.intersectsPlane(this)}},{key:"intersectsSphere",value:function(e){return e.intersectsPlane(this)}},{key:"coplanarPoint",value:function(e){return e.copy(this.normal).multiplyScalar(-this.constant)}},{key:"applyMatrix4",value:function(e,t){var n=t||Ro.getNormalMatrix(e),r=this.coplanarPoint(Mo).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}},{key:"translate",value:function(e){return this.constant-=e.dot(this.normal),this}},{key:"equals",value:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),No=new mi,Io=new Kr,Lo=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Po,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Po,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Po,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Po,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Po,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Po;c(this,e),this.planes=[t,n,r,i,a,o]}return p(e,[{key:"set",value:function(e,t,n,r,i,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this}},{key:"copy",value:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this}},{key:"setFromProjectionMatrix",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:or,n=this.planes,r=e.elements,i=r[0],a=r[1],o=r[2],s=r[3],u=r[4],l=r[5],c=r[6],h=r[7],f=r[8],d=r[9],p=r[10],A=r[11],v=r[12],m=r[13],g=r[14],y=r[15];if(n[0].setComponents(s-i,h-u,A-f,y-v).normalize(),n[1].setComponents(s+i,h+u,A+f,y+v).normalize(),n[2].setComponents(s+a,h+l,A+d,y+m).normalize(),n[3].setComponents(s-a,h-l,A-d,y-m).normalize(),n[4].setComponents(s-o,h-c,A-p,y-g).normalize(),t===or)n[5].setComponents(s+o,h+c,A+p,y+g).normalize();else{if(t!==sr)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(o,c,p,g).normalize()}return this}},{key:"intersectsObject",value:function(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),No.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{var t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),No.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(No)}},{key:"intersectsSprite",value:function(e){return No.center.set(0,0,0),No.radius=.7071067811865476,No.applyMatrix4(e.matrixWorld),this.intersectsSphere(No)}},{key:"intersectsSphere",value:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0}},{key:"intersectsBox",value:function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(Io.x=r.normal.x>0?e.max.x:e.min.x,Io.y=r.normal.y>0?e.max.y:e.min.y,Io.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Io)<0)return!1}return!0}},{key:"containsPoint",value:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();var Do=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isLineBasicMaterial=!0,r.type="LineBasicMaterial",r.color=new ga(16777215),r.map=null,r.linewidth=1,r.linecap="round",r.linejoin="round",r.fog=!0,r.setValues(e),r}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}]),n}(ba),Oo=new Kr,Uo=new Kr,Bo=new Ei,Fo=new Si,zo=new mi,Vo=new Kr,qo=new Kr,jo=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qa,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Do;return c(this,n),(e=t.call(this)).isLine=!0,e.type="Line",e.geometry=r,e.material=i,e.morphTargetDictionary=void 0,e.morphTargetInfluences=void 0,e.updateMorphTargets(),e}return p(n,[{key:"copy",value:function(e,t){return ht(m(n.prototype),"copy",this).call(this,e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}},{key:"computeLineDistances",value:function(){var e=this.geometry;if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)Oo.fromBufferAttribute(t,r-1),Uo.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=Oo.distanceTo(Uo);e.setAttribute("lineDistance",new La(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),zo.copy(n.boundingSphere),zo.applyMatrix4(r),zo.radius+=i,!1!==e.ray.intersectsSphere(zo)){Bo.copy(r).invert(),Fo.copy(e.ray).applyMatrix4(Bo);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,u=this.isLineSegments?2:1,l=n.index,c=n.attributes.position;if(null!==l){for(var h=Math.max(0,a.start),f=Math.min(l.count,a.start+a.count),d=h,p=f-1;d<p;d+=u){var A=l.getX(d),v=l.getX(d+1),m=Go(this,e,Fo,s,A,v,d);m&&t.push(m)}if(this.isLineLoop){var g=l.getX(f-1),y=l.getX(h),_=Go(this,e,Fo,s,g,y,f-1);_&&t.push(_)}}else{for(var b=Math.max(0,a.start),x=Math.min(c.count,a.start+a.count),w=b,T=x-1;w<T;w+=u){var S=Go(this,e,Fo,s,w,w+1,w);S&&t.push(S)}if(this.isLineLoop){var E=Go(this,e,Fo,s,x-1,b,x-1);E&&t.push(E)}}}}},{key:"updateMorphTargets",value:function(){var e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){var n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var r=0,i=n.length;r<i;r++){var a=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}}]),n}($i);function Go(e,t,n,r,i,a,o){var s=e.geometry.attributes.position;if(Oo.fromBufferAttribute(s,i),Uo.fromBufferAttribute(s,a),!(n.distanceSqToSegment(Oo,Uo,Vo,qo)>r)){Vo.applyMatrix4(e.matrixWorld);var u=t.ray.origin.distanceTo(Vo);if(!(u<t.near||u>t.far))return{distance:u,point:qo.clone().applyMatrix4(e.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:e}}}var Ho=new Kr,Wo=new Kr,Xo=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,e,r)).isLineSegments=!0,i.type="LineSegments",i}return p(n,[{key:"computeLineDistances",value:function(){var e=this.geometry;if(null===e.index){for(var t=e.attributes.position,n=[],r=0,i=t.count;r<i;r+=2)Ho.fromBufferAttribute(t,r),Wo.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Ho.distanceTo(Wo);e.setAttribute("lineDistance",new La(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}]),n}(jo),Qo=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isPointsMaterial=!0,r.type="PointsMaterial",r.color=new ga(16777215),r.map=null,r.alphaMap=null,r.size=1,r.sizeAttenuation=!0,r.fog=!0,r.setValues(e),r}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}]),n}(ba),Yo=new Ei,Ko=new Si,Zo=new mi,Jo=new Kr,$o=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new qa,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Qo;return c(this,n),(e=t.call(this)).isPoints=!0,e.type="Points",e.geometry=r,e.material=i,e.morphTargetDictionary=void 0,e.morphTargetInfluences=void 0,e.updateMorphTargets(),e}return p(n,[{key:"copy",value:function(e,t){return ht(m(n.prototype),"copy",this).call(this,e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Zo.copy(n.boundingSphere),Zo.applyMatrix4(r),Zo.radius+=i,!1!==e.ray.intersectsSphere(Zo)){Yo.copy(r).invert(),Ko.copy(e.ray).applyMatrix4(Yo);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,u=n.index,l=n.attributes.position;if(null!==u)for(var c=Math.max(0,a.start),h=Math.min(u.count,a.start+a.count);c<h;c++){var f=u.getX(c);Jo.fromBufferAttribute(l,f),es(Jo,f,s,r,e,t,this)}else for(var d=Math.max(0,a.start),p=Math.min(l.count,a.start+a.count);d<p;d++)Jo.fromBufferAttribute(l,d),es(Jo,d,s,r,e,t,this)}}},{key:"updateMorphTargets",value:function(){var e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){var n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var r=0,i=n.length;r<i;r++){var a=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}}]),n}($i);function es(e,t,n,r,i,a,o){var s=Ko.distanceSqToPoint(e);if(s<n){var u=new Kr;Ko.closestPointToPoint(e,u),u.applyMatrix4(r);var l=i.ray.origin.distanceTo(u);if(l<i.near||l>i.far)return;a.push({distance:l,distanceToRay:Math.sqrt(s),point:u,index:t,face:null,faceIndex:null,barycoord:null,object:o})}}var ts=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,{width:e,height:r})).isFramebufferTexture=!0,i.magFilter=Lt,i.minFilter=Lt,i.generateMipmaps=!1,i.needsUpdate=!0,i}return p(n)}(jr),ns=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ht,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Lt,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Lt,f=arguments.length>8?arguments[8]:void 0,d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:rn;if(c(this,n),d!==rn&&d!==an)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");return(i=t.call(this,null,o,s,u,l,h,d,a,f)).isDepthTexture=!0,i.image={width:e,height:r},i.flipY=!1,i.generateMipmaps=!1,i.compareFunction=null,i}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.source=new zr(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}},{key:"toJSON",value:function(e){var t=ht(m(n.prototype),"toJSON",this).call(this,e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}]),n}(jr),rs=function(){function e(){c(this,e),this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}return p(e,[{key:"getPoint",value:function(){console.warn("THREE.Curve: .getPoint() not implemented.")}},{key:"getPointAt",value:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)}},{key:"getPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}},{key:"getSpacedPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}},{key:"getLength",value:function(){var e=this.getLengths();return e[e.length-1]}},{key:"getLengths",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n=[],r=this.getPoint(0),i=0;n.push(0);for(var a=1;a<=e;a++)i+=(t=this.getPoint(a/e)).distanceTo(r),n.push(i),r=t;return this.cacheArcLengths=n,n}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.getLengths()}},{key:"getUtoTmapping",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getLengths(),i=0,a=r.length;t=n||e*r[a-1];for(var o,s=0,u=a-1;s<=u;)if((o=r[i=Math.floor(s+(u-s)/2)]-t)<0)s=i+1;else{if(!(o>0)){u=i;break}u=i-1}if(r[i=u]===t)return i/(a-1);var l=r[i],c=r[i+1],h=c-l,f=(t-l)/h,d=(i+f)/(a-1);return d}},{key:"getTangent",value:function(e,t){var n=1e-4,r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);var a=this.getPoint(r),o=this.getPoint(i),s=t||(a.isVector2?new _r:new Kr);return s.copy(o).sub(a).normalize(),s}},{key:"getTangentAt",value:function(e,t){var n=this.getUtoTmapping(e);return this.getTangent(n,t)}},{key:"computeFrenetFrames",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Kr,r=[],i=[],a=[],o=new Kr,s=new Ei,u=0;u<=e;u++){var l=u/e;r[u]=this.getTangentAt(l,new Kr)}i[0]=new Kr,a[0]=new Kr;var c=Number.MAX_VALUE,h=Math.abs(r[0].x),f=Math.abs(r[0].y),d=Math.abs(r[0].z);h<=c&&(c=h,n.set(1,0,0)),f<=c&&(c=f,n.set(0,1,0)),d<=c&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],o),a[0].crossVectors(r[0],i[0]);for(var p=1;p<=e;p++){if(i[p]=i[p-1].clone(),a[p]=a[p-1].clone(),o.crossVectors(r[p-1],r[p]),o.length()>Number.EPSILON){o.normalize();var A=Math.acos(pr(r[p-1].dot(r[p]),-1,1));i[p].applyMatrix4(s.makeRotationAxis(o,A))}a[p].crossVectors(r[p],i[p])}if(!0===t){var v=Math.acos(pr(i[0].dot(i[e]),-1,1));v/=e,r[0].dot(o.crossVectors(i[0],i[e]))>0&&(v=-v);for(var m=1;m<=e;m++)i[m].applyMatrix4(s.makeRotationAxis(r[m],v*m)),a[m].crossVectors(r[m],i[m])}return{tangents:r,normals:i,binormals:a}}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},{key:"toJSON",value:function(){var e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}},{key:"fromJSON",value:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}]),e}(),is=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return c(this,n),(e=t.call(this)).isEllipseCurve=!0,e.type="EllipseCurve",e.aX=r,e.aY=i,e.xRadius=a,e.yRadius=o,e.aStartAngle=s,e.aEndAngle=u,e.aClockwise=l,e.aRotation=h,e}return p(n,[{key:"getPoint",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _r,n=t,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=a?0:r),!0!==this.aClockwise||a||(i===r?i=-r:i-=r);var o=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(o),u=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var l=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=s-this.aX,f=u-this.aY;s=h*l-f*c+this.aX,u=h*c+f*l+this.aY}return n.set(s,u)}},{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},{key:"toJSON",value:function(){var e=ht(m(n.prototype),"toJSON",this).call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}},{key:"fromJSON",value:function(e){return ht(m(n.prototype),"fromJSON",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}]),n}(rs),as=function(e){v(n,e);var t=b(n);function n(e,r,i,a,o,s){var u;return c(this,n),(u=t.call(this,e,r,i,i,a,o,s)).isArcCurve=!0,u.type="ArcCurve",u}return p(n)}(is);function os(){var e=0,t=0,n=0,r=0;function i(i,a,o,s){e=i,t=o,n=-3*i+3*a-2*o-s,r=2*i-2*a+o+s}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,o,s){var u=(t-e)/a-(n-e)/(a+o)+(n-t)/o,l=(n-t)/o-(r-t)/(o+s)+(r-n)/s;i(t,n,u*=o,l*=o)},calc:function(i){var a=i*i;return e+t*i+n*a+r*(a*i)}}}var ss=new Kr,us=new os,ls=new os,cs=new os,hs=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;return c(this,n),(e=t.call(this)).isCatmullRomCurve3=!0,e.type="CatmullRomCurve3",e.points=r,e.closed=i,e.curveType=a,e.tension=o,e}return p(n,[{key:"getPoint",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Kr,i=r,a=this.points,o=a.length,s=(o-(this.closed?0:1))*e,u=Math.floor(s),l=s-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/o)+1)*o:0===l&&u===o-1&&(u=o-2,l=1),this.closed||u>0?t=a[(u-1)%o]:(ss.subVectors(a[0],a[1]).add(a[0]),t=ss);var c=a[u%o],h=a[(u+1)%o];if(this.closed||u+2<o?n=a[(u+2)%o]:(ss.subVectors(a[o-1],a[o-2]).add(a[o-1]),n=ss),"centripetal"===this.curveType||"chordal"===this.curveType){var f="chordal"===this.curveType?.5:.25,d=Math.pow(t.distanceToSquared(c),f),p=Math.pow(c.distanceToSquared(h),f),A=Math.pow(h.distanceToSquared(n),f);p<1e-4&&(p=1),d<1e-4&&(d=p),A<1e-4&&(A=p),us.initNonuniformCatmullRom(t.x,c.x,h.x,n.x,d,p,A),ls.initNonuniformCatmullRom(t.y,c.y,h.y,n.y,d,p,A),cs.initNonuniformCatmullRom(t.z,c.z,h.z,n.z,d,p,A)}else"catmullrom"===this.curveType&&(us.initCatmullRom(t.x,c.x,h.x,n.x,this.tension),ls.initCatmullRom(t.y,c.y,h.y,n.y,this.tension),cs.initCatmullRom(t.z,c.z,h.z,n.z,this.tension));return i.set(us.calc(l),ls.calc(l),cs.calc(l)),i}},{key:"copy",value:function(e){ht(m(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},{key:"toJSON",value:function(){var e=ht(m(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}},{key:"fromJSON",value:function(e){ht(m(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push((new Kr).fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}]),n}(rs);function fs(e,t,n,r,i){var a=.5*(r-t),o=.5*(i-n),s=e*e;return(2*n-2*r+a+o)*(e*s)+(-3*n+3*r-2*a-o)*s+a*e+n}function ds(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function ps(e,t,n,r,i){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}var As=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new _r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new _r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new _r;return c(this,n),(e=t.call(this)).isCubicBezierCurve=!0,e.type="CubicBezierCurve",e.v0=r,e.v1=i,e.v2=a,e.v3=o,e}return p(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _r,n=t,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(ps(e,r.x,i.x,a.x,o.x),ps(e,r.y,i.y,a.y,o.y)),n}},{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=ht(m(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return ht(m(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}(rs),vs=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Kr,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Kr,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Kr,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Kr;return c(this,n),(e=t.call(this)).isCubicBezierCurve3=!0,e.type="CubicBezierCurve3",e.v0=r,e.v1=i,e.v2=a,e.v3=o,e}return p(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Kr,n=t,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(ps(e,r.x,i.x,a.x,o.x),ps(e,r.y,i.y,a.y,o.y),ps(e,r.z,i.z,a.z,o.z)),n}},{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=ht(m(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return ht(m(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}(rs),ms=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new _r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _r;return c(this,n),(e=t.call(this)).isLineCurve=!0,e.type="LineCurve",e.v1=r,e.v2=i,e}return p(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _r,n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"getTangent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _r;return t.subVectors(this.v2,this.v1).normalize()}},{key:"getTangentAt",value:function(e,t){return this.getTangent(e,t)}},{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=ht(m(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return ht(m(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(rs),gs=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Kr,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Kr;return c(this,n),(e=t.call(this)).isLineCurve3=!0,e.type="LineCurve3",e.v1=r,e.v2=i,e}return p(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Kr,n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"getTangent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Kr;return t.subVectors(this.v2,this.v1).normalize()}},{key:"getTangentAt",value:function(e,t){return this.getTangent(e,t)}},{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=ht(m(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return ht(m(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(rs),ys=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new _r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new _r;return c(this,n),(e=t.call(this)).isQuadraticBezierCurve=!0,e.type="QuadraticBezierCurve",e.v0=r,e.v1=i,e.v2=a,e}return p(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _r,n=t,r=this.v0,i=this.v1,a=this.v2;return n.set(ds(e,r.x,i.x,a.x),ds(e,r.y,i.y,a.y)),n}},{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=ht(m(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return ht(m(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(rs),_s=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Kr,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Kr,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Kr;return c(this,n),(e=t.call(this)).isQuadraticBezierCurve3=!0,e.type="QuadraticBezierCurve3",e.v0=r,e.v1=i,e.v2=a,e}return p(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Kr,n=t,r=this.v0,i=this.v1,a=this.v2;return n.set(ds(e,r.x,i.x,a.x),ds(e,r.y,i.y,a.y),ds(e,r.z,i.z,a.z)),n}},{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=ht(m(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return ht(m(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(rs),bs=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return c(this,n),(e=t.call(this)).isSplineCurve=!0,e.type="SplineCurve",e.points=r,e}return p(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _r,n=t,r=this.points,i=(r.length-1)*e,a=Math.floor(i),o=i-a,s=r[0===a?a:a-1],u=r[a],l=r[a>r.length-2?r.length-1:a+1],c=r[a>r.length-3?r.length-1:a+2];return n.set(fs(o,s.x,u.x,l.x,c.x),fs(o,s.y,u.y,l.y,c.y)),n}},{key:"copy",value:function(e){ht(m(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push(i.clone())}return this}},{key:"toJSON",value:function(){var e=ht(m(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var i=this.points[t];e.points.push(i.toArray())}return e}},{key:"fromJSON",value:function(e){ht(m(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push((new _r).fromArray(i))}return this}}]),n}(rs),xs=Object.freeze({__proto__:null,ArcCurve:as,CatmullRomCurve3:hs,CubicBezierCurve:As,CubicBezierCurve3:vs,EllipseCurve:is,LineCurve:ms,LineCurve3:gs,QuadraticBezierCurve:ys,QuadraticBezierCurve3:_s,SplineCurve:bs}),ws=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this)).type="CurvePath",e.curves=[],e.autoClose=!1,e}return p(n,[{key:"add",value:function(e){this.curves.push(e)}},{key:"closePath",value:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){var n=!0===e.isVector2?"LineCurve":"LineCurve3";this.curves.push(new xs[n](t,e))}return this}},{key:"getPoint",value:function(e,t){for(var n=e*this.getLength(),r=this.getCurveLengths(),i=0;i<r.length;){if(r[i]>=n){var a=r[i]-n,o=this.curves[i],s=o.getLength(),u=0===s?0:1-a/s;return o.getPointAt(u,t)}i++}return null}},{key:"getLength",value:function(){var e=this.getCurveLengths();return e[e.length-1]}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}},{key:"getCurveLengths",value:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}},{key:"getSpacedPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}},{key:"getPoints",value:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,n=[],r=0,i=this.curves;r<i.length;r++)for(var a=i[r],o=a.isEllipseCurve?2*t:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o),u=0;u<s.length;u++){var l=s[u];e&&e.equals(l)||(n.push(l),e=l)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}},{key:"copy",value:function(e){ht(m(n.prototype),"copy",this).call(this,e),this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}},{key:"toJSON",value:function(){var e=ht(m(n.prototype),"toJSON",this).call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,r=this.curves.length;t<r;t++){var i=this.curves[t];e.curves.push(i.toJSON())}return e}},{key:"fromJSON",value:function(e){ht(m(n.prototype),"fromJSON",this).call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var i=e.curves[t];this.curves.push((new xs[i.type]).fromJSON(i))}return this}}]),n}(rs),Ts=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).type="Path",r.currentPoint=new _r,e&&r.setFromPoints(e),r}return p(n,[{key:"setFromPoints",value:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}},{key:"moveTo",value:function(e,t){return this.currentPoint.set(e,t),this}},{key:"lineTo",value:function(e,t){var n=new ms(this.currentPoint.clone(),new _r(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){var i=new ys(this.currentPoint.clone(),new _r(e,t),new _r(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,i,a){var o=new As(this.currentPoint.clone(),new _r(e,t),new _r(n,r),new _r(i,a));return this.curves.push(o),this.currentPoint.set(i,a),this}},{key:"splineThru",value:function(e){var t=[this.currentPoint.clone()].concat(e),n=new bs(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}},{key:"arc",value:function(e,t,n,r,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,r,i,a),this}},{key:"absarc",value:function(e,t,n,r,i,a){return this.absellipse(e,t,n,n,r,i,a),this}},{key:"ellipse",value:function(e,t,n,r,i,a,o,s){var u=this.currentPoint.x,l=this.currentPoint.y;return this.absellipse(e+u,t+l,n,r,i,a,o,s),this}},{key:"absellipse",value:function(e,t,n,r,i,a,o,s){var u=new is(e,t,n,r,i,a,o,s);if(this.curves.length>0){var l=u.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(u);var c=u.getPoint(1);return this.currentPoint.copy(c),this}},{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.currentPoint.copy(e.currentPoint),this}},{key:"toJSON",value:function(){var e=ht(m(n.prototype),"toJSON",this).call(this);return e.currentPoint=this.currentPoint.toArray(),e}},{key:"fromJSON",value:function(e){return ht(m(n.prototype),"fromJSON",this).call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}]),n}(ws),Ss=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;c(this,n),(e=t.call(this)).type="CircleGeometry",e.parameters={radius:r,segments:i,thetaStart:a,thetaLength:o},i=Math.max(3,i);var s=[],u=[],l=[],h=[],f=new Kr,d=new _r;u.push(0,0,0),l.push(0,0,1),h.push(.5,.5);for(var p=0,A=3;p<=i;p++,A+=3){var v=a+p/i*o;f.x=r*Math.cos(v),f.y=r*Math.sin(v),u.push(f.x,f.y,f.z),l.push(0,0,1),d.x=(u[A]/r+1)/2,d.y=(u[A+1]/r+1)/2,h.push(d.x,d.y)}for(var m=1;m<=i;m++)s.push(m,m+1,0);return e.setIndex(s),e.setAttribute("position",new La(u,3)),e.setAttribute("normal",new La(l,3)),e.setAttribute("uv",new La(h,2)),e}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.radius,e.segments,e.thetaStart,e.thetaLength)}}]),n}(qa),Es=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;c(this,n),(e=t.call(this)).type="CylinderGeometry",e.parameters={radiusTop:r,radiusBottom:i,height:a,radialSegments:o,heightSegments:s,openEnded:u,thetaStart:l,thetaLength:h};var f=y(e);o=Math.floor(o),s=Math.floor(s);var d=[],p=[],A=[],v=[],m=0,g=[],_=a/2,b=0;function x(){for(var e=new Kr,t=new Kr,n=0,u=(i-r)/a,c=0;c<=s;c++){for(var y=[],x=c/s,w=x*(i-r)+r,T=0;T<=o;T++){var S=T/o,E=S*h+l,k=Math.sin(E),M=Math.cos(E);t.x=w*k,t.y=-x*a+_,t.z=w*M,p.push(t.x,t.y,t.z),e.set(k,u,M).normalize(),A.push(e.x,e.y,e.z),v.push(S,1-x),y.push(m++)}g.push(y)}for(var C=0;C<o;C++)for(var R=0;R<s;R++){var P=g[R][C],N=g[R+1][C],I=g[R+1][C+1],L=g[R][C+1];(r>0||0!==R)&&(d.push(P,N,L),n+=3),(i>0||R!==s-1)&&(d.push(N,I,L),n+=3)}f.addGroup(b,n,0),b+=n}function w(e){for(var t=m,n=new _r,a=new Kr,s=0,u=!0===e?r:i,c=!0===e?1:-1,g=1;g<=o;g++)p.push(0,_*c,0),A.push(0,c,0),v.push(.5,.5),m++;for(var y=m,x=0;x<=o;x++){var w=x/o*h+l,T=Math.cos(w),S=Math.sin(w);a.x=u*S,a.y=_*c,a.z=u*T,p.push(a.x,a.y,a.z),A.push(0,c,0),n.x=.5*T+.5,n.y=.5*S*c+.5,v.push(n.x,n.y),m++}for(var E=0;E<o;E++){var k=t+E,M=y+E;!0===e?d.push(M,M+1,k):d.push(M+1,M,k),s+=3}f.addGroup(b,s,!0===e?1:2),b+=s}return x(),!1===u&&(r>0&&w(!0),i>0&&w(!1)),e.setIndex(d),e.setAttribute("position",new La(p,3)),e.setAttribute("normal",new La(A,3)),e.setAttribute("uv",new La(v,2)),e}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}]),n}(qa),ks=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,e)).uuid=dr(),r.type="Shape",r.holes=[],r}return p(n,[{key:"getPointsHoles",value:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}},{key:"extractPoints",value:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}},{key:"copy",value:function(e){ht(m(n.prototype),"copy",this).call(this,e),this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var i=e.holes[t];this.holes.push(i.clone())}return this}},{key:"toJSON",value:function(){var e=ht(m(n.prototype),"toJSON",this).call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,r=this.holes.length;t<r;t++){var i=this.holes[t];e.holes.push(i.toJSON())}return e}},{key:"fromJSON",value:function(e){ht(m(n.prototype),"fromJSON",this).call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var i=e.holes[t];this.holes.push((new Ts).fromJSON(i))}return this}}]),n}(Ts);function Ms(e,t){var n,r,i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,o=t&&t.length,s=o?t[0]*a:e.length,u=Cs(e,0,s,a,!0),l=[];if(!u||u.next===u.prev)return l;if(o&&(u=Os(e,t,u,a)),e.length>80*a){n=1/0,r=1/0;for(var c=-1/0,h=-1/0,f=a;f<s;f+=a){var d=e[f],p=e[f+1];d<n&&(n=d),p<r&&(r=p),d>c&&(c=d),p>h&&(h=p)}i=0!==(i=Math.max(c-n,h-r))?32767/i:0}return Ps(u,l,a,n,r,i,0),l}function Cs(e,t,n,r,i){var a;if(i===function(e,t,n,r){for(var i=0,a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,n,r)>0)for(var o=t;o<n;o+=r)a=Js(o/r|0,e[o],e[o+1],a);else for(var s=n-r;s>=t;s-=r)a=Js(s/r|0,e[s],e[s+1],a);return a&&Ws(a,a.next)&&($s(a),a=a.next),a}function Rs(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!Ws(r,r.next)&&0!==Hs(r.prev,r,r.next))r=r.next;else{if($s(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function Ps(e,t,n,r,i,a,o){if(e){!o&&a&&function(e,t,n,r){var i=e;do{0===i.z&&(i.z=zs(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n=1;do{var r=e,i=void 0;e=null;var a=null;for(t=0;r;){t++;for(var o=r,s=0,u=0;u<n&&(s++,o=o.nextZ);u++);for(var l=n;s>0||l>0&&o;)0!==s&&(0===l||!o||r.z<=o.z)?(i=r,r=r.nextZ,s--):(i=o,o=o.nextZ,l--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=o}a.nextZ=null,n*=2}while(t>1)}(i)}(e,r,i,a);for(var s=e;e.prev!==e.next;){var u=e.prev,l=e.next;if(a?Is(e,r,i,a):Ns(e))t.push(u.i,e.i,l.i),$s(e),e=l.next,s=l.next;else if((e=l)===s){o?1===o?Ps(e=Ls(Rs(e),t),t,n,r,i,a,2):2===o&&Ds(e,t,n,r,i,a):Ps(Rs(e),t,n,r,i,a,1);break}}}}function Ns(e){var t=e.prev,n=e,r=e.next;if(Hs(t,n,r)>=0)return!1;for(var i=t.x,a=n.x,o=r.x,s=t.y,u=n.y,l=r.y,c=Math.min(i,a,o),h=Math.min(s,u,l),f=Math.max(i,a,o),d=Math.max(s,u,l),p=r.next;p!==t;){if(p.x>=c&&p.x<=f&&p.y>=h&&p.y<=d&&js(i,s,a,u,o,l,p.x,p.y)&&Hs(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Is(e,t,n,r){var i=e.prev,a=e,o=e.next;if(Hs(i,a,o)>=0)return!1;for(var s=i.x,u=a.x,l=o.x,c=i.y,h=a.y,f=o.y,d=Math.min(s,u,l),p=Math.min(c,h,f),A=Math.max(s,u,l),v=Math.max(c,h,f),m=zs(d,p,t,n,r),g=zs(A,v,t,n,r),y=e.prevZ,_=e.nextZ;y&&y.z>=m&&_&&_.z<=g;){if(y.x>=d&&y.x<=A&&y.y>=p&&y.y<=v&&y!==i&&y!==o&&js(s,c,u,h,l,f,y.x,y.y)&&Hs(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,_.x>=d&&_.x<=A&&_.y>=p&&_.y<=v&&_!==i&&_!==o&&js(s,c,u,h,l,f,_.x,_.y)&&Hs(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;y&&y.z>=m;){if(y.x>=d&&y.x<=A&&y.y>=p&&y.y<=v&&y!==i&&y!==o&&js(s,c,u,h,l,f,y.x,y.y)&&Hs(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;_&&_.z<=g;){if(_.x>=d&&_.x<=A&&_.y>=p&&_.y<=v&&_!==i&&_!==o&&js(s,c,u,h,l,f,_.x,_.y)&&Hs(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function Ls(e,t){var n=e;do{var r=n.prev,i=n.next.next;!Ws(r,i)&&Xs(r,n,n.next,i)&&Ks(r,i)&&Ks(i,r)&&(t.push(r.i,n.i,i.i),$s(n),$s(n.next),n=e=i),n=n.next}while(n!==e);return Rs(n)}function Ds(e,t,n,r,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Gs(o,s)){var u=Zs(o,s);return o=Rs(o,o.next),u=Rs(u,u.next),Ps(o,t,n,r,i,a,0),void Ps(u,t,n,r,i,a,0)}s=s.next}o=o.next}while(o!==e)}function Os(e,t,n,r){for(var i=[],a=0,o=t.length;a<o;a++){var s=Cs(e,t[a]*r,a<o-1?t[a+1]*r:e.length,r,!1);s===s.next&&(s.steiner=!0),i.push(Vs(s))}i.sort(Us);for(var u=0;u<i.length;u++)n=Bs(i[u],n);return n}function Us(e,t){var n=e.x-t.x;0===n&&(0===(n=e.y-t.y)&&(n=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)));return n}function Bs(e,t){var n=function(e,t){var n,r=t,i=e.x,a=e.y,o=-1/0;if(Ws(e,r))return r;do{if(Ws(e,r.next))return r.next;if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>o&&(o=s,n=r.x<r.next.x?r:r.next,s===i))return n}r=r.next}while(r!==t);if(!n)return null;var u=n,l=n.x,c=n.y,h=1/0;r=n;do{if(i>=r.x&&r.x>=l&&i!==r.x&&qs(a<c?i:o,a,l,c,a<c?o:i,a,r.x,r.y)){var f=Math.abs(a-r.y)/(i-r.x);Ks(r,e)&&(f<h||f===h&&(r.x>n.x||r.x===n.x&&Fs(n,r)))&&(n=r,h=f)}r=r.next}while(r!==u);return n}(e,t);if(!n)return t;var r=Zs(n,e);return Rs(r,r.next),Rs(n,n.next)}function Fs(e,t){return Hs(e.prev,e,t.prev)<0&&Hs(t.next,e,e.next)<0}function zs(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Vs(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function qs(e,t,n,r,i,a,o,s){return(i-o)*(t-s)>=(e-o)*(a-s)&&(e-o)*(r-s)>=(n-o)*(t-s)&&(n-o)*(a-s)>=(i-o)*(r-s)}function js(e,t,n,r,i,a,o,s){return!(e===o&&t===s)&&qs(e,t,n,r,i,a,o,s)}function Gs(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Xs(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Ks(e,t)&&Ks(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!==n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Hs(e.prev,e,t.prev)||Hs(e,t.prev,t))||Ws(e,t)&&Hs(e.prev,e,e.next)>0&&Hs(t.prev,t,t.next)>0)}function Hs(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Ws(e,t){return e.x===t.x&&e.y===t.y}function Xs(e,t,n,r){var i=Ys(Hs(e,t,n)),a=Ys(Hs(e,t,r)),o=Ys(Hs(n,r,e)),s=Ys(Hs(n,r,t));return i!==a&&o!==s||(!(0!==i||!Qs(e,n,t))||(!(0!==a||!Qs(e,r,t))||(!(0!==o||!Qs(n,e,r))||!(0!==s||!Qs(n,t,r)))))}function Qs(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Ys(e){return e>0?1:e<0?-1:0}function Ks(e,t){return Hs(e.prev,e,e.next)<0?Hs(e,t,e.next)>=0&&Hs(e,e.prev,t)>=0:Hs(e,t,e.prev)<0||Hs(e,e.next,t)<0}function Zs(e,t){var n=eu(e.i,e.x,e.y),r=eu(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function Js(e,t,n,r){var i=eu(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function $s(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function eu(e,t,n){return{i:e,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}var tu=function(){function e(){c(this,e)}return p(e,null,[{key:"triangulate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return Ms(e,t,n)}}]),e}(),nu=function(){function e(){c(this,e)}return p(e,null,[{key:"area",value:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n}},{key:"isClockWise",value:function(t){return e.area(t)<0}},{key:"triangulateShape",value:function(e,t){var n=[],r=[],i=[];ru(e),iu(n,e);var a=e.length;t.forEach(ru);for(var o=0;o<t.length;o++)r.push(a),a+=t[o].length,iu(n,t[o]);for(var s=tu.triangulate(n,r),u=0;u<s.length;u+=3)i.push(s.slice(u,u+3));return i}}]),e}();function ru(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function iu(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}var au=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ks([new _r(.5,.5),new _r(-.5,.5),new _r(-.5,-.5),new _r(.5,-.5)]),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};c(this,n),(e=t.call(this)).type="ExtrudeGeometry",e.parameters={shapes:r,options:i},r=Array.isArray(r)?r:[r];for(var a=y(e),o=[],s=[],u=0,l=r.length;u<l;u++){var h=r[u];f(h)}function f(e){var t,n,r,u,l,c=[],h=void 0!==i.curveSegments?i.curveSegments:12,f=void 0!==i.steps?i.steps:1,d=void 0!==i.depth?i.depth:1,p=void 0===i.bevelEnabled||i.bevelEnabled,A=void 0!==i.bevelThickness?i.bevelThickness:.2,v=void 0!==i.bevelSize?i.bevelSize:A-.1,m=void 0!==i.bevelOffset?i.bevelOffset:0,g=void 0!==i.bevelSegments?i.bevelSegments:3,y=i.extrudePath,_=void 0!==i.UVGenerator?i.UVGenerator:ou,b=!1;y&&(t=y.getSpacedPoints(f),b=!0,p=!1,n=y.computeFrenetFrames(f,!1),r=new Kr,u=new Kr,l=new Kr),p||(g=0,A=0,v=0,m=0);var x=e.extractPoints(h),w=x.shape,T=x.holes;if(!nu.isClockWise(w)){w=w.reverse();for(var S=0,E=T.length;S<E;S++){var k=T[S];nu.isClockWise(k)&&(T[S]=k.reverse())}}function M(e){for(var t=e[0],n=1;n<=e.length;n++){var r=n%e.length,i=e[r],a=i.x-t.x,o=i.y-t.y,s=a*a+o*o,u=Math.max(Math.abs(i.x),Math.abs(i.y),Math.abs(t.x),Math.abs(t.y));s<=1.0000000000000001e-20*u*u?(e.splice(r,1),n--):t=i}}M(w),T.forEach(M);for(var C=T.length,R=w,P=0;P<C;P++){var N=T[P];w=w.concat(N)}function I(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().addScaledVector(t,n)}var L=w.length;function D(e,t,n){var r,i,a,o=e.x-t.x,s=e.y-t.y,u=n.x-e.x,l=n.y-e.y,c=o*o+s*s,h=o*l-s*u;if(Math.abs(h)>Number.EPSILON){var f=Math.sqrt(c),d=Math.sqrt(u*u+l*l),p=t.x-s/f,A=t.y+o/f,v=((n.x-l/d-p)*l-(n.y+u/d-A)*u)/(o*l-s*u),m=(r=p+o*v-e.x)*r+(i=A+s*v-e.y)*i;if(m<=2)return new _r(r,i);a=Math.sqrt(m/2)}else{var g=!1;o>Number.EPSILON?u>Number.EPSILON&&(g=!0):o<-Number.EPSILON?u<-Number.EPSILON&&(g=!0):Math.sign(s)===Math.sign(l)&&(g=!0),g?(r=-s,i=o,a=Math.sqrt(c)):(r=o,i=s,a=Math.sqrt(c/2))}return new _r(r/a,i/a)}for(var O=[],U=0,B=R.length,F=B-1,z=U+1;U<B;U++,F++,z++)F===B&&(F=0),z===B&&(z=0),O[U]=D(R[U],R[F],R[z]);for(var V,q=[],j=O.concat(),G=0,H=C;G<H;G++){var W=T[G];V=[];for(var X=0,Q=W.length,Y=Q-1,K=X+1;X<Q;X++,Y++,K++)Y===Q&&(Y=0),K===Q&&(K=0),V[X]=D(W[X],W[Y],W[K]);q.push(V),j=j.concat(V)}for(var Z=[],J=[],$=0;$<g;$++){for(var ee=$/g,te=A*Math.cos(ee*Math.PI/2),ne=v*Math.sin(ee*Math.PI/2)+m,re=0,ie=R.length;re<ie;re++){var ae=I(R[re],O[re],ne);De(ae.x,ae.y,-te),0==ee&&Z.push(ae)}for(var oe=0,se=C;oe<se;oe++){var ue=T[oe];V=q[oe];for(var le=[],ce=0,he=ue.length;ce<he;ce++){var fe=I(ue[ce],V[ce],ne);De(fe.x,fe.y,-te),0==ee&&le.push(fe)}0==ee&&J.push(le)}}for(var de=nu.triangulateShape(Z,J),pe=de.length,Ae=v+m,ve=0;ve<L;ve++){var me=p?I(w[ve],j[ve],Ae):w[ve];b?(u.copy(n.normals[0]).multiplyScalar(me.x),r.copy(n.binormals[0]).multiplyScalar(me.y),l.copy(t[0]).add(u).add(r),De(l.x,l.y,l.z)):De(me.x,me.y,0)}for(var ge=1;ge<=f;ge++)for(var ye=0;ye<L;ye++){var _e=p?I(w[ye],j[ye],Ae):w[ye];b?(u.copy(n.normals[ge]).multiplyScalar(_e.x),r.copy(n.binormals[ge]).multiplyScalar(_e.y),l.copy(t[ge]).add(u).add(r),De(l.x,l.y,l.z)):De(_e.x,_e.y,d/f*ge)}for(var be=g-1;be>=0;be--){for(var xe=be/g,we=A*Math.cos(xe*Math.PI/2),Te=v*Math.sin(xe*Math.PI/2)+m,Se=0,Ee=R.length;Se<Ee;Se++){var ke=I(R[Se],O[Se],Te);De(ke.x,ke.y,d+we)}for(var Me=0,Ce=T.length;Me<Ce;Me++){var Re=T[Me];V=q[Me];for(var Pe=0,Ne=Re.length;Pe<Ne;Pe++){var Ie=I(Re[Pe],V[Pe],Te);b?De(Ie.x,Ie.y+t[f-1].y,t[f-1].x+we):De(Ie.x,Ie.y,d+we)}}}function Le(e,t){for(var n=e.length;--n>=0;){var r=n,i=n-1;i<0&&(i=e.length-1);for(var a=0,o=f+2*g;a<o;a++){var s=L*a,u=L*(a+1);Ue(t+r+s,t+i+s,t+i+u,t+r+u)}}}function De(e,t,n){c.push(e),c.push(t),c.push(n)}function Oe(e,t,n){Be(e),Be(t),Be(n);var r=o.length/3,i=_.generateTopUV(a,o,r-3,r-2,r-1);Fe(i[0]),Fe(i[1]),Fe(i[2])}function Ue(e,t,n,r){Be(e),Be(t),Be(r),Be(t),Be(n),Be(r);var i=o.length/3,s=_.generateSideWallUV(a,o,i-6,i-3,i-2,i-1);Fe(s[0]),Fe(s[1]),Fe(s[3]),Fe(s[1]),Fe(s[2]),Fe(s[3])}function Be(e){o.push(c[3*e+0]),o.push(c[3*e+1]),o.push(c[3*e+2])}function Fe(e){s.push(e.x),s.push(e.y)}!function(){var e=o.length/3;if(p){for(var t=0,n=L*t,r=0;r<pe;r++){var i=de[r];Oe(i[2]+n,i[1]+n,i[0]+n)}n=L*(t=f+2*g);for(var s=0;s<pe;s++){var u=de[s];Oe(u[0]+n,u[1]+n,u[2]+n)}}else{for(var l=0;l<pe;l++){var c=de[l];Oe(c[2],c[1],c[0])}for(var h=0;h<pe;h++){var d=de[h];Oe(d[0]+L*f,d[1]+L*f,d[2]+L*f)}}a.addGroup(e,o.length/3-e,0)}(),function(){var e=o.length/3,t=0;Le(R,t),t+=R.length;for(var n=0,r=T.length;n<r;n++){var i=T[n];Le(i,t),t+=i.length}a.addGroup(e,o.length/3-e,1)}()}return e.setAttribute("position",new La(o,3)),e.setAttribute("uv",new La(s,2)),e.computeVertexNormals(),e}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}},{key:"toJSON",value:function(){var e=ht(m(n.prototype),"toJSON",this).call(this);return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var a=e[r];n.shapes.push(a.uuid)}else n.shapes.push(e.uuid);n.options=Object.assign({},t),void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)}}],[{key:"fromJSON",value:function(e,t){for(var r=[],i=0,a=e.shapes.length;i<a;i++){var o=t[e.shapes[i]];r.push(o)}var s=e.options.extrudePath;return void 0!==s&&(e.options.extrudePath=(new xs[s.type]).fromJSON(s)),new n(r,e.options)}}]),n}(qa),ou={generateTopUV:function(e,t,n,r,i){var a=t[3*n],o=t[3*n+1],s=t[3*r],u=t[3*r+1],l=t[3*i],c=t[3*i+1];return[new _r(a,o),new _r(s,u),new _r(l,c)]},generateSideWallUV:function(e,t,n,r,i,a){var o=t[3*n],s=t[3*n+1],u=t[3*n+2],l=t[3*r],c=t[3*r+1],h=t[3*r+2],f=t[3*i],d=t[3*i+1],p=t[3*i+2],A=t[3*a],v=t[3*a+1],m=t[3*a+2];return Math.abs(s-c)<Math.abs(o-l)?[new _r(o,1-u),new _r(l,1-h),new _r(f,1-p),new _r(A,1-m)]:[new _r(s,1-u),new _r(c,1-h),new _r(d,1-p),new _r(v,1-m)]}};var su=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;c(this,n),(e=t.call(this)).type="PlaneGeometry",e.parameters={width:r,height:i,widthSegments:a,heightSegments:o};for(var s=r/2,u=i/2,l=Math.floor(a),h=Math.floor(o),f=l+1,d=h+1,p=r/l,A=i/h,v=[],m=[],g=[],y=[],_=0;_<d;_++)for(var b=_*A-u,x=0;x<f;x++){var w=x*p-s;m.push(w,-b,0),g.push(0,0,1),y.push(x/l),y.push(1-_/h)}for(var T=0;T<h;T++)for(var S=0;S<l;S++){var E=S+f*T,k=S+f*(T+1),M=S+1+f*(T+1),C=S+1+f*T;v.push(E,k,C),v.push(k,M,C)}return e.setIndex(v),e.setAttribute("position",new La(m,3)),e.setAttribute("normal",new La(g,3)),e.setAttribute("uv",new La(y,2)),e}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.width,e.height,e.widthSegments,e.heightSegments)}}]),n}(qa);var uu=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;c(this,n),(e=t.call(this)).type="SphereGeometry",e.parameters={radius:r,widthSegments:i,heightSegments:a,phiStart:o,phiLength:s,thetaStart:u,thetaLength:l},i=Math.max(3,Math.floor(i)),a=Math.max(2,Math.floor(a));for(var h=Math.min(u+l,Math.PI),f=0,d=[],p=new Kr,A=new Kr,v=[],m=[],g=[],y=[],_=0;_<=a;_++){var b=[],x=_/a,w=0;0===_&&0===u?w=.5/i:_===a&&h===Math.PI&&(w=-.5/i);for(var T=0;T<=i;T++){var S=T/i;p.x=-r*Math.cos(o+S*s)*Math.sin(u+x*l),p.y=r*Math.cos(u+x*l),p.z=r*Math.sin(o+S*s)*Math.sin(u+x*l),m.push(p.x,p.y,p.z),A.copy(p).normalize(),g.push(A.x,A.y,A.z),y.push(S+w,1-x),b.push(f++)}d.push(b)}for(var E=0;E<a;E++)for(var k=0;k<i;k++){var M=d[E][k+1],C=d[E][k],R=d[E+1][k],P=d[E+1][k+1];(0!==E||u>0)&&v.push(M,C,P),(E!==a-1||h<Math.PI)&&v.push(C,R,P)}return e.setIndex(v),e.setAttribute("position",new La(m,3)),e.setAttribute("normal",new La(g,3)),e.setAttribute("uv",new La(y,2)),e}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new n(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}]),n}(qa),lu=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new _s(new Kr(-1,-1,0),new Kr(-1,1,0),new Kr(1,1,0)),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];c(this,n),(e=t.call(this)).type="TubeGeometry",e.parameters={path:r,tubularSegments:i,radius:a,radialSegments:o,closed:s};var u=r.computeFrenetFrames(i,s);e.tangents=u.tangents,e.normals=u.normals,e.binormals=u.binormals;var l=new Kr,h=new Kr,f=new _r,d=new Kr,p=[],A=[],v=[],m=[];function g(){for(var e=0;e<i;e++)y(e);y(!1===s?i:0),b(),_()}function y(e){d=r.getPointAt(e/i,d);for(var t=u.normals[e],n=u.binormals[e],s=0;s<=o;s++){var c=s/o*Math.PI*2,f=Math.sin(c),v=-Math.cos(c);h.x=v*t.x+f*n.x,h.y=v*t.y+f*n.y,h.z=v*t.z+f*n.z,h.normalize(),A.push(h.x,h.y,h.z),l.x=d.x+a*h.x,l.y=d.y+a*h.y,l.z=d.z+a*h.z,p.push(l.x,l.y,l.z)}}function _(){for(var e=1;e<=i;e++)for(var t=1;t<=o;t++){var n=(o+1)*(e-1)+(t-1),r=(o+1)*e+(t-1),a=(o+1)*e+t,s=(o+1)*(e-1)+t;m.push(n,r,s),m.push(r,a,s)}}function b(){for(var e=0;e<=i;e++)for(var t=0;t<=o;t++)f.x=e/i,f.y=t/o,v.push(f.x,f.y)}return g(),e.setIndex(m),e.setAttribute("position",new La(p,3)),e.setAttribute("normal",new La(A,3)),e.setAttribute("uv",new La(v,2)),e}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}},{key:"toJSON",value:function(){var e=ht(m(n.prototype),"toJSON",this).call(this);return e.path=this.parameters.path.toJSON(),e}}],[{key:"fromJSON",value:function(e){return new n((new xs[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}]),n}(qa),cu=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(c(this,n),(e=t.call(this)).type="WireframeGeometry",e.parameters={geometry:r},null!==r){var i=[],a=new Set,o=new Kr,s=new Kr;if(null!==r.index){var u=r.attributes.position,l=r.index,h=r.groups;0===h.length&&(h=[{start:0,count:l.count,materialIndex:0}]);for(var f=0,d=h.length;f<d;++f)for(var p=h[f],A=p.start,v=p.count,m=A,g=A+v;m<g;m+=3)for(var y=0;y<3;y++){var _=l.getX(m+y),b=l.getX(m+(y+1)%3);o.fromBufferAttribute(u,_),s.fromBufferAttribute(u,b),!0===hu(o,s,a)&&(i.push(o.x,o.y,o.z),i.push(s.x,s.y,s.z))}}else for(var x=r.attributes.position,w=0,T=x.count/3;w<T;w++)for(var S=0;S<3;S++){var E=3*w+S,k=3*w+(S+1)%3;o.fromBufferAttribute(x,E),s.fromBufferAttribute(x,k),!0===hu(o,s,a)&&(i.push(o.x,o.y,o.z),i.push(s.x,s.y,s.z))}e.setAttribute("position",new La(i,3))}return e}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}]),n}(qa);function hu(e,t,n){var r="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(t.x,",").concat(t.y,",").concat(t.z),i="".concat(t.x,",").concat(t.y,",").concat(t.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z);return!0!==n.has(r)&&!0!==n.has(i)&&(n.add(r),n.add(i),!0)}var fu=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isShadowMaterial=!0,r.type="ShadowMaterial",r.color=new ga(0),r.transparent=!0,r.fog=!0,r.setValues(e),r}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.fog=e.fog,this}}]),n}(ba),du=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshStandardMaterial=!0,r.type="MeshStandardMaterial",r.defines={STANDARD:""},r.color=new ga(16777215),r.roughness=1,r.metalness=0,r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new ga(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=0,r.normalScale=new _r(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.roughnessMap=null,r.metalnessMap=null,r.alphaMap=null,r.envMap=null,r.envMapRotation=new Oi,r.envMapIntensity=1,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.flatShading=!1,r.fog=!0,r.setValues(e),r}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}]),n}(ba),pu=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshPhysicalMaterial=!0,r.defines={STANDARD:"",PHYSICAL:""},r.type="MeshPhysicalMaterial",r.anisotropyRotation=0,r.anisotropyMap=null,r.clearcoatMap=null,r.clearcoatRoughness=0,r.clearcoatRoughnessMap=null,r.clearcoatNormalScale=new _r(1,1),r.clearcoatNormalMap=null,r.ior=1.5,Object.defineProperty(y(r),"reflectivity",{get:function(){return pr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),r.iridescenceMap=null,r.iridescenceIOR=1.3,r.iridescenceThicknessRange=[100,400],r.iridescenceThicknessMap=null,r.sheenColor=new ga(0),r.sheenColorMap=null,r.sheenRoughness=1,r.sheenRoughnessMap=null,r.transmissionMap=null,r.thickness=0,r.thicknessMap=null,r.attenuationDistance=1/0,r.attenuationColor=new ga(1,1,1),r.specularIntensity=1,r.specularIntensityMap=null,r.specularColor=new ga(1,1,1),r.specularColorMap=null,r._anisotropy=0,r._clearcoat=0,r._dispersion=0,r._iridescence=0,r._sheen=0,r._transmission=0,r.setValues(e),r}return p(n,[{key:"anisotropy",get:function(){return this._anisotropy},set:function(e){this._anisotropy>0!==e>0&&this.version++,this._anisotropy=e}},{key:"clearcoat",get:function(){return this._clearcoat},set:function(e){this._clearcoat>0!==e>0&&this.version++,this._clearcoat=e}},{key:"iridescence",get:function(){return this._iridescence},set:function(e){this._iridescence>0!==e>0&&this.version++,this._iridescence=e}},{key:"dispersion",get:function(){return this._dispersion},set:function(e){this._dispersion>0!==e>0&&this.version++,this._dispersion=e}},{key:"sheen",get:function(){return this._sheen},set:function(e){this._sheen>0!==e>0&&this.version++,this._sheen=e}},{key:"transmission",get:function(){return this._transmission},set:function(e){this._transmission>0!==e>0&&this.version++,this._transmission=e}},{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=l(e.iridescenceThicknessRange),this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}]),n}(du),Au=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshPhongMaterial=!0,r.type="MeshPhongMaterial",r.color=new ga(16777215),r.specular=new ga(1118481),r.shininess=30,r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new ga(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=0,r.normalScale=new _r(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.envMapRotation=new Oi,r.combine=0,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.flatShading=!1,r.fog=!0,r.setValues(e),r}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}]),n}(ba),vu=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshToonMaterial=!0,r.defines={TOON:""},r.type="MeshToonMaterial",r.color=new ga(16777215),r.map=null,r.gradientMap=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new ga(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=0,r.normalScale=new _r(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.fog=!0,r.setValues(e),r}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}]),n}(ba),mu=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshNormalMaterial=!0,r.type="MeshNormalMaterial",r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=0,r.normalScale=new _r(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.flatShading=!1,r.setValues(e),r}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}]),n}(ba),gu=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshLambertMaterial=!0,r.type="MeshLambertMaterial",r.color=new ga(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new ga(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=0,r.normalScale=new _r(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.envMapRotation=new Oi,r.combine=0,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.flatShading=!1,r.fog=!0,r.setValues(e),r}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}]),n}(ba),yu=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshDepthMaterial=!0,r.type="MeshDepthMaterial",r.depthPacking=3200,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.setValues(e),r}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}]),n}(ba),_u=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshDistanceMaterial=!0,r.type="MeshDistanceMaterial",r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.setValues(e),r}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}]),n}(ba),bu=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshMatcapMaterial=!0,r.defines={MATCAP:""},r.type="MeshMatcapMaterial",r.color=new ga(16777215),r.matcap=null,r.map=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=0,r.normalScale=new _r(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.flatShading=!1,r.fog=!0,r.setValues(e),r}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}]),n}(ba),xu=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isLineDashedMaterial=!0,r.type="LineDashedMaterial",r.scale=1,r.dashSize=3,r.gapSize=1,r.setValues(e),r}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}]),n}(Do);function wu(e,t){return e&&e.constructor!==t?"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e):e}function Tu(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}var Su=function(){function e(t,n,r,i){c(this,e),this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new n.constructor(r),this.sampleValues=n,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}return p(e,[{key:"evaluate",value:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var a;n:{r:if(!(e<r)){for(var o=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===o)break;if(i=r,e<(r=t[++n]))break t}a=t.length;break n}if(e>=i)break e;var s=t[1];e<s&&(n=2,i=s);for(var u=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===u)break;if(r=i,e>=(i=t[--n-1]))break t}a=n,n=0}for(;n<a;){var l=n+a>>>1;e<t[l]?a=l:n=l+1}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}},{key:"getSettings_",value:function(){return this.settings||this.DefaultSettings_}},{key:"copySampleValue_",value:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,a=0;a!==r;++a)t[a]=n[i+a];return t}},{key:"interpolate_",value:function(){throw new Error("call to abstract method")}},{key:"intervalChanged_",value:function(){}}]),e}(),Eu=function(e){v(n,e);var t=b(n);function n(e,r,i,a){var o;return c(this,n),(o=t.call(this,e,r,i,a))._weightPrev=-0,o._offsetPrev=-0,o._weightNext=-0,o._offsetNext=-0,o.DefaultSettings_={endingStart:Wn,endingEnd:Wn},o}return p(n,[{key:"intervalChanged_",value:function(e,t,n){var r=this.parameterPositions,i=e-2,a=e+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case Xn:i=e,o=2*t-n;break;case Qn:o=t+r[i=r.length-2]-r[i+1];break;default:i=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case Xn:a=e,s=2*n-t;break;case Qn:a=1,s=n+r[1]-r[0];break;default:a=e-1,s=t}var u=.5*(n-t),l=this.valueSize;this._weightPrev=u/(t-o),this._weightNext=u/(s-n),this._offsetPrev=i*l,this._offsetNext=a*l}},{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,l=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,f=this._weightNext,d=(n-t)/(r-t),p=d*d,A=p*d,v=-h*A+2*h*p-h*d,m=(1+h)*A+(-1.5-2*h)*p+(-.5+h)*d+1,g=(-1-f)*A+(1.5+f)*p+.5*d,y=f*A-f*p,_=0;_!==o;++_)i[_]=v*a[l+_]+m*a[u+_]+g*a[s+_]+y*a[c+_];return i}}]),n}(Su),ku=function(e){v(n,e);var t=b(n);function n(e,r,i,a){return c(this,n),t.call(this,e,r,i,a)}return p(n,[{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,l=(n-t)/(r-t),c=1-l,h=0;h!==o;++h)i[h]=a[u+h]*c+a[s+h]*l;return i}}]),n}(Su),Mu=function(e){v(n,e);var t=b(n);function n(e,r,i,a){return c(this,n),t.call(this,e,r,i,a)}return p(n,[{key:"interpolate_",value:function(e){return this.copySampleValue_(e-1)}}]),n}(Su),Cu=function(){function e(t,n,r,i){if(c(this,e),void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===n||0===n.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=wu(n,this.TimeBufferType),this.values=wu(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}return p(e,[{key:"InterpolantFactoryMethodDiscrete",value:function(e){return new Mu(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodLinear",value:function(e){return new ku(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodSmooth",value:function(e){return new Eu(this.times,this.values,this.getValueSize(),e)}},{key:"setInterpolation",value:function(e){var t;switch(e){case jn:t=this.InterpolantFactoryMethodDiscrete;break;case Gn:t=this.InterpolantFactoryMethodLinear;break;case Hn:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}},{key:"getInterpolation",value:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return jn;case this.InterpolantFactoryMethodLinear:return Gn;case this.InterpolantFactoryMethodSmooth:return Hn}}},{key:"getValueSize",value:function(){return this.values.length/this.times.length}},{key:"shift",value:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this}},{key:"scale",value:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this}},{key:"trim",value:function(e,t){for(var n=this.times,r=n.length,i=0,a=r-1;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(i=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=n.slice(i,a),this.values=this.values.slice(i*o,a*o)}return this}},{key:"validate",value:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,o=0;o!==i;o++){var s=n[o];if("number"===typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(void 0!==r&&Tu(r))for(var u=0,l=r.length;u!==l;++u){var c=r[u];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,u,c),e=!1;break}}return e}},{key:"optimize",value:function(){for(var e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===Hn,i=e.length-1,a=1,o=1;o<i;++o){var s=!1,u=e[o];if(u!==e[o+1]&&(1!==o||u!==e[0]))if(r)s=!0;else for(var l=o*n,c=l-n,h=l+n,f=0;f!==n;++f){var d=t[l+f];if(d!==t[c+f]||d!==t[h+f]){s=!0;break}}if(s){if(o!==a){e[a]=e[o];for(var p=o*n,A=a*n,v=0;v!==n;++v)t[A+v]=t[p+v]}++a}}if(i>0){e[a]=e[i];for(var m=i*n,g=a*n,y=0;y!==n;++y)t[g+y]=t[m+y];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*n)):(this.times=e,this.values=t),this}},{key:"clone",value:function(){var e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}],[{key:"toJSON",value:function(e){var t,n=e.constructor;if(n.toJSON!==this.toJSON)t=n.toJSON(e);else{t={name:e.name,times:wu(e.times,Array),values:wu(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}]),e}();Cu.prototype.ValueTypeName="",Cu.prototype.TimeBufferType=Float32Array,Cu.prototype.ValueBufferType=Float32Array,Cu.prototype.DefaultInterpolation=Gn;var Ru=function(e){v(n,e);var t=b(n);function n(e,r,i){return c(this,n),t.call(this,e,r,i)}return p(n)}(Cu);Ru.prototype.ValueTypeName="bool",Ru.prototype.ValueBufferType=Array,Ru.prototype.DefaultInterpolation=jn,Ru.prototype.InterpolantFactoryMethodLinear=void 0,Ru.prototype.InterpolantFactoryMethodSmooth=void 0;var Pu=function(e){v(n,e);var t=b(n);function n(e,r,i,a){return c(this,n),t.call(this,e,r,i,a)}return p(n)}(Cu);Pu.prototype.ValueTypeName="color";var Nu=function(e){v(n,e);var t=b(n);function n(e,r,i,a){return c(this,n),t.call(this,e,r,i,a)}return p(n)}(Cu);Nu.prototype.ValueTypeName="number";var Iu=function(e){v(n,e);var t=b(n);function n(e,r,i,a){return c(this,n),t.call(this,e,r,i,a)}return p(n,[{key:"interpolate_",value:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-t)/(r-t),u=e*o,l=u+o;u!==l;u+=4)Yr.slerpFlat(i,0,a,u-o,a,u,s);return i}}]),n}(Su),Lu=function(e){v(n,e);var t=b(n);function n(e,r,i,a){return c(this,n),t.call(this,e,r,i,a)}return p(n,[{key:"InterpolantFactoryMethodLinear",value:function(e){return new Iu(this.times,this.values,this.getValueSize(),e)}}]),n}(Cu);Lu.prototype.ValueTypeName="quaternion",Lu.prototype.InterpolantFactoryMethodSmooth=void 0;var Du=function(e){v(n,e);var t=b(n);function n(e,r,i){return c(this,n),t.call(this,e,r,i)}return p(n)}(Cu);Du.prototype.ValueTypeName="string",Du.prototype.ValueBufferType=Array,Du.prototype.DefaultInterpolation=jn,Du.prototype.InterpolantFactoryMethodLinear=void 0,Du.prototype.InterpolantFactoryMethodSmooth=void 0;var Ou=function(e){v(n,e);var t=b(n);function n(e,r,i,a){return c(this,n),t.call(this,e,r,i,a)}return p(n)}(Cu);Ou.prototype.ValueTypeName="vector";var Uu={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},Bu=p((function e(t,n,r){c(this,e);var i=this,a=!1,o=0,s=0,u=void 0,l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=n,this.onError=r,this.itemStart=function(e){s++,!1===a&&void 0!==i.onStart&&i.onStart(e,o,s),a=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,s),o===s&&(a=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return u?u(e):e},this.setURLModifier=function(e){return u=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){var t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(var t=0,n=l.length;t<n;t+=2){var r=l[t],i=l[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return i}return null}})),Fu=new Bu,zu=function(){function e(t){c(this,e),this.manager=void 0!==t?t:Fu,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}return p(e,[{key:"load",value:function(){}},{key:"loadAsync",value:function(e,t){var n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))}},{key:"parse",value:function(){}},{key:"setCrossOrigin",value:function(e){return this.crossOrigin=e,this}},{key:"setWithCredentials",value:function(e){return this.withCredentials=e,this}},{key:"setPath",value:function(e){return this.path=e,this}},{key:"setResourcePath",value:function(e){return this.resourcePath=e,this}},{key:"setRequestHeader",value:function(e){return this.requestHeader=e,this}}]),e}();zu.DEFAULT_MATERIAL_NAME="__DEFAULT";Error;var Vu=function(e){v(n,e);var t=b(n);function n(e){return c(this,n),t.call(this,e)}return p(n,[{key:"load",value:function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=Uu.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;var o=Tr("img");function s(){l(),Uu.add(e,this),t&&t(this),i.manager.itemEnd(e)}function u(t){l(),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}function l(){o.removeEventListener("load",s,!1),o.removeEventListener("error",u,!1)}return o.addEventListener("load",s,!1),o.addEventListener("error",u,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o}}]),n}(zu),qu=function(e){v(n,e);var t=b(n);function n(e){return c(this,n),t.call(this,e)}return p(n,[{key:"load",value:function(e,t,n,r){var i=new jr,a=new Vu(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}]),n}(zu),ju=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return c(this,n),(r=t.call(this)).isLight=!0,r.type="Light",r.color=new ga(e),r.intensity=i,r}return p(n,[{key:"dispose",value:function(){}},{key:"copy",value:function(e,t){return ht(m(n.prototype),"copy",this).call(this,e,t),this.color.copy(e.color),this.intensity=e.intensity,this}},{key:"toJSON",value:function(e){var t=ht(m(n.prototype),"toJSON",this).call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(t.object.target=this.target.uuid),t}}]),n}($i),Gu=function(e){v(n,e);var t=b(n);function n(e,r,i){var a;return c(this,n),(a=t.call(this,e,i)).isHemisphereLight=!0,a.type="HemisphereLight",a.position.copy($i.DEFAULT_UP),a.updateMatrix(),a.groundColor=new ga(r),a}return p(n,[{key:"copy",value:function(e,t){return ht(m(n.prototype),"copy",this).call(this,e,t),this.groundColor.copy(e.groundColor),this}}]),n}(ju),Hu=new Ei,Wu=new Kr,Xu=new Kr,Qu=function(){function e(t){c(this,e),this.camera=t,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new _r(512,512),this.map=null,this.mapPass=null,this.matrix=new Ei,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Lo,this._frameExtents=new _r(1,1),this._viewportCount=1,this._viewports=[new Gr(0,0,1,1)]}return p(e,[{key:"getViewportCount",value:function(){return this._viewportCount}},{key:"getFrustum",value:function(){return this._frustum}},{key:"updateMatrices",value:function(e){var t=this.camera,n=this.matrix;Wu.setFromMatrixPosition(e.matrixWorld),t.position.copy(Wu),Xu.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Xu),t.updateMatrixWorld(),Hu.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Hu),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Hu)}},{key:"getViewport",value:function(e){return this._viewports[e]}},{key:"getFrameExtents",value:function(){return this._frameExtents}},{key:"dispose",value:function(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}},{key:"copy",value:function(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toJSON",value:function(){var e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}]),e}(),Yu=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this,new fo(50,1,.5,500))).isSpotLightShadow=!0,e.focus=1,e}return p(n,[{key:"updateMatrices",value:function(e){var t=this.camera,r=2*fr*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,a=e.distance||t.far;r===t.fov&&i===t.aspect&&a===t.far||(t.fov=r,t.aspect=i,t.far=a,t.updateProjectionMatrix()),ht(m(n.prototype),"updateMatrices",this).call(this,e)}},{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.focus=e.focus,this}}]),n}(Qu),Ku=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2;return c(this,n),(i=t.call(this,e,r)).isSpotLight=!0,i.type="SpotLight",i.position.copy($i.DEFAULT_UP),i.updateMatrix(),i.target=new $i,i.distance=a,i.angle=o,i.penumbra=s,i.decay=u,i.map=null,i.shadow=new Yu,i}return p(n,[{key:"power",get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e,t){return ht(m(n.prototype),"copy",this).call(this,e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(ju),Zu=new Ei,Ju=new Kr,$u=new Kr,el=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this,new fo(90,1,.5,500))).isPointLightShadow=!0,e._frameExtents=new _r(4,2),e._viewportCount=6,e._viewports=[new Gr(2,1,1,1),new Gr(0,1,1,1),new Gr(3,1,1,1),new Gr(1,1,1,1),new Gr(3,0,1,1),new Gr(1,0,1,1)],e._cubeDirections=[new Kr(1,0,0),new Kr(-1,0,0),new Kr(0,0,1),new Kr(0,0,-1),new Kr(0,1,0),new Kr(0,-1,0)],e._cubeUps=[new Kr(0,1,0),new Kr(0,1,0),new Kr(0,1,0),new Kr(0,1,0),new Kr(0,0,1),new Kr(0,0,-1)],e}return p(n,[{key:"updateMatrices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),Ju.setFromMatrixPosition(e.matrixWorld),n.position.copy(Ju),$u.copy(n.position),$u.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt($u),n.updateMatrixWorld(),r.makeTranslation(-Ju.x,-Ju.y,-Ju.z),Zu.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Zu)}}]),n}(Qu),tl=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;return c(this,n),(i=t.call(this,e,r)).isPointLight=!0,i.type="PointLight",i.distance=a,i.decay=o,i.shadow=new el,i}return p(n,[{key:"power",get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e,t){return ht(m(n.prototype),"copy",this).call(this,e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}]),n}(ju),nl=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;return c(this,n),(e=t.call(this)).isOrthographicCamera=!0,e.type="OrthographicCamera",e.zoom=1,e.view=null,e.left=r,e.right=i,e.top=a,e.bottom=o,e.near=s,e.far=u,e.updateProjectionMatrix(),e}return p(n,[{key:"copy",value:function(e,t){return ht(m(n.prototype),"copy",this).call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}},{key:"setViewOffset",value:function(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,a=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var u=(this.right-this.left)/this.view.fullWidth/this.zoom,l=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a=(i+=u*this.view.offsetX)+u*this.view.width,s=(o-=l*this.view.offsetY)-l*this.view.height}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var t=ht(m(n.prototype),"toJSON",this).call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}]),n}(uo),rl=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this,new nl(-5,5,5,-5,.5,500))).isDirectionalLightShadow=!0,e}return p(n)}(Qu),il=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,e,r)).isDirectionalLight=!0,i.type="DirectionalLight",i.position.copy($i.DEFAULT_UP),i.updateMatrix(),i.target=new $i,i.shadow=new rl,i}return p(n,[{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(ju),al=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,e,r)).isAmbientLight=!0,i.type="AmbientLight",i}return p(n)}(ju),ol=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return c(this,n),(i=t.call(this,e,r)).isRectAreaLight=!0,i.type="RectAreaLight",i.width=a,i.height=o,i}return p(n,[{key:"power",get:function(){return this.intensity*this.width*this.height*Math.PI},set:function(e){this.intensity=e/(this.width*this.height*Math.PI)}},{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.width=e.width,this.height=e.height,this}},{key:"toJSON",value:function(e){var t=ht(m(n.prototype),"toJSON",this).call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}]),n}(ju),sl=function(){function e(){c(this,e),this.isSphericalHarmonics3=!0,this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new Kr)}return p(e,[{key:"set",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}},{key:"zero",value:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}},{key:"getAt",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],n*r*1.092548),t.addScaledVector(a[5],r*i*1.092548),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],n*i*1.092548),t.addScaledVector(a[8],.546274*(n*n-r*r)),t}},{key:"getIrradianceAt",value:function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*r),t.addScaledVector(a[2],1.023328*i),t.addScaledVector(a[3],1.023328*n),t.addScaledVector(a[4],.858086*n*r),t.addScaledVector(a[5],.858086*r*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],.858086*n*i),t.addScaledVector(a[8],.429043*(n*n-r*r)),t}},{key:"add",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}},{key:"addScaledSH",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}},{key:"scale",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}},{key:"lerp",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}},{key:"equals",value:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}},{key:"copy",value:function(e){return this.set(e.coefficients)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}},{key:"toArray",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}}],[{key:"getBasisAt",value:function(e,t){var n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}]),e}(),ul=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new sl,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return c(this,n),(e=t.call(this,void 0,i)).isLightProbe=!0,e.sh=r,e}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.sh.copy(e.sh),this}},{key:"fromJSON",value:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}},{key:"toJSON",value:function(e){var t=ht(m(n.prototype),"toJSON",this).call(this,e);return t.object.sh=this.sh.toArray(),t}}]),n}(ju),ll=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this)).isInstancedBufferGeometry=!0,e.type="InstancedBufferGeometry",e.instanceCount=1/0,e}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.instanceCount=e.instanceCount,this}},{key:"toJSON",value:function(){var e=ht(m(n.prototype),"toJSON",this).call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}]),n}(qa),cl=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return c(this,n),(e=t.call(this)).isArrayCamera=!0,e.cameras=r,e.index=0,e}return p(n)}(fo),hl=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];c(this,e),this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}return p(e,[{key:"start",value:function(){this.startTime=fl(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=fl();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}]),e}();function fl(){return performance.now()}var dl="\\[\\]\\.:\\/",pl=new RegExp("["+dl+"]","g"),Al="[^"+dl+"]",vl="[^"+dl.replace("\\.","")+"]",ml=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Al)+/(WCOD+)?/.source.replace("WCOD",vl)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Al)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Al)+"$"),gl=["material","materials","bones","map"],yl=function(){function e(t,n,r){c(this,e);var i=r||_l.parseTrackName(n);this._targetGroup=t,this._bindings=t.subscribe_(n,i)}return p(e,[{key:"getValue",value:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}},{key:"setValue",value:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}},{key:"bind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}},{key:"unbind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}]),e}(),_l=function(){function e(t,n,r){c(this,e),this.path=n,this.parsedPath=r||e.parseTrackName(n),this.node=e.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}return p(e,[{key:"_getValue_unavailable",value:function(){}},{key:"_setValue_unavailable",value:function(){}},{key:"_getValue_direct",value:function(e,t){e[t]=this.targetObject[this.propertyName]}},{key:"_getValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]}},{key:"_getValue_arrayElement",value:function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}},{key:"_getValue_toArray",value:function(e,t){this.resolvedProperty.toArray(e,t)}},{key:"_setValue_direct",value:function(e,t){this.targetObject[this.propertyName]=e[t]}},{key:"_setValue_direct_setNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_direct_setMatrixWorldNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]}},{key:"_setValue_array_setNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}},{key:"_setValue_array_setMatrixWorldNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_arrayElement",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}},{key:"_setValue_arrayElement_setNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_arrayElement_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_fromArray",value:function(e,t){this.resolvedProperty.fromArray(e,t)}},{key:"_setValue_fromArray_setNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}},{key:"_setValue_fromArray_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_getValue_unbound",value:function(e,t){this.bind(),this.getValue(e,t)}},{key:"_setValue_unbound",value:function(e,t){this.bind(),this.setValue(e,t)}},{key:"bind",value:function(){var t=this.node,n=this.parsedPath,r=n.objectName,i=n.propertyName,a=n.propertyIndex;if(t||(t=e.findNode(this.rootNode,n.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(r){var o=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var s=0;s<t.length;s++)if(t[s].name===o){o=s;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var u=t[i];if(void 0!==u){var l=this.Versioning.None;this.targetObject=t,!0===t.isMaterial?l=this.Versioning.NeedsUpdate:!0===t.isObject3D&&(l=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[a]&&(a=t.morphTargetDictionary[a])}c=this.BindingType.ArrayElement,this.resolvedProperty=u,this.propertyIndex=a}else void 0!==u.fromArray&&void 0!==u.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=u):Array.isArray(u)?(c=this.BindingType.EntireArray,this.resolvedProperty=u):this.propertyName=i;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}else{var h=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+i+" but it wasn't found.",t)}}else console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".")}},{key:"unbind",value:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}],[{key:"create",value:function(t,n,r){return t&&t.isAnimationObjectGroup?new e.Composite(t,n,r):new e(t,n,r)}},{key:"sanitizeNodeName",value:function(e){return e.replace(/\s/g,"_").replace(pl,"")}},{key:"parseTrackName",value:function(e){var t=ml.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==gl.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}},{key:"findNode",value:function(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function e(n){for(var r=0;r<n.length;r++){var i=n[r];if(i.name===t||i.uuid===t)return i;var a=e(i.children);if(a)return a}return null}(e.children);if(r)return r}return null}}]),e}();_l.Composite=yl,_l.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},_l.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},_l.prototype.GetterByBindingType=[_l.prototype._getValue_direct,_l.prototype._getValue_array,_l.prototype._getValue_arrayElement,_l.prototype._getValue_toArray],_l.prototype.SetterByBindingTypeAndVersioning=[[_l.prototype._setValue_direct,_l.prototype._setValue_direct_setNeedsUpdate,_l.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[_l.prototype._setValue_array,_l.prototype._setValue_array_setNeedsUpdate,_l.prototype._setValue_array_setMatrixWorldNeedsUpdate],[_l.prototype._setValue_arrayElement,_l.prototype._setValue_arrayElement_setNeedsUpdate,_l.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[_l.prototype._setValue_fromArray,_l.prototype._setValue_fromArray_setNeedsUpdate,_l.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);var bl=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return c(this,n),(i=t.call(this,e,r)).isInstancedInterleavedBuffer=!0,i.meshPerAttribute=a,i}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}},{key:"clone",value:function(e){var t=ht(m(n.prototype),"clone",this).call(this,e);return t.meshPerAttribute=this.meshPerAttribute,t}},{key:"toJSON",value:function(e){var t=ht(m(n.prototype),"toJSON",this).call(this,e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}]),n}(xo),xl=new Ei,wl=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;c(this,e),this.ray=new Si(t,n),this.near=r,this.far=i,this.camera=null,this.layers=new Ui,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}return p(e,[{key:"set",value:function(e,t){this.ray.set(e,t)}},{key:"setFromCamera",value:function(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}},{key:"setFromXRController",value:function(e){return xl.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(xl),this}},{key:"intersectObject",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Sl(e,this,n,t),n.sort(Tl),n}},{key:"intersectObjects",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=0,i=e.length;r<i;r++)Sl(e[r],this,n,t);return n.sort(Tl),n}}]),e}();function Tl(e,t){return e.distance-t.distance}function Sl(e,t,n,r){var i=!0;e.layers.test(t.layers)&&(!1===e.raycast(t,n)&&(i=!1));if(!0===i&&!0===r)for(var a=e.children,o=0,s=a.length;o<s;o++)Sl(a[o],t,n,!0)}var El=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;c(this,e),this.radius=t,this.phi=n,this.theta=r}return p(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}},{key:"makeSafe",value:function(){var e=1e-6;return this.phi=pr(this.phi,e,Math.PI-e),this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(pr(t/this.radius,-1,1))),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),kl=function(){function e(t,n,r,i){c(this,e),e.prototype.isMatrix2=!0,this.elements=[1,0,0,1],void 0!==t&&this.set(t,n,r,i)}return p(e,[{key:"identity",value:function(){return this.set(1,0,0,1),this}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<4;n++)this.elements[n]=e[n+t];return this}},{key:"set",value:function(e,t,n,r){var i=this.elements;return i[0]=e,i[2]=t,i[1]=n,i[3]=r,this}}]),e}(),Ml=new Kr,Cl=new Kr,Rl=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Kr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Kr;c(this,e),this.start=t,this.end=n}return p(e,[{key:"set",value:function(e,t){return this.start.copy(e),this.end.copy(t),this}},{key:"copy",value:function(e){return this.start.copy(e.start),this.end.copy(e.end),this}},{key:"getCenter",value:function(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(e){return e.subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}},{key:"closestPointToPointParameter",value:function(e,t){Ml.subVectors(e,this.start),Cl.subVectors(this.end,this.start);var n=Cl.dot(Cl),r=Cl.dot(Ml)/n;return t&&(r=pr(r,0,1)),r}},{key:"closestPointToPoint",value:function(e,t,n){var r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}},{key:"applyMatrix4",value:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}},{key:"equals",value:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();var Pl=function(){function e(){c(this,e),this.type="ShapePath",this.color=new ga,this.subPaths=[],this.currentPath=null}return p(e,[{key:"moveTo",value:function(e,t){return this.currentPath=new Ts,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}},{key:"lineTo",value:function(e,t){return this.currentPath.lineTo(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,i,a){return this.currentPath.bezierCurveTo(e,t,n,r,i,a),this}},{key:"splineThru",value:function(e){return this.currentPath.splineThru(e),this}},{key:"toShapes",value:function(e){function t(e,t){for(var n=t.length,r=!1,i=n-1,a=0;a<n;i=a++){var o=t[i],s=t[a],u=s.x-o.x,l=s.y-o.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(o=t[a],u=-u,s=t[i],l=-l),e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var c=l*(e.x-o.x)-u*(e.y-o.y);if(0===c)return!0;if(c<0)continue;r=!r}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return r}var n,r,i,a=nu.isClockWise,o=this.subPaths;if(0===o.length)return[];var s=[];if(1===o.length)return r=o[0],(i=new ks).curves=r.curves,s.push(i),s;var u=!a(o[0].getPoints());u=e?!u:u;var l,c,h=[],f=[],d=[],p=0;f[p]=void 0,d[p]=[];for(var A=0,v=o.length;A<v;A++)n=a(l=(r=o[A]).getPoints()),(n=e?!n:n)?(!u&&f[p]&&p++,f[p]={s:new ks,p:l},f[p].s.curves=r.curves,u&&p++,d[p]=[]):d[p].push({h:r,p:l[0]});if(!f[0])return function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],a=new ks;a.curves=i.curves,t.push(a)}return t}(o);if(f.length>1){for(var m=!1,g=0,y=0,_=f.length;y<_;y++)h[y]=[];for(var b=0,x=f.length;b<x;b++)for(var w=d[b],T=0;T<w.length;T++){for(var S=w[T],E=!0,k=0;k<f.length;k++)t(S.p,f[k].p)&&(b!==k&&g++,E?(E=!1,h[k].push(S)):m=!0);E&&h[b].push(S)}g>0&&!1===m&&(d=h)}for(var M=0,C=f.length;M<C;M++){i=f[M].s,s.push(i);for(var R=0,P=(c=d[M]).length;R<P;R++)i.holes.push(c[R].h)}return s}}]),e}(),Nl=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this)).object=e,r.domElement=i,r.enabled=!0,r.state=-1,r.keys={},r.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},r.touches={ONE:null,TWO:null},r}return p(n,[{key:"connect",value:function(e){void 0!==e?(null!==this.domElement&&this.disconnect(),this.domElement=e):console.warn("THREE.Controls: connect() now requires an element.")}},{key:"disconnect",value:function(){}},{key:"dispose",value:function(){}},{key:"update",value:function(){}}]),n}(ur);function Il(e,t,n,r){var i=function(e){switch(e){case zt:case Vt:return{byteLength:1,components:1};case jt:case qt:case Xt:return{byteLength:2,components:1};case Qt:case Yt:return{byteLength:2,components:4};case Ht:case Gt:case Wt:return{byteLength:4,components:1};case Zt:return{byteLength:4,components:3}}throw new Error("Unknown texture type ".concat(e,"."))}(r);switch(n){case Jt:case tn:return e*t;case nn:return e*t*2;case on:case sn:return e*t/i.components*i.byteLength;case un:case ln:return e*t*2/i.components*i.byteLength;case $t:return e*t*3/i.components*i.byteLength;case en:case cn:return e*t*4/i.components*i.byteLength;case hn:case fn:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case dn:case pn:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case vn:case gn:return Math.max(e,16)*Math.max(t,8)/4;case An:case mn:return Math.max(e,8)*Math.max(t,8)/2;case yn:case _n:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case bn:case xn:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case wn:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case Tn:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case Sn:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case En:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case kn:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case Mn:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case Cn:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case Rn:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case Pn:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case Nn:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case In:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case Ln:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case Dn:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case On:case Un:case Bn:return Math.ceil(e/4)*Math.ceil(t/4)*16;case Fn:case zn:return Math.ceil(e/4)*Math.ceil(t/4)*8;case Vn:case qn:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw new Error("Unable to determine texture byte length for ".concat(n," format."))}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:dt}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=dt);var Ll=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.createElement("div");return c(this,n),(e=t.call(this)).isCSS2DObject=!0,e.element=r,e.element.style.position="absolute",e.element.style.userSelect="none",e.element.setAttribute("draggable",!1),e.center=new _r(.5,.5),e.addEventListener("removed",(function(){this.traverse((function(e){e.element instanceof e.element.ownerDocument.defaultView.Element&&null!==e.element.parentNode&&e.element.remove()}))})),e}return p(n,[{key:"copy",value:function(e,t){return ht(m(n.prototype),"copy",this).call(this,e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}]),n}($i),Dl=new Kr,Ol=new Ei,Ul=new Ei,Bl=new Kr,Fl=new Kr,zl=p((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,e);var n,r,i,a,o=this,s={objects:new WeakMap},u=void 0!==t.element?t.element:document.createElement("div");function l(e){e.isCSS2DObject&&(e.element.style.display="none");for(var t=0,n=e.children.length;t<n;t++)l(e.children[t])}function h(e,t,n){if(!1!==e.visible){if(e.isCSS2DObject){Dl.setFromMatrixPosition(e.matrixWorld),Dl.applyMatrix4(Ul);var r=Dl.z>=-1&&Dl.z<=1&&!0===e.layers.test(n.layers),c=e.element;c.style.display=!0===r?"":"none",!0===r&&(e.onBeforeRender(o,t,n),c.style.transform="translate("+-100*e.center.x+"%,"+-100*e.center.y+"%)translate("+(Dl.x*i+i)+"px,"+(-Dl.y*a+a)+"px)",c.parentNode!==u&&u.appendChild(c),e.onAfterRender(o,t,n));var d={distanceToCameraSquared:f(n,e)};s.objects.set(e,d)}for(var p=0,A=e.children.length;p<A;p++)h(e.children[p],t,n)}else l(e)}function f(e,t){return Bl.setFromMatrixPosition(e.matrixWorld),Fl.setFromMatrixPosition(t.matrixWorld),Bl.distanceToSquared(Fl)}function d(e){var t=[];return e.traverseVisible((function(e){e.isCSS2DObject&&t.push(e)})),t}function p(e){for(var t=d(e).sort((function(e,t){return e.renderOrder!==t.renderOrder?t.renderOrder-e.renderOrder:s.objects.get(e).distanceToCameraSquared-s.objects.get(t).distanceToCameraSquared})),n=t.length,r=0,i=t.length;r<i;r++)t[r].element.style.zIndex=n-r}u.style.overflow="hidden",this.domElement=u,this.getSize=function(){return{width:n,height:r}},this.render=function(e,t){!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),Ol.copy(t.matrixWorldInverse),Ul.multiplyMatrices(t.projectionMatrix,Ol),h(e,e,t),p(e)},this.setSize=function(e,t){i=(n=e)/2,a=(r=t)/2,u.style.width=e+"px",u.style.height=t+"px"}}));var Vl=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},ql="object"==typeof global&&global&&global.Object===Object&&global,jl="object"==typeof self&&self&&self.Object===Object&&self,Gl=ql||jl||Function("return this")(),Hl=function(){return Gl.Date.now()},Wl=/\s/;var Xl=function(e){for(var t=e.length;t--&&Wl.test(e.charAt(t)););return t},Ql=/^\s+/;var Yl=function(e){return e?e.slice(0,Xl(e)+1).replace(Ql,""):e},Kl=Gl.Symbol,Zl=Object.prototype,Jl=Zl.hasOwnProperty,$l=Zl.toString,ec=Kl?Kl.toStringTag:void 0;var tc=function(e){var t=Jl.call(e,ec),n=e[ec];try{e[ec]=void 0;var r=!0}catch(p0){}var i=$l.call(e);return r&&(t?e[ec]=n:delete e[ec]),i},nc=Object.prototype.toString;var rc=function(e){return nc.call(e)},ic=Kl?Kl.toStringTag:void 0;var ac=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":ic&&ic in Object(e)?tc(e):rc(e)};var oc=function(e){return null!=e&&"object"==typeof e};var sc=function(e){return"symbol"==typeof e||oc(e)&&"[object Symbol]"==ac(e)},uc=/^[-+]0x[0-9a-f]+$/i,lc=/^0b[01]+$/i,cc=/^0o[0-7]+$/i,hc=parseInt;var fc=function(e){if("number"==typeof e)return e;if(sc(e))return NaN;if(Vl(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Vl(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Yl(e);var n=lc.test(e);return n||cc.test(e)?hc(e.slice(2),n?2:8):uc.test(e)?NaN:+e},dc=Math.max,pc=Math.min;var Ac=function(e,t,n){var r,i,a,o,s,u,l=0,c=!1,h=!1,f=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function d(t){var n=r,a=i;return r=i=void 0,l=t,o=e.apply(a,n)}function p(e){return l=e,s=setTimeout(v,t),c?d(e):o}function A(e){var n=e-u;return void 0===u||n>=t||n<0||h&&e-l>=a}function v(){var e=Hl();if(A(e))return m(e);s=setTimeout(v,function(e){var n=t-(e-u);return h?pc(n,a-(e-l)):n}(e))}function m(e){return s=void 0,f&&r?d(e):(r=i=void 0,o)}function g(){var e=Hl(),n=A(e);if(r=arguments,i=this,u=e,n){if(void 0===s)return p(u);if(h)return clearTimeout(s),s=setTimeout(v,t),d(u)}return void 0===s&&(s=setTimeout(v,t)),o}return t=fc(t)||0,Vl(n)&&(c=!!n.leading,a=(h="maxWait"in n)?dc(fc(n.maxWait)||0,t):a,f="trailing"in n?!!n.trailing:f),g.cancel=function(){void 0!==s&&clearTimeout(s),l=0,r=u=i=s=void 0},g.flush=function(){return void 0===s?o:m(Hl())},g};function vc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function mc(e,t,n){return Object.defineProperty(e,"prototype",{writable:!1}),e}function gc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t);else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return vc(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vc(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var yc=mc((function e(t,n){var r=n.default,i=void 0===r?null:r,a=n.triggerUpdate,o=void 0===a||a,s=n.onChange,u=void 0===s?function(e,t){}:s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.defaultVal=i,this.triggerUpdate=o,this.onChange=u}));function _c(e){var t=e.stateInit,n=void 0===t?function(){return{}}:t,r=e.props,i=void 0===r?{}:r,a=e.methods,o=void 0===a?{}:a,s=e.aliases,u=void 0===s?{}:s,l=e.init,c=void 0===l?function(){}:l,h=e.update,f=void 0===h?function(){}:h,d=Object.keys(i).map((function(e){return new yc(e,i[e])}));return function e(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var a=!!(this instanceof e?this.constructor:void 0),s=a?r.shift():void 0,l=r[0],h=void 0===l?{}:l,p=Object.assign({},n instanceof Function?n(h):n,{initialised:!1}),A={};function v(e){return m(e,h),g(),v}var m=function(e,t){c.call(v,e,p,t),p.initialised=!0},g=Ac((function(){p.initialised&&(f.call(v,p,A),A={})}),1);return d.forEach((function(e){v[e.name]=function(e){var t=e.name,n=e.triggerUpdate,r=void 0!==n&&n,i=e.onChange,a=void 0===i?function(e,t){}:i,o=e.defaultVal,s=void 0===o?null:o;return function(e){var n=p[t];if(!arguments.length)return n;var i=void 0===e?s:e;return p[t]=i,a.call(v,i,p,n),!A.hasOwnProperty(t)&&(A[t]=n),r&&g(),v}}(e)})),Object.keys(o).forEach((function(e){v[e]=function(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=o[e]).call.apply(t,[v,p].concat(r))}})),Object.entries(u).forEach((function(e){var t=gc(e,2),n=t[0],r=t[1];return v[n]=v[r]})),v.resetProps=function(){return d.forEach((function(e){v[e.name](e.defaultVal)})),v},v.resetProps(),p._rerender=g,a&&s&&v(s),v}}var bc=Object.freeze({Linear:Object.freeze({None:function(e){return e},In:function(e){return e},Out:function(e){return e},InOut:function(e){return e}}),Quadratic:Object.freeze({In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}}),Circular:Object.freeze({In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}}),Back:Object.freeze({In:function(e){var t=1.70158;return 1===e?1:e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return 0===e?0:--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}),Bounce:Object.freeze({In:function(e){return 1-bc.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*bc.Bounce.In(2*e):.5*bc.Bounce.Out(2*e-1)+.5}}),generatePow:function(e){return void 0===e&&(e=4),e=(e=e<Number.EPSILON?Number.EPSILON:e)>1e4?1e4:e,{In:function(t){return Math.pow(t,e)},Out:function(t){return 1-Math.pow(1-t,e)},InOut:function(t){return t<.5?Math.pow(2*t,e)/2:(1-Math.pow(2-2*t,e))/2+.5}}}}),xc=function(){return performance.now()},wc=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return e.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map((function(t){return e._tweens[t]}))},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var a=i[r];null===(e=a._group)||void 0===e||e.remove(a),a._group=this,this._tweens[a.getId()]=a,this._tweensAddedDuringUpdate[a.getId()]=a}},e.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,r=e;n<r.length;n++){var i=r[n];i._group=void 0,delete this._tweens[i.getId()],delete this._tweensAddedDuringUpdate[i.getId()]}},e.prototype.allStopped=function(){return this.getAll().every((function(e){return!e.isPlaying()}))},e.prototype.update=function(e,t){void 0===e&&(e=xc()),void 0===t&&(t=!0);var n=Object.keys(this._tweens);if(0!==n.length)for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<n.length;r++){var i=this._tweens[n[r]],a=!t;i&&!1===i.update(e,a)&&!t&&this.remove(i)}n=Object.keys(this._tweensAddedDuringUpdate)}},e}(),Tc={Linear:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),a=Tc.Utils.Linear;return t<0?a(e[0],e[1],r):t>1?a(e[n],e[n-1],n-r):a(e[i],e[i+1>n?n:i+1],r-i)},Bezier:function(e,t){for(var n=0,r=e.length-1,i=Math.pow,a=Tc.Utils.Bernstein,o=0;o<=r;o++)n+=i(1-t,r-o)*i(t,o)*e[o]*a(r,o);return n},CatmullRom:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),a=Tc.Utils.CatmullRom;return e[0]===e[n]?(t<0&&(i=Math.floor(r=n*(1+t))),a(e[(i-1+n)%n],e[i],e[(i+1)%n],e[(i+2)%n],r-i)):t<0?e[0]-(a(e[0],e[0],e[1],e[1],-r)-e[0]):t>1?e[n]-(a(e[n],e[n],e[n-1],e[n-1],r-n)-e[n]):a(e[i?i-1:0],e[i],e[n<i+1?n:i+1],e[n<i+2?n:i+2],r-i)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=Tc.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:function(){var e=[1];return function(t){var n=1;if(e[t])return e[t];for(var r=t;r>1;r--)n*=r;return e[t]=n,n}}(),CatmullRom:function(e,t,n,r,i){var a=.5*(n-e),o=.5*(r-t),s=i*i;return(2*t-2*n+a+o)*(i*s)+(-3*t+3*n-2*a-o)*s+a*i+t}}},Sc=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),Ec=new wc,kc=function(){function e(e,t){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=bc.Linear.None,this._interpolationFunction=Tc.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=Sc.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,"object"===typeof t?(this._group=t,t.add(this)):!0===t&&(this._group=Ec,Ec.add(this))}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.getDuration=function(){return this._duration},e.prototype.to=function(e,t){if(void 0===t&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},e.prototype.duration=function(e){return void 0===e&&(e=1e3),this._duration=e<0?0:e,this},e.prototype.dynamic=function(e){return void 0===e&&(e=!1),this._isDynamic=e,this},e.prototype.start=function(e,t){if(void 0===e&&(e=xc()),void 0===t&&(t=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed)for(var n in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var i in this._valuesEnd)r[i]=this._valuesEnd[i];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},e.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},e.prototype._setupProperties=function(e,t,n,r,i){for(var a in n){var o=e[a],s=Array.isArray(o),u=s?"array":typeof o,l=!s&&Array.isArray(n[a]);if("undefined"!==u&&"function"!==u){if(l){if(0===(v=n[a]).length)continue;for(var c=[o],h=0,f=v.length;h<f;h+=1){var d=this._handleRelativeValue(o,v[h]);if(isNaN(d)){l=!1,console.warn("Found invalid interpolation list. Skipping.");break}c.push(d)}l&&(n[a]=c)}if("object"!==u&&!s||!o||l)("undefined"===typeof t[a]||i)&&(t[a]=o),s||(t[a]*=1),r[a]=l?n[a].slice().reverse():t[a]||0;else{t[a]=s?[]:{};var p=o;for(var A in p)t[a][A]=p[A];r[a]=s?[]:{};var v=n[a];if(!this._isDynamic){var m={};for(var A in v)m[A]=v[A];n[a]=v=m}this._setupProperties(p,t[a],v,r[a],i)}}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},e.prototype.pause=function(e){return void 0===e&&(e=xc()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e),this},e.prototype.resume=function(e){return void 0===e&&(e=xc()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this):this},e.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},e.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},e.prototype.remove=function(){var e;return null===(e=this._group)||void 0===e||e.remove(this),this},e.prototype.delay=function(e){return void 0===e&&(e=0),this._delayTime=e,this},e.prototype.repeat=function(e){return void 0===e&&(e=0),this._initialRepeat=e,this._repeat=e,this},e.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},e.prototype.yoyo=function(e){return void 0===e&&(e=!1),this._yoyo=e,this},e.prototype.easing=function(e){return void 0===e&&(e=bc.Linear.None),this._easingFunction=e,this},e.prototype.interpolation=function(e){return void 0===e&&(e=Tc.Linear),this._interpolationFunction=e,this},e.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},e.prototype.onStart=function(e){return this._onStartCallback=e,this},e.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},e.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},e.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},e.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},e.prototype.onStop=function(e){return this._onStopCallback=e,this},e.prototype.update=function(t,n){var r,i,a=this;if(void 0===t&&(t=xc()),void 0===n&&(n=e.autoStartOnUpdate),this._isPaused)return!0;if(!this._goToEnd&&!this._isPlaying){if(!n)return!1;this.start(t,!0)}if(this._goToEnd=!1,t<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=t-this._startTime,s=this._duration+(null!==(r=this._repeatDelayTime)&&void 0!==r?r:this._delayTime),u=this._duration+this._repeat*s,l=function(){if(0===a._duration)return 1;if(o>u)return 1;var e=Math.trunc(o/s),t=o-e*s,n=Math.min(t/a._duration,1);return 0===n&&o===a._duration?1:n}(),c=this._easingFunction(l);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,c),this._onUpdateCallback&&this._onUpdateCallback(this._object,l),0===this._duration||o>=this._duration){if(this._repeat>0){var h=Math.min(Math.trunc((o-this._duration)/s)+1,this._repeat);for(i in isFinite(this._repeat)&&(this._repeat-=h),this._valuesStartRepeat)this._yoyo||"string"!==typeof this._valuesEnd[i]||(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo&&this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=s*h,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var f=0,d=this._chainedTweens.length;f<d;f++)this._chainedTweens[f].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(e,t,n,r){for(var i in n)if(void 0!==t[i]){var a=t[i]||0,o=n[i],s=Array.isArray(e[i]),u=Array.isArray(o);!s&&u?e[i]=this._interpolationFunction(o,r):"object"===typeof o&&o?this._updateProperties(e[i],a,o,r):"number"===typeof(o=this._handleRelativeValue(a,o))&&(e[i]=a+(o-a)*r)}},e.prototype._handleRelativeValue=function(e,t){return"string"!==typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},e.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],n=this._valuesEnd[e];this._valuesStartRepeat[e]="string"===typeof n?this._valuesStartRepeat[e]+parseFloat(n):this._valuesEnd[e],this._valuesEnd[e]=t},e.autoStartOnUpdate=!1,e}(),Mc=(Sc.nextId,Ec);Mc.getAll.bind(Mc),Mc.removeAll.bind(Mc),Mc.add.bind(Mc),Mc.remove.bind(Mc),Mc.update.bind(Mc);function Cc(e,t,n,r,i){if(isNaN(t)||isNaN(n)||isNaN(r))return e;var a,o,s,u,l,c,h,f,d,p,A,v,m=e._root,g={data:i},y=e._x0,_=e._y0,b=e._z0,x=e._x1,w=e._y1,T=e._z1;if(!m)return e._root=g,e;for(;m.length;)if((f=t>=(o=(y+x)/2))?y=o:x=o,(d=n>=(s=(_+w)/2))?_=s:w=s,(p=r>=(u=(b+T)/2))?b=u:T=u,a=m,!(m=m[A=p<<2|d<<1|f]))return a[A]=g,e;if(l=+e._x.call(null,m.data),c=+e._y.call(null,m.data),h=+e._z.call(null,m.data),t===l&&n===c&&r===h)return g.next=m,a?a[A]=g:e._root=g,e;do{a=a?a[A]=new Array(8):e._root=new Array(8),(f=t>=(o=(y+x)/2))?y=o:x=o,(d=n>=(s=(_+w)/2))?_=s:w=s,(p=r>=(u=(b+T)/2))?b=u:T=u}while((A=p<<2|d<<1|f)===(v=(h>=u)<<2|(c>=s)<<1|l>=o));return a[v]=m,a[A]=g,e}function Rc(e,t,n,r,i,a,o){this.node=e,this.x0=t,this.y0=n,this.z0=r,this.x1=i,this.y1=a,this.z1=o}var Pc=function(e,t,n,r,i,a){return Math.sqrt(Math.pow(e-r,2)+Math.pow(t-i,2)+Math.pow(n-a,2))};function Nc(e){return e[0]}function Ic(e){return e[1]}function Lc(e){return e[2]}function Dc(e,t,n,r){var i=new Oc(null==t?Nc:t,null==n?Ic:n,null==r?Lc:r,NaN,NaN,NaN,NaN,NaN,NaN);return null==e?i:i.addAll(e)}function Oc(e,t,n,r,i,a,o,s,u){this._x=e,this._y=t,this._z=n,this._x0=r,this._y0=i,this._z0=a,this._x1=o,this._y1=s,this._z1=u,this._root=void 0}function Uc(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Bc=Dc.prototype=Oc.prototype;Bc.copy=function(){var e,t,n=new Oc(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),r=this._root;if(!r)return n;if(!r.length)return n._root=Uc(r),n;for(e=[{source:r,target:n._root=new Array(8)}];r=e.pop();)for(var i=0;i<8;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=new Array(8)}):r.target[i]=Uc(t));return n},Bc.add=function(e){var t=+this._x.call(null,e),n=+this._y.call(null,e),r=+this._z.call(null,e);return Cc(this.cover(t,n,r),t,n,r,e)},Bc.addAll=function(e){Array.isArray(e)||(e=Array.from(e));for(var t,n,r,i,a=e.length,o=new Float64Array(a),s=new Float64Array(a),u=new Float64Array(a),l=1/0,c=1/0,h=1/0,f=-1/0,d=-1/0,p=-1/0,A=0;A<a;++A)isNaN(n=+this._x.call(null,t=e[A]))||isNaN(r=+this._y.call(null,t))||isNaN(i=+this._z.call(null,t))||(o[A]=n,s[A]=r,u[A]=i,n<l&&(l=n),n>f&&(f=n),r<c&&(c=r),r>d&&(d=r),i<h&&(h=i),i>p&&(p=i));if(l>f||c>d||h>p)return this;this.cover(l,c,h).cover(f,d,p);for(var v=0;v<a;++v)Cc(this,o[v],s[v],u[v],e[v]);return this},Bc.cover=function(e,t,n){if(isNaN(e=+e)||isNaN(t=+t)||isNaN(n=+n))return this;var r=this._x0,i=this._y0,a=this._z0,o=this._x1,s=this._y1,u=this._z1;if(isNaN(r))o=(r=Math.floor(e))+1,s=(i=Math.floor(t))+1,u=(a=Math.floor(n))+1;else{for(var l,c,h=o-r||1,f=this._root;r>e||e>=o||i>t||t>=s||a>n||n>=u;)switch(c=(n<a)<<2|(t<i)<<1|e<r,(l=new Array(8))[c]=f,f=l,h*=2,c){case 0:o=r+h,s=i+h,u=a+h;break;case 1:r=o-h,s=i+h,u=a+h;break;case 2:o=r+h,i=s-h,u=a+h;break;case 3:r=o-h,i=s-h,u=a+h;break;case 4:o=r+h,s=i+h,a=u-h;break;case 5:r=o-h,s=i+h,a=u-h;break;case 6:o=r+h,i=s-h,a=u-h;break;case 7:r=o-h,i=s-h,a=u-h}this._root&&this._root.length&&(this._root=f)}return this._x0=r,this._y0=i,this._z0=a,this._x1=o,this._y1=s,this._z1=u,this},Bc.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},Bc.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1],+e[0][2]).cover(+e[1][0],+e[1][1],+e[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},Bc.find=function(e,t,n,r){var i,a,o,s,u,l,c,h,f,d=this._x0,p=this._y0,A=this._z0,v=this._x1,m=this._y1,g=this._z1,y=[],_=this._root;for(_&&y.push(new Rc(_,d,p,A,v,m,g)),null==r?r=1/0:(d=e-r,p=t-r,A=n-r,v=e+r,m=t+r,g=n+r,r*=r);h=y.pop();)if(!(!(_=h.node)||(a=h.x0)>v||(o=h.y0)>m||(s=h.z0)>g||(u=h.x1)<d||(l=h.y1)<p||(c=h.z1)<A))if(_.length){var b=(a+u)/2,x=(o+l)/2,w=(s+c)/2;y.push(new Rc(_[7],b,x,w,u,l,c),new Rc(_[6],a,x,w,b,l,c),new Rc(_[5],b,o,w,u,x,c),new Rc(_[4],a,o,w,b,x,c),new Rc(_[3],b,x,s,u,l,w),new Rc(_[2],a,x,s,b,l,w),new Rc(_[1],b,o,s,u,x,w),new Rc(_[0],a,o,s,b,x,w)),(f=(n>=w)<<2|(t>=x)<<1|e>=b)&&(h=y[y.length-1],y[y.length-1]=y[y.length-1-f],y[y.length-1-f]=h)}else{var T=e-+this._x.call(null,_.data),S=t-+this._y.call(null,_.data),E=n-+this._z.call(null,_.data),k=T*T+S*S+E*E;if(k<r){var M=Math.sqrt(r=k);d=e-M,p=t-M,A=n-M,v=e+M,m=t+M,g=n+M,i=_.data}}return i},Bc.findAllWithinRadius=function(e,t,n,r){var i=this,a=[],o=e-r,s=t-r,u=n-r,l=e+r,c=t+r,h=n+r;return this.visit((function(f,d,p,A,v,m,g){if(!f.length)do{var y=f.data;Pc(e,t,n,i._x(y),i._y(y),i._z(y))<=r&&a.push(y)}while(f=f.next);return d>l||p>c||A>h||v<o||m<s||g<u})),a},Bc.remove=function(e){if(isNaN(a=+this._x.call(null,e))||isNaN(o=+this._y.call(null,e))||isNaN(s=+this._z.call(null,e)))return this;var t,n,r,i,a,o,s,u,l,c,h,f,d,p,A,v=this._root,m=this._x0,g=this._y0,y=this._z0,_=this._x1,b=this._y1,x=this._z1;if(!v)return this;if(v.length)for(;;){if((h=a>=(u=(m+_)/2))?m=u:_=u,(f=o>=(l=(g+b)/2))?g=l:b=l,(d=s>=(c=(y+x)/2))?y=c:x=c,t=v,!(v=v[p=d<<2|f<<1|h]))return this;if(!v.length)break;(t[p+1&7]||t[p+2&7]||t[p+3&7]||t[p+4&7]||t[p+5&7]||t[p+6&7]||t[p+7&7])&&(n=t,A=p)}for(;v.data!==e;)if(r=v,!(v=v.next))return this;return(i=v.next)&&delete v.next,r?(i?r.next=i:delete r.next,this):t?(i?t[p]=i:delete t[p],(v=t[0]||t[1]||t[2]||t[3]||t[4]||t[5]||t[6]||t[7])&&v===(t[7]||t[6]||t[5]||t[4]||t[3]||t[2]||t[1]||t[0])&&!v.length&&(n?n[A]=v:this._root=v),this):(this._root=i,this)},Bc.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},Bc.root=function(){return this._root},Bc.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},Bc.visit=function(e){var t,n,r,i,a,o,s,u,l=[],c=this._root;for(c&&l.push(new Rc(c,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=l.pop();)if(!e(c=t.node,r=t.x0,i=t.y0,a=t.z0,o=t.x1,s=t.y1,u=t.z1)&&c.length){var h=(r+o)/2,f=(i+s)/2,d=(a+u)/2;(n=c[7])&&l.push(new Rc(n,h,f,d,o,s,u)),(n=c[6])&&l.push(new Rc(n,r,f,d,h,s,u)),(n=c[5])&&l.push(new Rc(n,h,i,d,o,f,u)),(n=c[4])&&l.push(new Rc(n,r,i,d,h,f,u)),(n=c[3])&&l.push(new Rc(n,h,f,a,o,s,d)),(n=c[2])&&l.push(new Rc(n,r,f,a,h,s,d)),(n=c[1])&&l.push(new Rc(n,h,i,a,o,f,d)),(n=c[0])&&l.push(new Rc(n,r,i,a,h,f,d))}return this},Bc.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new Rc(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=n.pop();){var i=t.node;if(i.length){var a,o=t.x0,s=t.y0,u=t.z0,l=t.x1,c=t.y1,h=t.z1,f=(o+l)/2,d=(s+c)/2,p=(u+h)/2;(a=i[0])&&n.push(new Rc(a,o,s,u,f,d,p)),(a=i[1])&&n.push(new Rc(a,f,s,u,l,d,p)),(a=i[2])&&n.push(new Rc(a,o,d,u,f,c,p)),(a=i[3])&&n.push(new Rc(a,f,d,u,l,c,p)),(a=i[4])&&n.push(new Rc(a,o,s,p,f,d,h)),(a=i[5])&&n.push(new Rc(a,f,s,p,l,d,h)),(a=i[6])&&n.push(new Rc(a,o,d,p,f,c,h)),(a=i[7])&&n.push(new Rc(a,f,d,p,l,c,h))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.z0,t.x1,t.y1,t.z1);return this},Bc.x=function(e){return arguments.length?(this._x=e,this):this._x},Bc.y=function(e){return arguments.length?(this._y=e,this):this._y},Bc.z=function(e){return arguments.length?(this._z=e,this):this._z};var Fc=Math.sqrt(50),zc=Math.sqrt(10),Vc=Math.sqrt(2);function qc(e,t,n){var r,i,a,o=(t-e)/Math.max(0,n),s=Math.floor(Math.log10(o)),u=o/Math.pow(10,s),l=u>=Fc?10:u>=zc?5:u>=Vc?2:1;return s<0?(a=Math.pow(10,-s)/l,(r=Math.round(e*a))/a<e&&++r,(i=Math.round(t*a))/a>t&&--i,a=-a):(a=Math.pow(10,s)*l,(r=Math.round(e/a))*a<e&&++r,(i=Math.round(t/a))*a>t&&--i),i<r&&.5<=n&&n<2?qc(e,t,2*n):[r,i,a]}function jc(e,t,n){return qc(e=+e,t=+t,n=+n)[2]}function Gc(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Hc(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Wc(e){var t,n,r;function i(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<a){if(0!==t(r,r))return a;do{var o=i+a>>>1;n(e[o],r)<0?i=o+1:a=o}while(i<a)}return i}return 2!==e.length?(t=Gc,n=function(t,n){return Gc(e(t),n)},r=function(t,n){return e(t)-n}):(t=e===Gc||e===Hc?e:Xc,n=e,r=e),{left:i,center:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,o=i(e,t,n,a-1);return o>n&&r(e[o-1],t)>-r(e[o],t)?o-1:o},right:function(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<a){if(0!==t(r,r))return a;do{var o=i+a>>>1;n(e[o],r)<=0?i=o+1:a=o}while(i<a)}return i}}}function Xc(){return 0}var Qc=Wc(Gc),Yc=Qc.right,Kc=(Qc.left,Wc((function(e){return null===e?NaN:+e})).center,Yc);function Zc(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Jc(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function $c(){}var eh=.7,th=1/eh,nh="\\s*([+-]?\\d+)\\s*",rh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ih="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ah=/^#([0-9a-f]{3,8})$/,oh=new RegExp("^rgb\\(".concat(nh,",").concat(nh,",").concat(nh,"\\)$")),sh=new RegExp("^rgb\\(".concat(ih,",").concat(ih,",").concat(ih,"\\)$")),uh=new RegExp("^rgba\\(".concat(nh,",").concat(nh,",").concat(nh,",").concat(rh,"\\)$")),lh=new RegExp("^rgba\\(".concat(ih,",").concat(ih,",").concat(ih,",").concat(rh,"\\)$")),ch=new RegExp("^hsl\\(".concat(rh,",").concat(ih,",").concat(ih,"\\)$")),hh=new RegExp("^hsla\\(".concat(rh,",").concat(ih,",").concat(ih,",").concat(rh,"\\)$")),fh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function dh(){return this.rgb().formatHex()}function ph(){return this.rgb().formatRgb()}function Ah(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=ah.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?vh(t):3===n?new _h(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?mh(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?mh(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=oh.exec(e))?new _h(t[1],t[2],t[3],1):(t=sh.exec(e))?new _h(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=uh.exec(e))?mh(t[1],t[2],t[3],t[4]):(t=lh.exec(e))?mh(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=ch.exec(e))?Eh(t[1],t[2]/100,t[3]/100,1):(t=hh.exec(e))?Eh(t[1],t[2]/100,t[3]/100,t[4]):fh.hasOwnProperty(e)?vh(fh[e]):"transparent"===e?new _h(NaN,NaN,NaN,0):null}function vh(e){return new _h(e>>16&255,e>>8&255,255&e,1)}function mh(e,t,n,r){return r<=0&&(e=t=n=NaN),new _h(e,t,n,r)}function gh(e){return e instanceof $c||(e=Ah(e)),e?new _h((e=e.rgb()).r,e.g,e.b,e.opacity):new _h}function yh(e,t,n,r){return 1===arguments.length?gh(e):new _h(e,t,n,null==r?1:r)}function _h(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function bh(){return"#".concat(Sh(this.r)).concat(Sh(this.g)).concat(Sh(this.b))}function xh(){var e=wh(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(Th(this.r),", ").concat(Th(this.g),", ").concat(Th(this.b)).concat(1===e?")":", ".concat(e,")"))}function wh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Th(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Sh(e){return((e=Th(e))<16?"0":"")+e.toString(16)}function Eh(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Mh(e,t,n,r)}function kh(e){if(e instanceof Mh)return new Mh(e.h,e.s,e.l,e.opacity);if(e instanceof $c||(e=Ah(e)),!e)return new Mh;if(e instanceof Mh)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(o=t===a?(n-r)/s+6*(n<r):n===a?(r-t)/s+2:(t-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new Mh(o,s,u,e.opacity)}function Mh(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Ch(e){return(e=(e||0)%360)<0?e+360:e}function Rh(e){return Math.max(0,Math.min(1,e||0))}function Ph(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Nh(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}Zc($c,Ah,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:dh,formatHex:dh,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return kh(this).formatHsl()},formatRgb:ph,toString:ph}),Zc(_h,yh,Jc($c,{brighter:function(e){return e=null==e?th:Math.pow(th,e),new _h(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?eh:Math.pow(eh,e),new _h(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},clamp:function(){return new _h(Th(this.r),Th(this.g),Th(this.b),wh(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bh,formatHex:bh,formatHex8:function(){return"#".concat(Sh(this.r)).concat(Sh(this.g)).concat(Sh(this.b)).concat(Sh(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:xh,toString:xh})),Zc(Mh,(function(e,t,n,r){return 1===arguments.length?kh(e):new Mh(e,t,n,null==r?1:r)}),Jc($c,{brighter:function(e){return e=null==e?th:Math.pow(th,e),new Mh(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?eh:Math.pow(eh,e),new Mh(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new _h(Ph(e>=240?e-240:e+120,i,r),Ph(e,i,r),Ph(e<120?e+240:e-120,i,r),this.opacity)},clamp:function(){return new Mh(Ch(this.h),Rh(this.s),Rh(this.l),wh(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=wh(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(Ch(this.h),", ").concat(100*Rh(this.s),"%, ").concat(100*Rh(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));var Ih=function(e){return function(){return e}};function Lh(e,t){return function(n){return e+n*t}}function Dh(e){return 1===(e=+e)?Oh:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Ih(isNaN(t)?n:t)}}function Oh(e,t){var n=t-e;return n?Lh(e,n):Ih(isNaN(e)?t:e)}var Uh=function e(t){var n=Dh(t);function r(e,t){var r=n((e=yh(e)).r,(t=yh(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=Oh(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function Bh(e){return function(t){var n,r,i=t.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=yh(t[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=e(a),o=e(o),s=e(s),r.opacity=1,function(e){return r.r=a(e),r.g=o(e),r.b=s(e),r+""}}}Bh((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return Nh((n-r/t)*t,o,i,a,s)}})),Bh((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return Nh((n-r/t)*t,i,a,o,s)}}));function Fh(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(a){for(n=0;n<r;++n)i[n]=e[n]*(1-a)+t[n]*a;return i}}function zh(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Vh(e,t){return(zh(t)?Fh:qh)(e,t)}function qh(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=Yh(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<i;++n)o[n]=a[n](e);return o}}function jh(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Gh(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Hh(e,t){var n,r={},i={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=Yh(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}var Wh=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Xh=new RegExp(Wh.source,"g");function Qh(e,t){var n,r,i,a=Wh.lastIndex=Xh.lastIndex=0,o=-1,s=[],u=[];for(e+="",t+="";(n=Wh.exec(e))&&(r=Xh.exec(t));)(i=r.index)>a&&(i=t.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,u.push({i:o,x:Gh(n,r)})),a=Xh.lastIndex;return a<t.length&&(i=t.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})}function Yh(e,t){var n,r=typeof t;return null==t||"boolean"===r?Ih(t):("number"===r?Gh:"string"===r?(n=Ah(t))?(t=n,Uh):Qh:t instanceof Ah?Uh:t instanceof Date?jh:zh(t)?Fh:Array.isArray(t)?qh:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?Hh:Gh)(e,t)}function Kh(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function Zh(e){return+e}var Jh=[0,1];function $h(e){return e}function ef(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function tf(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return i<r?(r=ef(i,r),a=n(o,a)):(r=ef(r,i),a=n(a,o)),function(e){return a(r(e))}}function nf(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=ef(e[o],e[o+1]),a[o]=n(t[o],t[o+1]);return function(t){var n=Kc(e,t,1,r)-1;return a[n](i[n](t))}}function rf(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function af(){var e,t,n,r,i,a,o=Jh,s=Jh,u=Yh,l=$h;function c(){var e=Math.min(o.length,s.length);return l!==$h&&(l=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(o[0],o[e-1])),r=e>2?nf:tf,i=a=null,h}function h(t){return null==t||isNaN(t=+t)?n:(i||(i=r(o.map(e),s,u)))(e(l(t)))}return h.invert=function(n){return l(t((a||(a=r(s,o.map(e),Gh)))(n)))},h.domain=function(e){return arguments.length?(o=Array.from(e,Zh),c()):o.slice()},h.range=function(e){return arguments.length?(s=Array.from(e),c()):s.slice()},h.rangeRound=function(e){return s=Array.from(e),u=Kh,c()},h.clamp=function(e){return arguments.length?(l=!!e||$h,c()):l!==$h},h.interpolate=function(e){return arguments.length?(u=e,c()):u},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,r){return e=n,t=r,c()}}function of(){return af()($h,$h)}function sf(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}var uf,lf=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function cf(e){if(!(t=lf.exec(e)))throw new Error("invalid format: "+e);var t;return new hf({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function hf(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function ff(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function df(e){return(e=ff(Math.abs(e)))?e[1]:NaN}function pf(e,t){var n=ff(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}cf.prototype=hf.prototype,hf.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Af={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return pf(100*e,t)},r:pf,s:function(e,t){var n=ff(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(uf=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+ff(e,Math.max(0,t+a-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function vf(e){return e}var mf,gf,yf,_f=Array.prototype.map,bf=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function xf(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?vf:(t=_f.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,a=[],o=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(e.substring(i-=s,i+s)),!((u+=s+1)>r));)s=t[o=(o+1)%t.length];return a.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",a=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?vf:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(_f.call(e.numerals,String)),u=void 0===e.percent?"%":e.percent+"",l=void 0===e.minus?"\u2212":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=cf(e)).fill,n=e.align,h=e.sign,f=e.symbol,d=e.zero,p=e.width,A=e.comma,v=e.precision,m=e.trim,g=e.type;"n"===g?(A=!0,g="g"):Af[g]||(void 0===v&&(v=12),m=!0,g="g"),(d||"0"===t&&"="===n)&&(d=!0,t="0",n="=");var y="$"===f?i:"#"===f&&/[boxX]/.test(g)?"0"+g.toLowerCase():"",_="$"===f?a:/[%p]/.test(g)?u:"",b=Af[g],x=/[defgprs%]/.test(g);function w(e){var i,a,u,f=y,w=_;if("c"===g)w=b(e)+w,e="";else{var T=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:b(Math.abs(e),v),m&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),T&&0===+e&&"+"!==h&&(T=!1),f=(T?"("===h?h:l:"-"===h||"("===h?"":h)+f,w=("s"===g?bf[8+uf/3]:"")+w+(T&&"("===h?")":""),x)for(i=-1,a=e.length;++i<a;)if(48>(u=e.charCodeAt(i))||u>57){w=(46===u?o+e.slice(i+1):e.slice(i))+w,e=e.slice(0,i);break}}A&&!d&&(e=r(e,1/0));var S=f.length+e.length+w.length,E=S<p?new Array(p-S+1).join(t):"";switch(A&&d&&(e=r(E+e,E.length?p-w.length:1/0),E=""),n){case"<":e=f+e+w+E;break;case"=":e=f+E+e+w;break;case"^":e=E.slice(0,S=E.length>>1)+f+e+w+E.slice(S);break;default:e=E+f+e+w}return s(e)}return v=void 0===v?6:/[gprs]/.test(g)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),w.toString=function(){return e+""},w}return{format:h,formatPrefix:function(e,t){var n=h(((e=cf(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(df(t)/3))),i=Math.pow(10,-r),a=bf[8+r/3];return function(e){return n(i*e)+a}}}}function wf(e,t,n,r){var i,a=function(e,t,n){n=+n;var r=(t=+t)<(e=+e),i=r?jc(t,e,n):jc(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}(e,t,n);switch((r=cf(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(df(t)/3)))-df(Math.abs(e)))}(a,o))||(r.precision=i),yf(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,df(t)-df(e))+1}(a,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(e){return Math.max(0,-df(Math.abs(e)))}(a))||(r.precision=i-2*("%"===r.type))}return gf(r)}function Tf(e){var t=e.domain;return e.ticks=function(e){var n=t();return function(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];var r=t<e,i=T(r?qc(t,e,n):qc(e,t,n),3),a=i[0],o=i[1],s=i[2];if(!(o>=a))return[];var u=o-a+1,l=new Array(u);if(r)if(s<0)for(var c=0;c<u;++c)l[c]=(o-c)/-s;else for(var h=0;h<u;++h)l[h]=(o-h)*s;else if(s<0)for(var f=0;f<u;++f)l[f]=(a+f)/-s;else for(var d=0;d<u;++d)l[d]=(a+d)*s;return l}(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return wf(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,a=t(),o=0,s=a.length-1,u=a[o],l=a[s],c=10;for(l<u&&(i=u,u=l,l=i,i=o,o=s,s=i);c-- >0;){if((i=jc(u,l,n))===r)return a[o]=u,a[s]=l,t(a);if(i>0)u=Math.floor(u/i)*i,l=Math.ceil(l/i)*i;else{if(!(i<0))break;u=Math.ceil(u*i)/i,l=Math.floor(l*i)/i}r=i}return e},e}function Sf(){var e=of();return e.copy=function(){return rf(e,Sf())},sf.apply(e,arguments),Tf(e)}mf=xf({thousands:",",grouping:[3],currency:["$",""]}),gf=mf.format,yf=mf.formatPrefix;var Ef=1e-6,kf=1e-12,Mf=Math.PI,Cf=Mf/2,Rf=Mf/4,Pf=2*Mf,Nf=180/Mf,If=Mf/180,Lf=Math.abs,Df=Math.atan,Of=Math.atan2,Uf=Math.cos,Bf=Math.ceil,Ff=Math.exp,zf=(Math.floor,Math.hypot),Vf=Math.log,qf=(Math.pow,Math.sin),jf=Math.sign||function(e){return e>0?1:e<0?-1:0},Gf=Math.sqrt,Hf=Math.tan;function Wf(e){return e>1?Cf:e<-1?-Cf:Math.asin(e)}function Xf(e){return(e=qf(e/2))*e}function Qf(e,t){return[e,Vf(Hf((Cf+t)/2))]}function Yf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Kf(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function Zf(e,t,n){return t=od(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,sd()?Reflect.construct(t,[],od(e).constructor):t.apply(e,n))}function Jf(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ed(e,t){return e.get(Kf(e,t))}function td(e,t,n){Jf(e,t),t.set(e,n)}function nd(e,t,n){return e.set(Kf(e,t),n),n}function rd(e,t){Jf(e,t),t.add(e)}function id(e,t,n){return function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,hd(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ad(e,t,n){return(t=hd(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function od(e){return od=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},od(e)}function sd(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(sd=function(){return!!e})()}function ud(e,t){return ud=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ud(e,t)}function ld(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t);else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(e,t)||fd(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cd(e){return function(e){if(Array.isArray(e))return Yf(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||fd(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hd(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}function fd(e,t){if(e){if("string"==typeof e)return Yf(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yf(e,t):void 0}}Qf.invert=function(e,t){return[e,2*Df(Ff(t))-Cf]};var dd=function(e){e instanceof Array?e.forEach(dd):(e.map&&e.map.dispose(),e.dispose())},pd=function(e){e.geometry&&e.geometry.dispose(),e.material&&dd(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(pd)},Ad=function(e){if(e&&e.children)for(;e.children.length;){var t=e.children[0];e.remove(t),pd(t)}};function vd(e,t,n){var r=(90-e)*Math.PI/180,i=(90-t)*Math.PI/180;return{x:n*Math.sin(r)*Math.cos(i),y:n*Math.cos(r),z:n*Math.sin(r)*Math.sin(i)}}function md(e){return e*Math.PI/180}var gd=function(e){return 1-(Qf(0,(.5-e)*Math.PI)[1]/Math.PI+1)/2},yd=function(e){return Math.max(0,Math.min(1,gd(e)))},_d=function(e){return.5-Qf.invert(0,(2*(1-e)-1)*Math.PI)[1]/Math.PI},bd=function(e,t,n,r){var i=Math.pow(2,e),a=Math.max(0,Math.min(i-1,Math.floor((n+180)*i/360))),o=(90-r)/180;return t&&(o=Math.max(0,Math.min(1,gd(o)))),[a,Math.floor(o*i)]},xd=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,o=[],s=Math.pow(2,e),u=360/s,l=180/s,c=void 0===i?s-1:i,h=void 0===a?s-1:a,f=n,d=Math.min(s-1,c);f<=d;f++)for(var p=r,A=Math.min(s-1,h);p<=A;p++){var v=p,m=l;if(t){v=0===p?p:_d(p/s)*s;var g=p+1===s?p+1:_d((p+1)/s)*s;m=180*(g-v)/s}var y=(f+.5)*u-180,_=90-(180*v/s+m/2),b=m;o.push({x:f,y:p,lng:y,lat:_,latLen:b})}return o},wd=new WeakMap,Td=new WeakMap,Sd=new WeakMap,Ed=new WeakMap,kd=new WeakMap,Md=new WeakMap,Cd=new WeakMap,Rd=new WeakMap,Pd=new WeakSet,Nd=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.tileUrl,a=r.minLevel,o=void 0===a?0:a,s=r.maxLevel,u=void 0===s?17:s,l=r.mercatorProjection,c=void 0===l||l;return $f(this,t),rd(n=Zf(this,t),Pd),td(n,wd,void 0),td(n,Td,void 0),td(n,Sd,void 0),td(n,Ed,void 0),td(n,kd,{}),td(n,Md,void 0),td(n,Cd,void 0),td(n,Rd,void 0),ad(n,"minLevel",void 0),ad(n,"maxLevel",void 0),ad(n,"thresholds",cd(new Array(30)).map((function(e,t){return 8/Math.pow(2,t)}))),ad(n,"curvatureResolution",5),ad(n,"tileMargin",0),ad(n,"clearTiles",(function(){Object.values(ed(kd,n)).forEach((function(e){e.forEach((function(e){e.obj&&(n.remove(e.obj),Ad(e.obj),delete e.obj)}))})),nd(kd,n,{})})),nd(wd,n,e),n.tileUrl=i,nd(Td,n,c),n.minLevel=o,n.maxLevel=u,n.level=0,n.add(nd(Rd,n,new eo(new uu(.99*ed(wd,n),180,90),new xa({color:0})))),ed(Rd,n).visible=!1,ed(Rd,n).material.polygonOffset=!0,ed(Rd,n).material.polygonOffsetUnits=3,ed(Rd,n).material.polygonOffsetFactor=1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ud(e,t)}(t,e),id(t,[{key:"tileUrl",get:function(){return ed(Sd,this)},set:function(e){nd(Sd,this,e),this.updatePov(ed(Cd,this))}},{key:"level",get:function(){return ed(Ed,this)},set:function(e){var t=this;ed(kd,this)[e]||Kf(Pd,this,Id).call(this,e);var n=ed(Ed,this);if(nd(Ed,this,e),e!==n&&void 0!==n){if(ed(Rd,this).visible=e>0,ed(kd,this)[e].forEach((function(e){return e.obj&&(e.obj.material.depthWrite=!0)})),n<e&&ed(kd,this)[n].forEach((function(e){return e.obj&&(e.obj.material.depthWrite=!1)})),n>e)for(var r=e+1;r<=n;r++)ed(kd,this)[r]&&ed(kd,this)[r].forEach((function(e){e.obj&&(t.remove(e.obj),Ad(e.obj),delete e.obj)}));Kf(Pd,this,Ld).call(this)}}},{key:"updatePov",value:function(e){var t,n=this;if(e&&e instanceof uo&&(nd(Cd,this,e),nd(Md,this,(function(r){if(!r.hullPnts){var i=360/Math.pow(2,n.level),a=r.lng,o=r.lat,s=r.latLen,u=a-i/2,l=a+i/2,c=o-s/2,h=o+s/2;r.hullPnts=[[o,a],[c,u],[h,u],[c,l],[h,l]].map((function(e){var t=ld(e,2);return vd(t[0],t[1],ed(wd,n))})).map((function(e){var t=e.x,n=e.y,r=e.z;return new Kr(t,n,r)}))}return t||(t=new Lo,e.updateMatrix(),e.updateMatrixWorld(),t.setFromProjectionMatrix((new Ei).multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse))),r.hullPnts.some((function(e){return t.containsPoint(e.clone().applyMatrix4(n.matrixWorld))}))})),this.tileUrl)){var r=(e.position.clone().distanceTo(this.getWorldPosition(new Kr))-ed(wd,this))/ed(wd,this),i=this.thresholds.findIndex((function(e){return e&&e<=r}));this.level=Math.min(this.maxLevel,Math.max(this.minLevel,i<0?this.thresholds.length:i)),Kf(Pd,this,Ld).call(this)}}}])}(go);function Id(e){var t=this;if(e>7)ed(kd,this)[e]=[];else{var n=ed(kd,this)[e]=xd(e,ed(Td,this));n.forEach((function(e){return e.centroid=vd(e.lat,e.lng,ed(wd,t))})),n.octree=Dc().x((function(e){return e.centroid.x})).y((function(e){return e.centroid.y})).z((function(e){return e.centroid.z})).addAll(n)}}function Ld(){var e=this;if(this.tileUrl&&void 0!==this.level&&ed(kd,this).hasOwnProperty(this.level)&&(ed(Md,this)||!(this.level>6))){var t=ed(kd,this)[this.level];if(ed(Cd,this)){var n=this.worldToLocal(ed(Cd,this).position.clone());if(t.octree){var r,i=this.worldToLocal(ed(Cd,this).position.clone()),a=3*(i.length()-ed(wd,this));t=(r=t.octree).findAllWithinRadius.apply(r,cd(i).concat([a]))}else{var o=function(e){var t=e.x,n=e.y,r=e.z,i=Math.sqrt(t*t+n*n+r*r),a=Math.acos(n/i),o=Math.atan2(r,t);return{lat:90-180*a/Math.PI,lng:90-180*o/Math.PI-(o<-Math.PI/2?360:0),r:i}}(n),s=90*(o.r/ed(wd,this)-1),u=s/Math.cos(md(o.lat)),l=[o.lng-u,o.lng+u],c=[o.lat+s,o.lat-s],h=ld(bd(this.level,ed(Td,this),l[0],c[0]),2),f=h[0],d=h[1],p=ld(bd(this.level,ed(Td,this),l[1],c[1]),2),A=p[0],v=p[1];!t.record&&(t.record={});var m=t.record;if(m.hasOwnProperty("".concat(Math.round((f+A)/2),"_").concat(Math.round((d+v)/2)))){for(var g=[],y=f;y<=A;y++)for(var _=d;_<=v;_++){var b="".concat(y,"_").concat(_);m.hasOwnProperty(b)||(m[b]=xd(this.level,ed(Td,this),y,_,y,_)[0],t.push(m[b])),g.push(m[b])}t=g}else t=xd(this.level,ed(Td,this),f,d,A,v).map((function(e){var n="".concat(e.x,"_").concat(e.y);return m.hasOwnProperty(n)?m[n]:(m[n]=e,t.push(e),e)}))}}t.filter((function(e){return!e.obj})).filter(ed(Md,this)||function(){return!0}).forEach((function(t){var n=t.x,r=t.y,i=t.lng,a=t.lat,o=t.latLen,s=360/Math.pow(2,e.level);if(!t.obj){var u=s*(1-e.tileMargin),l=o*(1-e.tileMargin),c=md(i),h=md(-a),f=new eo(new uu(ed(wd,e),Math.ceil(u/e.curvatureResolution),Math.ceil(l/e.curvatureResolution),md(90-u/2)+c,md(u),md(90-l/2)+h,md(l)),new gu);if(ed(Td,e)){var d=ld([a+o/2,a-o/2].map((function(e){return.5-e/180})),2),p=d[0],A=d[1];!function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=Sf().domain([1,0]).range([t,n]).clamp(!0),i=Sf().domain([yd(t),yd(n)]).range([1,0]).clamp(!0),a=function(e){return i(yd(r(e)))},o=e.array,s=0,u=o.length;s<u;s+=2)o[s+1]=a(o[s+1]);e.needsUpdate=!0}(f.geometry.attributes.uv,p,A)}t.obj=f}t.loading||(t.loading=!0,(new qu).load(e.tileUrl(n,r,e.level),(function(n){var r=t.obj;r&&(n.colorSpace=Kn,r.material.map=n,r.material.color=null,r.material.needsUpdate=!0,e.add(r)),t.loading=!1})))}))}}function Dd(e,t){var n,r,i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,o=t&&t.length,s=o?t[0]*a:e.length,u=Od(e,0,s,a,!0),l=[];if(!u||u.next===u.prev)return l;if(o&&(u=jd(e,t,u,a)),e.length>80*a){n=1/0,r=1/0;for(var c=-1/0,h=-1/0,f=a;f<s;f+=a){var d=e[f],p=e[f+1];d<n&&(n=d),p<r&&(r=p),d>c&&(c=d),p>h&&(h=p)}i=0!==(i=Math.max(c-n,h-r))?32767/i:0}return Bd(u,l,a,n,r,i,0),l}function Od(e,t,n,r,i){var a;if(i===up(e,t,n,r)>0)for(var o=t;o<n;o+=r)a=ap(o/r|0,e[o],e[o+1],a);else for(var s=n-r;s>=t;s-=r)a=ap(s/r|0,e[s],e[s+1],a);return a&&$d(a,a.next)&&(op(a),a=a.next),a}function Ud(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!$d(r,r.next)&&0!==Jd(r.prev,r,r.next))r=r.next;else{if(op(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function Bd(e,t,n,r,i,a,o){if(e){!o&&a&&function(e,t,n,r){var i=e;do{0===i.z&&(i.z=Xd(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n=1;do{var r=e,i=void 0;e=null;var a=null;for(t=0;r;){t++;for(var o=r,s=0,u=0;u<n&&(s++,o=o.nextZ);u++);for(var l=n;s>0||l>0&&o;)0!==s&&(0===l||!o||r.z<=o.z)?(i=r,r=r.nextZ,s--):(i=o,o=o.nextZ,l--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=o}a.nextZ=null,n*=2}while(t>1)}(i)}(e,r,i,a);for(var s=e;e.prev!==e.next;){var u=e.prev,l=e.next;if(a?zd(e,r,i,a):Fd(e))t.push(u.i,e.i,l.i),op(e),e=l.next,s=l.next;else if((e=l)===s){o?1===o?Bd(e=Vd(Ud(e),t),t,n,r,i,a,2):2===o&&qd(e,t,n,r,i,a):Bd(Ud(e),t,n,r,i,a,1);break}}}}function Fd(e){var t=e.prev,n=e,r=e.next;if(Jd(t,n,r)>=0)return!1;for(var i=t.x,a=n.x,o=r.x,s=t.y,u=n.y,l=r.y,c=Math.min(i,a,o),h=Math.min(s,u,l),f=Math.max(i,a,o),d=Math.max(s,u,l),p=r.next;p!==t;){if(p.x>=c&&p.x<=f&&p.y>=h&&p.y<=d&&Kd(i,s,a,u,o,l,p.x,p.y)&&Jd(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function zd(e,t,n,r){var i=e.prev,a=e,o=e.next;if(Jd(i,a,o)>=0)return!1;for(var s=i.x,u=a.x,l=o.x,c=i.y,h=a.y,f=o.y,d=Math.min(s,u,l),p=Math.min(c,h,f),A=Math.max(s,u,l),v=Math.max(c,h,f),m=Xd(d,p,t,n,r),g=Xd(A,v,t,n,r),y=e.prevZ,_=e.nextZ;y&&y.z>=m&&_&&_.z<=g;){if(y.x>=d&&y.x<=A&&y.y>=p&&y.y<=v&&y!==i&&y!==o&&Kd(s,c,u,h,l,f,y.x,y.y)&&Jd(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,_.x>=d&&_.x<=A&&_.y>=p&&_.y<=v&&_!==i&&_!==o&&Kd(s,c,u,h,l,f,_.x,_.y)&&Jd(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;y&&y.z>=m;){if(y.x>=d&&y.x<=A&&y.y>=p&&y.y<=v&&y!==i&&y!==o&&Kd(s,c,u,h,l,f,y.x,y.y)&&Jd(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;_&&_.z<=g;){if(_.x>=d&&_.x<=A&&_.y>=p&&_.y<=v&&_!==i&&_!==o&&Kd(s,c,u,h,l,f,_.x,_.y)&&Jd(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function Vd(e,t){var n=e;do{var r=n.prev,i=n.next.next;!$d(r,i)&&ep(r,n,n.next,i)&&rp(r,i)&&rp(i,r)&&(t.push(r.i,n.i,i.i),op(n),op(n.next),n=e=i),n=n.next}while(n!==e);return Ud(n)}function qd(e,t,n,r,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Zd(o,s)){var u=ip(o,s);return o=Ud(o,o.next),u=Ud(u,u.next),Bd(o,t,n,r,i,a,0),void Bd(u,t,n,r,i,a,0)}s=s.next}o=o.next}while(o!==e)}function jd(e,t,n,r){for(var i=[],a=0,o=t.length;a<o;a++){var s=Od(e,t[a]*r,a<o-1?t[a+1]*r:e.length,r,!1);s===s.next&&(s.steiner=!0),i.push(Qd(s))}i.sort(Gd);for(var u=0;u<i.length;u++)n=Hd(i[u],n);return n}function Gd(e,t){var n=e.x-t.x;0===n&&(0===(n=e.y-t.y)&&(n=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)));return n}function Hd(e,t){var n=function(e,t){var n,r=t,i=e.x,a=e.y,o=-1/0;if($d(e,r))return r;do{if($d(e,r.next))return r.next;if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>o&&(o=s,n=r.x<r.next.x?r:r.next,s===i))return n}r=r.next}while(r!==t);if(!n)return null;var u=n,l=n.x,c=n.y,h=1/0;r=n;do{if(i>=r.x&&r.x>=l&&i!==r.x&&Yd(a<c?i:o,a,l,c,a<c?o:i,a,r.x,r.y)){var f=Math.abs(a-r.y)/(i-r.x);rp(r,e)&&(f<h||f===h&&(r.x>n.x||r.x===n.x&&Wd(n,r)))&&(n=r,h=f)}r=r.next}while(r!==u);return n}(e,t);if(!n)return t;var r=ip(n,e);return Ud(r,r.next),Ud(n,n.next)}function Wd(e,t){return Jd(e.prev,e,t.prev)<0&&Jd(t.next,e,e.next)<0}function Xd(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Qd(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Yd(e,t,n,r,i,a,o,s){return(i-o)*(t-s)>=(e-o)*(a-s)&&(e-o)*(r-s)>=(n-o)*(t-s)&&(n-o)*(a-s)>=(i-o)*(r-s)}function Kd(e,t,n,r,i,a,o,s){return!(e===o&&t===s)&&Yd(e,t,n,r,i,a,o,s)}function Zd(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&ep(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(rp(e,t)&&rp(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!==n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Jd(e.prev,e,t.prev)||Jd(e,t.prev,t))||$d(e,t)&&Jd(e.prev,e,e.next)>0&&Jd(t.prev,t,t.next)>0)}function Jd(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function $d(e,t){return e.x===t.x&&e.y===t.y}function ep(e,t,n,r){var i=np(Jd(e,t,n)),a=np(Jd(e,t,r)),o=np(Jd(n,r,e)),s=np(Jd(n,r,t));return i!==a&&o!==s||(!(0!==i||!tp(e,n,t))||(!(0!==a||!tp(e,r,t))||(!(0!==o||!tp(n,e,r))||!(0!==s||!tp(n,t,r)))))}function tp(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function np(e){return e>0?1:e<0?-1:0}function rp(e,t){return Jd(e.prev,e,e.next)<0?Jd(e,t,e.next)>=0&&Jd(e,e.prev,t)>=0:Jd(e,t,e.prev)<0||Jd(e,e.next,t)<0}function ip(e,t){var n=sp(e.i,e.x,e.y),r=sp(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function ap(e,t,n,r){var i=sp(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function op(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function sp(e,t,n){return{i:e,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function up(e,t,n,r){for(var i=0,a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}function lp(e){var t,n=[],r=[],i=e[0][0].length,a=0,o=0,s=k(e);try{for(s.s();!(t=s.n()).done;){var u,l=t.value,c=k(l);try{for(c.s();!(u=c.n()).done;)for(var h=u.value,f=0;f<i;f++)n.push(h[f])}catch(d){c.e(d)}finally{c.f()}o&&(a+=o,r.push(a)),o=l.length}}catch(d){s.e(d)}finally{s.f()}return{vertices:n,holes:r,dimensions:i}}var cp=function(){function e(){c(this,e),this._partials=new Float64Array(32),this._n=0}return p(e,[{key:"add",value:function(e){for(var t=this._partials,n=0,r=0;r<this._n&&r<32;r++){var i=t[r],a=e+i,o=Math.abs(e)<Math.abs(i)?e-(a-i):i-(a-e);o&&(t[n++]=o),e=a}return t[n]=e,this._n=n+1,this}},{key:"valueOf",value:function(){var e,t,n,r=this._partials,i=this._n,a=0;if(i>0){for(a=r[--i];i>0&&(e=a,!(n=(t=r[--i])-((a=e+t)-e))););i>0&&(n<0&&r[i-1]<0||n>0&&r[i-1]>0)&&(t=2*n)==(e=a+t)-a&&(a=e)}return a}}]),e}();function hp(){}function fp(e,t){e&&gp.hasOwnProperty(e.type)&&gp[e.type](e,t)}var dp,pp,Ap,vp,mp={Feature:function(e,t){fp(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)fp(n[r].geometry,t)}},gp={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){yp(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)yp(n[r],t,0)},Polygon:function(e,t){_p(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)_p(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)fp(n[r],t)}};function yp(e,t,n){var r,i=-1,a=e.length-n;for(t.lineStart();++i<a;)r=e[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function _p(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)yp(e[n],t,1);t.polygonEnd()}function bp(e,t){e&&mp.hasOwnProperty(e.type)?mp[e.type](e,t):fp(e,t)}var xp={sphere:hp,point:hp,lineStart:function(){xp.point=Tp,xp.lineEnd=wp},lineEnd:hp,polygonStart:hp,polygonEnd:hp};function wp(){xp.point=xp.lineEnd=hp}function Tp(e,t){pp=e*=If,Ap=qf(t*=If),vp=Uf(t),xp.point=Sp}function Sp(e,t){e*=If;var n=qf(t*=If),r=Uf(t),i=Lf(e-pp),a=Uf(i),o=r*qf(i),s=vp*n-Ap*r*a,u=Ap*n+vp*r*a;dp.add(Of(Gf(o*o+s*s),u)),pp=e,Ap=n,vp=r}var Ep=[null,null],kp={type:"LineString",coordinates:Ep};function Mp(e,t){return Ep[0]=e,Ep[1]=t,function(e){return dp=new cp,bp(e,xp),+dp}(kp)}function Cp(e,t){var n=e[0]*If,r=e[1]*If,i=t[0]*If,a=t[1]*If,o=Uf(r),s=qf(r),u=Uf(a),l=qf(a),c=o*Uf(n),h=o*qf(n),f=u*Uf(i),d=u*qf(i),p=2*Wf(Gf(Xf(a-r)+o*u*Xf(i-n))),A=qf(p),v=p?function(e){var t=qf(e*=p)/A,n=qf(p-e)/A,r=n*c+t*f,i=n*h+t*d,a=n*s+t*l;return[Of(i,r)*Nf,Of(a,Gf(r*r+i*i))*Nf]}:function(){return[n*Nf,r*Nf]};return v.distance=p,v}function Rp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Pp(e,t,n){return t=Ip(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Lp()?Reflect.construct(t,[],Ip(e).constructor):t.apply(e,n))}function Np(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ip(e){return Ip=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ip(e)}function Lp(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Lp=function(){return!!e})()}function Dp(e,t){return Dp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Dp(e,t)}function Op(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(e,t)||Bp(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Up(e){return function(e){if(Array.isArray(e))return Rp(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Bp(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bp(e,t){if(e){if("string"==typeof e)return Rp(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rp(e,t):void 0}}var Fp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[],r=null;return e.forEach((function(e){if(r){var i=180*Mp(e,r)/Math.PI;if(i>t)for(var a=Cp(r,e),o=r.length>2||e.length>2?Gh(r[2]||0,e[2]||0):null,s=o?function(e){return[].concat(Up(a(e)),[o(e)])}:a,u=1/Math.ceil(i/t),l=u;l<1;)n.push(s(l)),l+=u}n.push(r=e)})),n},zp="undefined"!==typeof window&&window.THREE?window.THREE:{BufferGeometry:qa,Float32BufferAttribute:La},Vp=(new zp.BufferGeometry).setAttribute?"setAttribute":"addAttribute",qp=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;Np(this,t),(n=Pp(this,t)).type="GeoJsonGeometry",n.parameters={geoJson:e,radius:r,resolution:i};var a=({Point:l,MultiPoint:c,LineString:h,MultiLineString:f,Polygon:d,MultiPolygon:p}[e.type]||function(){return[]})(e.coordinates,r),o=[],s=[],u=0;function l(e,t){return[{vertices:Hp(e[1],e[0],t+(e[2]||0)),indices:[]}]}function c(e,t){var n={vertices:[],indices:[]};return e.map((function(e){return l(e,t)})).forEach((function(e){var t=Op(e,1)[0];jp(n,t)})),[n]}function h(e,t){for(var n=lp([Fp(e,i).map((function(e){var n=Op(e,3),r=n[0],i=n[1],a=n[2];return Hp(i,r,t+(void 0===a?0:a))}))]).vertices,r=Math.round(n.length/3),a=[],o=1;o<r;o++)a.push(o-1,o);return[{vertices:n,indices:a}]}function f(e,t){var n={vertices:[],indices:[]};return e.map((function(e){return h(e,t)})).forEach((function(e){var t=Op(e,1)[0];jp(n,t)})),[n]}function d(e,t){for(var n=lp(e.map((function(e){return Fp(e,i).map((function(e){var n=Op(e,3),r=n[0],i=n[1],a=n[2];return Hp(i,r,t+(void 0===a?0:a))}))}))),r=n.vertices,a=n.holes,o=a[0]||1/0,s=r.slice(0,3*o),u=r.slice(3*o),l=new Set(a),c=Math.round(r.length/3),h=[],f=[],d=1;d<c;d++)l.has(d)||(d<o?h.push(d-1,d):f.push(d-1-o,d-o));var p=[{indices:h,vertices:s}];return a.length&&p.push({indices:f,vertices:u}),p}function p(e,t){var n={vertices:[],indices:[]},r={vertices:[],indices:[]};e.map((function(e){return d(e,t)})).forEach((function(e){var t=Op(e,2),i=t[0],a=t[1];jp(n,i),a&&jp(r,a)}));var i=[n];return r.vertices.length&&i.push(r),i}return a.forEach((function(e){var t=o.length;jp({indices:o,vertices:s},e),n.addGroup(t,o.length-t,u++)})),o.length&&n.setIndex(o),s.length&&n[Vp]("position",new zp.Float32BufferAttribute(s,3)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dp(e,t)}(t,e),function(e,t,n){return Object.defineProperty(e,"prototype",{writable:!1}),e}(t)}(zp.BufferGeometry);function jp(e,t){var n=Math.round(e.vertices.length/3);Gp(e.vertices,t.vertices),Gp(e.indices,t.indices.map((function(e){return e+n})))}function Gp(e,t){var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Bp(e))||t){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.push(i)}}catch(a){r.e(a)}finally{r.f()}}function Hp(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=(90-e)*Math.PI/180,i=(90-t)*Math.PI/180;return[n*Math.sin(r)*Math.cos(i),n*Math.cos(r),n*Math.sin(r)*Math.sin(i)]}function Wp(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),a=new Array(i);++r<i;)a[r]=e+r*n;return a}function Xp(e,t,n){var r=Wp(e,t-Ef,n).concat(t);return function(e){return r.map((function(t){return[e,t]}))}}function Qp(e,t,n){var r=Wp(e,t-Ef,n).concat(t);return function(e){return r.map((function(t){return[t,e]}))}}function Yp(){return function(){var e,t,n,r,i,a,o,s,u,l,c,h,f=10,d=f,p=90,A=360,v=2.5;function m(){return{type:"MultiLineString",coordinates:g()}}function g(){return Wp(Bf(r/p)*p,n,p).map(c).concat(Wp(Bf(s/A)*A,o,A).map(h)).concat(Wp(Bf(t/f)*f,e,f).filter((function(e){return Lf(e%p)>Ef})).map(u)).concat(Wp(Bf(a/d)*d,i,d).filter((function(e){return Lf(e%A)>Ef})).map(l))}return m.lines=function(){return g().map((function(e){return{type:"LineString",coordinates:e}}))},m.outline=function(){return{type:"Polygon",coordinates:[c(r).concat(h(o).slice(1),c(n).reverse().slice(1),h(s).reverse().slice(1))]}},m.extent=function(e){return arguments.length?m.extentMajor(e).extentMinor(e):m.extentMinor()},m.extentMajor=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],s=+e[0][1],o=+e[1][1],r>n&&(e=r,r=n,n=e),s>o&&(e=s,s=o,o=e),m.precision(v)):[[r,s],[n,o]]},m.extentMinor=function(n){return arguments.length?(t=+n[0][0],e=+n[1][0],a=+n[0][1],i=+n[1][1],t>e&&(n=t,t=e,e=n),a>i&&(n=a,a=i,i=n),m.precision(v)):[[t,a],[e,i]]},m.step=function(e){return arguments.length?m.stepMajor(e).stepMinor(e):m.stepMinor()},m.stepMajor=function(e){return arguments.length?(p=+e[0],A=+e[1],m):[p,A]},m.stepMinor=function(e){return arguments.length?(f=+e[0],d=+e[1],m):[f,d]},m.precision=function(f){return arguments.length?(v=+f,u=Xp(a,i,90),l=Qp(t,e,v),c=Xp(s,o,90),h=Qp(r,n,v),m):v},m.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}()()}function Kp(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||!t.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!e.hasAttribute("position")||!e.hasAttribute("normal")||!e.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function r(e){if(e.normalized||e.isInterleavedBufferAttribute){for(var t=new Float32Array(e.count*e.itemSize),n=0,r=0;n<e.count;n++)t[r++]=e.getX(n),t[r++]=e.getY(n),e.itemSize>2&&(t[r++]=e.getZ(n));return t}return e.array instanceof Float32Array?e.array:new Float32Array(e.array)}var i=e.index?e.toNonIndexed():e,a=t.generateTangents(r(i.attributes.position),r(i.attributes.normal),r(i.attributes.uv));if(n)for(var o=3;o<a.length;o+=4)a[o]*=-1;return i.setAttribute("tangent",new Ra(a,4)),e!==i&&e.copy(i),e}function Zp(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null!==e[0].index,r=new Set(Object.keys(e[0].attributes)),i=new Set(Object.keys(e[0].morphAttributes)),a={},o={},s=e[0].morphTargetsRelative,u=new qa,l=0,c=0;c<e.length;++c){var h=e[c],f=0;if(n!==(null!==h.index))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(var d in h.attributes){if(!r.has(d))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+'. All geometries must have compatible attributes; make sure "'+d+'" attribute exists among all geometries, or in none of them.'),null;void 0===a[d]&&(a[d]=[]),a[d].push(h.attributes[d]),f++}if(f!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". Make sure all geometries have the same number of attributes."),null;if(s!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(var p in h.morphAttributes){if(!i.has(p))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===o[p]&&(o[p]=[]),o[p].push(h.morphAttributes[p])}if(t){var A=void 0;if(n)A=h.index.count;else{if(void 0===h.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". The geometry must have either an index or a position attribute"),null;A=h.attributes.position.count}u.addGroup(l,A,c),l+=A}}if(n){for(var v=0,m=[],g=0;g<e.length;++g){for(var y=e[g].index,_=0;_<y.count;++_)m.push(y.getX(_)+v);v+=e[g].attributes.position.count}u.setIndex(m)}for(var b in a){var x=Jp(a[b]);if(!x)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+b+" attribute."),null;u.setAttribute(b,x)}for(var w in o){var T=o[w][0].length;if(0===T)break;u.morphAttributes=u.morphAttributes||{},u.morphAttributes[w]=[];for(var S=0;S<T;++S){for(var E=[],k=0;k<o[w].length;++k)E.push(o[w][k][S]);var M=Jp(E);if(!M)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+w+" morphAttribute."),null;u.morphAttributes[w].push(M)}}return u}function Jp(e){for(var t,n,r,i=-1,a=0,o=0;o<e.length;++o){var s=e[o];if(void 0===t&&(t=s.array.constructor),t!==s.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===n&&(n=s.itemSize),n!==s.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===r&&(r=s.normalized),r!==s.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(-1===i&&(i=s.gpuType),i!==s.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;a+=s.count*n}for(var u=new t(a),l=new Ra(u,n,r),c=0,h=0;h<e.length;++h){var f=e[h];if(f.isInterleavedBufferAttribute)for(var d=c/n,p=0,A=f.count;p<A;p++)for(var v=0;v<n;v++){var m=f.getComponent(p,v);l.setComponent(p+d,v,m)}else u.set(f.array,c);c+=f.count*n}return void 0!==i&&(l.gpuType=i),l}function $p(e){return e.isInstancedInterleavedBufferAttribute||e.isInterleavedBufferAttribute?tA(e):e.isInstancedBufferAttribute?(new ko).copy(e):(new Ra).copy(e)}function eA(e){for(var t,n=0,r=0,i=0,a=e.length;i<a;++i){var o=e[i];if(void 0===t&&(t=o.array.constructor),t!==o.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;n+=o.array.length,r+=o.itemSize}for(var s=new xo(new t(n),r),u=0,l=[],c=["getX","getY","getZ","getW"],h=["setX","setY","setZ","setW"],f=0,d=e.length;f<d;f++){var p=e[f],A=p.itemSize,v=p.count,m=new To(s,A,u,p.normalized);l.push(m),u+=A;for(var g=0;g<v;g++)for(var y=0;y<A;y++)m[h[y]](g,p[c[y]](g))}return l}function tA(e){var t,n=e.data.array.constructor,r=e.count,i=e.itemSize,a=e.normalized,o=new n(r*i);t=e.isInstancedInterleavedBufferAttribute?new ko(o,i,a,e.meshPerAttribute):new Ra(o,i,a);for(var s=0;s<r;s++)t.setX(s,e.getX(s)),i>=2&&t.setY(s,e.getY(s)),i>=3&&t.setZ(s,e.getZ(s)),i>=4&&t.setW(s,e.getW(s));return t}function nA(e){var t=e.attributes,n=e.morphTargets,r=new Map;for(var i in t){var a=t[i];a.isInterleavedBufferAttribute&&(r.has(a)||r.set(a,tA(a)),t[i]=r.get(a))}for(var o in n){var s=n[o];s.isInterleavedBufferAttribute&&(r.has(s)||r.set(s,tA(s)),n[o]=r.get(s))}}function rA(e){var t=0;for(var n in e.attributes){var r=e.getAttribute(n);t+=r.count*r.itemSize*r.array.BYTES_PER_ELEMENT}var i=e.getIndex();return t+=i?i.count*i.itemSize*i.array.BYTES_PER_ELEMENT:0}function iA(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-4;t=Math.max(t,Number.EPSILON);for(var n={},r=e.getIndex(),i=e.getAttribute("position"),a=r?r.count:i.count,o=0,s=Object.keys(e.attributes),u={},l={},c=[],h=["getX","getY","getZ","getW"],f=["setX","setY","setZ","setW"],d=function(){var t=s[p],n=e.attributes[t];u[t]=new n.constructor(new n.array.constructor(n.count*n.itemSize),n.itemSize,n.normalized);var r=e.morphAttributes[t];r&&(l[t]||(l[t]=[]),r.forEach((function(e,n){var r=new e.array.constructor(e.count*e.itemSize);l[t][n]=new e.constructor(r,e.itemSize,e.normalized)})))},p=0,A=s.length;p<A;p++)d();for(var v=.5*t,m=Math.log10(1/t),g=Math.pow(10,m),y=v*g,_=0;_<a;_++){for(var b=r?r.getX(_):_,x="",w=0,T=s.length;w<T;w++)for(var S=s[w],E=e.getAttribute(S),k=E.itemSize,M=0;M<k;M++)x+="".concat(~~(E[h[M]](b)*g+y),",");if(x in n)c.push(n[x]);else{for(var C=0,R=s.length;C<R;C++)for(var P=s[C],N=e.getAttribute(P),I=e.morphAttributes[P],L=N.itemSize,D=u[P],O=l[P],U=0;U<L;U++){var B=h[U],F=f[U];if(D[F](o,N[B](b)),I)for(var z=0,V=I.length;z<V;z++)O[z][F](o,I[z][B](b))}n[x]=o,c.push(o),o++}}var q=e.clone();for(var j in e.attributes){var G=u[j];if(q.setAttribute(j,new G.constructor(G.array.slice(0,o*G.itemSize),G.itemSize,G.normalized)),j in l)for(var H=0;H<l[j].length;H++){var W=l[j][H];q.morphAttributes[j][H]=new W.constructor(W.array.slice(0,o*W.itemSize),W.itemSize,W.normalized)}}return q.setIndex(c),q}function aA(e,t){if(0===t)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(2===t||1===t){var n=e.getIndex();if(null===n){var r=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var a=0;a<i.count;a++)r.push(a);e.setIndex(r),n=e.getIndex()}var o=n.count-2,s=[];if(2===t)for(var u=1;u<=o;u++)s.push(n.getX(0)),s.push(n.getX(u)),s.push(n.getX(u+1));else for(var l=0;l<o;l++)l%2===0?(s.push(n.getX(l)),s.push(n.getX(l+1)),s.push(n.getX(l+2))):(s.push(n.getX(l+2)),s.push(n.getX(l+1)),s.push(n.getX(l)));s.length/3!==o&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var c=e.clone();return c.setIndex(s),c.clearGroups(),c}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}function oA(e){var t=new Kr,n=new Kr,r=new Kr,i=new Kr,a=new Kr,o=new Kr,s=new Kr,u=new Kr,l=new Kr;function c(e,c,h,f,d,p,A,v){t.fromBufferAttribute(c,d),n.fromBufferAttribute(c,p),r.fromBufferAttribute(c,A);var m=e.morphTargetInfluences;if(h&&m){s.set(0,0,0),u.set(0,0,0),l.set(0,0,0);for(var g=0,y=h.length;g<y;g++){var _=m[g],b=h[g];0!==_&&(i.fromBufferAttribute(b,d),a.fromBufferAttribute(b,p),o.fromBufferAttribute(b,A),f?(s.addScaledVector(i,_),u.addScaledVector(a,_),l.addScaledVector(o,_)):(s.addScaledVector(i.sub(t),_),u.addScaledVector(a.sub(n),_),l.addScaledVector(o.sub(r),_)))}t.add(s),n.add(u),r.add(l)}e.isSkinnedMesh&&(e.applyBoneTransform(d,t),e.applyBoneTransform(p,n),e.applyBoneTransform(A,r)),v[3*d+0]=t.x,v[3*d+1]=t.y,v[3*d+2]=t.z,v[3*p+0]=n.x,v[3*p+1]=n.y,v[3*p+2]=n.z,v[3*A+0]=r.x,v[3*A+1]=r.y,v[3*A+2]=r.z}var h,f,d,p,A,v,m,g,y=e.geometry,_=e.material,b=y.index,x=y.attributes.position,w=y.morphAttributes.position,T=y.morphTargetsRelative,S=y.attributes.normal,E=y.morphAttributes.position,k=y.groups,M=y.drawRange,C=new Float32Array(x.count*x.itemSize),R=new Float32Array(S.count*S.itemSize);if(null!==b)if(Array.isArray(_))for(p=0,v=k.length;p<v;p++)for(g=k[p],A=Math.max(g.start,M.start),m=Math.min(g.start+g.count,M.start+M.count);A<m;A+=3)c(e,x,w,T,h=b.getX(A),f=b.getX(A+1),d=b.getX(A+2),C),c(e,S,E,T,h,f,d,R);else for(p=Math.max(0,M.start),v=Math.min(b.count,M.start+M.count);p<v;p+=3)c(e,x,w,T,h=b.getX(p),f=b.getX(p+1),d=b.getX(p+2),C),c(e,S,E,T,h,f,d,R);else if(Array.isArray(_))for(p=0,v=k.length;p<v;p++)for(g=k[p],A=Math.max(g.start,M.start),m=Math.min(g.start+g.count,M.start+M.count);A<m;A+=3)c(e,x,w,T,h=A,f=A+1,d=A+2,C),c(e,S,E,T,h,f,d,R);else for(p=Math.max(0,M.start),v=Math.min(x.count,M.start+M.count);p<v;p+=3)c(e,x,w,T,h=p,f=p+1,d=p+2,C),c(e,S,E,T,h,f,d,R);return{positionAttribute:x,normalAttribute:S,morphedPositionAttribute:new La(C,3),morphedNormalAttribute:new La(R,3)}}function sA(e){if(0===e.groups.length)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),e;var t=e.groups;if(t=t.sort((function(e,t){return e.materialIndex!==t.materialIndex?e.materialIndex-t.materialIndex:e.start-t.start})),null===e.getIndex()){for(var n=e.getAttribute("position"),r=[],i=0;i<n.count;i+=3)r.push(i,i+1,i+2);e.setIndex(r)}for(var a=e.getIndex(),o=[],s=0;s<t.length;s++)for(var u=t[s],l=u.start,c=l+u.count,h=l;h<c;h++)o.push(a.getX(h));e.dispose(),e.setIndex(o);for(var f=0,d=0;d<t.length;d++){var p=t[d];p.start=f,f+=p.count}var A=t[0];e.groups=[A];for(var v=1;v<t.length;v++){var m=t[v];A.materialIndex===m.materialIndex?A.count+=m.count:(A=m,e.groups.push(A))}return e}function uA(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.PI/3,n=Math.cos(t),r=100*(1+1e-10),i=[new Kr,new Kr,new Kr],a=new Kr,o=new Kr,s=new Kr,u=new Kr;function l(e){var t=~~(e.x*r),n=~~(e.y*r),i=~~(e.z*r);return"".concat(t,",").concat(n,",").concat(i)}for(var c=e.index?e.toNonIndexed():e,h=c.attributes.position,f={},d=0,p=h.count/3;d<p;d++){var A=3*d,v=i[0].fromBufferAttribute(h,A+0),m=i[1].fromBufferAttribute(h,A+1),g=i[2].fromBufferAttribute(h,A+2);a.subVectors(g,m),o.subVectors(v,m);for(var y=(new Kr).crossVectors(a,o).normalize(),_=0;_<3;_++){var b=i[_],x=l(b);x in f||(f[x]=[]),f[x].push(y)}}for(var w=new Float32Array(3*h.count),T=new Ra(w,3,!1),S=0,E=h.count/3;S<E;S++){var k=3*S,M=i[0].fromBufferAttribute(h,k+0),C=i[1].fromBufferAttribute(h,k+1),R=i[2].fromBufferAttribute(h,k+2);a.subVectors(R,C),o.subVectors(M,C),s.crossVectors(a,o).normalize();for(var P=0;P<3;P++){var N=i[P],I=l(N),L=f[I];u.set(0,0,0);for(var D=0,O=L.length;D<O;D++){var U=L[D];s.dot(U)>n&&u.add(U)}u.normalize(),T.setXYZ(k+P,u.x,u.y,u.z)}}return c.setAttribute("normal",T),c}var lA=function(e){return"function"===typeof e?e:"string"===typeof e?function(t){return t[e]}:function(t){return e}};function cA(e){return cA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cA(e)}var hA=/^\s+/,fA=/\s+$/;function dA(e,t){if(t=t||{},(e=e||"")instanceof dA)return e;if(!(this instanceof dA))return new dA(e,t);var n=function(e){var t={r:0,g:0,b:0},n=1,r=null,i=null,a=null,o=!1,s=!1;"string"==typeof e&&(e=function(e){e=e.replace(hA,"").replace(fA,"").toLowerCase();var t,n=!1;if(RA[e])e=RA[e],n=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};if(t=zA.rgb.exec(e))return{r:t[1],g:t[2],b:t[3]};if(t=zA.rgba.exec(e))return{r:t[1],g:t[2],b:t[3],a:t[4]};if(t=zA.hsl.exec(e))return{h:t[1],s:t[2],l:t[3]};if(t=zA.hsla.exec(e))return{h:t[1],s:t[2],l:t[3],a:t[4]};if(t=zA.hsv.exec(e))return{h:t[1],s:t[2],v:t[3]};if(t=zA.hsva.exec(e))return{h:t[1],s:t[2],v:t[3],a:t[4]};if(t=zA.hex8.exec(e))return{r:DA(t[1]),g:DA(t[2]),b:DA(t[3]),a:FA(t[4]),format:n?"name":"hex8"};if(t=zA.hex6.exec(e))return{r:DA(t[1]),g:DA(t[2]),b:DA(t[3]),format:n?"name":"hex"};if(t=zA.hex4.exec(e))return{r:DA(t[1]+""+t[1]),g:DA(t[2]+""+t[2]),b:DA(t[3]+""+t[3]),a:FA(t[4]+""+t[4]),format:n?"name":"hex8"};if(t=zA.hex3.exec(e))return{r:DA(t[1]+""+t[1]),g:DA(t[2]+""+t[2]),b:DA(t[3]+""+t[3]),format:n?"name":"hex"};return!1}(e));"object"==cA(e)&&(VA(e.r)&&VA(e.g)&&VA(e.b)?(t=function(e,t,n){return{r:255*IA(e,255),g:255*IA(t,255),b:255*IA(n,255)}}(e.r,e.g,e.b),o=!0,s="%"===String(e.r).substr(-1)?"prgb":"rgb"):VA(e.h)&&VA(e.s)&&VA(e.v)?(r=UA(e.s),i=UA(e.v),t=function(e,t,n){e=6*IA(e,360),t=IA(t,100),n=IA(n,100);var r=Math.floor(e),i=e-r,a=n*(1-t),o=n*(1-i*t),s=n*(1-(1-i)*t),u=r%6,l=[n,o,a,a,s,n][u],c=[s,n,n,o,a,a][u],h=[a,a,s,n,n,o][u];return{r:255*l,g:255*c,b:255*h}}(e.h,r,i),o=!0,s="hsv"):VA(e.h)&&VA(e.s)&&VA(e.l)&&(r=UA(e.s),a=UA(e.l),t=function(e,t,n){var r,i,a;function o(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(e=IA(e,360),t=IA(t,100),n=IA(n,100),0===t)r=i=a=n;else{var s=n<.5?n*(1+t):n+t-n*t,u=2*n-s;r=o(u,s,e+1/3),i=o(u,s,e),a=o(u,s,e-1/3)}return{r:255*r,g:255*i,b:255*a}}(e.h,r,a),o=!0,s="hsl"),e.hasOwnProperty("a")&&(n=e.a));return n=NA(n),{ok:o,format:e.format||s,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:n}}(e);this._originalInput=e,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=t.format||n.format,this._gradientType=t.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}function pA(e,t,n){e=IA(e,255),t=IA(t,255),n=IA(n,255);var r,i,a=Math.max(e,t,n),o=Math.min(e,t,n),s=(a+o)/2;if(a==o)r=i=0;else{var u=a-o;switch(i=s>.5?u/(2-a-o):u/(a+o),a){case e:r=(t-n)/u+(t<n?6:0);break;case t:r=(n-e)/u+2;break;case n:r=(e-t)/u+4}r/=6}return{h:r,s:i,l:s}}function AA(e,t,n){e=IA(e,255),t=IA(t,255),n=IA(n,255);var r,i,a=Math.max(e,t,n),o=Math.min(e,t,n),s=a,u=a-o;if(i=0===a?0:u/a,a==o)r=0;else{switch(a){case e:r=(t-n)/u+(t<n?6:0);break;case t:r=(n-e)/u+2;break;case n:r=(e-t)/u+4}r/=6}return{h:r,s:i,v:s}}function vA(e,t,n,r){var i=[OA(Math.round(e).toString(16)),OA(Math.round(t).toString(16)),OA(Math.round(n).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function mA(e,t,n,r){return[OA(BA(r)),OA(Math.round(e).toString(16)),OA(Math.round(t).toString(16)),OA(Math.round(n).toString(16))].join("")}function gA(e,t){t=0===t?0:t||10;var n=dA(e).toHsl();return n.s-=t/100,n.s=LA(n.s),dA(n)}function yA(e,t){t=0===t?0:t||10;var n=dA(e).toHsl();return n.s+=t/100,n.s=LA(n.s),dA(n)}function _A(e){return dA(e).desaturate(100)}function bA(e,t){t=0===t?0:t||10;var n=dA(e).toHsl();return n.l+=t/100,n.l=LA(n.l),dA(n)}function xA(e,t){t=0===t?0:t||10;var n=dA(e).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(-t/100*255))),n.g=Math.max(0,Math.min(255,n.g-Math.round(-t/100*255))),n.b=Math.max(0,Math.min(255,n.b-Math.round(-t/100*255))),dA(n)}function wA(e,t){t=0===t?0:t||10;var n=dA(e).toHsl();return n.l-=t/100,n.l=LA(n.l),dA(n)}function TA(e,t){var n=dA(e).toHsl(),r=(n.h+t)%360;return n.h=r<0?360+r:r,dA(n)}function SA(e){var t=dA(e).toHsl();return t.h=(t.h+180)%360,dA(t)}function EA(e,t){if(isNaN(t)||t<=0)throw new Error("Argument to polyad must be a positive number");for(var n=dA(e).toHsl(),r=[dA(e)],i=360/t,a=1;a<t;a++)r.push(dA({h:(n.h+a*i)%360,s:n.s,l:n.l}));return r}function kA(e){var t=dA(e).toHsl(),n=t.h;return[dA(e),dA({h:(n+72)%360,s:t.s,l:t.l}),dA({h:(n+216)%360,s:t.s,l:t.l})]}function MA(e,t,n){t=t||6,n=n||30;var r=dA(e).toHsl(),i=360/n,a=[dA(e)];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,a.push(dA(r));return a}function CA(e,t){t=t||6;for(var n=dA(e).toHsv(),r=n.h,i=n.s,a=n.v,o=[],s=1/t;t--;)o.push(dA({h:r,s:i,v:a})),a=(a+s)%1;return o}dA.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,t,n,r=this.toRgb();return e=r.r/255,t=r.g/255,n=r.b/255,.2126*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.7152*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))},setAlpha:function(e){return this._a=NA(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=AA(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=AA(this._r,this._g,this._b),t=Math.round(360*e.h),n=Math.round(100*e.s),r=Math.round(100*e.v);return 1==this._a?"hsv("+t+", "+n+"%, "+r+"%)":"hsva("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=pA(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=pA(this._r,this._g,this._b),t=Math.round(360*e.h),n=Math.round(100*e.s),r=Math.round(100*e.l);return 1==this._a?"hsl("+t+", "+n+"%, "+r+"%)":"hsla("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return vA(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return function(e,t,n,r,i){var a=[OA(Math.round(e).toString(16)),OA(Math.round(t).toString(16)),OA(Math.round(n).toString(16)),OA(BA(r))];if(i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1))return a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0);return a.join("")}(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*IA(this._r,255))+"%",g:Math.round(100*IA(this._g,255))+"%",b:Math.round(100*IA(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Math.round(100*IA(this._r,255))+"%, "+Math.round(100*IA(this._g,255))+"%, "+Math.round(100*IA(this._b,255))+"%)":"rgba("+Math.round(100*IA(this._r,255))+"%, "+Math.round(100*IA(this._g,255))+"%, "+Math.round(100*IA(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(PA[vA(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+mA(this._r,this._g,this._b,this._a),n=t,r=this._gradientType?"GradientType = 1, ":"";if(e){var i=dA(e);n="#"+mA(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this._format;var n=!1,r=this._a<1&&this._a>=0;return t||!r||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"hex4"!==e&&"hex8"!==e&&"name"!==e?("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex4"===e&&(n=this.toHex8String(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},clone:function(){return dA(this.toString())},_applyModification:function(e,t){var n=e.apply(null,[this].concat([].slice.call(t)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(bA,arguments)},brighten:function(){return this._applyModification(xA,arguments)},darken:function(){return this._applyModification(wA,arguments)},desaturate:function(){return this._applyModification(gA,arguments)},saturate:function(){return this._applyModification(yA,arguments)},greyscale:function(){return this._applyModification(_A,arguments)},spin:function(){return this._applyModification(TA,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(MA,arguments)},complement:function(){return this._applyCombination(SA,arguments)},monochromatic:function(){return this._applyCombination(CA,arguments)},splitcomplement:function(){return this._applyCombination(kA,arguments)},triad:function(){return this._applyCombination(EA,[3])},tetrad:function(){return this._applyCombination(EA,[4])}},dA.fromRatio=function(e,t){if("object"==cA(e)){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]="a"===r?e[r]:UA(e[r]));e=n}return dA(e,t)},dA.equals=function(e,t){return!(!e||!t)&&dA(e).toRgbString()==dA(t).toRgbString()},dA.random=function(){return dA.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},dA.mix=function(e,t,n){n=0===n?0:n||50;var r=dA(e).toRgb(),i=dA(t).toRgb(),a=n/100;return dA({r:(i.r-r.r)*a+r.r,g:(i.g-r.g)*a+r.g,b:(i.b-r.b)*a+r.b,a:(i.a-r.a)*a+r.a})},dA.readability=function(e,t){var n=dA(e),r=dA(t);return(Math.max(n.getLuminance(),r.getLuminance())+.05)/(Math.min(n.getLuminance(),r.getLuminance())+.05)},dA.isReadable=function(e,t,n){var r,i,a=dA.readability(e,t);switch(i=!1,r=function(e){var t,n;t=((e=e||{level:"AA",size:"small"}).level||"AA").toUpperCase(),n=(e.size||"small").toLowerCase(),"AA"!==t&&"AAA"!==t&&(t="AA");"small"!==n&&"large"!==n&&(n="small");return{level:t,size:n}}(n),r.level+r.size){case"AAsmall":case"AAAlarge":i=a>=4.5;break;case"AAlarge":i=a>=3;break;case"AAAsmall":i=a>=7}return i},dA.mostReadable=function(e,t,n){var r,i,a,o,s=null,u=0;i=(n=n||{}).includeFallbackColors,a=n.level,o=n.size;for(var l=0;l<t.length;l++)(r=dA.readability(e,t[l]))>u&&(u=r,s=dA(t[l]));return dA.isReadable(e,s,{level:a,size:o})||!i?s:(n.includeFallbackColors=!1,dA.mostReadable(e,["#fff","#000"],n))};var RA=dA.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},PA=dA.hexNames=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}(RA);function NA(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function IA(e,t){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"===typeof e&&-1!=e.indexOf("%")}(e);return e=Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function LA(e){return Math.min(1,Math.max(0,e))}function DA(e){return parseInt(e,16)}function OA(e){return 1==e.length?"0"+e:""+e}function UA(e){return e<=1&&(e=100*e+"%"),e}function BA(e){return Math.round(255*parseFloat(e)).toString(16)}function FA(e){return DA(e)/255}var zA=function(){var e="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",t="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?",n="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?";return{CSS_UNIT:new RegExp(e),rgb:new RegExp("rgb"+t),rgba:new RegExp("rgba"+n),hsl:new RegExp("hsl"+t),hsla:new RegExp("hsla"+n),hsv:new RegExp("hsv"+t),hsva:new RegExp("hsva"+n),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function VA(e){return!!zA.CSS_UNIT.exec(e)}function qA(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function jA(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function GA(e,t){return e.get(jA(e,t))}function HA(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function WA(e,t,n){return e.set(jA(e,t),n),n}function XA(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,KA(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function QA(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t);else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(e,t)||ZA(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function YA(e){return function(e){if(Array.isArray(e))return qA(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ZA(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function KA(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}function ZA(e,t){if(e){if("string"==typeof e)return qA(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qA(e,t):void 0}}var JA=new WeakMap,$A=new WeakMap,ev=new WeakMap,tv=new WeakMap,nv=new WeakMap,rv=new WeakMap,iv=function(){return XA((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),HA(this,JA,new Map),HA(this,$A,new Map),HA(this,ev,(function(e){return e})),HA(this,tv,(function(){return{}})),HA(this,nv,(function(){})),HA(this,rv,(function(){}))}),[{key:"getObj",value:function(e){return GA(JA,this).get(GA(ev,this).call(this,e))}},{key:"getData",value:function(e){return GA($A,this).get(e)}},{key:"entries",value:function(){return YA(GA($A,this).entries()).map((function(e){var t=QA(e,2),n=t[0];return[t[1],n]}))}},{key:"id",value:function(e){return WA(ev,this,lA(e)),this}},{key:"onCreateObj",value:function(e){return WA(tv,this,e),this}},{key:"onUpdateObj",value:function(e){return WA(nv,this,e),this}},{key:"onRemoveObj",value:function(e){return WA(rv,this,e),this}},{key:"digest",value:function(e){var t=this;e.filter((function(e){return!GA(JA,t).has(GA(ev,t).call(t,e))})).forEach((function(e){var n=GA(tv,t).call(t,e);GA(JA,t).set(GA(ev,t).call(t,e),n),GA($A,t).set(n,e)}));var n=new Map(e.map((function(e){return[GA(ev,t).call(t,e),e]})));return GA(JA,this).forEach((function(e,r){n.has(r)?GA(nv,t).call(t,e,n.get(r)):(GA(rv,t).call(t,e,r),GA(JA,t).delete(r),GA($A,t).delete(e))})),this}},{key:"clear",value:function(){return this.digest([]),this}}])}(),av=n(463);function ov(){var e,t=0,n=1,r=1,i=[.5],a=[0,1];function o(t){return null!=t&&t<=t?a[Kc(i,t,0,r)]:e}function s(){var e=-1;for(i=new Array(r);++e<r;)i[e]=((e+1)*n-(e-r)*t)/(r+1);return o}return o.domain=function(e){var r;return arguments.length?(r=T(e,2),t=r[0],n=r[1],t=+t,n=+n,s()):[t,n]},o.range=function(e){return arguments.length?(r=(a=Array.from(e)).length-1,s()):a.slice()},o.invertExtent=function(e){var o=a.indexOf(e);return o<0?[NaN,NaN]:o<1?[t,i[0]]:o>=r?[i[r-1],n]:[i[o-1],i[o]]},o.unknown=function(t){return arguments.length?(e=t,o):o},o.thresholds=function(){return i.slice()},o.copy=function(){return ov().domain([t,n]).range(a).unknown(e)},sf.apply(Tf(o),arguments)}var sv=ft().mark(uv);function uv(e){var t,n,r;return ft().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t=k(e),i.prev=1,t.s();case 3:if((n=t.n()).done){i.next=8;break}return r=n.value,i.delegateYield(r,"t0",6);case 6:i.next=3;break;case 8:i.next=13;break;case 10:i.prev=10,i.t1=i.catch(1),t.e(i.t1);case 13:return i.prev=13,t.f(),i.finish(13);case 16:case"end":return i.stop()}}),sv,null,[[1,10,13,16]])}function lv(e){return Array.from(uv(e))}function cv(e,t){var n=0,r=0;if(void 0===t){var i,a=k(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;null!=o&&(o=+o)>=o&&(++n,r+=o)}}catch(h){a.e(h)}finally{a.f()}}else{var s,u=-1,l=k(e);try{for(l.s();!(s=l.n()).done;){var c=s.value;null!=(c=t(c,++u,e))&&(c=+c)>=c&&(++n,r+=c)}}catch(h){l.e(h)}finally{l.f()}}if(n)return r/n}function hv(e,t){var n,r;if(void 0===t){var i,a=k(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;null!=o&&(void 0===n?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}}catch(h){a.e(h)}finally{a.f()}}else{var s,u=-1,l=k(e);try{for(l.s();!(s=l.n()).done;){var c=s.value;null!=(c=t(c,++u,e))&&(void 0===n?c>=c&&(n=r=c):(n>c&&(n=c),r<c&&(r=c)))}}catch(h){l.e(h)}finally{l.f()}}return[n,r]}var fv=134217729;function dv(e,t,n,r,i){var a,o,s,u,l=t[0],c=r[0],h=0,f=0;c>l===c>-l?(a=l,l=t[++h]):(a=c,c=r[++f]);var d=0;if(h<e&&f<n)for(c>l===c>-l?(s=a-((o=l+a)-l),l=t[++h]):(s=a-((o=c+a)-c),c=r[++f]),a=o,0!==s&&(i[d++]=s);h<e&&f<n;)c>l===c>-l?(s=a-((o=a+l)-(u=o-a))+(l-u),l=t[++h]):(s=a-((o=a+c)-(u=o-a))+(c-u),c=r[++f]),a=o,0!==s&&(i[d++]=s);for(;h<e;)s=a-((o=a+l)-(u=o-a))+(l-u),l=t[++h],a=o,0!==s&&(i[d++]=s);for(;f<n;)s=a-((o=a+c)-(u=o-a))+(c-u),c=r[++f],a=o,0!==s&&(i[d++]=s);return 0===a&&0!==d||(i[d++]=a),d}function pv(e){return new Float64Array(e)}var Av=pv(4),vv=pv(8),mv=pv(12),gv=pv(16),yv=pv(4);function _v(e,t,n,r,i,a){var o=(t-a)*(n-i),s=(e-i)*(r-a),u=o-s,l=Math.abs(o+s);return Math.abs(u)>=33306690738754716e-32*l?u:-function(e,t,n,r,i,a,o){var s,u,l,c,h,f,d,p,A,v,m,g,y,_,b,x,w,T,S=e-i,E=n-i,k=t-a,M=r-a;h=(b=(p=S-(d=(f=fv*S)-(f-S)))*(v=M-(A=(f=fv*M)-(f-M)))-((_=S*M)-d*A-p*A-d*v))-(m=b-(w=(p=k-(d=(f=fv*k)-(f-k)))*(v=E-(A=(f=fv*E)-(f-E)))-((x=k*E)-d*A-p*A-d*v))),Av[0]=b-(m+h)+(h-w),h=(y=_-((g=_+m)-(h=g-_))+(m-h))-(m=y-x),Av[1]=y-(m+h)+(h-x),h=(T=g+m)-g,Av[2]=g-(T-h)+(m-h),Av[3]=T;var C=function(e,t){for(var n=t[0],r=1;r<e;r++)n+=t[r];return n}(4,Av),R=22204460492503146e-32*o;if(C>=R||-C>=R)return C;if(s=e-(S+(h=e-S))+(h-i),l=n-(E+(h=n-E))+(h-i),u=t-(k+(h=t-k))+(h-a),c=r-(M+(h=r-M))+(h-a),0===s&&0===u&&0===l&&0===c)return C;if(R=11093356479670487e-47*o+33306690738754706e-32*Math.abs(C),(C+=S*c+M*s-(k*l+E*u))>=R||-C>=R)return C;h=(b=(p=s-(d=(f=fv*s)-(f-s)))*(v=M-(A=(f=fv*M)-(f-M)))-((_=s*M)-d*A-p*A-d*v))-(m=b-(w=(p=u-(d=(f=fv*u)-(f-u)))*(v=E-(A=(f=fv*E)-(f-E)))-((x=u*E)-d*A-p*A-d*v))),yv[0]=b-(m+h)+(h-w),h=(y=_-((g=_+m)-(h=g-_))+(m-h))-(m=y-x),yv[1]=y-(m+h)+(h-x),h=(T=g+m)-g,yv[2]=g-(T-h)+(m-h),yv[3]=T;var P=dv(4,Av,4,yv,vv);h=(b=(p=S-(d=(f=fv*S)-(f-S)))*(v=c-(A=(f=fv*c)-(f-c)))-((_=S*c)-d*A-p*A-d*v))-(m=b-(w=(p=k-(d=(f=fv*k)-(f-k)))*(v=l-(A=(f=fv*l)-(f-l)))-((x=k*l)-d*A-p*A-d*v))),yv[0]=b-(m+h)+(h-w),h=(y=_-((g=_+m)-(h=g-_))+(m-h))-(m=y-x),yv[1]=y-(m+h)+(h-x),h=(T=g+m)-g,yv[2]=g-(T-h)+(m-h),yv[3]=T;var N=dv(P,vv,4,yv,mv);h=(b=(p=s-(d=(f=fv*s)-(f-s)))*(v=c-(A=(f=fv*c)-(f-c)))-((_=s*c)-d*A-p*A-d*v))-(m=b-(w=(p=u-(d=(f=fv*u)-(f-u)))*(v=l-(A=(f=fv*l)-(f-l)))-((x=u*l)-d*A-p*A-d*v))),yv[0]=b-(m+h)+(h-w),h=(y=_-((g=_+m)-(h=g-_))+(m-h))-(m=y-x),yv[1]=y-(m+h)+(h-x),h=(T=g+m)-g,yv[2]=g-(T-h)+(m-h),yv[3]=T;var I=dv(N,mv,4,yv,gv);return gv[I-1]}(e,t,n,r,i,a,l)}pv(4),pv(4),pv(4),pv(4),pv(4),pv(4),pv(4),pv(4),pv(4),pv(8),pv(8),pv(8),pv(4),pv(8),pv(8),pv(8),pv(12),pv(192),pv(192);pv(4),pv(4),pv(4),pv(4),pv(4),pv(4),pv(4),pv(4),pv(8),pv(8),pv(8),pv(8),pv(8),pv(8),pv(8),pv(8),pv(8),pv(4),pv(4),pv(4),pv(8),pv(16),pv(16),pv(16),pv(32),pv(32),pv(48),pv(64),pv(1152),pv(1152);pv(4),pv(4),pv(4),pv(4),pv(4),pv(4),pv(4),pv(4),pv(4),pv(4),pv(24),pv(24),pv(24),pv(24),pv(24),pv(24),pv(24),pv(24),pv(24),pv(24),pv(1152),pv(1152),pv(1152),pv(1152),pv(1152),pv(2304),pv(2304),pv(3456),pv(5760),pv(8),pv(8),pv(8),pv(16),pv(24),pv(48),pv(48),pv(96),pv(192),pv(384),pv(384),pv(384),pv(768);pv(96),pv(96),pv(96),pv(1152);var bv=Math.pow(2,-52),xv=new Uint32Array(512),wv=function(){function e(t){c(this,e);var n=t.length>>1;if(n>0&&"number"!==typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;var r=Math.max(2*n-5,0);this._triangles=new Uint32Array(3*r),this._halfedges=new Int32Array(3*r),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}return p(e,[{key:"update",value:function(){for(var e=this.coords,t=this._hullPrev,n=this._hullNext,r=this._hullTri,i=this._hullHash,a=e.length>>1,o=1/0,s=1/0,u=-1/0,l=-1/0,c=0;c<a;c++){var h=e[2*c],f=e[2*c+1];h<o&&(o=h),f<s&&(s=f),h>u&&(u=h),f>l&&(l=f),this._ids[c]=c}for(var d,p,A,v=(o+u)/2,m=(s+l)/2,g=0,y=1/0;g<a;g++){var _=Tv(v,m,e[2*g],e[2*g+1]);_<y&&(d=g,y=_)}for(var b=e[2*d],x=e[2*d+1],w=0,T=1/0;w<a;w++)if(w!==d){var S=Tv(b,x,e[2*w],e[2*w+1]);S<T&&S>0&&(p=w,T=S)}for(var E=e[2*p],k=e[2*p+1],M=1/0,C=0;C<a;C++)if(C!==d&&C!==p){var R=Ev(b,x,E,k,e[2*C],e[2*C+1]);R<M&&(A=C,M=R)}var P=e[2*A],N=e[2*A+1];if(M===1/0){for(var I=0;I<a;I++)this._dists[I]=e[2*I]-e[0]||e[2*I+1]-e[1];kv(this._ids,this._dists,0,a-1);for(var L=new Uint32Array(a),D=0,O=0,U=-1/0;O<a;O++){var B=this._ids[O],F=this._dists[B];F>U&&(L[D++]=B,U=F)}return this.hull=L.subarray(0,D),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(_v(b,x,E,k,P,N)<0){var z=p,V=E,q=k;p=A,E=P,k=N,A=z,P=V,N=q}var j=function(e,t,n,r,i,a){var o=n-e,s=r-t,u=i-e,l=a-t,c=o*o+s*s,h=u*u+l*l,f=.5/(o*l-s*u),d=e+(l*c-s*h)*f,p=t+(o*h-u*c)*f;return{x:d,y:p}}(b,x,E,k,P,N);this._cx=j.x,this._cy=j.y;for(var G=0;G<a;G++)this._dists[G]=Tv(e[2*G],e[2*G+1],j.x,j.y);kv(this._ids,this._dists,0,a-1),this._hullStart=d;var H=3;n[d]=t[A]=p,n[p]=t[d]=A,n[A]=t[p]=d,r[d]=0,r[p]=1,r[A]=2,i.fill(-1),i[this._hashKey(b,x)]=d,i[this._hashKey(E,k)]=p,i[this._hashKey(P,N)]=A,this.trianglesLen=0,this._addTriangle(d,p,A,-1,-1,-1);for(var W,X,Q=0;Q<this._ids.length;Q++){var Y=this._ids[Q],K=e[2*Y],Z=e[2*Y+1];if(!(Q>0&&Math.abs(K-W)<=bv&&Math.abs(Z-X)<=bv)&&(W=K,X=Z,Y!==d&&Y!==p&&Y!==A)){for(var J=0,$=0,ee=this._hashKey(K,Z);$<this._hashSize&&(-1===(J=i[(ee+$)%this._hashSize])||J===n[J]);$++);for(var te=J=t[J],ne=void 0;ne=n[te],_v(K,Z,e[2*te],e[2*te+1],e[2*ne],e[2*ne+1])>=0;)if((te=ne)===J){te=-1;break}if(-1!==te){var re=this._addTriangle(te,Y,n[te],-1,-1,r[te]);r[Y]=this._legalize(re+2),r[te]=re,H++;for(var ie=n[te];ne=n[ie],_v(K,Z,e[2*ie],e[2*ie+1],e[2*ne],e[2*ne+1])<0;)re=this._addTriangle(ie,Y,ne,r[Y],-1,r[ie]),r[Y]=this._legalize(re+2),n[ie]=ie,H--,ie=ne;if(te===J)for(;_v(K,Z,e[2*(ne=t[te])],e[2*ne+1],e[2*te],e[2*te+1])<0;)re=this._addTriangle(ne,Y,te,-1,r[te],r[ne]),this._legalize(re+2),r[ne]=re,n[te]=te,H--,te=ne;this._hullStart=t[Y]=te,n[te]=t[ie]=Y,n[Y]=ie,i[this._hashKey(K,Z)]=Y,i[this._hashKey(e[2*te],e[2*te+1])]=te}}}this.hull=new Uint32Array(H);for(var ae=0,oe=this._hullStart;ae<H;ae++)this.hull[ae]=oe,oe=n[oe];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}},{key:"_hashKey",value:function(e,t){return Math.floor(function(e,t){var n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}},{key:"_legalize",value:function(e){for(var t=this._triangles,n=this._halfedges,r=this.coords,i=0,a=0;;){var o=n[e],s=e-e%3;if(a=s+(e+2)%3,-1!==o){var u=o-o%3,l=s+(e+1)%3,c=u+(o+2)%3,h=t[a],f=t[e],d=t[l],p=t[c];if(Sv(r[2*h],r[2*h+1],r[2*f],r[2*f+1],r[2*d],r[2*d+1],r[2*p],r[2*p+1])){t[e]=p,t[o]=h;var A=n[c];if(-1===A){var v=this._hullStart;do{if(this._hullTri[v]===c){this._hullTri[v]=e;break}v=this._hullPrev[v]}while(v!==this._hullStart)}this._link(e,A),this._link(o,n[a]),this._link(a,c);var m=u+(o+1)%3;i<xv.length&&(xv[i++]=m)}else{if(0===i)break;e=xv[--i]}}else{if(0===i)break;e=xv[--i]}}return a}},{key:"_link",value:function(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}},{key:"_addTriangle",value:function(e,t,n,r,i,a){var o=this.trianglesLen;return this._triangles[o]=e,this._triangles[o+1]=t,this._triangles[o+2]=n,this._link(o,r),this._link(o+1,i),this._link(o+2,a),this.trianglesLen+=3,o}}],[{key:"from",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Cv,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Rv,i=t.length,a=new Float64Array(2*i),o=0;o<i;o++){var s=t[o];a[2*o]=n(s),a[2*o+1]=r(s)}return new e(a)}}]),e}();function Tv(e,t,n,r){var i=e-n,a=t-r;return i*i+a*a}function Sv(e,t,n,r,i,a,o,s){var u=e-o,l=t-s,c=n-o,h=r-s,f=i-o,d=a-s,p=c*c+h*h,A=f*f+d*d;return u*(h*A-p*d)-l*(c*A-p*f)+(u*u+l*l)*(c*d-h*f)<0}function Ev(e,t,n,r,i,a){var o=n-e,s=r-t,u=i-e,l=a-t,c=o*o+s*s,h=u*u+l*l,f=.5/(o*l-s*u),d=(l*c-s*h)*f,p=(o*h-u*c)*f;return d*d+p*p}function kv(e,t,n,r){if(r-n<=20)for(var i=n+1;i<=r;i++){for(var a=e[i],o=t[a],s=i-1;s>=n&&t[e[s]]>o;)e[s+1]=e[s--];e[s+1]=a}else{var u=n+1,l=r;Mv(e,n+r>>1,u),t[e[n]]>t[e[r]]&&Mv(e,n,r),t[e[u]]>t[e[r]]&&Mv(e,u,r),t[e[n]]>t[e[u]]&&Mv(e,n,u);for(var c=e[u],h=t[c];;){do{u++}while(t[e[u]]<h);do{l--}while(t[e[l]]>h);if(l<u)break;Mv(e,u,l)}e[n+1]=e[l],e[l]=c,r-u+1>=l-n?(kv(e,t,u,r),kv(e,t,n,l-1)):(kv(e,t,n,l-1),kv(e,t,u,r))}}function Mv(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function Cv(e){return e[0]}function Rv(e){return e[1]}function Pv(e,t){var n,r,i,a,o,s,u,l,c,h=0,f=e[0],d=e[1],p=t.length;for(n=0;n<p;n++){r=0;var A=t[n],v=A.length-1;if((l=A[0])[0]!==A[v][0]&&l[1]!==A[v][1])throw new Error("First and last coordinates in a ring must be the same");for(a=l[0]-f,o=l[1]-d;r<v;r++){if(s=(c=A[r+1])[0]-f,u=c[1]-d,0===o&&0===u){if(s<=0&&a>=0||a<=0&&s>=0)return 0}else if(u>=0&&o<=0||u<=0&&o>=0){if(0===(i=_v(a,s,o,u,0,0)))return 0;(i>0&&u>0&&o<=0||i<0&&u<=0&&o>0)&&h++}l=c,o=u,a=s}}return h%2!==0}function Nv(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return l(e.geometry.coordinates);if("Point"===e.type)return l(e.coordinates)}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return l(e);throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Iv(e){return"Feature"===e.type?e.geometry:e}function Lv(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}var Dv,Ov,Uv,Bv,Fv,zv,Vv,qv,jv,Gv,Hv,Wv,Xv,Qv,Yv,Kv,Zv=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var r=Nv(e),i=Iv(t),a=i.type,o=t.bbox,s=i.coordinates;if(o&&!1===Lv(r,o))return!1;"Polygon"===a&&(s=[s]);for(var u=!1,l=0;l<s.length;++l){var c=Pv(r,s[l]);if(0===c)return!n.ignoreBoundary;c&&(u=!0)}return u},Jv=new cp,$v=new cp,em={point:hp,lineStart:hp,lineEnd:hp,polygonStart:function(){Jv=new cp,em.lineStart=tm,em.lineEnd=nm},polygonEnd:function(){var e=+Jv;$v.add(e<0?Pf+e:e),this.lineStart=this.lineEnd=this.point=hp},sphere:function(){$v.add(Pf)}};function tm(){em.point=rm}function nm(){im(Dv,Ov)}function rm(e,t){em.point=im,Dv=e,Ov=t,Uv=e*=If,Bv=Uf(t=(t*=If)/2+Rf),Fv=qf(t)}function im(e,t){var n=(e*=If)-Uv,r=n>=0?1:-1,i=r*n,a=Uf(t=(t*=If)/2+Rf),o=qf(t),s=Fv*o,u=Bv*a+s*Uf(i),l=s*r*qf(i);Jv.add(Of(l,u)),Uv=e,Bv=a,Fv=o}function am(e){return[Of(e[1],e[0]),Wf(e[2])]}function om(e){var t=e[0],n=e[1],r=Uf(n);return[r*Uf(t),r*qf(t),qf(n)]}function sm(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function um(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function lm(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function cm(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function hm(e){var t=Gf(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var fm={point:dm,lineStart:Am,lineEnd:vm,polygonStart:function(){fm.point=mm,fm.lineStart=gm,fm.lineEnd=ym,Qv=new cp,em.polygonStart()},polygonEnd:function(){em.polygonEnd(),fm.point=dm,fm.lineStart=Am,fm.lineEnd=vm,Jv<0?(zv=-(qv=180),Vv=-(jv=90)):Qv>Ef?jv=90:Qv<-Ef&&(Vv=-90),Kv[0]=zv,Kv[1]=qv},sphere:function(){zv=-(qv=180),Vv=-(jv=90)}};function dm(e,t){Yv.push(Kv=[zv=e,qv=e]),t<Vv&&(Vv=t),t>jv&&(jv=t)}function pm(e,t){var n=om([e*If,t*If]);if(Xv){var r=um(Xv,n),i=um([r[1],-r[0],0],r);hm(i),i=am(i);var a,o=e-Gv,s=o>0?1:-1,u=i[0]*Nf*s,l=Lf(o)>180;l^(s*Gv<u&&u<s*e)?(a=i[1]*Nf)>jv&&(jv=a):l^(s*Gv<(u=(u+360)%360-180)&&u<s*e)?(a=-i[1]*Nf)<Vv&&(Vv=a):(t<Vv&&(Vv=t),t>jv&&(jv=t)),l?e<Gv?_m(zv,e)>_m(zv,qv)&&(qv=e):_m(e,qv)>_m(zv,qv)&&(zv=e):qv>=zv?(e<zv&&(zv=e),e>qv&&(qv=e)):e>Gv?_m(zv,e)>_m(zv,qv)&&(qv=e):_m(e,qv)>_m(zv,qv)&&(zv=e)}else Yv.push(Kv=[zv=e,qv=e]);t<Vv&&(Vv=t),t>jv&&(jv=t),Xv=n,Gv=e}function Am(){fm.point=pm}function vm(){Kv[0]=zv,Kv[1]=qv,fm.point=dm,Xv=null}function mm(e,t){if(Xv){var n=e-Gv;Qv.add(Lf(n)>180?n+(n>0?360:-360):n)}else Hv=e,Wv=t;em.point(e,t),pm(e,t)}function gm(){em.lineStart()}function ym(){mm(Hv,Wv),em.lineEnd(),Lf(Qv)>Ef&&(zv=-(qv=180)),Kv[0]=zv,Kv[1]=qv,Xv=null}function _m(e,t){return(t-=e)<0?t+360:t}function bm(e,t){return e[0]-t[0]}function xm(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function wm(e){var t,n,r,i,a,o,s;if(jv=qv=-(zv=Vv=1/0),Yv=[],bp(e,fm),n=Yv.length){for(Yv.sort(bm),t=1,a=[r=Yv[0]];t<n;++t)xm(r,(i=Yv[t])[0])||xm(r,i[1])?(_m(r[0],i[1])>_m(r[0],r[1])&&(r[1]=i[1]),_m(i[0],r[1])>_m(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,t=0,r=a[n=a.length-1];t<=n;r=i,++t)i=a[t],(s=_m(r[1],i[0]))>o&&(o=s,zv=i[0],qv=r[1])}return Yv=Kv=null,zv===1/0||Vv===1/0?[[NaN,NaN],[NaN,NaN]]:[[zv,Vv],[qv,jv]]}function Tm(e){return Lf(e[0])<=Mf?e[0]:jf(e[0])*((Lf(e[0])+Mf)%Pf-Mf)}function Sm(e,t){var n=Tm(t),r=t[1],i=qf(r),a=[qf(n),-Uf(n),0],o=0,s=0,u=new cp;1===i?r=Cf+Ef:-1===i&&(r=-Cf-Ef);for(var l=0,c=e.length;l<c;++l)if(f=(h=e[l]).length)for(var h,f,d=h[f-1],p=Tm(d),A=d[1]/2+Rf,v=qf(A),m=Uf(A),g=0;g<f;++g,p=_,v=x,m=w,d=y){var y=h[g],_=Tm(y),b=y[1]/2+Rf,x=qf(b),w=Uf(b),T=_-p,S=T>=0?1:-1,E=S*T,k=E>Mf,M=v*x;if(u.add(Of(M*S*qf(E),m*w+M*Uf(E))),o+=k?T+S*Pf:T,k^p>=n^_>=n){var C=um(om(d),om(y));hm(C);var R=um(a,C);hm(R);var P=(k^T>=0?-1:1)*Wf(R[2]);(r>P||r===P&&(C[0]||C[1]))&&(s+=k^T>=0?1:-1)}}return(o<-Ef||o<Ef&&u<-1e-12)^1&s}var Em,km,Mm,Cm,Rm,Pm,Nm,Im,Lm,Dm,Om,Um,Bm,Fm,zm,Vm,qm={Feature:function(e,t){return Gm(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)if(Gm(n[r].geometry,t))return!0;return!1}},jm={Sphere:function(){return!0},Point:function(e,t){return Hm(e.coordinates,t)},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)if(Hm(n[r],t))return!0;return!1},LineString:function(e,t){return Wm(e.coordinates,t)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)if(Wm(n[r],t))return!0;return!1},Polygon:function(e,t){return Xm(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)if(Xm(n[r],t))return!0;return!1},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)if(Gm(n[r],t))return!0;return!1}};function Gm(e,t){return!(!e||!jm.hasOwnProperty(e.type))&&jm[e.type](e,t)}function Hm(e,t){return 0===Mp(e,t)}function Wm(e,t){for(var n,r,i,a=0,o=e.length;a<o;a++){if(0===(r=Mp(e[a],t)))return!0;if(a>0&&(i=Mp(e[a],e[a-1]))>0&&n<=i&&r<=i&&(n+r-i)*(1-Math.pow((n-r)/i,2))<kf*i)return!0;n=r}return!1}function Xm(e,t){return!!Sm(e.map(Qm),Ym(t))}function Qm(e){return(e=e.map(Ym)).pop(),e}function Ym(e){return[e[0]*If,e[1]*If]}function Km(e,t){return(e&&qm.hasOwnProperty(e.type)?qm[e.type]:Gm)(e,t)}var Zm={sphere:hp,point:Jm,lineStart:eg,lineEnd:rg,polygonStart:function(){Zm.lineStart=ig,Zm.lineEnd=ag},polygonEnd:function(){Zm.lineStart=eg,Zm.lineEnd=rg}};function Jm(e,t){e*=If;var n=Uf(t*=If);$m(n*Uf(e),n*qf(e),qf(t))}function $m(e,t,n){++Em,Mm+=(e-Mm)/Em,Cm+=(t-Cm)/Em,Rm+=(n-Rm)/Em}function eg(){Zm.point=tg}function tg(e,t){e*=If;var n=Uf(t*=If);Fm=n*Uf(e),zm=n*qf(e),Vm=qf(t),Zm.point=ng,$m(Fm,zm,Vm)}function ng(e,t){e*=If;var n=Uf(t*=If),r=n*Uf(e),i=n*qf(e),a=qf(t),o=Of(Gf((o=zm*a-Vm*i)*o+(o=Vm*r-Fm*a)*o+(o=Fm*i-zm*r)*o),Fm*r+zm*i+Vm*a);km+=o,Pm+=o*(Fm+(Fm=r)),Nm+=o*(zm+(zm=i)),Im+=o*(Vm+(Vm=a)),$m(Fm,zm,Vm)}function rg(){Zm.point=Jm}function ig(){Zm.point=og}function ag(){sg(Um,Bm),Zm.point=Jm}function og(e,t){Um=e,Bm=t,e*=If,t*=If,Zm.point=sg;var n=Uf(t);Fm=n*Uf(e),zm=n*qf(e),Vm=qf(t),$m(Fm,zm,Vm)}function sg(e,t){e*=If;var n=Uf(t*=If),r=n*Uf(e),i=n*qf(e),a=qf(t),o=zm*a-Vm*i,s=Vm*r-Fm*a,u=Fm*i-zm*r,l=zf(o,s,u),c=Wf(l),h=l&&-c/l;Lm.add(h*o),Dm.add(h*s),Om.add(h*u),km+=c,Pm+=c*(Fm+(Fm=r)),Nm+=c*(zm+(zm=i)),Im+=c*(Vm+(Vm=a)),$m(Fm,zm,Vm)}function ug(e){Em=km=Mm=Cm=Rm=Pm=Nm=Im=0,Lm=new cp,Dm=new cp,Om=new cp,bp(e,Zm);var t=+Lm,n=+Dm,r=+Om,i=zf(t,n,r);return i<kf&&(t=Pm,n=Nm,r=Im,km<Ef&&(t=Mm,n=Cm,r=Rm),(i=zf(t,n,r))<kf)?[NaN,NaN]:[Of(n,t)*Nf,Wf(r/i)*Nf]}var lg=1e-6,cg=function(){function e(){c(this,e),this._x0=this._y0=this._x1=this._y1=null,this._=""}return p(e,[{key:"moveTo",value:function(e,t){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t)}},{key:"closePath",value:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}},{key:"lineTo",value:function(e,t){this._+="L".concat(this._x1=+e,",").concat(this._y1=+t)}},{key:"arc",value:function(e,t,n){var r=(e=+e)+(n=+n),i=t=+t;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(i):(Math.abs(this._x1-r)>lg||Math.abs(this._y1-i)>lg)&&(this._+="L"+r+","+i),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(e-n,",").concat(t,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=i))}},{key:"rect",value:function(e,t,n,r){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")}},{key:"value",value:function(){return this._||null}}]),e}(),hg=function(){function e(){c(this,e),this._=[]}return p(e,[{key:"moveTo",value:function(e,t){this._.push([e,t])}},{key:"closePath",value:function(){this._.push(this._[0].slice())}},{key:"lineTo",value:function(e,t){this._.push([e,t])}},{key:"value",value:function(){return this._.length?this._:null}}]),e}(),fg=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500],r=T(n,4),i=r[0],a=r[1],o=r[2],s=r[3];if(c(this,e),!((o=+o)>=(i=+i))||!((s=+s)>=(a=+a)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=o,this.xmin=i,this.ymax=s,this.ymin=a,this._init()}return p(e,[{key:"update",value:function(){return this.delaunay.update(),this._init(),this}},{key:"_init",value:function(){for(var e,t,n,r,i=this.delaunay,a=i.points,o=i.hull,s=i.triangles,u=this.vectors,l=this.circumcenters=this._circumcenters.subarray(0,s.length/3*2),c=0,h=0,f=s.length;c<f;c+=3,h+=2){var d=2*s[c],p=2*s[c+1],A=2*s[c+2],v=a[d],m=a[d+1],g=a[p],y=a[p+1],_=a[A],b=a[A+1],x=g-v,w=y-m,T=_-v,S=b-m,E=2*(x*S-w*T);if(Math.abs(E)<1e-9){if(void 0===e){e=t=0;var M,C=k(o);try{for(C.s();!(M=C.n()).done;){var R=M.value;e+=a[2*R],t+=a[2*R+1]}}catch(j){C.e(j)}finally{C.f()}e/=o.length,t/=o.length}var P=1e9*Math.sign((e-v)*S-(t-m)*T);n=(v+_)/2-P*S,r=(m+b)/2+P*T}else{var N=1/E,I=x*x+w*w,L=T*T+S*S;n=v+(S*I-w*L)*N,r=m+(x*L-T*I)*N}l[h]=n,l[h+1]=r}var D,O,U,B=o[o.length-1],F=4*B,z=a[2*B],V=a[2*B+1];u.fill(0);for(var q=0;q<o.length;++q)D=F,O=z,U=V,F=4*(B=o[q]),z=a[2*B],V=a[2*B+1],u[D+2]=u[F]=U-V,u[D+3]=u[F+1]=z-O}},{key:"render",value:function(e){var t=null==e?e=new cg:void 0,n=this.delaunay,r=n.halfedges,i=n.inedges,a=n.hull,o=this.circumcenters,s=this.vectors;if(a.length<=1)return null;for(var u=0,l=r.length;u<l;++u){var c=r[u];if(!(c<u)){var h=2*Math.floor(u/3),f=2*Math.floor(c/3),d=o[h],p=o[h+1],A=o[f],v=o[f+1];this._renderSegment(d,p,A,v,e)}}for(var m,g=a[a.length-1],y=0;y<a.length;++y){m=g,g=a[y];var _=2*Math.floor(i[g]/3),b=o[_],x=o[_+1],w=4*m,T=this._project(b,x,s[w+2],s[w+3]);T&&this._renderSegment(b,x,T[0],T[1],e)}return t&&t.value()}},{key:"renderBounds",value:function(e){var t=null==e?e=new cg:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}},{key:"renderCell",value:function(e,t){var n=null==t?t=new cg:void 0,r=this._clip(e);if(null!==r&&r.length){t.moveTo(r[0],r[1]);for(var i=r.length;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(var a=2;a<i;a+=2)r[a]===r[a-2]&&r[a+1]===r[a-1]||t.lineTo(r[a],r[a+1]);return t.closePath(),n&&n.value()}}},{key:"cellPolygons",value:ft().mark((function e(){var t,n,r,i;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.delaunay.points,n=0,r=t.length/2;case 2:if(!(n<r)){e.next=11;break}if(!(i=this.cellPolygon(n))){e.next=8;break}return i.index=n,e.next=8,i;case 8:++n,e.next=2;break;case 11:case"end":return e.stop()}}),e,this)}))},{key:"cellPolygon",value:function(e){var t=new hg;return this.renderCell(e,t),t.value()}},{key:"_renderSegment",value:function(e,t,n,r,i){var a,o=this._regioncode(e,t),s=this._regioncode(n,r);0===o&&0===s?(i.moveTo(e,t),i.lineTo(n,r)):(a=this._clipSegment(e,t,n,r,o,s))&&(i.moveTo(a[0],a[1]),i.lineTo(a[2],a[3]))}},{key:"contains",value:function(e,t,n){return(t=+t)===t&&(n=+n)===n&&this.delaunay._step(e,t,n)===e}},{key:"neighbors",value:ft().mark((function e(t){var n,r,i,a,o,s,u,l,c;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this._clip(t))){e.next=33;break}r=k(this.delaunay.neighbors(t)),e.prev=3,r.s();case 5:if((i=r.n()).done){e.next=25;break}if(a=i.value,!(o=this._clip(a))){e.next=23;break}s=0,u=n.length;case 10:if(!(s<u)){e.next=23;break}l=0,c=o.length;case 12:if(!(l<c)){e.next=20;break}if(n[s]!==o[l]||n[s+1]!==o[l+1]||n[(s+2)%u]!==o[(l+c-2)%c]||n[(s+3)%u]!==o[(l+c-1)%c]){e.next=17;break}return e.next=16,a;case 16:return e.abrupt("break",23);case 17:l+=2,e.next=12;break;case 20:s+=2,e.next=10;break;case 23:e.next=5;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(3),r.e(e.t0);case 30:return e.prev=30,r.f(),e.finish(30);case 33:case"end":return e.stop()}}),e,this,[[3,27,30,33]])}))},{key:"_cell",value:function(e){var t=this.circumcenters,n=this.delaunay,r=n.inedges,i=n.halfedges,a=n.triangles,o=r[e];if(-1===o)return null;var s=[],u=o;do{var l=Math.floor(u/3);if(s.push(t[2*l],t[2*l+1]),a[u=u%3===2?u-2:u+1]!==e)break;u=i[u]}while(u!==o&&-1!==u);return s}},{key:"_clip",value:function(e){if(0===e&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];var t=this._cell(e);if(null===t)return null;var n=this.vectors,r=4*e;return this._simplify(n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t))}},{key:"_clipFinite",value:function(e,t){for(var n,r,i,a,o=t.length,s=null,u=t[o-2],l=t[o-1],c=this._regioncode(u,l),h=0,f=0;f<o;f+=2)if(n=u,r=l,u=t[f],l=t[f+1],i=c,c=this._regioncode(u,l),0===i&&0===c)a=h,h=0,s?s.push(u,l):s=[u,l];else{var d=void 0,p=void 0,A=void 0,v=void 0,m=void 0;if(0===i){if(null===(d=this._clipSegment(n,r,u,l,i,c)))continue;var g=T(d,4);p=g[0],A=g[1],v=g[2],m=g[3]}else{if(null===(d=this._clipSegment(u,l,n,r,c,i)))continue;var y=T(d,4);v=y[0],m=y[1],p=y[2],A=y[3],a=h,h=this._edgecode(p,A),a&&h&&this._edge(e,a,h,s,s.length),s?s.push(p,A):s=[p,A]}a=h,h=this._edgecode(v,m),a&&h&&this._edge(e,a,h,s,s.length),s?s.push(v,m):s=[v,m]}if(s)a=h,h=this._edgecode(s[0],s[1]),a&&h&&this._edge(e,a,h,s,s.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}},{key:"_clipSegment",value:function(e,t,n,r,i,a){var o=i<a;if(o){var s=[n,r,e,t,a,i];e=s[0],t=s[1],n=s[2],r=s[3],i=s[4],a=s[5]}for(;;){if(0===i&&0===a)return o?[n,r,e,t]:[e,t,n,r];if(i&a)return null;var u=void 0,l=void 0,c=i||a;8&c?(u=e+(n-e)*(this.ymax-t)/(r-t),l=this.ymax):4&c?(u=e+(n-e)*(this.ymin-t)/(r-t),l=this.ymin):2&c?(l=t+(r-t)*(this.xmax-e)/(n-e),u=this.xmax):(l=t+(r-t)*(this.xmin-e)/(n-e),u=this.xmin),i?(e=u,t=l,i=this._regioncode(e,t)):(n=u,r=l,a=this._regioncode(n,r))}}},{key:"_clipInfinite",value:function(e,t,n,r,i,a){var o,s=Array.from(t);if((o=this._project(s[0],s[1],n,r))&&s.unshift(o[0],o[1]),(o=this._project(s[s.length-2],s[s.length-1],i,a))&&s.push(o[0],o[1]),s=this._clipFinite(e,s))for(var u,l=0,c=s.length,h=this._edgecode(s[c-2],s[c-1]);l<c;l+=2)u=h,h=this._edgecode(s[l],s[l+1]),u&&h&&(l=this._edge(e,u,h,s,l),c=s.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}},{key:"_edge",value:function(e,t,n,r,i){for(;t!==n;){var a=void 0,o=void 0;switch(t){case 5:t=4;continue;case 4:t=6,a=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,a=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,a=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,a=this.xmin,o=this.ymin}r[i]===a&&r[i+1]===o||!this.contains(e,a,o)||(r.splice(i,0,a,o),i+=2)}return i}},{key:"_project",value:function(e,t,n,r){var i,a,o,s=1/0;if(r<0){if(t<=this.ymin)return null;(i=(this.ymin-t)/r)<s&&(o=this.ymin,a=e+(s=i)*n)}else if(r>0){if(t>=this.ymax)return null;(i=(this.ymax-t)/r)<s&&(o=this.ymax,a=e+(s=i)*n)}if(n>0){if(e>=this.xmax)return null;(i=(this.xmax-e)/n)<s&&(a=this.xmax,o=t+(s=i)*r)}else if(n<0){if(e<=this.xmin)return null;(i=(this.xmin-e)/n)<s&&(a=this.xmin,o=t+(s=i)*r)}return[a,o]}},{key:"_edgecode",value:function(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}},{key:"_regioncode",value:function(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}},{key:"_simplify",value:function(e){if(e&&e.length>4){for(var t=0;t<e.length;t+=2){var n=(t+2)%e.length,r=(t+4)%e.length;(e[t]===e[n]&&e[n]===e[r]||e[t+1]===e[n+1]&&e[n+1]===e[r+1])&&(e.splice(n,2),t-=2)}e.length||(e=null)}return e}}]),e}(),dg=ft().mark(bg),pg=2*Math.PI,Ag=Math.pow;function vg(e){return e[0]}function mg(e){return e[1]}function gg(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}var yg=function(){function e(t){c(this,e),this._delaunator=new wv(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}return p(e,[{key:"update",value:function(){return this._delaunator.update(),this._init(),this}},{key:"_init",value:function(){var e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&function(e){for(var t=e.triangles,n=e.coords,r=0;r<t.length;r+=3){var i=2*t[r],a=2*t[r+1],o=2*t[r+2];if((n[o]-n[i])*(n[a+1]-n[i+1])-(n[a]-n[i])*(n[o+1]-n[i+1])>1e-10)return!1}return!0}(e)){this.collinear=Int32Array.from({length:t.length/2},(function(e,t){return t})).sort((function(e,n){return t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]}));for(var n=this.collinear[0],r=this.collinear[this.collinear.length-1],i=[t[2*n],t[2*n+1],t[2*r],t[2*r+1]],a=1e-8*Math.hypot(i[3]-i[1],i[2]-i[0]),o=0,s=t.length/2;o<s;++o){var u=gg(t[2*o],t[2*o+1],a);t[2*o]=u[0],t[2*o+1]=u[1]}this._delaunator=new wv(t)}else delete this.collinear;for(var l=this.halfedges=this._delaunator.halfedges,c=this.hull=this._delaunator.hull,h=this.triangles=this._delaunator.triangles,f=this.inedges.fill(-1),d=this._hullIndex.fill(-1),p=0,A=l.length;p<A;++p){var v=h[p%3===2?p-2:p+1];-1!==l[p]&&-1!==f[v]||(f[v]=p)}for(var m=0,g=c.length;m<g;++m)d[c[m]]=m;c.length<=2&&c.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=c[0],f[c[0]]=1,2===c.length&&(f[c[1]]=0,this.triangles[1]=c[1],this.triangles[2]=c[1]))}},{key:"voronoi",value:function(e){return new fg(this,e)}},{key:"neighbors",value:ft().mark((function e(t){var n,r,i,a,o,s,u,l,c,h,f;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.inedges,r=this.hull,i=this._hullIndex,a=this.halfedges,o=this.triangles,!(s=this.collinear)){e.next=10;break}if(!((u=s.indexOf(t))>0)){e.next=6;break}return e.next=6,s[u-1];case 6:if(!(u<s.length-1)){e.next=9;break}return e.next=9,s[u+1];case 9:return e.abrupt("return");case 10:if(-1!==(l=n[t])){e.next=13;break}return e.abrupt("return");case 13:c=l,h=-1;case 14:return e.next=16,h=o[c];case 16:if(o[c=c%3===2?c-2:c+1]===t){e.next=19;break}return e.abrupt("return");case 19:if(-1!==(c=a[c])){e.next=26;break}if((f=r[(i[t]+1)%r.length])===h){e.next=25;break}return e.next=25,f;case 25:return e.abrupt("return");case 26:if(c!==l){e.next=14;break}case 27:case"end":return e.stop()}}),e,this)}))},{key:"find",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((e=+e)!==e||(t=+t)!==t)return-1;for(var r,i=n;(r=this._step(n,e,t))>=0&&r!==n&&r!==i;)n=r;return r}},{key:"_step",value:function(e,t,n){var r=this.inedges,i=this.hull,a=this._hullIndex,o=this.halfedges,s=this.triangles,u=this.points;if(-1===r[e]||!u.length)return(e+1)%(u.length>>1);var l=e,c=Ag(t-u[2*e],2)+Ag(n-u[2*e+1],2),h=r[e],f=h;do{var d=s[f],p=Ag(t-u[2*d],2)+Ag(n-u[2*d+1],2);if(p<c&&(c=p,l=d),s[f=f%3===2?f-2:f+1]!==e)break;if(-1===(f=o[f])){if((f=i[(a[e]+1)%i.length])!==d&&Ag(t-u[2*f],2)+Ag(n-u[2*f+1],2)<c)return f;break}}while(f!==h);return l}},{key:"render",value:function(e){for(var t=null==e?e=new cg:void 0,n=this.points,r=this.halfedges,i=this.triangles,a=0,o=r.length;a<o;++a){var s=r[a];if(!(s<a)){var u=2*i[a],l=2*i[s];e.moveTo(n[u],n[u+1]),e.lineTo(n[l],n[l+1])}}return this.renderHull(e),t&&t.value()}},{key:"renderPoints",value:function(e,t){void 0!==t||e&&"function"===typeof e.moveTo||(t=e,e=null),t=void 0==t?2:+t;for(var n=null==e?e=new cg:void 0,r=this.points,i=0,a=r.length;i<a;i+=2){var o=r[i],s=r[i+1];e.moveTo(o+t,s),e.arc(o,s,t,0,pg)}return n&&n.value()}},{key:"renderHull",value:function(e){var t=null==e?e=new cg:void 0,n=this.hull,r=this.points,i=2*n[0],a=n.length;e.moveTo(r[i],r[i+1]);for(var o=1;o<a;++o){var s=2*n[o];e.lineTo(r[s],r[s+1])}return e.closePath(),t&&t.value()}},{key:"hullPolygon",value:function(){var e=new hg;return this.renderHull(e),e.value()}},{key:"renderTriangle",value:function(e,t){var n=null==t?t=new cg:void 0,r=this.points,i=this.triangles,a=2*i[e*=3],o=2*i[e+1],s=2*i[e+2];return t.moveTo(r[a],r[a+1]),t.lineTo(r[o],r[o+1]),t.lineTo(r[s],r[s+1]),t.closePath(),n&&n.value()}},{key:"trianglePolygons",value:ft().mark((function e(){var t,n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.triangles,n=0,r=t.length/3;case 2:if(!(n<r)){e.next=8;break}return e.next=5,this.trianglePolygon(n);case 5:++n,e.next=2;break;case 8:case"end":return e.stop()}}),e,this)}))},{key:"trianglePolygon",value:function(e){var t=new hg;return this.renderTriangle(e,t),t.value()}}],[{key:"from",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vg,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:mg,i=arguments.length>3?arguments[3]:void 0;return new e("length"in t?_g(t,n,r,i):Float64Array.from(bg(t,n,r,i)))}}]),e}();function _g(e,t,n,r){for(var i=e.length,a=new Float64Array(2*i),o=0;o<i;++o){var s=e[o];a[2*o]=t.call(r,s,o,e),a[2*o+1]=n.call(r,s,o,e)}return a}function bg(e,t,n,r){var i,a,o,s;return ft().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:i=0,a=k(e),u.prev=2,a.s();case 4:if((o=a.n()).done){u.next=13;break}return s=o.value,u.next=8,t.call(r,s,i,e);case 8:return u.next=10,n.call(r,s,i,e);case 10:++i;case 11:u.next=4;break;case 13:u.next=18;break;case 15:u.prev=15,u.t0=u.catch(2),a.e(u.t0);case 18:return u.prev=18,a.f(),u.finish(18);case 21:case"end":return u.stop()}}),dg,null,[[2,15,18,21]])}function xg(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n}function wg(e,t){return Lf(e)>Mf&&(e-=Math.round(e/Pf)*Pf),[e,t]}function Tg(e,t,n){return(e%=Pf)?t||n?xg(Eg(e),kg(t,n)):Eg(e):t||n?kg(t,n):wg}function Sg(e){return function(t,n){return Lf(t+=e)>Mf&&(t-=Math.round(t/Pf)*Pf),[t,n]}}function Eg(e){var t=Sg(e);return t.invert=Sg(-e),t}function kg(e,t){var n=Uf(e),r=qf(e),i=Uf(t),a=qf(t);function o(e,t){var o=Uf(t),s=Uf(e)*o,u=qf(e)*o,l=qf(t),c=l*n+s*r;return[Of(u*i-c*a,s*n-l*r),Wf(c*i+u*a)]}return o.invert=function(e,t){var o=Uf(t),s=Uf(e)*o,u=qf(e)*o,l=qf(t),c=l*i-u*a;return[Of(u*i+l*a,s*n+c*r),Wf(c*n-s*r)]},o}function Mg(){var e,t=[];return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){t.push(e=[])},lineEnd:hp,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function Cg(e,t){return Lf(e[0]-t[0])<Ef&&Lf(e[1]-t[1])<Ef}function Rg(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Pg(e,t,n,r,i){var a,o,s=[],u=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,r=e[0],o=e[t];if(Cg(r,o)){if(!r[2]&&!o[2]){for(i.lineStart(),a=0;a<t;++a)i.point((r=e[a])[0],r[1]);return void i.lineEnd()}o[0]+=2e-6}s.push(n=new Rg(r,e,null,!0)),u.push(n.o=new Rg(r,null,n,!1)),s.push(n=new Rg(o,e,null,!1)),u.push(n.o=new Rg(o,null,n,!0))}})),s.length){for(u.sort(t),Ng(s),Ng(u),a=0,o=u.length;a<o;++a)u[a].e=n=!n;for(var l,c,h=s[0];;){for(var f=h,d=!0;f.v;)if((f=f.n)===h)return;l=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(a=0,o=l.length;a<o;++a)i.point((c=l[a])[0],c[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(d)for(l=f.p.z,a=l.length-1;a>=0;--a)i.point((c=l[a])[0],c[1]);else r(f.x,f.p.x,-1,i);f=f.p}l=(f=f.o).z,d=!d}while(!f.v);i.lineEnd()}}}function Ng(e){if(t=e.length){for(var t,n,r=0,i=e[0];++r<t;)i.n=n=e[r],n.p=i,i=n;i.n=n=e[0],n.p=i}}function Ig(e,t,n,r){return function(i){var a,o,s,u=t(i),l=Mg(),c=t(l),h=!1,f={point:d,lineStart:A,lineEnd:v,polygonStart:function(){f.point=m,f.lineStart=g,f.lineEnd=y,o=[],a=[]},polygonEnd:function(){f.point=d,f.lineStart=A,f.lineEnd=v,o=lv(o);var e=Sm(a,r);o.length?(h||(i.polygonStart(),h=!0),Pg(o,Dg,e,n,i)):e&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),o=a=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(t,n){e(t,n)&&i.point(t,n)}function p(e,t){u.point(e,t)}function A(){f.point=p,u.lineStart()}function v(){f.point=d,u.lineEnd()}function m(e,t){s.push([e,t]),c.point(e,t)}function g(){c.lineStart(),s=[]}function y(){m(s[0][0],s[0][1]),c.lineEnd();var e,t,n,r,u=c.clean(),f=l.result(),d=f.length;if(s.pop(),a.push(s),s=null,d)if(1&u){if((t=(n=f[0]).length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),e=0;e<t;++e)i.point((r=n[e])[0],r[1]);i.lineEnd()}}else d>1&&2&u&&f.push(f.pop().concat(f.shift())),o.push(f.filter(Lg))}return f}}function Lg(e){return e.length>1}function Dg(e,t){return((e=e.x)[0]<0?e[1]-Cf-Ef:Cf-e[1])-((t=t.x)[0]<0?t[1]-Cf-Ef:Cf-t[1])}wg.invert=wg;var Og=Ig((function(){return!0}),(function(e){var t,n=NaN,r=NaN,i=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(a,o){var s=a>0?Mf:-Mf,u=Lf(a-n);Lf(u-Mf)<Ef?(e.point(n,r=(r+o)/2>0?Cf:-Cf),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),e.point(a,r),t=0):i!==s&&u>=Mf&&(Lf(n-i)<Ef&&(n-=i*Ef),Lf(a-s)<Ef&&(a-=s*Ef),r=function(e,t,n,r){var i,a,o=qf(e-n);return Lf(o)>Ef?Df((qf(t)*(a=Uf(r))*qf(n)-qf(r)*(i=Uf(t))*qf(e))/(i*a*o)):(t+r)/2}(n,r,a,o),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),t=0),e.point(n=a,r=o),i=s},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}),(function(e,t,n,r){var i;if(null==e)i=n*Cf,r.point(-Mf,i),r.point(0,i),r.point(Mf,i),r.point(Mf,0),r.point(Mf,-i),r.point(0,-i),r.point(-Mf,-i),r.point(-Mf,0),r.point(-Mf,i);else if(Lf(e[0]-t[0])>Ef){var a=e[0]<t[0]?Mf:-Mf;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(t[0],t[1])}),[-Mf,-Cf]);function Ug(e,t,n,r,i,a){if(n){var o=Uf(t),s=qf(t),u=r*n;null==i?(i=t+r*Pf,a=t-u/2):(i=Bg(o,i),a=Bg(o,a),(r>0?i<a:i>a)&&(i+=r*Pf));for(var l,c=i;r>0?c>a:c<a;c-=u)l=am([o,-s*Uf(c),-s*qf(c)]),e.point(l[0],l[1])}}function Bg(e,t){(t=om(t))[0]-=e,hm(t);var n=function(e){return e>1?0:e<-1?Mf:Math.acos(e)}(-t[1]);return((-t[2]<0?-n:n)+Pf-Ef)%Pf}function Fg(e){var t=Uf(e),n=2*If,r=t>0,i=Lf(t)>Ef;function a(e,n){return Uf(e)*Uf(n)>t}function o(e,n,r){var i=[1,0,0],a=um(om(e),om(n)),o=sm(a,a),s=a[0],u=o-s*s;if(!u)return!r&&e;var l=t*o/u,c=-t*s/u,h=um(i,a),f=cm(i,l);lm(f,cm(a,c));var d=h,p=sm(f,d),A=sm(d,d),v=p*p-A*(sm(f,f)-1);if(!(v<0)){var m=Gf(v),g=cm(d,(-p-m)/A);if(lm(g,f),g=am(g),!r)return g;var y,_=e[0],b=n[0],x=e[1],w=n[1];b<_&&(y=_,_=b,b=y);var T=b-_,S=Lf(T-Mf)<Ef;if(!S&&w<x&&(y=x,x=w,w=y),S||T<Ef?S?x+w>0^g[1]<(Lf(g[0]-_)<Ef?x:w):x<=g[1]&&g[1]<=w:T>Mf^(_<=g[0]&&g[0]<=b)){var E=cm(d,(-p+m)/A);return lm(E,f),[g,am(E)]}}}function s(t,n){var i=r?e:Mf-e,a=0;return t<-i?a|=1:t>i&&(a|=2),n<-i?a|=4:n>i&&(a|=8),a}return Ig(a,(function(e){var t,n,u,l,c;return{lineStart:function(){l=u=!1,c=1},point:function(h,f){var d,p=[h,f],A=a(h,f),v=r?A?0:s(h,f):A?s(h+(h<0?Mf:-Mf),f):0;if(!t&&(l=u=A)&&e.lineStart(),A!==u&&(!(d=o(t,p))||Cg(t,d)||Cg(p,d))&&(p[2]=1),A!==u)c=0,A?(e.lineStart(),d=o(p,t),e.point(d[0],d[1])):(d=o(t,p),e.point(d[0],d[1],2),e.lineEnd()),t=d;else if(i&&t&&r^A){var m;v&n||!(m=o(p,t,!0))||(c=0,r?(e.lineStart(),e.point(m[0][0],m[0][1]),e.point(m[1][0],m[1][1]),e.lineEnd()):(e.point(m[1][0],m[1][1]),e.lineEnd(),e.lineStart(),e.point(m[0][0],m[0][1],3)))}!A||t&&Cg(t,p)||e.point(p[0],p[1]),t=p,u=A,n=v},lineEnd:function(){u&&e.lineEnd(),t=null},clean:function(){return c|(l&&u)<<1}}}),(function(t,r,i,a){Ug(a,e,n,i,t,r)}),r?[0,-e]:[-Mf,e-Mf])}var zg=1e9,Vg=-zg;function qg(e,t,n,r){function i(i,a){return e<=i&&i<=n&&t<=a&&a<=r}function a(i,a,s,l){var c=0,h=0;if(null==i||(c=o(i,s))!==(h=o(a,s))||u(i,a)<0^s>0)do{l.point(0===c||3===c?e:n,c>1?r:t)}while((c=(c+s+4)%4)!==h);else l.point(a[0],a[1])}function o(r,i){return Lf(r[0]-e)<Ef?i>0?0:3:Lf(r[0]-n)<Ef?i>0?2:1:Lf(r[1]-t)<Ef?i>0?1:0:i>0?3:2}function s(e,t){return u(e.x,t.x)}function u(e,t){var n=o(e,1),r=o(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(o){var u,l,c,h,f,d,p,A,v,m,g,y=o,_=Mg(),b={point:x,lineStart:function(){b.point=w,l&&l.push(c=[]);m=!0,v=!1,p=A=NaN},lineEnd:function(){u&&(w(h,f),d&&v&&_.rejoin(),u.push(_.result()));b.point=x,v&&y.lineEnd()},polygonStart:function(){y=_,u=[],l=[],g=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,i=l.length;n<i;++n)for(var a,o,s=l[n],u=1,c=s.length,h=s[0],f=h[0],d=h[1];u<c;++u)a=f,o=d,f=(h=s[u])[0],d=h[1],o<=r?d>r&&(f-a)*(r-o)>(d-o)*(e-a)&&++t:d<=r&&(f-a)*(r-o)<(d-o)*(e-a)&&--t;return t}(),n=g&&t,i=(u=lv(u)).length;(n||i)&&(o.polygonStart(),n&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),i&&Pg(u,s,t,a,o),o.polygonEnd());y=o,u=l=c=null}};function x(e,t){i(e,t)&&y.point(e,t)}function w(a,o){var s=i(a,o);if(l&&c.push([a,o]),m)h=a,f=o,d=s,m=!1,s&&(y.lineStart(),y.point(a,o));else if(s&&v)y.point(a,o);else{var u=[p=Math.max(Vg,Math.min(zg,p)),A=Math.max(Vg,Math.min(zg,A))],_=[a=Math.max(Vg,Math.min(zg,a)),o=Math.max(Vg,Math.min(zg,o))];!function(e,t,n,r,i,a){var o,s=e[0],u=e[1],l=0,c=1,h=t[0]-s,f=t[1]-u;if(o=n-s,h||!(o>0)){if(o/=h,h<0){if(o<l)return;o<c&&(c=o)}else if(h>0){if(o>c)return;o>l&&(l=o)}if(o=i-s,h||!(o<0)){if(o/=h,h<0){if(o>c)return;o>l&&(l=o)}else if(h>0){if(o<l)return;o<c&&(c=o)}if(o=r-u,f||!(o>0)){if(o/=f,f<0){if(o<l)return;o<c&&(c=o)}else if(f>0){if(o>c)return;o>l&&(l=o)}if(o=a-u,f||!(o<0)){if(o/=f,f<0){if(o>c)return;o>l&&(l=o)}else if(f>0){if(o<l)return;o<c&&(c=o)}return l>0&&(e[0]=s+l*h,e[1]=u+l*f),c<1&&(t[0]=s+c*h,t[1]=u+c*f),!0}}}}}(u,_,e,t,n,r)?s&&(y.lineStart(),y.point(a,o),g=!1):(v||(y.lineStart(),y.point(u[0],u[1])),y.point(_[0],_[1]),s||y.lineEnd(),g=!1)}p=a,A=o,v=s}return b}}var jg=function(e){return e};function Gg(e){return function(t){var n=new Hg;for(var r in e)n[r]=e[r];return n.stream=t,n}}function Hg(){}Hg.prototype={constructor:Hg,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Wg=1/0,Xg=Wg,Qg=-Wg,Yg=Qg,Kg={point:function(e,t){e<Wg&&(Wg=e);e>Qg&&(Qg=e);t<Xg&&(Xg=t);t>Yg&&(Yg=t)},lineStart:hp,lineEnd:hp,polygonStart:hp,polygonEnd:hp,result:function(){var e=[[Wg,Xg],[Qg,Yg]];return Qg=Yg=-(Xg=Wg=1/0),e}};var Zg=Kg;function Jg(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),bp(n,e.stream(Zg)),t(Zg.result()),null!=r&&e.clipExtent(r),e}function $g(e,t,n){return Jg(e,(function(n){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],a=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),o=+t[0][0]+(r-a*(n[1][0]+n[0][0]))/2,s=+t[0][1]+(i-a*(n[1][1]+n[0][1]))/2;e.scale(150*a).translate([o,s])}),n)}var ey=Uf(30*If);function ty(e,t){return+t?function(e,t){function n(r,i,a,o,s,u,l,c,h,f,d,p,A,v){var m=l-r,g=c-i,y=m*m+g*g;if(y>4*t&&A--){var _=o+f,b=s+d,x=u+p,w=Gf(_*_+b*b+x*x),T=Wf(x/=w),S=Lf(Lf(x)-1)<Ef||Lf(a-h)<Ef?(a+h)/2:Of(b,_),E=e(S,T),k=E[0],M=E[1],C=k-r,R=M-i,P=g*C-m*R;(P*P/y>t||Lf((m*C+g*R)/y-.5)>.3||o*f+s*d+u*p<ey)&&(n(r,i,a,o,s,u,k,M,S,_/=w,b/=w,x,A,v),v.point(k,M),n(k,M,S,_,b,x,l,c,h,f,d,p,A,v))}}return function(t){var r,i,a,o,s,u,l,c,h,f,d,p,A={point:v,lineStart:m,lineEnd:y,polygonStart:function(){t.polygonStart(),A.lineStart=_},polygonEnd:function(){t.polygonEnd(),A.lineStart=m}};function v(n,r){n=e(n,r),t.point(n[0],n[1])}function m(){c=NaN,A.point=g,t.lineStart()}function g(r,i){var a=om([r,i]),o=e(r,i);n(c,h,l,f,d,p,c=o[0],h=o[1],l=r,f=a[0],d=a[1],p=a[2],16,t),t.point(c,h)}function y(){A.point=v,t.lineEnd()}function _(){m(),A.point=b,A.lineEnd=x}function b(e,t){g(r=e,t),i=c,a=h,o=f,s=d,u=p,A.point=g}function x(){n(c,h,l,f,d,p,i,a,r,o,s,u,16,t),A.lineEnd=y,y()}return A}}(e,t):function(e){return Gg({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)}var ny=Gg({point:function(e,t){this.stream.point(e*If,t*If)}});function ry(e,t,n,r,i,a){if(!a)return function(e,t,n,r,i){function a(a,o){return[t+e*(a*=r),n-e*(o*=i)]}return a.invert=function(a,o){return[(a-t)/e*r,(n-o)/e*i]},a}(e,t,n,r,i);var o=Uf(a),s=qf(a),u=o*e,l=s*e,c=o/e,h=s/e,f=(s*n-o*t)/e,d=(s*t+o*n)/e;function p(e,a){return[u*(e*=r)-l*(a*=i)+t,n-l*e-u*a]}return p.invert=function(e,t){return[r*(c*e-h*t+f),i*(d-h*e-c*t)]},p}function iy(e){return function(e){var t,n,r,i,a,o,s,u,l,c,h=150,f=480,d=250,p=0,A=0,v=0,m=0,g=0,y=0,_=1,b=1,x=null,w=Og,T=null,S=jg,E=.5;function k(e){return u(e[0]*If,e[1]*If)}function M(e){return(e=u.invert(e[0],e[1]))&&[e[0]*Nf,e[1]*Nf]}function C(){var e=ry(h,0,0,_,b,y).apply(null,t(p,A)),r=ry(h,f-e[0],d-e[1],_,b,y);return n=Tg(v,m,g),s=xg(t,r),u=xg(n,s),o=ty(s,E),R()}function R(){return l=c=null,k}return k.stream=function(e){return l&&c===e?l:l=ny(function(e){return Gg({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(n)(w(o(S(c=e)))))},k.preclip=function(e){return arguments.length?(w=e,x=void 0,R()):w},k.postclip=function(e){return arguments.length?(S=e,T=r=i=a=null,R()):S},k.clipAngle=function(e){return arguments.length?(w=+e?Fg(x=e*If):(x=null,Og),R()):x*Nf},k.clipExtent=function(e){return arguments.length?(S=null==e?(T=r=i=a=null,jg):qg(T=+e[0][0],r=+e[0][1],i=+e[1][0],a=+e[1][1]),R()):null==T?null:[[T,r],[i,a]]},k.scale=function(e){return arguments.length?(h=+e,C()):h},k.translate=function(e){return arguments.length?(f=+e[0],d=+e[1],C()):[f,d]},k.center=function(e){return arguments.length?(p=e[0]%360*If,A=e[1]%360*If,C()):[p*Nf,A*Nf]},k.rotate=function(e){return arguments.length?(v=e[0]%360*If,m=e[1]%360*If,g=e.length>2?e[2]%360*If:0,C()):[v*Nf,m*Nf,g*Nf]},k.angle=function(e){return arguments.length?(y=e%360*If,C()):y*Nf},k.reflectX=function(e){return arguments.length?(_=e?-1:1,C()):_<0},k.reflectY=function(e){return arguments.length?(b=e?-1:1,C()):b<0},k.precision=function(e){return arguments.length?(o=ty(s,E=e*e),R()):Gf(E)},k.fitExtent=function(e,t){return $g(k,e,t)},k.fitSize=function(e,t){return function(e,t,n){return $g(e,[[0,0],t],n)}(k,e,t)},k.fitWidth=function(e,t){return function(e,t,n){return Jg(e,(function(n){var r=+t,i=r/(n[1][0]-n[0][0]),a=(r-i*(n[1][0]+n[0][0]))/2,o=-i*n[0][1];e.scale(150*i).translate([a,o])}),n)}(k,e,t)},k.fitHeight=function(e,t){return function(e,t,n){return Jg(e,(function(n){var r=+t,i=r/(n[1][1]-n[0][1]),a=-i*n[0][0],o=(r-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([a,o])}),n)}(k,e,t)},function(){return t=e.apply(this,arguments),k.invert=t.invert&&M,C()}}((function(){return e}))()}function ay(e,t){var n=Uf(t),r=1+Uf(e)*n;return[n*qf(e)/r,qf(t)/r]}ay.invert=function(e){return function(t,n){var r=Gf(t*t+n*n),i=e(r),a=qf(i),o=Uf(i);return[Of(t*a,r*o),Wf(r&&n*a/r)]}}((function(e){return 2*Df(e)}));var oy=Math.PI,sy=oy/2,uy=180/oy,ly=oy/180,cy=(Math.abs,Math.atan,Math.atan2),hy=Math.cos,fy=(Math.ceil,Math.exp,Math.floor,Math.log,Math.max),dy=Math.min,py=(Math.pow,Math.sin),Ay=Math.sign||function(e){return e>0?1:e<0?-1:0},vy=Math.sqrt;Math.tan;function my(e){return e>1?sy:e<-1?-sy:Math.asin(e)}function gy(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function yy(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function _y(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]}function by(e){var t=vy(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]}function xy(e){return[cy(e[1],e[0])*uy,my(fy(-1,dy(1,e[2])))*uy]}function wy(e){var t=e[0]*ly,n=e[1]*ly,r=hy(n);return[r*hy(t),r*py(t),py(n)]}function Ty(e){return e=e.map((function(e){return wy(e)})),gy(e[0],yy(e[2],e[1]))}function Sy(e){var t=function(e){if(e.length<2)return{};var t=0;for(;isNaN(e[t][0]+e[t][1])&&t++<e.length;);var n=function(e){function t(t){return(t=e(t[0]*If,t[1]*If))[0]*=Nf,t[1]*=Nf,t}return e=Tg(e[0]*If,e[1]*If,e.length>2?e[2]*If:0),t.invert=function(t){return(t=e.invert(t[0]*If,t[1]*If))[0]*=Nf,t[1]*=Nf,t},t}(e[t]),r=iy(ay).scale(250).clipAngle(142).translate([0,0]).scale(1).rotate(n.invert([180,0]));e=e.map(r);for(var i=[],a=1,o=0,s=e.length;o<s;o++){var u=Math.pow(e[o][0],2)+Math.pow(e[o][1],2);!isFinite(u)||u>1e32?i.push(o):u>a&&(a=u)}var l=1e6*vy(a);i.forEach((function(t){return e[t]=[l,0]})),e.push([0,l]),e.push([-l,0]),e.push([0,-l]);var c=yg.from(e);c.projection=r;for(var h=c.triangles,f=c.halfedges,d=c.inedges,p=[],A=0,v=f.length;A<v;A++)if(f[A]<0){var m=A%3==2?A-2:A+1,g=A%3==0?A+2:A-1,y=f[m],_=f[g];f[y]=_,f[_]=y,f[m]=f[g]=-1,h[A]=h[m]=h[g]=t,d[h[y]]=y%3==0?y+2:y-1,d[h[_]]=_%3==0?_+2:_-1,p.push(Math.min(A,m,g)),A+=2-A%3}else h[A]>e.length-3-1&&(h[A]=t);return c}(e),n=function(e){var t=e.triangles;if(!t)return[];for(var n=[],r=0,i=t.length/3;r<i;r++){var a=t[3*r],o=t[3*r+1],s=t[3*r+2];a!==o&&o!==s&&n.push([a,s,o])}return n}(t),r=function(e,t){var n=new Set;return 2===t.length?[[0,1]]:(e.forEach((function(e){if(e[0]!==e[1]&&!(Ty(e.map((function(e){return t[e]})))<0))for(var r,i=0;i<3;i++)r=(i+1)%3,n.add(hv([e[i],e[r]]).join("-"))})),Array.from(n,(function(e){return e.split("-").map(Number)})))}(n,e),i=function(e,t){var n=[];e.forEach((function(e){for(var t=0;t<3;t++){var r=e[t],i=e[(t+1)%3];n[r]=n[r]||[],n[r].push(i)}})),0===e.length&&(2===t?(n[0]=[1],n[1]=[0]):1===t&&(n[0]=[]));return n}(n,e.length),a=function(e,t){function n(e,t){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}return function(r,i,a){void 0===a&&(a=0);var o,s,u=a,l=wy([r,i]);do{o=a,a=null,s=n(l,wy(t[o])),e[o].forEach((function(e){var r=n(l,wy(t[e]));if(r<s)return s=r,a=e,void(u=e)}))}while(null!==a);return u}}(i,e),o=function(e,t){return e.map((function(e){var n=e.map((function(e){return t[e]})).map(wy);return xy(by(_y(_y(yy(n[1],n[0]),yy(n[2],n[1])),yy(n[0],n[2]))))}))}(n,e),s=function(e,t,n){var r=[],i=e.slice();if(0===t.length){if(n.length<2)return{polygons:r,centers:i};if(2===n.length){var a=wy(n[0]),o=wy(n[1]),s=by(_y(a,o)),u=by(yy(a,o)),l=yy(s,u),c=[s,yy(s,l),yy(yy(s,l),l),yy(yy(yy(s,l),l),l)].map(xy).map(f);return r.push(c),r.push(c.slice().reverse()),{polygons:r,centers:i}}}t.forEach((function(e,t){for(var n=0;n<3;n++){var i=e[n],a=e[(n+1)%3],o=e[(n+2)%3];r[i]=r[i]||[],r[i].push([a,o,t,[i,a,o]])}}));var h=r.map((function(e){for(var t=[e[0][2]],r=e[0][1],a=1;a<e.length;a++)for(var o=0;o<e.length;o++)if(e[o][0]==r){r=e[o][1],t.push(e[o][2]);break}if(t.length>2)return t;if(2==t.length){var s=Ey(n[e[0][3][0]],n[e[0][3][1]],i[t[0]]),u=Ey(n[e[0][3][2]],n[e[0][3][0]],i[t[0]]),l=f(s),c=f(u);return[t[0],c,t[1],l]}}));function f(e){var n=-1;return i.slice(t.length,1/0).forEach((function(r,i){r[0]===e[0]&&r[1]===e[1]&&(n=i+t.length)})),n<0&&(n=i.length,i.push(e)),n}return{polygons:h,centers:i}}(o,n,e),u=s.polygons,l=s.centers,c=function(e){var t=[];return e.forEach((function(e){if(e){var n,r=e[e.length-1],i=k(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;a>r&&t.push([r,a]),r=a}}catch(o){i.e(o)}finally{i.f()}}})),t}(u),h=function(e,t){var n=new Set,r=[];e.map((function(e){if(!(Ty(e.map((function(e){return t[e>t.length?0:e]})))>1e-12))for(var r=0;r<3;r++){var i=[e[r],e[(r+1)%3]],a="".concat(i[0],"-").concat(i[1]);n.has(a)?n.delete(a):n.add("".concat(i[1],"-").concat(i[0]))}}));var i,a=new Map;if(n.forEach((function(e){e=e.split("-").map(Number),a.set(e[0],e[1]),i=e[0]})),void 0===i)return r;var o=i;do{r.push(o);var s=a.get(o);a.set(o,-1),o=s}while(o>-1&&o!==i);return r}(n,e),f=function(e,t){return function(n){var r=new Map,i=new Map;return e.forEach((function(e,t){var a=e.join("-");r.set(a,n[t]),i.set(a,!0)})),t.forEach((function(e){for(var t=0,n=-1,a=0;a<3;a++){var o=hv([e[a],e[(a+1)%3]]).join("-");r.get(o)>t&&(t=r.get(o),n=o)}i.set(n,!1)})),e.map((function(e){return i.get(e.join("-"))}))}}(r,n);return{delaunay:t,edges:r,triangles:n,centers:l,neighbors:i,polygons:u,mesh:c,hull:h,urquhart:f,find:a}}function Ey(e,t,n){e=wy(e),t=wy(t),n=wy(n);var r=Ay(gy(yy(t,e),n));return xy(by(_y(e,t)).map((function(e){return r*e})))}function ky(e){var t=function e(t){if(e.delaunay=null,"object"===typeof(e._data=t)&&"FeatureCollection"===e._data.type&&(e._data=e._data.features),"object"===typeof e._data){var n=e._data.map((function(t){return[e._vx(t),e._vy(t),t]})).filter((function(e){return isFinite(e[0]+e[1])}));e.points=n.map((function(e){return[e[0],e[1]]})),e.valid=n.map((function(e){return e[2]})),e.delaunay=Sy(e.points)}return e};return t._vx=function(e){return"object"==typeof e&&"type"in e?ug(e)[0]:0 in e?e[0]:void 0},t._vy=function(e){return"object"==typeof e&&"type"in e?ug(e)[1]:1 in e?e[1]:void 0},t.x=function(e){return e?(t._vx=e,t):t._vx},t.y=function(e){return e?(t._vy=e,t):t._vy},t.polygons=function(e){if(void 0!==e&&t(e),!t.delaunay)return!1;var n={type:"FeatureCollection",features:[]};return 0===t.valid.length||(t.delaunay.polygons.forEach((function(e,r){return n.features.push({type:"Feature",geometry:e?{type:"Polygon",coordinates:[[].concat(l(e),[e[0]]).map((function(e){return t.delaunay.centers[e]}))]}:null,properties:{site:t.valid[r],sitecoordinates:t.points[r],neighbours:t.delaunay.neighbors[r]}})})),1===t.valid.length&&n.features.push({type:"Feature",geometry:{type:"Sphere"},properties:{site:t.valid[0],sitecoordinates:t.points[0],neighbours:[]}})),n},t.triangles=function(e){return void 0!==e&&t(e),!!t.delaunay&&{type:"FeatureCollection",features:t.delaunay.triangles.map((function(e,n){return e=e.map((function(e){return t.points[e]})),e.center=t.delaunay.centers[n],e})).filter((function(e){return Ty(e)>0})).map((function(e){return{type:"Feature",properties:{circumcenter:e.center},geometry:{type:"Polygon",coordinates:[[].concat(l(e),[e[0]])]}}}))}},t.links=function(e){if(void 0!==e&&t(e),!t.delaunay)return!1;var n=t.delaunay.edges.map((function(e){return Mp(t.points[e[0]],t.points[e[1]])})),r=t.delaunay.urquhart(n);return{type:"FeatureCollection",features:t.delaunay.edges.map((function(e,i){return{type:"Feature",properties:{source:t.valid[e[0]],target:t.valid[e[1]],length:n[i],urquhart:!!r[i]},geometry:{type:"LineString",coordinates:[t.points[e[0]],t.points[e[1]]]}}}))}},t.mesh=function(e){return void 0!==e&&t(e),!!t.delaunay&&{type:"MultiLineString",coordinates:t.delaunay.edges.map((function(e){return[t.points[e[0]],t.points[e[1]]]}))}},t.cellMesh=function(e){if(void 0!==e&&t(e),!t.delaunay)return!1;var n,r=t.delaunay,i=r.centers,a=[],o=k(r.polygons);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(s)for(var u=s.length,l=s[u-1],c=s[0],h=0;h<u;l=c,c=s[++h])c>l&&a.push([i[l],i[c]])}}catch(f){o.e(f)}finally{o.f()}return{type:"MultiLineString",coordinates:a}},t._found=void 0,t.find=function(e,n,r){if(t._found=t.delaunay.find(e,n,t._found),!r||Mp([e,n],t.points[t._found])<r)return t._found},t.hull=function(e){void 0!==e&&t(e);var n=t.delaunay.hull,r=t.points;return 0===n.length?null:{type:"Polygon",coordinates:[[].concat(l(n.map((function(e){return r[e]}))),[r[n[0]]])]}},e?t(e):t}function My(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Cy(e,t,n){return t=Ry(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Py()?Reflect.construct(t,[],Ry(e).constructor):t.apply(e,n))}function Ry(e){return Ry=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ry(e)}function Py(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Py=function(){return!!e})()}function Ny(e,t){return Ny=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ny(e,t)}function Iy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t);else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(e,t)||Dy(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ly(e){return function(e){if(Array.isArray(e))return My(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Dy(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dy(e,t){if(e){if("string"==typeof e)return My(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?My(e,t):void 0}}function Oy(e,t){return e.map((function(e){var n,r=[];return e.forEach((function(e){if(n){var i=180*Mp(e,n)/Math.PI;if(i>t)for(var a=Cp(n,e),o=1/Math.ceil(i/t),s=o;s<1;)r.push(a(s)),s+=o}r.push(n=e)})),r}))}function Uy(e,t){var n={type:"Polygon",coordinates:e},r=Iy(wm(n),2),i=Iy(r[0],2),a=i[0],o=i[1],s=Iy(r[1],2),u=s[0],l=s[1];if(Math.min(Math.abs(u-a),Math.abs(l-o))<t)return[];var c=a>u||l>=89||o<=-89;return function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minLng,r=t.maxLng,i=t.minLat,a=t.maxLat,o=Math.round(Math.pow(360/e,2)/Math.PI),s=(1+Math.sqrt(5))/2,u=function(e){return e/s*360%360-180},l=function(e){return Math.acos(2*e/o-1)/Math.PI*180-90},c=function(e){return o*(Math.cos((e+90)*Math.PI/180)+1)/2},h=[void 0!==a?Math.ceil(c(a)):0,void 0!==i?Math.floor(c(i)):o-1],f=void 0===n&&void 0===r?function(){return!0}:void 0===n?function(e){return e<=r}:void 0===r?function(e){return e>=n}:r>=n?function(e){return e>=n&&e<=r}:function(e){return e>=n||e<=r},d=[],p=h[0];p<=h[1];p++){var A=u(p);f(A)&&d.push([A,l(p)])}return d}(t,{minLng:a,maxLng:u,minLat:o,maxLat:l}).filter((function(e){return By(e,n,c)}))}function By(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?Km(t,e):Zv(e,t)}var Fy=window.THREE?window.THREE:{BufferGeometry:qa,Float32BufferAttribute:La},zy=(new Fy.BufferGeometry).setAttribute?"setAttribute":"addAttribute",Vy=function(e){function t(e,n,r,i,a,o,s){var u;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(u=Cy(this,t)).type="ConicPolygonGeometry",u.parameters={polygonGeoJson:e,bottomHeight:n,topHeight:r,closedBottom:i,closedTop:a,includeSides:o,curvatureResolution:s},n=n||0,r=r||1,i=void 0===i||i,a=void 0===a||a,o=void 0===o||o;var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.resolution,r=void 0===n?1/0:n,i=Oy(e,r),a=lv(i),o=Uy(e,r),s=[].concat(Ly(a),Ly(o)),u={type:"Polygon",coordinates:e},l=Iy(wm(u),2),c=Iy(l[0],2),h=c[0],f=c[1],d=Iy(l[1],2),p=d[0],A=d[1],v=h>p||A>=89||f<=-89,m=[];if(v){var g=ky(s).triangles(),y=new Map(s.map((function(e,t){var n=Iy(e,2),r=n[0],i=n[1];return["".concat(r,"-").concat(i),t]})));g.features.forEach((function(e){var t,n=e.geometry.coordinates[0].slice(0,3).reverse(),r=[];if(n.forEach((function(e){var t=Iy(e,2),n=t[0],i=t[1],a="".concat(n,"-").concat(i);y.has(a)&&r.push(y.get(a))})),3===r.length){if(r.some((function(e){return e<a.length}))&&!By(e.properties.circumcenter,u,v))return;(t=m).push.apply(t,r)}}))}else if(o.length)for(var _=wv.from(s),b=function(e){var t,n=[2,1,0].map((function(t){return _.triangles[e+t]})),r=n.map((function(e){return s[e]}));if(n.some((function(e){return e<a.length}))){var i=[0,1].map((function(e){return cv(r,(function(t){return t[e]}))}));if(!By(i,u,v))return 1}(t=m).push.apply(t,Ly(n))},x=0,w=_.triangles.length;x<w;x+=3)b(x);else{var T=lp(i),S=T.vertices,E=T.holes;m=Dd(S,void 0===E?[]:E,2)}var k=Sf(hv(s,(function(e){return e[0]})),[0,1]),M=Sf(hv(s,(function(e){return e[1]})),[0,1]),C=s.map((function(e){var t=Iy(e,2),n=t[0],r=t[1];return[k(n),M(r)]})),R={points:s,indices:m,uvs:C};return{contour:i,triangles:R}}(e,{resolution:s=s||5}),c=l.contour,h=l.triangles,f=lv(h.uvs),d=[],p=[],A=[],v=0,m=function(e){var t=Math.round(d.length/3),n=A.length;d=d.concat(e.vertices),p=p.concat(e.uvs),A=A.concat(t?e.indices.map((function(e){return e+t})):e.indices),u.addGroup(n,A.length-n,v++)};function g(e,t){var n="function"===typeof t?t:function(){return t},r=e.map((function(e){return e.map((function(e){var t=Iy(e,2),r=t[0],i=t[1];return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=(90-e)*Math.PI/180,i=(90-t)*Math.PI/180;return[n*Math.sin(r)*Math.cos(i),n*Math.cos(r),n*Math.sin(r)*Math.sin(i)]}(i,r,n(r,i))}))}));return lp(r)}function y(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{indices:t?h.indices:h.indices.slice().reverse(),vertices:g([h.points],e).vertices,uvs:f}}return o&&m(function(){for(var e=g(c,n),t=e.vertices,i=e.holes,a=g(c,r).vertices,o=lv([a,t]),s=Math.round(a.length/3),u=new Set(i),l=0,h=[],f=0;f<s;f++){var d=f+1;if(d===s)d=l;else if(u.has(d)){var p=d;d=l,l=p}h.push(f,f+s,d+s),h.push(d+s,d,f)}for(var A=[],v=1;v>=0;v--)for(var m=0;m<s;m+=1)A.push(m/(s-1),v);return{indices:h,vertices:o,uvs:A}}()),i&&m(y(n,!1)),a&&m(y(r,!0)),u.setIndex(A),u[zy]("position",new Fy.Float32BufferAttribute(d,3)),u[zy]("uv",new Fy.Float32BufferAttribute(p,2)),u.computeVertexNormals(),u}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ny(e,t)}(t,e),function(e,t,n){return Object.defineProperty(e,"prototype",{writable:!1}),e}(t)}(Fy.BufferGeometry);function qy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function jy(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Gy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t);else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(e,t)||Xy(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hy(e){return function(e){if(Array.isArray(e))return qy(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Xy(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wy(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}function Xy(e,t){if(e){if("string"==typeof e)return qy(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qy(e,t):void 0}}var Qy=function(e){var t,n="undefined"!==typeof(e=e||{})?e:{},r={};for(t in n)n.hasOwnProperty(t)&&(r[t]=n[t]);var i,a=[],o="";"undefined"!==typeof document&&document.currentScript&&(o=document.currentScript.src),o=0!==o.indexOf("blob:")?o.substr(0,o.lastIndexOf("/")+1):"",i=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){if(200==r.status||0==r.status&&r.response)t(r.response);else{var i=Q(e);i?t(i.buffer):n()}},r.onerror=n,r.send(null)};var s=n.print||console.log.bind(console),u=n.printErr||console.warn.bind(console);for(t in r)r.hasOwnProperty(t)&&(n[t]=r[t]);r=null,n.arguments&&(a=n.arguments);var l=0;var c=!1;function h(e){var t,r=n["_"+e];return t="Cannot call unknown function "+e+", make sure it is exported",r||ue("Assertion failed: "+t),r}function f(e,t,n,r,i){var a={string:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var n=1+(e.length<<2);(function(e,t,n){(function(e,t,n,r){if(!(r>0))return 0;for(var i=n,a=n+r-1,o=0;o<e.length;++o){var s=e.charCodeAt(o);if(s>=55296&&s<=57343)s=65536+((1023&s)<<10)|1023&e.charCodeAt(++o);if(s<=127){if(n>=a)break;t[n++]=s}else if(s<=2047){if(n+1>=a)break;t[n++]=192|s>>6,t[n++]=128|63&s}else if(s<=65535){if(n+2>=a)break;t[n++]=224|s>>12,t[n++]=128|s>>6&63,t[n++]=128|63&s}else{if(n+3>=a)break;t[n++]=240|s>>18,t[n++]=128|s>>12&63,t[n++]=128|s>>6&63,t[n++]=128|63&s}}t[n]=0})(e,m,t,n)})(e,t=ee(n),n)}return t},array:function(e){var t=ee(e.length);return function(e,t){v.set(e,t)}(e,t),t}};var o=h(e),s=[],u=0;if(r)for(var l=0;l<r.length;l++){var c=a[n[l]];c?(0===u&&(u=ne()),s[l]=c(r[l])):s[l]=r[l]}var f=o.apply(null,s);return f=function(e){return"string"===t?p(e):"boolean"===t?Boolean(e):e}(f),0!==u&&te(u),f}var d="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function p(e,t){return e?function(e,t,n){for(var r=t+n,i=t;e[i]&&!(i>=r);)++i;if(i-t>16&&e.subarray&&d)return d.decode(e.subarray(t,i));for(var a="";t<i;){var o=e[t++];if(128&o){var s=63&e[t++];if(192!=(224&o)){var u=63&e[t++];if((o=224==(240&o)?(15&o)<<12|s<<6|u:(7&o)<<18|s<<12|u<<6|63&e[t++])<65536)a+=String.fromCharCode(o);else{var l=o-65536;a+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else a+=String.fromCharCode((31&o)<<6|s)}else a+=String.fromCharCode(o)}return a}(m,e,t):""}var A,v,m,g,y,_,b;"undefined"!==typeof TextDecoder&&new TextDecoder("utf-16le");function x(e,t){return e%t>0&&(e+=t-e%t),e}function w(e){A=e,n.HEAP8=v=new Int8Array(e),n.HEAP16=g=new Int16Array(e),n.HEAP32=y=new Int32Array(e),n.HEAPU8=m=new Uint8Array(e),n.HEAPU16=new Uint16Array(e),n.HEAPU32=new Uint32Array(e),n.HEAPF32=_=new Float32Array(e),n.HEAPF64=b=new Float64Array(e)}var T=n.TOTAL_MEMORY||33554432;function S(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var r=t.func;"number"===typeof r?void 0===t.arg?n.dynCall_v(r):n.dynCall_vi(r,t.arg):r(void 0===t.arg?null:t.arg)}else t()}}T=(A=n.buffer?n.buffer:new ArrayBuffer(T)).byteLength,w(A),y[7152]=5271520;var E=[],k=[],M=[],C=[];var R=Math.abs,P=Math.ceil,N=Math.floor,I=Math.min,L=0,D=null,O=null;n.preloadedImages={},n.preloadedAudios={};var U,B,F=null,z="data:application/octet-stream;base64,";function V(e){return String.prototype.startsWith?e.startsWith(z):0===e.indexOf(z)}F="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAEAAAAAAAAAAAEAAAAAAQAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAA6B6FaUp9QQTPXMuL4myJBraiDfBwx9UBYJseitzTIQOL5if9jqZtAnXX+Z+ycb0C3pucbhRBCQG8wJBYqpRRAlWbDCzCY5z/eFWBUEve6P/+qo4Q50Y4/D9YM3iCcYT8fcA2QJSA0P4ADxu0qAAc/BNcGolVJ2j5d9FACqwquPh9z7MthtI9CSUSYJke/YUJQ/64OyjU0Qpi0+HCmFQdCm3GfIVdh2kHsJ11kAyauQYC3UDFJOoFBSJsFV1OwU0FK5fcxX4AmQWhy/zZIt/lACqaCPsBjzUDbdUNIScugQMYQlVJ4MXNANiuq8GTvRUDxTXnulxEZQFZ8QX5kpuw/qmG/JwYFlEAluh3Q6DB+QKn4vyNq0GZAKOXekas+UUB8xabXXhI6QG63C2pLtSNAdDBtyNfLDUDyOcu67ID2P0rCMvRXAeE/Ki2TSVyzyT9Dk+8Sz2uzP5J+w5ARWp0/NQAoOiMuhj9YnP+RyMJwPxgW7TvQVFk/KgsLYF0kQz9g5dAC6IwzQcgHPVvDex1B1XjppodHBkHJq3OMM9fwQNvcmJ7wddlAInGPpQs/w0BRobq5EBmtQJZ2ai7n+ZVAtv2G5E+bgECG+gIfKBlpQK5f8jdI91JAL39sL/WpPEB8rGxhDqklQK6yUf43XhBAxL9y/tK8+D86XyZpgrHiPwAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAP////8AAAAAAAAAAAAAAAABAAAAAAAAAAAAAAD/////AAAAAAAAAAABAAAAAQAAAAAAAAAAAAAA/////wAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8FAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQAAAAAAAQABAAABAQAAAAAAAQAAAAEAAAABAAEAAAAAAAAAAAAAAAAAAAAAquJYWJZl+D9jaeZNtj/zPwwdI9KqaeO/qGefXwdHdz+q4lhYlmX4P+OrlPMN3PI/DB0j0qpp47+7SQLV4VIEQKriWFiWZfg/r2kma3tz8T82eQmLqNIGwMRIWXMqSvo/fcCszPux9j+jara6ozTwP6hnn18HR3c/MSoKLequ8r+SabgA2nj0P7jBLbDOHO8/1Ym/ICfH4T+6lxjvlFXHv73m373LRPU/0vXyDVxo7T+ToKRHJXMAQF/33578aPE/pAyy64tD9T8+U/hCvyruPwxv8Y7YYwLAuXYr8NAiCEB4+LDK0Sn0P1Qeuy4j+eo/OMx50n7K7L+TrGB/nyf8v5ehC2fbYPM/aXMKexiT6z8mFRIMjg/zP7yUVwGGBNw/E6opHERf8z/z0wR2g9DqPw4pBpcOhvu/NbA29uWAA8DMaTExyXzyP02biiQ+Ruk/S8jz2/FKBEB1pzZnpbb9P7pQU4wLfPI//7ZcQXeG6D9CqEQvAYoIwDB2VB6sSgRAVyv8H5We8T+EHWF8XNPmPzB2wT8Nrrg/SEi+cX+w4L8of+GtdSDxP1sjk5AdouU/6ZjOVru13r8K0obqI6bxvwVbdNXyhfA/w5GG024n5z+rwmtMzP8BwLw9pSX49QXABe/2uQxP8D+b6wCzCvXkP7uGT87fK+Q/pz/JWw4coj+qoBf2J0nwP/yE3PUo0+I/vFJeHcaC+D96luSIqvntP/bf8sHUYu8/gZNN41mL4z9bhOqVOF4FwO6lmAh1hQhAbCVxbdhk7z+1C8NdDcfiPwG36x/0OQBAx0WJ76c2+D9nlSHXANfuP2HlfZ3gqOE/EwnVlVPg9r96+oHzEH//v5bXzdT1Auw/DM3GwLsA4D9p/8uoKcr+v+U9x5DQVAPAehjSdghb7D9sc1IetODgP8MVwwB1pu6/azPk6OGe978W8t/TUc3rP+0QMvYfP+A/RsG/QpSE8D+l3uwScxzgPwQaifgujuw/k1Vti1I43z8MAwLnSh0GQH5nYnwwZgJAiGUzWC5s6j8WyyI/BbLgPw4iUapGeQJAB3W+imnp/j9BLWR4ssrpP2t+gG5Pstk/cpBsfm6DCMCOpU9dOZsFQEv8nFypHeo/ehJ6i+6S2D9jqlGEmarLv7STC5TRiOa/bC+x8WZD6D9H3yUkWpDZP8gZvmCMuQLAreY19/eRBsCoPOc8UzzpP6KI/QV+y9g/t/MoboyWzT+Hv5q3Zu3Mvy2xROCT4uY/9gQitMMg1T9abAqhWMDkv1oLTavoUfG/PMUJP9CD5j+fHRX3t6fSPz7W2gk6bvs/WRnuHwqN9D8YFturGCTmP1EZczv0b9I/5t4exabB5D/1ESLh5fTEP9X2z6SYweQ/6lv3I2zT0D9zkRGNUNMAQKoSvc4EIfs/Xggt8wQI5T+mJHHg/w/SP4lhT/9t8vQ/DrZ/DbwH7D+XlhbYZrjkP34LIpFt6c4/lwfp8fLX9L+j96CTTf76v3WdNhEv9uM/d8c3o4lV0D/vFdCHVcsFwAHeDq0F1QhApbYqcZiN5D9KoilqByXLPwX0/diA0vq/0fo0GxnxAMBbaTkvlCzjP/RrFrWXrMs/UYTrky7jA0DB9f4FiZYAQEGAk/3QzeE/r/TeqE8t0D/OqjlsnPbvvz8RKU8JOfW/smSEbK/O4T8MzuyPm3DDP/rFtctq9gZAfb1EVEaSA0Dts5dVInnhP18SFMc79MM/7y34cw6LAMDFrRJsZO0DwC2KLvLSYuA/hx5wcUHewz+49SnK/4ruPyeS0PX9a+E/ZxaaLvvZ3z8WPu5T2QS8Pygo4RIvMqa/BJ0Kqsd0279cKW4ay8jdP3b05bmZ364/10/qtdxk2r+Bcz6CDMvpv54qOw+Amdw/qLV71pW7sT/YKc80nIPUP8OfIaBJ77G/LyTuD1un2z+diYu8efWzP1wU7ACkfwjAZroyPL1yBkAmv3lKJJbbPysKSE4W+p0/dIgqY79TA8ATLTOQ3tsGwJ2zweD/Xdg/XO/jXeFUaL8VW2qLFKfov1cA9Aa6XfK/tIa7YGgI2T+f3hu/sxqPv2nXdPpf3Pc/jkw8Jbda8j+tT/z8tGPVP1yBHpJd35k/KYvYOy1s8j/yz+kCQjPrP9+agH7x59g/PZfJ9aBhpr/rDKzvYBb+PwtkiaGCt/c/vb1mVr+f1T/JIHwHc8Govw7aeF6+9vG/Xv7kD6fp979isYioQYHVP7AIQZuSFrG/3z1AdUTnAUDN3XY9O7f9P0AdQ9ljYNQ/dJANJPTOrb8kLECUiiPlP4yF7UgmStA/9xGmXxCG1T9qZzix4W2zv2SGJRJVrPe/Fh9a2M/B/b8IexzFCoPSP9y1QFD2bLe/Q86cWLJe/b+mOOfYm78BwOTjkPAGE9E/8aPCUKu/ub9pPZyLCiUGwBA7Mev/BQlALOmrlRi+0j+AMJ/dKULBv7iLtL6a6QRAEMDV/yajAUDa62dE3crJP1P70RgBUbq/38hVnR6esT/s1tG10Z/Ov/zLwalHPss/dTS9NKTXx78nMcRzCIEHQAabxDsAmQRA0tyLK3gSyT+Aui7nOhDGv5Gs58z3WgHATN3forJuBMCAui7nOhDGP9Lciyt4Esm/WAJyHQ4c7z8UP5HFIs3iP3U0vTSk18c//MvBqUc+y7+cvv8HLg/Kvy1I/mHsI+K/U/vRGAFRuj/a62dE3crJv8p+WV8KlQjAuQ/nOP43B0CAMJ/dKULBPyzpq5UYvtK/ZoU+VoLh4L9etLlRUfvtv/GjwlCrv7k/5OOQ8AYT0b9DfT9FhufXPwUX8hJp+4u/3LVAUPZstz8IexzFCoPSv9+L609E5fQ/q9Fz7X2J7T9qZzix4W2zP/cRpl8QhtW/vtNilqGX+j8MOy7QJoL0P3SQDST0zq0/QB1D2WNg1L8IIjSvGNkDwGB8Jou2GAfAsAhBm5IWsT9isYioQYHVvyS9D3zb6uy/gnwRa7uM9L/JIHwHc8GoP729Zla/n9W/CsAHJZwmAEDEW6OYT1r6Pz2XyfWgYaY/35qAfvHn2L83Tdy4lS30vxf2/gZ0jPq/XIEekl3fmb+tT/z8tGPVvybPr2zJ1/+/K7mJ0ypVAsCf3hu/sxqPPwCGu2BoCNm/5oITrpZn+r+UDUyDP+n/v1zv413hVGg/nbPB4P9d2L9MlmkxNvgCQMtZlKE85v8/KwpIThb6nb8mv3lKJJbbv8+SZsTvOOc/pQCIIOYw0j+diYu8efWzvy8k7g9bp9u/kxYDa+pKtD9XlYvA8HnVv6i1e9aVu7G/nio7D4CZ3L/WR6rNh5EGwCkgQweBkghAdvTluZnfrr9cKW4ay8jdvxbjhr1f1QVAR5C0MzivAkAWPu5T2QS8v2cWmi772d+/cKj4lzLJCEBx2QJfYrMFQIcecHFB3sO/LYou8tJi4L+jr7lhO38BwIcI0Nb7xgTAXxIUxzv0w7/ts5dVInnhv0T+l8DZLfE/MP3FoFvS5D8MzuyPm3DDv7JkhGyvzuG/tzhzRIRc0b9Ovv3/0z7mv6/03qhPLdC/m4CT/dDN4b9dwjU5VCQBQBBJX1ntCv0/9GsWtZesy79baTkvlCzjv1mjYgEz++S/oW6KnOQW8b9KoilqByXLv6W2KnGYjeS/SmaKz3Vx9z+BZB5yxGHwP3fHN6OJVdC/dZ02ES/2478PuaBjLrXaP4/JU81pPaO/fgsikW3pzr+XlhbYZrjkv4tSn7YDbP0/f2LnFKlF9z+mJHHg/w/Sv14ILfMECOW/mfg4qYhR/b+OP+RQDCACwOpb9yNs09C/1fbPpJjB5L9pN2WOVZ3wv3hHy9nxIve/URlzO/Rv0r8YFturGCTmv1d1/KKR8QPA8gsy9qzSB8CfHRX3t6fSvzzFCT/Qg+a/EYStnrzV9r/2QJqI7Lb9v/YEIrTDINW/LbFE4JPi5r/7kQEs5fEDQHunnf4GeQBAooj9BX7L2L+oPOc8Uzzpv+ydYY2SSAfAL4HK6CRTB0BH3yUkWpDZv2wvsfFmQ+i/Ik0Yzruh6T8fM3LoGoDUP3oSeovukti/S/ycXKkd6r9rEv+7UWcHQCRIQe/GfwNAa36Abk+y2b9BLWR4ssrpv9KT87qa0bM/FTyktw823L8WyyI/BbLgv4hlM1gubOq/DizMp9Ki6r8b5ckdjVrzv5NVbYtSON+/BBqJ+C6O7L/dUBFqgyXYv00Wh18r7+q/7RAy9h8/4L8W8t/TUc3rv4RM5DKx3wDAfvWIj94aBcBsc1IetODgv3oY0nYIW+y/oGcTFF54AUDkJqS/FKX6PwzNxsC7AOC/ltfN1PUC7L+5Wrz/zHnzP6688w2rNOc/YeV9neCo4b9nlSHXANfuvw9RsxKjY/s/1V8GteXE8j+1C8NdDcfiv2wlcW3YZO+/IOywaA7Q8b9bFP+4Tg36v4GTTeNZi+O/9t/ywdRi77+tRc3yFR7eP2bkcHXJkLO//ITc9SjT4r+qoBf2J0nwv2YHKoswwfm/iQcLspCjAcCb6wCzCvXkvwXv9rkMT/C/YkuwYAMXBMApCNUai9kIwMORhtNuJ+e/BVt01fKF8L+ZqWEfvIjsP6h693QZYNk/WyOTkB2i5b8of+GtdSDxvwpaaulDSwVADMQAX+lOAECEHWF8XNPmv1cr/B+VnvG/XyFG6opcCMD/mtR32/UEQP+2XEF3hui/ulBTjAt88r/imfCfRP+yP9zbvtc8XeO/TZuKJD5G6b/MaTExyXzyvxiTQeElXOO/rbJRQVGN9L/z0wR2g9DqvxOqKRxEX/O/FDGCEei99j9x8zV4VYTmP2lzCnsYk+u/l6ELZ9tg878pRXacaDT/v3k6GZRqoQXAVB67LiP56r94+LDK0Sn0vwO6pZ9b7wFAvK0nKVcc9j8+U/hCvyruv6QMsuuLQ/W/FPhKFYv46j8MyxaDTOW/v9L18g1caO2/vebfvctE9b/7GD8ZrF3xv3gx1AR9bQDAuMEtsM4c77+SabgA2nj0v5xKFIwxsATArKNSBaKsB0Cjara6ozTwv33ArMz7sfa/dF2U0FcWCcDxL357DJX/P69pJmt7c/G/quJYWJZl+L/YntVJlnrSP4sRLzXM+fe/46uU8w3c8r+q4lhYlmX4v85lu5+QRwRAsI0H/WU8479jaeZNtj/zv6riWFiWZfi/sI0H/WU847/OZbufkEcEQHAoPUBrnss/9exKzDtFtT88wM8kax+gP9OqeKeAYog/MW0ItiZvcj+ph+smvt5bP2lCaV5dEUU/StaUmQDaLz+kK9y22BMYP0O3whZuMwI/IIbgZGWE6z7UkjYaEM3UPuezxwa9cr8+LybxRMnFpz6E1N8DbPiRPsYjySMvK3s+//////8fAAj//////zMQCP////9/MiAI/////28yMAj/////YzJACP///z9iMlAI////N2IyYAj///8zYjJwCP//vzNiMoAI//+rM2IykAj/f6szYjKgCP8PqzNiMrAI/wOrM2IywAi/A6szYjLQCJ8DqzNiMuAImQOrM2Iy8Aj//////z8PCP//////Kx8I/////38pLwj/////Pyk/CP////85KU8I////PzgpXwj///8POClvCP///w44KX8I//8fDjgpjwj//w8OOCmfCP9/DQ44Ka8I/w8NDjgpvwj/DQ0OOCnPCP8MDQ44Kd8IxwwNDjgp7wjEDA0OOCn/CAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAABgtRFT7Ifk/GC1EVPsh+b8YLURU+yEJQBgtRFT7IQnAYWxnb3MuYwBoM05laWdoYm9yUm90YXRpb25zAGNvb3JkaWprLmMAX3VwQXA3Q2hlY2tlZABfdXBBcDdyQ2hlY2tlZABkaXJlY3RlZEVkZ2UuYwBkaXJlY3RlZEVkZ2VUb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpclt0bXBGaWprLmZhY2VdW2ZpamsuZmFjZV0gPT0gS0kAZmFjZWlqay5jAF9mYWNlSWprUGVudFRvQ2VsbEJvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9DZWxsQm91bmRhcnkAaDNJbmRleC5jAGNvbXBhY3RDZWxscwBsYXRMbmdUb0NlbGwAY2VsbFRvQ2hpbGRQb3MAdmFsaWRhdGVDaGlsZFBvcwBsYXRMbmcuYwBjZWxsQXJlYVJhZHMyAHBvbHlnb24tPm5leHQgPT0gTlVMTABsaW5rZWRHZW8uYwBhZGROZXdMaW5rZWRQb2x5Z29uAG5leHQgIT0gTlVMTABsb29wICE9IE5VTEwAYWRkTmV3TGlua2VkTG9vcABwb2x5Z29uLT5maXJzdCA9PSBOVUxMAGFkZExpbmtlZExvb3AAY29vcmQgIT0gTlVMTABhZGRMaW5rZWRDb29yZABsb29wLT5maXJzdCA9PSBOVUxMAGlubmVyTG9vcHMgIT0gTlVMTABub3JtYWxpemVNdWx0aVBvbHlnb24AYmJveGVzICE9IE5VTEwAY2FuZGlkYXRlcyAhPSBOVUxMAGZpbmRQb2x5Z29uRm9ySG9sZQBjYW5kaWRhdGVCQm94ZXMgIT0gTlVMTAByZXZEaXIgIT0gSU5WQUxJRF9ESUdJVABsb2NhbGlqLmMAY2VsbFRvTG9jYWxJamsAYmFzZUNlbGwgIT0gb3JpZ2luQmFzZUNlbGwAIShvcmlnaW5PblBlbnQgJiYgaW5kZXhPblBlbnQpAGJhc2VDZWxsID09IG9yaWdpbkJhc2VDZWxsAGJhc2VDZWxsICE9IElOVkFMSURfQkFTRV9DRUxMAGxvY2FsSWprVG9DZWxsACFfaXNCYXNlQ2VsbFBlbnRhZ29uKGJhc2VDZWxsKQBiYXNlQ2VsbFJvdGF0aW9ucyA+PSAwAGdyaWRQYXRoQ2VsbHMAcG9seWZpbGwuYwBpdGVyU3RlcFBvbHlnb25Db21wYWN0ADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";function q(e){return e}function j(e){return e.replace(/\b__Z[\w\d_]+/g,(function(e){return e===e?e:e+" ["+e+"]"}))}function G(){var e=new Error;if(!e.stack){try{throw new Error(0)}catch(p0){e=p0}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}function H(){return v.length}function W(e){try{var t=new ArrayBuffer(e);if(t.byteLength!=e)return;return new Int8Array(t).set(v),$(t),w(t),1}catch(p0){}}var X="function"===typeof atob?atob:function(e){var t,n,r,i,a,o,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",l=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{t=s.indexOf(e.charAt(l++))<<2|(i=s.indexOf(e.charAt(l++)))>>4,n=(15&i)<<4|(a=s.indexOf(e.charAt(l++)))>>2,r=(3&a)<<6|(o=s.indexOf(e.charAt(l++))),u+=String.fromCharCode(t),64!==a&&(u+=String.fromCharCode(n)),64!==o&&(u+=String.fromCharCode(r))}while(l<e.length);return u};function Q(e){if(V(e))return function(e){try{for(var t=X(e),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n}catch(i){throw new Error("Converting base64 string to bytes failed.")}}(e.slice(z.length))}var Y,K,Z={a:ue,b:function(e){l=e},c:function(){return l},d:function(e,t,n,r){ue("Assertion failed: "+p(e)+", at: "+[t?p(t):"unknown filename",n,r?p(r):"unknown function"])},e:function(e){return n.___errno_location&&(y[n.___errno_location()>>2]=e),e},f:H,g:function(e,t,n){m.set(m.subarray(t,t+n),e)},h:function(e){var t=H(),n=16777216,r=2130706432;if(e>r)return!1;for(var i=Math.max(t,16777216);i<e;)i=i<=536870912?x(2*i,n):Math.min(x((3*i+2147483648)/4,n),r);return!!W(i)},i:function(e){ue("OOM")},j:q,k:j,l:W,m:G,n:function(){var e=G();return n.extraStackTrace&&(e+="\n"+n.extraStackTrace()),j(e)},o:28624,p:28608},J=function(e,t,n){var r=new e.Int8Array(n),i=new e.Int32Array(n),a=(new e.Uint8Array(n),new e.Float32Array(n),new e.Float64Array(n)),o=0|t.o,s=0|t.p,u=e.Math.floor,l=e.Math.abs,c=e.Math.sqrt,h=e.Math.pow,f=e.Math.cos,d=e.Math.sin,p=e.Math.tan,A=e.Math.acos,v=e.Math.asin,m=e.Math.atan,g=e.Math.atan2,y=e.Math.ceil,_=e.Math.imul,b=e.Math.min,x=e.Math.max,w=e.Math.clz32,T=t.b,S=t.c,E=t.d,k=t.e,M=t.f,C=t.g,R=t.h,P=t.i,N=28640;function I(e,t,n,r){return 0|L(e|=0,t|=0,n|=0,r|=0,0)}function L(e,t,n,r,a){var o,s=0,u=0,l=0,c=0;if(o=N,N=N+16|0,u=o,!(0|D(e|=0,t|=0,n|=0,r|=0,a|=0)))return N=o,0|(r=0);do{if((0|n)>=0){if((0|n)>13780509){if(0|(s=0|ft(15,u)))break;u=0|i[(l=u)>>2],l=0|i[l+4>>2]}else c=0|nn(0|n,0|(s=((0|n)<0)<<31>>31),3,0),l=0|S(),s=0|Zt(0|n,0|s,1,0),s=0|Zt(0|(s=0|nn(0|c,0|l,0|s,0|S())),0|S(),1,0),l=0|S(),i[u>>2]=s,i[u+4>>2]=l,u=s;if(pn(0|r,0,u<<3|0),0|a){pn(0|a,0,u<<2|0),s=0|O(e,t,n,r,a,u,l,0);break}(s=0|Kt(u,4))?(c=0|O(e,t,n,r,s,u,l,0),Yt(s),s=c):s=13}else s=2}while(0);return N=o,0|(c=s)}function D(e,t,n,r,a){e|=0,t|=0,n|=0,r|=0,a|=0;var o,s,u=0,l=0,c=0,h=0,f=0,d=0,p=0,A=0,v=0;if(s=N,N=N+16|0,v=s+8|0,i[(A=o=s)>>2]=e,i[A+4>>2]=t,(0|n)<0)return N=s,0|(v=2);if(i[(u=r)>>2]=e,i[u+4>>2]=t,(u=0!=(0|a))&&(i[a>>2]=0),0|je(e,t))return N=s,0|(v=9);i[v>>2]=0;e:do{if((0|n)>=1)if(u)for(d=1,f=0,p=0,A=1,u=e;;){if(!(f|p)){if(0|(u=0|U(u,t,4,v,o)))break e;if(0|je(u=0|i[(t=o)>>2],t=0|i[t+4>>2])){u=9;break e}}if(0|(u=0|U(u,t,0|i[26800+(p<<2)>>2],v,o)))break e;if(u=0|i[(t=o)>>2],t=0|i[t+4>>2],i[(e=r+(d<<3)|0)>>2]=u,i[e+4>>2]=t,i[a+(d<<2)>>2]=A,l=(0|(e=f+1|0))==(0|A),h=6==(0|(c=p+1|0)),0|je(u,t)){u=9;break e}if((0|(A=A+(h&l&1)|0))>(0|n)){u=0;break}d=d+1|0,f=l?0:e,p=l?h?0:c:p}else for(d=1,f=0,p=0,A=1,u=e;;){if(!(f|p)){if(0|(u=0|U(u,t,4,v,o)))break e;if(0|je(u=0|i[(t=o)>>2],t=0|i[t+4>>2])){u=9;break e}}if(0|(u=0|U(u,t,0|i[26800+(p<<2)>>2],v,o)))break e;if(u=0|i[(t=o)>>2],t=0|i[t+4>>2],i[(e=r+(d<<3)|0)>>2]=u,i[e+4>>2]=t,l=(0|(e=f+1|0))==(0|A),h=6==(0|(c=p+1|0)),0|je(u,t)){u=9;break e}if((0|(A=A+(h&l&1)|0))>(0|n)){u=0;break}d=d+1|0,f=l?0:e,p=l?h?0:c:p}else u=0}while(0);return N=s,0|(v=u)}function O(e,t,n,r,a,o,s,u){n|=0,r|=0,a|=0,u|=0;var l,c,h,f=0,d=0,p=0,A=0,v=0,m=0,g=0;if(h=N,N=N+16|0,l=h+8|0,c=h,f=0|an(0|(e|=0),0|(t|=0),0|(o|=0),0|(s|=0)),p=0|S(),!(0==(0|(g=0|i[(m=A=r+(f<<3)|0)>>2]))&0==(0|(m=0|i[m+4>>2]))|(d=(0|g)==(0|e)&(0|m)==(0|t))))do{f=0|rn(0|(f=0|Zt(0|f,0|p,1,0)),0|S(),0|o,0|s),p=0|S(),d=(0|(m=0|i[(g=A=r+(f<<3)|0)>>2]))==(0|e)&(0|(g=0|i[g+4>>2]))==(0|t)}while(!(0==(0|m)&0==(0|g)|d));if(f=a+(f<<2)|0,d&&(0|i[f>>2])<=(0|u))return N=h,0|(g=0);if(i[(g=A)>>2]=e,i[g+4>>2]=t,i[f>>2]=u,(0|u)>=(0|n))return N=h,0|(g=0);switch(d=u+1|0,i[l>>2]=0,0|(f=0|U(e,t,2,l,c))){case 9:v=9;break;case 0:(f=0|O(0|i[(f=c)>>2],0|i[f+4>>2],n,r,a,o,s,d))||(v=9)}e:do{if(9==(0|v)){switch(i[l>>2]=0,0|(f=0|U(e,t,3,l,c))){case 9:break;case 0:if(0|(f=0|O(0|i[(f=c)>>2],0|i[f+4>>2],n,r,a,o,s,d)))break e;break;default:break e}switch(i[l>>2]=0,0|(f=0|U(e,t,1,l,c))){case 9:break;case 0:if(0|(f=0|O(0|i[(f=c)>>2],0|i[f+4>>2],n,r,a,o,s,d)))break e;break;default:break e}switch(i[l>>2]=0,0|(f=0|U(e,t,5,l,c))){case 9:break;case 0:if(0|(f=0|O(0|i[(f=c)>>2],0|i[f+4>>2],n,r,a,o,s,d)))break e;break;default:break e}switch(i[l>>2]=0,0|(f=0|U(e,t,4,l,c))){case 9:break;case 0:if(0|(f=0|O(0|i[(f=c)>>2],0|i[f+4>>2],n,r,a,o,s,d)))break e;break;default:break e}switch(i[l>>2]=0,0|(f=0|U(e,t,6,l,c))){case 9:break;case 0:if(0|(f=0|O(0|i[(f=c)>>2],0|i[f+4>>2],n,r,a,o,s,d)))break e;break;default:break e}return N=h,0|(g=0)}}while(0);return N=h,0|(g=f)}function U(e,t,n,r,a){e|=0,t|=0,a|=0;var o,s,u=0,l=0,c=0,h=0,f=0,d=0,p=0;if((n|=0)>>>0>6)return 0|(a=1);if(f=(0|i[(r|=0)>>2])%6|0,i[r>>2]=f,(0|f)>0){u=0;do{n=0|ye(n),u=u+1|0}while((0|u)<(0|i[r>>2]))}if(f=0|sn(0|e,0|t,45),S(),(s=127&f)>>>0>121)return 0|(a=5);o=0|We(e,t),u=0|sn(0|e,0|t,52),S(),u&=15;e:do{if(u){for(;;){if(c=0|sn(0|e,0|t,0|(l=3*(15-u|0)|0)),S(),7==(0|(c&=7))){t=5;break}if(p=0==(0|Ze(u)),u=u+-1|0,d=0|un(7,0,0|l),t&=~(0|S()),e=0|un(0|i[(p?432:16)+(28*c|0)+(n<<2)>>2],0,0|l)|e&~d,t|=l=0|S(),!(n=0|i[(p?640:224)+(28*c|0)+(n<<2)>>2])){n=0;break e}if(!u){h=8;break e}}return 0|t}h=8}while(0);8==(0|h)&&(e|=0|un(0|(p=0|i[848+(28*s|0)+(n<<2)>>2]),0,45),t=0|S()|-1040385&t,n=0|i[4272+(28*s|0)+(n<<2)>>2],127==(127&p|0)&&(p=0|un(0|i[848+(28*s|0)+20>>2],0,45),t=0|S()|-1040385&t,n=0|i[4272+(28*s|0)+20>>2],e=0|Qe(p|e,t),t=0|S(),i[r>>2]=1+(0|i[r>>2]))),c=0|sn(0|e,0|t,45),S(),c&=127;e:do{if(0|z(c)){t:do{if(1==(0|We(e,t))){if((0|s)!=(0|c)){if(0|G(c,0|i[7696+(28*s|0)>>2])){e=0|Ke(e,t),l=1,t=0|S();break}E(27795,26864,436,26872)}switch(0|o){case 3:e=0|Qe(e,t),t=0|S(),i[r>>2]=1+(0|i[r>>2]),l=0;break t;case 5:e=0|Ke(e,t),t=0|S(),i[r>>2]=5+(0|i[r>>2]),l=0;break t;case 0:return 0|(p=9);default:return 0|(p=1)}}else l=0}while(0);if((0|n)>0){u=0;do{e=0|Xe(e,t),t=0|S(),u=u+1|0}while((0|u)!=(0|n))}if((0|s)!=(0|c)){if(!(0|V(c))){if(0!=(0|l)|5!=(0|We(e,t)))break;i[r>>2]=1+(0|i[r>>2]);break}switch(127&f){case 8:case 118:break e}3!=(0|We(e,t))&&(i[r>>2]=1+(0|i[r>>2]))}}else if((0|n)>0){u=0;do{e=0|Qe(e,t),t=0|S(),u=u+1|0}while((0|u)!=(0|n))}}while(0);return i[r>>2]=((0|i[r>>2])+n|0)%6|0,i[(p=a)>>2]=e,i[p+4>>2]=t,0|(p=0)}function B(e,t,n,r){n|=0,r|=0;var a,o,s,u=0,l=0;for(s=N,N=N+16|0,a=s,o=s+8|0,u=(u=0==(0|je(e|=0,t|=0)))?1:2;;){if(i[o>>2]=0,0==(0|U(e,t,u,o,a))&((0|i[(l=a)>>2])==(0|n)?(0|i[l+4>>2])==(0|r):0)){e=4;break}if((u=u+1|0)>>>0>=7){u=7,e=4;break}}return 4==(0|e)?(N=s,0|u):0}function F(e,t,n,r,o,s,u){t|=0,n|=0,r|=0,o|=0,s|=0,u|=0;var l,c,h,f,d,p,A,v,m,g,y=0,_=0,b=0,x=0,w=0,T=0,E=0,k=0,M=0,C=0,R=0,P=0,I=0,L=0,D=0,O=0,U=0,B=0,F=0;if(g=N,N=N+64|0,A=g+48|0,v=g+32|0,m=g+24|0,l=g+8|0,c=g,(0|(_=0|i[(e|=0)>>2]))<=0)return N=g,0|(D=0);for(h=e+4|0,f=A+8|0,d=v+8|0,p=l+8|0,y=0,I=0;;){P=(b=0|i[h>>2])+(I<<4)|0,i[A>>2]=i[P>>2],i[A+4>>2]=i[P+4>>2],i[A+8>>2]=i[P+8>>2],i[A+12>>2]=i[P+12>>2],(0|I)==(_+-1|0)?(i[v>>2]=i[b>>2],i[v+4>>2]=i[b+4>>2],i[v+8>>2]=i[b+8>>2],i[v+12>>2]=i[b+12>>2]):(P=b+(I+1<<4)|0,i[v>>2]=i[P>>2],i[v+4>>2]=i[P+4>>2],i[v+8>>2]=i[P+8>>2],i[v+12>>2]=i[P+12>>2]),_=0|te(A,v,r,m);e:do{if(_)b=0,y=_;else if(b=0|i[(_=m)>>2],(0|(_=0|i[_+4>>2]))>0|0==(0|_)&b>>>0>0){R=0,P=0;t:for(;;){if(U=1/(+(b>>>0)+4294967296*+(0|_)),F=+a[A>>3],B=+((_=0|Jt(0|b,0|_,0|R,0|P))>>>0)+4294967296*+(0|S()),O=+(R>>>0)+4294967296*+(0|P),a[l>>3]=U*(F*B)+U*(+a[v>>3]*O),a[p>>3]=U*(+a[f>>3]*B)+U*(+a[d>>3]*O),0|(_=0|Je(l,r,c))){y=_;break}T=0|an(0|(M=0|i[(C=c)>>2]),0|(C=0|i[C+4>>2]),0|t,0|n),x=0|S(),b=0|i[(w=_=u+(T<<3)|0)>>2],w=0|i[w+4>>2];n:do{if(0==(0|b)&0==(0|w))L=_,D=16;else for(E=0,k=0;;){if((0|E)>(0|n)|(0|E)==(0|n)&k>>>0>t>>>0){y=1;break t}if((0|b)==(0|M)&(0|w)==(0|C))break n;if(T=0|rn(0|(_=0|Zt(0|T,0|x,1,0)),0|S(),0|t,0|n),x=0|S(),k=0|Zt(0|k,0|E,1,0),E=0|S(),0==(0|(b=0|i[(w=_=u+(T<<3)|0)>>2]))&0==(0|(w=0|i[w+4>>2]))){L=_,D=16;break}}}while(0);if(16!=(0|D)||(D=0,0==(0|M)&0==(0|C))||(i[(k=L)>>2]=M,i[k+4>>2]=C,k=s+(i[o>>2]<<3)|0,i[k>>2]=M,i[k+4>>2]=C,k=0|Zt(0|i[(k=o)>>2],0|i[k+4>>2],1,0),M=0|S(),i[(C=o)>>2]=k,i[C+4>>2]=M),R=0|Zt(0|R,0|P,1,0),P=0|S(),b=0|i[(_=m)>>2],!((0|(_=0|i[_+4>>2]))>(0|P)|(0|_)==(0|P)&b>>>0>R>>>0)){b=1;break e}}b=0}else b=1}while(0);if(I=I+1|0,!b){D=21;break}if((0|I)>=(0|(_=0|i[e>>2]))){y=0,D=21;break}}return 21==(0|D)?(N=g,0|y):0}function z(e){return(e|=0)>>>0>121?0|(e=0):0|(e=0|i[7696+(28*e|0)+16>>2])}function V(e){return 4==(0|(e|=0))|117==(0|e)|0}function q(e){return 0|i[11120+(216*(0|i[(e|=0)>>2])|0)+(72*(0|i[e+4>>2])|0)+(24*(0|i[e+8>>2])|0)+(i[e+12>>2]<<3)>>2]}function j(e){return 0|i[11120+(216*(0|i[(e|=0)>>2])|0)+(72*(0|i[e+4>>2])|0)+(24*(0|i[e+8>>2])|0)+(i[e+12>>2]<<3)+4>>2]}function G(e,t){return t|=0,(0|i[7696+(28*(e|=0)|0)+20>>2])==(0|t)?0|(t=1):0|(t=(0|i[7696+(28*e|0)+24>>2])==(0|t))}function H(e,t){return 0|i[848+(28*(e|=0)|0)+((t|=0)<<2)>>2]}function W(e,t){return t|=0,(0|i[848+(28*(e|=0)|0)>>2])==(0|t)?0|(t=0):(0|i[848+(28*e|0)+4>>2])==(0|t)?0|(t=1):(0|i[848+(28*e|0)+8>>2])==(0|t)?0|(t=2):(0|i[848+(28*e|0)+12>>2])==(0|t)?0|(t=3):(0|i[848+(28*e|0)+16>>2])==(0|t)?0|(t=4):(0|i[848+(28*e|0)+20>>2])==(0|t)?0|(t=5):0|((0|i[848+(28*e|0)+24>>2])==(0|t)?6:7)}function X(e){var t,n,r;return t=(r=+a[(e|=0)+16>>3])-(n=+a[e+24>>3]),+(r<n?t+6.283185307179586:t)}function Q(e){return+a[(e|=0)+16>>3]<+a[e+24>>3]|0}function Y(e){return+(+a[(e|=0)>>3]-+a[e+8>>3])}function K(e,t){e|=0;var n,r,i=0;return(i=+a[(t|=0)>>3])>=+a[e+8>>3]&&i<=+a[e>>3]?(n=+a[e+16>>3],i=+a[e+24>>3],t=(r=+a[t+8>>3])>=i,e=r<=n&1,n<i?t&&(e=1):t||(e=0),0|(t=0!=(0|e))):0|(t=0)}function Z(e,t){t|=0;var n,r,i,o,s,u=0,l=0,c=0,h=0;return+a[(e|=0)>>3]<+a[t+8>>3]||+a[e+8>>3]>+a[t>>3]?0|(u=0):(i=(l=+a[e+16>>3])<(h=+a[(n=e+24|0)>>3]),c=(s=+a[(u=t+16|0)>>3])<(o=+a[(r=t+24|0)>>3]),t=h-s<o-l,e=i?c|t?1:2:0,t=c?i?1:t?2:1:0,(l=+lt(l,e))<+lt(+a[r>>3],t)||(h=+lt(+a[n>>3],e))>+lt(+a[u>>3],t)?0|(c=0):0|(c=1))}function J(e,t){t|=0;var n,r,i,o,s,u=0,l=0,c=0,h=0;return+a[(e|=0)>>3]<+a[t>>3]||+a[e+8>>3]>+a[t+8>>3]?0|(u=0):(i=(o=+a[(u=e+16|0)>>3])<(l=+a[e+24>>3]),c=(h=+a[(n=t+16|0)>>3])<(s=+a[(r=t+24|0)>>3]),t=l-h<s-o,e=i?c|t?1:2:0,t=c?i?1:t?2:1:0,(l=+lt(l,e))<=+lt(+a[r>>3],t)?0|(c=(h=+lt(+a[u>>3],e))>=+lt(+a[n>>3],t)):0|(c=0))}function $(e,t){e|=0,t|=0;var n,r,o,s,u,l=0;o=N,N=N+176|0,i[(r=o)>>2]=4,l=+a[t>>3],a[r+8>>3]=l,s=+a[t+16>>3],a[r+16>>3]=s,a[r+24>>3]=l,l=+a[t+24>>3],a[r+32>>3]=l,u=+a[t+8>>3],a[r+40>>3]=u,a[r+48>>3]=l,a[r+56>>3]=u,a[r+64>>3]=s,n=(t=r+72|0)+96|0;do{i[t>>2]=0,t=t+4|0}while((0|t)<(0|n));dn(0|e,0|r,168),N=o}function ee(e,t,n){e|=0,t|=0,n|=0;var r,s,c,h,f,d,p,A=0,v=0,m=0,g=0,_=0,x=0,w=0;d=N,N=N+288|0,f=d+264|0,g=d+96|0,v=(A=m=d)+96|0;do{i[A>>2]=0,A=A+4|0}while((0|A)<(0|v));return 0|(t=0|rt(t,m))?(N=d,0|(x=t)):(tt(m=0|i[(v=m)>>2],v=0|i[v+4>>2],f),nt(m,v,g),h=+ct(f,g+8|0),a[f>>3]=+a[e>>3],a[(v=f+8|0)>>3]=+a[e+16>>3],a[g>>3]=+a[e+8>>3],a[(m=g+8|0)>>3]=+a[e+24>>3],s=+ct(f,g),w=+a[v>>3]-+a[m>>3],c=+l(+w),p=+a[f>>3]-+a[g>>3],r=+l(+p),0==w|0==p||(w=+cn(+c,+r),w=+y(+s*s/+hn(+w/+hn(+c,+r),3)/(h*(2.59807621135*h)*.8)),a[o>>3]=w,_=~~w>>>0,x=+l(w)>=1?w>0?~~+b(+u(w/4294967296),4294967295)>>>0:~~+y((w-+(~~w>>>0))/4294967296)>>>0:0,2146435072==(2146435072&i[o+4>>2]|0))?t=1:(g=0==(0|_)&0==(0|x),i[(t=n)>>2]=g?1:_,i[t+4>>2]=g?0:x,t=0),N=d,0|(x=t))}function te(e,t,n,r){e|=0,t|=0,n|=0,r|=0;var s,c,h,f,d=0,p=0,A=0;f=N,N=N+288|0,c=f+264|0,h=f+96|0,s=(d=p=f)+96|0;do{i[d>>2]=0,d=d+4|0}while((0|d)<(0|s));return 0|(n=0|rt(n,p))?(N=f,0|(r=n)):(tt(d=0|i[(n=p)>>2],n=0|i[n+4>>2],c),nt(d,n,h),A=+ct(c,h+8|0),A=+y(+ +ct(e,t)/(2*A)),a[o>>3]=A,n=~~A>>>0,d=+l(A)>=1?A>0?~~+b(+u(A/4294967296),4294967295)>>>0:~~+y((A-+(~~A>>>0))/4294967296)>>>0:0,2146435072==(2146435072&i[o+4>>2]|0)?(N=f,0|(r=1)):(p=0==(0|n)&0==(0|d),i[r>>2]=p?1:n,i[r+4>>2]=p?0:d,N=f,0|(r=0)))}function ne(e,t,n,r){t|=0,n|=0,r|=0,i[(e|=0)>>2]=t,i[e+4>>2]=n,i[e+8>>2]=r}function re(e,t){e|=0;var n,r,o,s,u=0,c=0,h=0,f=0,d=0,p=0,A=0;i[(s=(t|=0)+8|0)>>2]=0,r=+a[e>>3],f=+l(+r),o=+a[e+8>>3],f+=.5*(d=1.1547005383792515*+l(+o)),f-=+(0|(u=~~f)),d-=+(0|(e=~~d));do{if(f<.5){if(f<.3333333333333333){if(i[t>>2]=u,d<.5*(f+1)){i[t+4>>2]=e;break}e=e+1|0,i[t+4>>2]=e;break}if(e=(1&!(d<(A=1-f)))+e|0,i[t+4>>2]=e,A<=d&d<2*f){u=u+1|0,i[t>>2]=u;break}i[t>>2]=u;break}if(!(f<.6666666666666666)){if(u=u+1|0,i[t>>2]=u,d<.5*f){i[t+4>>2]=e;break}e=e+1|0,i[t+4>>2]=e;break}if(d<1-f){if(i[t+4>>2]=e,2*f-1<d){i[t>>2]=u;break}}else e=e+1|0,i[t+4>>2]=e;u=u+1|0,i[t>>2]=u}while(0);do{if(r<0){if(1&e){u=~~(+(0|u)-(2*(+((p=0|Jt(0|u,((0|u)<0)<<31>>31|0,0|(p=(e+1|0)/2|0),((0|p)<0)<<31>>31|0))>>>0)+4294967296*+(0|S()))+1)),i[t>>2]=u;break}u=~~(+(0|u)-2*(+((p=0|Jt(0|u,((0|u)<0)<<31>>31|0,0|(p=(0|e)/2|0),((0|p)<0)<<31>>31|0))>>>0)+4294967296*+(0|S()))),i[t>>2]=u;break}}while(0);p=t+4|0,o<0&&(u=u-((1|e<<1)/2|0)|0,i[t>>2]=u,e=0-e|0,i[p>>2]=e),c=e-u|0,(0|u)<0?(h=0-u|0,i[p>>2]=c,i[s>>2]=h,i[t>>2]=0,e=c,u=0):h=0,(0|e)<0&&(u=u-e|0,i[t>>2]=u,h=h-e|0,i[s>>2]=h,i[p>>2]=0,e=0),n=u-h|0,c=e-h|0,(0|h)<0&&(i[t>>2]=n,i[p>>2]=c,i[s>>2]=0,e=c,u=n,h=0),(0|(c=(0|h)<(0|(c=(0|e)<(0|u)?e:u))?h:c))<=0||(i[t>>2]=u-c,i[p>>2]=e-c,i[s>>2]=h-c)}function ie(e){var t,n=0,r=0,a=0,o=0,s=0;n=0|i[(e|=0)>>2],r=0|i[(t=e+4|0)>>2],(0|n)<0&&(r=r-n|0,i[t>>2]=r,i[(s=e+8|0)>>2]=(0|i[s>>2])-n,i[e>>2]=0,n=0),(0|r)<0?(n=n-r|0,i[e>>2]=n,o=(0|i[(s=e+8|0)>>2])-r|0,i[s>>2]=o,i[t>>2]=0,r=0):(s=o=e+8|0,o=0|i[o>>2]),(0|o)<0&&(n=n-o|0,i[e>>2]=n,r=r-o|0,i[t>>2]=r,i[s>>2]=0,o=0),(0|(a=(0|o)<(0|(a=(0|r)<(0|n)?r:n))?o:a))<=0||(i[e>>2]=n-a,i[t>>2]=r-a,i[s>>2]=o-a)}function ae(e,t){t|=0;var n,r;r=0|i[(e|=0)+8>>2],n=+((0|i[e+4>>2])-r|0),a[t>>3]=+((0|i[e>>2])-r|0)-.5*n,a[t+8>>3]=.8660254037844386*n}function oe(e,t,n){e|=0,t|=0,i[(n|=0)>>2]=(0|i[t>>2])+(0|i[e>>2]),i[n+4>>2]=(0|i[t+4>>2])+(0|i[e+4>>2]),i[n+8>>2]=(0|i[t+8>>2])+(0|i[e+8>>2])}function se(e,t,n){e|=0,t|=0,i[(n|=0)>>2]=(0|i[e>>2])-(0|i[t>>2]),i[n+4>>2]=(0|i[e+4>>2])-(0|i[t+4>>2]),i[n+8>>2]=(0|i[e+8>>2])-(0|i[t+8>>2])}function ue(e,t){t|=0;var n,r=0;r=0|_(0|i[(e|=0)>>2],t),i[e>>2]=r,n=0|_(0|i[(r=e+4|0)>>2],t),i[r>>2]=n,t=0|_(0|i[(e=e+8|0)>>2],t),i[e>>2]=t}function le(e){var t,n,r=0,a=0,o=0,s=0,u=0;u=(0|(n=0|i[(e|=0)>>2]))<0,e=(e=(a=(0|(s=((t=(0|(o=(0|i[e+4>>2])-(u?n:0)|0))<0)?0-o|0:0)+((0|i[e+8>>2])-(u?n:0))|0))<0)?0:s)-((o=(0|(a=(0|e)<(0|(a=(0|(r=(t?0:o)-(a?s:0)|0))<(0|(s=(u?0:n)-(t?o:0)-(a?s:0)|0))?r:s))?e:a))>0)?a:0)|0,r=r-(o?a:0)|0;e:do{switch(s-(o?a:0)|0){case 0:switch(0|r){case 0:return 0|(u=0==(0|e)?0:1==(0|e)?1:7);case 1:return 0|(u=0==(0|e)?2:1==(0|e)?3:7);default:break e}case 1:switch(0|r){case 0:return 0|(u=0==(0|e)?4:1==(0|e)?5:7);case 1:if(e)break e;return 0|(e=6);default:break e}}}while(0);return 0|(u=7)}function ce(e){var t,n,r=0,a=0,o=0,s=0,u=0,l=0,c=0;if(l=0|i[(n=(e|=0)+8|0)>>2],(t=(0|i[e>>2])-l|0)>>>0>715827881|(l=(0|i[(c=e+4|0)>>2])-l|0)>>>0>715827881){if(s=2147483647-t|0,u=-2147483648-t|0,(o=(0|t)>0)?(0|s)<(0|t):(0|u)>(0|t))return 0|(c=1);if(a=t<<1,o?(2147483647-a|0)<(0|t):(-2147483648-a|0)>(0|t))return 0|(c=1);if((0|l)>0?(2147483647-l|0)<(0|l):(-2147483648-l|0)>(0|l))return 0|(c=1);if(r=3*t|0,a=l<<1,(o?(0|s)<(0|a):(0|u)>(0|a))||((0|t)>-1?(-2147483648|r|0)>=(0|l):(-2147483648^r|0)<(0|l)))return 0|(c=1)}else a=l<<1,r=3*t|0;return o=0|Xt(.14285714285714285*+(r-l|0)),i[e>>2]=o,s=0|Xt(.14285714285714285*+(a+t|0)),i[c>>2]=s,i[n>>2]=0,r=(a=(0|s)<(0|o))?o:s,(0|(a=a?s:o))<0&&((-2147483648==(0|a)||((0|r)>0?(2147483647-r|0)<(0|a):(-2147483648-r|0)>(0|a)))&&E(27795,26892,354,26903),((0|r)>-1?(-2147483648|r|0)>=(0|a):(-2147483648^r|0)<(0|a))&&E(27795,26892,354,26903)),r=s-o|0,(0|o)<0?(a=0-o|0,i[c>>2]=r,i[n>>2]=a,i[e>>2]=0,o=0):(r=s,a=0),(0|r)<0&&(o=o-r|0,i[e>>2]=o,a=a-r|0,i[n>>2]=a,i[c>>2]=0,r=0),u=o-a|0,s=r-a|0,(0|a)<0?(i[e>>2]=u,i[c>>2]=s,i[n>>2]=0,r=s,s=u,a=0):s=o,(0|(o=(0|a)<(0|(o=(0|r)<(0|s)?r:s))?a:o))<=0||(i[e>>2]=s-o,i[c>>2]=r-o,i[n>>2]=a-o),0|(c=0)}function he(e){var t,n=0,r=0,a=0,o=0,s=0,u=0,l=0;if(o=0|i[(t=(e|=0)+8|0)>>2],(s=(0|i[e>>2])-o|0)>>>0>715827881|(o=(0|i[(u=e+4|0)>>2])-o|0)>>>0>715827881){if((r=(0|s)>0)?(2147483647-s|0)<(0|s):(-2147483648-s|0)>(0|s))return 0|(u=1);if(n=s<<1,(a=(0|o)>0)?(2147483647-o|0)<(0|o):(-2147483648-o|0)>(0|o))return 0|(u=1);if(l=o<<1,a?(2147483647-l|0)<(0|o):(-2147483648-l|0)>(0|o))return 0|(l=1);if(r?(2147483647-n|0)<(0|o):(-2147483648-n|0)>(0|o))return 0|(l=1);if(r=3*o|0,(0|o)>-1?(-2147483648|r|0)>=(0|s):(-2147483648^r|0)<(0|s))return 0|(l=1)}else r=3*o|0,n=s<<1;return a=0|Xt(.14285714285714285*+(n+o|0)),i[e>>2]=a,o=0|Xt(.14285714285714285*+(r-s|0)),i[u>>2]=o,i[t>>2]=0,n=(r=(0|o)<(0|a))?a:o,(0|(r=r?o:a))<0&&((-2147483648==(0|r)||((0|n)>0?(2147483647-n|0)<(0|r):(-2147483648-n|0)>(0|r)))&&E(27795,26892,402,26917),((0|n)>-1?(-2147483648|n|0)>=(0|r):(-2147483648^n|0)<(0|r))&&E(27795,26892,402,26917)),n=o-a|0,(0|a)<0?(r=0-a|0,i[u>>2]=n,i[t>>2]=r,i[e>>2]=0,a=0):(n=o,r=0),(0|n)<0&&(a=a-n|0,i[e>>2]=a,r=r-n|0,i[t>>2]=r,i[u>>2]=0,n=0),s=a-r|0,o=n-r|0,(0|r)<0?(i[e>>2]=s,i[u>>2]=o,i[t>>2]=0,n=o,o=s,r=0):o=a,(0|(a=(0|r)<(0|(a=(0|n)<(0|o)?n:o))?r:a))<=0||(i[e>>2]=o-a,i[u>>2]=n-a,i[t>>2]=r-a),0|(l=0)}function fe(e){var t,n,r=0,a=0,o=0,s=0,u=0;a=0|i[(t=(e|=0)+8|0)>>2],o=0|Xt(.14285714285714285*+((3*(r=(0|i[e>>2])-a|0)|0)-(a=(0|i[(n=e+4|0)>>2])-a|0)|0)),i[e>>2]=o,r=0|Xt(.14285714285714285*+((a<<1)+r|0)),i[n>>2]=r,i[t>>2]=0,a=r-o|0,(0|o)<0?(u=0-o|0,i[n>>2]=a,i[t>>2]=u,i[e>>2]=0,r=a,o=0,a=u):a=0,(0|r)<0&&(o=o-r|0,i[e>>2]=o,a=a-r|0,i[t>>2]=a,i[n>>2]=0,r=0),u=o-a|0,s=r-a|0,(0|a)<0?(i[e>>2]=u,i[n>>2]=s,i[t>>2]=0,r=s,s=u,a=0):s=o,(0|(o=(0|a)<(0|(o=(0|r)<(0|s)?r:s))?a:o))<=0||(i[e>>2]=s-o,i[n>>2]=r-o,i[t>>2]=a-o)}function de(e){var t,n,r=0,a=0,o=0,s=0,u=0;a=0|i[(t=(e|=0)+8|0)>>2],o=0|Xt(.14285714285714285*+(((r=(0|i[e>>2])-a|0)<<1)+(a=(0|i[(n=e+4|0)>>2])-a|0)|0)),i[e>>2]=o,r=0|Xt(.14285714285714285*+((3*a|0)-r|0)),i[n>>2]=r,i[t>>2]=0,a=r-o|0,(0|o)<0?(u=0-o|0,i[n>>2]=a,i[t>>2]=u,i[e>>2]=0,r=a,o=0,a=u):a=0,(0|r)<0&&(o=o-r|0,i[e>>2]=o,a=a-r|0,i[t>>2]=a,i[n>>2]=0,r=0),u=o-a|0,s=r-a|0,(0|a)<0?(i[e>>2]=u,i[n>>2]=s,i[t>>2]=0,r=s,s=u,a=0):s=o,(0|(o=(0|a)<(0|(o=(0|r)<(0|s)?r:s))?a:o))<=0||(i[e>>2]=s-o,i[n>>2]=r-o,i[t>>2]=a-o)}function pe(e){var t,n,r,a=0,o=0,s=0,u=0;a=0|i[(e|=0)>>2],o=0|i[(n=e+4|0)>>2],s=0|i[(r=e+8|0)>>2],u=o+(3*a|0)|0,i[e>>2]=u,o=s+(3*o|0)|0,i[n>>2]=o,a=(3*s|0)+a|0,i[r>>2]=a,s=o-u|0,(0|u)<0?(a=a-u|0,i[n>>2]=s,i[r>>2]=a,i[e>>2]=0,o=s,s=0):s=u,(0|o)<0&&(s=s-o|0,i[e>>2]=s,a=a-o|0,i[r>>2]=a,i[n>>2]=0,o=0),t=s-a|0,u=o-a|0,(0|a)<0?(i[e>>2]=t,i[n>>2]=u,i[r>>2]=0,s=t,a=0):u=o,(0|(o=(0|a)<(0|(o=(0|u)<(0|s)?u:s))?a:o))<=0||(i[e>>2]=s-o,i[n>>2]=u-o,i[r>>2]=a-o)}function Ae(e){var t,n,r,a=0,o=0,s=0,u=0;u=0|i[(e|=0)>>2],s=(3*(a=0|i[(n=e+4|0)>>2])|0)+u|0,u=(o=0|i[(r=e+8|0)>>2])+(3*u|0)|0,i[e>>2]=u,i[n>>2]=s,a=(3*o|0)+a|0,i[r>>2]=a,o=s-u|0,(0|u)<0?(a=a-u|0,i[n>>2]=o,i[r>>2]=a,i[e>>2]=0,u=0):o=s,(0|o)<0&&(u=u-o|0,i[e>>2]=u,a=a-o|0,i[r>>2]=a,i[n>>2]=0,o=0),t=u-a|0,s=o-a|0,(0|a)<0?(i[e>>2]=t,i[n>>2]=s,i[r>>2]=0,u=t,a=0):s=o,(0|(o=(0|a)<(0|(o=(0|s)<(0|u)?s:u))?a:o))<=0||(i[e>>2]=u-o,i[n>>2]=s-o,i[r>>2]=a-o)}function ve(e,t){e|=0;var n,r,a,o=0,s=0,u=0;((t|=0)+-1|0)>>>0>=6||(u=(0|i[15440+(12*t|0)>>2])+(0|i[e>>2])|0,i[e>>2]=u,a=e+4|0,s=(0|i[15440+(12*t|0)+4>>2])+(0|i[a>>2])|0,i[a>>2]=s,r=e+8|0,t=(0|i[15440+(12*t|0)+8>>2])+(0|i[r>>2])|0,i[r>>2]=t,o=s-u|0,(0|u)<0?(t=t-u|0,i[a>>2]=o,i[r>>2]=t,i[e>>2]=0,s=0):(o=s,s=u),(0|o)<0&&(s=s-o|0,i[e>>2]=s,t=t-o|0,i[r>>2]=t,i[a>>2]=0,o=0),n=s-t|0,u=o-t|0,(0|t)<0?(i[e>>2]=n,i[a>>2]=u,i[r>>2]=0,s=n,t=0):u=o,(0|(o=(0|t)<(0|(o=(0|u)<(0|s)?u:s))?t:o))<=0||(i[e>>2]=s-o,i[a>>2]=u-o,i[r>>2]=t-o))}function me(e){var t,n,r,a=0,o=0,s=0,u=0;u=0|i[(e|=0)>>2],s=(a=0|i[(n=e+4|0)>>2])+u|0,u=(o=0|i[(r=e+8|0)>>2])+u|0,i[e>>2]=u,i[n>>2]=s,a=o+a|0,i[r>>2]=a,o=s-u|0,(0|u)<0?(a=a-u|0,i[n>>2]=o,i[r>>2]=a,i[e>>2]=0,s=0):(o=s,s=u),(0|o)<0&&(s=s-o|0,i[e>>2]=s,a=a-o|0,i[r>>2]=a,i[n>>2]=0,o=0),t=s-a|0,u=o-a|0,(0|a)<0?(i[e>>2]=t,i[n>>2]=u,i[r>>2]=0,s=t,a=0):u=o,(0|(o=(0|a)<(0|(o=(0|u)<(0|s)?u:s))?a:o))<=0||(i[e>>2]=s-o,i[n>>2]=u-o,i[r>>2]=a-o)}function ge(e){var t,n,r,a=0,o=0,s=0,u=0;a=0|i[(e|=0)>>2],s=0|i[(n=e+4|0)>>2],o=0|i[(r=e+8|0)>>2],u=s+a|0,i[e>>2]=u,s=o+s|0,i[n>>2]=s,a=o+a|0,i[r>>2]=a,o=s-u|0,(0|u)<0?(a=a-u|0,i[n>>2]=o,i[r>>2]=a,i[e>>2]=0,s=0):(o=s,s=u),(0|o)<0&&(s=s-o|0,i[e>>2]=s,a=a-o|0,i[r>>2]=a,i[n>>2]=0,o=0),t=s-a|0,u=o-a|0,(0|a)<0?(i[e>>2]=t,i[n>>2]=u,i[r>>2]=0,s=t,a=0):u=o,(0|(o=(0|a)<(0|(o=(0|u)<(0|s)?u:s))?a:o))<=0||(i[e>>2]=s-o,i[n>>2]=u-o,i[r>>2]=a-o)}function ye(e){switch(0|(e|=0)){case 1:e=5;break;case 5:e=4;break;case 4:e=6;break;case 6:e=2;break;case 2:e=3;break;case 3:e=1}return 0|e}function _e(e){switch(0|(e|=0)){case 1:e=3;break;case 3:e=2;break;case 2:e=6;break;case 6:e=4;break;case 4:e=5;break;case 5:e=1}return 0|e}function be(e){var t,n,r,a=0,o=0,s=0,u=0;a=0|i[(e|=0)>>2],o=0|i[(n=e+4|0)>>2],s=0|i[(r=e+8|0)>>2],u=o+(a<<1)|0,i[e>>2]=u,o=s+(o<<1)|0,i[n>>2]=o,a=(s<<1)+a|0,i[r>>2]=a,s=o-u|0,(0|u)<0?(a=a-u|0,i[n>>2]=s,i[r>>2]=a,i[e>>2]=0,o=s,s=0):s=u,(0|o)<0&&(s=s-o|0,i[e>>2]=s,a=a-o|0,i[r>>2]=a,i[n>>2]=0,o=0),t=s-a|0,u=o-a|0,(0|a)<0?(i[e>>2]=t,i[n>>2]=u,i[r>>2]=0,s=t,a=0):u=o,(0|(o=(0|a)<(0|(o=(0|u)<(0|s)?u:s))?a:o))<=0||(i[e>>2]=s-o,i[n>>2]=u-o,i[r>>2]=a-o)}function xe(e){var t,n,r,a=0,o=0,s=0,u=0;u=0|i[(e|=0)>>2],s=((a=0|i[(n=e+4|0)>>2])<<1)+u|0,u=(o=0|i[(r=e+8|0)>>2])+(u<<1)|0,i[e>>2]=u,i[n>>2]=s,a=(o<<1)+a|0,i[r>>2]=a,o=s-u|0,(0|u)<0?(a=a-u|0,i[n>>2]=o,i[r>>2]=a,i[e>>2]=0,u=0):o=s,(0|o)<0&&(u=u-o|0,i[e>>2]=u,a=a-o|0,i[r>>2]=a,i[n>>2]=0,o=0),t=u-a|0,s=o-a|0,(0|a)<0?(i[e>>2]=t,i[n>>2]=s,i[r>>2]=0,u=t,a=0):s=o,(0|(o=(0|a)<(0|(o=(0|s)<(0|u)?s:u))?a:o))<=0||(i[e>>2]=u-o,i[n>>2]=s-o,i[r>>2]=a-o)}function we(e,t){t|=0;var n,r,a,o=0,s=0,u=0;return a=(0|(r=(0|i[(e|=0)>>2])-(0|i[t>>2])|0))<0,n=(0|(s=(0|i[e+4>>2])-(0|i[t+4>>2])-(a?r:0)|0))<0,t=(t=(e=(0|(u=(a?0-r|0:0)+(0|i[e+8>>2])-(0|i[t+8>>2])+(n?0-s|0:0)|0))<0)?0:u)-((s=(0|(e=(0|t)<(0|(e=(0|(o=(n?0:s)-(e?u:0)|0))<(0|(u=(a?0:r)-(n?s:0)-(e?u:0)|0))?o:u))?t:e))>0)?e:0)|0,o=o-(s?e:0)|0,0|((0|(e=(0|(e=u-(s?e:0)|0))>-1?e:0-e|0))>(0|(t=(0|(o=(0|o)>-1?o:0-o|0))>(0|(t=(0|t)>-1?t:0-t|0))?o:t))?e:t)}function Te(e,t){t|=0;var n;n=0|i[(e|=0)+8>>2],i[t>>2]=(0|i[e>>2])-n,i[t+4>>2]=(0|i[e+4>>2])-n}function Se(e,t){t|=0;var n,r,a,o=0,s=0,u=0;if(s=0|i[(e|=0)>>2],i[t>>2]=s,u=0|i[e+4>>2],i[(r=t+4|0)>>2]=u,i[(a=t+8|0)>>2]=0,e=(o=(0|u)<(0|s))?s:u,(0|(o=o?u:s))<0){if(-2147483648==(0|o)||((0|e)>0?(2147483647-e|0)<(0|o):(-2147483648-e|0)>(0|o)))return 0|(t=1);if((0|e)>-1?(-2147483648|e|0)>=(0|o):(-2147483648^e|0)<(0|o))return 0|(t=1)}return e=u-s|0,(0|s)<0?(o=0-s|0,i[r>>2]=e,i[a>>2]=o,i[t>>2]=0,s=0):(e=u,o=0),(0|e)<0&&(s=s-e|0,i[t>>2]=s,o=o-e|0,i[a>>2]=o,i[r>>2]=0,e=0),n=s-o|0,u=e-o|0,(0|o)<0?(i[t>>2]=n,i[r>>2]=u,i[a>>2]=0,e=u,u=n,o=0):u=s,(0|(s=(0|o)<(0|(s=(0|e)<(0|u)?e:u))?o:s))<=0||(i[t>>2]=u-s,i[r>>2]=e-s,i[a>>2]=o-s),0|(t=0)}function Ee(e){var t,n,r,a;n=(a=0|i[(t=(e|=0)+8|0)>>2])-(0|i[e>>2])|0,i[e>>2]=n,e=(0|i[(r=e+4|0)>>2])-a|0,i[r>>2]=e,i[t>>2]=0-(e+n)}function ke(e){var t,n,r=0,a=0,o=0,s=0,u=0;r=0-(a=0|i[(e|=0)>>2])|0,i[e>>2]=r,i[(t=e+8|0)>>2]=0,s=(o=0|i[(n=e+4|0)>>2])+a|0,(0|a)>0?(i[n>>2]=s,i[t>>2]=a,i[e>>2]=0,r=0,o=s):a=0,(0|o)<0?(u=r-o|0,i[e>>2]=u,a=a-o|0,i[t>>2]=a,i[n>>2]=0,s=u-a|0,r=0-a|0,(0|a)<0?(i[e>>2]=s,i[n>>2]=r,i[t>>2]=0,o=r,a=0):(o=0,s=u)):s=r,(0|(r=(0|a)<(0|(r=(0|o)<(0|s)?o:s))?a:r))<=0||(i[e>>2]=s-r,i[n>>2]=o-r,i[t>>2]=a-r)}function Me(e,t,n){n|=0;var r,a,o=0,s=0;return a=N,N=N+16|0,r=a,s=-2130706433&(t|=0)|134217728,!0&268435456==(2013265920&t|0)?(o=0|sn(0|(e|=0),0|t,56),S(),o=0|function(e,t,n){e|=0,t|=0,n|=0;var r=0,a=0,o=0;if(o=N,N=N+16|0,a=o,r=0|je(e,t),(n+-1|0)>>>0>5)return N=o,0|(a=-1);if(r=0!=(0|r),1==(0|n)&r)return N=o,0|(a=-1);do{if(!(0|Bt(e,t,a))){if(r){r=(5+(0|i[26352+(n<<2)>>2])-(0|i[a>>2])|0)%5|0;break}r=(6+(0|i[26384+(n<<2)>>2])-(0|i[a>>2])|0)%6|0;break}r=-1}while(0);return a=r,N=o,0|a}(e,s,7&o),-1==(0|o)?(i[n>>2]=0,N=a,0|(s=6)):(0|et(e,s,r)&&E(27795,26932,282,26947),t=0|sn(0|e,0|t,52),S(),t&=15,0|je(e,s)?Ne(r,t,o,2,n):Oe(r,t,o,2,n),N=a,0|(s=0))):(N=a,0|(s=6))}function Ce(e,t,n,r){t|=0,r|=0;var o,s=0,u=0,l=0,c=0;if(o=N,N=N+16|0,function(e,t,n){e|=0,t|=0,n|=0;var r=0,o=0,s=0;s=N,N=N+32|0,o=s,function(e,t){e|=0,t|=0;var n=0,r=0,i=0;n=+a[e>>3],r=+f(+n),n=+d(+n),a[t+16>>3]=n,n=+a[e+8>>3],i=r*+f(+n),a[t>>3]=i,n=r*+d(+n),a[t+8>>3]=n}(e,o),i[t>>2]=0,a[n>>3]=5,r=+Ut(16400,o),r<+a[n>>3]&&(i[t>>2]=0,a[n>>3]=r);r=+Ut(16424,o),r<+a[n>>3]&&(i[t>>2]=1,a[n>>3]=r);r=+Ut(16448,o),r<+a[n>>3]&&(i[t>>2]=2,a[n>>3]=r);r=+Ut(16472,o),r<+a[n>>3]&&(i[t>>2]=3,a[n>>3]=r);r=+Ut(16496,o),r<+a[n>>3]&&(i[t>>2]=4,a[n>>3]=r);r=+Ut(16520,o),r<+a[n>>3]&&(i[t>>2]=5,a[n>>3]=r);r=+Ut(16544,o),r<+a[n>>3]&&(i[t>>2]=6,a[n>>3]=r);r=+Ut(16568,o),r<+a[n>>3]&&(i[t>>2]=7,a[n>>3]=r);r=+Ut(16592,o),r<+a[n>>3]&&(i[t>>2]=8,a[n>>3]=r);r=+Ut(16616,o),r<+a[n>>3]&&(i[t>>2]=9,a[n>>3]=r);r=+Ut(16640,o),r<+a[n>>3]&&(i[t>>2]=10,a[n>>3]=r);r=+Ut(16664,o),r<+a[n>>3]&&(i[t>>2]=11,a[n>>3]=r);r=+Ut(16688,o),r<+a[n>>3]&&(i[t>>2]=12,a[n>>3]=r);r=+Ut(16712,o),r<+a[n>>3]&&(i[t>>2]=13,a[n>>3]=r);r=+Ut(16736,o),r<+a[n>>3]&&(i[t>>2]=14,a[n>>3]=r);r=+Ut(16760,o),r<+a[n>>3]&&(i[t>>2]=15,a[n>>3]=r);r=+Ut(16784,o),r<+a[n>>3]&&(i[t>>2]=16,a[n>>3]=r);r=+Ut(16808,o),r<+a[n>>3]&&(i[t>>2]=17,a[n>>3]=r);r=+Ut(16832,o),r<+a[n>>3]&&(i[t>>2]=18,a[n>>3]=r);if(r=+Ut(16856,o),!(r<+a[n>>3]))return void(N=s);i[t>>2]=19,a[n>>3]=r,N=s}(e|=0,n|=0,c=o),(u=+A(+(1-.5*+a[c>>3])))<1e-16)return i[r>>2]=0,i[r+4>>2]=0,i[r+8>>2]=0,i[r+12>>2]=0,void(N=o);if(c=0|i[n>>2],s=+st((s=+a[15920+(24*c|0)>>3])-+st(+function(e,t){e|=0,t|=0;var n=0,r=0,i=0,o=0,s=0;return o=+a[t>>3],r=+f(+o),i=+a[t+8>>3]-+a[e+8>>3],s=r*+d(+i),n=+a[e>>3],+ +g(+s,+(+d(+o)*+f(+n)-+f(+i)*(r*+d(+n))))}(15600+(c<<4)|0,e))),l=0|Ze(t)?+st(s+-.3334731722518321):s,s=2.618033988749896*+p(+u),(0|t)>0){e=0;do{s*=2.6457513110645907,e=e+1|0}while((0|e)!=(0|t))}u=+f(+l)*s,a[r>>3]=u,l=+d(+l)*s,a[r+8>>3]=l,N=o}function Re(e,t,n,r,o){t|=0,n|=0,r|=0,o|=0;var s,u=0,h=0;if(u=+function(e){e|=0;var t=0,n=0;return n=+a[e>>3],t=+a[e+8>>3],+ +c(+(n*n+t*t))}(e|=0),u<1e-16)return t=15600+(t<<4)|0,i[o>>2]=i[t>>2],i[o+4>>2]=i[t+4>>2],i[o+8>>2]=i[t+8>>2],void(i[o+12>>2]=i[t+12>>2]);if(h=+g(+ +a[e+8>>3],+ +a[e>>3]),(0|n)>0){e=0;do{u*=.37796447300922725,e=e+1|0}while((0|e)!=(0|n))}s=.3333333333333333*u,r?(n=0==(0|Ze(n)),u=+m(.381966011250105*(n?s:.37796447300922725*s))):(u=+m(.381966011250105*u),0|Ze(n)&&(h=+st(h+.3334731722518321))),function(e,t,n,r){e|=0,t=+t,n=+n,r|=0;var o=0,s=0,u=0,c=0;if(n<1e-16)return i[r>>2]=i[e>>2],i[r+4>>2]=i[e+4>>2],i[r+8>>2]=i[e+8>>2],void(i[r+12>>2]=i[e+12>>2]);s=t<0?t+6.283185307179586:t,s=t>=6.283185307179586?s+-6.283185307179586:s;do{if(!(s<1e-16)){if(o=+l(+(s+-3.141592653589793))<1e-16,t=+a[e>>3],o){t-=n,a[r>>3]=t,o=r;break}if(u=+f(+n),n=+d(+n),t=u*+d(+t)+ +f(+s)*(n*+f(+t)),t=+v(+((t=t>1?1:t)<-1?-1:t)),a[r>>3]=t,+l(+(t+-1.5707963267948966))<1e-16)return a[r>>3]=1.5707963267948966,void(a[r+8>>3]=0);if(+l(+(t+1.5707963267948966))<1e-16)return a[r>>3]=-1.5707963267948966,void(a[r+8>>3]=0);if(c=1/+f(+t),s=n*+d(+s)*c,n=+a[e>>3],t=c*((u-+d(+t)*+d(+n))/+f(+n)),u=s>1?1:s,t=t>1?1:t,(t=+a[e+8>>3]+ +g(+(u<-1?-1:u),+(t<-1?-1:t)))>3.141592653589793)do{t+=-6.283185307179586}while(t>3.141592653589793);if(t<-3.141592653589793)do{t+=6.283185307179586}while(t<-3.141592653589793);return void(a[r+8>>3]=t)}t=+a[e>>3]+n,a[r>>3]=t,o=r}while(0);if(+l(+(t+-1.5707963267948966))<1e-16)return a[o>>3]=1.5707963267948966,void(a[r+8>>3]=0);if(+l(+(t+1.5707963267948966))<1e-16)return a[o>>3]=-1.5707963267948966,void(a[r+8>>3]=0);if(t=+a[e+8>>3],t>3.141592653589793)do{t+=-6.283185307179586}while(t>3.141592653589793);if(t<-3.141592653589793)do{t+=6.283185307179586}while(t<-3.141592653589793);a[r+8>>3]=t}(15600+(t<<4)|0,+st(+a[15920+(24*t|0)>>3]-h),u,o)}function Pe(e,t,n){t|=0,n|=0;var r,a;r=N,N=N+16|0,ae((e|=0)+4|0,a=r),Re(a,0|i[e>>2],t,0,n),N=r}function Ne(e,t,n,r,o){e|=0,t|=0,n|=0,r|=0,o|=0;var s,u,l,c,h,f,d,p,A,v,m,g,y,_,b,x,w,T,S,k,M,C,R=0,P=0,I=0,L=0,D=0,O=0;if(C=N,N=N+272|0,L=C+240|0,S=C,k=C+224|0,M=C+208|0,m=C+176|0,g=C+160|0,y=C+192|0,_=C+144|0,b=C+128|0,x=C+112|0,w=C+96|0,T=C+80|0,i[(R=C+256|0)>>2]=t,i[L>>2]=i[e>>2],i[L+4>>2]=i[e+4>>2],i[L+8>>2]=i[e+8>>2],i[L+12>>2]=i[e+12>>2],Ie(L,R,S),i[o>>2]=0,(0|(L=r+n+(5==(0|r)&1)|0))<=(0|n))N=C;else{u=k+4|0,l=m+4|0,c=n+5|0,h=16880+((s=0|i[R>>2])<<2)|0,f=16960+(s<<2)|0,d=b+8|0,p=x+8|0,A=w+8|0,v=M+4|0,I=n;e:for(;;){P=S+(((0|I)%5|0)<<4)|0,i[M>>2]=i[P>>2],i[M+4>>2]=i[P+4>>2],i[M+8>>2]=i[P+8>>2],i[M+12>>2]=i[P+12>>2];do{}while(2==(0|Le(M,s,0,1)));if((0|I)>(0|n)&0!=(0|Ze(t))){if(i[m>>2]=i[M>>2],i[m+4>>2]=i[M+4>>2],i[m+8>>2]=i[M+8>>2],i[m+12>>2]=i[M+12>>2],ae(u,g),r=0|i[m>>2],R=0|i[17040+(80*r|0)+(i[k>>2]<<2)>>2],i[m>>2]=i[18640+(80*r|0)+(20*R|0)>>2],(0|(P=0|i[18640+(80*r|0)+(20*R|0)+16>>2]))>0){e=0;do{me(l),e=e+1|0}while((0|e)<(0|P))}switch(P=18640+(80*r|0)+(20*R|0)+4|0,i[y>>2]=i[P>>2],i[y+4>>2]=i[P+4>>2],i[y+8>>2]=i[P+8>>2],ue(y,3*(0|i[h>>2])|0),oe(l,y,l),ie(l),ae(l,_),D=+(0|i[f>>2]),a[b>>3]=3*D,a[d>>3]=0,O=-1.5*D,a[x>>3]=O,a[p>>3]=2.598076211353316*D,a[w>>3]=O,a[A>>3]=-2.598076211353316*D,0|i[17040+(80*(0|i[m>>2])|0)+(i[M>>2]<<2)>>2]){case 1:e=x,r=b;break;case 3:e=w,r=x;break;case 2:e=b,r=w;break;default:e=12;break e}Dt(g,_,r,e,T),Re(T,0|i[m>>2],s,1,o+8+(i[o>>2]<<4)|0),i[o>>2]=1+(0|i[o>>2])}if((0|I)<(0|c)&&(ae(v,m),Re(m,0|i[M>>2],s,1,o+8+(i[o>>2]<<4)|0),i[o>>2]=1+(0|i[o>>2])),i[k>>2]=i[M>>2],i[k+4>>2]=i[M+4>>2],i[k+8>>2]=i[M+8>>2],i[k+12>>2]=i[M+12>>2],(0|(I=I+1|0))>=(0|L)){e=3;break}}3!=(0|e)?12==(0|e)&&E(26970,27017,572,27027):N=C}}function Ie(e,t,n){e|=0,t|=0,n|=0;var r,a=0,o=0,s=0,u=0,l=0;r=N,N=N+128|0,o=r,u=20240,l=(s=a=r+64|0)+60|0;do{i[s>>2]=i[u>>2],s=s+4|0,u=u+4|0}while((0|s)<(0|l));u=20304,l=(s=o)+60|0;do{i[s>>2]=i[u>>2],s=s+4|0,u=u+4|0}while((0|s)<(0|l));a=(l=0==(0|Ze(0|i[t>>2])))?a:o,be(o=e+4|0),xe(o),0|Ze(0|i[t>>2])&&(Ae(o),i[t>>2]=1+(0|i[t>>2])),i[n>>2]=i[e>>2],oe(o,a,t=n+4|0),ie(t),i[n+16>>2]=i[e>>2],oe(o,a+12|0,t=n+20|0),ie(t),i[n+32>>2]=i[e>>2],oe(o,a+24|0,t=n+36|0),ie(t),i[n+48>>2]=i[e>>2],oe(o,a+36|0,t=n+52|0),ie(t),i[n+64>>2]=i[e>>2],oe(o,a+48|0,n=n+68|0),ie(n),N=r}function Le(e,t,n,r){n|=0,r|=0;var a,o,s,u,l,c,h=0,f=0,d=0,p=0,A=0;if(c=N,N=N+32|0,l=c+12|0,o=c,A=(e|=0)+4|0,p=0|i[16960+((t|=0)<<2)>>2],p=(u=0!=(0|r))?3*p|0:p,h=0|i[A>>2],a=0|i[(s=e+8|0)>>2],u){if((0|(h=a+h+(r=0|i[(f=e+12|0)>>2])|0))==(0|p))return N=c,0|(A=1);d=f}else h=a+h+(r=0|i[(d=e+12|0)>>2])|0;if((0|h)<=(0|p))return N=c,0|(A=0);do{if((0|r)>0){if(r=0|i[e>>2],(0|a)>0){f=18640+(80*r|0)+60|0,r=e;break}r=18640+(80*r|0)+40|0,n?(ne(l,p,0,0),se(A,l,o),ge(o),oe(o,l,A),f=r,r=e):(f=r,r=e)}else f=18640+(80*(0|i[e>>2])|0)+20|0,r=e}while(0);if(i[r>>2]=i[f>>2],(0|i[(h=f+16|0)>>2])>0){r=0;do{me(A),r=r+1|0}while((0|r)<(0|i[h>>2]))}return e=f+4|0,i[l>>2]=i[e>>2],i[l+4>>2]=i[e+4>>2],i[l+8>>2]=i[e+8>>2],t=0|i[16880+(t<<2)>>2],ue(l,u?3*t|0:t),oe(A,l,A),ie(A),r=u&&((0|i[s>>2])+(0|i[A>>2])+(0|i[d>>2])|0)==(0|p)?1:2,N=c,0|(A=r)}function De(e,t){e|=0,t|=0;var n=0;do{n=0|Le(e,t,0,1)}while(2==(0|n));return 0|n}function Oe(e,t,n,r,o){e|=0,t|=0,n|=0,r|=0,o|=0;var s,u,l,c,h,f,d,p,A,v,m,g,y,_,b,x,w,T,S=0,k=0,M=0,C=0,R=0;if(T=N,N=N+240|0,_=T+208|0,b=T,x=T+192|0,w=T+176|0,A=T+160|0,v=T+144|0,m=T+128|0,g=T+112|0,y=T+96|0,i[(S=T+224|0)>>2]=t,i[_>>2]=i[e>>2],i[_+4>>2]=i[e+4>>2],i[_+8>>2]=i[e+8>>2],i[_+12>>2]=i[e+12>>2],Ue(_,S,b),i[o>>2]=0,(0|(p=r+n+(6==(0|r)&1)|0))<=(0|n))N=T;else{u=n+6|0,l=16960+((s=0|i[S>>2])<<2)|0,c=v+8|0,h=m+8|0,f=g+8|0,d=x+4|0,k=0,M=n,r=-1;e:for(;;){if(e=b+((S=(0|M)%6|0)<<4)|0,i[x>>2]=i[e>>2],i[x+4>>2]=i[e+4>>2],i[x+8>>2]=i[e+8>>2],i[x+12>>2]=i[e+12>>2],e=k,k=0|Le(x,s,0,1),(0|M)>(0|n)&0!=(0|Ze(t))&&(1!=(0|e)&&(0|i[x>>2])!=(0|r))){switch(ae(b+(((S+5|0)%6|0)<<4)+4|0,w),ae(b+(S<<4)+4|0,A),C=+(0|i[l>>2]),a[v>>3]=3*C,a[c>>3]=0,R=-1.5*C,a[m>>3]=R,a[h>>3]=2.598076211353316*C,a[g>>3]=R,a[f>>3]=-2.598076211353316*C,S=0|i[_>>2],0|i[17040+(80*S|0)+(((0|r)==(0|S)?0|i[x>>2]:r)<<2)>>2]){case 1:e=m,r=v;break;case 3:e=g,r=m;break;case 2:e=v,r=g;break;default:e=8;break e}Dt(w,A,r,e,y),0|Ot(w,y)||0|Ot(A,y)||(Re(y,0|i[_>>2],s,1,o+8+(i[o>>2]<<4)|0),i[o>>2]=1+(0|i[o>>2]))}if((0|M)<(0|u)&&(ae(d,w),Re(w,0|i[x>>2],s,1,o+8+(i[o>>2]<<4)|0),i[o>>2]=1+(0|i[o>>2])),(0|(M=M+1|0))>=(0|p)){e=3;break}r=0|i[x>>2]}3!=(0|e)?8==(0|e)&&E(27054,27017,737,27099):N=T}}function Ue(e,t,n){e|=0,t|=0,n|=0;var r,a=0,o=0,s=0,u=0,l=0;r=N,N=N+160|0,o=r,u=20368,l=(s=a=r+80|0)+72|0;do{i[s>>2]=i[u>>2],s=s+4|0,u=u+4|0}while((0|s)<(0|l));u=20448,l=(s=o)+72|0;do{i[s>>2]=i[u>>2],s=s+4|0,u=u+4|0}while((0|s)<(0|l));a=(l=0==(0|Ze(0|i[t>>2])))?a:o,be(o=e+4|0),xe(o),0|Ze(0|i[t>>2])&&(Ae(o),i[t>>2]=1+(0|i[t>>2])),i[n>>2]=i[e>>2],oe(o,a,t=n+4|0),ie(t),i[n+16>>2]=i[e>>2],oe(o,a+12|0,t=n+20|0),ie(t),i[n+32>>2]=i[e>>2],oe(o,a+24|0,t=n+36|0),ie(t),i[n+48>>2]=i[e>>2],oe(o,a+36|0,t=n+52|0),ie(t),i[n+64>>2]=i[e>>2],oe(o,a+48|0,t=n+68|0),ie(t),i[n+80>>2]=i[e>>2],oe(o,a+60|0,n=n+84|0),ie(n),N=r}function Be(e,t){return t=0|sn(0|(e|=0),0|(t|=0),45),S(),127&t|0}function Fe(e,t){e|=0;var n=0,i=0,a=0,o=0;return!0&134217728==(-16777216&(t|=0)|0)?(i=0|sn(0|e,0|t,52),S(),i&=15,n=0|sn(0|e,0|t,45),S(),(n&=127)>>>0>121?0|(e=0):0==(613566756&(o=0|un(0|(a=0|sn(0|e,0|t,0|(o=3*(15^i)|0))),0|S(),0|o))&(0|Jt(-1227133514,-1171,0|o,0|(a=0|S())))|0)&0==(4681&a&(0|S())|0)&&15==(0|i)|0==(0|(o=0|sn(0|(0|un(0|~e,0|~t,0|(o=19+(3*i|0)|0))),0|S(),0|o)))&0==(0|S())?0|r[20528+n>>0]?0==(0|e)&0==(0|(t&=8191))?0|(o=1):(o=0|ln(0|e,0|t,0),S(),0!=(0|(63-o|0)%3)|0):0|(o=1):0|(o=0)):0|(e=0)}function ze(e,t,n,r){e|=0,n|=0,r|=0;var a=0,o=0,s=0,u=0;if(a=0|un(0|(t|=0),0,52),o=0|S(),n=0|un(0|n,0,45),n=0|o|S()|134225919,(0|t)<1)return o=-1,r=n,i[(t=e)>>2]=o,void(i[(e=e+4|0)>>2]=r);for(o=1,a=-1;u=0|un(7,0,0|(s=3*(15-o|0)|0)),n&=~(0|S()),a=a&~u|(s=0|un(0|r,0,0|s)),n=0|n|S(),(0|o)!=(0|t);)o=o+1|0;i[(s=u=e)>>2]=a,i[(u=u+4|0)>>2]=n}function Ve(e,t,n,r){n|=0,r|=0;var a=0,o=0;if(o=0|sn(0|(e|=0),0|(t|=0),52),S(),n>>>0>15)return 0|(r=4);if((0|(o&=15))<(0|n))return 0|(r=12);if((0|o)==(0|n))return i[r>>2]=e,i[r+4>>2]=t,0|(r=0);if(a=0|un(0|n,0,52),a|=e,e=0|S()|-15728641&t,(0|o)>(0|n))do{t=0|un(7,0,3*(14-n|0)|0),n=n+1|0,a|=t,e=0|S()|e}while((0|n)<(0|o));return i[r>>2]=a,i[r+4>>2]=e,0|(r=0)}function qe(e,t,n,r){n|=0,r|=0;var a=0,o=0,s=0;if(o=0|sn(0|(e|=0),0|(t|=0),52),S(),!((0|n)<16&(0|(o&=15))<=(0|n)))return 0|(r=4);a=n-o|0,n=0|sn(0|e,0|t,45),S();e:do{if(0|z(127&n)){t:do{if(0|o){for(n=1;0==((s=0|un(7,0,3*(15-n|0)|0))&e|0)&0==((0|S())&t|0);){if(!(n>>>0<o>>>0))break t;n=n+1|0}n=0|xt(7,0,a,((0|a)<0)<<31>>31),a=0|S();break e}}while(0);n=0|Zt(0|(n=0|nn(0|(n=0|xt(7,0,a,((0|a)<0)<<31>>31)),0|S(),5,0)),0|S(),-5,-1),n=0|Zt(0|(n=0|tn(0|n,0|S(),6,0)),0|S(),1,0),a=0|S()}else n=0|xt(7,0,a,((0|a)<0)<<31>>31),a=0|S()}while(0);return i[(s=r)>>2]=n,i[s+4>>2]=a,0|(s=0)}function je(e,t){var n=0,r=0,i=0;if(i=0|sn(0|(e|=0),0|(t|=0),45),S(),!(0|z(127&i)))return 0|(i=0);i=0|sn(0|e,0|t,52),S(),i&=15;e:do{if(i)for(r=1;;){if(n=0|sn(0|e,0|t,3*(15-r|0)|0),S(),0|(n&=7))break e;if(!(r>>>0<i>>>0)){n=0;break}r=r+1|0}else n=0}while(0);return 0|(i=0==(0|n)&1)}function Ge(e,t,n,r){return e|=0,t|=0,(0|(r|=0))<(0|(n|=0))?(r=e,T(0|(n=t)),0|r):(n=0|un(-1,-1,3+(3*(r-n|0)|0)|0),r=0|un(0|~n,0|~(0|S()),3*(15-r|0)|0),n=~(0|S())&t,r=~r&e,T(0|n),0|r)}function He(e,t,n,r){n|=0,r|=0;var a=0;return a=0|sn(0|(e|=0),0|(t|=0),52),S(),(0|n)<16&(0|(a&=15))<=(0|n)?((0|a)<(0|n)&&(a=0|un(-1,-1,3+(3*(n+-1-a|0)|0)|0),a=0|un(0|~a,0|~(0|S()),3*(15-n|0)|0),t=~(0|S())&t,e&=~a),a=0|un(0|n,0,52),n=-15728641&t|0|S(),i[r>>2]=e|a,i[r+4>>2]=n,0|(r=0)):0|(r=4)}function We(e,t){var n=0,r=0,i=0;if(i=0|sn(0|(e|=0),0|(t|=0),52),S(),!(i&=15))return 0|(i=0);for(r=1;;){if(n=0|sn(0|e,0|t,3*(15-r|0)|0),S(),0|(n&=7)){r=5;break}if(!(r>>>0<i>>>0)){n=0,r=5;break}r=r+1|0}return 5==(0|r)?0|n:0}function Xe(e,t){var n=0,r=0,i=0,a=0,o=0,s=0,u=0;if(u=0|sn(0|(e|=0),0|(t|=0),52),S(),!(u&=15))return u=e,T(0|(s=t)),0|u;for(s=1,n=0;;){r=0|un(7,0,0|(a=3*(15-s|0)|0)),i=0|S(),o=0|sn(0|e,0|t,0|a),S(),e=(a=0|un(0|ye(7&o),0,0|a))|e&~r,t=(o=0|S())|t&~i;e:do{if(!n)if(0==(a&r|0)&0==(o&i|0))n=0;else if(r=0|sn(0|e,0|t,52),S(),r&=15){n=1;t:for(;;){switch(o=0|sn(0|e,0|t,3*(15-n|0)|0),S(),7&o){case 1:break t;case 0:break;default:n=1;break e}if(!(n>>>0<r>>>0)){n=1;break e}n=n+1|0}for(n=1;;){if(i=0|sn(0|e,0|t,0|(o=3*(15-n|0)|0)),S(),a=0|un(7,0,0|o),t&=~(0|S()),e=e&~a|(o=0|un(0|ye(7&i),0,0|o)),t=0|t|S(),!(n>>>0<r>>>0)){n=1;break}n=n+1|0}}else n=1}while(0);if(!(s>>>0<u>>>0))break;s=s+1|0}return T(0|t),0|e}function Qe(e,t){var n=0,r=0,i=0,a=0,o=0;if(r=0|sn(0|(e|=0),0|(t|=0),52),S(),!(r&=15))return r=e,T(0|(n=t)),0|r;for(n=1;o=0|sn(0|e,0|t,0|(a=3*(15-n|0)|0)),S(),i=0|un(7,0,0|a),t&=~(0|S()),e=(a=0|un(0|ye(7&o),0,0|a))|e&~i,t=0|S()|t,n>>>0<r>>>0;)n=n+1|0;return T(0|t),0|e}function Ye(e,t){var n=0,r=0,i=0,a=0,o=0,s=0,u=0;if(u=0|sn(0|(e|=0),0|(t|=0),52),S(),!(u&=15))return u=e,T(0|(s=t)),0|u;for(s=1,n=0;;){r=0|un(7,0,0|(a=3*(15-s|0)|0)),i=0|S(),o=0|sn(0|e,0|t,0|a),S(),e=(a=0|un(0|_e(7&o),0,0|a))|e&~r,t=(o=0|S())|t&~i;e:do{if(!n)if(0==(a&r|0)&0==(o&i|0))n=0;else if(r=0|sn(0|e,0|t,52),S(),r&=15){n=1;t:for(;;){switch(o=0|sn(0|e,0|t,3*(15-n|0)|0),S(),7&o){case 1:break t;case 0:break;default:n=1;break e}if(!(n>>>0<r>>>0)){n=1;break e}n=n+1|0}for(n=1;;){if(a=0|un(7,0,0|(i=3*(15-n|0)|0)),o=t&~(0|S()),t=0|sn(0|e,0|t,0|i),S(),e=e&~a|(t=0|un(0|_e(7&t),0,0|i)),t=0|o|S(),!(n>>>0<r>>>0)){n=1;break}n=n+1|0}}else n=1}while(0);if(!(s>>>0<u>>>0))break;s=s+1|0}return T(0|t),0|e}function Ke(e,t){var n=0,r=0,i=0,a=0,o=0;if(r=0|sn(0|(e|=0),0|(t|=0),52),S(),!(r&=15))return r=e,T(0|(n=t)),0|r;for(n=1;a=0|un(7,0,0|(o=3*(15-n|0)|0)),i=t&~(0|S()),t=0|sn(0|e,0|t,0|o),S(),e=(t=0|un(0|_e(7&t),0,0|o))|e&~a,t=0|S()|i,n>>>0<r>>>0;)n=n+1|0;return T(0|t),0|e}function Ze(e){return 0|(0|(e|=0))%2}function Je(e,t,n){n|=0;var r,a=0;return r=N,N=N+16|0,a=r,(t|=0)>>>0>15?(N=r,0|(a=4)):2146435072==(2146435072&i[(e|=0)+4>>2]|0)||2146435072==(2146435072&i[e+8+4>>2]|0)?(N=r,0|(a=3)):(function(e,t,n){var r,i;r=N,N=N+16|0,Ce(e|=0,t|=0,n|=0,i=r),re(i,n+4|0),N=r}(e,t,a),t=0|function(e,t){e|=0;var n,r=0,a=0,o=0,s=0,u=0,l=0,c=0,h=0;if(n=N,N=N+64|0,l=n+40|0,a=n+24|0,o=n+12|0,s=n,un(0|(t|=0),0,52),r=134225919|S(),!t)return(0|i[e+4>>2])>2||(0|i[e+8>>2])>2||(0|i[e+12>>2])>2?(l=0,T(0|(u=0)),N=n,0|l):(un(0|q(e),0,45),u=0|S()|r,l=-1,T(0|u),N=n,0|l);if(i[l>>2]=i[e>>2],i[l+4>>2]=i[e+4>>2],i[l+8>>2]=i[e+8>>2],i[l+12>>2]=i[e+12>>2],u=l+4|0,(0|t)>0)for(e=-1;i[a>>2]=i[u>>2],i[a+4>>2]=i[u+4>>2],i[a+8>>2]=i[u+8>>2],1&t?(fe(u),i[o>>2]=i[u>>2],i[o+4>>2]=i[u+4>>2],i[o+8>>2]=i[u+8>>2],pe(o)):(de(u),i[o>>2]=i[u>>2],i[o+4>>2]=i[u+4>>2],i[o+8>>2]=i[u+8>>2],Ae(o)),se(a,o,s),ie(s),c=0|un(7,0,0|(h=3*(15-t|0)|0)),r&=~(0|S()),e=(h=0|un(0|le(s),0,0|h))|e&~c,r=0|S()|r,(0|t)>1;)t=t+-1|0;else e=-1;e:do{if((0|i[u>>2])<=2&&(0|i[l+8>>2])<=2&&(0|i[l+12>>2])<=2){if(t=0|un(0|(a=0|q(l)),0,45),t|=e,e=0|S()|-1040385&r,s=0|j(l),!(0|z(a))){if((0|s)<=0)break;for(o=0;;){if(a=0|sn(0|t,0|e,52),S(),a&=15)for(r=1;l=0|sn(0|t,0|e,0|(h=3*(15-r|0)|0)),S(),c=0|un(7,0,0|h),e&=~(0|S()),t=t&~c|(h=0|un(0|ye(7&l),0,0|h)),e=0|e|S(),r>>>0<a>>>0;)r=r+1|0;if((0|(o=o+1|0))==(0|s))break e}}o=0|sn(0|t,0|e,52),S(),o&=15;t:do{if(o){r=1;n:for(;;){switch(h=0|sn(0|t,0|e,3*(15-r|0)|0),S(),7&h){case 1:break n;case 0:break;default:break t}if(!(r>>>0<o>>>0))break t;r=r+1|0}if(0|G(a,0|i[l>>2]))for(r=1;c=0|un(7,0,0|(l=3*(15-r|0)|0)),h=e&~(0|S()),e=0|sn(0|t,0|e,0|l),S(),t=t&~c|(e=0|un(0|_e(7&e),0,0|l)),e=0|h|S(),r>>>0<o>>>0;)r=r+1|0;else for(r=1;l=0|sn(0|t,0|e,0|(h=3*(15-r|0)|0)),S(),c=0|un(7,0,0|h),e&=~(0|S()),t=t&~c|(h=0|un(0|ye(7&l),0,0|h)),e=0|e|S(),r>>>0<o>>>0;)r=r+1|0}}while(0);if((0|s)>0){r=0;do{t=0|Xe(t,e),e=0|S(),r=r+1|0}while((0|r)!=(0|s))}}else t=0,e=0}while(0);return h=t,T(0|(c=e)),N=n,0|h}(a,t),a=0|S(),i[n>>2]=t,i[n+4>>2]=a,0==(0|t)&0==(0|a)&&E(27795,27122,959,27145),N=r,0|(a=0))}function $e(e,t,n){var r,a=0,o=0,s=0;if(r=(n|=0)+4|0,o=0|sn(0|(e|=0),0|(t|=0),52),S(),o&=15,s=0|sn(0|e,0|t,45),S(),a=0==(0|o),0|z(127&s)){if(a)return 0|(s=1);a=1}else{if(a)return 0|(s=0);a=0==(0|i[r>>2])&&0==(0|i[n+8>>2])?0!=(0|i[n+12>>2])&1:1}for(n=1;1&n?pe(r):Ae(r),s=0|sn(0|e,0|t,3*(15-n|0)|0),S(),ve(r,7&s),n>>>0<o>>>0;)n=n+1|0;return 0|a}function et(e,t,n){n|=0;var r,a,o=0,s=0,u=0,l=0,c=0,h=0;if(a=N,N=N+16|0,r=a,h=0|sn(0|(e|=0),0|(t|=0),45),S(),(h&=127)>>>0>121)return i[n>>2]=0,i[n+4>>2]=0,i[n+8>>2]=0,i[n+12>>2]=0,N=a,0|(h=5);e:do{if(0!=(0|z(h))&&(u=0|sn(0|e,0|t,52),S(),0!=(0|(u&=15)))){o=1;t:for(;;){switch(c=0|sn(0|e,0|t,3*(15-o|0)|0),S(),7&c){case 5:break t;case 0:break;default:o=t;break e}if(!(o>>>0<u>>>0)){o=t;break e}o=o+1|0}for(s=1,o=t;l=0|un(7,0,0|(t=3*(15-s|0)|0)),c=o&~(0|S()),o=0|sn(0|e,0|o,0|t),S(),e=e&~l|(o=0|un(0|_e(7&o),0,0|t)),o=0|c|S(),s>>>0<u>>>0;)s=s+1|0}else o=t}while(0);if(c=7696+(28*h|0)|0,i[n>>2]=i[c>>2],i[n+4>>2]=i[c+4>>2],i[n+8>>2]=i[c+8>>2],i[n+12>>2]=i[c+12>>2],!(0|$e(e,o,n)))return N=a,0|(h=0);if(l=n+4|0,i[r>>2]=i[l>>2],i[r+4>>2]=i[l+4>>2],i[r+8>>2]=i[l+8>>2],u=0|sn(0|e,0|o,52),S(),c=15&u,1&u?(Ae(l),u=c+1|0):u=c,0|z(h)){e:do{if(c)for(t=1;;){if(s=0|sn(0|e,0|o,3*(15-t|0)|0),S(),0|(s&=7)){o=s;break e}if(!(t>>>0<c>>>0)){o=0;break}t=t+1|0}else o=0}while(0);o=4==(0|o)&1}else o=0;if(0|Le(n,u,o,0)){if(0|z(h))do{}while(0!=(0|Le(n,u,0,0)));(0|u)!=(0|c)&&de(l)}else(0|u)!=(0|c)&&(i[l>>2]=i[r>>2],i[l+4>>2]=i[r+4>>2],i[l+8>>2]=i[r+8>>2]);return N=a,0|(h=0)}function tt(e,t,n){n|=0;var r,i,a=0;return i=N,N=N+16|0,0|(a=0|et(e|=0,t|=0,r=i))?(N=i,0|a):(a=0|sn(0|e,0|t,52),S(),Pe(r,15&a,n),N=i,0|(a=0))}function nt(e,t,n){n|=0;var r,i=0,a=0,o=0;if(r=N,N=N+16|0,0|(i=0|et(e|=0,t|=0,o=r)))return N=r,0|(o=i);i=0|sn(0|e,0|t,45),S(),i=0==(0|z(127&i)),a=0|sn(0|e,0|t,52),S(),a&=15;e:do{if(!i){if(0|a)for(i=1;;){if(!(0==((0|un(7,0,3*(15-i|0)|0))&e|0)&0==((0|S())&t|0)))break e;if(!(i>>>0<a>>>0))break;i=i+1|0}return Ne(o,a,0,5,n),N=r,0|0}}while(0);return Oe(o,a,0,6,n),N=r,0|0}function rt(e,t){t|=0;var n=0,r=0,a=0,o=0,s=0,u=0,l=0;if((e|=0)>>>0>15)return 0|(u=4);if(un(0|e,0,52),u=134225919|S(),!e){n=0,r=0;do{0|z(r)&&(un(0|r,0,45),s=0|u|S(),i[(e=t+(n<<3)|0)>>2]=-1,i[e+4>>2]=s,n=n+1|0),r=r+1|0}while(122!=(0|r));return 0|(n=0)}n=0,s=0;do{if(0|z(s)){for(un(0|s,0,45),r=1,a=-1,o=0|u|S();a&=~(l=0|un(7,0,3*(15-r|0)|0)),o&=~(0|S()),(0|r)!=(0|e);)r=r+1|0;i[(l=t+(n<<3)|0)>>2]=a,i[l+4>>2]=o,n=n+1|0}s=s+1|0}while(122!=(0|s));return 0|(n=0)}function it(e,t,n,r){e|=0,r|=0;var a=0,o=0,s=0;a=0|sn(0|(t|=0),0|(n|=0),52),S(),0==(0|t)&0==(0|n)|(0|r)>15|(0|(a&=15))>(0|r)?(o=-1,t=-1,n=0,a=0):(t=0|Ge(t,n,a+1|0,r),s=-15728641&(0|S()),n=0|un(0|r,0,52),o=a,t=(t=0==(0|je(n|=t,s=0|s|S())))?-1:r,a=s),i[(s=e)>>2]=n,i[s+4>>2]=a,i[e+8>>2]=o,i[e+12>>2]=t}function at(e,t,n,r){n|=0,r|=0;var a=0,o=0;return a=0|sn(0|(e|=0),0|(t|=0),52),S(),a&=15,i[(o=r+8|0)>>2]=a,0==(0|e)&0==(0|t)|(0|n)>15|(0|a)>(0|n)?(i[(n=r)>>2]=0,i[n+4>>2]=0,i[o>>2]=-1,void(i[r+12>>2]=-1)):(e=0|Ge(e,t,a+1|0,n),o=-15728641&(0|S()),a=0|un(0|n,0,52),a|=e,o=0|o|S(),i[(e=r)>>2]=a,i[e+4>>2]=o,e=r+12|0,0|je(a,o)?void(i[e>>2]=n):void(i[e>>2]=-1))}function ot(e){var t,n=0,r=0,a=0,o=0,s=0,u=0,l=0,c=0;if(!(0==(0|(n=0|i[(r=e|=0)>>2]))&0==(0|(r=0|i[r+4>>2])))&&(a=0|sn(0|n,0|r,52),S(),n=0|Zt(0|(l=0|un(1,0,3*(15^(a&=15))|0)),0|S(),0|n,0|r),r=0|S(),i[(l=e)>>2]=n,i[l+4>>2]=r,!((0|a)<(0|(u=0|i[(l=e+8|0)>>2]))))){for(t=e+12|0,s=a;;){if((0|s)==(0|u)){a=5;break}if(c=(0|s)==(0|i[t>>2]),a=0|sn(0|n,0|r,0|(o=3*(15-s|0)|0)),S(),c&1==(0|(a&=7))&!0){a=7;break}if(!(7==(0|a)&!0)){a=10;break}if(n=0|Zt(0|n,0|r,0|(c=0|un(1,0,0|o)),0|S()),r=0|S(),i[(c=e)>>2]=n,i[c+4>>2]=r,!((0|s)>(0|u))){a=10;break}s=s+-1|0}if(5==(0|a))return i[(c=e)>>2]=0,i[c+4>>2]=0,i[l>>2]=-1,void(i[t>>2]=-1);if(7==(0|a))return u=0|Zt(0|n,0|r,0|(u=0|un(1,0,0|o)),0|S()),l=0|S(),i[(c=e)>>2]=u,i[c+4>>2]=l,void(i[t>>2]=s+-1)}}function st(e){var t;return t=(e=+e)<0?e+6.283185307179586:e,+(e>=6.283185307179586?t+-6.283185307179586:t)}function ut(e,t){return t|=0,+l(+(+a[(e|=0)>>3]-+a[t>>3]))<17453292519943298e-27?0|(t=+l(+(+a[e+8>>3]-+a[t+8>>3]))<17453292519943298e-27):0|(t=0)}function lt(e,t){switch(e=+e,0|(t|=0)){case 1:e=e<0?e+6.283185307179586:e;break;case 2:e=e>0?e+-6.283185307179586:e}return+e}function ct(e,t){e|=0;var n,r,i,o=0;return r=+a[(t|=0)>>3],n=+a[e>>3],o=(i=+d(.5*(r-n)))*i+(o=+d(.5*(+a[t+8>>3]-+a[e+8>>3])))*(+f(+r)*+f(+n)*o),2*+g(+ +c(+o),+ +c(+(1-o)))*6371.007180918475}function ht(e,t){return t|=0,(e|=0)>>>0>15?0|(t=4):(a[t>>3]=+a[20656+(e<<3)>>3],0|(t=0))}function ft(e,t){t|=0;var n=0;return(e|=0)>>>0>15?0|(t=4):(n=0|nn(0|(n=0|xt(7,0,e,((0|e)<0)<<31>>31)),0|S(),120,0),e=0|S(),i[t>>2]=2|n,i[t+4>>2]=e,0|(t=0))}function dt(e,t,n){e|=0,n|=0;var r,i,o,s,u=0,l=0,h=0,A=0,v=0,y=0;return y=+a[(t|=0)>>3],o=+a[e>>3],v=+d(.5*(y-o)),h=+a[t+8>>3],i=+a[e+8>>3],A=+d(.5*(h-i)),r=+f(+o),s=+f(+y),A=2*+g(+ +c(+(A=v*v+A*(s*r*A))),+ +c(+(1-A))),v=+a[n>>3],y=+d(.5*(v-y)),u=+a[n+8>>3],h=+d(.5*(u-h)),l=+f(+v),h=2*+g(+ +c(+(h=y*y+h*(s*l*h))),+ +c(+(1-h))),v=+d(.5*(o-v)),u=+d(.5*(i-u)),u=2*+g(+ +c(+(u=v*v+u*(r*l*u))),+ +c(+(1-u))),4*+m(+ +c(+ +p(.5*(l=.5*(A+h+u)))*+p(.5*(l-A))*+p(.5*(l-h))*+p(.5*(l-u))))}function pt(e,t,n){n|=0;var r,o,s,u=0,l=0;if(s=N,N=N+192|0,o=s,0|(l=0|tt(e|=0,t|=0,r=s+168|0)))return N=s,0|(n=l);if(0|nt(e,t,o)&&E(27795,27190,415,27199),(0|(t=0|i[o>>2]))>0){if(u=+dt(o+8|0,o+8+((1!=(0|t)&1)<<4)|0,r)+0,1!=(0|t)){e=1;do{u+=+dt(o+8+((l=e)<<4)|0,o+8+(((0|(e=e+1|0))%(0|t)|0)<<4)|0,r)}while((0|e)<(0|t))}}else u=0;return a[n>>3]=u,N=s,0|(n=0)}function At(e){e|=0;var t,n,r=0;return(t=0|Kt(1,12))||E(27280,27235,49,27293),0|(r=0|i[(n=e+4|0)>>2])?(i[(r=r+8|0)>>2]=t,i[n>>2]=t,0|t):(0|i[e>>2]&&E(27310,27235,61,27333),i[(r=e)>>2]=t,i[n>>2]=t,0|t)}function vt(e,t){e|=0,t|=0;var n,r;return(r=0|Qt(24))||E(27347,27235,78,27361),i[r>>2]=i[t>>2],i[r+4>>2]=i[t+4>>2],i[r+8>>2]=i[t+8>>2],i[r+12>>2]=i[t+12>>2],i[r+16>>2]=0,0|(n=0|i[(t=e+4|0)>>2])?(i[n+16>>2]=r,i[t>>2]=r,0|r):(0|i[e>>2]&&E(27376,27235,82,27361),i[e>>2]=r,i[t>>2]=r,0|r)}function mt(e){var t=0,n=0,r=0,a=0;if(e|=0)for(r=1;;){if(0|(t=0|i[e>>2]))do{if(0|(n=0|i[t>>2]))do{a=n,n=0|i[n+16>>2],Yt(a)}while(0!=(0|n));a=t,t=0|i[t+8>>2],Yt(a)}while(0!=(0|t));if(t=e,e=0|i[e+8>>2],r||Yt(t),!e)break;r=0}}function gt(e){var t,n,r=0,o=0,s=0,u=0,c=0,h=0,f=0,d=0,p=0,A=0,v=0,m=0,g=0,y=0,_=0,b=0,x=0,w=0,T=0,S=0,k=0,M=0,C=0,R=0,P=0,N=0,I=0,L=0,D=0,O=0;if(0|i[(u=(e|=0)+8|0)>>2])return 0|(O=1);if(!(s=0|i[e>>2]))return 0|(O=0);r=s,o=0;do{o=o+1|0,r=0|i[r+8>>2]}while(0!=(0|r));if(o>>>0<2)return 0|(O=0);(n=0|Qt(o<<2))||E(27396,27235,317,27415),(t=0|Qt(o<<5))||E(27437,27235,321,27415),i[e>>2]=0,i[(M=e+4|0)>>2]=0,i[u>>2]=0,o=0,L=0,k=0,v=0;e:for(;;){if(A=0|i[s>>2]){c=0,h=A;do{if(d=+a[h+8>>3],r=h,h=0|i[h+16>>2],f=+a[(u=(p=0==(0|h))?A:h)+8>>3],+l(+(d-f))>3.141592653589793){O=14;break}c+=(f-d)*(+a[r>>3]+ +a[u>>3])}while(!p);if(14==(0|O)){O=0,c=0,r=A;do{S=+a[r+8>>3],N=0|i[(I=r+16|0)>>2],T=+a[(N=0==(0|N)?A:N)+8>>3],c+=(+a[r>>3]+ +a[N>>3])*((T<0?T+6.283185307179586:T)-(S<0?S+6.283185307179586:S)),r=0|i[(0==(0|r)?s:I)>>2]}while(0!=(0|r))}c>0?(i[n+(L<<2)>>2]=s,L=L+1|0,u=k,r=v):O=19}else O=19;if(19==(0|O)){O=0;do{if(!o){if(v){u=M,h=v+8|0,r=s,o=e;break}if(0|i[e>>2]){O=27;break e}u=M,h=e,r=s,o=e;break}if(0|i[(r=o+8|0)>>2]){O=21;break e}if(!(o=0|Kt(1,12))){O=23;break e}i[r>>2]=o,u=o+4|0,h=o,r=v}while(0);if(i[h>>2]=s,i[u>>2]=s,h=t+(k<<5)|0,p=0|i[s>>2]){for(a[(A=t+(k<<5)+8|0)>>3]=17976931348623157e292,a[(v=t+(k<<5)+24|0)>>3]=17976931348623157e292,a[h>>3]=-17976931348623157e292,a[(m=t+(k<<5)+16|0)>>3]=-17976931348623157e292,x=17976931348623157e292,w=-17976931348623157e292,u=0,g=p,d=17976931348623157e292,_=17976931348623157e292,b=-17976931348623157e292,f=-17976931348623157e292;c=+a[g>>3],S=+a[g+8>>3],g=0|i[g+16>>2],T=+a[((y=0==(0|g))?p:g)+8>>3],c<d&&(a[A>>3]=c,d=c),S<_&&(a[v>>3]=S,_=S),c>b?a[h>>3]=c:c=b,S>f&&(a[m>>3]=S,f=S),x=S>0&S<x?S:x,w=S<0&S>w?S:w,u|=+l(+(S-T))>3.141592653589793,!y;)b=c;u&&(a[m>>3]=w,a[v>>3]=x)}else i[h>>2]=0,i[h+4>>2]=0,i[h+8>>2]=0,i[h+12>>2]=0,i[h+16>>2]=0,i[h+20>>2]=0,i[h+24>>2]=0,i[h+28>>2]=0;u=k+1|0}if(s=0|i[(I=s+8|0)>>2],i[I>>2]=0,!s){O=45;break}k=u,v=r}if(21==(0|O))E(27213,27235,35,27247);else if(23==(0|O))E(27267,27235,37,27247);else if(27==(0|O))E(27310,27235,61,27333);else if(45==(0|O)){e:do{if((0|L)>0){for(I=0==(0|u),P=u<<2,N=0==(0|e),R=0,r=0;;){if(C=0|i[n+(R<<2)>>2],I)O=73;else{if(!(k=0|Qt(P))){O=50;break}if(!(M=0|Qt(P))){O=52;break}t:do{if(N)o=0;else{for(u=0,o=0,h=e;s=t+(u<<5)|0,0|yt(0|i[h>>2],s,0|i[C>>2])?(i[k+(o<<2)>>2]=h,i[M+(o<<2)>>2]=s,y=o+1|0):y=o,h=0|i[h+8>>2];)u=u+1|0,o=y;if((0|y)>0)if(s=0|i[k>>2],1==(0|y))o=s;else for(m=0,g=-1,o=s,v=s;;){for(p=0|i[v>>2],s=0,h=0;A=(0|(u=0|i[i[k+(h<<2)>>2]>>2]))==(0|p)?s:s+(1&(0|yt(u,0|i[M+(h<<2)>>2],0|i[p>>2])))|0,(0|(h=h+1|0))!=(0|y);)s=A;if(o=(u=(0|A)>(0|g))?v:o,(0|(s=m+1|0))==(0|y))break t;m=s,g=u?A:g,v=0|i[k+(s<<2)>>2]}else o=0}}while(0);if(Yt(k),Yt(M),o){if(s=0|i[(u=o+4|0)>>2])o=s+8|0;else if(0|i[o>>2]){O=70;break}i[o>>2]=C,i[u>>2]=C}else O=73}if(73==(0|O)){if(O=0,0|(r=0|i[C>>2]))do{M=r,r=0|i[r+16>>2],Yt(M)}while(0!=(0|r));Yt(C),r=1}if((0|(R=R+1|0))>=(0|L)){D=r;break e}}50==(0|O)?E(27452,27235,249,27471):52==(0|O)?E(27490,27235,252,27471):70==(0|O)&&E(27310,27235,61,27333)}else D=0}while(0);return Yt(n),Yt(t),0|(O=D)}return 0}function yt(e,t,n){e|=0;var r=0,o=0,s=0,u=0,l=0,c=0,h=0,f=0;if(!(0|K(t|=0,n|=0)))return 0|(e=0);if(t=0|Q(t),r=+a[n>>3],o=t&(o=+a[n+8>>3])<0?o+6.283185307179586:o,!(e=0|i[e>>2]))return 0|(e=0);if(t){t=0,h=o,n=e;e:for(;;){for(;u=+a[n>>3],o=+a[n+8>>3],f=0|i[(n=n+16|0)>>2],s=+a[(f=0==(0|f)?e:f)>>3],l=+a[f+8>>3],u>s?(c=u,u=l):(c=s,s=u,u=o,o=l),(r=r==s|r==c?r+2220446049250313e-31:r)<s|r>c;)if(!(n=0|i[n>>2])){n=22;break e}if(((c=(l=u<0?u+6.283185307179586:u)+(r-s)/(c-s)*((u=o<0?o+6.283185307179586:o)-l))<0?c+6.283185307179586:c)>(h=l==h|u==h?h+-2220446049250313e-31:h)&&(t^=1),!(n=0|i[n>>2])){n=22;break}}if(22==(0|n))return 0|t}else{t=0,h=o,n=e;e:for(;;){for(;u=+a[n>>3],o=+a[n+8>>3],f=0|i[(n=n+16|0)>>2],s=+a[(f=0==(0|f)?e:f)>>3],l=+a[f+8>>3],u>s?(c=u,u=l):(c=s,s=u,u=o,o=l),(r=r==s|r==c?r+2220446049250313e-31:r)<s|r>c;)if(!(n=0|i[n>>2])){n=22;break e}if(u+(r-s)/(c-s)*(o-u)>(h=u==h|o==h?h+-2220446049250313e-31:h)&&(t^=1),!(n=0|i[n>>2])){n=22;break}}if(22==(0|n))return 0|t}return 0}function _t(e,t,n,a,o){n|=0,a|=0,o|=0;var s,u,l,c,h=0,f=0,d=0,p=0,A=0,v=0,m=0,g=0,y=0,_=0;if(c=N,N=N+32|0,_=c+16|0,l=c,h=0|sn(0|(e|=0),0|(t|=0),52),S(),h&=15,m=0|sn(0|n,0|a,52),S(),(0|h)!=(15&m|0))return N=c,0|(_=12);if(A=0|sn(0|e,0|t,45),S(),A&=127,v=0|sn(0|n,0|a,45),S(),A>>>0>121|(v&=127)>>>0>121)return N=c,0|(_=5);if(m=(0|A)!=(0|v)){if(7==(0|(d=0|W(A,v))))return N=c,0|(_=1);7==(0|(p=0|W(v,A)))?E(27514,27538,161,27548):(g=d,f=p)}else g=0,f=0;s=0|z(A),u=0|z(v),i[_>>2]=0,i[_+4>>2]=0,i[_+8>>2]=0,i[_+12>>2]=0;do{if(g){if(d=(0|(v=0|i[4272+(28*A|0)+(g<<2)>>2]))>0,u)if(d){A=0,p=n,d=a;do{p=0|Ye(p,d),d=0|S(),1==(0|(f=0|_e(f)))&&(f=0|_e(1)),A=A+1|0}while((0|A)!=(0|v));v=f,A=p,p=d}else v=f,A=n,p=a;else if(d){A=0,p=n,d=a;do{p=0|Ke(p,d),d=0|S(),f=0|_e(f),A=A+1|0}while((0|A)!=(0|v));v=f,A=p,p=d}else v=f,A=n,p=a;if($e(A,p,_),m||E(27563,27538,191,27548),(d=0!=(0|s))&(f=0!=(0|u))&&E(27590,27538,192,27548),d){if(7==(0|(f=0|We(e,t)))){h=5;break}if(0|r[22e3+(7*f|0)+g>>0]){h=1;break}A=p=0|i[21168+(28*f|0)+(g<<2)>>2]}else if(f){if(7==(0|(f=0|We(A,p)))){h=5;break}if(0|r[22e3+(7*f|0)+v>>0]){h=1;break}A=0,p=0|i[21168+(28*v|0)+(f<<2)>>2]}else A=0,p=0;if((A|p|0)<0)h=5;else{if((0|p)>0){d=_+4|0,f=0;do{ge(d),f=f+1|0}while((0|f)!=(0|p))}if(i[l>>2]=0,i[l+4>>2]=0,i[l+8>>2]=0,ve(l,g),0|h)for(;0|Ze(h)?pe(l):Ae(l),(0|h)>1;)h=h+-1|0;if((0|A)>0){h=0;do{ge(l),h=h+1|0}while((0|h)!=(0|A))}oe(y=_+4|0,l,y),ie(y),y=51}}else if($e(n,a,_),0!=(0|s)&0!=(0|u))if((0|v)!=(0|A)&&E(27621,27538,261,27548),7==(0|(f=0|We(e,t)))|7==(0|(h=0|We(n,a))))h=5;else if(0|r[22e3+(7*f|0)+h>>0])h=1;else if((0|(f=0|i[21168+(28*f|0)+(h<<2)>>2]))>0){d=_+4|0,h=0;do{ge(d),h=h+1|0}while((0|h)!=(0|f));y=51}else y=51;else y=51}while(0);return 51==(0|y)&&(h=_+4|0,i[o>>2]=i[h>>2],i[o+4>>2]=i[h+4>>2],i[o+8>>2]=i[h+8>>2],h=0),N=c,0|(_=h)}function bt(e,t,n,r){n|=0,r|=0;var a,o,s,u=0,l=0,c=0,h=0,f=0,d=0,p=0,A=0,v=0,m=0,g=0,y=0,_=0;if(s=N,N=N+48|0,a=s+36|0,c=s+24|0,h=s+12|0,f=s,u=0|sn(0|(e|=0),0|(t|=0),52),S(),u&=15,p=0|sn(0|e,0|t,45),S(),(p&=127)>>>0>121)return N=s,0|(r=5);if(o=0|z(p),un(0|u,0,52),m=134225919|S(),i[(l=r)>>2]=-1,i[l+4>>2]=m,!u)return 7==(0|(u=0|le(n)))||127==(0|(u=0|H(p,u)))?(N=s,0|(m=1)):(A=0|un(0|u,0,45),v=0|S(),v=-1040385&i[(p=r)+4>>2]|v,i[(m=r)>>2]=i[p>>2]|A,i[m+4>>2]=v,N=s,0|(m=0));for(i[a>>2]=i[n>>2],i[a+4>>2]=i[n+4>>2],i[a+8>>2]=i[n+8>>2],n=u;;){if(l=n,n=n+-1|0,i[c>>2]=i[a>>2],i[c+4>>2]=i[a+4>>2],i[c+8>>2]=i[a+8>>2],0|Ze(l)){if(0|(u=0|ce(a))){n=13;break}i[h>>2]=i[a>>2],i[h+4>>2]=i[a+4>>2],i[h+8>>2]=i[a+8>>2],pe(h)}else{if(0|(u=0|he(a))){n=13;break}i[h>>2]=i[a>>2],i[h+4>>2]=i[a+4>>2],i[h+8>>2]=i[a+8>>2],Ae(h)}if(se(c,h,f),ie(f),y=0|i[(u=r)>>2],u=0|i[u+4>>2],g=0|un(7,0,0|(_=3*(15-l|0)|0)),u&=~(0|S()),_=0|un(0|le(f),0,0|_),u=0|S()|u,i[(m=r)>>2]=_|y&~g,i[m+4>>2]=u,(0|l)<=1){n=14;break}}e:do{if(13!=(0|n)&&14==(0|n))if((0|i[a>>2])<=1&&(0|i[a+4>>2])<=1&&(0|i[a+8>>2])<=1){f=127==(0|(u=0|H(p,n=0|le(a))))?0:0|z(u);t:do{if(n){if(o){if(7==(0|(u=0|We(e,t)))){u=5;break e}if((0|(l=0|i[21376+(28*u|0)+(n<<2)>>2]))>0){u=n,n=0;do{u=0|ye(u),n=n+1|0}while((0|n)!=(0|l))}else u=n;if(1==(0|u)){u=9;break e}127==(0|(n=0|H(p,u)))&&E(27648,27538,411,27678),0|z(n)?E(27693,27538,412,27678):(v=n,A=l,d=u)}else v=u,A=0,d=n;if((0|(h=0|i[4272+(28*p|0)+(d<<2)>>2]))<=-1&&E(27724,27538,419,27678),!f){if((0|A)<0){u=5;break e}if(0|A){u=0,n=0|i[(l=r)>>2],l=0|i[l+4>>2];do{n=0|Qe(n,l),l=0|S(),i[(_=r)>>2]=n,i[_+4>>2]=l,u=u+1|0}while((0|u)<(0|A))}if((0|h)<=0){u=v,n=58;break}for(u=0,n=0|i[(l=r)>>2],l=0|i[l+4>>2];;)if(n=0|Qe(n,l),l=0|S(),i[(_=r)>>2]=n,i[_+4>>2]=l,(0|(u=u+1|0))==(0|h)){u=v,n=58;break t}}if(7==(0|(c=0|W(v,p)))&&E(27514,27538,428,27678),n=0|i[(u=r)>>2],u=0|i[u+4>>2],(0|h)>0){l=0;do{n=0|Qe(n,u),u=0|S(),i[(_=r)>>2]=n,i[_+4>>2]=u,l=l+1|0}while((0|l)!=(0|h))}if(7==(0|(u=0|We(n,u)))&&E(27795,27538,440,27678),n=0|V(v),(0|(n=0|i[(n?21792:21584)+(28*c|0)+(u<<2)>>2]))<0&&E(27795,27538,454,27678),n){u=0,l=0|i[(c=r)>>2],c=0|i[c+4>>2];do{l=0|Xe(l,c),c=0|S(),i[(_=r)>>2]=l,i[_+4>>2]=c,u=u+1|0}while((0|u)<(0|n));u=v,n=58}else u=v,n=58}else if(0!=(0|o)&0!=(0|f)){if(7==(0|(n=0|We(e,t)))|7==(0|(l=0|We(0|i[(l=r)>>2],0|i[l+4>>2])))){u=5;break e}if((0|(l=0|i[21376+(28*n|0)+(l<<2)>>2]))<0){u=5;break e}if(l){n=0,c=0|i[(h=r)>>2],h=0|i[h+4>>2];do{c=0|Qe(c,h),h=0|S(),i[(_=r)>>2]=c,i[_+4>>2]=h,n=n+1|0}while((0|n)<(0|l));n=58}else n=59}else n=58}while(0);if(58==(0|n)&&f&&(n=59),59==(0|n)&&1==(0|We(0|i[(_=r)>>2],0|i[_+4>>2]))){u=9;break}g=0|i[(_=r)>>2],_=-1040385&i[_+4>>2],y=0|un(0|u,0,45),_=0|_|S(),i[(u=r)>>2]=g|y,i[u+4>>2]=_,u=0}else u=1}while(0);return N=s,0|(_=u)}function xt(e,t,n,r){e|=0,t|=0;var i=0,a=0,o=0;if(0==(0|(n|=0))&0==(0|(r|=0)))return a=1,T(0|(i=0)),0|a;a=e,i=t,e=1,t=0;do{e=0|nn(0|((o=0==(1&n|0)&!0)?1:a),0|(o?0:i),0|e,0|t),t=0|S(),n=0|on(0|n,0|r,1),r=0|S(),a=0|nn(0|a,0|i,0|a,0|i),i=0|S()}while(!(0==(0|n)&0==(0|r)));return T(0|t),0|e}function wt(e,t,n,r){n|=0,r|=0;var o,s=0,u=0,l=0,c=0,h=0,d=0;o=N,N=N+16|0,u=o,l=0|sn(0|(e|=0),0|(t|=0),52),S(),l&=15;do{if(l){if(!(s=0|tt(e,t,u))){h=+a[u>>3],c=1/+f(+h),d=+a[25968+(l<<3)>>3],a[n>>3]=h+d,a[n+8>>3]=h-d,h=+a[u+8>>3],c*=d,a[n+16>>3]=c+h,a[n+24>>3]=h-c;break}return N=o,0|(l=s)}if(s=0|sn(0|e,0|t,45),S(),(s&=127)>>>0>121)return N=o,0|(l=5);u=22064+(s<<5)|0,i[n>>2]=i[u>>2],i[n+4>>2]=i[u+4>>2],i[n+8>>2]=i[u+8>>2],i[n+12>>2]=i[u+12>>2],i[n+16>>2]=i[u+16>>2],i[n+20>>2]=i[u+20>>2],i[n+24>>2]=i[u+24>>2],i[n+28>>2]=i[u+28>>2];break}while(0);return function(e,t){t=+t;var n,r,i,o,s,u,l,c=0,h=0;c=(o=+a[(i=16+(e|=0)|0)>>3])-(r=+a[(n=e+24|0)>>3]),c=o<r?c+6.283185307179586:c,h=+a[e>>3],c=.5*(c*t-c),h+=t=.5*((l=h-(u=+a[(s=e+8|0)>>3]))*t-l),a[e>>3]=h>1.5707963267948966?1.5707963267948966:h,t=u-t,a[s>>3]=t<-1.5707963267948966?-1.5707963267948966:t,t=(t=o+c)>3.141592653589793?t+-6.283185307179586:t,a[i>>3]=t<-3.141592653589793?t+6.283185307179586:t,t=(t=r-c)>3.141592653589793?t+-6.283185307179586:t,a[n>>3]=t<-3.141592653589793?t+6.283185307179586:t}(n,r?1.4:1.1),(0|i[(r=26096+(l<<3)|0)>>2])==(0|e)&&(0|i[r+4>>2])==(0|t)&&(a[n>>3]=1.5707963267948966),(0|i[(l=26224+(l<<3)|0)>>2])==(0|e)&&(0|i[l+4>>2])==(0|t)&&(a[n+8>>3]=-1.5707963267948966),1.5707963267948966!=+a[n>>3]&&-1.5707963267948966!=+a[n+8>>3]?(N=o,0|(l=0)):(a[n+16>>3]=3.141592653589793,a[n+24>>3]=-3.141592653589793,N=o,0|(l=0))}function Tt(e,t,n,a){e|=0,t|=0,n|=0,a|=0;var o,s,u,l=0,c=0,h=0,f=0;u=N,N=N+48|0,o=u+40|0,s=u,ze(c=u+32|0,0,0,0),h=0|i[c>>2],c=0|i[c+4>>2];do{if(n>>>0<=15){if(0|(l=0|Ct(a))){i[(a=s)>>2]=0,i[a+4>>2]=0,i[s+8>>2]=l,i[s+12>>2]=-1,h=s+29|0,i[(a=s+16|0)>>2]=0,i[a+4>>2]=0,i[a+8>>2]=0,r[a+12>>0]=0,r[h>>0]=0|r[o>>0],r[h+1>>0]=0|r[o+1>>0],r[h+2>>0]=0|r[o+2>>0];break}if(l=0|Kt(1+(0|i[t+8>>2])|0,32)){Rt(t,l),i[(f=s)>>2]=h,i[f+4>>2]=c,i[s+8>>2]=0,i[s+12>>2]=n,i[s+16>>2]=a,i[s+20>>2]=t,i[s+24>>2]=l,r[s+28>>0]=0,r[(h=s+29|0)>>0]=0|r[o>>0],r[h+1>>0]=0|r[o+1>>0],r[h+2>>0]=0|r[o+2>>0];break}i[(a=s)>>2]=0,i[a+4>>2]=0,i[s+8>>2]=13,i[s+12>>2]=-1,h=s+29|0,i[(a=s+16|0)>>2]=0,i[a+4>>2]=0,i[a+8>>2]=0,r[a+12>>0]=0,r[h>>0]=0|r[o>>0],r[h+1>>0]=0|r[o+1>>0],r[h+2>>0]=0|r[o+2>>0];break}i[(h=s)>>2]=0,i[h+4>>2]=0,i[s+8>>2]=4,i[s+12>>2]=-1,f=s+29|0,i[(h=s+16|0)>>2]=0,i[h+4>>2]=0,i[h+8>>2]=0,r[h+12>>0]=0,r[f>>0]=0|r[o>>0],r[f+1>>0]=0|r[o+1>>0],r[f+2>>0]=0|r[o+2>>0]}while(0);St(s),i[e>>2]=i[s>>2],i[e+4>>2]=i[s+4>>2],i[e+8>>2]=i[s+8>>2],i[e+12>>2]=i[s+12>>2],i[e+16>>2]=i[s+16>>2],i[e+20>>2]=i[s+20>>2],i[e+24>>2]=i[s+24>>2],i[e+28>>2]=i[s+28>>2],N=u}function St(e){var t,n,a,o,s=0,u=0,l=0,c=0,h=0,f=0,d=0,p=0,A=0,v=0,m=0,g=0,y=0,_=0,b=0,x=0;if(o=N,N=N+336|0,t=o+168|0,n=o,0==(0|(u=0|i[(l=e|=0)>>2]))&0==(0|(l=0|i[l+4>>2])))N=o;else{if(0|r[(s=e+28|0)>>0]?(u=0|Et(u,l),l=0|S()):r[s>>0]=1,!(0|i[i[(a=e+20|0)>>2]>>2]))return 0|(u=0|i[(s=e+24|0)>>2])&&Yt(u),i[(x=e)>>2]=0,i[x+4>>2]=0,i[e+8>>2]=0,i[a>>2]=0,i[e+12>>2]=-1,i[e+16>>2]=0,i[s>>2]=0,void(N=o);c=15&(s=0|i[(x=e+16|0)>>2]);e:do{if(0==(0|u)&0==(0|l))b=e+24|0;else{y=e+12|0,m=3==(0|c),v=255&s,p=3==(1|c),g=e+24|0,A=(c+-1|0)>>>0<3,f=3==(2|c),d=n+8|0;t:for(;;){if(h=0|sn(0|u,0|l,52),S(),(0|(h&=15))==(0|i[y>>2])){switch(15&v){case 0:case 2:case 3:if(0|(c=0|tt(u,l,t))){_=15;break t}if(0|Pt(0|i[a>>2],0|i[g>>2],t)){_=19;break t}}if(p&&(c=0|i[4+(0|i[a>>2])>>2],i[t>>2]=i[c>>2],i[t+4>>2]=i[c+4>>2],i[t+8>>2]=i[c+8>>2],i[t+12>>2]=i[c+12>>2],0|K(26832,t))){if(0|Je(0|i[4+(0|i[a>>2])>>2],h,n)){_=25;break}if((0|i[(c=n)>>2])==(0|u)&&(0|i[c+4>>2])==(0|l)){_=29;break}}if(A){if(0|(c=0|nt(u,l,t))){_=32;break}if(0|wt(u,l,n,0)){_=36;break}if(f&&0|Nt(0|i[a>>2],0|i[g>>2],t,n)){_=42;break}if(p&&0|Lt(0|i[a>>2],0|i[g>>2],t,n)){_=42;break}}if(m){if(s=0|wt(u,l,t,1),c=0|i[g>>2],0|s){_=45;break}if(0|Z(c,t)){if($(n,t),0|J(t,0|i[g>>2])){_=53;break}if(0|Pt(0|i[a>>2],0|i[g>>2],d)){_=53;break}if(0|Lt(0|i[a>>2],0|i[g>>2],n,t)){_=53;break}}}}do{if((0|h)<(0|i[y>>2])){if(s=0|wt(u,l,t,1),c=0|i[g>>2],0|s){_=58;break t}if(!(0|Z(c,t))){_=73;break}if(0|J(0|i[g>>2],t)&&($(n,t),0|Nt(0|i[a>>2],0|i[g>>2],n,t))){_=65;break t}if(0|(u=0|He(u,l,h+1|0,n))){_=67;break t}u=0|i[(l=n)>>2],l=0|i[l+4>>2]}else _=73}while(0);if(73==(0|_)&&(_=0,u=0|Et(u,l),l=0|S()),0==(0|u)&0==(0|l)){b=g;break e}}switch(0|_){case 15:0|(s=0|i[g>>2])&&Yt(s),i[(_=e)>>2]=0,i[_+4>>2]=0,i[a>>2]=0,i[y>>2]=-1,i[x>>2]=0,i[g>>2]=0,i[e+8>>2]=c,_=20;break;case 19:i[e>>2]=u,i[e+4>>2]=l,_=20;break;case 25:E(27795,27761,470,27772);break;case 29:case 42:return i[e>>2]=u,i[e+4>>2]=l,void(N=o);case 32:return 0|(s=0|i[g>>2])&&Yt(s),i[(b=e)>>2]=0,i[b+4>>2]=0,i[a>>2]=0,i[y>>2]=-1,i[x>>2]=0,i[g>>2]=0,i[e+8>>2]=c,void(N=o);case 36:E(27795,27761,493,27772);break;case 45:0|c&&Yt(c),i[(_=e)>>2]=0,i[_+4>>2]=0,i[a>>2]=0,i[y>>2]=-1,i[x>>2]=0,i[g>>2]=0,i[e+8>>2]=s,_=55;break;case 53:i[e>>2]=u,i[e+4>>2]=l,_=55;break;case 58:0|c&&Yt(c),i[(_=e)>>2]=0,i[_+4>>2]=0,i[a>>2]=0,i[y>>2]=-1,i[x>>2]=0,i[g>>2]=0,i[e+8>>2]=s,_=71;break;case 65:i[e>>2]=u,i[e+4>>2]=l,_=71;break;case 67:return 0|(s=0|i[g>>2])&&Yt(s),i[(b=e)>>2]=0,i[b+4>>2]=0,i[a>>2]=0,i[y>>2]=-1,i[x>>2]=0,i[g>>2]=0,i[e+8>>2]=u,void(N=o)}if(20==(0|_))return void(N=o);if(55==(0|_))return void(N=o);if(71==(0|_))return void(N=o)}}while(0);0|(s=0|i[b>>2])&&Yt(s),i[(_=e)>>2]=0,i[_+4>>2]=0,i[e+8>>2]=0,i[a>>2]=0,i[e+12>>2]=-1,i[x>>2]=0,i[b>>2]=0,N=o}}function Et(e,t){var n,r=0,a=0,o=0,s=0,u=0,l=0,c=0,h=0,f=0;n=N,N=N+16|0,f=n,a=0|sn(0|(e|=0),0|(t|=0),52),S(),a&=15,r=0|sn(0|e,0|t,45),S();do{if(a){for(;r=0|un(a+4095|0,0,52),o=0|S()|-15728641&t,r=r|e|(u=0|un(7,0,0|(s=3*(15-a|0)|0))),o|=l=0|S(),c=0|sn(0|e,0|t,0|s),S(),a=a+-1|0,!((c&=7)>>>0<6);){if(!a){h=4;break}t=o,e=r}if(4==(0|h)){r=0|sn(0|r,0|o,45),S();break}return f=0|un(((f=0==(0|c)&0!=(0|je(r,o)))?2:1)+c|0,0,0|s),h=0|S()|t&~l,f|=e&~u,T(0|h),N=n,0|f}}while(0);return(r&=127)>>>0>120?(f=0,T(0|(h=0)),N=n,0|f):(ze(f,0,r+1|0,0),h=0|i[f+4>>2],f=0|i[f>>2],T(0|h),N=n,0|f)}function kt(e,t,n){e|=0;var r,o=0,s=0,u=0,l=0,c=0,h=0,f=0,d=0,p=0;if(!(0|K(t|=0,n|=0)))return 0|(p=0);if(t=0|Q(t),o=+a[n>>3],s=t&(s=+a[n+8>>3])<0?s+6.283185307179586:s,(0|(p=0|i[e>>2]))<=0)return 0|(p=0);if(r=0|i[e+4>>2],t){t=0,d=s,n=-1,e=0;e:for(;;){for(f=e;l=+a[r+(f<<4)>>3],s=+a[r+(f<<4)+8>>3],u=+a[r+((e=(n+2|0)%(0|p)|0)<<4)>>3],c=+a[r+(e<<4)+8>>3],l>u?(h=l,l=c):(h=u,u=l,l=s,s=c),(o=o==u|o==h?o+2220446049250313e-31:o)<u|o>h;){if((0|(n=f+1|0))>=(0|p)){n=22;break e}e=f,f=n,n=e}if(((h=(c=l<0?l+6.283185307179586:l)+(o-u)/(h-u)*((l=s<0?s+6.283185307179586:s)-c))<0?h+6.283185307179586:h)>(d=c==d|l==d?d+-2220446049250313e-31:d)&&(t^=1),(0|(e=f+1|0))>=(0|p)){n=22;break}n=f}if(22==(0|n))return 0|t}else{t=0,d=s,n=-1,e=0;e:for(;;){for(f=e;l=+a[r+(f<<4)>>3],s=+a[r+(f<<4)+8>>3],u=+a[r+((e=(n+2|0)%(0|p)|0)<<4)>>3],c=+a[r+(e<<4)+8>>3],l>u?(h=l,l=c):(h=u,u=l,l=s,s=c),(o=o==u|o==h?o+2220446049250313e-31:o)<u|o>h;){if((0|(n=f+1|0))>=(0|p)){n=22;break e}e=f,f=n,n=e}if(l+(o-u)/(h-u)*(s-l)>(d=l==d|s==d?d+-2220446049250313e-31:d)&&(t^=1),(0|(e=f+1|0))>=(0|p)){n=22;break}n=f}if(22==(0|n))return 0|t}return 0}function Mt(e,t){t|=0;var n,r,o,s,u,c=0,h=0,f=0,d=0,p=0,A=0,v=0,m=0,g=0,y=0,_=0,b=0;if(!(r=0|i[(e|=0)>>2]))return i[t>>2]=0,i[t+4>>2]=0,i[t+8>>2]=0,i[t+12>>2]=0,i[t+16>>2]=0,i[t+20>>2]=0,i[t+24>>2]=0,void(i[t+28>>2]=0);if(a[(o=t+8|0)>>3]=17976931348623157e292,a[(s=t+24|0)>>3]=17976931348623157e292,a[t>>3]=-17976931348623157e292,a[(u=t+16|0)>>3]=-17976931348623157e292,!((0|r)<=0)){for(n=0|i[e+4>>2],m=17976931348623157e292,g=-17976931348623157e292,y=0,e=-1,d=17976931348623157e292,p=17976931348623157e292,v=-17976931348623157e292,h=-17976931348623157e292,_=0;c=+a[n+(_<<4)>>3],A=+a[n+(_<<4)+8>>3],f=+a[n+(((0|(e=e+2|0))==(0|r)?0:e)<<4)+8>>3],c<d&&(a[o>>3]=c,d=c),A<p&&(a[s>>3]=A,p=A),c>v?a[t>>3]=c:c=v,A>h&&(a[u>>3]=A,h=A),m=A>0&A<m?A:m,g=A<0&A>g?A:g,y|=+l(+(A-f))>3.141592653589793,(0|(e=_+1|0))!=(0|r);)b=_,v=c,_=e,e=b;y&&(a[u>>3]=g,a[s>>3]=m)}}function Ct(e){return 0|((e|=0)>>>0<4?0:15)}function Rt(e,t){t|=0;var n,r=0,o=0,s=0,u=0,c=0,h=0,f=0,d=0,p=0,A=0,v=0,m=0,g=0,y=0,_=0,b=0,x=0,w=0,T=0,S=0,E=0;if(g=0|i[(e|=0)>>2]){if(a[(y=t+8|0)>>3]=17976931348623157e292,a[(_=t+24|0)>>3]=17976931348623157e292,a[t>>3]=-17976931348623157e292,a[(b=t+16|0)>>3]=-17976931348623157e292,(0|g)>0){for(s=0|i[e+4>>2],v=17976931348623157e292,m=-17976931348623157e292,o=0,r=-1,f=17976931348623157e292,d=17976931348623157e292,A=-17976931348623157e292,c=-17976931348623157e292,x=0;u=+a[s+(x<<4)>>3],p=+a[s+(x<<4)+8>>3],h=+a[s+(((0|(S=r+2|0))==(0|g)?0:S)<<4)+8>>3],u<f&&(a[y>>3]=u,f=u),p<d&&(a[_>>3]=p,d=p),u>A?a[t>>3]=u:u=A,p>c&&(a[b>>3]=p,c=p),v=p>0&p<v?p:v,m=p<0&p>m?p:m,o|=+l(+(p-h))>3.141592653589793,(0|(r=x+1|0))!=(0|g);)S=x,A=u,x=r,r=S;o&&(a[b>>3]=m,a[_>>3]=v)}}else i[t>>2]=0,i[t+4>>2]=0,i[t+8>>2]=0,i[t+12>>2]=0,i[t+16>>2]=0,i[t+20>>2]=0,i[t+24>>2]=0,i[t+28>>2]=0;if(!((0|(r=0|i[(S=e+8|0)>>2]))<=0)){n=e+12|0,T=0;do{if(s=0|i[n>>2],o=T,_=t+((T=T+1|0)<<5)|0,b=0|i[s+(o<<3)>>2]){if(a[(x=t+(T<<5)+8|0)>>3]=17976931348623157e292,a[(e=t+(T<<5)+24|0)>>3]=17976931348623157e292,a[_>>3]=-17976931348623157e292,a[(w=t+(T<<5)+16|0)>>3]=-17976931348623157e292,(0|b)>0){for(g=0|i[s+(o<<3)+4>>2],v=17976931348623157e292,m=-17976931348623157e292,s=0,o=-1,y=0,f=17976931348623157e292,d=17976931348623157e292,p=-17976931348623157e292,c=-17976931348623157e292;u=+a[g+(y<<4)>>3],A=+a[g+(y<<4)+8>>3],h=+a[g+(((0|(o=o+2|0))==(0|b)?0:o)<<4)+8>>3],u<f&&(a[x>>3]=u,f=u),A<d&&(a[e>>3]=A,d=A),u>p?a[_>>3]=u:u=p,A>c&&(a[w>>3]=A,c=A),v=A>0&A<v?A:v,m=A<0&A>m?A:m,s|=+l(+(A-h))>3.141592653589793,(0|(o=y+1|0))!=(0|b);)E=y,y=o,p=u,o=E;s&&(a[w>>3]=m,a[e>>3]=v)}}else i[_>>2]=0,i[_+4>>2]=0,i[_+8>>2]=0,i[_+12>>2]=0,i[_+16>>2]=0,i[_+20>>2]=0,i[_+24>>2]=0,i[_+28>>2]=0,r=0|i[S>>2]}while((0|T)<(0|r))}}function Pt(e,t,n){var r=0,a=0,o=0;if(!(0|kt(e|=0,t|=0,n|=0)))return 0|(a=0);if((0|i[(a=e+8|0)>>2])<=0)return 0|(a=1);for(r=e+12|0,e=0;;){if(o=e,e=e+1|0,0|kt((0|i[r>>2])+(o<<3)|0,t+(e<<5)|0,n)){e=0,r=6;break}if((0|e)>=(0|i[a>>2])){e=1,r=6;break}}return 6==(0|r)?0|e:0}function Nt(e,t,n,r){r|=0;var a,o,s=0,u=0,l=0,c=0,h=0;if(o=N,N=N+16|0,a=o,!(0|kt(e|=0,t|=0,l=(n|=0)+8|0)))return N=o,0|(c=0);c=e+8|0;e:do{if((0|i[c>>2])>0){for(u=e+12|0,s=0;;){if(h=s,s=s+1|0,0|kt((0|i[u>>2])+(h<<3)|0,t+(s<<5)|0,l)){s=0;break}if((0|s)>=(0|i[c>>2]))break e}return N=o,0|s}}while(0);if(0|It(e,t,n,r))return N=o,0|(h=0);i[a>>2]=i[n>>2],i[a+4>>2]=l,s=0|i[c>>2];e:do{if((0|s)>0)for(e=e+12|0,l=0,u=s;;){if(s=0|i[e>>2],(0|i[s+(l<<3)>>2])>0){if(0|kt(a,r,0|i[s+(l<<3)+4>>2])){s=0;break e}if(s=l+1|0,0|It((0|i[e>>2])+(l<<3)|0,t+(s<<5)|0,n,r)){s=0;break e}u=0|i[c>>2]}else s=l+1|0;if(!((0|s)<(0|u))){s=1;break}l=s}else s=1}while(0);return N=o,0|(h=s)}function It(e,t,n,r){e|=0,n|=0;var o,s,u,l,c,h,f=0,d=0,p=0,A=0,v=0,m=0,g=0,y=0,_=0,b=0,x=0,w=0,T=0,S=0,E=0;if(h=N,N=N+176|0,l=h+172|0,f=h+168|0,c=h,!(0|Z(t|=0,r|=0)))return N=h,0|(e=0);if(function(e,t,n,r){var o,s,u,l,c;t|=0,n|=0,r|=0,e=(s=+a[16+(e|=0)>>3])<(c=+a[e+24>>3]),o=(l=+a[t+16>>3])<(u=+a[t+24>>3]),t=c-l<u-s,i[n>>2]=e?o|t?1:2:0,i[r>>2]=o?e?1:t?2:1:0}(t,r,l,f),dn(0|c,0|n,168),(0|i[n>>2])>0){t=0;do{x=+lt(+a[(S=c+8+(t<<4)+8|0)>>3],0|i[f>>2]),a[S>>3]=x,t=t+1|0}while((0|t)<(0|i[n>>2]))}s=+a[r>>3],u=+a[r+8>>3],x=+lt(+a[r+16>>3],0|i[f>>2]),o=+lt(+a[r+24>>3],0|i[f>>2]);e:do{if((0|i[e>>2])>0){if(r=e+4|0,(0|(f=0|i[c>>2]))<=0)for(t=0;;)if((0|(t=t+1|0))>=(0|i[e>>2])){t=0;break e}for(n=0;;){if(t=0|i[r>>2],_=+a[t+(n<<4)>>3],b=+lt(+a[t+(n<<4)+8>>3],0|i[l>>2]),t=0|i[r>>2],S=(0|(n=n+1|0))%(0|i[e>>2])|0,d=+a[t+(S<<4)>>3],p=+lt(+a[t+(S<<4)+8>>3],0|i[l>>2]),!(_>=s)|!(d>=s)&&!(_<=u)|!(d<=u)&&!(b<=o)|!(p<=o)&&!(b>=x)|!(p>=x)){y=d-_,m=p-b,t=0;do{if(E=t,S=(0|(t=t+1|0))==(0|f)?0:t,d=+a[c+8+(E<<4)+8>>3],p=+a[c+8+(S<<4)+8>>3]-d,A=+a[c+8+(E<<4)>>3],!(0==(g=y*p-m*(v=+a[c+8+(S<<4)>>3]-A))||(w=b-d,T=_-A,v=(w*v-p*T)/g,v<0|v>1))&&(g=(y*w-m*T)/g)>=0&g<=1){t=1;break e}}while((0|t)<(0|f))}if((0|n)>=(0|i[e>>2])){t=0;break}}}else t=0}while(0);return N=h,0|(E=t)}function Lt(e,t,n,r){var a=0,o=0,s=0;if(0|It(e|=0,t|=0,n|=0,r|=0))return 0|(o=1);if((0|i[(o=e+8|0)>>2])<=0)return 0|(o=0);for(a=e+12|0,e=0;;){if(s=e,e=e+1|0,0|It((0|i[a>>2])+(s<<3)|0,t+(e<<5)|0,n,r)){e=1,a=6;break}if((0|e)>=(0|i[o>>2])){e=0,a=6;break}}return 6==(0|a)?0|e:0}function Dt(e,t,n,r,i){t|=0,n|=0,r|=0,i|=0;var o,s,u,l,c,h,f,d=0;l=+a[(e|=0)>>3],u=+a[t>>3]-l,s=+a[e+8>>3],o=+a[t+8>>3]-s,h=+a[n>>3],d=((d=+a[r>>3]-h)*(s-(f=+a[n+8>>3]))-(l-h)*(c=+a[r+8>>3]-f))/(u*c-o*d),a[i>>3]=l+u*d,a[i+8>>3]=s+o*d}function Ot(e,t){return t|=0,+l(+(+a[(e|=0)>>3]-+a[t>>3]))<1.1920928955078125e-7?0|(t=+l(+(+a[e+8>>3]-+a[t+8>>3]))<1.1920928955078125e-7):0|(t=0)}function Ut(e,t){t|=0;var n,r,i;return+((i=+a[(e|=0)>>3]-+a[t>>3])*i+(r=+a[e+8>>3]-+a[t+8>>3])*r+(n=+a[e+16>>3]-+a[t+16>>3])*n)}function Bt(e,t,n){n|=0;var r,a,o,s,u=0,l=0,c=0;if(s=N,N=N+32|0,c=s,0|(u=0|et(e|=0,t|=0,a=s+16|0)))return N=s,0|(n=u);r=0|Be(e,t),o=0|We(e,t),function(e,t){e=7696+(28*(e|=0)|0)|0,i[(t|=0)>>2]=i[e>>2],i[t+4>>2]=i[e+4>>2],i[t+8>>2]=i[e+8>>2],i[t+12>>2]=i[e+12>>2]}(r,c),u=0|function(e,t){e|=0;var n=0,r=0;if((t|=0)>>>0>20)return-1;do{if((0|i[11120+(216*t|0)>>2])!=(0|e))if((0|i[11120+(216*t|0)+8>>2])!=(0|e))if((0|i[11120+(216*t|0)+16>>2])!=(0|e))if((0|i[11120+(216*t|0)+24>>2])!=(0|e))if((0|i[11120+(216*t|0)+32>>2])!=(0|e))if((0|i[11120+(216*t|0)+40>>2])!=(0|e))if((0|i[11120+(216*t|0)+48>>2])!=(0|e))if((0|i[11120+(216*t|0)+56>>2])!=(0|e))if((0|i[11120+(216*t|0)+64>>2])!=(0|e))if((0|i[11120+(216*t|0)+72>>2])!=(0|e))if((0|i[11120+(216*t|0)+80>>2])!=(0|e))if((0|i[11120+(216*t|0)+88>>2])!=(0|e))if((0|i[11120+(216*t|0)+96>>2])!=(0|e))if((0|i[11120+(216*t|0)+104>>2])!=(0|e))if((0|i[11120+(216*t|0)+112>>2])!=(0|e))if((0|i[11120+(216*t|0)+120>>2])!=(0|e))if((0|i[11120+(216*t|0)+128>>2])!=(0|e)){if((0|i[11120+(216*t|0)+136>>2])!=(0|e)){if((0|i[11120+(216*t|0)+144>>2])==(0|e)){e=0,n=2,r=0;break}if((0|i[11120+(216*t|0)+152>>2])==(0|e)){e=0,n=2,r=1;break}if((0|i[11120+(216*t|0)+160>>2])==(0|e)){e=0,n=2,r=2;break}if((0|i[11120+(216*t|0)+168>>2])==(0|e)){e=1,n=2,r=0;break}if((0|i[11120+(216*t|0)+176>>2])==(0|e)){e=1,n=2,r=1;break}if((0|i[11120+(216*t|0)+184>>2])==(0|e)){e=1,n=2,r=2;break}if((0|i[11120+(216*t|0)+192>>2])==(0|e)){e=2,n=2,r=0;break}if((0|i[11120+(216*t|0)+200>>2])==(0|e)){e=2,n=2,r=1;break}if((0|i[11120+(216*t|0)+208>>2])==(0|e)){e=2,n=2,r=2;break}return-1}e=2,n=1,r=2}else e=2,n=1,r=1;else e=2,n=1,r=0;else e=1,n=1,r=2;else e=1,n=1,r=1;else e=1,n=1,r=0;else e=0,n=1,r=2;else e=0,n=1,r=1;else e=0,n=1,r=0;else e=2,n=0,r=2;else e=2,n=0,r=1;else e=2,n=0,r=0;else e=1,n=0,r=2;else e=1,n=0,r=1;else e=1,n=0,r=0;else e=0,n=0,r=2;else e=0,n=0,r=1;else e=0,n=0,r=0}while(0);return 0|i[11120+(216*t|0)+(72*n|0)+(24*e|0)+(r<<3)+4>>2]}(r,0|i[a>>2]);e:do{if(0|z(r)){switch(0|r){case 4:e=0;break;case 14:e=1;break;case 24:e=2;break;case 38:e=3;break;case 49:e=4;break;case 58:e=5;break;case 63:e=6;break;case 72:e=7;break;case 83:e=8;break;case 97:e=9;break;case 107:e=10;break;case 117:e=11;break;default:u=1;break e}if(l=0|i[26416+(24*e|0)+8>>2],t=0|i[26416+(24*e|0)+16>>2],(0|(e=0|i[a>>2]))!=(0|i[c>>2])&&(c=0|V(r))|(0|(e=0|i[a>>2]))==(0|t)&&(u=(u+1|0)%6|0),3==(0|o)&(0|e)==(0|t)){u=(u+5|0)%6|0,l=22;break}5==(0|o)&(0|e)==(0|l)?(u=(u+1|0)%6|0,l=22):l=22}else l=22}while(0);return 22==(0|l)&&(i[n>>2]=u,u=0),N=s,0|(n=u)}function Ft(e,t,n,r){n|=0,r|=0;var a,o,s,u,l,c=0,h=0,f=0,d=0,p=0,A=0,v=0,m=0,g=0,y=0,_=0;if(l=N,N=N+32|0,_=l+24|0,u=l+20|0,s=l+8|0,o=l+16|0,a=l,p=(p=0==(0|je(e|=0,t|=0)))?6:5,v=0|sn(0|e,0|t,52),S(),p>>>0<=n>>>0)return N=l,0|(r=2);!(m=0==(0|(v&=15)))&&0==((g=0|un(7,0,3*(15^v)|0))&e|0)&0==((0|S())&t|0)?c=n:h=4;e:do{if(4==(0|h)){if((0|((c=0!=(0|je(e,t)))?4:5))<(0|n))return N=l,0|(r=1);if(0|Bt(e,t,_))return N=l,0|(r=1);if(h=(0|i[_>>2])+n|0,7==(0|(g=0|i[(c=c?26704+(((0|h)%5|0)<<2)|0:26736+(((0|h)%6|0)<<2)|0)>>2])))return N=l,0|(r=1);i[u>>2]=0,c=0|U(e,t,g,u,s);do{if(!c){if(A=0|i[(d=s)>>2],h=(f=(d=0|i[d+4>>2])>>>0<t>>>0|(0|d)==(0|t)&A>>>0<e>>>0)?A:e,f=f?d:t,!m&&0==(A&(m=0|un(7,0,3*(15^v)|0))|0)&0==(d&(0|S())|0))c=n;else{if(d=(n+-1+p|0)%(0|p)|0,c=0|je(e,t),(0|d)<0&&E(27795,27797,246,27806),(0|((p=0!=(0|c))?4:5))<(0|d)&&E(27795,27797,246,27806),0|Bt(e,t,_)&&E(27795,27797,246,27806),c=(0|i[_>>2])+d|0,7==(0|(d=0|i[(c=p?26704+(((0|c)%5|0)<<2)|0:26736+(((0|c)%6|0)<<2)|0)>>2]))&&E(27795,27797,246,27806),i[o>>2]=0,0|(c=0|U(e,t,d,o,a)))break;p=0|i[(A=a)>>2],A=0|i[A+4>>2];do{if(A>>>0<f>>>0|(0|A)==(0|f)&p>>>0<h>>>0){if(h=0|je(p,A)?0|B(p,A,e,t):0|i[26800+((((0|i[o>>2])+(0|i[26768+(d<<2)>>2])|0)%6|0)<<2)>>2],c=0|je(p,A),(h+-1|0)>>>0>5){c=-1,h=p,f=A;break}if(1==(0|h)&(c=0!=(0|c))){c=-1,h=p,f=A;break}do{if(!(0|Bt(p,A,_))){if(c){c=(5+(0|i[26352+(h<<2)>>2])-(0|i[_>>2])|0)%5|0;break}c=(6+(0|i[26384+(h<<2)>>2])-(0|i[_>>2])|0)%6|0;break}c=-1}while(0);h=p,f=A}else c=n}while(0);A=0|i[(d=s)>>2],d=0|i[d+4>>2]}if((0|h)==(0|A)&(0|f)==(0|d)){if(e=(p=0!=(0|je(A,d)))?0|B(A,d,e,t):0|i[26800+((((0|i[u>>2])+(0|i[26768+(g<<2)>>2])|0)%6|0)<<2)>>2],c=0|je(A,d),(e+-1|0)>>>0<=5&&!(1==(0|e)&(y=0!=(0|c))))do{if(!(0|Bt(A,d,_))){if(y){c=(5+(0|i[26352+(e<<2)>>2])-(0|i[_>>2])|0)%5|0;break}c=(6+(0|i[26384+(e<<2)>>2])-(0|i[_>>2])|0)%6|0;break}c=-1}while(0);else c=-1;c=6==(0|(c=c+1|0))|p&5==(0|c)?0:c}t=f,e=h;break e}}while(0);return N=l,0|(r=c)}}while(0);return y=0|un(0|c,0,56),_=0|S()|-2130706433&t|536870912,i[r>>2]=y|e,i[r+4>>2]=_,N=l,0|(r=0)}function zt(e,t,n){e|=0,n|=0;var r=0;(0|(t|=0))>0?(r=0|Kt(t,4),i[e>>2]=r,r||E(27819,27842,40,27856)):i[e>>2]=0,i[e+4>>2]=t,i[e+8>>2]=0,i[e+12>>2]=n}function Vt(e){var t,n,r,o=0,s=0,u=0,c=0;t=(e|=0)+4|0,n=e+12|0,r=e+8|0;e:for(;;){for(s=0|i[t>>2],o=0;;){if((0|o)>=(0|s))break e;if(u=0|i[e>>2],c=0|i[u+(o<<2)>>2])break;o=o+1|0}o=u+(~~(+l(+ +h(10,+ +(15-(0|i[n>>2])|0))*(+a[c>>3]+ +a[c+8>>3]))%+(0|s))>>>0<<2)|0,s=0|i[o>>2];t:do{if(0|s){if(u=c+32|0,(0|s)==(0|c))i[o>>2]=i[u>>2];else{if(!(o=0|i[(s=s+32|0)>>2]))break;for(;(0|o)!=(0|c);)if(!(o=0|i[(s=o+32|0)>>2]))break t;i[s>>2]=i[u>>2]}Yt(c),i[r>>2]=(0|i[r>>2])-1}}while(0)}Yt(0|i[e>>2])}function qt(e){var t,n=0,r=0;for(t=0|i[(e|=0)+4>>2],r=0;;){if((0|r)>=(0|t)){n=0,r=4;break}if(n=0|i[(0|i[e>>2])+(r<<2)>>2]){r=4;break}r=r+1|0}return 4==(0|r)?0|n:0}function jt(e,t){t|=0;var n=0,r=0,o=0,s=0;if(n=~~(+l(+ +h(10,+ +(15-(0|i[(e|=0)+12>>2])|0))*(+a[t>>3]+ +a[t+8>>3]))%+(0|i[e+4>>2]))>>>0,n=(0|i[e>>2])+(n<<2)|0,!(r=0|i[n>>2]))return 0|(s=1);s=t+32|0;do{if((0|r)!=(0|t)){if(!(n=0|i[r+32>>2]))return 0|(s=1);for(o=n;;){if((0|o)==(0|t)){o=8;break}if(!(n=0|i[o+32>>2])){n=1,o=10;break}r=o,o=n}if(8==(0|o)){i[r+32>>2]=i[s>>2];break}if(10==(0|o))return 0|n}else i[n>>2]=i[s>>2]}while(0);return Yt(t),i[(s=e+8|0)>>2]=(0|i[s>>2])-1,0|(s=0)}function Gt(e,t,n){e|=0,t|=0,n|=0;var r,o=0,s=0,u=0;(r=0|Qt(40))||E(27872,27842,98,27885),i[r>>2]=i[t>>2],i[r+4>>2]=i[t+4>>2],i[r+8>>2]=i[t+8>>2],i[r+12>>2]=i[t+12>>2],i[(s=r+16|0)>>2]=i[n>>2],i[s+4>>2]=i[n+4>>2],i[s+8>>2]=i[n+8>>2],i[s+12>>2]=i[n+12>>2],i[r+32>>2]=0,s=~~(+l(+ +h(10,+ +(15-(0|i[e+12>>2])|0))*(+a[t>>3]+ +a[t+8>>3]))%+(0|i[e+4>>2]))>>>0,s=(0|i[e>>2])+(s<<2)|0,o=0|i[s>>2];do{if(o){for(;!(0|ut(o,t)&&0|ut(o+16|0,n));)if(s=0|i[o+32>>2],!(0|i[(o=0==(0|s)?o:s)+32>>2])){u=10;break}if(10==(0|u)){i[o+32>>2]=r;break}return Yt(r),0|(u=o)}i[s>>2]=r}while(0);return i[(u=e+8|0)>>2]=1+(0|i[u>>2]),0|(u=r)}function Ht(e,t,n){t|=0,n|=0;var r=0,o=0;if(o=~~(+l(+ +h(10,+ +(15-(0|i[(e|=0)+12>>2])|0))*(+a[t>>3]+ +a[t+8>>3]))%+(0|i[e+4>>2]))>>>0,!(o=0|i[(0|i[e>>2])+(o<<2)>>2]))return 0|(n=0);if(!n){for(e=o;;){if(0|ut(e,t)){r=10;break}if(!(e=0|i[e+32>>2])){e=0,r=10;break}}if(10==(0|r))return 0|e}for(e=o;;){if(0|ut(e,t)&&0|ut(e+16|0,n)){r=10;break}if(!(e=0|i[e+32>>2])){e=0,r=10;break}}return 10==(0|r)?0|e:0}function Wt(e,t){t|=0;var n=0;if(n=~~(+l(+ +h(10,+ +(15-(0|i[(e|=0)+12>>2])|0))*(+a[t>>3]+ +a[t+8>>3]))%+(0|i[e+4>>2]))>>>0,!(e=0|i[(0|i[e>>2])+(n<<2)>>2]))return 0|(n=0);for(;;){if(0|ut(e,t)){t=5;break}if(!(e=0|i[e+32>>2])){e=0,t=5;break}}return 5==(0|t)?0|e:0}function Xt(e){return 0|~~+An(+(e=+e))}function Qt(e){e|=0;var t,n=0,r=0,a=0,o=0,s=0,u=0,l=0,c=0,h=0,f=0,d=0,p=0,A=0,v=0,m=0,g=0,y=0,_=0,b=0,x=0;t=N,N=N+16|0,p=t;do{if(e>>>0<245){if(e=(h=e>>>0<11?16:e+11&-8)>>>3,3&(r=(d=0|i[6977])>>>e)|0)return a=0|i[(r=(e=27948+((n=(1&r^1)+e|0)<<1<<2)|0)+8|0)>>2],(0|(s=0|i[(o=a+8|0)>>2]))==(0|e)?i[6977]=d&~(1<<n):(i[s+12>>2]=e,i[r>>2]=s),x=n<<3,i[a+4>>2]=3|x,i[(x=a+x+4|0)>>2]=1|i[x>>2],N=t,0|(x=o);if(h>>>0>(f=0|i[6979])>>>0){if(0|r)return n=((n=r<<e&((n=2<<e)|0-n))&0-n)-1|0,s=0|i[(e=(n=27948+((a=((r=(n>>>=l=n>>>12&16)>>>5&8)|l|(s=(n>>>=r)>>>2&4)|(e=(n>>>=s)>>>1&2)|(a=(n>>>=e)>>>1&1))+(n>>>a)|0)<<1<<2)|0)+8|0)>>2],(0|(r=0|i[(l=s+8|0)>>2]))==(0|n)?(e=d&~(1<<a),i[6977]=e):(i[r+12>>2]=n,i[e>>2]=r,e=d),u=(x=a<<3)-h|0,i[s+4>>2]=3|h,i[(o=s+h|0)+4>>2]=1|u,i[s+x>>2]=u,0|f&&(a=0|i[6982],r=27948+((n=f>>>3)<<1<<2)|0,e&(n=1<<n)?n=0|i[(e=r+8|0)>>2]:(i[6977]=e|n,n=r,e=r+8|0),i[e>>2]=a,i[n+12>>2]=a,i[a+8>>2]=n,i[a+12>>2]=r),i[6979]=u,i[6982]=o,N=t,0|(x=l);if(s=0|i[6978]){for(r=(s&0-s)-1|0,r=c=0|i[28212+(((a=(r>>>=o=r>>>12&16)>>>5&8)|o|(u=(r>>>=a)>>>2&4)|(l=(r>>>=u)>>>1&2)|(c=(r>>>=l)>>>1&1))+(r>>>c)<<2)>>2],l=c,c=(-8&i[c+4>>2])-h|0;(e=0|i[r+16>>2])||(e=0|i[r+20>>2]);)r=e,l=(o=(u=(-8&i[e+4>>2])-h|0)>>>0<c>>>0)?e:l,c=o?u:c;if((u=l+h|0)>>>0>l>>>0){o=0|i[l+24>>2],n=0|i[l+12>>2];do{if((0|n)==(0|l)){if(!(n=0|i[(e=l+20|0)>>2])&&!(n=0|i[(e=l+16|0)>>2])){r=0;break}for(;;)if(r=0|i[(a=n+20|0)>>2])n=r,e=a;else{if(!(r=0|i[(a=n+16|0)>>2]))break;n=r,e=a}i[e>>2]=0,r=n}else r=0|i[l+8>>2],i[r+12>>2]=n,i[n+8>>2]=r,r=n}while(0);do{if(0|o){if(n=0|i[l+28>>2],(0|l)==(0|i[(e=28212+(n<<2)|0)>>2])){if(i[e>>2]=r,!r){i[6978]=s&~(1<<n);break}}else if(i[((0|i[(x=o+16|0)>>2])==(0|l)?x:o+20|0)>>2]=r,!r)break;i[r+24>>2]=o,0|(n=0|i[l+16>>2])&&(i[r+16>>2]=n,i[n+24>>2]=r),0|(n=0|i[l+20>>2])&&(i[r+20>>2]=n,i[n+24>>2]=r)}}while(0);return c>>>0<16?(x=c+h|0,i[l+4>>2]=3|x,i[(x=l+x+4|0)>>2]=1|i[x>>2]):(i[l+4>>2]=3|h,i[u+4>>2]=1|c,i[u+c>>2]=c,0|f&&(a=0|i[6982],r=27948+((n=f>>>3)<<1<<2)|0,(n=1<<n)&d?n=0|i[(e=r+8|0)>>2]:(i[6977]=n|d,n=r,e=r+8|0),i[e>>2]=a,i[n+12>>2]=a,i[a+8>>2]=n,i[a+12>>2]=r),i[6979]=c,i[6982]=u),N=t,0|(x=l+8|0)}d=h}else d=h}else d=h}else if(e>>>0<=4294967231)if(h=-8&(e=e+11|0),a=0|i[6978]){o=0-h|0,c=(e>>>=8)?h>>>0>16777215?31:h>>>((c=14-((l=((m=e<<(d=(e+1048320|0)>>>16&8))+520192|0)>>>16&4)|d|(c=((m<<=l)+245760|0)>>>16&2))+(m<<c>>>15)|0)+7|0)&1|c<<1:0,r=0|i[28212+(c<<2)>>2];e:do{if(r)for(e=0,l=h<<(31==(0|c)?0:25-(c>>>1)|0),s=0;;){if((u=(-8&i[r+4>>2])-h|0)>>>0<o>>>0){if(!u){e=r,o=0,m=65;break e}e=r,o=u}if(s=0==(0|(m=0|i[r+20>>2]))|(0|m)==(0|(r=0|i[r+16+(l>>>31<<2)>>2]))?s:m,!r){r=s,m=61;break}l<<=1}else r=0,e=0,m=61}while(0);if(61==(0|m)){if(0==(0|r)&0==(0|e)){if(!(e=((e=2<<c)|0-e)&a)){d=h;break}d=(e&0-e)-1|0,e=0,r=0|i[28212+(((s=(d>>>=u=d>>>12&16)>>>5&8)|u|(l=(d>>>=s)>>>2&4)|(c=(d>>>=l)>>>1&2)|(r=(d>>>=c)>>>1&1))+(d>>>r)<<2)>>2]}r?m=65:(l=e,u=o)}if(65==(0|m))for(s=r;;){if(o=(r=(d=(-8&i[s+4>>2])-h|0)>>>0<o>>>0)?d:o,e=r?s:e,(r=0|i[s+16>>2])||(r=0|i[s+20>>2]),!r){l=e,u=o;break}s=r}if(0!=(0|l)&&u>>>0<((0|i[6979])-h|0)>>>0&&(f=l+h|0)>>>0>l>>>0){s=0|i[l+24>>2],n=0|i[l+12>>2];do{if((0|n)==(0|l)){if(!(n=0|i[(e=l+20|0)>>2])&&!(n=0|i[(e=l+16|0)>>2])){n=0;break}for(;;)if(r=0|i[(o=n+20|0)>>2])n=r,e=o;else{if(!(r=0|i[(o=n+16|0)>>2]))break;n=r,e=o}i[e>>2]=0}else x=0|i[l+8>>2],i[x+12>>2]=n,i[n+8>>2]=x}while(0);do{if(s){if(e=0|i[l+28>>2],(0|l)==(0|i[(r=28212+(e<<2)|0)>>2])){if(i[r>>2]=n,!n){a&=~(1<<e),i[6978]=a;break}}else if(i[((0|i[(x=s+16|0)>>2])==(0|l)?x:s+20|0)>>2]=n,!n)break;i[n+24>>2]=s,0|(e=0|i[l+16>>2])&&(i[n+16>>2]=e,i[e+24>>2]=n),(e=0|i[l+20>>2])&&(i[n+20>>2]=e,i[e+24>>2]=n)}}while(0);e:do{if(u>>>0<16)x=u+h|0,i[l+4>>2]=3|x,i[(x=l+x+4|0)>>2]=1|i[x>>2];else{if(i[l+4>>2]=3|h,i[f+4>>2]=1|u,i[f+u>>2]=u,n=u>>>3,u>>>0<256){r=27948+(n<<1<<2)|0,(e=0|i[6977])&(n=1<<n)?n=0|i[(e=r+8|0)>>2]:(i[6977]=e|n,n=r,e=r+8|0),i[e>>2]=f,i[n+12>>2]=f,i[f+8>>2]=n,i[f+12>>2]=r;break}if(n=28212+((r=(n=u>>>8)?u>>>0>16777215?31:u>>>((r=14-((_=((x=n<<(b=(n+1048320|0)>>>16&8))+520192|0)>>>16&4)|b|(r=((x<<=_)+245760|0)>>>16&2))+(x<<r>>>15)|0)+7|0)&1|r<<1:0)<<2)|0,i[f+28>>2]=r,i[(e=f+16|0)+4>>2]=0,i[e>>2]=0,!(a&(e=1<<r))){i[6978]=a|e,i[n>>2]=f,i[f+24>>2]=n,i[f+12>>2]=f,i[f+8>>2]=f;break}n=0|i[n>>2];t:do{if((-8&i[n+4>>2]|0)!=(0|u)){for(a=u<<(31==(0|r)?0:25-(r>>>1)|0);e=0|i[(r=n+16+(a>>>31<<2)|0)>>2];){if((-8&i[e+4>>2]|0)==(0|u)){n=e;break t}a<<=1,n=e}i[r>>2]=f,i[f+24>>2]=n,i[f+12>>2]=f,i[f+8>>2]=f;break e}}while(0);x=0|i[(b=n+8|0)>>2],i[x+12>>2]=f,i[b>>2]=f,i[f+8>>2]=x,i[f+12>>2]=n,i[f+24>>2]=0}}while(0);return N=t,0|(x=l+8|0)}d=h}else d=h;else d=-1}while(0);if((r=0|i[6979])>>>0>=d>>>0)return n=r-d|0,e=0|i[6982],n>>>0>15?(x=e+d|0,i[6982]=x,i[6979]=n,i[x+4>>2]=1|n,i[e+r>>2]=n,i[e+4>>2]=3|d):(i[6979]=0,i[6982]=0,i[e+4>>2]=3|r,i[(x=e+r+4|0)>>2]=1|i[x>>2]),N=t,0|(x=e+8|0);if((u=0|i[6980])>>>0>d>>>0)return _=u-d|0,i[6980]=_,b=(x=0|i[6983])+d|0,i[6983]=b,i[b+4>>2]=1|_,i[x+4>>2]=3|d,N=t,0|(x=x+8|0);if(0|i[7095]?e=0|i[7097]:(i[7097]=4096,i[7096]=4096,i[7098]=-1,i[7099]=-1,i[7100]=0,i[7088]=0,i[7095]=-16&p^1431655768,e=4096),l=d+48|0,(h=(s=e+(c=d+47|0)|0)&(o=0-e|0))>>>0<=d>>>0)return N=t,0|(x=0);if(0|(e=0|i[7087])&&(p=(f=0|i[7085])+h|0)>>>0<=f>>>0|p>>>0>e>>>0)return N=t,0|(x=0);e:do{if(4&i[7088])n=0,m=143;else{r=0|i[6983];t:do{if(r){for(a=28356;!((p=0|i[a>>2])>>>0<=r>>>0&&(p+(0|i[a+4>>2])|0)>>>0>r>>>0);){if(!(e=0|i[a+8>>2])){m=128;break t}a=e}if((n=s-u&o)>>>0<2147483647)if((0|(e=0|vn(0|n)))==((0|i[a>>2])+(0|i[a+4>>2])|0)){if(-1!=(0|e)){u=n,s=e,m=145;break e}}else a=e,m=136;else n=0}else m=128}while(0);do{if(128==(0|m))if(-1!=(0|(r=0|vn(0)))&&(n=r,v=(n=(0==((v=(A=0|i[7096])+-1|0)&n|0)?0:(v+n&0-A)-n|0)+h|0)+(A=0|i[7085])|0,n>>>0>d>>>0&n>>>0<2147483647)){if(0|(p=0|i[7087])&&v>>>0<=A>>>0|v>>>0>p>>>0){n=0;break}if((0|(e=0|vn(0|n)))==(0|r)){u=n,s=r,m=145;break e}a=e,m=136}else n=0}while(0);do{if(136==(0|m)){if(r=0-n|0,!(l>>>0>n>>>0&n>>>0<2147483647&-1!=(0|a))){if(-1==(0|a)){n=0;break}u=n,s=a,m=145;break e}if((e=c-n+(e=0|i[7097])&0-e)>>>0>=2147483647){u=n,s=a,m=145;break e}if(-1==(0|vn(0|e))){vn(0|r),n=0;break}u=e+n|0,s=a,m=145;break e}}while(0);i[7088]=4|i[7088],m=143}}while(0);if(143==(0|m)&&h>>>0<2147483647&&!(-1==(0|(_=0|vn(0|h)))|1^(y=(g=(v=0|vn(0))-_|0)>>>0>(d+40|0)>>>0)|_>>>0<v>>>0&-1!=(0|_)&-1!=(0|v)^1)&&(u=y?g:n,s=_,m=145),145==(0|m)){n=(0|i[7085])+u|0,i[7085]=n,n>>>0>(0|i[7086])>>>0&&(i[7086]=n),c=0|i[6983];e:do{if(c){for(n=28356;;){if((0|s)==((e=0|i[n>>2])+(r=0|i[n+4>>2])|0)){m=154;break}if(!(a=0|i[n+8>>2]))break;n=a}if(154==(0|m)&&(b=n+4|0,0==(8&i[n+12>>2]|0))&&s>>>0>c>>>0&e>>>0<=c>>>0){i[b>>2]=r+u,b=c+(_=0==(7&(_=c+8|0)|0)?0:0-_&7)|0,_=(x=(0|i[6980])+u|0)-_|0,i[6983]=b,i[6980]=_,i[b+4>>2]=1|_,i[c+x+4>>2]=40,i[6984]=i[7099];break}for(s>>>0<(0|i[6981])>>>0&&(i[6981]=s),r=s+u|0,n=28356;;){if((0|i[n>>2])==(0|r)){m=162;break}if(!(e=0|i[n+8>>2]))break;n=e}if(162==(0|m)&&0==(8&i[n+12>>2]|0)){i[n>>2]=s,i[(f=n+4|0)>>2]=(0|i[f>>2])+u,h=(f=s+(0==(7&(f=s+8|0)|0)?0:0-f&7)|0)+d|0,l=(n=r+(0==(7&(n=r+8|0)|0)?0:0-n&7)|0)-f-d|0,i[f+4>>2]=3|d;t:do{if((0|c)==(0|n))x=(0|i[6980])+l|0,i[6980]=x,i[6983]=h,i[h+4>>2]=1|x;else{if((0|i[6982])==(0|n)){x=(0|i[6979])+l|0,i[6979]=x,i[6982]=h,i[h+4>>2]=1|x,i[h+x>>2]=x;break}if(1==(3&(e=0|i[n+4>>2])|0)){u=-8&e,a=e>>>3;n:do{if(e>>>0<256){if(e=0|i[n+8>>2],(0|(r=0|i[n+12>>2]))==(0|e)){i[6977]=i[6977]&~(1<<a);break}i[e+12>>2]=r,i[r+8>>2]=e;break}s=0|i[n+24>>2],e=0|i[n+12>>2];do{if((0|e)==(0|n)){if(e=0|i[(a=(r=n+16|0)+4|0)>>2])r=a;else if(!(e=0|i[r>>2])){e=0;break}for(;;)if(a=0|i[(o=e+20|0)>>2])e=a,r=o;else{if(!(a=0|i[(o=e+16|0)>>2]))break;e=a,r=o}i[r>>2]=0}else x=0|i[n+8>>2],i[x+12>>2]=e,i[e+8>>2]=x}while(0);if(!s)break;a=28212+((r=0|i[n+28>>2])<<2)|0;do{if((0|i[a>>2])==(0|n)){if(i[a>>2]=e,0|e)break;i[6978]=i[6978]&~(1<<r);break n}if(i[((0|i[(x=s+16|0)>>2])==(0|n)?x:s+20|0)>>2]=e,!e)break n}while(0);if(i[e+24>>2]=s,0|(a=0|i[(r=n+16|0)>>2])&&(i[e+16>>2]=a,i[a+24>>2]=e),!(r=0|i[r+4>>2]))break;i[e+20>>2]=r,i[r+24>>2]=e}while(0);n=n+u|0,o=u+l|0}else o=l;if(i[(n=n+4|0)>>2]=-2&i[n>>2],i[h+4>>2]=1|o,i[h+o>>2]=o,n=o>>>3,o>>>0<256){r=27948+(n<<1<<2)|0,(e=0|i[6977])&(n=1<<n)?n=0|i[(e=r+8|0)>>2]:(i[6977]=e|n,n=r,e=r+8|0),i[e>>2]=h,i[n+12>>2]=h,i[h+8>>2]=n,i[h+12>>2]=r;break}n=o>>>8;do{if(n){if(o>>>0>16777215){a=31;break}a=o>>>((a=14-((_=((x=n<<(b=(n+1048320|0)>>>16&8))+520192|0)>>>16&4)|b|(a=((x<<=_)+245760|0)>>>16&2))+(x<<a>>>15)|0)+7|0)&1|a<<1}else a=0}while(0);if(n=28212+(a<<2)|0,i[h+28>>2]=a,i[(e=h+16|0)+4>>2]=0,i[e>>2]=0,!((e=0|i[6978])&(r=1<<a))){i[6978]=e|r,i[n>>2]=h,i[h+24>>2]=n,i[h+12>>2]=h,i[h+8>>2]=h;break}n=0|i[n>>2];n:do{if((-8&i[n+4>>2]|0)!=(0|o)){for(a=o<<(31==(0|a)?0:25-(a>>>1)|0);e=0|i[(r=n+16+(a>>>31<<2)|0)>>2];){if((-8&i[e+4>>2]|0)==(0|o)){n=e;break n}a<<=1,n=e}i[r>>2]=h,i[h+24>>2]=n,i[h+12>>2]=h,i[h+8>>2]=h;break t}}while(0);x=0|i[(b=n+8|0)>>2],i[x+12>>2]=h,i[b>>2]=h,i[h+8>>2]=x,i[h+12>>2]=n,i[h+24>>2]=0}}while(0);return N=t,0|(x=f+8|0)}for(n=28356;!((e=0|i[n>>2])>>>0<=c>>>0&&(x=e+(0|i[n+4>>2])|0)>>>0>c>>>0);)n=0|i[n+8>>2];n=(e=(e=(o=x+-47|0)+(0==(7&(e=o+8|0)|0)?0:0-e&7)|0)>>>0<(o=c+16|0)>>>0?c:e)+8|0,b=s+(_=0==(7&(_=s+8|0)|0)?0:0-_&7)|0,_=(r=u+-40|0)-_|0,i[6983]=b,i[6980]=_,i[b+4>>2]=1|_,i[s+r+4>>2]=40,i[6984]=i[7099],i[(r=e+4|0)>>2]=27,i[n>>2]=i[7089],i[n+4>>2]=i[7090],i[n+8>>2]=i[7091],i[n+12>>2]=i[7092],i[7089]=s,i[7090]=u,i[7092]=0,i[7091]=n,n=e+24|0;do{b=n,i[(n=n+4|0)>>2]=7}while((b+8|0)>>>0<x>>>0);if((0|e)!=(0|c)){if(s=e-c|0,i[r>>2]=-2&i[r>>2],i[c+4>>2]=1|s,i[e>>2]=s,n=s>>>3,s>>>0<256){r=27948+(n<<1<<2)|0,(e=0|i[6977])&(n=1<<n)?n=0|i[(e=r+8|0)>>2]:(i[6977]=e|n,n=r,e=r+8|0),i[e>>2]=c,i[n+12>>2]=c,i[c+8>>2]=n,i[c+12>>2]=r;break}if(r=28212+((a=(n=s>>>8)?s>>>0>16777215?31:s>>>((a=14-((_=((x=n<<(b=(n+1048320|0)>>>16&8))+520192|0)>>>16&4)|b|(a=((x<<=_)+245760|0)>>>16&2))+(x<<a>>>15)|0)+7|0)&1|a<<1:0)<<2)|0,i[c+28>>2]=a,i[c+20>>2]=0,i[o>>2]=0,!((n=0|i[6978])&(e=1<<a))){i[6978]=n|e,i[r>>2]=c,i[c+24>>2]=r,i[c+12>>2]=c,i[c+8>>2]=c;break}n=0|i[r>>2];t:do{if((-8&i[n+4>>2]|0)!=(0|s)){for(a=s<<(31==(0|a)?0:25-(a>>>1)|0);e=0|i[(r=n+16+(a>>>31<<2)|0)>>2];){if((-8&i[e+4>>2]|0)==(0|s)){n=e;break t}a<<=1,n=e}i[r>>2]=c,i[c+24>>2]=n,i[c+12>>2]=c,i[c+8>>2]=c;break e}}while(0);x=0|i[(b=n+8|0)>>2],i[x+12>>2]=c,i[b>>2]=c,i[c+8>>2]=x,i[c+12>>2]=n,i[c+24>>2]=0}}else 0==(0|(x=0|i[6981]))|s>>>0<x>>>0&&(i[6981]=s),i[7089]=s,i[7090]=u,i[7092]=0,i[6986]=i[7095],i[6985]=-1,i[6990]=27948,i[6989]=27948,i[6992]=27956,i[6991]=27956,i[6994]=27964,i[6993]=27964,i[6996]=27972,i[6995]=27972,i[6998]=27980,i[6997]=27980,i[7e3]=27988,i[6999]=27988,i[7002]=27996,i[7001]=27996,i[7004]=28004,i[7003]=28004,i[7006]=28012,i[7005]=28012,i[7008]=28020,i[7007]=28020,i[7010]=28028,i[7009]=28028,i[7012]=28036,i[7011]=28036,i[7014]=28044,i[7013]=28044,i[7016]=28052,i[7015]=28052,i[7018]=28060,i[7017]=28060,i[7020]=28068,i[7019]=28068,i[7022]=28076,i[7021]=28076,i[7024]=28084,i[7023]=28084,i[7026]=28092,i[7025]=28092,i[7028]=28100,i[7027]=28100,i[7030]=28108,i[7029]=28108,i[7032]=28116,i[7031]=28116,i[7034]=28124,i[7033]=28124,i[7036]=28132,i[7035]=28132,i[7038]=28140,i[7037]=28140,i[7040]=28148,i[7039]=28148,i[7042]=28156,i[7041]=28156,i[7044]=28164,i[7043]=28164,i[7046]=28172,i[7045]=28172,i[7048]=28180,i[7047]=28180,i[7050]=28188,i[7049]=28188,i[7052]=28196,i[7051]=28196,b=s+(_=0==(7&(_=s+8|0)|0)?0:0-_&7)|0,_=(x=u+-40|0)-_|0,i[6983]=b,i[6980]=_,i[b+4>>2]=1|_,i[s+x+4>>2]=40,i[6984]=i[7099]}while(0);if((n=0|i[6980])>>>0>d>>>0)return _=n-d|0,i[6980]=_,b=(x=0|i[6983])+d|0,i[6983]=b,i[b+4>>2]=1|_,i[x+4>>2]=3|d,N=t,0|(x=x+8|0)}return i[(x=27904)>>2]=12,N=t,0|(x=0)}function Yt(e){var t=0,n=0,r=0,a=0,o=0,s=0,u=0,l=0;if(e|=0){n=e+-8|0,a=0|i[6981],l=n+(t=-8&(e=0|i[e+-4>>2]))|0;do{if(1&e)u=n,s=n;else{if(r=0|i[n>>2],!(3&e))return;if(o=r+t|0,(s=n+(0-r)|0)>>>0<a>>>0)return;if((0|i[6982])==(0|s)){if(3!=(3&(t=0|i[(e=l+4|0)>>2])|0)){u=s,t=o;break}return i[6979]=o,i[e>>2]=-2&t,i[s+4>>2]=1|o,void(i[s+o>>2]=o)}if(n=r>>>3,r>>>0<256){if(e=0|i[s+8>>2],(0|(t=0|i[s+12>>2]))==(0|e)){i[6977]=i[6977]&~(1<<n),u=s,t=o;break}i[e+12>>2]=t,i[t+8>>2]=e,u=s,t=o;break}a=0|i[s+24>>2],e=0|i[s+12>>2];do{if((0|e)==(0|s)){if(e=0|i[(n=(t=s+16|0)+4|0)>>2])t=n;else if(!(e=0|i[t>>2])){e=0;break}for(;;)if(n=0|i[(r=e+20|0)>>2])e=n,t=r;else{if(!(n=0|i[(r=e+16|0)>>2]))break;e=n,t=r}i[t>>2]=0}else u=0|i[s+8>>2],i[u+12>>2]=e,i[e+8>>2]=u}while(0);if(a){if(t=0|i[s+28>>2],(0|i[(n=28212+(t<<2)|0)>>2])==(0|s)){if(i[n>>2]=e,!e){i[6978]=i[6978]&~(1<<t),u=s,t=o;break}}else if(i[((0|i[(u=a+16|0)>>2])==(0|s)?u:a+20|0)>>2]=e,!e){u=s,t=o;break}i[e+24>>2]=a,0|(n=0|i[(t=s+16|0)>>2])&&(i[e+16>>2]=n,i[n+24>>2]=e),(t=0|i[t+4>>2])?(i[e+20>>2]=t,i[t+24>>2]=e,u=s,t=o):(u=s,t=o)}else u=s,t=o}}while(0);if(!(s>>>0>=l>>>0)&&1&(r=0|i[(e=l+4|0)>>2])){if(2&r)i[e>>2]=-2&r,i[u+4>>2]=1|t,i[s+t>>2]=t,a=t;else{if((0|i[6983])==(0|l)){if(l=(0|i[6980])+t|0,i[6980]=l,i[6983]=u,i[u+4>>2]=1|l,(0|u)!=(0|i[6982]))return;return i[6982]=0,void(i[6979]=0)}if((0|i[6982])==(0|l))return l=(0|i[6979])+t|0,i[6979]=l,i[6982]=s,i[u+4>>2]=1|l,void(i[s+l>>2]=l);a=(-8&r)+t|0,n=r>>>3;do{if(r>>>0<256){if(t=0|i[l+8>>2],(0|(e=0|i[l+12>>2]))==(0|t)){i[6977]=i[6977]&~(1<<n);break}i[t+12>>2]=e,i[e+8>>2]=t;break}o=0|i[l+24>>2],e=0|i[l+12>>2];do{if((0|e)==(0|l)){if(e=0|i[(n=(t=l+16|0)+4|0)>>2])t=n;else if(!(e=0|i[t>>2])){n=0;break}for(;;)if(n=0|i[(r=e+20|0)>>2])e=n,t=r;else{if(!(n=0|i[(r=e+16|0)>>2]))break;e=n,t=r}i[t>>2]=0,n=e}else n=0|i[l+8>>2],i[n+12>>2]=e,i[e+8>>2]=n,n=e}while(0);if(0|o){if(e=0|i[l+28>>2],(0|i[(t=28212+(e<<2)|0)>>2])==(0|l)){if(i[t>>2]=n,!n){i[6978]=i[6978]&~(1<<e);break}}else if(i[((0|i[(r=o+16|0)>>2])==(0|l)?r:o+20|0)>>2]=n,!n)break;i[n+24>>2]=o,0|(t=0|i[(e=l+16|0)>>2])&&(i[n+16>>2]=t,i[t+24>>2]=n),0|(e=0|i[e+4>>2])&&(i[n+20>>2]=e,i[e+24>>2]=n)}}while(0);if(i[u+4>>2]=1|a,i[s+a>>2]=a,(0|u)==(0|i[6982]))return void(i[6979]=a)}if(e=a>>>3,a>>>0<256)return n=27948+(e<<1<<2)|0,(t=0|i[6977])&(e=1<<e)?e=0|i[(t=n+8|0)>>2]:(i[6977]=t|e,e=n,t=n+8|0),i[t>>2]=u,i[e+12>>2]=u,i[u+8>>2]=e,void(i[u+12>>2]=n);e=28212+((r=(e=a>>>8)?a>>>0>16777215?31:a>>>((r=14-((o=((l=e<<(s=(e+1048320|0)>>>16&8))+520192|0)>>>16&4)|s|(r=((l<<=o)+245760|0)>>>16&2))+(l<<r>>>15)|0)+7|0)&1|r<<1:0)<<2)|0,i[u+28>>2]=r,i[u+20>>2]=0,i[u+16>>2]=0,t=0|i[6978],n=1<<r;e:do{if(t&n){e=0|i[e>>2];t:do{if((-8&i[e+4>>2]|0)!=(0|a)){for(r=a<<(31==(0|r)?0:25-(r>>>1)|0);t=0|i[(n=e+16+(r>>>31<<2)|0)>>2];){if((-8&i[t+4>>2]|0)==(0|a)){e=t;break t}r<<=1,e=t}i[n>>2]=u,i[u+24>>2]=e,i[u+12>>2]=u,i[u+8>>2]=u;break e}}while(0);l=0|i[(s=e+8|0)>>2],i[l+12>>2]=u,i[s>>2]=u,i[u+8>>2]=l,i[u+12>>2]=e,i[u+24>>2]=0}else i[6978]=t|n,i[e>>2]=u,i[u+24>>2]=e,i[u+12>>2]=u,i[u+8>>2]=u}while(0);if(l=(0|i[6985])-1|0,i[6985]=l,!(0|l)){for(e=28364;e=0|i[e>>2];)e=e+8|0;i[6985]=-1}}}}function Kt(e,t){t|=0;var n=0;return(e|=0)?(n=0|_(t,e),(t|e)>>>0>65535&&(n=(0|(n>>>0)/(e>>>0))==(0|t)?n:-1)):n=0,(e=0|Qt(n))&&3&i[e+-4>>2]?(pn(0|e,0,0|n),0|e):0|e}function Zt(e,t,n,r){return 0|(T((t|=0)+(r|=0)+((n=(e|=0)+(n|=0)>>>0)>>>0<e>>>0|0)>>>0|0),0|n)}function Jt(e,t,n,r){return 0|(T(0|(r=(t|=0)-(r|=0)-((n|=0)>>>0>(e|=0)>>>0|0)>>>0)),e-n>>>0|0)}function $t(e){return 0|((e|=0)?31-(0|w(e^e-1))|0:32)}function en(e,t,n,r,a){a|=0;var o=0,s=0,u=0,l=0,c=0,h=0,f=0,d=0,p=0,A=0;if(h=e|=0,s=n|=0,u=d=r|=0,!(c=l=t|=0))return o=0!=(0|a),u?o?(i[a>>2]=0|e,i[a+4>>2]=0&t,a=0,0|(T(0|(d=0)),a)):(a=0,0|(T(0|(d=0)),a)):(o&&(i[a>>2]=(h>>>0)%(s>>>0),i[a+4>>2]=0),a=(h>>>0)/(s>>>0)>>>0,0|(T(0|(d=0)),a));o=0==(0|u);do{if(s){if(!o){if((o=(0|w(0|u))-(0|w(0|c))|0)>>>0<=31){s=f=o+1|0,e=h>>>(f>>>0)&(t=o-31>>31)|c<<(u=31-o|0),t&=c>>>(f>>>0),o=0,u=h<<u;break}return a?(i[a>>2]=0|e,i[a+4>>2]=l|0&t,a=0,0|(T(0|(d=0)),a)):(a=0,0|(T(0|(d=0)),a))}if((o=s-1|0)&s|0){s=u=33+(0|w(0|s))-(0|w(0|c))|0,e=(f=32-u|0)-1>>31&c>>>((p=u-32|0)>>>0)|(c<<f|h>>>(u>>>0))&(t=p>>31),t&=c>>>(u>>>0),o=h<<(A=64-u|0)&(l=f>>31),u=(c<<A|h>>>(p>>>0))&l|h<<f&u-33>>31;break}return 0|a&&(i[a>>2]=o&h,i[a+4>>2]=0),1==(0|s)?(A=0|e,0|(T(0|(p=l|0&t)),A)):(p=c>>>((A=0|$t(0|s))>>>0)|0,A=c<<32-A|h>>>(A>>>0)|0,0|(T(0|p),A))}if(o)return 0|a&&(i[a>>2]=(c>>>0)%(s>>>0),i[a+4>>2]=0),A=(c>>>0)/(s>>>0)>>>0,0|(T(0|(p=0)),A);if(!h)return 0|a&&(i[a>>2]=0,i[a+4>>2]=(c>>>0)%(u>>>0)),A=(c>>>0)/(u>>>0)>>>0,0|(T(0|(p=0)),A);if(!((o=u-1|0)&u))return 0|a&&(i[a>>2]=0|e,i[a+4>>2]=o&c|0&t),p=0,A=c>>>((0|$t(0|u))>>>0),0|(T(0|p),A);if((o=(0|w(0|u))-(0|w(0|c))|0)>>>0<=30){s=t=o+1|0,e=c<<(u=31-o|0)|h>>>(t>>>0),t=c>>>(t>>>0),o=0,u=h<<u;break}return a?(i[a>>2]=0|e,i[a+4>>2]=l|0&t,A=0,0|(T(0|(p=0)),A)):(A=0,0|(T(0|(p=0)),A))}while(0);if(s){c=0|Zt(0|(f=0|n),0|(h=d|0&r),-1,-1),n=0|S(),l=u,u=0;do{r=l,l=o>>>31|l<<1,o=u|o<<1,Jt(0|c,0|n,0|(r=e<<1|r>>>31|0),0|(d=e>>>31|t<<1|0)),u=1&(p=(A=0|S())>>31|((0|A)<0?-1:0)<<1),e=0|Jt(0|r,0|d,p&f|0,(((0|A)<0?-1:0)>>31|((0|A)<0?-1:0)<<1)&h|0),t=0|S(),s=s-1|0}while(0!=(0|s));c=l,l=0}else c=u,l=0,u=0;return s=0,0|a&&(i[a>>2]=e,i[a+4>>2]=t),A=-2&(o<<1|0)|u,0|(T(0|(p=(0|o)>>>31|(c|s)<<1|0&(s<<1|o>>>31)|l)),A)}function tn(e,t,n,r){n|=0;var i,a,o,s,u;return a=(r|=0)>>31|((0|r)<0?-1:0)<<1,i=((0|r)<0?-1:0)>>31|((0|r)<0?-1:0)<<1,o=0|Jt((u=(t|=0)>>31|((0|t)<0?-1:0)<<1)^(e|=0)|0,(s=((0|t)<0?-1:0)>>31|((0|t)<0?-1:0)<<1)^t|0,0|u,0|s),e=a^u,t=i^s,0|Jt((0|en(o,0|S(),0|Jt(a^n|0,i^r|0,0|a,0|i),0|S(),0))^e|0,(0|S())^t|0,0|e,0|t)}function nn(e,t,n,r){t|=0,r|=0;var i,a;return n=0|function(e,t){var n,r,i,a=0;return e=((n=0|_(a=65535&(t|=0),i=65535&(e|=0)))>>>16)+(0|_(a,r=e>>>16))|0,t=0|_(a=t>>>16,i),0|(T((e>>>16)+(0|_(a,r))+(((65535&e)+t|0)>>>16)|0),e+t<<16|65535&n|0)}(i=e|=0,a=n|=0),e=0|S(),0|(T((0|_(t,a))+(0|_(r,i))+e|0&e|0),0|n)}function rn(e,t,n,r){n|=0;var a,o,s,u,l,c;return a=N,N=N+16|0,u=0|a,c=(r|=0)>>31|((0|r)<0?-1:0)<<1,l=((0|r)<0?-1:0)>>31|((0|r)<0?-1:0)<<1,en(e=0|Jt((s=(t|=0)>>31|((0|t)<0?-1:0)<<1)^(e|=0)|0,(o=((0|t)<0?-1:0)>>31|((0|t)<0?-1:0)<<1)^t|0,0|s,0|o),t=0|S(),0|Jt(c^n|0,l^r|0,0|c,0|l),0|S(),u),r=0|Jt(i[u>>2]^s|0,i[u+4>>2]^o|0,0|s,0|o),n=0|S(),N=a,0|(T(0|n),r)}function an(e,t,n,r){var a,o;return o=N,N=N+16|0,en(e|=0,t|=0,n|=0,r|=0,a=0|o),N=o,0|(T(0|i[a+4>>2]),0|i[a>>2])}function on(e,t,n){return e|=0,t|=0,(0|(n|=0))<32?(T(t>>n|0),e>>>n|(t&(1<<n)-1)<<32-n):(T(0|((0|t)<0?-1:0)),t>>n-32|0)}function sn(e,t,n){return e|=0,t|=0,(0|(n|=0))<32?(T(t>>>n|0),e>>>n|(t&(1<<n)-1)<<32-n):(T(0),t>>>n-32|0)}function un(e,t,n){return e|=0,t|=0,(0|(n|=0))<32?(T(t<<n|(e&(1<<n)-1<<32-n)>>>32-n|0),e<<n):(T(e<<n-32|0),0)}function ln(e,t,n){return e|=0,0,32==(0|(t=0|w(t|=0)))&&(t=t+(0|w(e))|0),T(0),0|t}function cn(e,t){return t=+t,(e=+e)!=e?+t:t!=t?+e:+x(+e,+t)}function hn(e,t){return t=+t,(e=+e)!=e?+t:t!=t?+e:+b(+e,+t)}function fn(e){return(e=+e)>=0?+u(e+.5):+y(e-.5)}function dn(e,t,n){e|=0,t|=0;var a,o,s=0;if((0|(n|=0))>=8192)return C(0|e,0|t,0|n),0|e;if(o=0|e,a=e+n|0,(3&e)==(3&t)){for(;3&e;){if(!n)return 0|o;r[e>>0]=0|r[t>>0],e=e+1|0,t=t+1|0,n=n-1|0}for(s=(n=-4&a|0)-64|0;(0|e)<=(0|s);)i[e>>2]=i[t>>2],i[e+4>>2]=i[t+4>>2],i[e+8>>2]=i[t+8>>2],i[e+12>>2]=i[t+12>>2],i[e+16>>2]=i[t+16>>2],i[e+20>>2]=i[t+20>>2],i[e+24>>2]=i[t+24>>2],i[e+28>>2]=i[t+28>>2],i[e+32>>2]=i[t+32>>2],i[e+36>>2]=i[t+36>>2],i[e+40>>2]=i[t+40>>2],i[e+44>>2]=i[t+44>>2],i[e+48>>2]=i[t+48>>2],i[e+52>>2]=i[t+52>>2],i[e+56>>2]=i[t+56>>2],i[e+60>>2]=i[t+60>>2],e=e+64|0,t=t+64|0;for(;(0|e)<(0|n);)i[e>>2]=i[t>>2],e=e+4|0,t=t+4|0}else for(n=a-4|0;(0|e)<(0|n);)r[e>>0]=0|r[t>>0],r[e+1>>0]=0|r[t+1>>0],r[e+2>>0]=0|r[t+2>>0],r[e+3>>0]=0|r[t+3>>0],e=e+4|0,t=t+4|0;for(;(0|e)<(0|a);)r[e>>0]=0|r[t>>0],e=e+1|0,t=t+1|0;return 0|o}function pn(e,t,n){t|=0;var a,o=0,s=0,u=0;if(a=(e|=0)+(n|=0)|0,t&=255,(0|n)>=67){for(;3&e;)r[e>>0]=t,e=e+1|0;for(u=t|t<<8|t<<16|t<<24,s=(o=-4&a|0)-64|0;(0|e)<=(0|s);)i[e>>2]=u,i[e+4>>2]=u,i[e+8>>2]=u,i[e+12>>2]=u,i[e+16>>2]=u,i[e+20>>2]=u,i[e+24>>2]=u,i[e+28>>2]=u,i[e+32>>2]=u,i[e+36>>2]=u,i[e+40>>2]=u,i[e+44>>2]=u,i[e+48>>2]=u,i[e+52>>2]=u,i[e+56>>2]=u,i[e+60>>2]=u,e=e+64|0;for(;(0|e)<(0|o);)i[e>>2]=u,e=e+4|0}for(;(0|e)<(0|a);)r[e>>0]=t,e=e+1|0;return a-n|0}function An(e){return(e=+e)>=0?+u(e+.5):+y(e-.5)}function vn(e){e|=0;var t,n,r;return r=0|M(),(0|e)>0&(0|(t=(n=0|i[s>>2])+e|0))<(0|n)|(0|t)<0?(P(0|t),k(12),-1):(0|t)>(0|r)&&!(0|R(0|t))?(k(12),-1):(i[s>>2]=t,0|n)}return{___divdi3:tn,___muldi3:nn,___remdi3:rn,___uremdi3:an,_areNeighborCells:function(e,t,n,r,a){a|=0;var o,s,u,l=0,c=0,h=0,f=0;if(u=N,N=N+64|0,s=u,o=u+56|0,!(!0&134217728==(2013265920&(t|=0)|0)&!0&134217728==(2013265920&(r|=0)|0)))return N=u,0|(a=5);if((0|(e|=0))==(0|(n|=0))&(0|t)==(0|r))return i[a>>2]=0,N=u,0|(a=0);if(c=0|sn(0|e,0|t,52),S(),c&=15,f=0|sn(0|n,0|r,52),S(),(0|c)!=(15&f|0))return N=u,0|(a=12);if(l=c+-1|0,c>>>0>1){Ve(e,t,l,s),Ve(n,r,l,o),h=0|i[(f=s)>>2],f=0|i[f+4>>2];e:do{if((0|h)==(0|i[o>>2])&&(0|f)==(0|i[o+4>>2])){l=0|sn(0|e,0|t,0|(c=3*(15^c)|0)),S(),l&=7,c=0|sn(0|n,0|r,0|c),S(),c&=7;do{if(0==(0|l)|0==(0|c))i[a>>2]=1,l=0;else if(7==(0|l))l=5;else{if(1==(0|l)|1==(0|c)&&0|je(h,f)){l=5;break}if((0|i[15536+(l<<2)>>2])!=(0|c)&&(0|i[15568+(l<<2)>>2])!=(0|c))break e;i[a>>2]=1,l=0}}while(0);return N=u,0|(a=l)}}while(0)}c=(l=s)+56|0;do{i[l>>2]=0,l=l+4|0}while((0|l)<(0|c));return I(e,t,1,s),l=(0|i[(t=s)>>2])==(0|n)&&(0|i[t+4>>2])==(0|r)||(0|i[(t=s+8|0)>>2])==(0|n)&&(0|i[t+4>>2])==(0|r)||(0|i[(t=s+16|0)>>2])==(0|n)&&(0|i[t+4>>2])==(0|r)||(0|i[(t=s+24|0)>>2])==(0|n)&&(0|i[t+4>>2])==(0|r)||(0|i[(t=s+32|0)>>2])==(0|n)&&(0|i[t+4>>2])==(0|r)||(0|i[(t=s+40|0)>>2])==(0|n)&&(0|i[t+4>>2])==(0|r)?1:1&((0|i[(l=s+48|0)>>2])==(0|n)?(0|i[l+4>>2])==(0|r):0),i[a>>2]=l,N=u,0|(a=0)},_bitshift64Ashr:on,_bitshift64Lshr:sn,_bitshift64Shl:un,_calloc:Kt,_cellAreaKm2:function(e,t,n){return 0|(e=0|pt(e|=0,t|=0,n|=0))||(a[n>>3]=6371.007180918475*+a[n>>3]*6371.007180918475),0|e},_cellAreaM2:function(e,t,n){return 0|(e=0|pt(e|=0,t|=0,n|=0))||(a[n>>3]=6371.007180918475*+a[n>>3]*6371.007180918475*1e3*1e3),0|e},_cellAreaRads2:pt,_cellToBoundary:nt,_cellToCenterChild:He,_cellToChildPos:function(e,t,n,r){n|=0,r|=0;var a,o=0,s=0,u=0,l=0,c=0,h=0,f=0,d=0,p=0,A=0,v=0,m=0,g=0,y=0;if(a=N,N=N+16|0,g=a,y=0|sn(0|(e|=0),0|(t|=0),52),S(),y&=15,n>>>0>15)return N=a,0|(y=4);if((0|y)<(0|n))return N=a,0|(y=12);if((0|y)!=(0|n))if(s=0|un(0|n,0,52),s|=e,l=0|S()|-15728641&t,(0|y)>(0|n)){c=n;do{m=0|un(7,0,3*(14-c|0)|0),c=c+1|0,s|=m,l=0|S()|l}while((0|c)<(0|y));m=s}else m=s;else m=e,l=t;v=0|sn(0|m,0|l,45),S();e:do{if(0|z(127&v)){if(c=0|sn(0|m,0|l,52),S(),0|(c&=15))for(s=1;;){if(!(0==((v=0|un(7,0,3*(15-s|0)|0))&m|0)&0==((0|S())&l|0))){h=33;break e}if(!(s>>>0<c>>>0))break;s=s+1|0}if(i[(v=r)>>2]=0,i[v+4>>2]=0,(0|y)>(0|n)){for(v=-15728641&t,A=y;;){if(p=A,(A=A+-1|0)>>>0>15|(0|y)<(0|A)){h=19;break}if((0|y)!=(0|A))if(s=0|un(0|A,0,52),s|=e,c=0|S()|v,(0|y)<(0|p))d=s;else{h=A;do{d=0|un(7,0,3*(14-h|0)|0),h=h+1|0,s|=d,c=0|S()|c}while((0|h)<(0|y));d=s}else d=e,c=t;if(f=0|sn(0|d,0|c,45),S(),0|z(127&f)){f=0|sn(0|d,0|c,52),S(),f&=15;t:do{if(f)for(h=1;;){if(s=0|sn(0|d,0|c,3*(15-h|0)|0),S(),0|(s&=7))break t;if(!(h>>>0<f>>>0)){s=0;break}h=h+1|0}else s=0}while(0);s=0==(0|s)&1}else s=0;if(c=0|sn(0|e,0|t,3*(15-p|0)|0),S(),7==(0|(c&=7))){o=5,h=42;break}if(1==(0|c)&(s=0!=(0|s))){o=5,h=42;break}if(0|(d=c+((0!=(0|c)&s)<<31>>31)|0)&&(h=0|xt(7,0,h=y-p|0,((0|h)<0)<<31>>31),f=0|S(),s?(s=0|Zt(0|(s=0|nn(0|h,0|f,5,0)),0|S(),-5,-1),s=0|Zt(0|(s=0|tn(0|s,0|S(),6,0)),0|S(),1,0),c=0|S()):(s=h,c=f),p=0|Zt(0|s,0|c,0|(p=0|nn(0|h,0|f,0|(p=d+-1|0),((0|p)<0)<<31>>31|0)),0|S()),f=0|Zt(0|p,0|(d=0|S()),0|i[(f=r)>>2],0|i[f+4>>2]),d=0|S(),i[(p=r)>>2]=f,i[p+4>>2]=d),(0|A)<=(0|n)){h=37;break}}if(19==(0|h))E(27795,27122,1276,27158);else{if(37==(0|h)){o=0|i[(u=r)+4>>2],u=0|i[u>>2];break}if(42==(0|h))return N=a,0|o}}else o=0,u=0}else h=33}while(0);e:do{if(33==(0|h)){if(i[(v=r)>>2]=0,i[v+4>>2]=0,(0|y)>(0|n)){for(s=y;;){if(o=0|sn(0|e,0|t,3*(15-s|0)|0),S(),7==(0|(o&=7))){o=5;break}if(o=0|nn(0|(u=0|xt(7,0,u=y-s|0,((0|u)<0)<<31>>31)),0|S(),0|o,0),u=0|S(),u=0|Zt(0|i[(v=r)>>2],0|i[v+4>>2],0|o,0|u),o=0|S(),i[(v=r)>>2]=u,i[v+4>>2]=o,(0|(s=s+-1|0))<=(0|n))break e}return N=a,0|o}o=0,u=0}}while(0);return 0|qe(m,l,y,g)&&E(27795,27122,1236,27173),((0|o)>-1|-1==(0|o)&u>>>0>4294967295)&((0|(g=0|i[(y=g)+4>>2]))>(0|o)|((0|g)==(0|o)?(0|i[y>>2])>>>0>u>>>0:0))?(N=a,0|(y=0)):(E(27795,27122,1316,27158),0)},_cellToChildren:function(e,t,n,r){r|=0;var a,o,s=0,u=0;if(o=N,N=N+16|0,it(a=o,e|=0,t|=0,n|=0),0==(0|(e=0|i[(t=a)>>2]))&0==(0|(t=0|i[t+4>>2])))return N=o,0;s=0,n=0;do{i[(u=r+(s<<3)|0)>>2]=e,i[u+4>>2]=t,s=0|Zt(0|s,0|n,1,0),n=0|S(),ot(a),e=0|i[(u=a)>>2],t=0|i[u+4>>2]}while(!(0==(0|e)&0==(0|t)));return N=o,0},_cellToChildrenSize:qe,_cellToLatLng:tt,_cellToLocalIj:function(e,t,n,r,i,a){var o,s;return e|=0,t|=0,n|=0,r|=0,a|=0,s=N,N=N+16|0,o=s,(i|=0)?e=15:(e=0|_t(e,t,n,r,o))||(Te(o,a),e=0),N=s,0|e},_cellToParent:Ve,_cellToVertex:Ft,_cellToVertexes:function(e,t,n){n|=0;var r,a=0,o=0;return o=0==(0|je(e|=0,t|=0)),r=0==(0|(a=0|Ft(e,t,0,n))),o?r?0|(a=0|Ft(e,t,1,n+8|0))||0|(a=0|Ft(e,t,2,n+16|0))||0|(a=0|Ft(e,t,3,n+24|0))||(a=0|Ft(e,t,4,n+32|0))?0|(o=a):0|Ft(e,t,5,n+40|0):0|(o=a):r?0|(a=0|Ft(e,t,1,n+8|0))||0|(a=0|Ft(e,t,2,n+16|0))||0|(a=0|Ft(e,t,3,n+24|0))||0|(a=0|Ft(e,t,4,n+32|0))?0|(o=a):(i[(o=n+40|0)>>2]=0,i[o+4>>2]=0,0|(o=0)):0|(o=a)},_cellsToDirectedEdge:function(e,t,n,r,a){return a|=0,7==(0|(n=0|B(e|=0,t|=0,n|=0,r|=0)))?0|(a=11):(r=0|un(0|n,0,56),t=-2130706433&t|0|S()|268435456,i[a>>2]=e|r,i[a+4>>2]=t,0|(a=0))},_cellsToLinkedMultiPolygon:function(e,t,n){n|=0;var r,a,o,s=0;if(o=N,N=N+32|0,r=o,e=0|function(e,t,n){e|=0,n|=0;var r,a,o=0,s=0,u=0,l=0,c=0,h=0;if(a=N,N=N+176|0,r=a,(0|(t|=0))<1)return zt(n,0,0),N=a,0;for(c=0|sn(0|i[(c=e)>>2],0|i[c+4>>2],52),S(),zt(n,(0|t)>6?t:6,15&c),c=0;!(0|(o=0|nt(0|i[(o=e+(c<<3)|0)>>2],0|i[o+4>>2],r)));){if((0|(o=0|i[r>>2]))>0){l=0;do{u=r+8+(l<<4)|0,(s=0|Ht(n,o=r+8+(((0|(l=l+1|0))%(0|o)|0)<<4)|0,u))?jt(n,s):Gt(n,u,o),o=0|i[r>>2]}while((0|l)<(0|o))}if((0|(c=c+1|0))>=(0|t)){o=0,h=13;break}}return 13==(0|h)?(N=a,0|o):(Vt(n),N=a,0|(h=o))}(e|=0,t|=0,a=o+16|0),0|e)return N=o,0|(n=e);if(i[n>>2]=0,i[n+4>>2]=0,i[n+8>>2]=0,0|(e=0|qt(a)))do{t=0|At(n);do{vt(t,e),s=e+16|0,i[r>>2]=i[s>>2],i[r+4>>2]=i[s+4>>2],i[r+8>>2]=i[s+8>>2],i[r+12>>2]=i[s+12>>2],jt(a,e),e=0|Wt(a,r)}while(0!=(0|e));e=0|qt(a)}while(0!=(0|e));return Vt(a),(e=0|gt(n))?(mt(n),N=o,0|(s=e)):(N=o,0|(s=0))},_childPosToCell:function(e,t,n,r,a,o){e|=0,t|=0,o|=0;var s,u=0,l=0,c=0,h=0,f=0,d=0,p=0,A=0,v=0;if(s=N,N=N+16|0,u=s,(a|=0)>>>0>15)return N=s,0|(o=4);if(l=0|sn(0|(n|=0),0|(r|=0),52),S(),(0|(l&=15))>(0|a))return N=s,0|(o=12);if(0|qe(n,r,a,u)&&E(27795,27122,1236,27173),!(((0|t)>-1|-1==(0|t)&e>>>0>4294967295)&((0|(h=0|i[(f=u)+4>>2]))>(0|t)|((0|h)==(0|t)?(0|i[f>>2])>>>0>e>>>0:0))))return N=s,0|(o=2);f=a-l|0,a=0|un(0|a,0,52),c=0|S()|-15728641&r,i[(h=o)>>2]=a|n,i[h+4>>2]=c,h=0|sn(0|n,0|r,45),S();e:do{if(0|z(127&h)){if(0|l)for(u=1;;){if(!(0==((h=0|un(7,0,3*(15-u|0)|0))&n|0)&0==((0|S())&r|0)))break e;if(!(u>>>0<l>>>0))break;u=u+1|0}if((0|f)<1)return N=s,0|(o=0);for(h=15^l,r=-1,c=1,u=1;;){l=0|xt(7,0,l=f-c|0,((0|l)<0)<<31>>31),n=0|S();do{if(u){if(u=0|tn(0|(u=0|Zt(0|(u=0|nn(0|l,0|n,5,0)),0|S(),-5,-1)),0|S(),6,0),(0|t)>(0|(a=0|S()))|(0|t)==(0|a)&e>>>0>u>>>0){t=0|Jt(0|(t=0|Zt(0|e,0|t,-1,-1)),0|S(),0|u,0|a),u=0|S(),A=0|i[(d=o)>>2],d=0|i[d+4>>2],p=0|un(7,0,0|(v=3*(h+r|0)|0)),d&=~(0|S()),v=0|un(0|(a=0|Zt(0|(r=0|tn(0|t,0|u,0|l,0|n)),0|(e=0|S()),2,0)),0|S(),0|v),d=0|S()|d,i[(a=o)>>2]=v|A&~p,i[a+4>>2]=d,e=0|Jt(0|t,0|u,0|(e=0|nn(0|r,0|e,0|l,0|n)),0|S()),u=0,t=0|S();break}p=0|i[(v=o)>>2],v=0|i[v+4>>2],A=0|un(7,0,3*(h+r|0)|0),v&=~(0|S()),i[(u=o)>>2]=p&~A,i[u+4>>2]=v,u=1;break}a=0|i[(p=o)>>2],p=0|i[p+4>>2],d=0|un(7,0,0|(r=3*(h+r|0)|0)),p&=~(0|S()),r=0|un(0|(v=0|tn(0|e,0|t,0|l,0|n)),0|(u=0|S()),0|r),p=0|S()|p,i[(A=o)>>2]=r|a&~d,i[A+4>>2]=p,e=0|Jt(0|e,0|t,0|(u=0|nn(0|v,0|u,0|l,0|n)),0|S()),u=0,t=0|S()}while(0);if(!((0|f)>(0|c))){t=0;break}r=~c,c=c+1|0}return N=s,0|t}}while(0);if((0|f)<1)return N=s,0|(v=0);for(a=15^l,u=1;;){if(A=0|xt(7,0,A=f-u|0,((0|A)<0)<<31>>31),v=0|S(),n=0|i[(c=o)>>2],c=0|i[c+4>>2],r=0|un(7,0,0|(l=3*(a-u|0)|0)),c&=~(0|S()),l=0|un(0|(d=0|tn(0|e,0|t,0|A,0|v)),0|(p=0|S()),0|l),c=0|S()|c,i[(h=o)>>2]=l|n&~r,i[h+4>>2]=c,e=0|Jt(0|e,0|t,0|(v=0|nn(0|d,0|p,0|A,0|v)),0|S()),t=0|S(),(0|f)<=(0|u)){t=0;break}u=u+1|0}return N=s,0|t},_compactCells:function(e,t,n,r){t|=0;var a,o=0,s=0,u=0,l=0,c=0,h=0,f=0,d=0,p=0,A=0,v=0,m=0,g=0,y=0,_=0,b=0,x=0,w=0,T=0,k=0,M=0,C=0,R=0,P=0,N=0;if(0==(0|(n|=0))&0==(0|(r|=0)))return 0|(N=0);if(s=0|i[(o=e|=0)>>2],!0&0==(15728640&(o=0|i[o+4>>2])|0)){if(!((0|r)>0|0==(0|r)&n>>>0>0))return 0|(N=0);if(i[(N=t)>>2]=s,i[N+4>>2]=o,1==(0|n)&0==(0|r))return 0|(N=0);o=1,s=0;do{P=0|i[(R=e+(o<<3)|0)+4>>2],i[(N=t+(o<<3)|0)>>2]=i[R>>2],i[N+4>>2]=P,o=0|Zt(0|o,0|s,1,0),s=0|S()}while((0|s)<(0|r)|(0|s)==(0|r)&o>>>0<n>>>0);return 0|(o=0)}if(!(P=0|Qt(a=n<<3)))return 0|(N=13);if(dn(0|P,0|e,0|a),!(R=0|Kt(n,8)))return Yt(P),0|(N=13);e:for(;;){M=0|sn(0|(h=0|i[(o=P)>>2]),0|(o=0|i[o+4>>2]),52),S(),C=(M&=15)+-1|0,k=0!=(0|M),T=(0|r)>0|0==(0|r)&n>>>0>0;t:do{if(k&T){if(_=0|un(0|C,0,52),b=0|S(),C>>>0>15){if(!(0==(0|h)&0==(0|o))){N=16;break e}for(s=0,e=0;;){if(s=0|Zt(0|s,0|e,1,0),!((0|(e=0|S()))<(0|r)|(0|e)==(0|r)&s>>>0<n>>>0))break t;if(!(0==(0|(w=0|i[(u=P+(s<<3)|0)>>2]))&0==(0|(u=0|i[u+4>>2])))){o=u,N=16;break e}}}for(l=h,e=o,s=0,u=0;;){if(!(0==(0|l)&0==(0|e))){if(!(!0&0==(117440512&e|0))){N=21;break e}if(f=0|sn(0|l,0|e,52),S(),(0|(f&=15))<(0|C)){o=12,N=27;break e}if((0|f)!=(0|C)&&(l|=_,e=-15728641&e|b,f>>>0>=M>>>0)){c=C;do{w=0|un(7,0,3*(14-c|0)|0),c=c+1|0,l|=w,e=0|S()|e}while(c>>>0<f>>>0)}if(p=0|an(0|l,0|e,0|n,0|r),A=0|S(),!(0==(0|(d=0|i[(f=c=R+(p<<3)|0)>>2]))&0==(0|(f=0|i[f+4>>2])))){g=0,y=0;do{if((0|g)>(0|r)|(0|g)==(0|r)&y>>>0>n>>>0){N=31;break e}if((0|d)==(0|l)&(-117440513&f|0)==(0|e)){v=0|sn(0|d,0|f,56),S(),m=(v&=7)+1|0,w=0|sn(0|d,0|f,45),S();n:do{if(0|z(127&w)){if(d=0|sn(0|d,0|f,52),S(),!(d&=15)){f=6;break}for(f=1;;){if(!(0==((w=0|un(7,0,3*(15-f|0)|0))&l|0)&0==((0|S())&e|0))){f=7;break n}if(!(f>>>0<d>>>0)){f=6;break}f=f+1|0}}else f=7}while(0);if((v+2|0)>>>0>f>>>0){N=41;break e}w=0|un(0|m,0,56),e=0|S()|-117440513&e,i[(x=c)>>2]=0,i[x+4>>2]=0,l|=w}else p=0|rn(0|(p=0|Zt(0|p,0|A,1,0)),0|S(),0|n,0|r),A=0|S();y=0|Zt(0|y,0|g,1,0),g=0|S(),d=0|i[(f=c=R+(p<<3)|0)>>2],f=0|i[f+4>>2]}while(!(0==(0|d)&0==(0|f)))}i[(w=c)>>2]=l,i[w+4>>2]=e}if(s=0|Zt(0|s,0|u,1,0),!((0|(u=0|S()))<(0|r)|(0|u)==(0|r)&s>>>0<n>>>0))break t;l=0|i[(e=P+(s<<3)|0)>>2],e=0|i[e+4>>2]}}}while(0);if(w=0|Zt(0|n,0|r,5,0),(x=0|S())>>>0<0|0==(0|x)&w>>>0<11){N=85;break}if(w=0|tn(0|n,0|r,6,0),S(),!(w=0|Kt(w,8))){N=48;break}do{if(T){for(m=0,e=0,v=0,g=0;;){if(0==(0|(s=0|i[(u=f=R+(m<<3)|0)>>2]))&0==(0|(u=0|i[u+4>>2])))x=v;else{d=0|sn(0|s,0|u,56),S(),l=(d&=7)+1|0,p=-117440513&u,x=0|sn(0|s,0|u,45),S();t:do{if(0|z(127&x)){if(A=0|sn(0|s,0|u,52),S(),0|(A&=15))for(c=1;;){if(!(0==(s&(x=0|un(7,0,3*(15-c|0)|0))|0)&0==(p&(0|S())|0)))break t;if(!(c>>>0<A>>>0))break;c=c+1|0}s|=u=0|un(0|l,0,56),u=0|S()|p,i[(l=f)>>2]=s,i[l+4>>2]=u,l=d+2|0}}while(0);7==(0|l)?(i[(x=w+(e<<3)|0)>>2]=s,i[x+4>>2]=-117440513&u,e=0|Zt(0|e,0|v,1,0),x=0|S()):x=v}if(m=0|Zt(0|m,0|g,1,0),!((0|(g=0|S()))<(0|r)|(0|g)==(0|r)&m>>>0<n>>>0))break;v=x}if(T){if(y=C>>>0>15,_=0|un(0|C,0,52),b=0|S(),!k){for(s=0,c=0,l=0,u=0;0==(0|h)&0==(0|o)||(i[(C=t+(s<<3)|0)>>2]=h,i[C+4>>2]=o,s=0|Zt(0|s,0|c,1,0),c=0|S()),l=0|Zt(0|l,0|u,1,0),(0|(u=0|S()))<(0|r)|(0|u)==(0|r)&l>>>0<n>>>0;)h=0|i[(o=P+(l<<3)|0)>>2],o=0|i[o+4>>2];o=x;break}for(s=0,c=0,u=0,l=0;;){do{if(!(0==(0|h)&0==(0|o))){if(A=0|sn(0|h,0|o,52),S(),y|(0|(A&=15))<(0|C)){N=80;break e}if((0|A)!=(0|C)){if(f=h|_,d=-15728641&o|b,A>>>0>=M>>>0){p=C;do{k=0|un(7,0,3*(14-p|0)|0),p=p+1|0,f|=k,d=0|S()|d}while(p>>>0<A>>>0)}}else f=h,d=o;v=0|an(0|f,0|d,0|n,0|r),p=0,A=0,g=0|S();do{if((0|p)>(0|r)|(0|p)==(0|r)&A>>>0>n>>>0){N=81;break e}if((-117440513&(m=0|i[(k=R+(v<<3)|0)+4>>2])|0)==(0|d)&&(0|i[k>>2])==(0|f)){N=65;break}v=0|rn(0|(k=0|Zt(0|v,0|g,1,0)),0|S(),0|n,0|r),g=0|S(),A=0|Zt(0|A,0|p,1,0),p=0|S(),k=R+(v<<3)|0}while((0|i[k>>2])!=(0|f)||(0|i[k+4>>2])!=(0|d));if(65==(0|N)&&(N=0,!0&100663296==(117440512&m|0)))break;i[(k=t+(s<<3)|0)>>2]=h,i[k+4>>2]=o,s=0|Zt(0|s,0|c,1,0),c=0|S()}}while(0);if(u=0|Zt(0|u,0|l,1,0),!((0|(l=0|S()))<(0|r)|(0|l)==(0|r)&u>>>0<n>>>0))break;h=0|i[(o=P+(u<<3)|0)>>2],o=0|i[o+4>>2]}o=x}else s=0,o=x}else s=0,e=0,o=0}while(0);if(pn(0|R,0,0|a),dn(0|P,0|w,e<<3|0),Yt(w),0==(0|e)&0==(0|o)){N=89;break}t=t+(s<<3)|0,r=o,n=e}if(16==(0|N))!0&0==(117440512&o|0)?(o=4,N=27):N=21;else if(31==(0|N))E(27795,27122,529,27132);else{if(41==(0|N))return Yt(P),Yt(R),0|(N=10);if(48==(0|N))return Yt(P),Yt(R),0|(N=13);80==(0|N)?E(27795,27122,620,27132):81==(0|N)?E(27795,27122,632,27132):85==(0|N)&&(dn(0|t,0|P,n<<3|0),N=89)}return 21==(0|N)?(Yt(P),Yt(R),0|(N=5)):27==(0|N)?(Yt(P),Yt(R),0|(N=o)):89==(0|N)?(Yt(P),Yt(R),0|(N=0)):0},_destroyLinkedMultiPolygon:mt,_directedEdgeToBoundary:Me,_directedEdgeToCells:function(e,t,n){e|=0;var r,a,o,s=0;return r=N,N=N+16|0,s=r,!0&268435456==(2013265920&(t|=0)|0)?(a=-2130706433&t|134217728,i[(o=n|=0)>>2]=e,i[o+4>>2]=a,i[s>>2]=0,t=0|sn(0|e,0|t,56),S(),s=0|U(e,a,7&t,s,n+8|0),N=r,0|s):(N=r,0|(s=6))},_edgeLengthKm:function(e,t,n){n|=0;var r,o=0,s=0,u=0,l=0,h=0,p=0,A=0;if(r=N,N=N+176|0,0|(e=0|Me(e|=0,t|=0,l=r)))return l=e,u=+a[n>>3],u*=6371.007180918475,a[n>>3]=u,N=r,0|l;if(a[n>>3]=0,(0|(e=0|i[l>>2]))<=1)return l=0,u=0,u*=6371.007180918475,a[n>>3]=u,N=r,0|l;t=e+-1|0,e=0,o=+a[l+8>>3],s=+a[l+16>>3],u=0;do{p=o,o=+a[l+8+((e=e+1|0)<<4)>>3],A=+d(.5*(o-p)),h=s,s=+a[l+8+(e<<4)+8>>3],h=A*A+(h=+d(.5*(s-h)))*(+f(+p)*+f(+o)*h),u+=2*+g(+ +c(+h),+ +c(+(1-h)))}while((0|e)!=(0|t));return a[n>>3]=u,l=0,A=u,A*=6371.007180918475,a[n>>3]=A,N=r,0|l},_edgeLengthM:function(e,t,n){n|=0;var r,o=0,s=0,u=0,l=0,h=0,p=0,A=0;if(r=N,N=N+176|0,0|(e=0|Me(e|=0,t|=0,l=r)))return l=e,u=+a[n>>3],u*=6371.007180918475,u*=1e3,a[n>>3]=u,N=r,0|l;if(a[n>>3]=0,(0|(e=0|i[l>>2]))<=1)return l=0,u=0,u*=6371.007180918475,u*=1e3,a[n>>3]=u,N=r,0|l;t=e+-1|0,e=0,o=+a[l+8>>3],s=+a[l+16>>3],u=0;do{p=o,o=+a[l+8+((e=e+1|0)<<4)>>3],A=+d(.5*(o-p)),h=s,s=+a[l+8+(e<<4)+8>>3],h=A*A+(h=+d(.5*(s-h)))*(+f(+p)*+f(+o)*h),u+=2*+g(+ +c(+h),+ +c(+(1-h)))}while((0|e)!=(0|t));return a[n>>3]=u,l=0,A=u,A*=6371.007180918475,A*=1e3,a[n>>3]=A,N=r,0|l},_edgeLengthRads:function(e,t,n){n|=0;var r,o=0,s=0,u=0,l=0,h=0,p=0,A=0;if(r=N,N=N+176|0,0|(e=0|Me(e|=0,t|=0,l=r)))return N=r,0|(l=e);if(a[n>>3]=0,(0|(e=0|i[l>>2]))<=1)return N=r,0|(l=0);t=e+-1|0,e=0,o=+a[l+8>>3],s=+a[l+16>>3],u=0;do{p=o,o=+a[l+8+((e=e+1|0)<<4)>>3],A=+d(.5*(o-p)),h=s,s=+a[l+8+(e<<4)+8>>3],h=A*A+(h=+d(.5*(s-h)))*(+f(+o)*+f(+p)*h),u+=2*+g(+ +c(+h),+ +c(+(1-h)))}while((0|e)<(0|t));return a[n>>3]=u,N=r,0|(l=0)},_emscripten_replace_memory:function(e){return r=new Int8Array(e),new Uint8Array(e),i=new Int32Array(e),new Float32Array(e),a=new Float64Array(e),n=e,!0},_free:Yt,_getBaseCellNumber:Be,_getDirectedEdgeDestination:function(e,t,n){e|=0,t|=0,n|=0;var r,a,o=0;return r=N,N=N+16|0,i[(o=r)>>2]=0,!0&268435456==(2013265920&t|0)?(a=0|sn(0|e,0|t,56),S(),o=0|U(e,-2130706433&t|134217728,7&a,o,n),N=r,0|o):(N=r,0|(o=6))},_getDirectedEdgeOrigin:function(e,t,n){return e|=0,n|=0,!0&268435456==(2013265920&(t|=0)|0)?(i[n>>2]=e,i[n+4>>2]=-2130706433&t|134217728,0|(n=0)):0|(n=6)},_getHexagonAreaAvgKm2:ht,_getHexagonAreaAvgM2:function(e,t){return t|=0,(e|=0)>>>0>15?0|(t=4):(a[t>>3]=+a[20784+(e<<3)>>3],0|(t=0))},_getHexagonEdgeLengthAvgKm:function(e,t){return t|=0,(e|=0)>>>0>15?0|(t=4):(a[t>>3]=+a[20912+(e<<3)>>3],0|(t=0))},_getHexagonEdgeLengthAvgM:function(e,t){return t|=0,(e|=0)>>>0>15?0|(t=4):(a[t>>3]=+a[21040+(e<<3)>>3],0|(t=0))},_getIcosahedronFaces:function e(t,n,r){r|=0;var a,o=0,s=0,u=0,l=0,c=0,h=0,f=0,d=0;a=N,N=N+128|0,f=a+112|0,u=a+96|0,d=a,s=0|sn(0|(t|=0),0|(n|=0),52),S(),c=15&s,i[f>>2]=c,l=0|sn(0|t,0|n,45),S(),l&=127;e:do{if(0|z(l)){if(0|c)for(o=1;;){if(!(0==((h=0|un(7,0,3*(15-o|0)|0))&t|0)&0==((0|S())&n|0))){s=0;break e}if(!(o>>>0<c>>>0))break;o=o+1|0}if(!(1&s))return h=0|un(c+1|0,0,52),d=0|S()|-15728641&n,d=0|e((h|t)&~(f=0|un(7,0,3*(14-c|0)|0)),d&~(0|S()),r),N=a,0|d;s=1}else s=0}while(0);if(!(o=0|et(t,n,u))){s?(Ie(u,f,d),h=5):(Ue(u,f,d),h=6);e:do{if(0|z(l))if(c)for(o=1;;){if(!(0==((l=0|un(7,0,3*(15-o|0)|0))&t|0)&0==((0|S())&n|0))){t=2;break e}if(!(o>>>0<c>>>0)){t=5;break}o=o+1|0}else t=5;else t=2}while(0);pn(0|r,-1,t<<2|0);e:do{if(s)for(u=0;;){if(De(l=d+(u<<4)|0,0|i[f>>2]),l=0|i[l>>2],-1==(0|(c=0|i[r>>2]))|(0|c)==(0|l))o=r;else{s=0;do{if((s=s+1|0)>>>0>=t>>>0){o=1;break e}c=0|i[(o=r+(s<<2)|0)>>2]}while(!(-1==(0|c)|(0|c)==(0|l)))}if(i[o>>2]=l,(u=u+1|0)>>>0>=h>>>0){o=0;break}}else for(u=0;;){if(Le(l=d+(u<<4)|0,0|i[f>>2],0,1),l=0|i[l>>2],-1==(0|(c=0|i[r>>2]))|(0|c)==(0|l))o=r;else{s=0;do{if((s=s+1|0)>>>0>=t>>>0){o=1;break e}c=0|i[(o=r+(s<<2)|0)>>2]}while(!(-1==(0|c)|(0|c)==(0|l)))}if(i[o>>2]=l,(u=u+1|0)>>>0>=h>>>0){o=0;break}}}while(0)}return N=a,0|(d=o)},_getNumCells:ft,_getPentagons:rt,_getRes0Cells:function(e){e|=0;var t=0,n=0,r=0;t=0;do{un(0|t,0,45),r=134225919|S(),i[(n=e+(t<<3)|0)>>2]=-1,i[n+4>>2]=r,t=t+1|0}while(122!=(0|t));return 0},_getResolution:function(e,t){return t=0|sn(0|(e|=0),0|(t|=0),52),S(),15&t|0},_greatCircleDistanceKm:ct,_greatCircleDistanceM:function(e,t){e|=0;var n,r,i,o=0;return r=+a[(t|=0)>>3],n=+a[e>>3],o=(i=+d(.5*(r-n)))*i+(o=+d(.5*(+a[t+8>>3]-+a[e+8>>3])))*(+f(+r)*+f(+n)*o),2*+g(+ +c(+o),+ +c(+(1-o)))*6371.007180918475*1e3},_greatCircleDistanceRads:function(e,t){e|=0;var n,r,i,o=0;return r=+a[(t|=0)>>3],n=+a[e>>3],o=(i=+d(.5*(r-n)))*i+(o=+d(.5*(+a[t+8>>3]-+a[e+8>>3])))*(+f(+r)*+f(+n)*o),2*+g(+ +c(+o),+ +c(+(1-o)))},_gridDisk:I,_gridDiskDistances:L,_gridDistance:function(e,t,n,r,a){n|=0,r|=0,a|=0;var o,s,u=0,l=0;return s=N,N=N+32|0,l=s,0|(o=0|_t(e|=0,t|=0,e,t,u=s+12|0))?(N=s,0|(l=o)):0|(e=0|_t(e,t,n,r,l))?(N=s,0|(l=e)):(u=0|we(u,l),i[(l=a)>>2]=u,i[l+4>>2]=((0|u)<0)<<31>>31,N=s,0|(l=0))},_gridPathCells:function(e,t,n,r,a){n|=0,r|=0,a|=0;var o,s,u=0,c=0,h=0,f=0,d=0,p=0,A=0,v=0,m=0,g=0,y=0,_=0,b=0,x=0,w=0,T=0,k=0,M=0;if(s=N,N=N+48|0,c=s+12|0,k=s,!(u=0|_t(e|=0,t|=0,e,t,o=s+24|0))&&!(u=0|_t(e,t,n,r,c))){T=((0|(w=0|we(o,c)))<0)<<31>>31,i[o>>2]=0,i[o+4>>2]=0,i[o+8>>2]=0,i[c>>2]=0,i[c+4>>2]=0,i[c+8>>2]=0,0|_t(e,t,e,t,o)&&E(27795,27538,692,27747),0|_t(e,t,n,r,c)&&E(27795,27538,697,27747),Ee(o),Ee(c),p=0==(0|w)?0:1/+(0|w),n=0|i[o>>2],y=p*+((0|i[c>>2])-n|0),r=0|i[(_=o+4|0)>>2],b=p*+((0|i[c+4>>2])-r|0),u=0|i[(x=o+8|0)>>2],p*=+((0|i[c+8>>2])-u|0),i[k>>2]=n,i[(A=k+4|0)>>2]=r,i[(v=k+8|0)>>2]=u;e:do{if((0|w)<0)u=0;else for(m=0,g=0;;){M=y*(f=+(g>>>0)+4294967296*+(0|m))+ +(0|n),h=b*f+ +(0|r),f=p*f+ +(0|u),n=~~+fn(+M),c=~~+fn(+h),u=~~+fn(+f),M=+l(+(+(0|n)-M)),h=+l(+(+(0|c)-h)),f=+l(+(+(0|u)-f));do{if(!(M>h&M>f)){if(d=0-n|0,h>f){r=d-u|0;break}r=c,u=d-c|0;break}n=0-(c+u)|0,r=c}while(0);if(i[k>>2]=n,i[A>>2]=r,i[v>>2]=u,ke(k),0|(u=0|bt(e,t,k,a+(g<<3)|0)))break e;if(!((0|m)<(0|T)|(0|m)==(0|T)&g>>>0<w>>>0)){u=0;break e}n=0|Zt(0|g,0|m,1,0),m=r=0|S(),g=n,n=0|i[o>>2],r=0|i[_>>2],u=0|i[x>>2]}}while(0);return N=s,0|(k=u)}return N=s,0|(k=u)},_gridPathCellsSize:function(e,t,n,r,a){n|=0,r|=0,a|=0;var o,s=0,u=0,l=0;return o=N,N=N+32|0,l=o,(s=0|_t(e|=0,t|=0,e,t,u=o+12|0))||(s=0|_t(e,t,n,r,l))?(N=o,0|(l=s)):(r=0|Zt(0|(r=0|we(u,l)),((0|r)<0)<<31>>31|0,1,0),u=0|S(),i[(l=a)>>2]=r,i[l+4>>2]=u,N=o,0|(l=0))},_gridRingUnsafe:function(e,t,n,r){e|=0,t|=0,n|=0,r|=0;var a,o,s=0,u=0,l=0,c=0,h=0,f=0,d=0,p=0,A=0;if(o=N,N=N+16|0,A=o+8|0,i[(p=a=o)>>2]=e,i[p+4>>2]=t,!n)return i[(A=r)>>2]=e,i[A+4>>2]=t,N=o,0|(A=0);i[A>>2]=0;e:do{if(0|je(e,t))e=9;else{if(u=(0|n)>0){s=0,p=e;do{if(0|(e=0|U(p,t,4,A,a)))break e;if(s=s+1|0,0|je(p=0|i[(t=a)>>2],t=0|i[t+4>>2])){e=9;break e}}while((0|s)<(0|n));if(i[(d=r)>>2]=p,i[d+4>>2]=t,d=n+-1|0,u){f=0,e=1;do{if(s=26800+(f<<2)|0,5==(0|f))for(l=0|i[s>>2],u=0,s=e;;){if(0|(e=0|U(0|i[(e=a)>>2],0|i[e+4>>2],l,A,a)))break e;if((0|u)!=(0|d)){if(c=0|i[(h=a)>>2],h=0|i[h+4>>2],i[(e=r+(s<<3)|0)>>2]=c,i[e+4>>2]=h,0|je(c,h)){e=9;break e}e=s+1|0}else e=s;if((0|(u=u+1|0))>=(0|n))break;s=e}else for(l=a,h=0|i[s>>2],c=0,s=e,u=0|i[l>>2],l=0|i[l+4>>2];;){if(0|(e=0|U(u,l,h,A,a)))break e;if(u=0|i[(l=a)>>2],l=0|i[l+4>>2],i[(e=r+(s<<3)|0)>>2]=u,i[e+4>>2]=l,e=s+1|0,0|je(u,l)){e=9;break e}if((0|(c=c+1|0))>=(0|n))break;s=e}f=f+1|0}while(f>>>0<6);l=p,s=0|i[(e=a)>>2],u=t,e=0|i[e+4>>2]}else l=p,s=p,u=t,e=t}else i[(l=r)>>2]=e,i[l+4>>2]=t,l=e,s=e,u=t,e=t;e=(0|l)==(0|s)&(0|u)==(0|e)?0:9}}while(0);return N=o,0|(A=e)},_i64Add:Zt,_i64Subtract:Jt,_isPentagon:je,_isResClassIII:function(e,t){return t=0|sn(0|(e|=0),0|(t|=0),52),S(),1&t|0},_isValidCell:Fe,_isValidDirectedEdge:function(e,t){var n=0;switch(n=0|sn(0|(e|=0),0|(t|=0),56),S(),7&n){case 0:case 7:return 0|(n=0)}return n=-2130706433&t|134217728,!0&268435456==(2013265920&t|0)?!0&16777216==(117440512&t|0)&0!=(0|je(e,n))?0|(n=0):0|(n=0|Fe(e,n)):0|(n=0)},_isValidVertex:function(e,t){e|=0;var n,r,a=0,o=0;return r=N,N=N+16|0,n=r,!0&536870912==(2013265920&(t|=0)|0)&&0|Fe(e,a=-2130706433&t|134217728)?(o=0|sn(0|e,0|t,56),S(),a=(o=0==(0|Ft(e,a,7&o,n)))&((0|i[(a=n)>>2])==(0|e)?(0|i[a+4>>2])==(0|t):0)&1,N=r,0|a):(N=r,0|(a=0))},_latLngToCell:Je,_llvm_ctlz_i64:ln,_llvm_maxnum_f64:cn,_llvm_minnum_f64:hn,_llvm_round_f64:fn,_localIjToCell:function(e,t,n,r,i){var a,o;return e|=0,t|=0,n|=0,i|=0,o=N,N=N+16|0,a=o,(r|=0)?n=15:(n=0|Se(n,a))||(n=0|bt(e,t,a,i)),N=o,0|n},_malloc:Qt,_maxFaceCount:function(e,t,n){n|=0;var r=0,a=0;if(a=0|sn(0|(e|=0),0|(t|=0),45),S(),!(0|z(127&a)))return a=2,i[n>>2]=a,0;if(a=0|sn(0|e,0|t,52),S(),!(a&=15))return a=5,i[n>>2]=a,0;for(r=1;;){if(!(0==((0|un(7,0,3*(15-r|0)|0))&e|0)&0==((0|S())&t|0))){r=2,e=6;break}if(!(r>>>0<a>>>0)){r=5,e=6;break}r=r+1|0}return 6==(0|e)?(i[n>>2]=r,0):0},_maxGridDiskSize:function(e,t){t|=0;var n=0,r=0,a=0;return(0|(e|=0))<0?0|(t=2):(0|e)>13780509?0|(t=0|ft(15,t)):(a=0|nn(0|e,0|(n=((0|e)<0)<<31>>31),3,0),r=0|S(),n=0|Zt(0|e,0|n,1,0),n=0|Zt(0|(n=0|nn(0|a,0|r,0|n,0|S())),0|S(),1,0),e=0|S(),i[t>>2]=n,i[t+4>>2]=e,0|(t=0))},_maxPolygonToCellsSize:function(e,t,n,r){e|=0,t|=0,r|=0;var a,o=0,s=0,u=0,l=0,c=0;if(a=N,N=N+48|0,o=a+16|0,s=a+8|0,u=a,0|(n=0|Ct(n|=0)))return N=a,0|(u=n);if(l=0|i[(c=e)+4>>2],i[(n=s)>>2]=i[c>>2],i[n+4>>2]=l,Mt(s,o),!(n=0|ee(o,t,u))){if(t=0|i[s>>2],(0|(s=0|i[e+8>>2]))>0){o=0|i[e+12>>2],n=0;do{t=(0|i[o+(n<<3)>>2])+t|0,n=n+1|0}while((0|n)<(0|s))}o=0|i[(n=u)>>2],(0|(n=0|i[n+4>>2]))<(0|(s=((0|t)<0)<<31>>31))|(0|n)==(0|s)&o>>>0<t>>>0?(i[(n=u)>>2]=t,i[n+4>>2]=s,n=s):t=o,l=0|Zt(0|t,0|n,12,0),c=0|S(),i[(n=u)>>2]=l,i[n+4>>2]=c,i[(n=r)>>2]=l,i[n+4>>2]=c,n=0}return N=a,0|(c=n)},_maxPolygonToCellsSizeExperimental:function(e,t,n,o){t|=0,n|=0,o|=0;var s,u,c=0,h=0,d=0,p=0,A=0,v=0,m=0,g=0;if(u=N,N=N+48|0,A=u+32|0,p=u+40|0,s=u,!(0|i[(e|=0)>>2]))return i[(v=o)>>2]=0,i[v+4>>2]=0,N=u,0|(v=0);ze(A,0,0,0),c=0|i[(d=A)>>2],d=0|i[d+4>>2];do{if(t>>>0>15)i[(v=s)>>2]=0,i[v+4>>2]=0,i[s+8>>2]=4,i[s+12>>2]=-1,n=s+29|0,i[(v=s+16|0)>>2]=0,i[v+4>>2]=0,i[v+8>>2]=0,r[v+12>>0]=0,r[n>>0]=0|r[p>>0],r[n+1>>0]=0|r[p+1>>0],r[n+2>>0]=0|r[p+2>>0],n=4,v=9;else{if(0|(n=0|Ct(n))){i[(A=s)>>2]=0,i[A+4>>2]=0,i[s+8>>2]=n,i[s+12>>2]=-1,v=s+29|0,i[(A=s+16|0)>>2]=0,i[A+4>>2]=0,i[A+8>>2]=0,r[A+12>>0]=0,r[v>>0]=0|r[p>>0],r[v+1>>0]=0|r[p+1>>0],r[v+2>>0]=0|r[p+2>>0],v=9;break}if(!(n=0|Kt(1+(0|i[e+8>>2])|0,32))){i[(v=s)>>2]=0,i[v+4>>2]=0,i[s+8>>2]=13,i[s+12>>2]=-1,n=s+29|0,i[(v=s+16|0)>>2]=0,i[v+4>>2]=0,i[v+8>>2]=0,r[v+12>>0]=0,r[n>>0]=0|r[p>>0],r[n+1>>0]=0|r[p+1>>0],r[n+2>>0]=0|r[p+2>>0],n=13,v=9;break}Rt(e,n),i[(g=s)>>2]=c,i[g+4>>2]=d,i[(d=s+8|0)>>2]=0,i[s+12>>2]=t,i[s+20>>2]=e,i[s+24>>2]=n,r[s+28>>0]=0,r[(c=s+29|0)>>0]=0|r[p>>0],r[c+1>>0]=0|r[p+1>>0],r[c+2>>0]=0|r[p+2>>0],i[s+16>>2]=3,m=+Y(n),m*=+X(n),h=+l(+ +a[n>>3]),h=m/+f(+ +hn(+h,+ +l(+ +a[n+8>>3])))*6371.007180918475*6371.007180918475,n=0|i[(c=s+12|0)>>2];e:do{if((0|n)>0)do{if(ht(n+-1|0,A),!(h/+a[A>>3]>10))break e;n=(g=0|i[c>>2])+-1|0,i[c>>2]=n}while((0|g)>1)}while(0);if(St(s),i[(c=o)>>2]=0,i[c+4>>2]=0,!(0==(0|(n=0|i[(c=s)>>2]))&0==(0|(c=0|i[c+4>>2]))))do{qe(n,c,t,A),p=A,p=0|Zt(0|i[(e=o)>>2],0|i[e+4>>2],0|i[p>>2],0|i[p+4>>2]),e=0|S(),i[(g=o)>>2]=p,i[g+4>>2]=e,St(s),n=0|i[(g=s)>>2],c=0|i[g+4>>2]}while(!(0==(0|n)&0==(0|c)));n=0|i[d>>2]}}while(0);return N=u,0|(g=n)},_memcpy:dn,_memset:pn,_originToDirectedEdges:function(e,t,n){n|=0;var r,a=0;return r=0==(0|je(e|=0,t|=0)),t&=-2130706433,i[(a=n)>>2]=r?e:0,i[a+4>>2]=r?285212672|t:0,i[(a=n+8|0)>>2]=e,i[a+4>>2]=301989888|t,i[(a=n+16|0)>>2]=e,i[a+4>>2]=318767104|t,i[(a=n+24|0)>>2]=e,i[a+4>>2]=335544320|t,i[(a=n+32|0)>>2]=e,i[a+4>>2]=352321536|t,i[(n=n+40|0)>>2]=e,i[n+4>>2]=369098752|t,0},_pentagonCount:function(){return 12},_polygonToCells:function(e,t,n,r){e|=0,t|=0,r|=0;var a,o,s,u,l=0,c=0,h=0,f=0,d=0,p=0,A=0,v=0,m=0,g=0,y=0,_=0,b=0,x=0,w=0,T=0,E=0,k=0,M=0,C=0,R=0,P=0,I=0,L=0,U=0,B=0,z=0;if(u=N,N=N+112|0,a=u+80|0,d=u+72|0,o=u,s=u+56|0,0|(l=0|Ct(n|=0)))return N=u,0|(z=l);if(!(z=0|Qt(32+(i[(p=e+8|0)>>2]<<5)|0)))return N=u,0|(z=13);if(Rt(e,z),!(l=0|Ct(n))){if(B=0|i[(U=e)+4>>2],i[(l=d)>>2]=i[U>>2],i[l+4>>2]=B,Mt(d,a),l=0|ee(a,t,o))U=0,B=0;else{if(l=0|i[d>>2],(0|(c=0|i[p>>2]))>0){h=0|i[e+12>>2],n=0;do{l=(0|i[h+(n<<3)>>2])+l|0,n=n+1|0}while((0|n)!=(0|c));n=l}else n=l;c=0|i[(l=o)>>2],(0|(l=0|i[l+4>>2]))<(0|(h=((0|n)<0)<<31>>31))|(0|l)==(0|h)&c>>>0<n>>>0?(i[(l=o)>>2]=n,i[l+4>>2]=h,l=h):n=c,U=0|Zt(0|n,0|l,12,0),B=0|S(),i[(l=o)>>2]=U,i[l+4>>2]=B,l=0}if(!l){if(!(n=0|Kt(U,8)))return Yt(z),N=u,0|(z=13);if(!(f=0|Kt(U,8)))return Yt(z),Yt(n),N=u,0|(z=13);i[(I=a)>>2]=0,i[I+4>>2]=0,L=0|i[(I=e)+4>>2],i[(l=d)>>2]=i[I>>2],i[l+4>>2]=L,l=0|F(d,U,B,t,a,n,f);e:do{if(l)Yt(n),Yt(f),Yt(z);else{t:do{if((0|i[p>>2])>0){for(h=e+12|0,c=0;l=0|F((0|i[h>>2])+(c<<3)|0,U,B,t,a,n,f),c=c+1|0,!(0|l);)if((0|c)>=(0|i[p>>2]))break t;Yt(n),Yt(f),Yt(z);break e}}while(0);(0|B)>0|0==(0|B)&U>>>0>0&&pn(0|f,0,U<<3|0),I=0|i[(L=a)+4>>2];t:do{if((0|I)>0|0==(0|I)&(0|i[L>>2])>>>0>0){C=n,R=f,P=n,I=f,L=n,l=n,E=n,k=f,M=f,n=f;n:for(;;){for(b=0,x=0,w=0,T=0,c=0,h=0;;){d=(f=o)+56|0;do{i[f>>2]=0,f=f+4|0}while((0|f)<(0|d));if(0|D(p=0|i[(t=C+(b<<3)|0)>>2],t=0|i[t+4>>2],1,o,0)){d=(f=o)+56|0;do{i[f>>2]=0,f=f+4|0}while((0|f)<(0|d));0|(f=0|Kt(7,4))&&(O(p,t,1,o,f,7,0,0),Yt(f))}for(_=0;;){g=0|i[(y=o+(_<<3)|0)>>2],y=0|i[y+4>>2];r:do{if(0==(0|g)&0==(0|y))f=c,d=h;else{if(A=0|an(0|g,0|y,0|U,0|B),p=0|S(),!(0==(0|(d=0|i[(t=f=r+(A<<3)|0)>>2]))&0==(0|(t=0|i[t+4>>2])))){v=0,m=0;do{if((0|v)>(0|B)|(0|v)==(0|B)&m>>>0>U>>>0)break n;if((0|d)==(0|g)&(0|t)==(0|y)){f=c,d=h;break r}A=0|rn(0|(f=0|Zt(0|A,0|p,1,0)),0|S(),0|U,0|B),p=0|S(),m=0|Zt(0|m,0|v,1,0),v=0|S(),d=0|i[(t=f=r+(A<<3)|0)>>2],t=0|i[t+4>>2]}while(!(0==(0|d)&0==(0|t)))}if(0==(0|g)&0==(0|y)){f=c,d=h;break}tt(g,y,s),0|Pt(e,z,s)&&(m=0|Zt(0|c,0|h,1,0),h=0|S(),i[(v=f)>>2]=g,i[v+4>>2]=y,i[(c=R+(c<<3)|0)>>2]=g,i[c+4>>2]=y,c=m),f=c,d=h}}while(0);if((_=_+1|0)>>>0>=7)break;c=f,h=d}if(b=0|Zt(0|b,0|x,1,0),x=0|S(),w=0|Zt(0|w,0|T,1,0),T=0|S(),c=0|i[(h=a)>>2],!((0|T)<(0|(h=0|i[h+4>>2]))|(0|T)==(0|h)&w>>>0<c>>>0))break;c=f,h=d}if((0|h)>0|0==(0|h)&c>>>0>0){c=0,h=0;do{i[(T=C+(c<<3)|0)>>2]=0,i[T+4>>2]=0,c=0|Zt(0|c,0|h,1,0),h=0|S(),w=0|i[(T=a)+4>>2]}while((0|h)<(0|w)|((0|h)==(0|w)?c>>>0<(0|i[T>>2])>>>0:0))}if(i[(T=a)>>2]=f,i[T+4>>2]=d,!((0|d)>0|0==(0|d)&f>>>0>0))break t;_=n,b=M,x=L,w=k,T=R,n=E,M=l,k=P,E=_,l=b,L=I,I=x,P=w,R=C,C=T}Yt(P),Yt(I),Yt(z),l=1;break e}l=f}while(0);Yt(z),Yt(n),Yt(l),l=0}}while(0);return N=u,0|(z=l)}}return Yt(z),N=u,0|(z=l)},_polygonToCellsExperimental:function(e,t,n,r,a,o){r|=0,a|=0,o|=0;var s,u,l,c=0,h=0,f=0,d=0,p=0,A=0,v=0,m=0;l=N,N=N+160|0,h=l+64|0,p=l+112|0,m=l,Tt(d=l+80|0,e|=0,t|=0,n|=0),it(h,0|i[(f=d)>>2],0|i[f+4>>2],t),s=0|i[(f=h)>>2],f=0|i[f+4>>2],c=0|i[d+8>>2],i[(A=p+4|0)>>2]=i[d>>2],i[A+4>>2]=i[d+4>>2],i[A+8>>2]=i[d+8>>2],i[A+12>>2]=i[d+12>>2],i[A+16>>2]=i[d+16>>2],i[A+20>>2]=i[d+20>>2],i[A+24>>2]=i[d+24>>2],i[A+28>>2]=i[d+28>>2],i[(A=m)>>2]=s,i[A+4>>2]=f,i[(A=m+8|0)>>2]=c,t=p,n=(e=m+12|0)+36|0;do{i[e>>2]=i[t>>2],e=e+4|0,t=t+4|0}while((0|e)<(0|n));if(i[(p=m+48|0)>>2]=i[h>>2],i[p+4>>2]=i[h+4>>2],i[p+8>>2]=i[h+8>>2],i[p+12>>2]=i[h+12>>2],0==(0|s)&0==(0|f))return N=l,0|(m=c);n=m+16|0,u=m+24|0,d=m+28|0,c=0,h=0,t=s,e=f;do{if(!((0|c)<(0|a)|(0|c)==(0|a)&h>>>0<r>>>0)){v=4;break}if(f=h,h=0|Zt(0|h,0|c,1,0),c=0|S(),i[(f=o+(f<<3)|0)>>2]=t,i[f+4>>2]=e,ot(p),0==(0|(t=0|i[(e=p)>>2]))&0==(0|(e=0|i[e+4>>2]))){if(St(n),0==(0|(e=0|i[(t=n)>>2]))&0==(0|(t=0|i[t+4>>2]))){v=10;break}at(e,t,0|i[d>>2],p),t=0|i[(e=p)>>2],e=0|i[e+4>>2]}i[(f=m)>>2]=t,i[f+4>>2]=e}while(!(0==(0|t)&0==(0|e)));return 4==(0|v)?(0|(t=0|i[(e=m+40|0)>>2])&&Yt(t),i[(v=m+16|0)>>2]=0,i[v+4>>2]=0,i[u>>2]=0,i[m+36>>2]=0,i[d>>2]=-1,i[m+32>>2]=0,i[e>>2]=0,at(0,0,0,p),i[m>>2]=0,i[m+4>>2]=0,i[A>>2]=0,N=l,0|(m=14)):(10==(0|v)&&(i[m>>2]=0,i[m+4>>2]=0,i[A>>2]=i[u>>2]),m=0|i[A>>2],N=l,0|m)},_readInt64AsDoubleFromPointer:function(e){return+(+((0|i[(e|=0)>>2])>>>0)+4294967296*+(0|i[e+4>>2]))},_res0CellCount:function(){return 122},_round:An,_sbrk:vn,_sizeOfCellBoundary:function(){return 168},_sizeOfCoordIJ:function(){return 8},_sizeOfGeoLoop:function(){return 8},_sizeOfGeoPolygon:function(){return 16},_sizeOfH3Index:function(){return 8},_sizeOfLatLng:function(){return 16},_sizeOfLinkedGeoPolygon:function(){return 12},_uncompactCells:function(e,t,n,r,a,o,s){e|=0,r|=0,a|=0,o|=0;var u,l=0,c=0,h=0,f=0,d=0,p=0,A=0,v=0;if(u=N,N=N+16|0,v=u,!((0|(n|=0))>0|0==(0|n)&(t|=0)>>>0>0))return N=u,0|(v=0);if((0|(s|=0))>=16)return N=u,0|(v=12);p=0,A=0,d=0,l=0;e:for(;;){if(f=0|sn(0|(c=0|i[(h=e+(p<<3)|0)>>2]),0|(h=0|i[h+4>>2]),52),S(),(15&f|0)>(0|s)){l=12,c=11;break}if(it(v,c,h,s),0==(0|(h=0|i[(f=v)>>2]))&0==(0|(f=0|i[f+4>>2])))c=d;else{c=d;do{if(!((0|l)<(0|o)|(0|l)==(0|o)&c>>>0<a>>>0)){c=10;break e}i[(d=r+(c<<3)|0)>>2]=h,i[d+4>>2]=f,c=0|Zt(0|c,0|l,1,0),l=0|S(),ot(v),h=0|i[(d=v)>>2],f=0|i[d+4>>2]}while(!(0==(0|h)&0==(0|f)))}if(p=0|Zt(0|p,0|A,1,0),!((0|(A=0|S()))<(0|n)|(0|A)==(0|n)&p>>>0<t>>>0)){l=0,c=11;break}d=c}return 10==(0|c)?(N=u,0|(v=14)):11==(0|c)?(N=u,0|l):0},_uncompactCellsSize:function(e,t,n,r,a){e|=0,t|=0,n|=0,r|=0,a|=0;var o,s,u=0,l=0,c=0,h=0,f=0,d=0;s=N,N=N+16|0,o=s;e:do{if((0|n)>0|0==(0|n)&t>>>0>0){for(f=0,l=0,u=0,d=0;;){if(!(0==(0|(c=0|i[(h=e+(f<<3)|0)>>2]))&0==(0|(h=0|i[h+4>>2])))&&(h=0==(0|qe(c,h,r,o)),l=0|Zt(0|i[(c=o)>>2],0|i[c+4>>2],0|l,0|u),u=0|S(),!h)){u=12;break}if(f=0|Zt(0|f,0|d,1,0),!((0|(d=0|S()))<(0|n)|(0|d)==(0|n)&f>>>0<t>>>0))break e}return N=s,0|u}l=0,u=0}while(0);return i[a>>2]=l,i[a+4>>2]=u,N=s,0|(a=0)},_vertexToLatLng:function(e,t,n){n|=0;var r,a,o,s,u=0,l=0;return s=N,N=N+192|0,a=s,o=s+168|0,u=0|sn(0|(e|=0),0|(t|=0),56),S(),u&=7,0|(r=0|et(e,l=-2130706433&t|134217728,o))?(N=s,0|(l=r)):(t=0|sn(0|e,0|t,52),S(),t&=15,0|je(e,l)?Ne(o,t,u,1,a):Oe(o,t,u,1,a),l=a+8|0,i[n>>2]=i[l>>2],i[n+4>>2]=i[l+4>>2],i[n+8>>2]=i[l+8>>2],i[n+12>>2]=i[l+12>>2],N=s,0|(l=0))},establishStackSpace:function(e,t){N=e|=0},stackAlloc:function(e){var t;return t=N,N=(N=N+(e|=0)|0)+15&-16,0|t},stackRestore:function(e){N=e|=0},stackSave:function(){return 0|N}}}({Math:Math,Int8Array:Int8Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Float32Array:Float32Array,Float64Array:Float64Array},Z,A),$=(n.___divdi3=J.___divdi3,n.___muldi3=J.___muldi3,n.___remdi3=J.___remdi3,n.___uremdi3=J.___uremdi3,n._areNeighborCells=J._areNeighborCells,n._bitshift64Ashr=J._bitshift64Ashr,n._bitshift64Lshr=J._bitshift64Lshr,n._bitshift64Shl=J._bitshift64Shl,n._calloc=J._calloc,n._cellAreaKm2=J._cellAreaKm2,n._cellAreaM2=J._cellAreaM2,n._cellAreaRads2=J._cellAreaRads2,n._cellToBoundary=J._cellToBoundary,n._cellToCenterChild=J._cellToCenterChild,n._cellToChildPos=J._cellToChildPos,n._cellToChildren=J._cellToChildren,n._cellToChildrenSize=J._cellToChildrenSize,n._cellToLatLng=J._cellToLatLng,n._cellToLocalIj=J._cellToLocalIj,n._cellToParent=J._cellToParent,n._cellToVertex=J._cellToVertex,n._cellToVertexes=J._cellToVertexes,n._cellsToDirectedEdge=J._cellsToDirectedEdge,n._cellsToLinkedMultiPolygon=J._cellsToLinkedMultiPolygon,n._childPosToCell=J._childPosToCell,n._compactCells=J._compactCells,n._destroyLinkedMultiPolygon=J._destroyLinkedMultiPolygon,n._directedEdgeToBoundary=J._directedEdgeToBoundary,n._directedEdgeToCells=J._directedEdgeToCells,n._edgeLengthKm=J._edgeLengthKm,n._edgeLengthM=J._edgeLengthM,n._edgeLengthRads=J._edgeLengthRads,n._emscripten_replace_memory=J._emscripten_replace_memory),ee=(n._free=J._free,n._getBaseCellNumber=J._getBaseCellNumber,n._getDirectedEdgeDestination=J._getDirectedEdgeDestination,n._getDirectedEdgeOrigin=J._getDirectedEdgeOrigin,n._getHexagonAreaAvgKm2=J._getHexagonAreaAvgKm2,n._getHexagonAreaAvgM2=J._getHexagonAreaAvgM2,n._getHexagonEdgeLengthAvgKm=J._getHexagonEdgeLengthAvgKm,n._getHexagonEdgeLengthAvgM=J._getHexagonEdgeLengthAvgM,n._getIcosahedronFaces=J._getIcosahedronFaces,n._getNumCells=J._getNumCells,n._getPentagons=J._getPentagons,n._getRes0Cells=J._getRes0Cells,n._getResolution=J._getResolution,n._greatCircleDistanceKm=J._greatCircleDistanceKm,n._greatCircleDistanceM=J._greatCircleDistanceM,n._greatCircleDistanceRads=J._greatCircleDistanceRads,n._gridDisk=J._gridDisk,n._gridDiskDistances=J._gridDiskDistances,n._gridDistance=J._gridDistance,n._gridPathCells=J._gridPathCells,n._gridPathCellsSize=J._gridPathCellsSize,n._gridRingUnsafe=J._gridRingUnsafe,n._i64Add=J._i64Add,n._i64Subtract=J._i64Subtract,n._isPentagon=J._isPentagon,n._isResClassIII=J._isResClassIII,n._isValidCell=J._isValidCell,n._isValidDirectedEdge=J._isValidDirectedEdge,n._isValidVertex=J._isValidVertex,n._latLngToCell=J._latLngToCell,n._llvm_ctlz_i64=J._llvm_ctlz_i64,n._llvm_maxnum_f64=J._llvm_maxnum_f64,n._llvm_minnum_f64=J._llvm_minnum_f64,n._llvm_round_f64=J._llvm_round_f64,n._localIjToCell=J._localIjToCell,n._malloc=J._malloc,n._maxFaceCount=J._maxFaceCount,n._maxGridDiskSize=J._maxGridDiskSize,n._maxPolygonToCellsSize=J._maxPolygonToCellsSize,n._maxPolygonToCellsSizeExperimental=J._maxPolygonToCellsSizeExperimental,n._memcpy=J._memcpy,n._memset=J._memset,n._originToDirectedEdges=J._originToDirectedEdges,n._pentagonCount=J._pentagonCount,n._polygonToCells=J._polygonToCells,n._polygonToCellsExperimental=J._polygonToCellsExperimental,n._readInt64AsDoubleFromPointer=J._readInt64AsDoubleFromPointer,n._res0CellCount=J._res0CellCount,n._round=J._round,n._sbrk=J._sbrk,n._sizeOfCellBoundary=J._sizeOfCellBoundary,n._sizeOfCoordIJ=J._sizeOfCoordIJ,n._sizeOfGeoLoop=J._sizeOfGeoLoop,n._sizeOfGeoPolygon=J._sizeOfGeoPolygon,n._sizeOfH3Index=J._sizeOfH3Index,n._sizeOfLatLng=J._sizeOfLatLng,n._sizeOfLinkedGeoPolygon=J._sizeOfLinkedGeoPolygon,n._uncompactCells=J._uncompactCells,n._uncompactCellsSize=J._uncompactCellsSize,n._vertexToLatLng=J._vertexToLatLng,n.establishStackSpace=J.establishStackSpace,n.stackAlloc=J.stackAlloc),te=n.stackRestore=J.stackRestore,ne=n.stackSave=J.stackSave;if(n.asm=J,n.cwrap=function(e,t,n,r){var i=(n=n||[]).every((function(e){return"number"===e}));return"string"!==t&&i&&!r?h(e):function(){return f(e,t,n,arguments)}},n.setValue=function(e,t,n,r){switch("*"===(n=n||"i8").charAt(n.length-1)&&(n="i32"),n){case"i1":case"i8":v[e>>0]=t;break;case"i16":g[e>>1]=t;break;case"i32":y[e>>2]=t;break;case"i64":B=[t>>>0,(U=t,+R(U)>=1?U>0?(0|I(+N(U/4294967296),4294967295))>>>0:~~+P((U-+(~~U>>>0))/4294967296)>>>0:0)],y[e>>2]=B[0],y[e+4>>2]=B[1];break;case"float":_[e>>2]=t;break;case"double":b[e>>3]=t;break;default:ue("invalid type for setValue: "+n)}},n.getValue=function(e,t,n){switch("*"===(t=t||"i8").charAt(t.length-1)&&(t="i32"),t){case"i1":case"i8":return v[e>>0];case"i16":return g[e>>1];case"i32":case"i64":return y[e>>2];case"float":return _[e>>2];case"double":return b[e>>3];default:ue("invalid type for getValue: "+t)}return null},F){V(F)||(Y=F,F=n.locateFile?n.locateFile(Y,o):o+Y),L++,n.monitorRunDependencies&&n.monitorRunDependencies(L);var re=function(e){e.byteLength&&(e=new Uint8Array(e)),m.set(e,8),n.memoryInitializerRequest&&delete n.memoryInitializerRequest.response,function(e){if(L--,n.monitorRunDependencies&&n.monitorRunDependencies(L),0==L&&(null!==D&&(clearInterval(D),D=null),O)){var t=O;O=null,t()}}()},ie=function(){i(F,re,(function(){throw"could not load memory initializer "+F}))},ae=Q(F);if(ae)re(ae.buffer);else if(n.memoryInitializerRequest){var oe=function(){var e=n.memoryInitializerRequest,t=e.response;if(200!==e.status&&0!==e.status){var r=Q(n.memoryInitializerRequestURL);if(!r)return console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+e.status+", retrying "+F),void ie();t=r.buffer}re(t)};n.memoryInitializerRequest.response?setTimeout(oe,0):n.memoryInitializerRequest.addEventListener("load",oe)}else ie()}function se(e){function t(){K||(K=!0,c||(S(k),S(M),n.onRuntimeInitialized&&n.onRuntimeInitialized(),function(){if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)e=n.postRun.shift(),C.unshift(e);var e;S(C)}()))}e=e||a,L>0||(!function(){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)e=n.preRun.shift(),E.unshift(e);var e;S(E)}(),L>0||(n.setStatus?(n.setStatus("Running..."),setTimeout((function(){setTimeout((function(){n.setStatus("")}),1),t()}),1)):t()))}function ue(e){throw n.onAbort&&n.onAbort(e),s(e+=""),u(e),c=!0,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(O=function e(){K||se(),K||(O=e)},n.run=se,n.abort=ue,n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return se(),e}("object"===typeof Qy?Qy:{}),Yy="number",Ky={0:"Success",1:"The operation failed but a more specific error is not available",2:"Argument was outside of acceptable range",3:"Latitude or longitude arguments were outside of acceptable range",4:"Resolution argument was outside of acceptable range",5:"Cell argument was not valid",6:"Directed edge argument was not valid",7:"Undirected edge argument was not valid",8:"Vertex argument was not valid",9:"Pentagon distortion was encountered",10:"Duplicate input",11:"Cell arguments were not neighbors",12:"Cell arguments had incompatible resolutions",13:"Memory allocation failed",14:"Bounds of provided memory were insufficient",15:"Mode or flags argument was not valid"},Zy={1e3:"Unknown unit",1001:"Array length out of bounds",1002:"Got unexpected null value for H3 index"};function Jy(e,t,n){var r=n&&"value"in n,i=new Error((e[t]||"Unknown error")+" (code: "+t+(r?", value: "+n.value:"")+")");return i.code=t,i}function $y(e,t){var n=2===arguments.length?{value:t}:{};return Jy(Ky,e,n)}function e_(e,t){var n=2===arguments.length?{value:t}:{};return Jy(Zy,e,n)}function t_(e){if(0!==e)throw $y(e)}var n_={};[["sizeOfH3Index",Yy],["sizeOfLatLng",Yy],["sizeOfCellBoundary",Yy],["sizeOfGeoLoop",Yy],["sizeOfGeoPolygon",Yy],["sizeOfLinkedGeoPolygon",Yy],["sizeOfCoordIJ",Yy],["readInt64AsDoubleFromPointer",Yy],["isValidCell",Yy,[Yy,Yy]],["latLngToCell",Yy,[Yy,Yy,Yy,Yy]],["cellToLatLng",Yy,[Yy,Yy,Yy]],["cellToBoundary",Yy,[Yy,Yy,Yy]],["maxGridDiskSize",Yy,[Yy,Yy]],["gridDisk",Yy,[Yy,Yy,Yy,Yy]],["gridDiskDistances",Yy,[Yy,Yy,Yy,Yy,Yy]],["gridRingUnsafe",Yy,[Yy,Yy,Yy,Yy]],["maxPolygonToCellsSize",Yy,[Yy,Yy,Yy,Yy]],["polygonToCells",Yy,[Yy,Yy,Yy,Yy]],["maxPolygonToCellsSizeExperimental",Yy,[Yy,Yy,Yy,Yy]],["polygonToCellsExperimental",Yy,[Yy,Yy,Yy,Yy,Yy,Yy]],["cellsToLinkedMultiPolygon",Yy,[Yy,Yy,Yy]],["destroyLinkedMultiPolygon",null,[Yy]],["compactCells",Yy,[Yy,Yy,Yy,Yy]],["uncompactCells",Yy,[Yy,Yy,Yy,Yy,Yy,Yy]],["uncompactCellsSize",Yy,[Yy,Yy,Yy,Yy,Yy]],["isPentagon",Yy,[Yy,Yy]],["isResClassIII",Yy,[Yy,Yy]],["getBaseCellNumber",Yy,[Yy,Yy]],["getResolution",Yy,[Yy,Yy]],["maxFaceCount",Yy,[Yy,Yy,Yy]],["getIcosahedronFaces",Yy,[Yy,Yy,Yy]],["cellToParent",Yy,[Yy,Yy,Yy,Yy]],["cellToChildren",Yy,[Yy,Yy,Yy,Yy]],["cellToCenterChild",Yy,[Yy,Yy,Yy,Yy]],["cellToChildrenSize",Yy,[Yy,Yy,Yy,Yy]],["cellToChildPos",Yy,[Yy,Yy,Yy,Yy]],["childPosToCell",Yy,[Yy,Yy,Yy,Yy,Yy,Yy]],["areNeighborCells",Yy,[Yy,Yy,Yy,Yy,Yy]],["cellsToDirectedEdge",Yy,[Yy,Yy,Yy,Yy,Yy]],["getDirectedEdgeOrigin",Yy,[Yy,Yy,Yy]],["getDirectedEdgeDestination",Yy,[Yy,Yy,Yy]],["isValidDirectedEdge",Yy,[Yy,Yy]],["directedEdgeToCells",Yy,[Yy,Yy,Yy]],["originToDirectedEdges",Yy,[Yy,Yy,Yy]],["directedEdgeToBoundary",Yy,[Yy,Yy,Yy]],["gridDistance",Yy,[Yy,Yy,Yy,Yy,Yy]],["gridPathCells",Yy,[Yy,Yy,Yy,Yy,Yy]],["gridPathCellsSize",Yy,[Yy,Yy,Yy,Yy,Yy]],["cellToLocalIj",Yy,[Yy,Yy,Yy,Yy,Yy,Yy]],["localIjToCell",Yy,[Yy,Yy,Yy,Yy,Yy]],["getHexagonAreaAvgM2",Yy,[Yy,Yy]],["getHexagonAreaAvgKm2",Yy,[Yy,Yy]],["getHexagonEdgeLengthAvgM",Yy,[Yy,Yy]],["getHexagonEdgeLengthAvgKm",Yy,[Yy,Yy]],["greatCircleDistanceM",Yy,[Yy,Yy]],["greatCircleDistanceKm",Yy,[Yy,Yy]],["greatCircleDistanceRads",Yy,[Yy,Yy]],["cellAreaM2",Yy,[Yy,Yy,Yy]],["cellAreaKm2",Yy,[Yy,Yy,Yy]],["cellAreaRads2",Yy,[Yy,Yy,Yy]],["edgeLengthM",Yy,[Yy,Yy,Yy]],["edgeLengthKm",Yy,[Yy,Yy,Yy]],["edgeLengthRads",Yy,[Yy,Yy,Yy]],["getNumCells",Yy,[Yy,Yy]],["getRes0Cells",Yy,[Yy]],["res0CellCount",Yy],["getPentagons",Yy,[Yy,Yy]],["pentagonCount",Yy],["cellToVertex",Yy,[Yy,Yy,Yy,Yy]],["cellToVertexes",Yy,[Yy,Yy,Yy]],["vertexToLatLng",Yy,[Yy,Yy,Yy]],["isValidVertex",Yy,[Yy,Yy]]].forEach((function(e){n_[e[0]]=Qy.cwrap.apply(Qy,e)}));var r_=16,i_=n_.sizeOfH3Index(),a_=n_.sizeOfLatLng(),o_=n_.sizeOfCellBoundary(),s_=n_.sizeOfGeoPolygon(),u_=n_.sizeOfGeoLoop();n_.sizeOfLinkedGeoPolygon(),n_.sizeOfCoordIJ();function l_(e){if("number"!==typeof e||e<0||e>15||Math.floor(e)!==e)throw $y(4,e);return e}function c_(e){if(!e)throw e_(1002);return e}var h_=Math.pow(2,32)-1;function f_(e){if(e>h_)throw e_(1001,e);return e}var d_=/[^0-9a-fA-F]/;function p_(e){if(Array.isArray(e)&&2===e.length&&Number.isInteger(e[0])&&Number.isInteger(e[1]))return e;if("string"!==typeof e||d_.test(e))return[0,0];var t=parseInt(e.substring(0,e.length-8),r_);return[parseInt(e.substring(e.length-8),r_),t]}function A_(e){if(e>=0)return e.toString(r_);var t=v_(8,(e&=2147483647).toString(r_));return t=(parseInt(t[0],r_)+8).toString(r_)+t.substring(1)}function v_(e,t){for(var n=e-t.length,r="",i=0;i<n;i++)r+="0";return r+=t}Math.pow(2,32);function m_(e,t,n){for(var r=e.length,i=Qy._calloc(r,a_),a=n?1:0,o=n?0:1,s=0;s<2*r;s+=2)Qy.HEAPF64.set([e[s/2][a],e[s/2][o]].map(L_),i/8+s);return Qy.HEAPU32.set([r,i],t/4),t}function g_(e,t){var n,r=e.length-1,i=Qy._calloc(s_),a=0+u_,o=a+4;if(m_(e[0],i+0,t),r>0){n=Qy._calloc(r,u_);for(var s=0;s<r;s++)m_(e[s+1],n+u_*s,t)}return Qy.setValue(i+a,r,"i32"),Qy.setValue(i+o,n,"i32"),i}function y_(e){var t=0+u_,n=t+4;Qy._free(Qy.getValue(e+0+4,"i8*"));var r=Qy.getValue(e+t,"i32");if(r>0){for(var i=Qy.getValue(e+n,"i32"),a=0;a<r;a++)Qy._free(Qy.getValue(i+u_*a+4,"i8*"));Qy._free(i)}Qy._free(e)}function __(e,t){void 0===t&&(t=0);var n=Qy.getValue(e+i_*t,"i32"),r=Qy.getValue(e+i_*t+4,"i32");return r?function(e,t){return A_(t)+v_(8,A_(e))}(n,r):null}function b_(e){return n_.readInt64AsDoubleFromPointer(e)}function x_(e,t){for(var n=[],r=0;r<t;r++){var i=__(e,r);null!==i&&n.push(i)}return n}function w_(e){return 180*Qy.getValue(e,"double")/Math.PI}function T_(e){return[w_(e),w_(e+8)]}function S_(e){return[w_(e+8),w_(e)]}function E_(e,t,n){for(var r=Qy.getValue(e,"i32"),i=e+8,a=[],o=t?S_:T_,s=0;s<2*r;s+=2)a.push(o(i+8*s));return n&&a.push(a[0]),a}function k_(e,t,n){var r=Qy._malloc(a_);Qy.HEAPF64.set([e,t].map(L_),r/8);var i=Qy._malloc(i_);try{return t_(n_.latLngToCell(r,n,i)),c_(__(i))}finally{Qy._free(i),Qy._free(r)}}function M_(e){var t=Qy._malloc(a_),n=p_(e),r=n[0],i=n[1];try{return t_(n_.cellToLatLng(r,i,t)),T_(t)}finally{Qy._free(t)}}function C_(e,t){var n=Qy._malloc(o_),r=p_(e),i=r[0],a=r[1];try{return t_(n_.cellToBoundary(i,a,n)),E_(n,t,t)}finally{Qy._free(n)}}function R_(e,t,n){if(l_(t),n=Boolean(n),0===e.length||0===e[0].length)return[];var r=g_("number"===typeof e[0][0]?[e]:e,n),i=Qy._malloc(8);try{t_(n_.maxPolygonToCellsSize(r,t,0,i));var a=f_(b_(i)),o=Qy._calloc(a,i_);try{return t_(n_.polygonToCells(r,t,0,o)),x_(o,a)}finally{Qy._free(o)}}finally{Qy._free(i),y_(r)}}var P_,N_,I_;function L_(e){return e*Math.PI/180}function D_(e,t){var n=0;if(void 0===t){var r,i=k(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;(a=+a)&&(n+=a)}}catch(c){i.e(c)}finally{i.f()}}else{var o,s=-1,u=k(e);try{for(u.s();!(o=u.n()).done;){var l=o.value;(l=+t(l,++s,e))&&(n+=l)}}catch(c){u.e(c)}finally{u.f()}}return n}var O_=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveMap","envMap","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"],U_=function(){function e(t){c(this,e),this.renderObjects=new WeakMap,this.hasNode=this.containsNode(t),this.hasAnimation=!0===t.object.isSkinnedMesh,this.refreshUniforms=O_,this.renderId=0}return p(e,[{key:"firstInitialization",value:function(e){return!1===this.renderObjects.has(e)&&(this.getRenderObjectData(e),!0)}},{key:"getRenderObjectData",value:function(e){var t=this.renderObjects.get(e);if(void 0===t){var n=e.geometry,r=e.material,i=e.object;if(t={material:this.getMaterialData(r),geometry:{id:n.id,attributes:this.getAttributesData(n.attributes),indexVersion:n.index?n.index.version:null,drawRange:{start:n.drawRange.start,count:n.drawRange.count}},worldMatrix:i.matrixWorld.clone()},i.center&&(t.center=i.center.clone()),i.morphTargetInfluences&&(t.morphTargetInfluences=i.morphTargetInfluences.slice()),null!==e.bundle&&(t.version=e.bundle.version),t.material.transmission>0){var a=e.context,o=a.width,s=a.height;t.bufferWidth=o,t.bufferHeight=s}this.renderObjects.set(e,t)}return t}},{key:"getAttributesData",value:function(e){var t={};for(var n in e){var r=e[n];t[n]={version:r.version}}return t}},{key:"containsNode",value:function(e){var t=e.material;for(var n in t)if(t[n]&&t[n].isNode)return!0;return null!==e.renderer.nodes.modelViewMatrix||null!==e.renderer.nodes.modelNormalViewMatrix}},{key:"getMaterialData",value:function(e){var t,n={},r=k(this.refreshUniforms);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=e[i];null!==a&&void 0!==a&&("object"===typeof a&&void 0!==a.clone?!0===a.isTexture?n[i]={id:a.id,version:a.version}:n[i]=a.clone():n[i]=a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"equals",value:function(e){var t=e.object,n=e.material,r=e.geometry,i=this.getRenderObjectData(e);if(!0!==i.worldMatrix.equals(t.matrixWorld))return i.worldMatrix.copy(t.matrixWorld),!1;var a=i.material;for(var o in a){var s=a[o],u=n[o];if(void 0!==s.equals){if(!1===s.equals(u))return s.copy(u),!1}else if(!0===u.isTexture){if(s.id!==u.id||s.version!==u.version)return s.id=u.id,s.version=u.version,!1}else if(s!==u)return a[o]=u,!1}if(a.transmission>0){var l=e.context,c=l.width,h=l.height;if(i.bufferWidth!==c||i.bufferHeight!==h)return i.bufferWidth=c,i.bufferHeight=h,!1}var f=i.geometry,d=r.attributes,p=f.attributes,A=Object.keys(p),v=Object.keys(d);if(f.id!==r.id)return f.id=r.id,!1;if(A.length!==v.length)return i.geometry.attributes=this.getAttributesData(d),!1;for(var m=0,g=A;m<g.length;m++){var y=g[m],_=p[y],b=d[y];if(void 0===b)return delete p[y],!1;if(_.version!==b.version)return _.version=b.version,!1}var x=r.index,w=f.indexVersion,T=x?x.version:null;if(w!==T)return f.indexVersion=T,!1;if(f.drawRange.start!==r.drawRange.start||f.drawRange.count!==r.drawRange.count)return f.drawRange.start=r.drawRange.start,f.drawRange.count=r.drawRange.count,!1;if(i.morphTargetInfluences){for(var S=!1,E=0;E<i.morphTargetInfluences.length;E++)i.morphTargetInfluences[E]!==t.morphTargetInfluences[E]&&(S=!0);if(S)return!0}return i.center&&!1===i.center.equals(t.center)?(i.center.copy(t.center),!0):(null!==e.bundle&&(i.version=e.bundle.version),!0)}},{key:"needsRefresh",value:function(e,t){if(this.hasNode||this.hasAnimation||this.firstInitialization(e))return!0;var n=t.renderId;if(this.renderId!==n)return this.renderId=n,!0;var r=!0===e.object.static,i=null!==e.bundle&&!0===e.bundle.static&&this.getRenderObjectData(e).version===e.bundle.version;return!r&&!i&&!0!==this.equals(e)}}]),e}();function B_(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=3735928559^t,r=1103547991^t;if(e instanceof Array)for(var i,a=0;a<e.length;a++)i=e[a],n=Math.imul(n^i,2654435761),r=Math.imul(r^i,1597334677);else for(var o,s=0;s<e.length;s++)o=e.charCodeAt(s),n=Math.imul(n^o,2654435761),r=Math.imul(r^o,1597334677);return n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507),4294967296*(2097151&(r^=Math.imul(n^n>>>13,3266489909)))+(n>>>0)}var F_=function(e){return B_(e)},z_=function(e){return B_(e)},V_=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return B_(t)};function q_(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];!0===e.isNode&&(n.push(e.id),e=e.getSelf());var r,i=k(j_(e));try{for(i.s();!(r=i.n()).done;){var a=r.value,o=a.property,s=a.childNode;n.push(B_(o.slice(0,-4)),s.getCacheKey(t))}}catch(u){i.e(u)}finally{i.f()}return B_(n)}function j_(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return ft().mark((function n(){var r,i,a,o,s,u;return ft().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=ft().keys(e);case 1:if((n.t1=n.t0()).done){n.next=35;break}if(!0!==(r=n.t1.value).startsWith("_")){n.next=5;break}return n.abrupt("continue",1);case 5:if(i=e[r],!0!==Array.isArray(i)){n.next=18;break}a=0;case 8:if(!(a<i.length)){n.next=16;break}if(!(o=i[a])||!(!0===o.isNode||t&&"function"===typeof o.toJSON)){n.next=13;break}return n.next=13,{property:r,index:a,childNode:o};case 13:a++,n.next=8;break;case 16:n.next=33;break;case 18:if(!i||!0!==i.isNode){n.next=23;break}return n.next=21,{property:r,childNode:i};case 21:n.next=33;break;case 23:if("object"!==typeof i){n.next=33;break}n.t2=ft().keys(i);case 25:if((n.t3=n.t2()).done){n.next=33;break}if(s=n.t3.value,!(u=i[s])||!(!0===u.isNode||t&&"function"===typeof u.toJSON)){n.next=31;break}return n.next=31,{property:r,index:s,childNode:u};case 31:n.next=25;break;case 33:n.next=1;break;case 35:case"end":return n.stop()}}),n)}))()}var G_=new Map([[1,"float"],[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),H_=new WeakMap;function W_(e){return G_.get(e)}function X_(e){if(/[iu]?vec\d/.test(e))return e.startsWith("ivec")?Int32Array:e.startsWith("uvec")?Uint32Array:Float32Array;if(/mat\d/.test(e))return Float32Array;if(/float/.test(e))return Float32Array;if(/uint/.test(e))return Uint32Array;if(/int/.test(e))return Int32Array;throw new Error("THREE.NodeUtils: Unsupported type: ".concat(e))}function Q_(e){return/float|int|uint/.test(e)?1:/vec2/.test(e)?2:/vec3/.test(e)?3:/vec4/.test(e)||/mat2/.test(e)?4:/mat3/.test(e)?9:/mat4/.test(e)?16:void console.error("THREE.TSL: Unsupported type:",e)}function Y_(e){if(void 0===e||null===e)return null;var t=typeof e;return!0===e.isNode?"node":"number"===t?"float":"boolean"===t?"bool":"string"===t?"string":"function"===t?"shader":!0===e.isVector2?"vec2":!0===e.isVector3?"vec3":!0===e.isVector4?"vec4":!0===e.isMatrix2?"mat2":!0===e.isMatrix3?"mat3":!0===e.isMatrix4?"mat4":!0===e.isColor?"color":e instanceof ArrayBuffer?"ArrayBuffer":null}function K_(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=e?e.slice(-4):void 0;return 1===n.length&&("vec2"===i?n=[n[0],n[0]]:"vec3"===i?n=[n[0],n[0],n[0]]:"vec4"===i&&(n=[n[0],n[0],n[0],n[0]])),"color"===e?S(ga,l(n)):"vec2"===i?S(_r,l(n)):"vec3"===i?S(Kr,l(n)):"vec4"===i?S(Gr,l(n)):"mat2"===i?S(kl,l(n)):"mat3"===i?S(br,l(n)):"mat4"===i?S(Ei,l(n)):"bool"===e?n[0]||!1:"float"===e||"int"===e||"uint"===e?n[0]||0:"string"===e?n[0]||"":"ArrayBuffer"===e?$_(n[0]):null}function Z_(e){var t=H_.get(e);return void 0===t&&(t={},H_.set(e,t)),t}function J_(e){for(var t="",n=new Uint8Array(e),r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return btoa(t)}function $_(e){return Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)})).buffer}var eb={VERTEX:"vertex",FRAGMENT:"fragment"},tb={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},nb={READ_ONLY:"readOnly",WRITE_ONLY:"writeOnly",READ_WRITE:"readWrite"},rb=["fragment","vertex"],ib=["setup","analyze","generate"],ab=[].concat(rb,["compute"]),ob=["x","y","z","w"],sb=0,ub=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return c(this,n),(e=t.call(this)).nodeType=r,e.updateType=tb.NONE,e.updateBeforeType=tb.NONE,e.updateAfterType=tb.NONE,e.uuid=yr.generateUUID(),e.version=0,e.global=!1,e.isNode=!0,e._cacheKey=null,e._cacheKeyVersion=0,Object.defineProperty(y(e),"id",{value:sb++}),e}return p(n,[{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"type",get:function(){return this.constructor.type}},{key:"onUpdate",value:function(e,t){return this.updateType=t,this.update=e.bind(this.getSelf()),this}},{key:"onFrameUpdate",value:function(e){return this.onUpdate(e,tb.FRAME)}},{key:"onRenderUpdate",value:function(e){return this.onUpdate(e,tb.RENDER)}},{key:"onObjectUpdate",value:function(e){return this.onUpdate(e,tb.OBJECT)}},{key:"onReference",value:function(e){return this.updateReference=e.bind(this.getSelf()),this}},{key:"getSelf",value:function(){return this.self||this}},{key:"updateReference",value:function(){return this}},{key:"isGlobal",value:function(){return this.global}},{key:"getChildren",value:ft().mark((function e(){var t,n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=k(j_(this)),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return r=n.value.childNode,e.next=7,r;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"traverse",value:function(e){e(this);var t,n=k(this.getChildren());try{for(n.s();!(t=n.n()).done;){t.value.traverse(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"getCacheKey",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!0!==(e=e||this.version!==this._cacheKeyVersion)&&null!==this._cacheKey||(this._cacheKey=V_(q_(this,e),this.customCacheKey()),this._cacheKeyVersion=this.version),this._cacheKey}},{key:"customCacheKey",value:function(){return 0}},{key:"getScope",value:function(){return this}},{key:"getHash",value:function(){return this.uuid}},{key:"getUpdateType",value:function(){return this.updateType}},{key:"getUpdateBeforeType",value:function(){return this.updateBeforeType}},{key:"getUpdateAfterType",value:function(){return this.updateAfterType}},{key:"getElementType",value:function(e){var t=this.getNodeType(e);return e.getElementType(t)}},{key:"getMemberType",value:function(){return"void"}},{key:"getNodeType",value:function(e){var t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}},{key:"getShared",value:function(e){var t=this.getHash(e);return e.getNodeFromHash(t)||this}},{key:"setup",value:function(e){var t,n=e.getNodeProperties(this),r=0,i=k(this.getChildren());try{for(i.s();!(t=i.n()).done;){var a=t.value;n["node"+r++]=a}}catch(o){i.e(o)}finally{i.f()}return n.outputNode||null}},{key:"analyze",value:function(e){if(1===e.increaseUsage(this))for(var t=e.getNodeProperties(this),n=0,r=Object.values(t);n<r.length;n++){var i=r[n];i&&!0===i.isNode&&i.build(e)}}},{key:"generate",value:function(e,t){var n=e.getNodeProperties(this).outputNode;if(n&&!0===n.isNode)return n.build(e,t)}},{key:"updateBefore",value:function(){console.warn("Abstract function.")}},{key:"updateAfter",value:function(){console.warn("Abstract function.")}},{key:"update",value:function(){console.warn("Abstract function.")}},{key:"build",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getShared(e);if(this!==n)return n.build(e,t);e.addNode(this),e.addChain(this);var r=null,i=e.getBuildStage();if("setup"===i){this.updateReference(e);var a=e.getNodeProperties(this);if(!0!==a.initialized){a.initialized=!0;for(var o=this.setup(e),s=o&&!0===o.isNode,u=0,l=Object.values(a);u<l.length;u++){var c=l[u];c&&!0===c.isNode&&c.build(e)}s&&o.build(e),a.outputNode=o}}else if("analyze"===i)this.analyze(e);else if("generate"===i){var h=1===this.generate.length;if(h){var f=this.getNodeType(e),d=e.getDataFromNode(this);void 0===(r=d.snippet)?void 0===d.generated?(d.generated=!0,r=this.generate(e)||"",d.snippet=r):(console.warn("THREE.Node: Recursion detected.",this),r=""):void 0!==d.flowCodes&&void 0!==e.context.nodeBlock&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),r=e.format(r,f,t)}else r=this.generate(e,t)||""}return e.removeChain(this),e.addSequentialNode(this),r}},{key:"getSerializeChildren",value:function(){return j_(this)}},{key:"serialize",value:function(e){var t,n={},r=k(this.getSerializeChildren());try{for(r.s();!(t=r.n()).done;){var i=t.value,a=i.property,o=i.index,s=i.childNode;void 0!==o?(void 0===n[a]&&(n[a]=Number.isInteger(o)?[]:{}),n[a][o]=s.toJSON(e.meta).uuid):n[a]=s.toJSON(e.meta).uuid}}catch(u){r.e(u)}finally{r.f()}Object.keys(n).length>0&&(e.inputNodes=n)}},{key:"deserialize",value:function(e){if(void 0!==e.inputNodes){var t=e.meta.nodes;for(var n in e.inputNodes)if(Array.isArray(e.inputNodes[n])){var r,i=[],a=k(e.inputNodes[n]);try{for(a.s();!(r=a.n()).done;){var o=r.value;i.push(t[o])}}catch(h){a.e(h)}finally{a.f()}this[n]=i}else if("object"===typeof e.inputNodes[n]){var s={};for(var u in e.inputNodes[n]){var l=e.inputNodes[n][u];s[u]=t[l]}this[n]=s}else{var c=e.inputNodes[n];this[n]=t[c]}}}},{key:"toJSON",value:function(e){var t=this.uuid,n=this.type,r=void 0===e||"string"===typeof e;r&&(e={textures:{},images:{},nodes:{}});var i=e.nodes[t];function a(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(void 0===i&&(i={uuid:t,type:n,meta:e,metadata:{version:4.6,type:"Node",generator:"Node.toJSON"}},!0!==r&&(e.nodes[i.uuid]=i),this.serialize(i),delete i.meta),r){var o=a(e.textures),s=a(e.images),u=a(e.nodes);o.length>0&&(i.textures=o),s.length>0&&(i.images=s),u.length>0&&(i.nodes=u)}return i}}],[{key:"type",get:function(){return"Node"}}]),n}(ur),lb=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this)).node=e,i.indexNode=r,i.isArrayElementNode=!0,i}return p(n,[{key:"getNodeType",value:function(e){return this.node.getElementType(e)}},{key:"generate",value:function(e){var t=this.indexNode.getNodeType(e),n=this.node.build(e),r=this.indexNode.build(e,!e.isVector(t)&&e.isInteger(t)?t:"uint");return"".concat(n,"[ ").concat(r," ]")}}],[{key:"type",get:function(){return"ArrayElementNode"}}]),n}(ub),cb=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this)).node=e,i.convertTo=r,i}return p(n,[{key:"getNodeType",value:function(e){var t,n=this.node.getNodeType(e),r=null,i=k(this.convertTo.split("|"));try{for(i.s();!(t=i.n()).done;){var a=t.value;null!==r&&e.getTypeLength(n)!==e.getTypeLength(a)||(r=a)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"serialize",value:function(e){ht(m(n.prototype),"serialize",this).call(this,e),e.convertTo=this.convertTo}},{key:"deserialize",value:function(e){ht(m(n.prototype),"deserialize",this).call(this,e),this.convertTo=e.convertTo}},{key:"generate",value:function(e,t){var n=this.node,r=this.getNodeType(e),i=n.build(e,r);return e.format(i,r,t)}}],[{key:"type",get:function(){return"ConvertNode"}}]),n}(ub),hb=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return c(this,n),(e=t.call(this,r)).isTempNode=!0,e}return p(n,[{key:"hasDependencies",value:function(e){return e.getDataFromNode(this).usageCount>1}},{key:"build",value:function(e,t){if("generate"===e.getBuildStage()){var r=e.getVectorType(this.getNodeType(e,t)),i=e.getDataFromNode(this);if(void 0!==i.propertyName)return e.format(i.propertyName,r,t);if("void"!==r&&"void"!==t&&this.hasDependencies(e)){var a=ht(m(n.prototype),"build",this).call(this,e,r),o=e.getVarFromNode(this,null,r),s=e.getPropertyName(o);return e.addLineFlowCode("".concat(s," = ").concat(a),this),i.snippet=a,i.propertyName=s,e.format(i.propertyName,r,t)}}return ht(m(n.prototype),"build",this).call(this,e,t)}}],[{key:"type",get:function(){return"TempNode"}}]),n}(ub),fb=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(e=t.call(this,i)).nodes=r,e}return p(n,[{key:"getNodeType",value:function(e){return null!==this.nodeType?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((function(t,n){return t+e.getTypeLength(n.getNodeType(e))}),0))}},{key:"generate",value:function(e,t){var n,r=this.getNodeType(e),i=e.getTypeLength(r),a=this.nodes,o=e.getComponentType(r),s=[],u=0,l=k(a);try{for(l.s();!(n=l.n()).done;){var c=n.value;if(u>=i){console.error("THREE.TSL: Length of parameters exceeds maximum length of function '".concat(r,"()' type."));break}var h=c.getNodeType(e),f=e.getTypeLength(h),d=void 0;u+f>i&&(console.error("THREE.TSL: Length of '".concat(r,"()' data exceeds maximum length of output type.")),f=i-u,h=e.getTypeFromLength(f)),u+=f,d=c.build(e,h);var p=e.getComponentType(h);p!==o&&(d=e.format(d,p,o)),s.push(d)}}catch(v){l.e(v)}finally{l.f()}var A="".concat(e.getType(r),"( ").concat(s.join(", ")," )");return e.format(A,r,t)}}],[{key:"type",get:function(){return"JoinNode"}}]),n}(hb),db=ob.join(""),pb=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";return c(this,n),(r=t.call(this)).node=e,r.components=i,r.isSplitNode=!0,r}return p(n,[{key:"getVectorLength",value:function(){var e,t=this.components.length,n=k(this.components);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=Math.max(ob.indexOf(r)+1,t)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"getComponentType",value:function(e){return e.getComponentType(this.node.getNodeType(e))}},{key:"getNodeType",value:function(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}},{key:"generate",value:function(e,t){var n=this.node,r=e.getTypeLength(n.getNodeType(e)),i=null;if(r>1){var a=null;this.getVectorLength()>=r&&(a=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));var o=n.build(e,a);i=this.components.length===r&&this.components===db.slice(0,this.components.length)?e.format(o,a,t):e.format("".concat(o,".").concat(this.components),this.getNodeType(e),t)}else i=n.build(e,t);return i}},{key:"serialize",value:function(e){ht(m(n.prototype),"serialize",this).call(this,e),e.components=this.components}},{key:"deserialize",value:function(e){ht(m(n.prototype),"deserialize",this).call(this,e),this.components=e.components}}],[{key:"type",get:function(){return"SplitNode"}}]),n}(ub),Ab=function(e){v(n,e);var t=b(n);function n(e,r,i){var a;return c(this,n),(a=t.call(this)).sourceNode=e,a.components=r,a.targetNode=i,a}return p(n,[{key:"getNodeType",value:function(e){return this.sourceNode.getNodeType(e)}},{key:"generate",value:function(e){for(var t=this.sourceNode,n=this.components,r=this.targetNode,i=this.getNodeType(e),a=e.getComponentType(r.getNodeType(e)),o=e.getTypeFromLength(n.length,a),s=r.build(e,o),u=t.build(e,i),l=e.getTypeLength(i),c=[],h=0;h<l;h++){var f=ob[h];f===n[0]?(c.push(s),h+=n.length-1):c.push(u+"."+f)}return"".concat(e.getType(i),"( ").concat(c.join(", ")," )")}}],[{key:"type",get:function(){return"SetNode"}}]),n}(hb),vb=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this)).sourceNode=e,i.components=r,i}return p(n,[{key:"getNodeType",value:function(e){return this.sourceNode.getNodeType(e)}},{key:"generate",value:function(e){var t=this.components,n=this.sourceNode,r=this.getNodeType(e),i=n.build(e),a=e.getVarFromNode(this),o=e.getPropertyName(a);e.addLineFlowCode(o+" = "+i,this);for(var s=e.getTypeLength(r),u=[],l=0,c=0;c<s;c++){var h=ob[c];h===t[l]?(u.push("1.0 - "+o+"."+h),l++):u.push(o+"."+h)}return"".concat(e.getType(r),"( ").concat(u.join(", ")," )")}}],[{key:"type",get:function(){return"FlipNode"}}]),n}(hb),mb=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this,i)).isInputNode=!0,r.value=e,r.precision=null,r}return p(n,[{key:"getNodeType",value:function(){return null===this.nodeType?Y_(this.value):this.nodeType}},{key:"getInputType",value:function(e){return this.getNodeType(e)}},{key:"setPrecision",value:function(e){return this.precision=e,this}},{key:"serialize",value:function(e){ht(m(n.prototype),"serialize",this).call(this,e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=Y_(this.value),e.nodeType=this.nodeType,"ArrayBuffer"===e.valueType&&(e.value=J_(e.value)),e.precision=this.precision}},{key:"deserialize",value:function(e){ht(m(n.prototype),"deserialize",this).call(this,e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?K_.apply(void 0,[e.valueType].concat(l(e.value))):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}},{key:"generate",value:function(){console.warn("Abstract function.")}}],[{key:"type",get:function(){return"InputNode"}}]),n}(ub),gb=/float|u?int/,yb=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this,e,i)).isConstNode=!0,r}return p(n,[{key:"generateConst",value:function(e){return e.generateConst(this.getNodeType(e),this.value)}},{key:"generate",value:function(e,t){var n=this.getNodeType(e);return gb.test(n)&&gb.test(t)?e.generateConst(t,this.value):e.format(this.generateConst(e),n,t)}}],[{key:"type",get:function(){return"ConstNode"}}]),n}(mb),_b=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this)).node=e,i.property=r,i.isMemberNode=!0,i}return p(n,[{key:"getNodeType",value:function(e){return this.node.getMemberType(e,this.property)}},{key:"generate",value:function(e){return this.node.build(e)+"."+this.property}}],[{key:"type",get:function(){return"MemberNode"}}]),n}(ub),bb=null,xb=new Map;function wb(e,t){if(xb.has(e))console.warn("THREE.TSL: Redefinition of method chaining '".concat(e,"'."));else{if("function"!==typeof t)throw new Error("THREE.TSL: Node element ".concat(e," is not a function"));xb.set(e,t)}}for(var Tb=function(e){return e.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w")},Sb=function(e){return Tb(e).split("").sort().join("")},Eb={setup:function(e,t){var n=t.shift();return e.apply(void 0,[hx(n)].concat(l(t)))},get:function(e,t,n){if("string"===typeof t&&void 0===e[t]){if(!0!==e.isStackNode&&"assign"===t)return function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=bb).assign.apply(e,[n].concat(r)),n};if(xb.has(t)){var r=xb.get(t);return e.isStackNode?function(){return n.add(r.apply(void 0,arguments))}:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return r.apply(void 0,[n].concat(t))}}if("self"===t)return e;if(t.endsWith("Assign")&&xb.has(t.slice(0,t.length-"Assign".length))){var i=xb.get(t.slice(0,t.length-"Assign".length));return e.isStackNode?function(){return n.assign(arguments.length<=0?void 0:arguments[0],i.apply(void 0,arguments))}:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.assign(i.apply(void 0,[n].concat(t)))}}if(!0===/^[xyzwrgbastpq]{1,4}$/.test(t))return t=Tb(t),cx(new pb(n,t));if(!0===/^set[XYZWRGBASTPQ]{1,4}$/.test(t))return t=Sb(t.slice(3).toLowerCase()),function(n){return cx(new Ab(e,t,n))};if(!0===/^flip[XYZWRGBASTPQ]{1,4}$/.test(t))return t=Sb(t.slice(4).toLowerCase()),function(){return cx(new vb(cx(e),t))};if("width"===t||"height"===t||"depth"===t)return"width"===t?t="x":"height"===t?t="y":"depth"===t&&(t="z"),cx(new pb(e,t));if(!0===/^\d+$/.test(t))return cx(new lb(n,new yb(Number(t),"uint")));if(!0===/^get$/.test(t))return function(e){return cx(new _b(n,e))}}return Reflect.get(e,t,n)},set:function(e,t,n,r){return"string"!==typeof t||void 0!==e[t]||!0!==/^[xyzwrgbastpq]{1,4}$/.test(t)&&"width"!==t&&"height"!==t&&"depth"!==t&&!0!==/^\d+$/.test(t)?Reflect.set(e,t,n,r):(r[t].assign(n),!0)}},kb=new WeakMap,Mb=new WeakMap,Cb=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Y_(e);if("node"===n){var r=kb.get(e);return void 0===r&&(r=new Proxy(e,Eb),kb.set(e,r),kb.set(r,r)),r}return null===t&&("float"===n||"boolean"===n)||n&&"shader"!==n&&"string"!==n?cx(ix(e,t)):"shader"===n?vx(e):e},Rb=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var n in e)e[n]=cx(e[n],t);return e},Pb=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e.length,r=0;r<n;r++)e[r]=cx(e[r],t);return e},Nb=function(e){var t,n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=function(e){return cx(null!==o?Object.assign(e,o):e)},u=i;function c(t){var i;return i=u?/[a-z]/i.test(u)?u+"()":u:e.type,void 0!==n&&t.length<n?(console.error('THREE.TSL: "'.concat(i,'" parameter length is less than minimum required.')),t.concat(new Array(n-t.length).fill(0))):void 0!==r&&t.length>r?(console.error('THREE.TSL: "'.concat(i,'" parameter length exceeds limit.')),t.slice(0,r)):t}return null===i?t=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return s(S(e,l(fx(c(n)))))}:null!==a?(a=cx(a),t=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return s(S(e,[i].concat(l(fx(c(n))),[a])))}):t=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return s(S(e,[i].concat(l(fx(c(n))))))},t.setParameterLength=function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return 1===i.length?n=r=i[0]:2===i.length&&(n=i[0],r=i[1]),t},t.setName=function(e){return u=e,t},t},Ib=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return cx(S(e,l(fx(n))))},Lb=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this)).shaderNode=e,i.inputNodes=r,i}return p(n,[{key:"getNodeType",value:function(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}},{key:"getMemberType",value:function(e,t){return this.getOutputNode(e).getMemberType(e,t)}},{key:"call",value:function(e){var t=this.shaderNode,n=this.inputNodes,r=e.getNodeProperties(t);if(r.onceOutput)return r.onceOutput;var i=null;if(t.layout){var a=Mb.get(e.constructor);void 0===a&&(a=new WeakMap,Mb.set(e.constructor,a));var o=a.get(t);void 0===o&&(o=cx(e.buildFunctionNode(t)),a.set(t,o)),e.addInclude(o),i=cx(o.call(n))}else{var s=t.jsFunc,u=null!==n||s.length>1?s(n||[],e):s(e);i=cx(u)}return t.once&&(r.onceOutput=i),i}},{key:"getOutputNode",value:function(e){var t=e.getNodeProperties(this);return null===t.outputNode&&(t.outputNode=this.setupOutput(e)),t.outputNode}},{key:"setup",value:function(e){return this.getOutputNode(e)}},{key:"setupOutput",value:function(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}},{key:"generate",value:function(e,t){return this.getOutputNode(e).build(e,t)}}]),n}(ub),Db=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,r)).jsFunc=e,i.layout=null,i.global=!0,i.once=!1,i}return p(n,[{key:"setLayout",value:function(e){return this.layout=e,this}},{key:"call",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return hx(e),cx(new Lb(this,e))}},{key:"setup",value:function(){return this.call()}}]),n}(ub),Ob=[.5,1.5,1/3,1e-6,1e6,Math.PI,2*Math.PI,1/Math.PI,2/Math.PI,1/(2*Math.PI),Math.PI/2],Ub=new Map,Bb=0,Fb=[!1,!0];Bb<Fb.length;Bb++){var zb=Fb[Bb];Ub.set(zb,new yb(zb))}for(var Vb=new Map,qb=0,jb=[0,1,2,3];qb<jb.length;qb++){var Gb=jb[qb];Vb.set(Gb,new yb(Gb,"uint"))}for(var Hb=new Map(l(Vb).map((function(e){return new yb(e.value,"int")}))),Wb=0,Xb=[-1,-2];Wb<Xb.length;Wb++){var Qb=Xb[Wb];Hb.set(Qb,new yb(Qb,"int"))}for(var Yb=new Map(l(Hb).map((function(e){return new yb(e.value)}))),Kb=0,Zb=Ob;Kb<Zb.length;Kb++){var Jb=Zb[Kb];Yb.set(Jb,new yb(Jb))}for(var $b=0,ex=Ob;$b<ex.length;$b++){var tx=ex[$b];Yb.set(-tx,new yb(-tx))}var nx={bool:Ub,uint:Vb,ints:Hb,float:Yb},rx=new Map([].concat(l(Ub),l(Yb))),ix=function(e,t){return rx.has(e)?rx.get(e):!0===e.isNode?e:new yb(e,t)},ax=function(e){try{return e.getNodeType()}catch(t){return}},ox=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if((0===r.length||!["bool","float","int","uint"].includes(e)&&r.every((function(e){return"object"!==typeof e})))&&(r=[K_.apply(void 0,[e].concat(l(r)))]),1===r.length&&null!==t&&t.has(r[0]))return cx(t.get(r[0]));if(1===r.length){var a=ix(r[0],e);return ax(a)===e?cx(a):cx(new cb(a,e))}var o=r.map((function(e){return ix(e)}));return cx(new fb(o,e))}},sx=function(e){return"object"===typeof e&&null!==e?e.value:e},ux=function(e){return void 0!==e&&null!==e?e.nodeType||e.convertTo||("string"===typeof e?e:null):null};function lx(e,t){return new Proxy(new Db(e,t),Eb)}var cx=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Cb(e,t)},hx=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Rb(e,t)},fx=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Pb(e,t)},dx=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return S(Nb,t)},px=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return S(Ib,t)},Ax=0,vx=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=null;null!==t&&("object"===typeof t?n=t.return:("string"===typeof t?n=t:console.error("THREE.TSL: Invalid layout type."),t=null));var r=new lx(e,n),i=function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return hx(n),e=n[0]&&n[0].isNode?[].concat(n):n[0],r.call(e)};if(i.shaderNode=r,i.setLayout=function(e){return r.setLayout(e),i},i.once=function(){return r.once=!0,i},null!==t){if("object"!==typeof t.inputs){var a={name:"fn"+Ax++,type:n,inputs:[]};for(var o in t)"return"!==o&&a.inputs.push({name:o,type:t[o]});t=a}i.setLayout(t)}return i};wb("toGlobal",(function(e){return e.global=!0,e}));var mx=function(e){bb=e},gx=function(){return bb},yx=function(){var e;return(e=bb).If.apply(e,arguments)};function _x(e){return bb&&bb.add(e),e}wb("append",_x);var bx=new ox("color"),xx=new ox("float",nx.float),wx=new ox("int",nx.ints),Tx=new ox("uint",nx.uint),Sx=new ox("bool",nx.bool),Ex=new ox("vec2"),kx=new ox("ivec2"),Mx=new ox("uvec2"),Cx=new ox("bvec2"),Rx=new ox("vec3"),Px=new ox("ivec3"),Nx=new ox("uvec3"),Ix=new ox("bvec3"),Lx=new ox("vec4"),Dx=new ox("ivec4"),Ox=new ox("uvec4"),Ux=new ox("bvec4"),Bx=new ox("mat2"),Fx=new ox("mat3"),zx=new ox("mat4");wb("toColor",bx),wb("toFloat",xx),wb("toInt",wx),wb("toUint",Tx),wb("toBool",Sx),wb("toVec2",Ex),wb("toIVec2",kx),wb("toUVec2",Mx),wb("toBVec2",Cx),wb("toVec3",Rx),wb("toIVec3",Px),wb("toUVec3",Nx),wb("toBVec3",Ix),wb("toVec4",Lx),wb("toIVec4",Dx),wb("toUVec4",Ox),wb("toBVec4",Ux),wb("toMat2",Bx),wb("toMat3",Fx),wb("toMat4",zx);var Vx=dx(lb).setParameterLength(2),qx=function(e,t){return cx(new cb(cx(e),t))};wb("element",Vx),wb("convert",qx);var jx=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return c(this,n),(i=t.call(this,e)).count=r,i.values=a,i.isArrayNode=!0,i}return p(n,[{key:"getNodeType",value:function(e){return null===this.nodeType&&(this.nodeType=this.values[0].getNodeType(e)),this.nodeType}},{key:"getElementType",value:function(e){return this.getNodeType(e)}},{key:"generate",value:function(e){var t=this.getNodeType(e);return e.generateArray(t,this.count,this.values)}}],[{key:"type",get:function(){return"ArrayNode"}}]),n}(hb),Gx=function(){var e;if(1===arguments.length){var t=arguments.length<=0?void 0:arguments[0];e=new jx(null,t.length,t)}else{var n=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1];e=new jx(n,r)}return cx(e)};wb("toArray",(function(e,t){return Gx(Array(t).fill(e))}));var Hx=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return c(this,n),(r=t.call(this,"string")).name=e,r.shared=i,r.order=a,r.isUniformGroup=!0,r}return p(n,[{key:"serialize",value:function(e){ht(m(n.prototype),"serialize",this).call(this,e),e.name=this.name,e.version=this.version,e.shared=this.shared}},{key:"deserialize",value:function(e){ht(m(n.prototype),"deserialize",this).call(this,e),this.name=e.name,this.version=e.version,this.shared=e.shared}}],[{key:"type",get:function(){return"UniformGroupNode"}}]),n}(ub),Wx=function(e){return new Hx(e)},Xx=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Hx(e,!0,t)},Qx=Xx("frame"),Yx=Xx("render"),Kx=Wx("object"),Zx=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this,e,i)).isUniformNode=!0,r.name="",r.groupNode=Kx,r}return p(n,[{key:"label",value:function(e){return this.name=e,this}},{key:"setGroup",value:function(e){return this.groupNode=e,this}},{key:"getGroup",value:function(){return this.groupNode}},{key:"getUniformHash",value:function(e){return this.getHash(e)}},{key:"onUpdate",value:function(e,t){var r=this,i=this.getSelf();return e=e.bind(i),ht(m(n.prototype),"onUpdate",this).call(this,(function(t){var n=e(t,i);void 0!==n&&(r.value=n)}),t)}},{key:"generate",value:function(e,t){var n=this.getNodeType(e),r=this.getUniformHash(e),i=e.getNodeFromHash(r);void 0===i&&(e.setHashNode(this,r),i=this);var a=i.getInputType(e),o=e.getUniformFromNode(i,a,e.shaderStage,this.name||e.context.label),s=e.getPropertyName(o);return void 0!==e.context.label&&delete e.context.label,e.format(s,n,t)}}],[{key:"type",get:function(){return"UniformNode"}}]),n}(mb),Jx=function(e,t){var n=ux(t||e),r=e&&!0===e.isNode?e.node&&e.node.value||e.value:e;return cx(new Zx(r,n))},$x=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return c(this,n),(r=t.call(this,e)).name=i,r.varying=a,r.isPropertyNode=!0,r}return p(n,[{key:"getHash",value:function(e){return this.name||ht(m(n.prototype),"getHash",this).call(this,e)}},{key:"isGlobal",value:function(){return!0}},{key:"generate",value:function(e){var t;return!0===this.varying?(t=e.getVaryingFromNode(this,this.name)).needsInterpolation=!0:t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}],[{key:"type",get:function(){return"PropertyNode"}}]),n}(ub),ew=function(e,t){return cx(new $x(e,t))},tw=function(e,t){return cx(new $x(e,t,!0))},nw=px($x,"vec4","DiffuseColor"),rw=px($x,"vec3","EmissiveColor"),iw=px($x,"float","Roughness"),aw=px($x,"float","Metalness"),ow=px($x,"float","Clearcoat"),sw=px($x,"float","ClearcoatRoughness"),uw=px($x,"vec3","Sheen"),lw=px($x,"float","SheenRoughness"),cw=px($x,"float","Iridescence"),hw=px($x,"float","IridescenceIOR"),fw=px($x,"float","IridescenceThickness"),dw=px($x,"float","AlphaT"),pw=px($x,"float","Anisotropy"),Aw=px($x,"vec3","AnisotropyT"),vw=px($x,"vec3","AnisotropyB"),mw=px($x,"color","SpecularColor"),gw=px($x,"float","SpecularF90"),yw=px($x,"float","Shininess"),_w=px($x,"vec4","Output"),bw=px($x,"float","dashSize"),xw=px($x,"float","gapSize"),ww=px($x,"float","pointWidth"),Tw=px($x,"float","IOR"),Sw=px($x,"float","Transmission"),Ew=px($x,"float","Thickness"),kw=px($x,"float","AttenuationDistance"),Mw=px($x,"color","AttenuationColor"),Cw=px($x,"float","Dispersion"),Rw=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this)).targetNode=e,i.sourceNode=r,i}return p(n,[{key:"hasDependencies",value:function(){return!1}},{key:"getNodeType",value:function(e,t){return"void"!==t?this.targetNode.getNodeType(e):"void"}},{key:"needsSplitAssign",value:function(e){var t=this.targetNode;if(!1===e.isAvailable("swizzleAssign")&&t.isSplitNode&&t.components.length>1){var n=e.getTypeLength(t.node.getNodeType(e));return ob.join("").slice(0,n)!==t.components}return!1}},{key:"generate",value:function(e,t){var n,r=this.targetNode,i=this.sourceNode,a=this.needsSplitAssign(e),o=r.getNodeType(e),s=r.context({assign:!0}).build(e),u=i.build(e,o),l=i.getNodeType(e),c=e.getDataFromNode(this);if(!0===c.initialized)"void"!==t&&(n=s);else if(a){var h=e.getVarFromNode(this,null,o),f=e.getPropertyName(h);e.addLineFlowCode("".concat(f," = ").concat(u),this);for(var d=r.node.context({assign:!0}).build(e),p=0;p<r.components.length;p++){var A=r.components[p];e.addLineFlowCode("".concat(d,".").concat(A," = ").concat(f,"[ ").concat(p," ]"),this)}"void"!==t&&(n=s)}else n="".concat(s," = ").concat(u),"void"!==t&&"void"!==l||(e.addLineFlowCode(n,this),"void"!==t&&(n=s));return c.initialized=!0,e.format(n,o,t)}}],[{key:"type",get:function(){return"AssignNode"}}]),n}(hb),Pw=dx(Rw).setParameterLength(2);wb("assign",Pw);var Nw=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c(this,n),(e=t.call(this)).functionNode=r,e.parameters=i,e}return p(n,[{key:"setParameters",value:function(e){return this.parameters=e,this}},{key:"getParameters",value:function(){return this.parameters}},{key:"getNodeType",value:function(e){return this.functionNode.getNodeType(e)}},{key:"generate",value:function(e){var t=[],n=this.functionNode,r=n.getInputs(e),i=this.parameters,a=function(t,n){var r=n.type;return"pointer"===r?"&"+t.build(e):t.build(e,r)};if(Array.isArray(i)){if(i.length>r.length)console.error("THREE.TSL: The number of provided parameters exceeds the expected number of inputs in 'Fn()'."),i.length=r.length;else if(i.length<r.length)for(console.error("THREE.TSL: The number of provided parameters is less than the expected number of inputs in 'Fn()'.");i.length<r.length;)i.push(xx(0));for(var o=0;o<i.length;o++)t.push(a(i[o],r[o]))}else{var s,u=k(r);try{for(u.s();!(s=u.n()).done;){var l=s.value,c=i[l.name];void 0!==c?t.push(a(c,l)):(console.error("THREE.TSL: Input '".concat(l.name,"' not found in 'Fn()'.")),t.push(a(xx(0),l)))}}catch(f){u.e(f)}finally{u.f()}}var h=n.build(e,"property");return"".concat(h,"( ").concat(t.join(", ")," )")}}],[{key:"type",get:function(){return"FunctionCallNode"}}]),n}(hb),Iw=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n=n.length>1||n[0]&&!0===n[0].isNode?fx(n):hx(n[0]),cx(new Nw(cx(e),n))};wb("call",Iw);var Lw=function(e){v(n,e);var t=b(n);function n(e,r,i){var a;if(c(this,n),a=t.call(this),(arguments.length<=3?0:arguments.length-3)>0){for(var o,s=new n(e,r,i),u=0;u<(arguments.length<=3?0:arguments.length-3)-1;u++)s=new n(e,s,u+3<3||arguments.length<=u+3?void 0:arguments[u+3]);r=s,i=(o=(arguments.length<=3?0:arguments.length-3)-1+3)<3||arguments.length<=o?void 0:arguments[o]}return a.op=e,a.aNode=r,a.bNode=i,a.isOperatorNode=!0,a}return p(n,[{key:"getNodeType",value:function(e,t){var n=this.op,r=this.aNode,i=this.bNode,a=r.getNodeType(e),o="undefined"!==typeof i?i.getNodeType(e):null;if("void"===a||"void"===o)return"void";if("%"===n)return a;if("~"===n||"&"===n||"|"===n||"^"===n||">>"===n||"<<"===n)return e.getIntegerType(a);if("!"===n||"=="===n||"!="===n||"&&"===n||"||"===n||"^^"===n)return"bool";if("<"===n||">"===n||"<="===n||">="===n){var s=t?e.getTypeLength(t):Math.max(e.getTypeLength(a),e.getTypeLength(o));return s>1?"bvec".concat(s):"bool"}if(e.isMatrix(a)){if("float"===o)return a;if(e.isVector(o))return e.getVectorFromMatrix(a);if(e.isMatrix(o))return a}else if(e.isMatrix(o)){if("float"===a)return o;if(e.isVector(a))return e.getVectorFromMatrix(o)}return e.getTypeLength(o)>e.getTypeLength(a)?o:a}},{key:"generate",value:function(e,t){var n=this.op,r=this.aNode,i=this.bNode,a=this.getNodeType(e,t),o=null,s=null;"void"!==a?(o=r.getNodeType(e),s="undefined"!==typeof i?i.getNodeType(e):null,"<"===n||">"===n||"<="===n||">="===n||"=="===n||"!="===n?e.isVector(o)?s=o:o!==s&&(o=s="float"):">>"===n||"<<"===n?(o=a,s=e.changeComponentType(s,"uint")):"%"===n?(o=a,s=e.isInteger(o)&&e.isInteger(s)?s:o):e.isMatrix(o)?"float"===s?s="float":e.isVector(s)?s=e.getVectorFromMatrix(o):e.isMatrix(s)||(o=s=a):o=e.isMatrix(s)?"float"===o?"float":e.isVector(o)?e.getVectorFromMatrix(s):s=a:s=a):o=s=a;var u=r.build(e,o),l="undefined"!==typeof i?i.build(e,s):null,c=e.getTypeLength(t),h=e.getFunctionOperator(n);if("void"!==t){var f=e.renderer.coordinateSystem===or;if("=="===n)return f?c>1?e.format("".concat(e.getMethod("equal",t),"( ").concat(u,", ").concat(l," )"),a,t):e.format("( ".concat(u," ").concat(n," ").concat(l," )"),a,t):c>1||!e.isVector(o)?e.format("( ".concat(u," == ").concat(l," )"),a,t):e.format("all( ".concat(u," == ").concat(l," )"),a,t);if("<"===n&&c>1)return f?e.format("".concat(e.getMethod("lessThan",t),"( ").concat(u,", ").concat(l," )"),a,t):e.format("( ".concat(u," < ").concat(l," )"),a,t);if("<="===n&&c>1)return f?e.format("".concat(e.getMethod("lessThanEqual",t),"( ").concat(u,", ").concat(l," )"),a,t):e.format("( ".concat(u," <= ").concat(l," )"),a,t);if(">"===n&&c>1)return f?e.format("".concat(e.getMethod("greaterThan",t),"( ").concat(u,", ").concat(l," )"),a,t):e.format("( ".concat(u," > ").concat(l," )"),a,t);if(">="===n&&c>1)return f?e.format("".concat(e.getMethod("greaterThanEqual",t),"( ").concat(u,", ").concat(l," )"),a,t):e.format("( ".concat(u," >= ").concat(l," )"),a,t);if("%"===n)return e.isInteger(s)?e.format("( ".concat(u," % ").concat(l," )"),a,t):e.format("".concat(e.getMethod("mod",a),"( ").concat(u,", ").concat(l," )"),a,t);if("!"===n||"~"===n)return e.format("(".concat(n).concat(u,")"),o,t);if(h)return e.format("".concat(h,"( ").concat(u,", ").concat(l," )"),a,t);if(e.isMatrix(o)&&"float"===s)return e.format("( ".concat(l," ").concat(n," ").concat(u," )"),a,t);if("float"===o&&e.isMatrix(s))return e.format("".concat(u," ").concat(n," ").concat(l),a,t);var d="( ".concat(u," ").concat(n," ").concat(l," )");return!f&&"bool"===a&&e.isVector(o)&&e.isVector(s)&&(d="all".concat(d)),e.format(d,a,t)}if("void"!==o)return h?e.format("".concat(h,"( ").concat(u,", ").concat(l," )"),a,t):e.isMatrix(o)&&"float"===s?e.format("".concat(l," ").concat(n," ").concat(u),a,t):e.format("".concat(u," ").concat(n," ").concat(l),a,t)}},{key:"serialize",value:function(e){ht(m(n.prototype),"serialize",this).call(this,e),e.op=this.op}},{key:"deserialize",value:function(e){ht(m(n.prototype),"deserialize",this).call(this,e),this.op=e.op}}],[{key:"type",get:function(){return"OperatorNode"}}]),n}(hb),Dw=dx(Lw,"+").setParameterLength(2,1/0).setName("add"),Ow=dx(Lw,"-").setParameterLength(2,1/0).setName("sub"),Uw=dx(Lw,"*").setParameterLength(2,1/0).setName("mul"),Bw=dx(Lw,"/").setParameterLength(2,1/0).setName("div"),Fw=dx(Lw,"%").setParameterLength(2).setName("mod"),zw=dx(Lw,"==").setParameterLength(2).setName("equal"),Vw=dx(Lw,"!=").setParameterLength(2).setName("notEqual"),qw=dx(Lw,"<").setParameterLength(2).setName("lessThan"),jw=dx(Lw,">").setParameterLength(2).setName("greaterThan"),Gw=dx(Lw,"<=").setParameterLength(2).setName("lessThanEqual"),Hw=dx(Lw,">=").setParameterLength(2).setName("greaterThanEqual"),Ww=dx(Lw,"&&").setParameterLength(2,1/0).setName("and"),Xw=dx(Lw,"||").setParameterLength(2,1/0).setName("or"),Qw=dx(Lw,"!").setParameterLength(1).setName("not"),Yw=dx(Lw,"^^").setParameterLength(2).setName("xor"),Kw=dx(Lw,"&").setParameterLength(2).setName("bitAnd"),Zw=dx(Lw,"~").setParameterLength(2).setName("bitNot"),Jw=dx(Lw,"|").setParameterLength(2).setName("bitOr"),$w=dx(Lw,"^").setParameterLength(2).setName("bitXor"),eT=dx(Lw,"<<").setParameterLength(2).setName("shiftLeft"),tT=dx(Lw,">>").setParameterLength(2).setName("shiftRight");wb("add",Dw),wb("sub",Ow),wb("mul",Uw),wb("div",Bw),wb("mod",Fw),wb("equal",zw),wb("notEqual",Vw),wb("lessThan",qw),wb("greaterThan",jw),wb("lessThanEqual",Gw),wb("greaterThanEqual",Hw),wb("and",Ww),wb("or",Xw),wb("not",Qw),wb("xor",Yw),wb("bitAnd",Kw),wb("bitNot",Zw),wb("bitOr",Jw),wb("bitXor",$w),wb("shiftLeft",eT),wb("shiftRight",tT);var nT=function(e,t){return console.warn('THREE.TSL: "remainder()" is deprecated. Use "mod( int( ... ) )" instead.'),Fw(e,t)},rT=function(e,t){return console.warn('THREE.TSL: "modInt()" is deprecated. Use "mod( int( ... ) )" instead.'),Fw(wx(e),wx(t))};wb("remainder",nT),wb("modInt",rT);var iT=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(c(this,n),i=t.call(this),(e===n.MAX||e===n.MIN)&&arguments.length>3){for(var s=new n(e,r,a),u=2;u<arguments.length-1;u++)s=new n(e,s,arguments[u]);r=s,a=arguments[arguments.length-1],o=null}return i.method=e,i.aNode=r,i.bNode=a,i.cNode=o,i.isMathNode=!0,i}return p(n,[{key:"getInputType",value:function(e){var t=this.aNode.getNodeType(e),n=this.bNode?this.bNode.getNodeType(e):null,r=this.cNode?this.cNode.getNodeType(e):null,i=e.isMatrix(t)?0:e.getTypeLength(t),a=e.isMatrix(n)?0:e.getTypeLength(n),o=e.isMatrix(r)?0:e.getTypeLength(r);return i>a&&i>o?t:a>o?n:o>i?r:t}},{key:"getNodeType",value:function(e){var t=this.method;return t===n.LENGTH||t===n.DISTANCE||t===n.DOT?"float":t===n.CROSS?"vec3":t===n.ALL||t===n.ANY?"bool":t===n.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}},{key:"generate",value:function(e,t){var r=this.method,i=this.getNodeType(e),a=this.getInputType(e),o=this.aNode,s=this.bNode,u=this.cNode,l=e.renderer.coordinateSystem;if(r===n.TRANSFORM_DIRECTION){var c=o,h=s;e.isMatrix(c.getNodeType(e))?h=Lx(Rx(h),0):c=Lx(Rx(c),0);var f=Uw(c,h).xyz;return bT(f).build(e,t)}if(r===n.NEGATE)return e.format("( - "+o.build(e,a)+" )",i,t);if(r===n.ONE_MINUS)return Ow(1,o).build(e,t);if(r===n.RECIPROCAL)return Bw(1,o).build(e,t);if(r===n.DIFFERENCE)return CT(Ow(o,s)).build(e,t);var d=[];return r===n.CROSS?d.push(o.build(e,i),s.build(e,i)):l===or&&r===n.STEP?d.push(o.build(e,1===e.getTypeLength(o.getNodeType(e))?"float":a),s.build(e,a)):l!==or||r!==n.MIN&&r!==n.MAX?r===n.REFRACT?d.push(o.build(e,a),s.build(e,a),u.build(e,"float")):r===n.MIX?d.push(o.build(e,a),s.build(e,a),u.build(e,1===e.getTypeLength(u.getNodeType(e))?"float":a)):(l===sr&&r===n.ATAN&&null!==s&&(r="atan2"),d.push(o.build(e,a)),null!==s&&d.push(s.build(e,a)),null!==u&&d.push(u.build(e,a))):d.push(o.build(e,a),s.build(e,1===e.getTypeLength(s.getNodeType(e))?"float":a)),e.format("".concat(e.getMethod(r,i),"( ").concat(d.join(", ")," )"),i,t)}},{key:"serialize",value:function(e){ht(m(n.prototype),"serialize",this).call(this,e),e.method=this.method}},{key:"deserialize",value:function(e){ht(m(n.prototype),"deserialize",this).call(this,e),this.method=e.method}}],[{key:"type",get:function(){return"MathNode"}}]),n}(hb);iT.ALL="all",iT.ANY="any",iT.RADIANS="radians",iT.DEGREES="degrees",iT.EXP="exp",iT.EXP2="exp2",iT.LOG="log",iT.LOG2="log2",iT.SQRT="sqrt",iT.INVERSE_SQRT="inversesqrt",iT.FLOOR="floor",iT.CEIL="ceil",iT.NORMALIZE="normalize",iT.FRACT="fract",iT.SIN="sin",iT.COS="cos",iT.TAN="tan",iT.ASIN="asin",iT.ACOS="acos",iT.ATAN="atan",iT.ABS="abs",iT.SIGN="sign",iT.LENGTH="length",iT.NEGATE="negate",iT.ONE_MINUS="oneMinus",iT.DFDX="dFdx",iT.DFDY="dFdy",iT.ROUND="round",iT.RECIPROCAL="reciprocal",iT.TRUNC="trunc",iT.FWIDTH="fwidth",iT.TRANSPOSE="transpose",iT.BITCAST="bitcast",iT.EQUALS="equals",iT.MIN="min",iT.MAX="max",iT.STEP="step",iT.REFLECT="reflect",iT.DISTANCE="distance",iT.DIFFERENCE="difference",iT.DOT="dot",iT.CROSS="cross",iT.POW="pow",iT.TRANSFORM_DIRECTION="transformDirection",iT.MIX="mix",iT.CLAMP="clamp",iT.REFRACT="refract",iT.SMOOTHSTEP="smoothstep",iT.FACEFORWARD="faceforward";var aT=xx(1e-6),oT=xx(1e6),sT=xx(Math.PI),uT=xx(2*Math.PI),lT=dx(iT,iT.ALL).setParameterLength(1),cT=dx(iT,iT.ANY).setParameterLength(1),hT=dx(iT,iT.RADIANS).setParameterLength(1),fT=dx(iT,iT.DEGREES).setParameterLength(1),dT=dx(iT,iT.EXP).setParameterLength(1),pT=dx(iT,iT.EXP2).setParameterLength(1),AT=dx(iT,iT.LOG).setParameterLength(1),vT=dx(iT,iT.LOG2).setParameterLength(1),mT=dx(iT,iT.SQRT).setParameterLength(1),gT=dx(iT,iT.INVERSE_SQRT).setParameterLength(1),yT=dx(iT,iT.FLOOR).setParameterLength(1),_T=dx(iT,iT.CEIL).setParameterLength(1),bT=dx(iT,iT.NORMALIZE).setParameterLength(1),xT=dx(iT,iT.FRACT).setParameterLength(1),wT=dx(iT,iT.SIN).setParameterLength(1),TT=dx(iT,iT.COS).setParameterLength(1),ST=dx(iT,iT.TAN).setParameterLength(1),ET=dx(iT,iT.ASIN).setParameterLength(1),kT=dx(iT,iT.ACOS).setParameterLength(1),MT=dx(iT,iT.ATAN).setParameterLength(1,2),CT=dx(iT,iT.ABS).setParameterLength(1),RT=dx(iT,iT.SIGN).setParameterLength(1),PT=dx(iT,iT.LENGTH).setParameterLength(1),NT=dx(iT,iT.NEGATE).setParameterLength(1),IT=dx(iT,iT.ONE_MINUS).setParameterLength(1),LT=dx(iT,iT.DFDX).setParameterLength(1),DT=dx(iT,iT.DFDY).setParameterLength(1),OT=dx(iT,iT.ROUND).setParameterLength(1),UT=dx(iT,iT.RECIPROCAL).setParameterLength(1),BT=dx(iT,iT.TRUNC).setParameterLength(1),FT=dx(iT,iT.FWIDTH).setParameterLength(1),zT=dx(iT,iT.TRANSPOSE).setParameterLength(1),VT=dx(iT,iT.BITCAST).setParameterLength(2),qT=function(e,t){return console.warn('THREE.TSL: "equals" is deprecated. Use "equal" inside a vector instead, like: "bvec*( equal( ... ) )"'),zw(e,t)},jT=dx(iT,iT.MIN).setParameterLength(2,1/0),GT=dx(iT,iT.MAX).setParameterLength(2,1/0),HT=dx(iT,iT.STEP).setParameterLength(2),WT=dx(iT,iT.REFLECT).setParameterLength(2),XT=dx(iT,iT.DISTANCE).setParameterLength(2),QT=dx(iT,iT.DIFFERENCE).setParameterLength(2),YT=dx(iT,iT.DOT).setParameterLength(2),KT=dx(iT,iT.CROSS).setParameterLength(2),ZT=dx(iT,iT.POW).setParameterLength(2),JT=dx(iT,iT.POW,2).setParameterLength(1),$T=dx(iT,iT.POW,3).setParameterLength(1),eS=dx(iT,iT.POW,4).setParameterLength(1),tS=dx(iT,iT.TRANSFORM_DIRECTION).setParameterLength(2),nS=function(e){return Uw(RT(e),ZT(CT(e),1/3))},rS=function(e){return YT(e,e)},iS=dx(iT,iT.MIX).setParameterLength(3),aS=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return cx(new iT(iT.CLAMP,cx(e),cx(t),cx(n)))},oS=function(e){return aS(e)},sS=dx(iT,iT.REFRACT).setParameterLength(3),uS=dx(iT,iT.SMOOTHSTEP).setParameterLength(3),lS=dx(iT,iT.FACEFORWARD).setParameterLength(3),cS=vx((function(e){var t=T(e,1)[0],n=YT(t.xy,Ex(12.9898,78.233)),r=Fw(n,sT);return xT(wT(r).mul(43758.5453))})),hS=function(e,t,n){return iS(t,n,e)},fS=function(e,t,n){return uS(t,n,e)},dS=function(e,t){return console.warn('THREE.TSL: "atan2" is overloaded. Use "atan" instead.'),MT(e,t)},pS=lS,AS=gT;wb("all",lT),wb("any",cT),wb("equals",qT),wb("radians",hT),wb("degrees",fT),wb("exp",dT),wb("exp2",pT),wb("log",AT),wb("log2",vT),wb("sqrt",mT),wb("inverseSqrt",gT),wb("floor",yT),wb("ceil",_T),wb("normalize",bT),wb("fract",xT),wb("sin",wT),wb("cos",TT),wb("tan",ST),wb("asin",ET),wb("acos",kT),wb("atan",MT),wb("abs",CT),wb("sign",RT),wb("length",PT),wb("lengthSq",rS),wb("negate",NT),wb("oneMinus",IT),wb("dFdx",LT),wb("dFdy",DT),wb("round",OT),wb("reciprocal",UT),wb("trunc",BT),wb("fwidth",FT),wb("atan2",dS),wb("min",jT),wb("max",GT),wb("step",HT),wb("reflect",WT),wb("distance",XT),wb("dot",YT),wb("cross",KT),wb("pow",ZT),wb("pow2",JT),wb("pow3",$T),wb("pow4",eS),wb("transformDirection",tS),wb("mix",hS),wb("clamp",aS),wb("refract",sS),wb("smoothstep",fS),wb("faceForward",lS),wb("difference",QT),wb("saturate",oS),wb("cbrt",nS),wb("transpose",zT),wb("rand",cS);var vS=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return c(this,n),(i=t.call(this)).condNode=e,i.ifNode=r,i.elseNode=a,i}return p(n,[{key:"getNodeType",value:function(e){var t=e.getNodeProperties(this),n=t.ifNode,r=t.elseNode;if(void 0===n)return this.setup(e),this.getNodeType(e);var i=n.getNodeType(e);if(null!==r){var a=r.getNodeType(e);if(e.getTypeLength(a)>e.getTypeLength(i))return a}return i}},{key:"setup",value:function(e){var t=this.condNode.cache(),n=this.ifNode.cache(),r=this.elseNode?this.elseNode.cache():null,i=e.context.nodeBlock;e.getDataFromNode(n).parentNodeBlock=i,null!==r&&(e.getDataFromNode(r).parentNodeBlock=i);var a=e.getNodeProperties(this);a.condNode=t,a.ifNode=n.context({nodeBlock:n}),a.elseNode=r?r.context({nodeBlock:r}):null}},{key:"generate",value:function(e,t){var n=this.getNodeType(e),r=e.getDataFromNode(this);if(void 0!==r.nodeProperty)return r.nodeProperty;var i=e.getNodeProperties(this),a=i.condNode,o=i.ifNode,s=i.elseNode,u=e.currentFunctionNode,l="void"!==t,c=l?ew(n).build(e):"";r.nodeProperty=c;var h=a.build(e,"bool");e.addFlowCode("\n".concat(e.tab,"if ( ").concat(h," ) {\n\n")).addFlowTab();var f=o.build(e,n);if(f&&(l?f=c+" = "+f+";":(f="return "+f+";",null===u&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),f="// "+f))),e.removeFlowTab().addFlowCode(e.tab+"\t"+f+"\n\n"+e.tab+"}"),null!==s){e.addFlowCode(" else {\n\n").addFlowTab();var d=s.build(e,n);d&&(l?d=c+" = "+d+";":(d="return "+d+";",null===u&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),d="// "+d))),e.removeFlowTab().addFlowCode(e.tab+"\t"+d+"\n\n"+e.tab+"}\n\n")}else e.addFlowCode("\n\n");return e.format(c,n,t)}}],[{key:"type",get:function(){return"ConditionalNode"}}]),n}(ub),mS=dx(vS).setParameterLength(2,3);wb("select",mS);var gS=function(){return console.warn("THREE.TSL: cond() has been renamed to select()."),mS.apply(void 0,arguments)};wb("cond",gS);var yS=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c(this,n),(r=t.call(this)).isContextNode=!0,r.node=e,r.value=i,r}return p(n,[{key:"getScope",value:function(){return this.node.getScope()}},{key:"getNodeType",value:function(e){return this.node.getNodeType(e)}},{key:"analyze",value:function(e){this.node.build(e)}},{key:"setup",value:function(e){var t=e.getContext();e.setContext(Qe(Qe({},e.context),this.value));var n=this.node.build(e);return e.setContext(t),n}},{key:"generate",value:function(e,t){var n=e.getContext();e.setContext(Qe(Qe({},e.context),this.value));var r=this.node.build(e,t);return e.setContext(n),r}}],[{key:"type",get:function(){return"ContextNode"}}]),n}(ub),_S=dx(yS).setParameterLength(1,2),bS=function(e,t){return _S(e,{label:t})};wb("context",_S),wb("label",bS);var xS=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return c(this,n),(r=t.call(this)).node=e,r.name=i,r.global=!0,r.isVarNode=!0,r.readOnly=a,r}return p(n,[{key:"getMemberType",value:function(e,t){return this.node.getMemberType(e,t)}},{key:"getElementType",value:function(e){return this.node.getElementType(e)}},{key:"getNodeType",value:function(e){return this.node.getNodeType(e)}},{key:"generate",value:function(e){var t=this.node,n=this.name,r=this.readOnly,i=!0===e.renderer.backend.isWebGPUBackend,a=!1,o=!1;r&&(a=e.isDeterministic(t),o=i?r:a);var s=e.getVectorType(this.getNodeType(e)),u=t.build(e,s),l=e.getVarFromNode(this,n,s,void 0,o),c=e.getPropertyName(l),h=c;if(o)if(i)h=a?"const ".concat(c):"let ".concat(c);else{var f=e.getArrayCount(t);h="const ".concat(e.getVar(l.type,c,f))}return e.addLineFlowCode("".concat(h," = ").concat(u),this),c}}],[{key:"type",get:function(){return"VarNode"}}]),n}(ub),wS=dx(xS),TS=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return wS(e,t).append()},SS=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return wS(e,t,!0).append()};wb("toVar",TS),wb("toConst",SS);var ES=function(e){return console.warn('TSL: "temp( node )" is deprecated. Use "Var( node )" or "node.toVar()" instead.'),wS(e)};wb("temp",ES);var kS=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this)).node=e,r.name=i,r.isVaryingNode=!0,r}return p(n,[{key:"isGlobal",value:function(){return!0}},{key:"getHash",value:function(e){return this.name||ht(m(n.prototype),"getHash",this).call(this,e)}},{key:"getNodeType",value:function(e){return this.node.getNodeType(e)}},{key:"setupVarying",value:function(e){var t=e.getNodeProperties(this),n=t.varying;if(void 0===n){var r=this.name,i=this.getNodeType(e);t.varying=n=e.getVaryingFromNode(this,r,i),t.node=this.node}return n.needsInterpolation||(n.needsInterpolation="fragment"===e.shaderStage),n}},{key:"setup",value:function(e){this.setupVarying(e)}},{key:"analyze",value:function(e){return this.setupVarying(e),this.node.analyze(e)}},{key:"generate",value:function(e){var t=e.getNodeProperties(this),n=this.setupVarying(e),r="fragment"===e.shaderStage&&!0===t.reassignPosition&&e.context.needsPositionReassign;if(void 0===t.propertyName||r){var i=this.getNodeType(e),a=e.getPropertyName(n,eb.VERTEX);e.flowNodeFromShaderStage(eb.VERTEX,this.node,i,a),t.propertyName=a,r?t.reassignPosition=!1:void 0===t.reassignPosition&&e.context.isPositionNodeInput&&(t.reassignPosition=!0)}return e.getPropertyName(n)}}],[{key:"type",get:function(){return"VaryingNode"}}]),n}(ub),MS=dx(kS).setParameterLength(1,2),CS=function(e){return MS(e)};wb("toVarying",MS),wb("toVertexStage",CS),wb("varying",(function(){return console.warn("THREE.TSL: .varying() has been renamed to .toVarying()."),MS.apply(void 0,arguments)})),wb("vertexStage",(function(){return console.warn("THREE.TSL: .vertexStage() has been renamed to .toVertexStage()."),MS.apply(void 0,arguments)}));var RS=vx((function(e){var t=T(e,1)[0],n=t.mul(.9478672986).add(.0521327014).pow(2.4),r=t.mul(.0773993808),i=t.lessThanEqual(.04045);return iS(n,r,i)})).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),PS=vx((function(e){var t=T(e,1)[0],n=t.pow(.41666).mul(1.055).sub(.055),r=t.mul(12.92),i=t.lessThanEqual(.0031308);return iS(n,r,i)})).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),NS="WorkingColorSpace",IS="OutputColorSpace",LS=function(e){v(n,e);var t=b(n);function n(e,r,i){var a;return c(this,n),(a=t.call(this,"vec4")).colorNode=e,a.source=r,a.target=i,a}return p(n,[{key:"resolveColorSpace",value:function(e,t){return t===NS?Dr.workingColorSpace:t===IS?e.context.outputColorSpace||e.renderer.outputColorSpace:t}},{key:"setup",value:function(e){var t=this.colorNode,n=this.resolveColorSpace(e,this.source),r=this.resolveColorSpace(e,this.target),i=t;return!1!==Dr.enabled&&n!==r&&n&&r?(Dr.getTransfer(n)===$n&&(i=Lx(RS(i.rgb),i.a)),Dr.getPrimaries(n)!==Dr.getPrimaries(r)&&(i=Lx(Fx(Dr._getMatrix(new br,n,r)).mul(i.rgb),i.a)),Dr.getTransfer(r)===$n&&(i=Lx(PS(i.rgb),i.a)),i):i}}],[{key:"type",get:function(){return"ColorSpaceNode"}}]),n}(hb),DS=function(e){return cx(new LS(cx(e),NS,IS))},OS=function(e){return cx(new LS(cx(e),IS,NS))},US=function(e,t){return cx(new LS(cx(e),NS,t))},BS=function(e,t){return cx(new LS(cx(e),t,NS))};wb("toOutputColorSpace",DS),wb("toWorkingColorSpace",OS),wb("workingToColorSpace",US),wb("colorSpaceToWorking",BS);var FS=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,e,r)).referenceNode=e,i.isReferenceElementNode=!0,i}return p(n,[{key:"getNodeType",value:function(){return this.referenceNode.uniformType}},{key:"generate",value:function(e){var t=ht(m(n.prototype),"generate",this).call(this,e),r=this.referenceNode.getNodeType(),i=this.getNodeType();return e.format(t,r,i)}}],[{key:"type",get:function(){return"ReferenceElementNode"}}]),n}(lb),zS=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return c(this,n),(i=t.call(this)).property=e,i.uniformType=r,i.object=a,i.count=o,i.properties=e.split("."),i.reference=a,i.node=null,i.group=null,i.updateType=tb.OBJECT,i}return p(n,[{key:"setGroup",value:function(e){return this.group=e,this}},{key:"element",value:function(e){return cx(new FS(this,cx(e)))}},{key:"setNodeType",value:function(e){var t=Jx(null,e).getSelf();null!==this.group&&t.setGroup(this.group),this.node=t}},{key:"getNodeType",value:function(e){return null===this.node&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}},{key:"getValueFromReference",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.reference,t=this.properties,n=e[t[0]],r=1;r<t.length;r++)n=n[t[r]];return n}},{key:"updateReference",value:function(e){return this.reference=null!==this.object?this.object:e.object,this.reference}},{key:"setup",value:function(){return this.updateValue(),this.node}},{key:"update",value:function(){this.updateValue()}},{key:"updateValue",value:function(){null===this.node&&this.setNodeType(this.uniformType);var e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}],[{key:"type",get:function(){return"ReferenceBaseNode"}}]),n}(ub),VS=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return c(this,n),(i=t.call(this,e,r,a)).renderer=a,i.setGroup(Yx),i}return p(n,[{key:"updateReference",value:function(e){return this.reference=null!==this.renderer?this.renderer:e.renderer,this.reference}}],[{key:"type",get:function(){return"RendererReferenceNode"}}]),n}(zS),qS=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return cx(new VS(e,t,n))},jS=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:HS,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return c(this,n),(r=t.call(this,"vec3")).toneMapping=e,r.exposureNode=i,r.colorNode=a,r}return p(n,[{key:"customCacheKey",value:function(){return V_(this.toneMapping)}},{key:"setup",value:function(e){var t=this.colorNode||e.context.color,n=this.toneMapping;if(0===n)return t;var r=null,i=e.renderer.library.getToneMappingFunction(n);return null!==i?r=Lx(i(t.rgb,this.exposureNode),t.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",n),r=t),r}}],[{key:"type",get:function(){return"ToneMappingNode"}}]),n}(hb),GS=function(e,t,n){return cx(new jS(e,cx(t),cx(n)))},HS=qS("toneMappingExposure","float");wb("toneMapping",(function(e,t,n){return GS(t,n,e)}));var WS=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return c(this,n),(r=t.call(this,e,i)).isBufferNode=!0,r.bufferType=i,r.bufferStride=a,r.bufferOffset=o,r.usage=rr,r.instanced=!1,r.attribute=null,r.global=!0,e&&!0===e.isBufferAttribute&&(r.attribute=e,r.usage=e.usage,r.instanced=e.isInstancedBufferAttribute),r}return p(n,[{key:"getHash",value:function(e){if(0===this.bufferStride&&0===this.bufferOffset){var t=e.globalCache.getData(this.value);return void 0===t&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}},{key:"getNodeType",value:function(e){return null===this.bufferType&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}},{key:"setup",value:function(e){if(null===this.attribute){var t=this.getNodeType(e),n=this.value,r=e.getTypeLength(t),i=this.bufferStride||r,a=this.bufferOffset,o=!0===n.isInterleavedBuffer?n:new xo(n,i),s=new To(o,r,a);o.setUsage(this.usage),this.attribute=s,this.attribute.isInstancedBufferAttribute=this.instanced}}},{key:"generate",value:function(e){var t=this.getNodeType(e),n=e.getBufferAttributeFromNode(this,t),r=e.getPropertyName(n),i=null;"vertex"===e.shaderStage||"compute"===e.shaderStage?(this.name=r,i=r):i=MS(this).build(e,t);return i}},{key:"getInputType",value:function(){return"bufferAttribute"}},{key:"setUsage",value:function(e){return this.usage=e,this.attribute&&!0===this.attribute.isBufferAttribute&&(this.attribute.usage=e),this}},{key:"setInstanced",value:function(e){return this.instanced=e,this}}],[{key:"type",get:function(){return"BufferAttributeNode"}}]),n}(mb),XS=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return cx(new WS(e,t,n,r))},QS=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return XS(e,t,n,r).setUsage(ir)},YS=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return XS(e,t,n,r).setInstanced(!0)},KS=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return QS(e,t,n,r).setInstanced(!0)};wb("toAttribute",(function(e){return XS(e.value)}));var ZS=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[64];return c(this,n),(i=t.call(this,"void")).isComputeNode=!0,i.computeNode=e,i.count=r,i.workgroupSize=a,i.dispatchCount=0,i.version=1,i.name="",i.updateBeforeType=tb.OBJECT,i.onInitFunction=null,i.updateDispatchCount(),i}return p(n,[{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"label",value:function(e){return this.name=e,this}},{key:"updateDispatchCount",value:function(){for(var e=this.count,t=this.workgroupSize,n=t[0],r=1;r<t.length;r++)n*=t[r];this.dispatchCount=Math.ceil(e/n)}},{key:"onInit",value:function(e){return this.onInitFunction=e,this}},{key:"updateBefore",value:function(e){e.renderer.compute(this)}},{key:"setup",value:function(e){var t=this.computeNode.setup(e);t&&(e.getNodeProperties(this).outputComputeNode=t.outputNode,t.outputNode=null);return t}},{key:"generate",value:function(e,t){if("compute"===e.shaderStage){var n=this.computeNode.build(e,"void");""!==n&&e.addLineFlowCode(n,this)}else{var r=e.getNodeProperties(this).outputComputeNode;if(r)return r.build(e,t)}}}],[{key:"type",get:function(){return"ComputeNode"}}]),n}(ub),JS=function(e,t,n){return cx(new ZS(cx(e),t,n))};wb("compute",JS);var $S=function(e){v(n,e);var t=b(n);function n(e){var r,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return c(this,n),(r=t.call(this)).node=e,r.parent=i,r.isCacheNode=!0,r}return p(n,[{key:"getNodeType",value:function(e){var t=e.getCache(),n=e.getCacheFromNode(this,this.parent);e.setCache(n);var r=this.node.getNodeType(e);return e.setCache(t),r}},{key:"build",value:function(e){var t,n=e.getCache(),r=e.getCacheFromNode(this,this.parent);e.setCache(r);for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];var s=(t=this.node).build.apply(t,[e].concat(a));return e.setCache(n),s}}],[{key:"type",get:function(){return"CacheNode"}}]),n}(ub),eE=function(e,t){return cx(new $S(cx(e),t))};wb("cache",eE);var tE=dx(function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this)).isBypassNode=!0,i.outputNode=e,i.callNode=r,i}return p(n,[{key:"getNodeType",value:function(e){return this.outputNode.getNodeType(e)}},{key:"generate",value:function(e){var t=this.callNode.build(e,"void");return""!==t&&e.addLineFlowCode(t,this),this.outputNode.build(e)}}],[{key:"type",get:function(){return"BypassNode"}}]),n}(ub)).setParameterLength(2);wb("bypass",tE);var nE=function(e){v(n,e);var t=b(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:xx(0),s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:xx(1);return c(this,n),(a=t.call(this)).node=e,a.inLowNode=r,a.inHighNode=i,a.outLowNode=o,a.outHighNode=s,a.doClamp=!0,a}return p(n,[{key:"setup",value:function(){var e=this.node,t=this.inLowNode,n=this.inHighNode,r=this.outLowNode,i=this.outHighNode,a=this.doClamp,o=e.sub(t).div(n.sub(t));return!0===a&&(o=o.clamp()),o.mul(i.sub(r)).add(r)}}],[{key:"type",get:function(){return"RemapNode"}}]),n}(ub),rE=dx(nE,null,null,{doClamp:!1}).setParameterLength(3,5),iE=dx(nE).setParameterLength(3,5);wb("remap",rE),wb("remapClamp",iE);var aE=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"void";return c(this,n),(e=t.call(this,i)).snippet=r,e}return p(n,[{key:"generate",value:function(e,t){var n=this.getNodeType(e),r=this.snippet;if("void"!==n)return e.format(r,n,t);e.addLineFlowCode(r,this)}}],[{key:"type",get:function(){return"ExpressionNode"}}]),n}(ub),oE=dx(aE).setParameterLength(1,2),sE=function(e){return(e?mS(e,oE("discard")):oE("discard")).append()};wb("discard",sE);var uE=function(e){v(n,e);var t=b(n);function n(e,r,i){var a;return c(this,n),(a=t.call(this,"vec4")).colorNode=e,a.toneMapping=r,a.outputColorSpace=i,a.isRenderOutputNode=!0,a}return p(n,[{key:"setup",value:function(e){var t=e.context,n=this.colorNode||t.color,r=(null!==this.toneMapping?this.toneMapping:t.toneMapping)||0,i=(null!==this.outputColorSpace?this.outputColorSpace:t.outputColorSpace)||Yn;return 0!==r&&(n=n.toneMapping(r)),i!==Yn&&i!==Dr.workingColorSpace&&(n=n.workingToColorSpace(i)),n}}],[{key:"type",get:function(){return"RenderOutputNode"}}]),n}(hb),lE=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return cx(new uE(cx(e),t,n))};wb("renderOutput",lE);var cE=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this)).node=e,r.callback=i,r}return p(n,[{key:"getNodeType",value:function(e){return this.node.getNodeType(e)}},{key:"setup",value:function(e){return this.node.build(e)}},{key:"analyze",value:function(e){return this.node.build(e)}},{key:"generate",value:function(e){var t=this.callback,n=this.node.build(e),r="";return r+="// #--- TSL Debug ---#\n",r+=e.flow.code.replace(/^\t/gm,"")+"\n",r+="/* ... */ "+n+" /* ... */\n",r+="// #-----------------#\n",null!==t?t(r):console.log(r),n}}],[{key:"type",get:function(){return"DebugNode"}}]),n}(hb),hE=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return cx(new cE(cx(e),t))};wb("debug",hE);var fE=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this,i)).global=!0,r._attributeName=e,r}return p(n,[{key:"getHash",value:function(e){return this.getAttributeName(e)}},{key:"getNodeType",value:function(e){var t=this.nodeType;if(null===t){var n=this.getAttributeName(e);if(e.hasGeometryAttribute(n)){var r=e.geometry.getAttribute(n);t=e.getTypeFromAttribute(r)}else t="float"}return t}},{key:"setAttributeName",value:function(e){return this._attributeName=e,this}},{key:"getAttributeName",value:function(){return this._attributeName}},{key:"generate",value:function(e){var t=this.getAttributeName(e),n=this.getNodeType(e);if(!0===e.hasGeometryAttribute(t)){var r=e.geometry.getAttribute(t),i=e.getTypeFromAttribute(r),a=e.getAttribute(t,i);return"vertex"===e.shaderStage?e.format(a.name,i,n):MS(this).build(e,n)}return console.warn('AttributeNode: Vertex attribute "'.concat(t,'" not found on geometry.')),e.generateConst(n)}},{key:"serialize",value:function(e){ht(m(n.prototype),"serialize",this).call(this,e),e.global=this.global,e._attributeName=this._attributeName}},{key:"deserialize",value:function(e){ht(m(n.prototype),"deserialize",this).call(this,e),this.global=e.global,this._attributeName=e._attributeName}}],[{key:"type",get:function(){return"AttributeNode"}}]),n}(ub),dE=function(e,t){return cx(new fE(e,t))},pE=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return dE("uv"+(e>0?e:""),"vec2")},AE=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this,"uvec2")).isTextureSizeNode=!0,r.textureNode=e,r.levelNode=i,r}return p(n,[{key:"generate",value:function(e,t){var n=this.textureNode.build(e,"property"),r=null===this.levelNode?"0":this.levelNode.build(e,"int");return e.format("".concat(e.getMethod("textureDimensions"),"( ").concat(n,", ").concat(r," )"),this.getNodeType(e),t)}}],[{key:"type",get:function(){return"TextureSizeNode"}}]),n}(ub),vE=dx(AE).setParameterLength(1,2),mE=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,0))._textureNode=e,r.updateType=tb.FRAME,r}return p(n,[{key:"textureNode",get:function(){return this._textureNode}},{key:"texture",get:function(){return this._textureNode.value}},{key:"update",value:function(){var e=this.texture,t=e.images,n=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(n&&void 0!==n.width){var r=n.width,i=n.height;this.value=Math.log2(Math.max(r,i))}}}],[{key:"type",get:function(){return"MaxMipLevelNode"}}]),n}(Zx),gE=dx(mE).setParameterLength(1),yE=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return c(this,n),(r=t.call(this,e)).isTextureNode=!0,r.uvNode=i,r.levelNode=a,r.biasNode=o,r.compareNode=null,r.depthNode=null,r.gradNode=null,r.sampler=!0,r.updateMatrix=!1,r.updateType=tb.NONE,r.referenceNode=null,r._value=e,r._matrixUniform=null,r.setUpdateMatrix(null===i),r}return p(n,[{key:"value",get:function(){return this.referenceNode?this.referenceNode.value:this._value},set:function(e){this.referenceNode?this.referenceNode.value=e:this._value=e}},{key:"getUniformHash",value:function(){return this.value.uuid}},{key:"getNodeType",value:function(){return!0===this.value.isDepthTexture?"float":this.value.type===Ht?"uvec4":this.value.type===Gt?"ivec4":"vec4"}},{key:"getInputType",value:function(){return"texture"}},{key:"getDefaultUV",value:function(){return pE(this.value.channel)}},{key:"updateReference",value:function(){return this.value}},{key:"getTransformedUV",value:function(e){return null===this._matrixUniform&&(this._matrixUniform=Jx(this.value.matrix)),this._matrixUniform.mul(Rx(e,1)).xy}},{key:"setUpdateMatrix",value:function(e){return this.updateMatrix=e,this.updateType=e?tb.RENDER:tb.NONE,this}},{key:"setupUV",value:function(e,t){var n=this.value;return e.isFlipY()&&(n.image instanceof ImageBitmap&&!0===n.flipY||!0===n.isRenderTargetTexture||!0===n.isFramebufferTexture||!0===n.isDepthTexture)&&(t=this.sampler?t.flipY():t.setY(wx(vE(this,this.levelNode).y).sub(t.y).sub(1))),t}},{key:"setup",value:function(e){var t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;var n=this.value;if(!n||!0!==n.isTexture)throw new Error("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().");var r=this.uvNode;null!==r&&!0!==e.context.forceUVContext||!e.context.getUV||(r=e.context.getUV(this)),r||(r=this.getDefaultUV()),!0===this.updateMatrix&&(r=this.getTransformedUV(r)),r=this.setupUV(e,r);var i=this.levelNode;null===i&&e.context.getTextureLevel&&(i=e.context.getTextureLevel(this)),t.uvNode=r,t.levelNode=i,t.biasNode=this.biasNode,t.compareNode=this.compareNode,t.gradNode=this.gradNode,t.depthNode=this.depthNode}},{key:"generateUV",value:function(e,t){return t.build(e,!0===this.sampler?"vec2":"ivec2")}},{key:"generateSnippet",value:function(e,t,n,r,i,a,o,s){var u=this.value;return r?e.generateTextureLevel(u,t,n,r,a):i?e.generateTextureBias(u,t,n,i,a):s?e.generateTextureGrad(u,t,n,s,a):o?e.generateTextureCompare(u,t,n,o,a):!1===this.sampler?e.generateTextureLoad(u,t,n,a):e.generateTexture(u,t,n,a)}},{key:"generate",value:function(e,t){var r=this.value,i=e.getNodeProperties(this),a=ht(m(n.prototype),"generate",this).call(this,e,"property");if(/^sampler/.test(t))return a+"_sampler";if(e.isReference(t))return a;var o=e.getDataFromNode(this),s=o.propertyName;if(void 0===s){var u=i.uvNode,l=i.levelNode,c=i.biasNode,h=i.compareNode,f=i.depthNode,d=i.gradNode,p=this.generateUV(e,u),A=l?l.build(e,"float"):null,v=c?c.build(e,"float"):null,g=f?f.build(e,"int"):null,y=h?h.build(e,"float"):null,_=d?[d[0].build(e,"vec2"),d[1].build(e,"vec2")]:null,b=e.getVarFromNode(this);s=e.getPropertyName(b);var x=this.generateSnippet(e,a,p,A,v,g,y,_);e.addLineFlowCode("".concat(s," = ").concat(x),this),o.snippet=x,o.propertyName=s}var w=s,T=this.getNodeType(e);return e.needsToWorkingColorSpace(r)&&(w=BS(oE(w,T),r.colorSpace).setup(e).build(e,T)),e.format(w,T,t)}},{key:"setSampler",value:function(e){return this.sampler=e,this}},{key:"getSampler",value:function(){return this.sampler}},{key:"uv",value:function(e){return console.warn("THREE.TextureNode: .uv() has been renamed. Use .sample() instead."),this.sample(e)}},{key:"sample",value:function(e){var t=this.clone();return t.uvNode=cx(e),t.referenceNode=this.getSelf(),cx(t)}},{key:"blur",value:function(e){var t=this.clone();t.biasNode=cx(e).mul(gE(t)),t.referenceNode=this.getSelf();var n=t.value;return(n&&!1===n.generateMipmaps||n.minFilter===Lt||n.magFilter===Lt)&&(console.warn("THREE.TSL: texture().blur() requires mipmaps and sampling. Use .generateMipmaps=true and .minFilter/.magFilter=THREE.LinearFilter in the Texture."),t.biasNode=null),cx(t)}},{key:"level",value:function(e){var t=this.clone();return t.levelNode=cx(e),t.referenceNode=this.getSelf(),cx(t)}},{key:"size",value:function(e){return vE(this,e)}},{key:"bias",value:function(e){var t=this.clone();return t.biasNode=cx(e),t.referenceNode=this.getSelf(),cx(t)}},{key:"compare",value:function(e){var t=this.clone();return t.compareNode=cx(e),t.referenceNode=this.getSelf(),cx(t)}},{key:"grad",value:function(e,t){var n=this.clone();return n.gradNode=[cx(e),cx(t)],n.referenceNode=this.getSelf(),cx(n)}},{key:"depth",value:function(e){var t=this.clone();return t.depthNode=cx(e),t.referenceNode=this.getSelf(),cx(t)}},{key:"serialize",value:function(e){ht(m(n.prototype),"serialize",this).call(this,e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}},{key:"deserialize",value:function(e){ht(m(n.prototype),"deserialize",this).call(this,e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}},{key:"update",value:function(){var e=this.value,t=this._matrixUniform;null!==t&&(t.value=e.matrix),!0===e.matrixAutoUpdate&&e.updateMatrix()}},{key:"clone",value:function(){var e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e}}],[{key:"type",get:function(){return"TextureNode"}}]),n}(Zx),_E=dx(yE).setParameterLength(1,4),bE=function(){return _E.apply(void 0,arguments).setSampler(!1)},xE=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return c(this,n),(i=t.call(this,e,r)).isBufferNode=!0,i.bufferType=r,i.bufferCount=a,i}return p(n,[{key:"getElementType",value:function(e){return this.getNodeType(e)}},{key:"getInputType",value:function(){return"buffer"}}],[{key:"type",get:function(){return"BufferNode"}}]),n}(Zx),wE=function(e,t,n){return cx(new xE(e,t,n))},TE=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,e,r)).isArrayBufferElementNode=!0,i}return p(n,[{key:"generate",value:function(e){var t=ht(m(n.prototype),"generate",this).call(this,e),r=this.getNodeType(),i=this.node.getPaddedType();return e.format(t,i,r)}}],[{key:"type",get:function(){return"UniformArrayElementNode"}}]),n}(lb),SE=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this,null)).array=e,r.elementType=null===i?Y_(e[0]):i,r.paddedType=r.getPaddedType(),r.updateType=tb.RENDER,r.isArrayBufferNode=!0,r}return p(n,[{key:"getNodeType",value:function(){return this.paddedType}},{key:"getElementType",value:function(){return this.elementType}},{key:"getPaddedType",value:function(){var e=this.elementType,t="vec4";return"mat2"===e?t="mat2":!0===/mat/.test(e)?t="mat4":"i"===e.charAt(0)?t="ivec4":"u"===e.charAt(0)&&(t="uvec4"),t}},{key:"update",value:function(){var e=this.array,t=this.value,n=this.elementType;if("float"===n||"int"===n||"uint"===n)for(var r=0;r<e.length;r++){t[4*r]=e[r]}else if("color"===n)for(var i=0;i<e.length;i++){var a=4*i,o=e[i];t[a]=o.r,t[a+1]=o.g,t[a+2]=o.b||0}else if("mat2"===n)for(var s=0;s<e.length;s++){var u=4*s,l=e[s];t[u]=l.elements[0],t[u+1]=l.elements[1],t[u+2]=l.elements[2],t[u+3]=l.elements[3]}else if("mat3"===n)for(var c=0;c<e.length;c++){var h=16*c,f=e[c];t[h]=f.elements[0],t[h+1]=f.elements[1],t[h+2]=f.elements[2],t[h+4]=f.elements[3],t[h+5]=f.elements[4],t[h+6]=f.elements[5],t[h+8]=f.elements[6],t[h+9]=f.elements[7],t[h+10]=f.elements[8],t[h+15]=1}else if("mat4"===n)for(var d=0;d<e.length;d++)for(var p=16*d,A=e[d],v=0;v<A.elements.length;v++)t[p+v]=A.elements[v];else for(var m=0;m<e.length;m++){var g=4*m,y=e[m];t[g]=y.x,t[g+1]=y.y,t[g+2]=y.z||0,t[g+3]=y.w||0}}},{key:"setup",value:function(e){var t=this.array.length,r=this.elementType,i=Float32Array,a=this.paddedType,o=e.getTypeLength(a);return"i"===r.charAt(0)&&(i=Int32Array),"u"===r.charAt(0)&&(i=Uint32Array),this.value=new i(t*o),this.bufferCount=t,this.bufferType=a,ht(m(n.prototype),"setup",this).call(this,e)}},{key:"element",value:function(e){return cx(new TE(this,cx(e)))}}],[{key:"type",get:function(){return"UniformArrayNode"}}]),n}(xE),EE=function(e,t){return cx(new SE(e,t))},kE=Jx(0,"uint").setGroup(Xx("cameraIndex")).toVarying("v_cameraIndex"),ME=Jx("float").label("cameraNear").setGroup(Yx).onRenderUpdate((function(e){return e.camera.near})),CE=Jx("float").label("cameraFar").setGroup(Yx).onRenderUpdate((function(e){return e.camera.far})),RE=vx((function(e){var t,n=e.camera;if(n.isArrayCamera&&n.cameras.length>0){var r,i=[],a=k(n.cameras);try{for(a.s();!(r=a.n()).done;){var o=r.value;i.push(o.projectionMatrix)}}catch(s){a.e(s)}finally{a.f()}t=EE(i).setGroup(Yx).label("cameraProjectionMatrices").element(kE).toVar("cameraProjectionMatrix")}else t=Jx("mat4").label("cameraProjectionMatrix").setGroup(Yx).onRenderUpdate((function(e){return e.camera.projectionMatrix}));return t})).once()(),PE=Jx("mat4").label("cameraProjectionMatrixInverse").setGroup(Yx).onRenderUpdate((function(e){return e.camera.projectionMatrixInverse})),NE=vx((function(e){var t,n=e.camera;if(n.isArrayCamera&&n.cameras.length>0){var r,i=[],a=k(n.cameras);try{for(a.s();!(r=a.n()).done;){var o=r.value;i.push(o.matrixWorldInverse)}}catch(s){a.e(s)}finally{a.f()}t=EE(i).setGroup(Yx).label("cameraViewMatrices").element(kE).toVar("cameraViewMatrix")}else t=Jx("mat4").label("cameraViewMatrix").setGroup(Yx).onRenderUpdate((function(e){return e.camera.matrixWorldInverse}));return t})).once()(),IE=Jx("mat4").label("cameraWorldMatrix").setGroup(Yx).onRenderUpdate((function(e){return e.camera.matrixWorld})),LE=Jx("mat3").label("cameraNormalMatrix").setGroup(Yx).onRenderUpdate((function(e){return e.camera.normalMatrix})),DE=Jx(new Kr).label("cameraPosition").setGroup(Yx).onRenderUpdate((function(e,t){var n=e.camera;return t.value.setFromMatrixPosition(n.matrixWorld)})),OE=new mi,UE=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this)).scope=e,r.object3d=i,r.updateType=tb.OBJECT,r._uniformNode=new Zx(null),r}return p(n,[{key:"getNodeType",value:function(){var e=this.scope;return e===n.WORLD_MATRIX?"mat4":e===n.POSITION||e===n.VIEW_POSITION||e===n.DIRECTION||e===n.SCALE?"vec3":e===n.RADIUS?"float":void 0}},{key:"update",value:function(e){var t=this.object3d,r=this._uniformNode,i=this.scope;if(i===n.WORLD_MATRIX)r.value=t.matrixWorld;else if(i===n.POSITION)r.value=r.value||new Kr,r.value.setFromMatrixPosition(t.matrixWorld);else if(i===n.SCALE)r.value=r.value||new Kr,r.value.setFromMatrixScale(t.matrixWorld);else if(i===n.DIRECTION)r.value=r.value||new Kr,t.getWorldDirection(r.value);else if(i===n.VIEW_POSITION){var a=e.camera;r.value=r.value||new Kr,r.value.setFromMatrixPosition(t.matrixWorld),r.value.applyMatrix4(a.matrixWorldInverse)}else if(i===n.RADIUS){var o=e.object.geometry;null===o.boundingSphere&&o.computeBoundingSphere(),OE.copy(o.boundingSphere).applyMatrix4(t.matrixWorld),r.value=OE.radius}}},{key:"generate",value:function(e){var t=this.scope;return t===n.WORLD_MATRIX?this._uniformNode.nodeType="mat4":t===n.POSITION||t===n.VIEW_POSITION||t===n.DIRECTION||t===n.SCALE?this._uniformNode.nodeType="vec3":t===n.RADIUS&&(this._uniformNode.nodeType="float"),this._uniformNode.build(e)}},{key:"serialize",value:function(e){ht(m(n.prototype),"serialize",this).call(this,e),e.scope=this.scope}},{key:"deserialize",value:function(e){ht(m(n.prototype),"deserialize",this).call(this,e),this.scope=e.scope}}],[{key:"type",get:function(){return"Object3DNode"}}]),n}(ub);UE.WORLD_MATRIX="worldMatrix",UE.POSITION="position",UE.SCALE="scale",UE.VIEW_POSITION="viewPosition",UE.DIRECTION="direction",UE.RADIUS="radius";var BE=dx(UE,UE.DIRECTION).setParameterLength(1),FE=dx(UE,UE.WORLD_MATRIX).setParameterLength(1),zE=dx(UE,UE.POSITION).setParameterLength(1),VE=dx(UE,UE.SCALE).setParameterLength(1),qE=dx(UE,UE.VIEW_POSITION).setParameterLength(1),jE=dx(UE,UE.RADIUS).setParameterLength(1),GE=function(e){v(n,e);var t=b(n);function n(e){return c(this,n),t.call(this,e)}return p(n,[{key:"update",value:function(e){this.object3d=e.object,ht(m(n.prototype),"update",this).call(this,e)}}],[{key:"type",get:function(){return"ModelNode"}}]),n}(UE),HE=px(GE,GE.DIRECTION),WE=px(GE,GE.WORLD_MATRIX),XE=px(GE,GE.POSITION),QE=px(GE,GE.SCALE),YE=px(GE,GE.VIEW_POSITION),KE=px(GE,GE.RADIUS),ZE=Jx(new br).onObjectUpdate((function(e,t){var n=e.object;return t.value.getNormalMatrix(n.matrixWorld)})),JE=Jx(new Ei).onObjectUpdate((function(e,t){var n=e.object;return t.value.copy(n.matrixWorld).invert()})),$E=vx((function(e){return e.renderer.nodes.modelViewMatrix||ek})).once()().toVar("modelViewMatrix"),ek=NE.mul(WE),tk=vx((function(e){return e.context.isHighPrecisionModelViewMatrix=!0,Jx("mat4").onObjectUpdate((function(e){var t=e.object,n=e.camera;return t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld)}))})).once()().toVar("highpModelViewMatrix"),nk=vx((function(e){var t=e.context.isHighPrecisionModelViewMatrix;return Jx("mat3").onObjectUpdate((function(e){var n=e.object,r=e.camera;return!0!==t&&n.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,n.matrixWorld),n.normalMatrix.getNormalMatrix(n.modelViewMatrix)}))})).once()().toVar("highpModelNormalViewMatrix"),rk=dE("position","vec3"),ik=rk.toVarying("positionLocal"),ak=rk.toVarying("positionPrevious"),ok=WE.mul(ik).xyz.toVarying("v_positionWorld").context({needsPositionReassign:!0}),sk=ik.transformDirection(WE).toVarying("v_positionWorldDirection").normalize().toVar("positionWorldDirection").context({needsPositionReassign:!0}),uk=vx((function(e){return e.context.setupPositionView()}),"vec3").once()().toVarying("v_positionView").context({needsPositionReassign:!0}),lk=uk.negate().toVarying("v_positionViewDirection").normalize().toVar("positionViewDirection"),ck=px(function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this,"bool")).isFrontFacingNode=!0,e}return p(n,[{key:"generate",value:function(e){var t=e.renderer,n=e.material;return t.coordinateSystem===or&&1===n.side?"false":e.getFrontFacing()}}],[{key:"type",get:function(){return"FrontFacingNode"}}]),n}(ub)),hk=xx(ck).mul(2).sub(1),fk=dE("normal","vec3"),dk=vx((function(e){return!1===e.geometry.hasAttribute("normal")?(console.warn('THREE.TSL: Vertex attribute "normal" not found on geometry.'),Rx(0,1,0)):fk}),"vec3").once()().toVar("normalLocal"),pk=uk.dFdx().cross(uk.dFdy()).normalize().toVar("normalFlat"),Ak=vx((function(e){return!0===e.material.flatShading?pk:MS(bk(dk),"v_normalView").normalize()}),"vec3").once()().toVar("normalView"),vk=MS(Ak.transformDirection(NE),"v_normalWorld").normalize().toVar("normalWorld"),mk=vx((function(e){return e.context.setupNormal().context({getUV:null})}),"vec3").once()().mul(hk).toVar("transformedNormalView"),gk=mk.transformDirection(NE).toVar("transformedNormalWorld"),yk=vx((function(e){return e.context.setupClearcoatNormal().context({getUV:null})}),"vec3").once()().mul(hk).toVar("transformedClearcoatNormalView"),_k=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=Fx(void 0===r?WE:r),a=n.div(Rx(i[0].dot(i[0]),i[1].dot(i[1]),i[2].dot(i[2])));return i.mul(a).xyz})),bk=vx((function(e,t){var n=T(e,1)[0],r=t.renderer.nodes.modelNormalViewMatrix;if(null!==r)return r.transformDirection(n);var i=ZE.mul(n);return NE.transformDirection(i)})),xk=new Oi,wk=new Ei,Tk=Jx(0).onReference((function(e){return e.material})).onObjectUpdate((function(e){return e.material.refractionRatio})),Sk=Jx(1).onReference((function(e){return e.material})).onObjectUpdate((function(e){var t=e.material,n=e.scene;return t.envMap?t.envMapIntensity:n.environmentIntensity})),Ek=Jx(new Ei).onReference((function(e){return e.material})).onObjectUpdate((function(e){var t=e.material,n=e.scene,r=null!==n.environment&&null===t.envMap?n.environmentRotation:t.envMapRotation;return r?(xk.copy(r),wk.makeRotationFromEuler(xk)):wk.identity(),wk})),kk=lk.negate().reflect(mk),Mk=lk.negate().refract(mk,Tk),Ck=kk.transformDirection(NE).toVar("reflectVector"),Rk=Mk.transformDirection(NE).toVar("reflectVector"),Pk=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return c(this,n),(r=t.call(this,e,i,a,o)).isCubeTextureNode=!0,r}return p(n,[{key:"getInputType",value:function(){return"cubeTexture"}},{key:"getDefaultUV",value:function(){var e=this.value;return e.mapping===Et?Ck:e.mapping===kt?Rk:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',e.mapping),Rx(0,0,0))}},{key:"setUpdateMatrix",value:function(){}},{key:"setupUV",value:function(e,t){var n=this.value;return e.renderer.coordinateSystem!==sr&&n.isRenderTargetTexture||(t=Rx(t.x.negate(),t.yz)),Ek.mul(t)}},{key:"generateUV",value:function(e,t){return t.build(e,"vec3")}}],[{key:"type",get:function(){return"CubeTextureNode"}}]),n}(yE),Nk=dx(Pk).setParameterLength(1,4).setName("cubeTexture"),Ik=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,e,r)).referenceNode=e,i.isReferenceElementNode=!0,i}return p(n,[{key:"getNodeType",value:function(){return this.referenceNode.uniformType}},{key:"generate",value:function(e){var t=ht(m(n.prototype),"generate",this).call(this,e),r=this.referenceNode.getNodeType(),i=this.getNodeType();return e.format(t,r,i)}}],[{key:"type",get:function(){return"ReferenceElementNode"}}]),n}(lb),Lk=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return c(this,n),(i=t.call(this)).property=e,i.uniformType=r,i.object=a,i.count=o,i.properties=e.split("."),i.reference=a,i.node=null,i.group=null,i.name=null,i.updateType=tb.OBJECT,i}return p(n,[{key:"element",value:function(e){return cx(new Ik(this,cx(e)))}},{key:"setGroup",value:function(e){return this.group=e,this}},{key:"label",value:function(e){return this.name=e,this}},{key:"setNodeType",value:function(e){var t=null;t=null!==this.count?wE(null,e,this.count):Array.isArray(this.getValueFromReference())?EE(null,e):"texture"===e?_E(null):"cubeTexture"===e?Nk(null):Jx(null,e),null!==this.group&&t.setGroup(this.group),null!==this.name&&t.label(this.name),this.node=t.getSelf()}},{key:"getNodeType",value:function(e){return null===this.node&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}},{key:"getValueFromReference",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.reference,t=this.properties,n=e[t[0]],r=1;r<t.length;r++)n=n[t[r]];return n}},{key:"updateReference",value:function(e){return this.reference=null!==this.object?this.object:e.object,this.reference}},{key:"setup",value:function(){return this.updateValue(),this.node}},{key:"update",value:function(){this.updateValue()}},{key:"updateValue",value:function(){null===this.node&&this.setNodeType(this.uniformType);var e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}],[{key:"type",get:function(){return"ReferenceNode"}}]),n}(ub),Dk=function(e,t,n){return cx(new Lk(e,t,n))},Ok=function(e,t,n,r){return cx(new Lk(e,t,r,n))},Uk=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return c(this,n),(i=t.call(this,e,r,a)).material=a,i.isMaterialReferenceNode=!0,i}return p(n,[{key:"updateReference",value:function(e){return this.reference=null!==this.material?this.material:e.material,this.reference}}],[{key:"type",get:function(){return"MaterialReferenceNode"}}]),n}(Lk),Bk=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return cx(new Uk(e,t,n))},Fk=vx((function(e){return!1===e.geometry.hasAttribute("tangent")&&e.geometry.computeTangents(),dE("tangent","vec4")}))(),zk=Fk.xyz.toVar("tangentLocal"),Vk=$E.mul(Lx(zk,0)).xyz.toVarying("v_tangentView").normalize().toVar("tangentView"),qk=Vk.transformDirection(NE).toVarying("v_tangentWorld").normalize().toVar("tangentWorld"),jk=Vk.toVar("transformedTangentView"),Gk=jk.transformDirection(NE).normalize().toVar("transformedTangentWorld"),Hk=function(e){return e.mul(Fk.w).xyz},Wk=MS(Hk(fk.cross(Fk)),"v_bitangentGeometry").normalize().toVar("bitangentGeometry"),Xk=MS(Hk(dk.cross(zk)),"v_bitangentLocal").normalize().toVar("bitangentLocal"),Qk=MS(Hk(Ak.cross(Vk)),"v_bitangentView").normalize().toVar("bitangentView"),Yk=MS(Hk(vk.cross(qk)),"v_bitangentWorld").normalize().toVar("bitangentWorld"),Kk=Hk(mk.cross(jk)).normalize().toVar("transformedBitangentView"),Zk=Kk.transformDirection(NE).normalize().toVar("transformedBitangentWorld"),Jk=Fx(Vk,Qk,Ak),$k=lk.mul(Jk),eM=function(){var e=vw.cross(lk);return e=e.cross(vw).normalize(),e=iS(e,mk,pw.mul(iw.oneMinus()).oneMinus().pow2().pow2()).normalize()}(),tM=vx((function(e){var t=e.eye_pos,n=e.surf_norm,r=e.mapN,i=e.uv,a=t.dFdx(),o=t.dFdy(),s=i.dFdx(),u=i.dFdy(),l=n,c=o.cross(l),h=l.cross(a),f=c.mul(s.x).add(h.mul(u.x)),d=c.mul(s.y).add(h.mul(u.y)),p=f.dot(f).max(d.dot(d)),A=hk.mul(p.inverseSqrt());return Dw(f.mul(r.x,A),d.mul(r.y,A),l.mul(r.z)).normalize()})),nM=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this,"vec3")).node=e,r.scaleNode=i,r.normalMapType=0,r}return p(n,[{key:"setup",value:function(e){var t=this.normalMapType,n=this.scaleNode,r=this.node.mul(2).sub(1);null!==n&&(r=Rx(r.xy.mul(n),r.z));var i=null;if(1===t)i=bk(r);else if(0===t){i=!0===e.hasGeometryAttribute("tangent")?Jk.mul(r).normalize():tM({eye_pos:uk,surf_norm:Ak,mapN:r,uv:pE()})}return i}}],[{key:"type",get:function(){return"NormalMapNode"}}]),n}(hb),rM=dx(nM).setParameterLength(1,2),iM=vx((function(e){var t=e.textureNode,n=e.bumpScale,r=function(e){return t.cache().context({getUV:function(t){return e(t.uvNode||pE())},forceUVContext:!0})},i=xx(r((function(e){return e})));return Ex(xx(r((function(e){return e.add(e.dFdx())}))).sub(i),xx(r((function(e){return e.add(e.dFdy())}))).sub(i)).mul(n)})),aM=vx((function(e){var t=e.surf_pos,n=e.surf_norm,r=e.dHdxy,i=t.dFdx().normalize(),a=n,o=t.dFdy().normalize().cross(a),s=a.cross(i),u=i.dot(o).mul(hk),l=u.sign().mul(r.x.mul(o).add(r.y.mul(s)));return u.abs().mul(n).sub(l).normalize()})),oM=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this,"vec3")).textureNode=e,r.scaleNode=i,r}return p(n,[{key:"setup",value:function(){var e=null!==this.scaleNode?this.scaleNode:1,t=iM({textureNode:this.textureNode,bumpScale:e});return aM({surf_pos:uk,surf_norm:Ak,dHdxy:t})}}],[{key:"type",get:function(){return"BumpMapNode"}}]),n}(hb),sM=dx(oM).setParameterLength(1,2),uM=new Map,lM=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).scope=e,r}return p(n,[{key:"getCache",value:function(e,t){var n=uM.get(e);return void 0===n&&(n=Bk(e,t),uM.set(e,n)),n}},{key:"getFloat",value:function(e){return this.getCache(e,"float")}},{key:"getColor",value:function(e){return this.getCache(e,"color")}},{key:"getTexture",value:function(e){return this.getCache("map"===e?"map":e+"Map","texture")}},{key:"setup",value:function(e){var t=e.context.material,r=this.scope,i=null;if(r===n.COLOR){var a=void 0!==t.color?this.getColor(r):Rx();i=t.map&&!0===t.map.isTexture?a.mul(this.getTexture("map")):a}else if(r===n.OPACITY){var o=this.getFloat(r);i=t.alphaMap&&!0===t.alphaMap.isTexture?o.mul(this.getTexture("alpha")):o}else if(r===n.SPECULAR_STRENGTH)i=t.specularMap&&!0===t.specularMap.isTexture?this.getTexture("specular").r:xx(1);else if(r===n.SPECULAR_INTENSITY){var s=this.getFloat(r);i=t.specularIntensityMap&&!0===t.specularIntensityMap.isTexture?s.mul(this.getTexture(r).a):s}else if(r===n.SPECULAR_COLOR){var u=this.getColor(r);i=t.specularColorMap&&!0===t.specularColorMap.isTexture?u.mul(this.getTexture(r).rgb):u}else if(r===n.ROUGHNESS){var l=this.getFloat(r);i=t.roughnessMap&&!0===t.roughnessMap.isTexture?l.mul(this.getTexture(r).g):l}else if(r===n.METALNESS){var c=this.getFloat(r);i=t.metalnessMap&&!0===t.metalnessMap.isTexture?c.mul(this.getTexture(r).b):c}else if(r===n.EMISSIVE){var h=this.getFloat("emissiveIntensity"),f=this.getColor(r).mul(h);i=t.emissiveMap&&!0===t.emissiveMap.isTexture?f.mul(this.getTexture(r)):f}else if(r===n.NORMAL)t.normalMap?(i=rM(this.getTexture("normal"),this.getCache("normalScale","vec2"))).normalMapType=t.normalMapType:i=t.bumpMap?sM(this.getTexture("bump").r,this.getFloat("bumpScale")):Ak;else if(r===n.CLEARCOAT){var d=this.getFloat(r);i=t.clearcoatMap&&!0===t.clearcoatMap.isTexture?d.mul(this.getTexture(r).r):d}else if(r===n.CLEARCOAT_ROUGHNESS){var p=this.getFloat(r);i=t.clearcoatRoughnessMap&&!0===t.clearcoatRoughnessMap.isTexture?p.mul(this.getTexture(r).r):p}else if(r===n.CLEARCOAT_NORMAL)i=t.clearcoatNormalMap?rM(this.getTexture(r),this.getCache(r+"Scale","vec2")):Ak;else if(r===n.SHEEN){var A=this.getColor("sheenColor").mul(this.getFloat("sheen"));i=t.sheenColorMap&&!0===t.sheenColorMap.isTexture?A.mul(this.getTexture("sheenColor").rgb):A}else if(r===n.SHEEN_ROUGHNESS){var v=this.getFloat(r);i=(i=t.sheenRoughnessMap&&!0===t.sheenRoughnessMap.isTexture?v.mul(this.getTexture(r).a):v).clamp(.07,1)}else if(r===n.ANISOTROPY)if(t.anisotropyMap&&!0===t.anisotropyMap.isTexture){var m=this.getTexture(r);i=Bx(XM.x,XM.y,XM.y.negate(),XM.x).mul(m.rg.mul(2).sub(Ex(1)).normalize().mul(m.b))}else i=XM;else if(r===n.IRIDESCENCE_THICKNESS){var g=Dk("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){var y=Dk("0","float",t.iridescenceThicknessRange);i=g.sub(y).mul(this.getTexture(r).g).add(y)}else i=g}else if(r===n.TRANSMISSION){var _=this.getFloat(r);i=t.transmissionMap?_.mul(this.getTexture(r).r):_}else if(r===n.THICKNESS){var b=this.getFloat(r);i=t.thicknessMap?b.mul(this.getTexture(r).g):b}else if(r===n.IOR)i=this.getFloat(r);else if(r===n.LIGHT_MAP)i=this.getTexture(r).rgb.mul(this.getFloat("lightMapIntensity"));else if(r===n.AO)i=this.getTexture(r).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else{var x=this.getNodeType(e);i=this.getCache(r,x)}return i}}],[{key:"type",get:function(){return"MaterialNode"}}]),n}(ub);lM.ALPHA_TEST="alphaTest",lM.COLOR="color",lM.OPACITY="opacity",lM.SHININESS="shininess",lM.SPECULAR="specular",lM.SPECULAR_STRENGTH="specularStrength",lM.SPECULAR_INTENSITY="specularIntensity",lM.SPECULAR_COLOR="specularColor",lM.REFLECTIVITY="reflectivity",lM.ROUGHNESS="roughness",lM.METALNESS="metalness",lM.NORMAL="normal",lM.CLEARCOAT="clearcoat",lM.CLEARCOAT_ROUGHNESS="clearcoatRoughness",lM.CLEARCOAT_NORMAL="clearcoatNormal",lM.EMISSIVE="emissive",lM.ROTATION="rotation",lM.SHEEN="sheen",lM.SHEEN_ROUGHNESS="sheenRoughness",lM.ANISOTROPY="anisotropy",lM.IRIDESCENCE="iridescence",lM.IRIDESCENCE_IOR="iridescenceIOR",lM.IRIDESCENCE_THICKNESS="iridescenceThickness",lM.IOR="ior",lM.TRANSMISSION="transmission",lM.THICKNESS="thickness",lM.ATTENUATION_DISTANCE="attenuationDistance",lM.ATTENUATION_COLOR="attenuationColor",lM.LINE_SCALE="scale",lM.LINE_DASH_SIZE="dashSize",lM.LINE_GAP_SIZE="gapSize",lM.LINE_WIDTH="linewidth",lM.LINE_DASH_OFFSET="dashOffset",lM.POINT_SIZE="size",lM.DISPERSION="dispersion",lM.LIGHT_MAP="light",lM.AO="ao";var cM=px(lM,lM.ALPHA_TEST),hM=px(lM,lM.COLOR),fM=px(lM,lM.SHININESS),dM=px(lM,lM.EMISSIVE),pM=px(lM,lM.OPACITY),AM=px(lM,lM.SPECULAR),vM=px(lM,lM.SPECULAR_INTENSITY),mM=px(lM,lM.SPECULAR_COLOR),gM=px(lM,lM.SPECULAR_STRENGTH),yM=px(lM,lM.REFLECTIVITY),_M=px(lM,lM.ROUGHNESS),bM=px(lM,lM.METALNESS),xM=px(lM,lM.NORMAL),wM=px(lM,lM.CLEARCOAT),TM=px(lM,lM.CLEARCOAT_ROUGHNESS),SM=px(lM,lM.CLEARCOAT_NORMAL),EM=px(lM,lM.ROTATION),kM=px(lM,lM.SHEEN),MM=px(lM,lM.SHEEN_ROUGHNESS),CM=px(lM,lM.ANISOTROPY),RM=px(lM,lM.IRIDESCENCE),PM=px(lM,lM.IRIDESCENCE_IOR),NM=px(lM,lM.IRIDESCENCE_THICKNESS),IM=px(lM,lM.TRANSMISSION),LM=px(lM,lM.THICKNESS),DM=px(lM,lM.IOR),OM=px(lM,lM.ATTENUATION_DISTANCE),UM=px(lM,lM.ATTENUATION_COLOR),BM=px(lM,lM.LINE_SCALE),FM=px(lM,lM.LINE_DASH_SIZE),zM=px(lM,lM.LINE_GAP_SIZE),VM=px(lM,lM.LINE_WIDTH),qM=px(lM,lM.LINE_DASH_OFFSET),jM=px(lM,lM.POINT_SIZE),GM=px(lM,lM.DISPERSION),HM=px(lM,lM.LIGHT_MAP),WM=px(lM,lM.AO),XM=Jx(new _r).onReference((function(e){return e.material})).onRenderUpdate((function(e){var t=e.material;this.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation))})),QM=vx((function(e){return e.context.setupModelViewProjection()}),"vec4").once()().toVarying("v_modelViewProjection"),YM=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,"uint")).scope=e,r.isIndexNode=!0,r}return p(n,[{key:"generate",value:function(e){var t,r,i=this.getNodeType(e),a=this.scope;if(a===n.VERTEX)t=e.getVertexIndex();else if(a===n.INSTANCE)t=e.getInstanceIndex();else if(a===n.DRAW)t=e.getDrawIndex();else if(a===n.INVOCATION_LOCAL)t=e.getInvocationLocalIndex();else if(a===n.INVOCATION_SUBGROUP)t=e.getInvocationSubgroupIndex();else{if(a!==n.SUBGROUP)throw new Error("THREE.IndexNode: Unknown scope: "+a);t=e.getSubgroupIndex()}"vertex"===e.shaderStage||"compute"===e.shaderStage?r=t:r=MS(this).build(e,i);return r}}],[{key:"type",get:function(){return"IndexNode"}}]),n}(ub);YM.VERTEX="vertex",YM.INSTANCE="instance",YM.SUBGROUP="subgroup",YM.INVOCATION_LOCAL="invocationLocal",YM.INVOCATION_SUBGROUP="invocationSubgroup",YM.DRAW="draw";var KM=px(YM,YM.VERTEX),ZM=px(YM,YM.INSTANCE),JM=px(YM,YM.SUBGROUP),$M=px(YM,YM.INVOCATION_SUBGROUP),eC=px(YM,YM.INVOCATION_LOCAL),tC=px(YM,YM.DRAW),nC=function(e){v(n,e);var t=b(n);function n(e,r,i){var a;return c(this,n),(a=t.call(this,"void")).count=e,a.instanceMatrix=r,a.instanceColor=i,a.instanceMatrixNode=null,a.instanceColorNode=null,a.updateType=tb.FRAME,a.buffer=null,a.bufferColor=null,a}return p(n,[{key:"setup",value:function(e){var t=this.count,n=this.instanceMatrix,r=this.instanceColor,i=this.instanceMatrixNode,a=this.instanceColorNode;if(null===i){if(t<=1e3)i=wE(n.array,"mat4",Math.max(t,1)).element(ZM);else{var o=new bl(n.array,16,1);this.buffer=o;var s=n.usage===ir?KS:YS,u=[s(o,"vec4",16,0),s(o,"vec4",16,4),s(o,"vec4",16,8),s(o,"vec4",16,12)];i=zx.apply(void 0,u)}this.instanceMatrixNode=i}if(r&&null===a){var l=new ko(r.array,3),c=r.usage===ir?KS:YS;this.bufferColor=l,a=Rx(c(l,"vec3",3,0)),this.instanceColorNode=a}var h=i.mul(ik).xyz;if(ik.assign(h),e.hasGeometryAttribute("normal")){var f=_k(dk,i);dk.assign(f)}null!==this.instanceColorNode&&tw("vec3","vInstanceColor").assign(this.instanceColorNode)}},{key:"update",value:function(){this.instanceMatrix.usage!==ir&&null!==this.buffer&&this.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMatrix.version),this.instanceColor&&this.instanceColor.usage!==ir&&null!==this.bufferColor&&this.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceColor.version)}}],[{key:"type",get:function(){return"InstanceNode"}}]),n}(ub),rC=dx(nC).setParameterLength(3),iC=function(e){v(n,e);var t=b(n);function n(e){var r;c(this,n);var i=e.count,a=e.instanceMatrix,o=e.instanceColor;return(r=t.call(this,i,a,o)).instancedMesh=e,r}return p(n,null,[{key:"type",get:function(){return"InstancedMeshNode"}}]),n}(nC),aC=dx(iC).setParameterLength(1),oC=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,"void")).batchMesh=e,r.batchingIdNode=null,r}return p(n,[{key:"setup",value:function(e){var t=this;null===this.batchingIdNode&&(null===e.getDrawIndex()?this.batchingIdNode=ZM:this.batchingIdNode=tC);var n=vx((function(e){var n=T(e,1)[0],r=wx(vE(bE(t.batchMesh._indirectTexture),0).x),i=wx(n).mod(r),a=wx(n).div(r);return bE(t.batchMesh._indirectTexture,kx(i,a)).x})).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]}),r=n(wx(this.batchingIdNode)),i=this.batchMesh._matricesTexture,a=wx(vE(bE(i),0).x),o=xx(r).mul(4).toInt().toVar(),s=o.mod(a),u=o.div(a),l=zx(bE(i,kx(s,u)),bE(i,kx(s.add(1),u)),bE(i,kx(s.add(2),u)),bE(i,kx(s.add(3),u))),c=this.batchMesh._colorsTexture;if(null!==c){var h=vx((function(e){var t=T(e,1)[0],n=wx(vE(bE(c),0).x),r=t,i=r.mod(n),a=r.div(n);return bE(c,kx(i,a)).rgb})).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]}),f=h(r);tw("vec3","vBatchColor").assign(f)}var d=Fx(l);ik.assign(l.mul(ik));var p=dk.div(Rx(d[0].dot(d[0]),d[1].dot(d[1]),d[2].dot(d[2]))),A=d.mul(p).xyz;dk.assign(A),e.hasGeometryAttribute("tangent")&&zk.mulAssign(d)}}],[{key:"type",get:function(){return"BatchNode"}}]),n}(ub),sC=dx(oC).setParameterLength(1),uC=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,e,r)).isStorageArrayElementNode=!0,i}return p(n,[{key:"storageBufferNode",get:function(){return this.node},set:function(e){this.node=e}},{key:"getMemberType",value:function(e,t){var n=this.storageBufferNode.structTypeNode;return n?n.getMemberType(e,t):"void"}},{key:"setup",value:function(e){return!1===e.isAvailable("storageBuffer")&&!0===this.node.isPBO&&e.setupPBO(this.node),ht(m(n.prototype),"setup",this).call(this,e)}},{key:"generate",value:function(e,t){var r,i=e.context.assign;if(r=!1===e.isAvailable("storageBuffer")?!0!==this.node.isPBO||!0===i||!this.node.value.isInstancedBufferAttribute&&"compute"===e.shaderStage?this.node.build(e):e.generatePBO(this):ht(m(n.prototype),"generate",this).call(this,e),!0!==i){var a=this.getNodeType(e);r=e.format(r,a,t)}return r}}],[{key:"type",get:function(){return"StorageArrayElementNode"}}]),n}(lb),lC=dx(uC).setParameterLength(2),cC=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;c(this,n);var o,s=null;return i&&i.isStruct?(o="struct",s=i.layout):null===i&&(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)?(o=W_(e.itemSize),a=e.count):o=i,(r=t.call(this,e,o,a)).isStorageBufferNode=!0,r.structTypeNode=s,r.access=nb.READ_WRITE,r.isAtomic=!1,r.isPBO=!1,r._attribute=null,r._varying=null,r.global=!0,!0!==e.isStorageBufferAttribute&&!0!==e.isStorageInstancedBufferAttribute&&(e.isInstancedBufferAttribute?e.isStorageInstancedBufferAttribute=!0:e.isStorageBufferAttribute=!0),r}return p(n,[{key:"getHash",value:function(e){if(0===this.bufferCount){var t=e.globalCache.getData(this.value);return void 0===t&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}},{key:"getInputType",value:function(){return this.value.isIndirectStorageBufferAttribute?"indirectStorageBuffer":"storageBuffer"}},{key:"element",value:function(e){return lC(this,e)}},{key:"setPBO",value:function(e){return this.isPBO=e,this}},{key:"getPBO",value:function(){return this.isPBO}},{key:"setAccess",value:function(e){return this.access=e,this}},{key:"toReadOnly",value:function(){return this.setAccess(nb.READ_ONLY)}},{key:"setAtomic",value:function(e){return this.isAtomic=e,this}},{key:"toAtomic",value:function(){return this.setAtomic(!0)}},{key:"getAttributeData",value:function(){return null===this._attribute&&(this._attribute=XS(this.value),this._varying=MS(this._attribute)),{attribute:this._attribute,varying:this._varying}}},{key:"getNodeType",value:function(e){return null!==this.structTypeNode?this.structTypeNode.getNodeType(e):e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer")?ht(m(n.prototype),"getNodeType",this).call(this,e):this.getAttributeData().attribute.getNodeType(e)}},{key:"generate",value:function(e){if(null!==this.structTypeNode&&this.structTypeNode.build(e),e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return ht(m(n.prototype),"generate",this).call(this,e);var t=this.getAttributeData(),r=t.attribute,i=t.varying.build(e);return e.registerTransform(i,r),i}}],[{key:"type",get:function(){return"StorageBufferNode"}}]),n}(xE),hC=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return cx(new cC(e,t,n))},fC=new WeakMap,dC=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,"void")).skinnedMesh=e,r.updateType=tb.OBJECT,r.skinIndexNode=dE("skinIndex","uvec4"),r.skinWeightNode=dE("skinWeight","vec4"),r.bindMatrixNode=Dk("bindMatrix","mat4"),r.bindMatrixInverseNode=Dk("bindMatrixInverse","mat4"),r.boneMatricesNode=Ok("skeleton.boneMatrices","mat4",e.skeleton.bones.length),r.positionNode=ik,r.toPositionNode=ik,r.previousBoneMatricesNode=null,r}return p(n,[{key:"getSkinnedPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.boneMatricesNode,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.positionNode,n=this.skinIndexNode,r=this.skinWeightNode,i=this.bindMatrixNode,a=this.bindMatrixInverseNode,o=e.element(n.x),s=e.element(n.y),u=e.element(n.z),l=e.element(n.w),c=i.mul(t),h=Dw(o.mul(r.x).mul(c),s.mul(r.y).mul(c),u.mul(r.z).mul(c),l.mul(r.w).mul(c));return a.mul(h).xyz}},{key:"getSkinnedNormal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.boneMatricesNode,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dk,n=this.skinIndexNode,r=this.skinWeightNode,i=this.bindMatrixNode,a=this.bindMatrixInverseNode,o=e.element(n.x),s=e.element(n.y),u=e.element(n.z),l=e.element(n.w),c=Dw(r.x.mul(o),r.y.mul(s),r.z.mul(u),r.w.mul(l));return(c=a.mul(c).mul(i)).transformDirection(t).xyz}},{key:"getPreviousSkinnedPosition",value:function(e){var t=e.object;return null===this.previousBoneMatricesNode&&(t.skeleton.previousBoneMatrices=new Float32Array(t.skeleton.boneMatrices),this.previousBoneMatricesNode=Ok("skeleton.previousBoneMatrices","mat4",t.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,ak)}},{key:"needsPreviousBoneMatrices",value:function(e){var t=e.renderer.getMRT();return t&&t.has("velocity")||!0===Z_(e.object).useVelocity}},{key:"setup",value:function(e){this.needsPreviousBoneMatrices(e)&&ak.assign(this.getPreviousSkinnedPosition(e));var t=this.getSkinnedPosition();if(this.toPositionNode&&this.toPositionNode.assign(t),e.hasGeometryAttribute("normal")){var n=this.getSkinnedNormal();dk.assign(n),e.hasGeometryAttribute("tangent")&&zk.assign(n)}return t}},{key:"generate",value:function(e,t){if("void"!==t)return ht(m(n.prototype),"generate",this).call(this,e,t)}},{key:"update",value:function(e){var t=e.object&&e.object.skeleton?e.object.skeleton:this.skinnedMesh.skeleton;fC.get(t)!==e.frameId&&(fC.set(t,e.frameId),null!==this.previousBoneMatricesNode&&t.previousBoneMatrices.set(t.boneMatrices),t.update())}}],[{key:"type",get:function(){return"SkinningNode"}}]),n}(ub),pC=function(e){return cx(new dC(e))},AC=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return c(this,n),(e=t.call(this)).params=r,e}return p(n,[{key:"getVarName",value:function(e){return String.fromCharCode("i".charCodeAt(0)+e)}},{key:"getProperties",value:function(e){var t=e.getNodeProperties(this);if(void 0!==t.stackNode)return t;for(var n={},r=0,i=this.params.length-1;r<i;r++){var a=this.params[r],o=!0!==a.isNode&&a.name||this.getVarName(r),s=!0!==a.isNode&&a.type||"int";n[o]=oE(o,s)}var u=e.addStack();return t.returnsNode=this.params[this.params.length-1](n,u,e),t.stackNode=u,e.removeStack(),t}},{key:"getNodeType",value:function(e){var t=this.getProperties(e).returnsNode;return t?t.getNodeType(e):"void"}},{key:"setup",value:function(e){this.getProperties(e)}},{key:"generate",value:function(e){for(var t=this.getProperties(e),n=this.params,r=t.stackNode,i=0,a=n.length-1;i<a;i++){var o=n[i],s=!1,u=null,l=null,c=null,h=null,f=null,d=null;o.isNode?"bool"===o.getNodeType(e)?(s=!0,h="bool",l=o.build(e,h)):(h="int",c=this.getVarName(i),u="0",l=o.build(e,h),f="<"):(h=o.type||"int",c=o.name||this.getVarName(i),u=o.start,l=o.end,f=o.condition,d=o.update,"number"===typeof u?u=e.generateConst(h,u):u&&u.isNode&&(u=u.build(e,h)),"number"===typeof l?l=e.generateConst(h,l):l&&l.isNode&&(l=l.build(e,h)),void 0!==u&&void 0===l?(u+=" - 1",l="0",f=">="):void 0!==l&&void 0===u&&(u="0",f="<"),void 0===f&&(f=Number(u)>Number(l)?">=":"<"));var p=void 0;if(s)p="while ( ".concat(l," )");else{var A={start:u,end:l},v=A.start,m=A.end,g="",y="",_="";d||(d="int"===h||"uint"===h?f.includes("<")?"++":"--":f.includes("<")?"+= 1.":"-= 1."),g+=e.getVar(h,c)+" = "+v,y+=c+" "+f+" "+m,_+=c+" "+d,p="for ( ".concat(g,"; ").concat(y,"; ").concat(_," )")}e.addFlowCode((0===i?"\n":"")+e.tab+p+" {\n\n").addFlowTab()}var b=r.build(e,"void"),x=t.returnsNode?t.returnsNode.build(e):"";e.removeFlowTab().addFlowCode("\n"+e.tab+b);for(var w=0,T=this.params.length-1;w<T;w++)e.addFlowCode((0===w?"":e.tab)+"}\n\n").removeFlowTab();return e.addFlowTab(),x}}],[{key:"type",get:function(){return"LoopNode"}}]),n}(ub),vC=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return cx(new AC(fx(t,"int"))).append()},mC=function(){return oE("break").append()},gC=new WeakMap,yC=new Gr,_C=vx((function(e){var t=e.bufferMap,n=e.influence,r=e.stride,i=e.width,a=e.depth,o=e.offset,s=wx(KM).mul(r).add(o),u=s.div(i),l=s.sub(u.mul(i));return bE(t,kx(l,u)).depth(a).xyz.mul(n)}));var bC,xC,wC=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,"void")).mesh=e,r.morphBaseInfluence=Jx(1),r.updateType=tb.OBJECT,r}return p(n,[{key:"setup",value:function(e){var t=this,n=e.geometry,r=void 0!==n.morphAttributes.position,i=n.hasAttribute("normal")&&void 0!==n.morphAttributes.normal,a=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,o=void 0!==a?a.length:0,s=function(e){var t=void 0!==e.morphAttributes.position,n=void 0!==e.morphAttributes.normal,r=void 0!==e.morphAttributes.color,i=e.morphAttributes.position||e.morphAttributes.normal||e.morphAttributes.color,a=void 0!==i?i.length:0,o=gC.get(e);if(void 0===o||o.count!==a){void 0!==o&&o.texture.dispose();var s=e.morphAttributes.position||[],u=e.morphAttributes.normal||[],l=e.morphAttributes.color||[],c=0;!0===t&&(c=1),!0===n&&(c=2),!0===r&&(c=3);var h=e.attributes.position.count*c,f=1,d=4096;h>d&&(f=Math.ceil(h/d),h=d);var p=new Float32Array(h*f*4*a),A=new Xr(p,h,f,a);A.type=Wt,A.needsUpdate=!0;for(var v=4*c,m=0;m<a;m++)for(var g=s[m],y=u[m],_=l[m],b=h*f*4*m,x=0;x<g.count;x++){var w=x*v;!0===t&&(yC.fromBufferAttribute(g,x),p[b+w+0]=yC.x,p[b+w+1]=yC.y,p[b+w+2]=yC.z,p[b+w+3]=0),!0===n&&(yC.fromBufferAttribute(y,x),p[b+w+4]=yC.x,p[b+w+5]=yC.y,p[b+w+6]=yC.z,p[b+w+7]=0),!0===r&&(yC.fromBufferAttribute(_,x),p[b+w+8]=yC.x,p[b+w+9]=yC.y,p[b+w+10]=yC.z,p[b+w+11]=4===_.itemSize?yC.w:1)}o={count:a,texture:A,stride:c,size:new _r(h,f)},gC.set(e,o),e.addEventListener("dispose",(function t(){A.dispose(),gC.delete(e),e.removeEventListener("dispose",t)}))}return o}(n),u=s.texture,l=s.stride,c=s.size;!0===r&&ik.mulAssign(this.morphBaseInfluence),!0===i&&dk.mulAssign(this.morphBaseInfluence);var h=wx(c.width);vC(o,(function(e){var n=e.i,a=xx(0).toVar();t.mesh.count>1&&null!==t.mesh.morphTexture&&void 0!==t.mesh.morphTexture?a.assign(bE(t.mesh.morphTexture,kx(wx(n).add(1),wx(ZM))).r):a.assign(Dk("morphTargetInfluences","float").element(n).toVar()),yx(a.notEqual(0),(function(){!0===r&&ik.addAssign(_C({bufferMap:u,influence:a,stride:l,width:h,depth:n,offset:wx(0)})),!0===i&&dk.addAssign(_C({bufferMap:u,influence:a,stride:l,width:h,depth:n,offset:wx(1)}))}))}))}},{key:"update",value:function(){var e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((function(e,t){return e+t}),0)}}],[{key:"type",get:function(){return"MorphNode"}}]),n}(ub),TC=dx(wC).setParameterLength(1),SC=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this,"vec3")).isLightingNode=!0,e}return p(n,null,[{key:"type",get:function(){return"LightingNode"}}]),n}(ub),EC=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return c(this,n),(e=t.call(this)).aoNode=r,e}return p(n,[{key:"setup",value:function(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}],[{key:"type",get:function(){return"AONode"}}]),n}(SC),kC=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return c(this,n),(r=t.call(this,e)).lightingModel=i,r.backdropNode=a,r.backdropAlphaNode=o,r._value=null,r}return p(n,[{key:"getContext",value:function(){var e=this.backdropNode,t=this.backdropAlphaNode,n={directDiffuse:Rx().toVar("directDiffuse"),directSpecular:Rx().toVar("directSpecular"),indirectDiffuse:Rx().toVar("indirectDiffuse"),indirectSpecular:Rx().toVar("indirectSpecular")};return{radiance:Rx().toVar("radiance"),irradiance:Rx().toVar("irradiance"),iblIrradiance:Rx().toVar("iblIrradiance"),ambientOcclusion:xx(1).toVar("ambientOcclusion"),reflectedLight:n,backdrop:e,backdropAlpha:t}}},{key:"setup",value:function(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,ht(m(n.prototype),"setup",this).call(this,e)}}],[{key:"type",get:function(){return"LightingContextNode"}}]),n}(yS),MC=dx(kC),CC=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).node=e,r}return p(n,[{key:"setup",value:function(e){e.context.irradiance.addAssign(this.node)}}],[{key:"type",get:function(){return"IrradianceNode"}}]),n}(SC),RC=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).scope=e,r.isViewportNode=!0,r}return p(n,[{key:"getNodeType",value:function(){return this.scope===n.VIEWPORT?"vec4":"vec2"}},{key:"getUpdateType",value:function(){var e=tb.NONE;return this.scope!==n.SIZE&&this.scope!==n.VIEWPORT||(e=tb.RENDER),this.updateType=e,e}},{key:"update",value:function(e){var t=e.renderer,r=t.getRenderTarget();this.scope===n.VIEWPORT?null!==r?xC.copy(r.viewport):(t.getViewport(xC),xC.multiplyScalar(t.getPixelRatio())):null!==r?(bC.width=r.width,bC.height=r.height):t.getDrawingBufferSize(bC)}},{key:"setup",value:function(){var e=this.scope;return e===n.SIZE?Jx(bC||(bC=new _r)):e===n.VIEWPORT?Jx(xC||(xC=new Gr)):Ex(IC.div(NC))}},{key:"generate",value:function(e){if(this.scope===n.COORDINATE){var t=e.getFragCoord();if(e.isFlipY()){var r=e.getNodeProperties(NC).outputNode.build(e);t="".concat(e.getType("vec2"),"( ").concat(t,".x, ").concat(r,".y - ").concat(t,".y )")}return t}return ht(m(n.prototype),"generate",this).call(this,e)}}],[{key:"type",get:function(){return"ScreenNode"}}]),n}(ub);RC.COORDINATE="coordinate",RC.VIEWPORT="viewport",RC.SIZE="size",RC.UV="uv";var PC=px(RC,RC.UV),NC=px(RC,RC.SIZE),IC=px(RC,RC.COORDINATE),LC=px(RC,RC.VIEWPORT),DC=LC.zw,OC=IC.sub(LC.xy),UC=OC.div(DC),BC=vx((function(){return console.warn('THREE.TSL: "viewportResolution" is deprecated. Use "screenSize" instead.'),NC}),"vec2").once()(),FC=vx((function(){return console.warn('THREE.TSL: "viewportTopLeft" is deprecated. Use "screenUV" instead.'),PC}),"vec2").once()(),zC=vx((function(){return console.warn('THREE.TSL: "viewportBottomLeft" is deprecated. Use "screenUV.flipY()" instead.'),PC.flipY()}),"vec2").once()(),VC=new _r,qC=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:PC,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return c(this,n),null===a&&((a=new ts).minFilter=Ft),(e=t.call(this,a,r,i)).generateMipmaps=!1,e.isOutputTextureNode=!0,e.updateBeforeType=tb.FRAME,e}return p(n,[{key:"updateBefore",value:function(e){var t=e.renderer;t.getDrawingBufferSize(VC);var n=this.value;n.image.width===VC.width&&n.image.height===VC.height||(n.image.width=VC.width,n.image.height=VC.height,n.needsUpdate=!0);var r=n.generateMipmaps;n.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(n),n.generateMipmaps=r}},{key:"clone",value:function(){var e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}],[{key:"type",get:function(){return"ViewportTextureNode"}}]),n}(yE),jC=dx(qC).setParameterLength(0,3),GC=dx(qC,null,null,{generateMipmaps:!0}).setParameterLength(0,3),HC=null,WC=function(e){v(n,e);var t=b(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:PC,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),null===HC&&(HC=new ns),t.call(this,e,r,HC)}return p(n,null,[{key:"type",get:function(){return"ViewportDepthTextureNode"}}]),n}(qC),XC=dx(WC).setParameterLength(0,2),QC=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this,"float")).scope=e,r.valueNode=i,r.isViewportDepthNode=!0,r}return p(n,[{key:"generate",value:function(e){return this.scope===n.DEPTH_BASE?e.getFragDepth():ht(m(n.prototype),"generate",this).call(this,e)}},{key:"setup",value:function(e){var t=e.camera,r=this.scope,i=this.valueNode,a=null;if(r===n.DEPTH_BASE)null!==i&&(a=$C().assign(i));else if(r===n.DEPTH)a=t.isPerspectiveCamera?KC(uk.z,ME,CE):YC(uk.z,ME,CE);else if(r===n.LINEAR_DEPTH)if(null!==i)if(t.isPerspectiveCamera){var o=ZC(i,ME,CE);a=YC(o,ME,CE)}else a=i;else a=YC(uk.z,ME,CE);return a}}],[{key:"type",get:function(){return"ViewportDepthNode"}}]),n}(ub);QC.DEPTH_BASE="depthBase",QC.DEPTH="depth",QC.LINEAR_DEPTH="linearDepth";var YC=function(e,t,n){return e.add(t).div(t.sub(n))},KC=function(e,t,n){return t.add(e).mul(n).div(n.sub(t).mul(e))},ZC=function(e,t,n){return t.mul(n).div(n.sub(t).mul(e).sub(n))},JC=function(e,t,n){t=t.max(1e-6).toVar();var r=vT(e.negate().div(t)),i=vT(n.div(t));return r.div(i)},$C=dx(QC,QC.DEPTH_BASE),eR=px(QC,QC.DEPTH),tR=dx(QC,QC.LINEAR_DEPTH).setParameterLength(0,1),nR=tR(XC());eR.assign=function(e){return $C(e)};var rR=dx(function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,"float")).name=e,r.isBuiltinNode=!0,r}return p(n,[{key:"generate",value:function(){return this.name}}]),n}(ub)).setParameterLength(1),iR=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.DEFAULT;return c(this,n),(e=t.call(this)).scope=r,e}return p(n,[{key:"setup",value:function(e){ht(m(n.prototype),"setup",this).call(this,e);var t=e.clippingContext,r=t.intersectionPlanes,i=t.unionPlanes;return this.hardwareClipping=e.material.hardwareClipping,this.scope===n.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(r,i):this.scope===n.HARDWARE?this.setupHardwareClipping(i,e):this.setupDefault(r,i)}},{key:"setupAlphaToCoverage",value:function(e,t){var n=this;return vx((function(){var r=xx().toVar("distanceToPlane"),i=xx().toVar("distanceToGradient"),a=xx(1).toVar("clipOpacity"),o=t.length;if(!1===n.hardwareClipping&&o>0){var s=EE(t);vC(o,(function(e){var t=e.i,n=s.element(t);r.assign(uk.dot(n.xyz).negate().add(n.w)),i.assign(r.fwidth().div(2)),a.mulAssign(uS(i.negate(),i,r))}))}var u=e.length;if(u>0){var l=EE(e),c=xx(1).toVar("intersectionClipOpacity");vC(u,(function(e){var t=e.i,n=l.element(t);r.assign(uk.dot(n.xyz).negate().add(n.w)),i.assign(r.fwidth().div(2)),c.mulAssign(uS(i.negate(),i,r).oneMinus())})),a.mulAssign(c.oneMinus())}nw.a.mulAssign(a),nw.a.equal(0).discard()}))()}},{key:"setupDefault",value:function(e,t){var n=this;return vx((function(){var r=t.length;if(!1===n.hardwareClipping&&r>0){var i=EE(t);vC(r,(function(e){var t=e.i,n=i.element(t);uk.dot(n.xyz).greaterThan(n.w).discard()}))}var a=e.length;if(a>0){var o=EE(e),s=Sx(!0).toVar("clipped");vC(a,(function(e){var t=e.i,n=o.element(t);s.assign(uk.dot(n.xyz).greaterThan(n.w).and(s))})),s.discard()}}))()}},{key:"setupHardwareClipping",value:function(e,t){var n=e.length;return t.enableHardwareClipping(n),vx((function(){var r=EE(e),i=rR(t.getClipDistance());vC(n,(function(e){var t=e.i,n=r.element(t),a=uk.dot(n.xyz).sub(n.w).negate();i.element(t).assign(a)}))}))()}}],[{key:"type",get:function(){return"ClippingNode"}}]),n}(ub);iR.ALPHA_TO_COVERAGE="alphaToCoverage",iR.DEFAULT="default",iR.HARDWARE="hardware";var aR=vx((function(e){var t=T(e,1)[0];return xT(Uw(1e4,wT(Uw(17,t.x).add(Uw(.1,t.y)))).mul(Dw(.1,CT(wT(Uw(13,t.y).add(t.x))))))})),oR=vx((function(e){var t=T(e,1)[0];return aR(Ex(aR(t.xy),t.z))})),sR=vx((function(e){var t=T(e,1)[0],n=GT(PT(LT(t.xyz)),PT(DT(t.xyz))),r=xx(1).div(xx(.05).mul(n)).toVar("pixScale"),i=Ex(pT(yT(vT(r))),pT(_T(vT(r)))),a=Ex(oR(yT(i.x.mul(t.xyz))),oR(yT(i.y.mul(t.xyz)))),o=xT(vT(r)),s=Dw(Uw(o.oneMinus(),a.x),Uw(o,a.y)),u=jT(o,o.oneMinus()),l=Rx(s.mul(s).div(Uw(2,u).mul(Ow(1,u))),s.sub(Uw(.5,u)).div(Ow(1,u)),Ow(1,Ow(1,s).mul(Ow(1,s)).div(Uw(2,u).mul(Ow(1,u))))),c=s.lessThan(u.oneMinus()).select(s.lessThan(u).select(l.x,l.y),l.z);return aS(c,1e-6,1)})).setLayout({name:"getAlphaHashThreshold",type:"float",inputs:[{name:"position",type:"vec3"}]}),uR=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this)).isNodeMaterial=!0,e.fog=!0,e.lights=!1,e.hardwareClipping=!1,e.lightsNode=null,e.envNode=null,e.aoNode=null,e.colorNode=null,e.normalNode=null,e.opacityNode=null,e.backdropNode=null,e.backdropAlphaNode=null,e.alphaTestNode=null,e.positionNode=null,e.geometryNode=null,e.depthNode=null,e.shadowPositionNode=null,e.receivedShadowNode=null,e.castShadowNode=null,e.outputNode=null,e.mrtNode=null,e.fragmentNode=null,e.vertexNode=null,e}return p(n,[{key:"type",get:function(){return this.constructor.type},set:function(e){}},{key:"customProgramCacheKey",value:function(){return this.type+q_(this)}},{key:"build",value:function(e){this.setup(e)}},{key:"setupObserver",value:function(e){return new U_(e)}},{key:"setup",value:function(e){var t=this;e.context.setupNormal=function(){return t.setupNormal(e)},e.context.setupPositionView=function(){return t.setupPositionView(e)},e.context.setupModelViewProjection=function(){return t.setupModelViewProjection(e)};var n=e.renderer,r=n.getRenderTarget();e.addStack();var i,a=this.vertexNode||this.setupVertex(e);e.stack.outputNode=a,this.setupHardwareClipping(e),null!==this.geometryNode&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();var o=this.setupClipping(e);if(!0!==this.depthWrite&&!0!==this.depthTest||(null!==r?!0===r.depthBuffer&&this.setupDepth(e):!0===n.depth&&this.setupDepth(e)),null===this.fragmentNode){this.setupDiffuseColor(e),this.setupVariants(e);var s=this.setupLighting(e);null!==o&&e.stack.add(o);var u=Lx(s,nw.a).max(0);i=this.setupOutput(e,u),_w.assign(i);var l=null!==this.outputNode;if(l&&(i=this.outputNode),null!==r){var c=n.getMRT(),h=this.mrtNode;null!==c?(l&&_w.assign(i),i=c,null!==h&&(i=c.merge(h))):null!==h&&(i=h)}}else{var f=this.fragmentNode;!0!==f.isOutputStructNode&&(f=Lx(f)),i=this.setupOutput(e,f)}e.stack.outputNode=i,e.addFlow("fragment",e.removeStack()),e.observer=this.setupObserver(e)}},{key:"setupClipping",value:function(e){if(null===e.clippingContext)return null;var t=e.clippingContext,n=t.unionPlanes,r=t.intersectionPlanes,i=null;if(n.length>0||r.length>0){var a=e.renderer.samples;this.alphaToCoverage&&a>1?i=cx(new iR(iR.ALPHA_TO_COVERAGE)):e.stack.add(cx(new iR))}return i}},{key:"setupHardwareClipping",value:function(e){if(this.hardwareClipping=!1,null!==e.clippingContext){var t=e.clippingContext.unionPlanes.length;t>0&&t<=8&&e.isAvailable("clipDistance")&&(e.stack.add(cx(new iR(iR.HARDWARE))),this.hardwareClipping=!0)}}},{key:"setupDepth",value:function(e){var t=e.renderer,n=e.camera,r=this.depthNode;if(null===r){var i=t.getMRT();i&&i.has("depth")?r=i.get("depth"):!0===t.logarithmicDepthBuffer&&(r=n.isPerspectiveCamera?JC(uk.z,ME,CE):YC(uk.z,ME,CE))}null!==r&&eR.assign(r).append()}},{key:"setupPositionView",value:function(){return $E.mul(ik).xyz}},{key:"setupModelViewProjection",value:function(){return RE.mul(uk)}},{key:"setupVertex",value:function(e){return e.addStack(),this.setupPosition(e),e.context.vertex=e.removeStack(),QM}},{key:"setupPosition",value:function(e){var t=e.object,n=e.geometry;if((n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color)&&TC(t).append(),!0===t.isSkinnedMesh&&pC(t).append(),this.displacementMap){var r=Bk("displacementMap","texture"),i=Bk("displacementScale","float"),a=Bk("displacementBias","float");ik.addAssign(dk.normalize().mul(r.x.mul(i).add(a)))}return t.isBatchedMesh&&sC(t).append(),t.isInstancedMesh&&t.instanceMatrix&&!0===t.instanceMatrix.isInstancedBufferAttribute&&aC(t).append(),null!==this.positionNode&&ik.assign(this.positionNode.context({isPositionNodeInput:!0})),ik}},{key:"setupDiffuseColor",value:function(e){var t=e.object,n=e.geometry,r=this.colorNode?Lx(this.colorNode):hM;(!0===this.vertexColors&&n.hasAttribute("color")&&(r=Lx(r.xyz.mul(dE("color","vec3")),r.a)),t.instanceColor)&&(r=tw("vec3","vInstanceColor").mul(r));t.isBatchedMesh&&t._colorsTexture&&(r=tw("vec3","vBatchColor").mul(r));nw.assign(r);var i=this.opacityNode?xx(this.opacityNode):pM;if(nw.a.assign(nw.a.mul(i)),null!==this.alphaTestNode||this.alphaTest>0){var a=null!==this.alphaTestNode?xx(this.alphaTestNode):cM;nw.a.lessThanEqual(a).discard()}!0===this.alphaHash&&nw.a.lessThan(sR(ik)).discard(),!1===this.transparent&&1===this.blending&&!1===this.alphaToCoverage&&nw.a.assign(1)}},{key:"setupVariants",value:function(){}},{key:"setupOutgoingLight",value:function(){return!0===this.lights?Rx(0):nw.rgb}},{key:"setupNormal",value:function(){return this.normalNode?Rx(this.normalNode):xM}},{key:"setupEnvironment",value:function(){var e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?Bk("envMap","cubeTexture"):Bk("envMap","texture")),e}},{key:"setupLightMap",value:function(e){var t=null;return e.material.lightMap&&(t=new CC(HM)),t}},{key:"setupLights",value:function(e){var t=[],n=this.setupEnvironment(e);n&&n.isLightingNode&&t.push(n);var r=this.setupLightMap(e);if(r&&r.isLightingNode&&t.push(r),null!==this.aoNode||e.material.aoMap){var i=null!==this.aoNode?this.aoNode:WM;t.push(new EC(i))}var a=this.lightsNode||e.lightsNode;return t.length>0&&(a=e.renderer.lighting.createNode([].concat(l(a.getLights()),t))),a}},{key:"setupLightingModel",value:function(){}},{key:"setupLighting",value:function(e){var t=e.material,n=this.backdropNode,r=this.backdropAlphaNode,i=this.emissiveNode,a=!0===this.lights||null!==this.lightsNode?this.setupLights(e):null,o=this.setupOutgoingLight(e);if(a&&a.getScope().hasLights){var s=this.setupLightingModel(e)||null;o=MC(a,s,n,r)}else null!==n&&(o=Rx(null!==r?iS(o,n,r):n));return(i&&!0===i.isNode||t.emissive&&!0===t.emissive.isColor)&&(rw.assign(Rx(i||dM)),o=o.add(rw)),o}},{key:"setupFog",value:function(e,t){var n=e.fogNode;return n&&(_w.assign(t),t=Lx(n)),t}},{key:"setupOutput",value:function(e,t){return!0===this.fog&&(t=this.setupFog(e,t)),t}},{key:"setDefaultValues",value:function(e){for(var t in e){var n=e[t];void 0===this[t]&&(this[t]=n,n&&n.clone&&(this[t]=n.clone()))}var r=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(var i in r)void 0===Object.getOwnPropertyDescriptor(this.constructor.prototype,i)&&void 0!==r[i].get&&Object.defineProperty(this.constructor.prototype,i,r[i])}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{},nodes:{}});var n=ba.prototype.toJSON.call(this,e),r=j_(this);n.inputNodes={};var i,a=k(r);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=o.property,u=o.childNode;n.inputNodes[s]=u.toJSON(e).uuid}}catch(d){a.e(d)}finally{a.f()}function l(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(t){var c=l(e.textures),h=l(e.images),f=l(e.nodes);c.length>0&&(n.textures=c),h.length>0&&(n.images=h),f.length>0&&(n.nodes=f)}return n}},{key:"copy",value:function(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.shadowPositionNode=e.shadowPositionNode,this.receivedShadowNode=e.receivedShadowNode,this.castShadowNode=e.castShadowNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,ht(m(n.prototype),"copy",this).call(this,e)}}],[{key:"type",get:function(){return"NodeMaterial"}}]),n}(ba),lR=new Do,cR=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isLineBasicNodeMaterial=!0,r.setDefaultValues(lR),r.setValues(e),r}return p(n,null,[{key:"type",get:function(){return"LineBasicNodeMaterial"}}]),n}(uR),hR=new xu,fR=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isLineDashedNodeMaterial=!0,r.setDefaultValues(hR),r.dashOffset=0,r.offsetNode=null,r.dashScaleNode=null,r.dashSizeNode=null,r.gapSizeNode=null,r.setValues(e),r}return p(n,[{key:"setupVariants",value:function(){var e=this.offsetNode?xx(this.offsetNode):qM,t=this.dashScaleNode?xx(this.dashScaleNode):BM,n=this.dashSizeNode?xx(this.dashSizeNode):FM,r=this.gapSizeNode?xx(this.gapSizeNode):zM;bw.assign(n),xw.assign(r);var i=MS(dE("lineDistance").mul(t));(e?i.add(e):i).mod(bw.add(xw)).greaterThan(bw).discard()}}],[{key:"type",get:function(){return"LineDashedNodeMaterial"}}]),n}(uR),dR=null,pR=function(e){v(n,e);var t=b(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:PC,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),null===dR&&(dR=new ts),t.call(this,e,r,dR)}return p(n,[{key:"updateReference",value:function(){return this}}],[{key:"type",get:function(){return"ViewportSharedTextureNode"}}]),n}(qC),AR=dx(pR).setParameterLength(0,2),vR=function(e){return cx(e).mul(.5).add(.5)},mR=new mu,gR=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshNormalNodeMaterial=!0,r.setDefaultValues(mR),r.setValues(e),r}return p(n,[{key:"setupDiffuseColor",value:function(){var e=this.opacityNode?xx(this.opacityNode):pM;nw.assign(BS(Lx(vR(mk),e),Kn))}}],[{key:"type",get:function(){return"MeshNormalNodeMaterial"}}]),n}(uR),yR=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:sk;return c(this,n),(e=t.call(this,"vec2")).dirNode=r,e}return p(n,[{key:"setup",value:function(){var e=this.dirNode,t=e.z.atan(e.x).mul(1/(2*Math.PI)).add(.5),n=e.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return Ex(t,n)}}],[{key:"type",get:function(){return"EquirectUVNode"}}]),n}(hb),_R=dx(yR).setParameterLength(0,1),bR=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c(this,n),(e=t.call(this,r,i)).isCubeRenderTarget=!0,e}return p(n,[{key:"fromEquirectangularTexture",value:function(e,t){var n=t.minFilter,r=t.generateMipmaps;t.generateMipmaps=!0,this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var i=new no(5,5,5),a=_R(sk),o=new uR;o.colorNode=_E(t,a,0),o.side=1,o.blending=0;var s=new eo(i,o),u=new bo;u.add(s),t.minFilter===Ft&&(t.minFilter=Ut);var l=new Ao(1,10,this),c=e.getMRT();return e.setMRT(null),l.update(e,u),e.setMRT(c),t.minFilter=n,t.currentGenerateMipmaps=r,s.geometry.dispose(),s.material.dispose(),this}}]),n}(mo),xR=new WeakMap;function wR(e){var t=e.target;t.removeEventListener("dispose",wR);var n=xR.get(t);void 0!==n&&(xR.delete(t),n.dispose())}function TR(e,t){t===Mt?e.mapping=Et:t===Ct&&(e.mapping=kt)}var SR=dx(function(e){v(n,e);var t=b(n);function n(e){var r;c(this,n),(r=t.call(this,"vec3")).envNode=e,r._cubeTexture=null,r._cubeTextureNode=Nk(null);var i=new vo;return i.isRenderTargetTexture=!0,r._defaultTexture=i,r.updateBeforeType=tb.RENDER,r}return p(n,[{key:"updateBefore",value:function(e){var t=e.renderer,n=e.material,r=this.envNode;if(r.isTextureNode||r.isMaterialReferenceNode){var i=r.isTextureNode?r.value:n[r.property];if(i&&i.isTexture){var a=i.mapping;if(a===Mt||a===Ct){if(xR.has(i)){var o=xR.get(i);TR(o,i.mapping),this._cubeTexture=o}else{var s=i.image;if(function(e){return null!==e&&void 0!==e&&e.height>0}(s)){var u=new bR(s.height);u.fromEquirectangularTexture(t,i),TR(u.texture,i.mapping),this._cubeTexture=u.texture,xR.set(i,u.texture),i.addEventListener("dispose",wR)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}},{key:"setup",value:function(e){return this.updateBefore(e),this._cubeTextureNode}}],[{key:"type",get:function(){return"CubeMapNode"}}]),n}(hb)).setParameterLength(1),ER=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return c(this,n),(e=t.call(this)).envNode=r,e}return p(n,[{key:"setup",value:function(e){e.context.environment=SR(this.envNode)}}],[{key:"type",get:function(){return"BasicEnvironmentNode"}}]),n}(SC),kR=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return c(this,n),(e=t.call(this)).lightMapNode=r,e}return p(n,[{key:"setup",value:function(e){var t=xx(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(t)}}],[{key:"type",get:function(){return"BasicLightMapNode"}}]),n}(SC),MR=function(){function e(){c(this,e)}return p(e,[{key:"start",value:function(e){e.lightsNode.setupLights(e,e.lightsNode.getLightNodes(e)),this.indirect(e)}},{key:"finish",value:function(){}},{key:"direct",value:function(){}},{key:"directRectArea",value:function(){}},{key:"indirect",value:function(){}},{key:"ambientOcclusion",value:function(){}}]),e}(),CR=function(e){v(n,e);var t=b(n);function n(){return c(this,n),t.call(this)}return p(n,[{key:"indirect",value:function(e){var t=e.context,n=t.ambientOcclusion,r=t.reflectedLight,i=t.irradianceLightMap;r.indirectDiffuse.assign(Lx(0)),i?r.indirectDiffuse.addAssign(i):r.indirectDiffuse.addAssign(Lx(1,1,1,0)),r.indirectDiffuse.mulAssign(n),r.indirectDiffuse.mulAssign(nw.rgb)}},{key:"finish",value:function(e){var t=e.material,n=e.context.outgoingLight,r=e.context.environment;if(r)switch(t.combine){case 0:n.rgb.assign(iS(n.rgb,n.rgb.mul(r.rgb),gM.mul(yM)));break;case 1:n.rgb.assign(iS(n.rgb,r.rgb,gM.mul(yM)));break;case 2:n.rgb.addAssign(r.rgb.mul(gM.mul(yM)));break;default:console.warn("THREE.BasicLightingModel: Unsupported .combine value:",t.combine)}}}]),n}(MR),RR=new xa,PR=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshBasicNodeMaterial=!0,r.lights=!0,r.setDefaultValues(RR),r.setValues(e),r}return p(n,[{key:"setupNormal",value:function(){return Ak}},{key:"setupEnvironment",value:function(e){var t=ht(m(n.prototype),"setupEnvironment",this).call(this,e);return t?new ER(t):null}},{key:"setupLightMap",value:function(e){var t=null;return e.material.lightMap&&(t=new kR(HM)),t}},{key:"setupOutgoingLight",value:function(){return nw.rgb}},{key:"setupLightingModel",value:function(){return new CR}}],[{key:"type",get:function(){return"MeshBasicNodeMaterial"}}]),n}(uR),NR=vx((function(e){var t=e.f0,n=e.f90,r=e.dotVH,i=r.mul(-5.55473).sub(6.98316).mul(r).exp2();return t.mul(i.oneMinus()).add(n.mul(i))})),IR=vx((function(e){return e.diffuseColor.mul(1/Math.PI)})),LR=vx((function(e){var t=e.dotNH;return yw.mul(xx(.5)).add(1).mul(xx(1/Math.PI)).mul(t.pow(yw))})),DR=vx((function(e){var t=e.lightDirection.add(lk).normalize(),n=mk.dot(t).clamp(),r=lk.dot(t).clamp(),i=NR({f0:mw,f90:1,dotVH:r}),a=xx(.25),o=LR({dotNH:n});return i.mul(a).mul(o)})),OR=function(e){v(n,e);var t=b(n);function n(){var e,r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return c(this,n),(e=t.call(this)).specular=r,e}return p(n,[{key:"direct",value:function(e){var t=e.lightDirection,n=e.lightColor,r=e.reflectedLight,i=mk.dot(t).clamp().mul(n);r.directDiffuse.addAssign(i.mul(IR({diffuseColor:nw.rgb}))),!0===this.specular&&r.directSpecular.addAssign(i.mul(DR({lightDirection:t})).mul(gM))}},{key:"indirect",value:function(e){var t=e.context,n=t.ambientOcclusion,r=t.irradiance,i=t.reflectedLight;i.indirectDiffuse.addAssign(r.mul(IR({diffuseColor:nw}))),i.indirectDiffuse.mulAssign(n)}}]),n}(CR),UR=new gu,BR=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshLambertNodeMaterial=!0,r.lights=!0,r.setDefaultValues(UR),r.setValues(e),r}return p(n,[{key:"setupEnvironment",value:function(e){var t=ht(m(n.prototype),"setupEnvironment",this).call(this,e);return t?new ER(t):null}},{key:"setupLightingModel",value:function(){return new OR(!1)}}],[{key:"type",get:function(){return"MeshLambertNodeMaterial"}}]),n}(uR),FR=new Au,zR=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshPhongNodeMaterial=!0,r.lights=!0,r.shininessNode=null,r.specularNode=null,r.setDefaultValues(FR),r.setValues(e),r}return p(n,[{key:"setupEnvironment",value:function(e){var t=ht(m(n.prototype),"setupEnvironment",this).call(this,e);return t?new ER(t):null}},{key:"setupLightingModel",value:function(){return new OR}},{key:"setupVariants",value:function(){var e=(this.shininessNode?xx(this.shininessNode):fM).max(1e-4);yw.assign(e);var t=this.specularNode||AM;mw.assign(t)}},{key:"copy",value:function(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,ht(m(n.prototype),"copy",this).call(this,e)}}],[{key:"type",get:function(){return"MeshPhongNodeMaterial"}}]),n}(uR),VR=vx((function(e){if(!1===e.geometry.hasAttribute("normal"))return xx(0);var t=Ak.dFdx().abs().max(Ak.dFdy().abs());return t.x.max(t.y).max(t.z)})),qR=vx((function(e){var t=e.roughness,n=VR(),r=t.max(.0525);return r=(r=r.add(n)).min(1)})),jR=vx((function(e){var t=e.alpha,n=e.dotNL,r=e.dotNV,i=t.pow2(),a=n.mul(i.add(i.oneMinus().mul(r.pow2())).sqrt()),o=r.mul(i.add(i.oneMinus().mul(n.pow2())).sqrt());return Bw(.5,a.add(o).max(aT))})).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),GR=vx((function(e){var t=e.alphaT,n=e.alphaB,r=e.dotTV,i=e.dotBV,a=e.dotTL,o=e.dotBL,s=e.dotNV,u=e.dotNL,l=u.mul(Rx(t.mul(r),n.mul(i),s).length()),c=s.mul(Rx(t.mul(a),n.mul(o),u).length());return Bw(.5,l.add(c)).saturate()})).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),HR=vx((function(e){var t=e.alpha,n=e.dotNH,r=t.pow2(),i=n.pow2().mul(r.oneMinus()).oneMinus();return r.div(i.pow2()).mul(1/Math.PI)})).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),WR=xx(1/Math.PI),XR=vx((function(e){var t=e.alphaT,n=e.alphaB,r=e.dotNH,i=e.dotTH,a=e.dotBH,o=t.mul(n),s=Rx(n.mul(i),t.mul(a),o.mul(r)),u=s.dot(s),l=o.div(u);return WR.mul(o.mul(l.pow2()))})).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),QR=vx((function(e){var t,n,r=e.lightDirection,i=e.f0,a=e.f90,o=e.roughness,s=e.f,u=e.USE_IRIDESCENCE,l=e.USE_ANISOTROPY,c=e.normalView||mk,h=o.pow2(),f=r.add(lk).normalize(),d=c.dot(r).clamp(),p=c.dot(lk).clamp(),A=c.dot(f).clamp(),v=lk.dot(f).clamp(),m=NR({f0:i,f90:a,dotVH:v});if(sx(u)&&(m=cw.mix(m,s)),sx(l)){var g=Aw.dot(r),y=Aw.dot(lk),_=Aw.dot(f),b=vw.dot(r),x=vw.dot(lk),w=vw.dot(f);t=GR({alphaT:dw,alphaB:h,dotTV:y,dotBV:x,dotTL:g,dotBL:b,dotNV:p,dotNL:d}),n=XR({alphaT:dw,alphaB:h,dotNH:A,dotTH:_,dotBH:w})}else t=jR({alpha:h,dotNL:d,dotNV:p}),n=HR({alpha:h,dotNH:A});return m.mul(t).mul(n)})),YR=vx((function(e){var t=e.roughness,n=e.dotNV,r=Lx(-1,-.0275,-.572,.022),i=Lx(1,.0425,1.04,-.04),a=t.mul(r).add(i),o=a.x.mul(a.x).min(n.mul(-9.28).exp2()).mul(a.x).add(a.y);return Ex(-1.04,1.04).mul(o).add(a.zw)})).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),KR=vx((function(e){var t=e.dotNV,n=e.specularColor,r=e.specularF90,i=e.roughness,a=YR({dotNV:t,roughness:i});return n.mul(a.x).add(r.mul(a.y))})),ZR=vx((function(e){var t=e.f,n=e.f90,r=e.dotVH.oneMinus().saturate(),i=r.mul(r),a=r.mul(i,i).clamp(0,.9999);return t.sub(Rx(n).mul(a)).div(a.oneMinus())})).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),JR=vx((function(e){var t=e.roughness,n=e.dotNH,r=t.pow2(),i=xx(1).div(r),a=n.pow2().oneMinus().max(.0078125);return xx(2).add(i).mul(a.pow(i.mul(.5))).div(2*Math.PI)})).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),$R=vx((function(e){var t=e.dotNV,n=e.dotNL;return xx(1).div(xx(4).mul(n.add(t).sub(n.mul(t))))})).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),eP=vx((function(e){var t=e.lightDirection,n=t.add(lk).normalize(),r=mk.dot(t).clamp(),i=mk.dot(lk).clamp(),a=mk.dot(n).clamp(),o=JR({roughness:lw,dotNH:a}),s=$R({dotNV:i,dotNL:r});return uw.mul(o).mul(s)})),tP=vx((function(e){var t=e.N,n=e.V,r=e.roughness,i=t.dot(n).saturate(),a=Ex(r,i.oneMinus().sqrt());return a.assign(a.mul(.984375).add(.0078125)),a})).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),nP=vx((function(e){var t=e.f,n=t.length();return GT(n.mul(n).add(t.z).div(n.add(1)),0)})).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),rP=vx((function(e){var t=e.v1,n=e.v2,r=t.dot(n),i=r.abs().toVar(),a=i.mul(.0145206).add(.4965155).mul(i).add(.8543985).toVar(),o=i.add(4.1616724).mul(i).add(3.417594).toVar(),s=a.div(o),u=r.greaterThan(0).select(s,GT(r.mul(r).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(s));return t.cross(n).mul(u)})).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),iP=vx((function(e){var t=e.N,n=e.V,r=e.P,i=e.mInv,a=e.p0,o=e.p1,s=e.p2,u=e.p3,l=o.sub(a).toVar(),c=u.sub(a).toVar(),h=l.cross(c),f=Rx().toVar();return yx(h.dot(r.sub(a)).greaterThanEqual(0),(function(){var e=n.sub(t.mul(n.dot(t))).normalize(),l=t.cross(e).negate(),c=i.mul(Fx(e,l,t).transpose()).toVar(),h=c.mul(a.sub(r)).normalize().toVar(),d=c.mul(o.sub(r)).normalize().toVar(),p=c.mul(s.sub(r)).normalize().toVar(),A=c.mul(u.sub(r)).normalize().toVar(),v=Rx(0).toVar();v.addAssign(rP({v1:h,v2:d})),v.addAssign(rP({v1:d,v2:p})),v.addAssign(rP({v1:p,v2:A})),v.addAssign(rP({v1:A,v2:h})),f.assign(Rx(nP({f:v})))})),f})).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),aP=1/6,oP=function(e){return Uw(aP,Uw(e,Uw(e,e.negate().add(3)).sub(3)).add(1))},sP=function(e){return Uw(aP,Uw(e,Uw(e,Uw(3,e).sub(6))).add(4))},uP=function(e){return Uw(aP,Uw(e,Uw(e,Uw(-3,e).add(3)).add(3)).add(1))},lP=function(e){return Uw(aP,ZT(e,3))},cP=function(e){return oP(e).add(sP(e))},hP=function(e){return uP(e).add(lP(e))},fP=function(e){return Dw(-1,sP(e).div(oP(e).add(sP(e))))},dP=function(e){return Dw(1,lP(e).div(uP(e).add(lP(e))))},pP=function(e,t,n){var r=e.uvNode,i=Uw(r,t.zw).add(.5),a=yT(i),o=xT(i),s=cP(o.x),u=hP(o.x),l=fP(o.x),c=dP(o.x),h=fP(o.y),f=dP(o.y),d=Ex(a.x.add(l),a.y.add(h)).sub(.5).mul(t.xy),p=Ex(a.x.add(c),a.y.add(h)).sub(.5).mul(t.xy),A=Ex(a.x.add(l),a.y.add(f)).sub(.5).mul(t.xy),v=Ex(a.x.add(c),a.y.add(f)).sub(.5).mul(t.xy),m=cP(o.y).mul(Dw(s.mul(e.sample(d).level(n)),u.mul(e.sample(p).level(n)))),g=hP(o.y).mul(Dw(s.mul(e.sample(A).level(n)),u.mul(e.sample(v).level(n))));return m.add(g)},AP=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=void 0===r?xx(3):r,a=Ex(n.size(wx(i))),o=Ex(n.size(wx(i.add(1)))),s=Bw(1,a),u=Bw(1,o),l=pP(n,Lx(s,a),yT(i)),c=pP(n,Lx(u,o),_T(i));return xT(i).mix(l,c)})),vP=vx((function(e){var t=T(e,5),n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=Rx(sS(r.negate(),bT(n),Bw(1,a))),u=Rx(PT(o[0].xyz),PT(o[1].xyz),PT(o[2].xyz));return bT(s).mul(i.mul(u))})).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),mP=vx((function(e){var t=T(e,2),n=t[0],r=t[1];return n.mul(aS(r.mul(2).sub(2),0,1))})).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),gP=GC(),yP=GC(),_P=vx((function(e,t){var n=T(e,3),r=n[0],i=n[1],a=n[2],o=(1===t.material.side?gP:yP).sample(r),s=vT(NC.x).mul(mP(i,a));return AP(o,s)})),bP=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2];return yx(i.notEqual(0),(function(){var e=AT(r).negate().div(i);return dT(e.negate().mul(n))})),Rx(1)})).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),xP=vx((function(e){var t,n,r=T(e,15),i=r[0],a=r[1],o=r[2],s=r[3],u=r[4],l=r[5],c=r[6],h=r[7],f=r[8],d=r[9],p=r[10],A=r[11],v=r[12],m=r[13],g=r[14];if(g){t=Lx().toVar(),n=Rx().toVar();var y=p.sub(1).mul(g.mul(.025)),_=Rx(p.sub(y),p,p.add(y));vC({start:0,end:3},(function(e){var r=e.i,u=_.element(r),l=vP(i,a,A,u,h),p=c.add(l),g=d.mul(f.mul(Lx(p,1))),y=Ex(g.xy.div(g.w)).toVar();y.addAssign(1),y.divAssign(2),y.assign(Ex(y.x,y.y.oneMinus()));var b=_P(y,o,u);t.element(r).assign(b.element(r)),t.a.addAssign(b.a),n.element(r).assign(s.element(r).mul(bP(PT(l),v,m).element(r)))})),t.a.divAssign(3)}else{var b=vP(i,a,A,p,h),x=c.add(b),w=d.mul(f.mul(Lx(x,1))),S=Ex(w.xy.div(w.w)).toVar();S.addAssign(1),S.divAssign(2),S.assign(Ex(S.x,S.y.oneMinus())),t=_P(S,o,p),n=s.mul(bP(PT(b),v,m))}var E=n.rgb.mul(t.rgb),k=i.dot(a).clamp(),M=Rx(KR({dotNV:k,specularColor:u,specularF90:l,roughness:o})),C=n.r.add(n.g,n.b).div(3);return Lx(M.oneMinus().mul(E),t.a.oneMinus().mul(C).oneMinus())})),wP=Fx(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),TP=function(e,t){return e.sub(t).div(e.add(t)).pow2()},SP=vx((function(e){var t=e.outsideIOR,n=e.eta2,r=e.cosTheta1,i=e.thinFilmThickness,a=e.baseF0,o=iS(t,n,uS(0,.03,i)),s=t.div(o).pow2().mul(r.pow2().oneMinus()).oneMinus();yx(s.lessThan(0),(function(){return Rx(1)}));var u=s.sqrt(),l=TP(o,t),c=NR({f0:l,f90:1,dotVH:r}),h=c.oneMinus(),f=o.lessThan(t).select(Math.PI,0),d=xx(Math.PI).sub(f),p=function(e){var t=e.sqrt();return Rx(1).add(t).div(Rx(1).sub(t))}(a.clamp(0,.9999)),A=TP(p,o.toVec3()),v=NR({f0:A,f90:1,dotVH:u}),m=Rx(p.x.lessThan(o).select(Math.PI,0),p.y.lessThan(o).select(Math.PI,0),p.z.lessThan(o).select(Math.PI,0)),g=o.mul(i,u,2),y=Rx(d).add(m),_=c.mul(v).clamp(1e-5,.9999),b=_.sqrt(),x=h.pow2().mul(v).div(Rx(1).sub(_)),w=c.add(x).toVar(),T=x.sub(h).toVar();return vC({start:1,end:2,condition:"<=",name:"m"},(function(e){var t=e.m;T.mulAssign(b);var n=function(e,t){var n=e.mul(2*Math.PI*1e-9),r=Rx(54856e-17,44201e-17,52481e-17),i=Rx(1681e3,1795300,2208400),a=Rx(43278e5,93046e5,66121e5),o=xx(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(n.mul(2239900).add(t.x).cos()).mul(n.pow2().mul(-45282e5).exp()),s=r.mul(a.mul(2*Math.PI).sqrt()).mul(i.mul(n).add(t).cos()).mul(n.pow2().negate().mul(a).exp());return s=Rx(s.x.add(o),s.y,s.z).div(1.0685e-7),wP.mul(s)}(xx(t).mul(g),xx(t).mul(y)).mul(2);w.addAssign(T.mul(n))})),w.max(Rx(0))})).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),EP=vx((function(e){var t=e.normal,n=e.viewDir,r=e.roughness,i=t.dot(n).saturate(),a=r.pow2(),o=mS(r.lessThan(.25),xx(-339.2).mul(a).add(xx(161.4).mul(r)).sub(25.9),xx(-8.48).mul(a).add(xx(14.3).mul(r)).sub(9.95)),s=mS(r.lessThan(.25),xx(44).mul(a).sub(xx(23.7).mul(r)).add(3.26),xx(1.97).mul(a).sub(xx(3.27).mul(r)).add(.72));return mS(r.lessThan(.25),0,xx(.1).mul(r).sub(.025)).add(o.mul(i).add(s).exp()).mul(1/Math.PI).saturate()})),kP=Rx(.04),MP=xx(1),CP=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return c(this,n),(e=t.call(this)).clearcoat=r,e.sheen=i,e.iridescence=a,e.anisotropy=o,e.transmission=s,e.dispersion=u,e.clearcoatRadiance=null,e.clearcoatSpecularDirect=null,e.clearcoatSpecularIndirect=null,e.sheenSpecularDirect=null,e.sheenSpecularIndirect=null,e.iridescenceFresnel=null,e.iridescenceF0=null,e}return p(n,[{key:"start",value:function(e){if(!0===this.clearcoat&&(this.clearcoatRadiance=Rx().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=Rx().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=Rx().toVar("clearcoatSpecularIndirect")),!0===this.sheen&&(this.sheenSpecularDirect=Rx().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=Rx().toVar("sheenSpecularIndirect")),!0===this.iridescence){var t=mk.dot(lk).clamp();this.iridescenceFresnel=SP({outsideIOR:xx(1),eta2:hw,cosTheta1:t,thinFilmThickness:fw,baseF0:mw}),this.iridescenceF0=ZR({f:this.iridescenceFresnel,f90:1,dotVH:t})}if(!0===this.transmission){var r=ok,i=DE.sub(ok).normalize(),a=gk,o=e.context;o.backdrop=xP(a,i,iw,nw,mw,gw,r,WE,NE,RE,Tw,Ew,Mw,kw,this.dispersion?Cw:null),o.backdropAlpha=Sw,nw.a.mulAssign(iS(1,o.backdrop.a,Sw))}ht(m(n.prototype),"start",this).call(this,e)}},{key:"computeMultiscattering",value:function(e,t,n){var r=mk.dot(lk).clamp(),i=YR({roughness:iw,dotNV:r}),a=(this.iridescenceF0?cw.mix(mw,this.iridescenceF0):mw).mul(i.x).add(n.mul(i.y)),o=i.x.add(i.y).oneMinus(),s=mw.add(mw.oneMinus().mul(.047619)),u=a.mul(s).div(o.mul(s).oneMinus());e.addAssign(a),t.addAssign(u.mul(o))}},{key:"direct",value:function(e){var t=e.lightDirection,n=e.lightColor,r=e.reflectedLight,i=mk.dot(t).clamp().mul(n);if(!0===this.sheen&&this.sheenSpecularDirect.addAssign(i.mul(eP({lightDirection:t}))),!0===this.clearcoat){var a=yk.dot(t).clamp().mul(n);this.clearcoatSpecularDirect.addAssign(a.mul(QR({lightDirection:t,f0:kP,f90:MP,roughness:sw,normalView:yk})))}r.directDiffuse.addAssign(i.mul(IR({diffuseColor:nw.rgb}))),r.directSpecular.addAssign(i.mul(QR({lightDirection:t,f0:mw,f90:1,roughness:iw,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}},{key:"directRectArea",value:function(e){var t=e.lightColor,n=e.lightPosition,r=e.halfWidth,i=e.halfHeight,a=e.reflectedLight,o=e.ltc_1,s=e.ltc_2,u=n.add(r).sub(i),l=n.sub(r).sub(i),c=n.sub(r).add(i),h=n.add(r).add(i),f=mk,d=lk,p=uk.toVar(),A=tP({N:f,V:d,roughness:iw}),v=o.sample(A).toVar(),m=s.sample(A).toVar(),g=Fx(Rx(v.x,0,v.y),Rx(0,1,0),Rx(v.z,0,v.w)).toVar(),y=mw.mul(m.x).add(mw.oneMinus().mul(m.y)).toVar();a.directSpecular.addAssign(t.mul(y).mul(iP({N:f,V:d,P:p,mInv:g,p0:u,p1:l,p2:c,p3:h}))),a.directDiffuse.addAssign(t.mul(nw).mul(iP({N:f,V:d,P:p,mInv:Fx(1,0,0,0,1,0,0,0,1),p0:u,p1:l,p2:c,p3:h})))}},{key:"indirect",value:function(e){this.indirectDiffuse(e),this.indirectSpecular(e),this.ambientOcclusion(e)}},{key:"indirectDiffuse",value:function(e){var t=e.context,n=t.irradiance;t.reflectedLight.indirectDiffuse.addAssign(n.mul(IR({diffuseColor:nw})))}},{key:"indirectSpecular",value:function(e){var t=e.context,n=t.radiance,r=t.iblIrradiance,i=t.reflectedLight;if(!0===this.sheen&&this.sheenSpecularIndirect.addAssign(r.mul(uw,EP({normal:mk,viewDir:lk,roughness:lw}))),!0===this.clearcoat){var a=yk.dot(lk).clamp(),o=KR({dotNV:a,specularColor:kP,specularF90:MP,roughness:sw});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(o))}var s=Rx().toVar("singleScattering"),u=Rx().toVar("multiScattering"),l=r.mul(1/Math.PI);this.computeMultiscattering(s,u,gw);var c=s.add(u),h=nw.mul(c.r.max(c.g).max(c.b).oneMinus());i.indirectSpecular.addAssign(n.mul(s)),i.indirectSpecular.addAssign(u.mul(l)),i.indirectDiffuse.addAssign(h.mul(l))}},{key:"ambientOcclusion",value:function(e){var t=e.context,n=t.ambientOcclusion,r=t.reflectedLight,i=mk.dot(lk).clamp().add(n),a=iw.mul(-16).oneMinus().negate().exp2(),o=n.sub(i.pow(a).oneMinus()).clamp();!0===this.clearcoat&&this.clearcoatSpecularIndirect.mulAssign(n),!0===this.sheen&&this.sheenSpecularIndirect.mulAssign(n),r.indirectDiffuse.mulAssign(n),r.indirectSpecular.mulAssign(o)}},{key:"finish",value:function(e){var t=e.context.outgoingLight;if(!0===this.clearcoat){var n=yk.dot(lk).clamp(),r=NR({dotVH:n,f0:kP,f90:MP}),i=t.mul(ow.mul(r).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(ow));t.assign(i)}if(!0===this.sheen){var a=uw.r.max(uw.g).max(uw.b).mul(.157).oneMinus(),o=t.mul(a).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);t.assign(o)}}}]),n}(MR),RP=xx(1),PP=xx(-2),NP=xx(.8),IP=xx(-1),LP=xx(.4),DP=xx(2),OP=xx(.305),UP=xx(3),BP=xx(.21),FP=xx(4),zP=xx(4),VP=xx(16),qP=vx((function(e){var t=T(e,1)[0],n=Rx(CT(t)).toVar(),r=xx(-1).toVar();return yx(n.x.greaterThan(n.z),(function(){yx(n.x.greaterThan(n.y),(function(){r.assign(mS(t.x.greaterThan(0),0,3))})).Else((function(){r.assign(mS(t.y.greaterThan(0),1,4))}))})).Else((function(){yx(n.z.greaterThan(n.y),(function(){r.assign(mS(t.z.greaterThan(0),2,5))})).Else((function(){r.assign(mS(t.y.greaterThan(0),1,4))}))})),r})).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),jP=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=Ex().toVar();return yx(r.equal(0),(function(){i.assign(Ex(n.z,n.y).div(CT(n.x)))})).ElseIf(r.equal(1),(function(){i.assign(Ex(n.x.negate(),n.z.negate()).div(CT(n.y)))})).ElseIf(r.equal(2),(function(){i.assign(Ex(n.x.negate(),n.y).div(CT(n.z)))})).ElseIf(r.equal(3),(function(){i.assign(Ex(n.z.negate(),n.y).div(CT(n.x)))})).ElseIf(r.equal(4),(function(){i.assign(Ex(n.x.negate(),n.z).div(CT(n.y)))})).Else((function(){i.assign(Ex(n.x,n.y).div(CT(n.z)))})),Uw(.5,i.add(1))})).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),GP=vx((function(e){var t=T(e,1)[0],n=xx(0).toVar();return yx(t.greaterThanEqual(NP),(function(){n.assign(RP.sub(t).mul(IP.sub(PP)).div(RP.sub(NP)).add(PP))})).ElseIf(t.greaterThanEqual(LP),(function(){n.assign(NP.sub(t).mul(DP.sub(IP)).div(NP.sub(LP)).add(IP))})).ElseIf(t.greaterThanEqual(OP),(function(){n.assign(LP.sub(t).mul(UP.sub(DP)).div(LP.sub(OP)).add(DP))})).ElseIf(t.greaterThanEqual(BP),(function(){n.assign(OP.sub(t).mul(FP.sub(UP)).div(OP.sub(BP)).add(UP))})).Else((function(){n.assign(xx(-2).mul(vT(Uw(1.16,t))))})),n})).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),HP=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=n.toVar();i.assign(Uw(2,i).sub(1));var a=Rx(i,1).toVar();return yx(r.equal(0),(function(){a.assign(a.zyx)})).ElseIf(r.equal(1),(function(){a.assign(a.xzy),a.xz.mulAssign(-1)})).ElseIf(r.equal(2),(function(){a.x.mulAssign(-1)})).ElseIf(r.equal(3),(function(){a.assign(a.zyx),a.xz.mulAssign(-1)})).ElseIf(r.equal(4),(function(){a.assign(a.xzy),a.xy.mulAssign(-1)})).ElseIf(r.equal(5),(function(){a.z.mulAssign(-1)})),a})).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),WP=vx((function(e){var t=T(e,6),n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=xx(i),l=Rx(r),c=aS(GP(u),PP,s),h=xT(c),f=yT(c),d=Rx(XP(n,l,f,a,o,s)).toVar();return yx(h.notEqual(0),(function(){var e=Rx(XP(n,l,f.add(1),a,o,s)).toVar();d.assign(iS(d,e,h))})),d})),XP=vx((function(e){var t=T(e,6),n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=xx(i).toVar(),l=Rx(r),c=xx(qP(l)).toVar(),h=xx(GT(zP.sub(u),0)).toVar();u.assign(GT(u,zP));var f=xx(pT(u)).toVar(),d=Ex(jP(l,c).mul(f.sub(2)).add(1)).toVar();return yx(c.greaterThan(2),(function(){d.y.addAssign(f),c.subAssign(3)})),d.x.addAssign(c.mul(f)),d.x.addAssign(h.mul(Uw(3,VP))),d.y.addAssign(Uw(4,pT(s).sub(f))),d.x.mulAssign(a),d.y.mulAssign(o),n.sample(d).grad(Ex(),Ex())})),QP=vx((function(e){var t=e.envMap,n=e.mipInt,r=e.outputDirection,i=e.theta,a=e.axis,o=e.CUBEUV_TEXEL_WIDTH,s=e.CUBEUV_TEXEL_HEIGHT,u=e.CUBEUV_MAX_MIP,l=TT(i),c=r.mul(l).add(a.cross(r).mul(wT(i))).add(a.mul(a.dot(r).mul(l.oneMinus())));return XP(t,c,n,o,s,u)})),YP=vx((function(e){var t=e.n,n=e.latitudinal,r=e.poleAxis,i=e.outputDirection,a=e.weights,o=e.samples,s=e.dTheta,u=e.mipInt,l=e.envMap,c=e.CUBEUV_TEXEL_WIDTH,h=e.CUBEUV_TEXEL_HEIGHT,f=e.CUBEUV_MAX_MIP,d=Rx(mS(n,r,KT(r,i))).toVar();yx(d.equal(Rx(0)),(function(){d.assign(Rx(i.z,0,i.x.negate()))})),d.assign(bT(d));var p=Rx().toVar();return p.addAssign(a.element(0).mul(QP({theta:0,axis:d,outputDirection:i,mipInt:u,envMap:l,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:f}))),vC({start:wx(1),end:t},(function(e){var t=e.i;yx(t.greaterThanEqual(o),(function(){mC()}));var n=xx(s.mul(xx(t))).toVar();p.addAssign(a.element(t).mul(QP({theta:n.mul(-1),axis:d,outputDirection:i,mipInt:u,envMap:l,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:f}))),p.addAssign(a.element(t).mul(QP({theta:n,axis:d,outputDirection:i,mipInt:u,envMap:l,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:f})))})),Lx(p,1)})),KP=[.125,.215,.35,.446,.526,.582],ZP=20,JP=new nl(-1,1,1,-1,0,1),$P=new fo(90,1),eN=new ga,tN=null,nN=0,rN=0,iN=(1+Math.sqrt(5))/2,aN=1/iN,oN=[new Kr(-iN,aN,0),new Kr(iN,aN,0),new Kr(-aN,0,iN),new Kr(aN,0,iN),new Kr(0,iN,-aN),new Kr(0,iN,aN),new Kr(-1,1,-1),new Kr(1,1,-1),new Kr(-1,1,1),new Kr(1,1,1)],sN=new Kr,uN=new WeakMap,lN=[3,1,5,0,4,2],cN=HP(pE(),dE("faceIndex")).normalize(),hN=Rx(cN.x,cN.y,cN.z),fN=function(){function e(t){c(this,e),this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}return p(e,[{key:"_hasInitialized",get:function(){return this._renderer.hasInitialized()}},{key:"fromScene",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=i.size,o=void 0===a?256:a,s=i.position,u=void 0===s?sN:s,l=i.renderTarget,c=void 0===l?null:l;if(this._setSize(o),!1===this._hasInitialized){console.warn("THREE.PMREMGenerator: .fromScene() called before the backend is initialized. Try using .fromSceneAsync() instead.");var h=c||this._allocateTargets();return i.renderTarget=h,this.fromSceneAsync(e,t,n,r,i),h}tN=this._renderer.getRenderTarget(),nN=this._renderer.getActiveCubeFace(),rN=this._renderer.getActiveMipmapLevel();var f=c||this._allocateTargets();return f.depthBuffer=!0,this._sceneToCubeUV(e,n,r,f,u),t>0&&this._blur(f,0,0,t),this._applyPMREM(f),this._cleanup(f),f}},{key:"fromSceneAsync",value:function(){var e=lt(ft().mark((function e(t){var n,r,i,a,o=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>1&&void 0!==o[1]?o[1]:0,r=o.length>2&&void 0!==o[2]?o[2]:.1,i=o.length>3&&void 0!==o[3]?o[3]:100,a=o.length>4&&void 0!==o[4]?o[4]:{},!1!==this._hasInitialized){e.next=7;break}return e.next=7,this._renderer.init();case 7:return e.abrupt("return",this.fromScene(t,n,r,i,a));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fromEquirectangular",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!1===this._hasInitialized){console.warn("THREE.PMREMGenerator: .fromEquirectangular() called before the backend is initialized. Try using .fromEquirectangularAsync() instead."),this._setSizeFromTexture(e);var n=t||this._allocateTargets();return this.fromEquirectangularAsync(e,n),n}return this._fromTexture(e,t)}},{key:"fromEquirectangularAsync",value:function(){var e=lt(ft().mark((function e(t){var n,r=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]?r[1]:null,!1!==this._hasInitialized){e.next=4;break}return e.next=4,this._renderer.init();case 4:return e.abrupt("return",this._fromTexture(t,n));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fromCubemap",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!1===this._hasInitialized){console.warn("THREE.PMREMGenerator: .fromCubemap() called before the backend is initialized. Try using .fromCubemapAsync() instead."),this._setSizeFromTexture(e);var n=t||this._allocateTargets();return this.fromCubemapAsync(e,t),n}return this._fromTexture(e,t)}},{key:"fromCubemapAsync",value:function(){var e=lt(ft().mark((function e(t){var n,r=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]?r[1]:null,!1!==this._hasInitialized){e.next=4;break}return e.next=4,this._renderer.init();case 4:return e.abrupt("return",this._fromTexture(t,n));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"compileCubemapShader",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._cubemapMaterial){e.next=4;break}return this._cubemapMaterial=vN(),e.next=4,this._compileMaterial(this._cubemapMaterial);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"compileEquirectangularShader",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._equirectMaterial){e.next=4;break}return this._equirectMaterial=mN(),e.next=4,this._compileMaterial(this._equirectMaterial);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose(),null!==this._backgroundBox&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}},{key:"_setSizeFromTexture",value:function(e){e.mapping===Et||e.mapping===kt?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4)}},{key:"_setSize",value:function(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}},{key:"_dispose",value:function(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(var e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}},{key:"_cleanup",value:function(e){this._renderer.setRenderTarget(tN,nN,rN),e.scissorTest=!1,pN(e,0,0,e.width,e.height)}},{key:"_fromTexture",value:function(e,t){this._setSizeFromTexture(e),tN=this._renderer.getRenderTarget(),nN=this._renderer.getActiveCubeFace(),rN=this._renderer.getActiveMipmapLevel();var n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}},{key:"_allocateTargets",value:function(){var e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Ut,minFilter:Ut,generateMipmaps:!1,type:Xt,format:en,colorSpace:Zn},r=dN(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=dN(e,t,n);var i=this._lodMax,a=function(e){for(var t=[],n=[],r=[],i=[],a=e,o=e-4+1+KP.length,s=0;s<o;s++){var u=Math.pow(2,a);n.push(u);var l=1/u;s>e-4?l=KP[s-e+4-1]:0===s&&(l=0),r.push(l);for(var c=1/(u-2),h=-c,f=1+c,d=[h,h,f,h,f,f,h,h,f,f,h,f],p=6,A=6,v=3,m=2,g=1,y=new Float32Array(v*A*p),_=new Float32Array(m*A*p),b=new Float32Array(g*A*p),x=0;x<p;x++){var w=x%3*2/3-1,T=x>2?0:-1,S=[w,T,0,w+2/3,T,0,w+2/3,T+1,0,w,T,0,w+2/3,T+1,0,w,T+1,0],E=lN[x];y.set(S,v*A*E),_.set(d,m*A*E);var k=[E,E,E,E,E,E];b.set(k,g*A*E)}var M=new qa;M.setAttribute("position",new Ra(y,v)),M.setAttribute("uv",new Ra(_,m)),M.setAttribute("faceIndex",new Ra(b,g)),t.push(M),i.push(new eo(M,null)),a>4&&a--}return{lodPlanes:t,sizeLods:n,sigmas:r,lodMeshes:i}}(i);this._sizeLods=a.sizeLods,this._lodPlanes=a.lodPlanes,this._sigmas=a.sigmas,this._lodMeshes=a.lodMeshes,this._blurMaterial=function(e,t,n){var r=EE(new Array(ZP).fill(0)),i=Jx(new Kr(0,1,0)),a=Jx(0),o=xx(ZP),s=Jx(0),u=Jx(1),l=_E(null),c=Jx(0),h=xx(1/t),f=xx(1/n),d=xx(e),p={n:o,latitudinal:s,weights:r,poleAxis:i,outputDirection:hN,dTheta:a,samples:u,envMap:l,mipInt:c,CUBEUV_TEXEL_WIDTH:h,CUBEUV_TEXEL_HEIGHT:f,CUBEUV_MAX_MIP:d},A=AN("blur");return A.fragmentNode=YP(Qe(Qe({},p),{},{latitudinal:s.equal(1)})),uN.set(A,p),A}(i,e,t)}return r}},{key:"_compileMaterial",value:function(){var e=lt(ft().mark((function e(t){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new eo(this._lodPlanes[0],t),e.next=3,this._renderer.compile(n,JP);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_sceneToCubeUV",value:function(e,t,n,r,i){var a=$P;a.near=t,a.far=n;var o=[1,1,1,1,-1,1],s=[1,-1,1,-1,1,-1],u=this._renderer,l=u.autoClear;u.getClearColor(eN),u.autoClear=!1;var c=this._backgroundBox;if(null===c){var h=new xa({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1});c=new eo(new no,h)}var f=!1,d=e.background;d?d.isColor&&(c.material.color.copy(d),e.background=null,f=!0):(c.material.color.copy(eN),f=!0),u.setRenderTarget(r),u.clear(),f&&u.render(c,a);for(var p=0;p<6;p++){var A=p%3;0===A?(a.up.set(0,o[p],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x+s[p],i.y,i.z)):1===A?(a.up.set(0,0,o[p]),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y+s[p],i.z)):(a.up.set(0,o[p],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y,i.z+s[p]));var v=this._cubeSize;pN(r,A*v,p>2?v:0,v,v),u.render(e,a)}u.autoClear=l,e.background=d}},{key:"_textureToCubeUV",value:function(e,t){var n=this._renderer,r=e.mapping===Et||e.mapping===kt;r?null===this._cubemapMaterial&&(this._cubemapMaterial=vN(e)):null===this._equirectMaterial&&(this._equirectMaterial=mN(e));var i=r?this._cubemapMaterial:this._equirectMaterial;i.fragmentNode.value=e;var a=this._lodMeshes[0];a.material=i;var o=this._cubeSize;pN(t,0,0,3*o,2*o),n.setRenderTarget(t),n.render(a,JP)}},{key:"_applyPMREM",value:function(e){var t=this._renderer,n=t.autoClear;t.autoClear=!1;for(var r=this._lodPlanes.length,i=1;i<r;i++){var a=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),o=oN[(r-i-1)%oN.length];this._blur(e,i-1,i,a,o)}t.autoClear=n}},{key:"_blur",value:function(e,t,n,r,i){var a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}},{key:"_halfBlur",value:function(e,t,n,r,i,a,o){var s=this._renderer,u=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var l=this._lodMeshes[r];l.material=u;var c=uN.get(u),h=this._sizeLods[n]-1,f=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,d=i/f,p=isFinite(i)?1+Math.floor(3*d):ZP;p>ZP&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(p," samples when the maximum is set to ").concat(ZP));for(var A=[],v=0,m=0;m<ZP;++m){var g=m/d,y=Math.exp(-g*g/2);A.push(y),0===m?v+=y:m<p&&(v+=2*y)}for(var _=0;_<A.length;_++)A[_]=A[_]/v;e.texture.frame=(e.texture.frame||0)+1,c.envMap.value=e.texture,c.samples.value=p,c.weights.array=A,c.latitudinal.value="latitudinal"===a?1:0,o&&(c.poleAxis.value=o);var b=this._lodMax;c.dTheta.value=f,c.mipInt.value=b-n;var x=this._sizeLods[r];pN(t,3*x*(r>b-4?r-b+4:0),4*(this._cubeSize-x),3*x,2*x),s.setRenderTarget(t),s.render(l,JP)}}]),e}();function dN(e,t,n){var r=new Hr(e,t,n);return r.texture.mapping=Rt,r.texture.name="PMREM.cubeUv",r.texture.isPMREMTexture=!0,r.scissorTest=!0,r}function pN(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function AN(e){var t=new uR;return t.depthTest=!1,t.depthWrite=!1,t.blending=0,t.name="PMREM_".concat(e),t}function vN(e){var t=AN("cubemap");return t.fragmentNode=Nk(e,hN),t}function mN(e){var t=AN("equirect");return t.fragmentNode=_E(e,_R(hN),0),t}var gN=new WeakMap;function yN(e,t,n){var r=function(e){var t=gN.get(e);void 0===t&&(t=new WeakMap,gN.set(e,t));return t}(t),i=r.get(e);if((void 0!==i?i.pmremVersion:-1)!==e.pmremVersion){var a=e.image;if(e.isCubeTexture){if(!function(e){if(null===e||void 0===e)return!1;for(var t=0,n=6,r=0;r<n;r++)void 0!==e[r]&&t++;return t===n}(a))return null;i=n.fromCubemap(e,i)}else{if(!function(e){return null!==e&&void 0!==e&&e.height>0}(a))return null;i=n.fromEquirectangular(e,i)}i.pmremVersion=e.pmremVersion,r.set(e,i)}return i.texture}var _N=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;c(this,n),(r=t.call(this,"vec3"))._value=e,r._pmrem=null,r.uvNode=i,r.levelNode=a,r._generator=null;var o=new jr;return o.isRenderTargetTexture=!0,r._texture=_E(o),r._width=Jx(0),r._height=Jx(0),r._maxMip=Jx(0),r.updateBeforeType=tb.RENDER,r}return p(n,[{key:"value",get:function(){return this._value},set:function(e){this._value=e,this._pmrem=null}},{key:"updateFromTexture",value:function(e){var t=function(e){var t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}},{key:"updateBefore",value:function(e){var t=this._pmrem,n=t?t.pmremVersion:-1,r=this._value;n!==r.pmremVersion&&null!==(t=!0===r.isPMREMTexture?r:yN(r,e.renderer,this._generator))&&(this._pmrem=t,this.updateFromTexture(t))}},{key:"setup",value:function(e){null===this._generator&&(this._generator=new fN(e.renderer)),this.updateBefore(e);var t=this.uvNode;null===t&&e.context.getUV&&(t=e.context.getUV(this)),t=Ek.mul(Rx(t.x,t.y.negate(),t.z));var n=this.levelNode;return null===n&&e.context.getTextureLevel&&(n=e.context.getTextureLevel(this)),WP(this._texture,t,n,this._width,this._height,this._maxMip)}},{key:"dispose",value:function(){ht(m(n.prototype),"dispose",this).call(this),null!==this._generator&&this._generator.dispose()}}],[{key:"type",get:function(){return"PMREMNode"}}]),n}(hb);var bN=dx(_N).setParameterLength(1,3),xN=new WeakMap,wN=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return c(this,n),(e=t.call(this)).envNode=r,e}return p(n,[{key:"setup",value:function(e){var t=e.material,n=this.envNode;if(n.isTextureNode||n.isMaterialReferenceNode){var r=n.isTextureNode?n.value:t[n.property],i=xN.get(r);void 0===i&&(i=bN(r),xN.set(r,i)),n=i}var a=!0===t.useAnisotropy||t.anisotropy>0?eM:mk,o=n.context(TN(iw,a)).mul(Sk),s=n.context(SN(gk)).mul(Math.PI).mul(Sk),u=eE(o),l=eE(s);e.context.radiance.addAssign(u),e.context.iblIrradiance.addAssign(l);var c=e.context.lightingModel.clearcoatRadiance;if(c){var h=n.context(TN(sw,yk)).mul(Sk),f=eE(h);c.addAssign(f)}}}],[{key:"type",get:function(){return"EnvironmentNode"}}]),n}(SC),TN=function(e,t){var n=null;return{getUV:function(){return null===n&&(n=lk.negate().reflect(t),n=(n=e.mul(e).mix(n,t).normalize()).transformDirection(NE)),n},getTextureLevel:function(){return e}}},SN=function(e){return{getUV:function(){return e},getTextureLevel:function(){return xx(1)}}},EN=new du,kN=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshStandardNodeMaterial=!0,r.lights=!0,r.emissiveNode=null,r.metalnessNode=null,r.roughnessNode=null,r.setDefaultValues(EN),r.setValues(e),r}return p(n,[{key:"setupEnvironment",value:function(e){var t=ht(m(n.prototype),"setupEnvironment",this).call(this,e);return null===t&&e.environmentNode&&(t=e.environmentNode),t?new wN(t):null}},{key:"setupLightingModel",value:function(){return new CP}},{key:"setupSpecular",value:function(){var e=iS(Rx(.04),nw.rgb,aw);mw.assign(e),gw.assign(1)}},{key:"setupVariants",value:function(){var e=this.metalnessNode?xx(this.metalnessNode):bM;aw.assign(e);var t=this.roughnessNode?xx(this.roughnessNode):_M;t=qR({roughness:t}),iw.assign(t),this.setupSpecular(),nw.assign(Lx(nw.rgb.mul(e.oneMinus()),nw.a))}},{key:"copy",value:function(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,ht(m(n.prototype),"copy",this).call(this,e)}}],[{key:"type",get:function(){return"MeshStandardNodeMaterial"}}]),n}(uR),MN=new pu,CN=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshPhysicalNodeMaterial=!0,r.clearcoatNode=null,r.clearcoatRoughnessNode=null,r.clearcoatNormalNode=null,r.sheenNode=null,r.sheenRoughnessNode=null,r.iridescenceNode=null,r.iridescenceIORNode=null,r.iridescenceThicknessNode=null,r.specularIntensityNode=null,r.specularColorNode=null,r.iorNode=null,r.transmissionNode=null,r.thicknessNode=null,r.attenuationDistanceNode=null,r.attenuationColorNode=null,r.dispersionNode=null,r.anisotropyNode=null,r.setDefaultValues(MN),r.setValues(e),r}return p(n,[{key:"useClearcoat",get:function(){return this.clearcoat>0||null!==this.clearcoatNode}},{key:"useIridescence",get:function(){return this.iridescence>0||null!==this.iridescenceNode}},{key:"useSheen",get:function(){return this.sheen>0||null!==this.sheenNode}},{key:"useAnisotropy",get:function(){return this.anisotropy>0||null!==this.anisotropyNode}},{key:"useTransmission",get:function(){return this.transmission>0||null!==this.transmissionNode}},{key:"useDispersion",get:function(){return this.dispersion>0||null!==this.dispersionNode}},{key:"setupSpecular",value:function(){var e=this.iorNode?xx(this.iorNode):DM;Tw.assign(e),mw.assign(iS(jT(JT(Tw.sub(1).div(Tw.add(1))).mul(mM),Rx(1)).mul(vM),nw.rgb,aw)),gw.assign(iS(vM,1,aw))}},{key:"setupLightingModel",value:function(){return new CP(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}},{key:"setupVariants",value:function(e){if(ht(m(n.prototype),"setupVariants",this).call(this,e),this.useClearcoat){var t=this.clearcoatNode?xx(this.clearcoatNode):wM,r=this.clearcoatRoughnessNode?xx(this.clearcoatRoughnessNode):TM;ow.assign(t),sw.assign(qR({roughness:r}))}if(this.useSheen){var i=this.sheenNode?Rx(this.sheenNode):kM,a=this.sheenRoughnessNode?xx(this.sheenRoughnessNode):MM;uw.assign(i),lw.assign(a)}if(this.useIridescence){var o=this.iridescenceNode?xx(this.iridescenceNode):RM,s=this.iridescenceIORNode?xx(this.iridescenceIORNode):PM,u=this.iridescenceThicknessNode?xx(this.iridescenceThicknessNode):NM;cw.assign(o),hw.assign(s),fw.assign(u)}if(this.useAnisotropy){var l=(this.anisotropyNode?Ex(this.anisotropyNode):CM).toVar();pw.assign(l.length()),yx(pw.equal(0),(function(){l.assign(Ex(1,0))})).Else((function(){l.divAssign(Ex(pw)),pw.assign(pw.saturate())})),dw.assign(pw.pow2().mix(iw.pow2(),1)),Aw.assign(Jk[0].mul(l.x).add(Jk[1].mul(l.y))),vw.assign(Jk[1].mul(l.x).sub(Jk[0].mul(l.y)))}if(this.useTransmission){var c=this.transmissionNode?xx(this.transmissionNode):IM,h=this.thicknessNode?xx(this.thicknessNode):LM,f=this.attenuationDistanceNode?xx(this.attenuationDistanceNode):OM,d=this.attenuationColorNode?Rx(this.attenuationColorNode):UM;if(Sw.assign(c),Ew.assign(h),kw.assign(f),Mw.assign(d),this.useDispersion){var p=this.dispersionNode?xx(this.dispersionNode):GM;Cw.assign(p)}}}},{key:"setupClearcoatNormal",value:function(){return this.clearcoatNormalNode?Rx(this.clearcoatNormalNode):SM}},{key:"setup",value:function(e){var t=this;e.context.setupClearcoatNormal=function(){return t.setupClearcoatNormal(e)},ht(m(n.prototype),"setup",this).call(this,e)}},{key:"copy",value:function(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,ht(m(n.prototype),"copy",this).call(this,e)}}],[{key:"type",get:function(){return"MeshPhysicalNodeMaterial"}}]),n}(kN),RN=vx((function(e){var t=e.normal,n=e.lightDirection,r=e.builder,i=t.dot(n),a=Ex(i.mul(.5).add(.5),0);if(r.material.gradientMap){var o=Bk("gradientMap","texture").context({getUV:function(){return a}});return Rx(o.r)}var s=a.fwidth().mul(.5);return iS(Rx(.7),Rx(1),uS(xx(.7).sub(s.x),xx(.7).add(s.x),a.x))})),PN=function(e){v(n,e);var t=b(n);function n(){return c(this,n),t.apply(this,arguments)}return p(n,[{key:"direct",value:function(e,t){var n=e.lightDirection,r=e.lightColor,i=e.reflectedLight,a=RN({normal:fk,lightDirection:n,builder:t}).mul(r);i.directDiffuse.addAssign(a.mul(IR({diffuseColor:nw.rgb})))}},{key:"indirect",value:function(e){var t=e.context,n=t.ambientOcclusion,r=t.irradiance,i=t.reflectedLight;i.indirectDiffuse.addAssign(r.mul(IR({diffuseColor:nw}))),i.indirectDiffuse.mulAssign(n)}}]),n}(MR),NN=new vu,IN=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshToonNodeMaterial=!0,r.lights=!0,r.setDefaultValues(NN),r.setValues(e),r}return p(n,[{key:"setupLightingModel",value:function(){return new PN}}],[{key:"type",get:function(){return"MeshToonNodeMaterial"}}]),n}(uR),LN=function(e){v(n,e);var t=b(n);function n(){return c(this,n),t.call(this,"vec2")}return p(n,[{key:"setup",value:function(){var e=Rx(lk.z,0,lk.x.negate()).normalize(),t=lk.cross(e);return Ex(e.dot(mk),t.dot(mk)).mul(.495).add(.5)}}],[{key:"type",get:function(){return"MatcapUVNode"}}]),n}(hb),DN=px(LN),ON=new bu,UN=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isMeshMatcapNodeMaterial=!0,r.setDefaultValues(ON),r.setValues(e),r}return p(n,[{key:"setupVariants",value:function(e){var t,n=DN;t=e.material.matcap?Bk("matcap","texture").context({getUV:function(){return n}}):Rx(iS(.2,.8,n.y)),nw.rgb.mulAssign(t.rgb)}}],[{key:"type",get:function(){return"MeshMatcapNodeMaterial"}}]),n}(uR),BN=dx(function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this)).positionNode=e,i.rotationNode=r,i}return p(n,[{key:"getNodeType",value:function(e){return this.positionNode.getNodeType(e)}},{key:"setup",value:function(e){var t=this.rotationNode,n=this.positionNode;if("vec2"===this.getNodeType(e)){var r=t.cos(),i=t.sin();return Bx(r,i,i.negate(),r).mul(n)}var a=t,o=zx(Lx(1,0,0,0),Lx(0,TT(a.x),wT(a.x).negate(),0),Lx(0,wT(a.x),TT(a.x),0),Lx(0,0,0,1)),s=zx(Lx(TT(a.y),0,wT(a.y),0),Lx(0,1,0,0),Lx(wT(a.y).negate(),0,TT(a.y),0),Lx(0,0,0,1)),u=zx(Lx(TT(a.z),wT(a.z).negate(),0,0),Lx(wT(a.z),TT(a.z),0,0),Lx(0,0,1,0),Lx(0,0,0,1));return o.mul(s).mul(u).mul(Lx(n,1)).xyz}}],[{key:"type",get:function(){return"RotateNode"}}]),n}(hb)).setParameterLength(2),FN=new So,zN=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isSpriteNodeMaterial=!0,r._useSizeAttenuation=!0,r.positionNode=null,r.rotationNode=null,r.scaleNode=null,r.transparent=!0,r.setDefaultValues(FN),r.setValues(e),r}return p(n,[{key:"setupPositionView",value:function(e){var t=e.object,n=e.camera,r=this.sizeAttenuation,i=this.positionNode,a=this.rotationNode,o=this.scaleNode,s=$E.mul(Rx(i||0)),u=Ex(WE[0].xyz.length(),WE[1].xyz.length());if(null!==o&&(u=u.mul(Ex(o))),!1===r)if(n.isPerspectiveCamera)u=u.mul(s.z.negate());else{var l=xx(2).div(RE.element(1).element(1));u=u.mul(l.mul(2))}var c=rk.xy;if(t.center&&!0===t.center.isVector2){var h=function(e,t,n){return cx(new zS(e,t,n))}("center","vec2",t);c=c.sub(h.sub(.5))}c=c.mul(u);var f=xx(a||EM),d=BN(c,f);return Lx(s.xy.add(d),s.zw)}},{key:"copy",value:function(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,ht(m(n.prototype),"copy",this).call(this,e)}},{key:"sizeAttenuation",get:function(){return this._useSizeAttenuation},set:function(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}],[{key:"type",get:function(){return"SpriteNodeMaterial"}}]),n}(uR),VN=new Qo,qN=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).sizeNode=null,r.isPointsNodeMaterial=!0,r.setDefaultValues(VN),r.setValues(e),r}return p(n,[{key:"setupPositionView",value:function(){var e=this.positionNode;return $E.mul(Rx(e||ik)).xyz}},{key:"setupVertex",value:function(e){var t=ht(m(n.prototype),"setupVertex",this).call(this,e);if(!0!==e.material.isNodeMaterial)return t;var r=this.rotationNode,i=this.scaleNode,a=this.sizeNode,o=rk.xy.toVar(),s=LC.z.div(LC.w);if(r&&r.isNode){var u=xx(r);o.assign(BN(o,u))}var l=null!==a?Ex(a):jM;return!0===this.sizeAttenuation&&(l=l.mul(l.div(uk.z.negate()))),i&&i.isNode&&(l=l.mul(Ex(i))),o.mulAssign(l.mul(2)),o.assign(o.div(LC.z)),o.y.assign(o.y.mul(s)),o.assign(o.mul(t.w)),t.addAssign(Lx(o,0,0)),t}},{key:"alphaToCoverage",get:function(){return this._useAlphaToCoverage},set:function(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}],[{key:"type",get:function(){return"PointsNodeMaterial"}}]),n}(zN),jN=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this)).shadowNode=xx(1).toVar("shadowMask"),e}return p(n,[{key:"direct",value:function(e){var t=e.lightNode;this.shadowNode.mulAssign(t.shadowNode)}},{key:"finish",value:function(e){var t=e.context;nw.a.mulAssign(this.shadowNode.oneMinus()),t.outgoingLight.rgb.assign(nw.rgb)}}]),n}(MR),GN=new fu,HN=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).isShadowNodeMaterial=!0,r.lights=!0,r.transparent=!0,r.setDefaultValues(GN),r.setValues(e),r}return p(n,[{key:"setupLightingModel",value:function(){return new jN}}],[{key:"type",get:function(){return"ShadowNodeMaterial"}}]),n}(uR),WN=(ew("vec3"),ew("vec3"),ew("vec3"),function(){function e(t,n){c(this,e),this.nodes=t,this.info=n,this._context=self,this._animationLoop=null,this._requestId=null}return p(e,[{key:"start",value:function(){var e=this;!function t(n,r){e._requestId=e._context.requestAnimationFrame(t),!0===e.info.autoReset&&e.info.reset(),e.nodes.nodeFrame.update(),e.info.frame=e.nodes.nodeFrame.frameId,null!==e._animationLoop&&e._animationLoop(n,r)}()}},{key:"stop",value:function(){this._context.cancelAnimationFrame(this._requestId),this._requestId=null}},{key:"getAnimationLoop",value:function(){return this._animationLoop}},{key:"setAnimationLoop",value:function(e){this._animationLoop=e}},{key:"getContext",value:function(){return this._context}},{key:"setContext",value:function(e){this._context=e}},{key:"dispose",value:function(){this.stop()}}]),e}()),XN=function(){function e(){c(this,e),this.weakMap=new WeakMap}return p(e,[{key:"get",value:function(e){for(var t=this.weakMap,n=0;n<e.length-1;n++)if(void 0===(t=t.get(e[n])))return;return t.get(e[e.length-1])}},{key:"set",value:function(e,t){for(var n=this.weakMap,r=0;r<e.length-1;r++){var i=e[r];!1===n.has(i)&&n.set(i,new WeakMap),n=n.get(i)}return n.set(e[e.length-1],t),this}},{key:"delete",value:function(e){for(var t=this.weakMap,n=0;n<e.length-1;n++)if(void 0===(t=t.get(e[n])))return!1;return t.delete(e[e.length-1])}}]),e}(),QN=0;var YN=function(){function e(t,n,r,i,a,o,s,u,l,h){var f=this;c(this,e),this.id=QN++,this._nodes=t,this._geometries=n,this.renderer=r,this.object=i,this.material=a,this.scene=o,this.camera=s,this.lightsNode=u,this.context=l,this.geometry=i.geometry,this.version=a.version,this.drawRange=null,this.attributes=null,this.pipeline=null,this.group=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.clippingContext=h,this.clippingContextCacheKey=null!==h?h.cacheKey:"",this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=function(){f.dispose()},this.material.addEventListener("dispose",this.onMaterialDispose)}return p(e,[{key:"updateClipping",value:function(e){this.clippingContext=e}},{key:"clippingNeedsUpdate",get:function(){return null!==this.clippingContext&&this.clippingContext.cacheKey!==this.clippingContextCacheKey&&(this.clippingContextCacheKey=this.clippingContext.cacheKey,!0)}},{key:"hardwareClippingPlanes",get:function(){return!0===this.material.hardwareClipping?this.clippingContext.unionClippingCount:0}},{key:"getNodeBuilderState",value:function(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}},{key:"getMonitor",value:function(){return this._monitor||(this._monitor=this.getNodeBuilderState().observer)}},{key:"getBindings",value:function(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}},{key:"getBindingGroup",value:function(e){var t,n=k(this.getBindings());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.name===e)return r}}catch(i){n.e(i)}finally{n.f()}}},{key:"getIndex",value:function(){return this._geometries.getIndex(this)}},{key:"getIndirect",value:function(){return this._geometries.getIndirect(this)}},{key:"getChainArray",value:function(){return[this.object,this.material,this.context,this.lightsNode]}},{key:"setGeometry",value:function(e){this.geometry=e,this.attributes=null}},{key:"getAttributes",value:function(){if(null!==this.attributes)return this.attributes;var e,t=this.getNodeBuilderState().nodeAttributes,n=this.geometry,r=[],i=new Set,a=k(t);try{for(a.s();!(e=a.n()).done;){var o=e.value,s=o.node&&o.node.attribute?o.node.attribute:n.getAttribute(o.name);if(void 0!==s){r.push(s);var u=s.isInterleavedBufferAttribute?s.data:s;i.add(u)}}}catch(l){a.e(l)}finally{a.f()}return this.attributes=r,this.vertexBuffers=Array.from(i.values()),r}},{key:"getVertexBuffers",value:function(){return null===this.vertexBuffers&&this.getAttributes(),this.vertexBuffers}},{key:"getDrawParameters",value:function(){var e=this.object,t=this.material,n=this.geometry,r=this.group,i=this.drawRange,a=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),o=this.getIndex(),s=null!==o,u=n.isInstancedBufferGeometry?n.instanceCount:e.count>1?e.count:1;if(0===u)return null;if(a.instanceCount=u,!0===e.isBatchedMesh)return a;var l=1;!0!==t.wireframe||e.isPoints||e.isLineSegments||e.isLine||e.isLineLoop||(l=2);var c=i.start*l,h=(i.start+i.count)*l;null!==r&&(c=Math.max(c,r.start*l),h=Math.min(h,(r.start+r.count)*l));var f=n.attributes.position,d=1/0;s?d=o.count:void 0!==f&&null!==f&&(d=f.count),c=Math.max(c,0);var p=(h=Math.min(h,d))-c;return p<0||p===1/0?null:(a.vertexCount=p,a.firstVertex=c,a)}},{key:"getGeometryCacheKey",value:function(){var e,t=this.geometry,n="",r=k(Object.keys(t.attributes).sort());try{for(r.s();!(e=r.n()).done;){var i=e.value,a=t.attributes[i];n+=i+",",a.data&&(n+=a.data.stride+","),a.offset&&(n+=a.offset+","),a.itemSize&&(n+=a.itemSize+","),a.normalized&&(n+="n,")}}catch(f){r.e(f)}finally{r.f()}var o,s=k(Object.keys(t.morphAttributes).sort());try{for(s.s();!(o=s.n()).done;){var u=o.value,l=t.morphAttributes[u];n+="morph-"+u+",";for(var c=0,h=l.length;c<h;c++){n+=l[c].id+","}}}catch(f){s.e(f)}finally{s.f()}return t.index&&(n+="index,"),n}},{key:"getMaterialCacheKey",value:function(){var e,t=this.object,n=this.material,r=n.customProgramCacheKey(),i=k(function(e){for(var t=Object.keys(e),n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptors(n);for(var i in r)if(void 0!==r[i]){var a=r[i];a&&"function"===typeof a.get&&t.push(i)}n=Object.getPrototypeOf(n)}return t}(n));try{for(i.s();!(e=i.n()).done;){var a=e.value;if(!/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(a)){var o=n[a],s=void 0;if(null!==o){var u=typeof o;"number"===u?s=0!==o?"1":"0":"object"===u?(s="{",o.isTexture&&(s+=o.mapping),s+="}"):s=String(o)}else s=String(o);r+=s+","}}}catch(l){i.e(l)}finally{i.f()}return r+=this.clippingContextCacheKey+",",t.geometry&&(r+=this.getGeometryCacheKey()),t.skeleton&&(r+=t.skeleton.bones.length+","),t.isBatchedMesh&&(r+=t._matricesTexture.uuid+",",null!==t._colorsTexture&&(r+=t._colorsTexture.uuid+",")),t.count>1&&(r+=t.uuid+","),r+=t.receiveShadow+",",F_(r)}},{key:"needsGeometryUpdate",get:function(){return this.geometry.id!==this.object.geometry.id}},{key:"needsUpdate",get:function(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}},{key:"getDynamicCacheKey",value:function(){var e=0;return!0!==this.material.isShadowPassMaterial&&(e=this._nodes.getCacheKey(this.scene,this.lightsNode)),this.camera.isArrayCamera&&(e=V_(e,this.camera.cameras.length)),this.object.receiveShadow&&(e=V_(e,1)),e}},{key:"getCacheKey",value:function(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}},{key:"dispose",value:function(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.onDispose()}}]),e}(),KN=[],ZN=function(){function e(t,n,r,i,a,o){c(this,e),this.renderer=t,this.nodes=n,this.geometries=r,this.pipelines=i,this.bindings=a,this.info=o,this.chainMaps={}}return p(e,[{key:"get",value:function(e,t,n,r,i,a,o,s){var u=this.getChainMap(s);KN[0]=e,KN[1]=t,KN[2]=a,KN[3]=i;var l=u.get(KN);return void 0===l?(l=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,t,n,r,i,a,o,s),u.set(KN,l)):(l.updateClipping(o),l.needsGeometryUpdate&&l.setGeometry(e.geometry),(l.version!==t.version||l.needsUpdate)&&(l.initialCacheKey!==l.getCacheKey()?(l.dispose(),l=this.get(e,t,n,r,i,a,o,s)):l.version=t.version)),KN.length=0,l}},{key:"getChainMap",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return this.chainMaps[e]||(this.chainMaps[e]=new XN)}},{key:"dispose",value:function(){this.chainMaps={}}},{key:"createRenderObject",value:function(e,t,n,r,i,a,o,s,u,l,c){var h=this,f=this.getChainMap(c),d=new YN(e,t,n,r,i,a,o,s,u,l);return d.onDispose=function(){h.pipelines.delete(d),h.bindings.delete(d),h.nodes.delete(d),f.delete(d.getChainArray())},d}}]),e}(),JN=function(){function e(){c(this,e),this.data=new WeakMap}return p(e,[{key:"get",value:function(e){var t=this.data.get(e);return void 0===t&&(t={},this.data.set(e,t)),t}},{key:"delete",value:function(e){var t=null;return this.data.has(e)&&(t=this.data.get(e),this.data.delete(e)),t}},{key:"has",value:function(e){return this.data.has(e)}},{key:"dispose",value:function(){this.data=new WeakMap}}]),e}(),$N=1,eI=2,tI=3,nI=4,rI=16,iI=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).backend=e,r}return p(n,[{key:"delete",value:function(e){var t=ht(m(n.prototype),"delete",this).call(this,e);return null!==t&&this.backend.destroyAttribute(e),t}},{key:"update",value:function(e,t){var n=this.get(e);if(void 0===n.version)t===$N?this.backend.createAttribute(e):t===eI?this.backend.createIndexAttribute(e):t===tI?this.backend.createStorageAttribute(e):t===nI&&this.backend.createIndirectStorageAttribute(e),n.version=this._getBufferAttribute(e).version;else{var r=this._getBufferAttribute(e);(n.version<r.version||r.usage===ir)&&(this.backend.updateAttribute(e),n.version=r.version)}}},{key:"_getBufferAttribute",value:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}]),n}(JN);function aI(e){return null!==e.index?e.index.version:e.attributes.position.version}function oI(e){var t=[],n=e.index,r=e.attributes.position;if(null!==n)for(var i=n.array,a=0,o=i.length;a<o;a+=3){var s=i[a+0],u=i[a+1],l=i[a+2];t.push(s,u,u,l,l,s)}else for(var c=0,h=r.array.length/3-1;c<h;c+=3){var f=c+0,d=c+1,p=c+2;t.push(f,d,d,p,p,f)}var A=new(wr(t)?Na:Pa)(t,1);return A.version=aI(e),A}var sI=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this)).attributes=e,i.info=r,i.wireframes=new WeakMap,i.attributeCall=new WeakMap,i}return p(n,[{key:"has",value:function(e){var t=e.geometry;return ht(m(n.prototype),"has",this).call(this,t)&&!0===this.get(t).initialized}},{key:"updateForRender",value:function(e){!1===this.has(e)&&this.initGeometry(e),this.updateAttributes(e)}},{key:"initGeometry",value:function(e){var t=this,n=e.geometry;this.get(n).initialized=!0,this.info.memory.geometries++;n.addEventListener("dispose",(function r(){t.info.memory.geometries--;var i=n.index,a=e.getAttributes();null!==i&&t.attributes.delete(i);var o,s=k(a);try{for(s.s();!(o=s.n()).done;){var u=o.value;t.attributes.delete(u)}}catch(c){s.e(c)}finally{s.f()}var l=t.wireframes.get(n);void 0!==l&&t.attributes.delete(l),n.removeEventListener("dispose",r)}))}},{key:"updateAttributes",value:function(e){var t,n=k(e.getAttributes());try{for(n.s();!(t=n.n()).done;){var r=t.value;r.isStorageBufferAttribute||r.isStorageInstancedBufferAttribute?this.updateAttribute(r,tI):this.updateAttribute(r,$N)}}catch(o){n.e(o)}finally{n.f()}var i=this.getIndex(e);null!==i&&this.updateAttribute(i,eI);var a=e.geometry.indirect;null!==a&&this.updateAttribute(a,nI)}},{key:"updateAttribute",value:function(e,t){var n=this.info.render.calls;e.isInterleavedBufferAttribute?void 0===this.attributeCall.get(e)?(this.attributes.update(e,t),this.attributeCall.set(e,n)):this.attributeCall.get(e.data)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e.data,n),this.attributeCall.set(e,n)):this.attributeCall.get(e)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e,n))}},{key:"getIndirect",value:function(e){return e.geometry.indirect}},{key:"getIndex",value:function(e){var t=e.geometry,n=e.material,r=t.index;if(!0===n.wireframe){var i=this.wireframes,a=i.get(t);void 0===a?(a=oI(t),i.set(t,a)):a.version!==aI(t)&&(this.attributes.delete(a),a=oI(t),i.set(t,a)),r=a}return r}}]),n}(JN),uI=function(){function e(){c(this,e),this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0},this.compute={calls:0,frameCalls:0,timestamp:0},this.memory={geometries:0,textures:0}}return p(e,[{key:"update",value:function(e,t,n){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=n*(t/3):e.isPoints?this.render.points+=n*t:e.isLineSegments?this.render.lines+=n*(t/2):e.isLine?this.render.lines+=n*(t-1):console.error("THREE.WebGPUInfo: Unknown object type.")}},{key:"reset",value:function(){this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}},{key:"dispose",value:function(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}]),e}(),lI=p((function e(t){c(this,e),this.cacheKey=t,this.usedTimes=0})),cI=function(e){v(n,e);var t=b(n);function n(e,r,i){var a;return c(this,n),(a=t.call(this,e)).vertexProgram=r,a.fragmentProgram=i,a}return p(n)}(lI),hI=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,e)).computeProgram=r,i.isComputePipeline=!0,i}return p(n)}(lI),fI=0,dI=p((function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;c(this,e),this.id=fI++,this.code=t,this.stage=n,this.name=r,this.transforms=i,this.attributes=a,this.usedTimes=0})),pI=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this)).backend=e,i.nodes=r,i.bindings=null,i.caches=new Map,i.programs={vertex:new Map,fragment:new Map,compute:new Map},i}return p(n,[{key:"getForCompute",value:function(e,t){var n=this.backend,r=this.get(e);if(this._needsComputeUpdate(e)){var i=r.pipeline;i&&(i.usedTimes--,i.computeProgram.usedTimes--);var a=this.nodes.getForCompute(e),o=this.programs.compute.get(a.computeShader);void 0===o&&(i&&0===i.computeProgram.usedTimes&&this._releaseProgram(i.computeProgram),o=new dI(a.computeShader,"compute",e.name,a.transforms,a.nodeAttributes),this.programs.compute.set(a.computeShader,o),n.createProgram(o));var s=this._getComputeCacheKey(e,o),u=this.caches.get(s);void 0===u&&(i&&0===i.usedTimes&&this._releasePipeline(i),u=this._getComputePipeline(e,o,s,t)),u.usedTimes++,o.usedTimes++,r.version=e.version,r.pipeline=u}return r.pipeline}},{key:"getForRender",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.backend,r=this.get(e);if(this._needsRenderUpdate(e)){var i=r.pipeline;i&&(i.usedTimes--,i.vertexProgram.usedTimes--,i.fragmentProgram.usedTimes--);var a=e.getNodeBuilderState(),o=e.material?e.material.name:"",s=this.programs.vertex.get(a.vertexShader);void 0===s&&(i&&0===i.vertexProgram.usedTimes&&this._releaseProgram(i.vertexProgram),s=new dI(a.vertexShader,"vertex",o),this.programs.vertex.set(a.vertexShader,s),n.createProgram(s));var u=this.programs.fragment.get(a.fragmentShader);void 0===u&&(i&&0===i.fragmentProgram.usedTimes&&this._releaseProgram(i.fragmentProgram),u=new dI(a.fragmentShader,"fragment",o),this.programs.fragment.set(a.fragmentShader,u),n.createProgram(u));var l=this._getRenderCacheKey(e,s,u),c=this.caches.get(l);void 0===c?(i&&0===i.usedTimes&&this._releasePipeline(i),c=this._getRenderPipeline(e,s,u,l,t)):e.pipeline=c,c.usedTimes++,s.usedTimes++,u.usedTimes++,r.pipeline=c}return r.pipeline}},{key:"delete",value:function(e){var t=this.get(e).pipeline;return t&&(t.usedTimes--,0===t.usedTimes&&this._releasePipeline(t),t.isComputePipeline?(t.computeProgram.usedTimes--,0===t.computeProgram.usedTimes&&this._releaseProgram(t.computeProgram)):(t.fragmentProgram.usedTimes--,t.vertexProgram.usedTimes--,0===t.vertexProgram.usedTimes&&this._releaseProgram(t.vertexProgram),0===t.fragmentProgram.usedTimes&&this._releaseProgram(t.fragmentProgram))),ht(m(n.prototype),"delete",this).call(this,e)}},{key:"dispose",value:function(){ht(m(n.prototype),"dispose",this).call(this),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}},{key:"updateForRender",value:function(e){this.getForRender(e)}},{key:"_getComputePipeline",value:function(e,t,n,r){n=n||this._getComputeCacheKey(e,t);var i=this.caches.get(n);return void 0===i&&(i=new hI(n,t),this.caches.set(n,i),this.backend.createComputePipeline(i,r)),i}},{key:"_getRenderPipeline",value:function(e,t,n,r,i){r=r||this._getRenderCacheKey(e,t,n);var a=this.caches.get(r);return void 0===a&&(a=new cI(r,t,n),this.caches.set(r,a),e.pipeline=a,this.backend.createRenderPipeline(e,i)),a}},{key:"_getComputeCacheKey",value:function(e,t){return e.id+","+t.id}},{key:"_getRenderCacheKey",value:function(e,t,n){return t.id+","+n.id+","+this.backend.getRenderCacheKey(e)}},{key:"_releasePipeline",value:function(e){this.caches.delete(e.cacheKey)}},{key:"_releaseProgram",value:function(e){var t=e.code,n=e.stage;this.programs[n].delete(t)}},{key:"_needsComputeUpdate",value:function(e){var t=this.get(e);return void 0===t.pipeline||t.version!==e.version}},{key:"_needsRenderUpdate",value:function(e){return void 0===this.get(e).pipeline||this.backend.needsRenderUpdate(e)}}]),n}(JN),AI=function(e){v(n,e);var t=b(n);function n(e,r,i,a,o,s){var u;return c(this,n),(u=t.call(this)).backend=e,u.textures=i,u.pipelines=o,u.attributes=a,u.nodes=r,u.info=s,u.pipelines.bindings=y(u),u}return p(n,[{key:"getForRender",value:function(e){var t,n=e.getBindings(),r=k(n);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=this.get(i);void 0===a.bindGroup&&(this._init(i),this.backend.createBindings(i,n,0),a.bindGroup=i)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getForCompute",value:function(e){var t,n=this.nodes.getForCompute(e).bindings,r=k(n);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=this.get(i);void 0===a.bindGroup&&(this._init(i),this.backend.createBindings(i,n,0),a.bindGroup=i)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"updateForCompute",value:function(e){this._updateBindings(this.getForCompute(e))}},{key:"updateForRender",value:function(e){this._updateBindings(this.getForRender(e))}},{key:"_updateBindings",value:function(e){var t,n=k(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this._update(r,e)}}catch(i){n.e(i)}finally{n.f()}}},{key:"_init",value:function(e){var t,n=k(e.bindings);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.isSampledTexture)this.textures.updateTexture(r.texture);else if(r.isStorageBuffer){var i=r.attribute,a=i.isIndirectStorageBufferAttribute?nI:tI;this.attributes.update(i,a)}}}catch(o){n.e(o)}finally{n.f()}}},{key:"_update",value:function(e,t){var n,r=this.backend,i=!1,a=!0,o=0,s=0,u=k(e.bindings);try{for(u.s();!(n=u.n()).done;){var l=n.value;if(l.isNodeUniformsGroup)if(!1===this.nodes.updateGroup(l))continue;if(l.isStorageBuffer){var c=l.attribute,h=c.isIndirectStorageBufferAttribute?nI:tI;this.attributes.update(c,h)}if(l.isUniformBuffer)l.update()&&r.updateBinding(l);else if(l.isSampler)l.update();else if(l.isSampledTexture){var f=this.textures.get(l.texture);l.needsBindingsUpdate(f.generation)&&(i=!0);var d=l.update(),p=l.texture;d&&this.textures.updateTexture(p);var A=r.get(p);if(void 0!==A.externalTexture||f.isDefaultTexture?a=!1:(o=10*o+p.id,s+=p.version),!0===r.isWebGPUBackend&&void 0===A.texture&&void 0===A.externalTexture&&(console.error("Bindings._update: binding should be available:",l,d,p,l.textureNode.value,i),this.textures.updateTexture(p),i=!0),!0===p.isStorageTexture){var v=this.get(p);!0===l.store?v.needsMipmap=!0:this.textures.needsMipmaps(p)&&!0===v.needsMipmap&&(this.backend.generateMipmaps(p),v.needsMipmap=!1)}}}}catch(m){u.e(m)}finally{u.f()}!0===i&&this.backend.updateBindings(e,t,a?o:0,s)}}]),n}(JN);function vI(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function mI(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function gI(e){return(e.transmission>0||e.transmissionNode)&&2===e.side&&!1===e.forceSinglePass}var yI=function(){function e(t,n,r){c(this,e),this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=t.getNode(n,r),this.lightsArray=[],this.scene=n,this.camera=r,this.occlusionQueryCount=0}return p(e,[{key:"begin",value:function(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}},{key:"getNextRenderItem",value:function(e,t,n,r,i,a,o){var s=this.renderItems[this.renderItemsIndex];return void 0===s?(s={id:e.id,object:e,geometry:t,material:n,groupOrder:r,renderOrder:e.renderOrder,z:i,group:a,clippingContext:o},this.renderItems[this.renderItemsIndex]=s):(s.id=e.id,s.object=e,s.geometry=t,s.material=n,s.groupOrder=r,s.renderOrder=e.renderOrder,s.z=i,s.group=a,s.clippingContext=o),this.renderItemsIndex++,s}},{key:"push",value:function(e,t,n,r,i,a,o){var s=this.getNextRenderItem(e,t,n,r,i,a,o);!0===e.occlusionTest&&this.occlusionQueryCount++,!0===n.transparent||n.transmission>0?(gI(n)&&this.transparentDoublePass.push(s),this.transparent.push(s)):this.opaque.push(s)}},{key:"unshift",value:function(e,t,n,r,i,a,o){var s=this.getNextRenderItem(e,t,n,r,i,a,o);!0===n.transparent||n.transmission>0?(gI(n)&&this.transparentDoublePass.unshift(s),this.transparent.unshift(s)):this.opaque.unshift(s)}},{key:"pushBundle",value:function(e){this.bundles.push(e)}},{key:"pushLight",value:function(e){this.lightsArray.push(e)}},{key:"sort",value:function(e,t){this.opaque.length>1&&this.opaque.sort(e||vI),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(t||mI),this.transparent.length>1&&this.transparent.sort(t||mI)}},{key:"finish",value:function(){this.lightsNode.setLights(this.lightsArray);for(var e=this.renderItemsIndex,t=this.renderItems.length;e<t;e++){var n=this.renderItems[e];if(null===n.id)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.groupOrder=null,n.renderOrder=null,n.z=null,n.group=null,n.clippingContext=null}}}]),e}(),_I=[],bI=function(){function e(t){c(this,e),this.lighting=t,this.lists=new XN}return p(e,[{key:"get",value:function(e,t){var n=this.lists;_I[0]=e,_I[1]=t;var r=n.get(_I);return void 0===r&&(r=new yI(this.lighting,e,t),n.set(_I,r)),_I.length=0,r}},{key:"dispose",value:function(){this.lists=new XN}}]),e}(),xI=0,wI=function(){function e(){c(this,e),this.id=xI++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new Gr,this.scissor=!1,this.scissorValue=new Gr,this.renderTarget=null,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.activeMipmapLevel=0,this.sampleCount=1,this.width=0,this.height=0,this.occlusionQueryCount=0,this.clippingContext=null,this.isRenderContext=!0}return p(e,[{key:"getCacheKey",value:function(){return TI(this)}}]),e}();function TI(e){var t,n=e.textures,r=[e.activeCubeFace],i=k(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;r.push(a.id)}}catch(o){i.e(o)}finally{i.f()}return z_(r)}var SI=[],EI=new bo,kI=new uo,MI=function(){function e(){c(this,e),this.chainMaps={}}return p(e,[{key:"get",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(SI[0]=e,SI[1]=t,null===r)n="default";else{var i=r.texture.format,a=r.textures.length;n="".concat(a,":").concat(i,":").concat(r.samples,":").concat(r.depthBuffer,":").concat(r.stencilBuffer)}var o=this._getChainMap(n),s=o.get(SI);return void 0===s&&(s=new wI,o.set(SI,s)),SI.length=0,null!==r&&(s.sampleCount=0===r.samples?1:r.samples),s}},{key:"getForClear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.get(EI,kI,e)}},{key:"_getChainMap",value:function(e){return this.chainMaps[e]||(this.chainMaps[e]=new XN)}},{key:"dispose",value:function(){this.chainMaps={}}}]),e}(),CI=new Kr,RI=function(e){v(n,e);var t=b(n);function n(e,r,i){var a;return c(this,n),(a=t.call(this)).renderer=e,a.backend=r,a.info=i,a}return p(n,[{key:"updateRenderTarget",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.get(e),i=0===e.samples?1:e.samples,a=r.depthTextureMips||(r.depthTextureMips={}),o=e.textures,s=this.getSize(o[0]),u=s.width>>n,l=s.height>>n,c=e.depthTexture||a[n],h=!0===e.depthBuffer||!0===e.stencilBuffer,f=!1;void 0===c&&h&&((c=new ns).format=e.stencilBuffer?an:rn,c.type=e.stencilBuffer?Kt:Ht,c.image.width=u,c.image.height=l,a[n]=c),r.width===s.width&&s.height===r.height||(f=!0,c&&(c.needsUpdate=!0,c.image.width=u,c.image.height=l)),r.width=s.width,r.height=s.height,r.textures=o,r.depthTexture=c||null,r.depth=e.depthBuffer,r.stencil=e.stencilBuffer,r.renderTarget=e,r.sampleCount!==i&&(f=!0,c&&(c.needsUpdate=!0),r.sampleCount=i);var d={sampleCount:i};if(!0!==e.isXRRenderTarget){for(var p=0;p<o.length;p++){var A=o[p];f&&(A.needsUpdate=!0),this.updateTexture(A,d)}c&&this.updateTexture(c,d)}if(!0!==r.initialized){r.initialized=!0;var v=function n(){e.removeEventListener("dispose",n);for(var r=0;r<o.length;r++)t._destroyTexture(o[r]);c&&t._destroyTexture(c),t.delete(e)};e.addEventListener("dispose",v)}}},{key:"updateTexture",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.get(e);if(!0!==r.initialized||r.version!==e.version){var i=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,a=this.backend;if(i&&!0===r.initialized&&(a.destroySampler(e),a.destroyTexture(e)),e.isFramebufferTexture){var o=this.renderer.getRenderTarget();e.type=o?o.texture.type:zt}var s=this.getSize(e),u=s.width,l=s.height,c=s.depth;if(n.width=u,n.height=l,n.depth=c,n.needsMipmaps=this.needsMipmaps(e),n.levels=n.needsMipmaps?this.getMipLevels(e,u,l):1,i||!0===e.isStorageTexture)a.createSampler(e),a.createTexture(e,n),r.generation=e.version;else{var h=!0!==r.initialized;if(h&&a.createSampler(e),e.version>0){var f=e.image;if(void 0===f)console.warn("THREE.Renderer: Texture marked for update but image is undefined.");else if(!1===f.complete)console.warn("THREE.Renderer: Texture marked for update but image is incomplete.");else{if(e.images){var d,p=[],A=k(e.images);try{for(A.s();!(d=A.n()).done;){var v=d.value;p.push(v)}}catch(g){A.e(g)}finally{A.f()}n.images=p}else n.image=f;void 0!==r.isDefaultTexture&&!0!==r.isDefaultTexture||(a.createTexture(e,n),r.isDefaultTexture=!1,r.generation=e.version),!0===e.source.dataReady&&a.updateTexture(e,n),n.needsMipmaps&&0===e.mipmaps.length&&a.generateMipmaps(e)}}else a.createDefaultTexture(e),r.isDefaultTexture=!0,r.generation=e.version}if(!0!==r.initialized){r.initialized=!0,r.generation=e.version,this.info.memory.textures++;var m=function n(){e.removeEventListener("dispose",n),t._destroyTexture(e),t.info.memory.textures--};e.addEventListener("dispose",m)}r.version=e.version}}},{key:"getSize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:CI,n=e.images?e.images[0]:e.image;return n?(void 0!==n.image&&(n=n.image),t.width=n.width||1,t.height=n.height||1,t.depth=e.isCubeTexture?6:n.depth||1):t.width=t.height=t.depth=1,t}},{key:"getMipLevels",value:function(e,t,n){return e.isCompressedTexture?e.mipmaps?e.mipmaps.length:1:Math.floor(Math.log2(Math.max(t,n)))+1}},{key:"needsMipmaps",value:function(e){return this.isEnvironmentTexture(e)||!0===e.isCompressedTexture||e.generateMipmaps}},{key:"isEnvironmentTexture",value:function(e){var t=e.mapping;return t===Mt||t===Ct||t===Et||t===kt}},{key:"_destroyTexture",value:function(e){this.backend.destroySampler(e),this.backend.destroyTexture(e),this.delete(e)}}]),n}(JN),PI=function(e){v(n,e);var t=b(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return c(this,n),(a=t.call(this,e,r,i)).a=o,a}return p(n,[{key:"set",value:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return this.a=i,ht(m(n.prototype),"set",this).call(this,e,t,r)}},{key:"copy",value:function(e){return void 0!==e.a&&(this.a=e.a),ht(m(n.prototype),"copy",this).call(this,e)}},{key:"clone",value:function(){return new this.constructor(this.r,this.g,this.b,this.a)}}]),n}(ga),NI=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this,e,i)).isParameterNode=!0,r}return p(n,[{key:"getHash",value:function(){return this.uuid}},{key:"generate",value:function(){return this.name}}],[{key:"type",get:function(){return"ParameterNode"}}]),n}($x),II=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return c(this,n),(e=t.call(this)).nodes=[],e.outputNode=null,e.parent=r,e._currentCond=null,e.isStackNode=!0,e}return p(n,[{key:"getNodeType",value:function(e){return this.outputNode?this.outputNode.getNodeType(e):"void"}},{key:"getMemberType",value:function(e,t){return this.outputNode?this.outputNode.getMemberType(e,t):"void"}},{key:"add",value:function(e){return this.nodes.push(e),this}},{key:"If",value:function(e,t){var n=new lx(t);return this._currentCond=mS(e,n),this.add(this._currentCond)}},{key:"ElseIf",value:function(e,t){var n=new lx(t),r=mS(e,n);return this._currentCond.elseNode=r,this._currentCond=r,this}},{key:"Else",value:function(e){return this._currentCond.elseNode=new lx(e),this}},{key:"build",value:function(e){var t,r,i=gx();mx(this);var a,o=k(this.nodes);try{for(o.s();!(a=o.n()).done;){var s=a.value;s.build(e,"void")}}catch(h){o.e(h)}finally{o.f()}mx(i);for(var u=arguments.length,l=new Array(u>1?u-1:0),c=1;c<u;c++)l[c-1]=arguments[c];return this.outputNode?(t=this.outputNode).build.apply(t,[e].concat(l)):(r=ht(m(n.prototype),"build",this)).call.apply(r,[this,e].concat(l))}},{key:"else",value:function(){return console.warn("THREE.TSL: .else() has been renamed to .Else()."),this.Else.apply(this,arguments)}},{key:"elseif",value:function(){return console.warn("THREE.TSL: .elseif() has been renamed to .ElseIf()."),this.ElseIf.apply(this,arguments)}}],[{key:"type",get:function(){return"StackNode"}}]),n}(ub),LI=dx(II).setParameterLength(0,1);function DI(e){return Object.entries(e).map((function(e){var t=T(e,2),n=t[0],r=t[1];return"string"===typeof r?{name:n,type:r,atomic:!1}:{name:n,type:r.type,atomic:r.atomic||!1}}))}var OI=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this,"struct")).membersLayout=DI(e),r.name=i,r.isStructLayoutNode=!0,r}return p(n,[{key:"getLength",value:function(){var e,t=0,n=k(this.membersLayout);try{for(n.s();!(e=n.n()).done;){t+=Q_(e.value.type)}}catch(r){n.e(r)}finally{n.f()}return t}},{key:"getMemberType",value:function(e,t){var n=this.membersLayout.find((function(e){return e.name===t}));return n?n.type:"void"}},{key:"getNodeType",value:function(e){return e.getStructTypeFromNode(this,this.membersLayout,this.name).name}},{key:"setup",value:function(e){e.addInclude(this)}},{key:"generate",value:function(e){return this.getNodeType(e)}}],[{key:"type",get:function(){return"StructTypeNode"}}]),n}(ub),UI=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,"vec3")).structLayoutNode=e,i.values=r,i.isStructNode=!0,i}return p(n,[{key:"getNodeType",value:function(e){return this.structLayoutNode.getNodeType(e)}},{key:"getMemberType",value:function(e,t){return this.structLayoutNode.getMemberType(e,t)}},{key:"generate",value:function(e){var t=e.getVarFromNode(this),n=t.type,r=e.getPropertyName(t);return e.addLineFlowCode("".concat(r," = ").concat(e.generateStruct(n,this.structLayoutNode.membersLayout,this.values)),this),t.name}}],[{key:"type",get:function(){return"StructNode"}}]),n}(ub),BI=function(e){v(n,e);var t=b(n);function n(){var e;c(this,n),e=t.call(this);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e.members=i,e.isOutputStructNode=!0,e}return p(n,[{key:"getNodeType",value:function(e){var t=e.getNodeProperties(this);if(void 0===t.membersLayout){for(var n=this.members,r=[],i=0;i<n.length;i++){var a="m"+i,o=n[i].getNodeType(e);r.push({name:a,type:o,index:i})}t.membersLayout=r,t.structType=e.getOutputStructTypeFromNode(this,t.membersLayout)}return t.structType.name}},{key:"generate",value:function(e){for(var t=e.getOutputStructName(),n=this.members,r=""!==t?t+".":"",i=0;i<n.length;i++){var a=n[i].build(e);e.addLineFlowCode("".concat(r,"m").concat(i," = ").concat(a),this)}return t}}],[{key:"type",get:function(){return"OutputStructNode"}}]),n}(ub),FI=dx(BI);function zI(e,t){for(var n=0;n<e.length;n++)if(e[n].name===t)return n;return-1}var VI=dx(function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).outputNodes=e,r.isMRTNode=!0,r}return p(n,[{key:"has",value:function(e){return void 0!==this.outputNodes[e]}},{key:"get",value:function(e){return this.outputNodes[e]}},{key:"merge",value:function(e){var t=Qe(Qe({},this.outputNodes),e.outputNodes);return VI(t)}},{key:"setup",value:function(e){var t=this.outputNodes,r=[],i=e.renderer.getRenderTarget().textures;for(var a in t){r[zI(i,a)]=Lx(t[a])}return this.members=r,ht(m(n.prototype),"setup",this).call(this,e)}}],[{key:"type",get:function(){return"MRTNode"}}]),n}(BI)),qI=vx((function(e){var t=T(e,1)[0].toUint().mul(747796405).add(2891336453),n=t.shiftRight(t.shiftRight(28).add(4)).bitXor(t).mul(277803737);return n.shiftRight(22).bitXor(n).toFloat().mul(1/Math.pow(2,32))})),jI=function(e,t){return ZT(Uw(4,e.mul(Ow(1,e))),t)},GI=vx((function(e){return T(e,1)[0].fract().sub(.5).abs()})).setLayout({name:"tri",type:"float",inputs:[{name:"x",type:"float"}]}),HI=vx((function(e){var t=T(e,1)[0];return Rx(GI(t.z.add(GI(t.y.mul(1)))),GI(t.z.add(GI(t.x.mul(1)))),GI(t.y.add(GI(t.x.mul(1)))))})).setLayout({name:"tri3",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),WI=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=Rx(n).toVar(),o=xx(1.4).toVar(),s=xx(0).toVar(),u=Rx(a).toVar();return vC({start:xx(0),end:xx(3),type:"float",condition:"<="},(function(){var e=Rx(HI(u.mul(2))).toVar();a.addAssign(e.add(i.mul(xx(.1).mul(r)))),u.mulAssign(1.8),o.mulAssign(1.5),a.mulAssign(1.2);var t=xx(GI(a.z.add(GI(a.x.add(GI(a.y)))))).toVar();s.addAssign(t.div(o)),u.addAssign(.14)})),s})).setLayout({name:"triNoise3D",type:"float",inputs:[{name:"position",type:"vec3"},{name:"speed",type:"float"},{name:"time",type:"float"}]}),XI=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];c(this,n),(e=t.call(this)).functionNodes=r;for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];return e.parametersNodes=a,e._candidateFnCall=null,e.global=!0,e}return p(n,[{key:"getNodeType",value:function(){return this.functionNodes[0].shaderNode.layout.type}},{key:"setup",value:function(e){var t=this.parametersNodes,n=this._candidateFnCall;if(null===n){var r,i=null,a=-1,o=k(this.functionNodes);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=s.shaderNode.layout;if(null===u)throw new Error("FunctionOverloadingNode: FunctionNode must be a layout.");var c=u.inputs;if(t.length===c.length){for(var h=0,f=0;f<t.length;f++){var d=t[f],p=c[f];d.getNodeType(e)===p.type?h++:h=0}h>a&&(i=s,a=h)}}}catch(A){o.e(A)}finally{o.f()}this._candidateFnCall=n=i.apply(void 0,l(t))}return n}}],[{key:"type",get:function(){return"FunctionOverloadingNode"}}]),n}(ub),QI=dx(XI),YI=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return QI.apply(void 0,[e].concat(n))}},KI=Jx(0).setGroup(Yx).onRenderUpdate((function(e){return e.time})),ZI=Jx(0).setGroup(Yx).onRenderUpdate((function(e){return e.deltaTime})),JI=Jx(0,"uint").setGroup(Yx).onRenderUpdate((function(e){return e.frameId})),$I=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=void 0===i?Ex(.5):i;return BN(n.sub(a),r).add(a)})),eL=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=void 0===i?Ex(.5):i,o=n.sub(a),s=o.dot(o),u=s.mul(s).mul(r);return n.add(o.mul(u))})),tL=vx((function(e){var t,n=e.position,r=void 0===n?null:n,i=e.horizontal,a=void 0===i||i,o=e.vertical,s=void 0!==o&&o;null!==r?((t=WE.toVar())[3][0]=r.x,t[3][1]=r.y,t[3][2]=r.z):t=WE;var u=NE.mul(t);return sx(a)&&(u[0][0]=WE[0].length(),u[0][1]=0,u[0][2]=0),sx(s)&&(u[1][0]=0,u[1][1]=WE[1].length(),u[1][2]=0),u[2][0]=0,u[2][1]=0,u[2][2]=1,RE.mul(u).mul(ik)})),nL=vx((function(e){var t=T(e,1)[0],n=void 0===t?null:t,r=tR();return tR(XC(n)).sub(r).lessThan(0).select(PC,n)})),rL=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pE(),a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xx(0);return c(this,n),(r=t.call(this,"vec2")).countNode=e,r.uvNode=i,r.frameNode=a,r}return p(n,[{key:"setup",value:function(){var e=this.frameNode,t=this.uvNode,n=this.countNode,r=n.width,i=n.height,a=e.mod(r.mul(i)).floor(),o=a.mod(r),s=i.sub(a.add(1).div(r).ceil()),u=n.reciprocal(),l=Ex(o,s);return t.add(l).mul(u)}}],[{key:"type",get:function(){return"SpriteSheetUVNode"}}]),n}(ub),iL=dx(rL).setParameterLength(3),aL=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:xx(1),s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ik,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:dk;return c(this,n),(r=t.call(this,"vec4")).textureXNode=e,r.textureYNode=i,r.textureZNode=a,r.scaleNode=o,r.positionNode=s,r.normalNode=u,r}return p(n,[{key:"setup",value:function(){var e=this.textureXNode,t=this.textureYNode,n=this.textureZNode,r=this.scaleNode,i=this.positionNode,a=this.normalNode.abs().normalize();a=a.div(a.dot(Rx(1)));var o=i.yz.mul(r),s=i.zx.mul(r),u=i.xy.mul(r),l=e.value,c=null!==t?t.value:l,h=null!==n?n.value:l,f=_E(l,o).mul(a.x),d=_E(c,s).mul(a.y),p=_E(h,u).mul(a.z);return Dw(f,d,p)}}],[{key:"type",get:function(){return"TriplanarTexturesNode"}}]),n}(ub),oL=dx(aL).setParameterLength(1,6),sL=new Po,uL=new Kr,lL=new Kr,cL=new Kr,hL=new Ei,fL=new Kr(0,0,-1),dL=new Gr,pL=new Kr,AL=new Kr,vL=new Gr,mL=new _r,gL=new Hr,yL=PC.flipX();gL.depthTexture=new ns(1,1);var _L=!1,bL=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c(this,n),(e=t.call(this,r.defaultTexture||gL.texture,yL))._reflectorBaseNode=r.reflector||new xL(y(e),r),e._depthNode=null,e.setUpdateMatrix(!1),e}return p(n,[{key:"reflector",get:function(){return this._reflectorBaseNode}},{key:"target",get:function(){return this._reflectorBaseNode.target}},{key:"getDepthNode",value:function(){if(null===this._depthNode){if(!0!==this._reflectorBaseNode.depth)throw new Error("THREE.ReflectorNode: Depth node can only be requested when the reflector is created with { depth: true }. ");this._depthNode=cx(new n({defaultTexture:gL.depthTexture,reflector:this._reflectorBaseNode}))}return this._depthNode}},{key:"setup",value:function(e){return e.object.isQuadMesh||this._reflectorBaseNode.build(e),ht(m(n.prototype),"setup",this).call(this,e)}},{key:"clone",value:function(){var e=new this.constructor(this.reflectorNode);return e._reflectorBaseNode=this._reflectorBaseNode,e}}],[{key:"type",get:function(){return"ReflectorNode"}}]),n}(yE),xL=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};c(this,n),r=t.call(this);var a=i.target,o=void 0===a?new $i:a,s=i.resolution,u=void 0===s?1:s,l=i.generateMipmaps,h=void 0!==l&&l,f=i.bounces,d=void 0===f||f,p=i.depth,A=void 0!==p&&p;return r.textureNode=e,r.target=o,r.resolution=u,r.generateMipmaps=h,r.bounces=d,r.depth=A,r.updateBeforeType=d?tb.RENDER:tb.FRAME,r.virtualCameras=new WeakMap,r.renderTargets=new WeakMap,r.forceUpdate=!1,r}return p(n,[{key:"_updateResolution",value:function(e,t){var n=this.resolution;t.getDrawingBufferSize(mL),e.setSize(Math.round(mL.width*n),Math.round(mL.height*n))}},{key:"setup",value:function(e){return this._updateResolution(gL,e.renderer),ht(m(n.prototype),"setup",this).call(this,e)}},{key:"getVirtualCamera",value:function(e){var t=this.virtualCameras.get(e);return void 0===t&&(t=e.clone(),this.virtualCameras.set(e,t)),t}},{key:"getRenderTarget",value:function(e){var t=this.renderTargets.get(e);return void 0===t&&(t=new Hr(0,0,{type:Xt}),!0===this.generateMipmaps&&(t.texture.minFilter=1008,t.texture.generateMipmaps=!0),!0===this.depth&&(t.depthTexture=new ns),this.renderTargets.set(e,t)),t}},{key:"updateBefore",value:function(e){if(!1===this.bounces&&_L)return!1;_L=!0;var t=e.scene,n=e.camera,r=e.renderer,i=e.material,a=this.target,o=this.getVirtualCamera(n),s=this.getRenderTarget(o);if(r.getDrawingBufferSize(mL),this._updateResolution(s,r),lL.setFromMatrixPosition(a.matrixWorld),cL.setFromMatrixPosition(n.matrixWorld),hL.extractRotation(a.matrixWorld),uL.set(0,0,1),uL.applyMatrix4(hL),pL.subVectors(lL,cL),!0!==pL.dot(uL)>0||!1!==this.forceUpdate){pL.reflect(uL).negate(),pL.add(lL),hL.extractRotation(n.matrixWorld),fL.set(0,0,-1),fL.applyMatrix4(hL),fL.add(cL),AL.subVectors(lL,fL),AL.reflect(uL).negate(),AL.add(lL),o.coordinateSystem=n.coordinateSystem,o.position.copy(pL),o.up.set(0,1,0),o.up.applyMatrix4(hL),o.up.reflect(uL),o.lookAt(AL),o.near=n.near,o.far=n.far,o.updateMatrixWorld(),o.projectionMatrix.copy(n.projectionMatrix),sL.setFromNormalAndCoplanarPoint(uL,lL),sL.applyMatrix4(o.matrixWorldInverse),dL.set(sL.normal.x,sL.normal.y,sL.normal.z,sL.constant);var u=o.projectionMatrix;vL.x=(Math.sign(dL.x)+u.elements[8])/u.elements[0],vL.y=(Math.sign(dL.y)+u.elements[9])/u.elements[5],vL.z=-1,vL.w=(1+u.elements[10])/u.elements[14],dL.multiplyScalar(1/dL.dot(vL));u.elements[2]=dL.x,u.elements[6]=dL.y,u.elements[10]=r.coordinateSystem===sr?dL.z-0:dL.z+1-0,u.elements[14]=dL.w,this.textureNode.value=s.texture,!0===this.depth&&(this.textureNode.getDepthNode().value=s.depthTexture),i.visible=!1;var l=r.getRenderTarget(),c=r.getMRT(),h=r.autoClear;r.setMRT(null),r.setRenderTarget(s),r.autoClear=!0,r.render(t,o),r.setMRT(c),r.setRenderTarget(l),r.autoClear=h,i.visible=!0,_L=!1,this.forceUpdate=!1}}}],[{key:"type",get:function(){return"ReflectorBaseNode"}}]),n}(ub),wL=new nl(-1,1,1,-1,0,1),TL=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];c(this,n);var i=!1===r?[0,-1,0,1,2,1]:[0,2,0,0,2,0];return(e=t.call(this)).setAttribute("position",new La([-1,3,0,-1,-1,0,3,-1,0],3)),e.setAttribute("uv",new La(i,2)),e}return p(n)}(qa),SL=new TL,EL=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return c(this,n),(e=t.call(this,SL,r)).camera=wL,e.isQuadMesh=!0,e}return p(n,[{key:"renderAsync",value:function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.renderAsync(this,wL));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(e){e.render(this,wL)}}]),n}(eo),kL=new _r,ML=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{type:Xt};c(this,n);var s=new Hr(i,a,o);return(r=t.call(this,s.texture,pE())).node=e,r.width=i,r.height=a,r.pixelRatio=1,r.renderTarget=s,r.textureNeedsUpdate=!0,r.autoUpdate=!0,r._rttNode=null,r._quadMesh=new EL(new uR),r.updateBeforeType=tb.RENDER,r}return p(n,[{key:"autoSize",get:function(){return null===this.width}},{key:"setup",value:function(e){return this._rttNode=this.node.context(e.getSharedContext()),this._quadMesh.material.name="RTT",this._quadMesh.material.needsUpdate=!0,ht(m(n.prototype),"setup",this).call(this,e)}},{key:"setSize",value:function(e,t){this.width=e,this.height=t;var n=e*this.pixelRatio,r=t*this.pixelRatio;this.renderTarget.setSize(n,r),this.textureNeedsUpdate=!0}},{key:"setPixelRatio",value:function(e){this.pixelRatio=e,this.setSize(this.width,this.height)}},{key:"updateBefore",value:function(e){var t=e.renderer;if(!1!==this.textureNeedsUpdate||!1!==this.autoUpdate){if(this.textureNeedsUpdate=!1,!0===this.autoSize){this.pixelRatio=t.getPixelRatio();var n=t.getSize(kL);this.setSize(n.width,n.height)}this._quadMesh.material.fragmentNode=this._rttNode;var r=t.getRenderTarget();t.setRenderTarget(this.renderTarget),this._quadMesh.render(t),t.setRenderTarget(r)}}},{key:"clone",value:function(){var e=new yE(this.value,this.uvNode,this.levelNode);return e.sampler=this.sampler,e.referenceNode=this,e}}],[{key:"type",get:function(){return"RTTNode"}}]),n}(yE),CL=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return cx(S(ML,[cx(e)].concat(n)))},RL=vx((function(e,t){var n,r=T(e,3),i=r[0],a=r[1],o=r[2];t.renderer.coordinateSystem===sr?(i=Ex(i.x,i.y.oneMinus()).mul(2).sub(1),n=Lx(Rx(i,a),1)):n=Lx(Rx(i.x,i.y.oneMinus(),a).mul(2).sub(1),1);var s=Lx(o.mul(n));return s.xyz.div(s.w)})),PL=vx((function(e){var t=T(e,2),n=t[0],r=t[1].mul(Lx(n,1)),i=r.xy.div(r.w).mul(.5).add(.5).toVar();return Ex(i.x,i.y.oneMinus())})),NL=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=vE(bE(r)),o=kx(n.mul(a)).toVar(),s=bE(r,o).toVar(),u=bE(r,o.sub(kx(2,0))).toVar(),l=bE(r,o.sub(kx(1,0))).toVar(),c=bE(r,o.add(kx(1,0))).toVar(),h=bE(r,o.add(kx(2,0))).toVar(),f=bE(r,o.add(kx(0,2))).toVar(),d=bE(r,o.add(kx(0,1))).toVar(),p=bE(r,o.sub(kx(0,1))).toVar(),A=bE(r,o.sub(kx(0,2))).toVar(),v=CT(Ow(xx(2).mul(l).sub(u),s)).toVar(),m=CT(Ow(xx(2).mul(c).sub(h),s)).toVar(),g=CT(Ow(xx(2).mul(d).sub(f),s)).toVar(),y=CT(Ow(xx(2).mul(p).sub(A),s)).toVar(),_=RL(n,s,i).toVar(),b=v.lessThan(m).select(_.sub(RL(n.sub(Ex(xx(1).div(a.x),0)),l,i)),_.negate().add(RL(n.add(Ex(xx(1).div(a.x),0)),c,i))),x=g.lessThan(y).select(_.sub(RL(n.add(Ex(0,xx(1).div(a.y))),d,i)),_.negate().add(RL(n.sub(Ex(0,xx(1).div(a.y))),p,i)));return bT(KT(b,x))})),IL=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float32Array;c(this,n);var o=ArrayBuffer.isView(e)?e:new a(e*r);return(i=t.call(this,o,r)).isStorageInstancedBufferAttribute=!0,i}return p(n)}(ko),LL=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float32Array;c(this,n);var o=ArrayBuffer.isView(e)?e:new a(e*r);return(i=t.call(this,o,r)).isStorageBufferAttribute=!0,i}return p(n)}(Ra),DL=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return c(this,n),(e=t.call(this,null,"vec4")).isVertexColorNode=!0,e.index=r,e}return p(n,[{key:"getAttributeName",value:function(){var e=this.index;return"color"+(e>0?e:"")}},{key:"generate",value:function(e){var t=this.getAttributeName(e);return!0===e.hasGeometryAttribute(t)?ht(m(n.prototype),"generate",this).call(this,e):e.generateConst(this.nodeType,new Gr(1,1,1,1))}},{key:"serialize",value:function(e){ht(m(n.prototype),"serialize",this).call(this,e),e.index=this.index}},{key:"deserialize",value:function(e){ht(m(n.prototype),"deserialize",this).call(this,e),this.index=e.index}}],[{key:"type",get:function(){return"VertexColorNode"}}]),n}(fE),OL=px(function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this,"vec2")).isPointUVNode=!0,e}return p(n,[{key:"generate",value:function(){return"vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y )"}}],[{key:"type",get:function(){return"PointUVNode"}}]),n}(ub)),UL=new Oi,BL=new Ei,FL=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.BACKGROUND_BLURRINESS,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(e=t.call(this)).scope=r,e.scene=i,e}return p(n,[{key:"setup",value:function(e){var t,r=this.scope,i=null!==this.scene?this.scene:e.scene;return r===n.BACKGROUND_BLURRINESS?t=Dk("backgroundBlurriness","float",i):r===n.BACKGROUND_INTENSITY?t=Dk("backgroundIntensity","float",i):r===n.BACKGROUND_ROTATION?t=Jx("mat4").label("backgroundRotation").setGroup(Yx).onRenderUpdate((function(){var e=i.background;return null!==e&&e.isTexture&&e.mapping!==St?(UL.copy(i.backgroundRotation),UL.x*=-1,UL.y*=-1,UL.z*=-1,BL.makeRotationFromEuler(UL)):BL.identity(),BL})):console.error("THREE.SceneNode: Unknown scope:",r),t}}],[{key:"type",get:function(){return"SceneNode"}}]),n}(ub);FL.BACKGROUND_BLURRINESS="backgroundBlurriness",FL.BACKGROUND_INTENSITY="backgroundIntensity",FL.BACKGROUND_ROTATION="backgroundRotation";var zL=px(FL,FL.BACKGROUND_BLURRINESS),VL=px(FL,FL.BACKGROUND_INTENSITY),qL=px(FL,FL.BACKGROUND_ROTATION),jL=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return c(this,n),(i=t.call(this,e,r)).storeNode=a,i.isStorageTextureNode=!0,i.access=nb.WRITE_ONLY,i}return p(n,[{key:"getInputType",value:function(){return"storageTexture"}},{key:"setup",value:function(e){ht(m(n.prototype),"setup",this).call(this,e),e.getNodeProperties(this).storeNode=this.storeNode}},{key:"setAccess",value:function(e){return this.access=e,this}},{key:"generate",value:function(e,t){return null!==this.storeNode?this.generateStore(e):ht(m(n.prototype),"generate",this).call(this,e,t)}},{key:"toReadWrite",value:function(){return this.setAccess(nb.READ_WRITE)}},{key:"toReadOnly",value:function(){return this.setAccess(nb.READ_ONLY)}},{key:"toWriteOnly",value:function(){return this.setAccess(nb.WRITE_ONLY)}},{key:"generateStore",value:function(e){var t=e.getNodeProperties(this),r=t.uvNode,i=t.storeNode,a=ht(m(n.prototype),"generate",this).call(this,e,"property"),o=r.build(e,"uvec2"),s=i.build(e,"vec4"),u=e.generateTextureStore(e,a,o,s);e.addLineFlowCode(u,this)}}],[{key:"type",get:function(){return"StorageTextureNode"}}]),n}(yE),GL=dx(jL).setParameterLength(1,3),HL=vx((function(e){var t=e.texture,n=e.uv,r=1e-4,i=Rx().toVar();return yx(n.x.lessThan(r),(function(){i.assign(Rx(1,0,0))})).ElseIf(n.y.lessThan(r),(function(){i.assign(Rx(0,1,0))})).ElseIf(n.z.lessThan(r),(function(){i.assign(Rx(0,0,1))})).ElseIf(n.x.greaterThan(.9999),(function(){i.assign(Rx(-1,0,0))})).ElseIf(n.y.greaterThan(.9999),(function(){i.assign(Rx(0,-1,0))})).ElseIf(n.z.greaterThan(.9999),(function(){i.assign(Rx(0,0,-1))})).Else((function(){var e=.01,r=t.sample(n.add(Rx(-.01,0,0))).r.sub(t.sample(n.add(Rx(e,0,0))).r),a=t.sample(n.add(Rx(0,-.01,0))).r.sub(t.sample(n.add(Rx(0,e,0))).r),o=t.sample(n.add(Rx(0,0,-.01))).r.sub(t.sample(n.add(Rx(0,0,e))).r);i.assign(Rx(r,a,o))})),i.normalize()})),WL=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return c(this,n),(r=t.call(this,e,i,a)).isTexture3DNode=!0,r}return p(n,[{key:"getInputType",value:function(){return"texture3D"}},{key:"getDefaultUV",value:function(){return Rx(.5,.5,.5)}},{key:"setUpdateMatrix",value:function(){}},{key:"setupUV",value:function(e,t){var n=this.value;return!e.isFlipY()||!0!==n.isRenderTargetTexture&&!0!==n.isFramebufferTexture||(t=this.sampler?t.flipY():t.setY(wx(vE(this,this.levelNode).y).sub(t.y).sub(1))),t}},{key:"generateUV",value:function(e,t){return t.build(e,"vec3")}},{key:"normal",value:function(e){return HL({texture:this,uv:e})}}],[{key:"type",get:function(){return"Texture3DNode"}}]),n}(yE),XL=dx(WL).setParameterLength(1,3),QL=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return c(this,n),(i=t.call(this,e,r,a)).userData=a,i}return p(n,[{key:"updateReference",value:function(e){return this.reference=null!==this.userData?this.userData:e.object.userData,this.reference}}],[{key:"type",get:function(){return"UserDataNode"}}]),n}(Lk),YL=new WeakMap,KL=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this,"vec2")).projectionMatrix=null,e.updateType=tb.OBJECT,e.updateAfterType=tb.OBJECT,e.previousModelWorldMatrix=Jx(new Ei),e.previousProjectionMatrix=Jx(new Ei).setGroup(Yx),e.previousCameraViewMatrix=Jx(new Ei),e}return p(n,[{key:"setProjectionMatrix",value:function(e){this.projectionMatrix=e}},{key:"update",value:function(e){var t=e.frameId,n=e.camera,r=JL(e.object);this.previousModelWorldMatrix.value.copy(r);var i=ZL(n);i.frameId!==t&&(i.frameId=t,void 0===i.previousProjectionMatrix?(i.previousProjectionMatrix=new Ei,i.previousCameraViewMatrix=new Ei,i.currentProjectionMatrix=new Ei,i.currentCameraViewMatrix=new Ei,i.previousProjectionMatrix.copy(this.projectionMatrix||n.projectionMatrix),i.previousCameraViewMatrix.copy(n.matrixWorldInverse)):(i.previousProjectionMatrix.copy(i.currentProjectionMatrix),i.previousCameraViewMatrix.copy(i.currentCameraViewMatrix)),i.currentProjectionMatrix.copy(this.projectionMatrix||n.projectionMatrix),i.currentCameraViewMatrix.copy(n.matrixWorldInverse),this.previousProjectionMatrix.value.copy(i.previousProjectionMatrix),this.previousCameraViewMatrix.value.copy(i.previousCameraViewMatrix))}},{key:"updateAfter",value:function(e){var t=e.object;JL(t).copy(t.matrixWorld)}},{key:"setup",value:function(){var e=null===this.projectionMatrix?RE:Jx(this.projectionMatrix),t=this.previousCameraViewMatrix.mul(this.previousModelWorldMatrix),n=e.mul($E).mul(ik),r=this.previousProjectionMatrix.mul(t).mul(ak),i=n.xy.div(n.w),a=r.xy.div(r.w);return Ow(i,a)}}],[{key:"type",get:function(){return"VelocityNode"}}]),n}(hb);function ZL(e){var t=YL.get(e);return void 0===t&&(t={},YL.set(e,t)),t}function JL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=ZL(e),r=n[t];return void 0===r&&(n[t]=r=new Ei),r}var $L=px(KL),eD=vx((function(e){var t=T(e,2),n=t[0],r=t[1];return jT(1,n.oneMinus().div(r)).oneMinus()})).setLayout({name:"blendBurn",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),tD=vx((function(e){var t=T(e,2),n=t[0],r=t[1];return jT(n.div(r.oneMinus()),1)})).setLayout({name:"blendDodge",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),nD=vx((function(e){var t=T(e,2),n=t[0],r=t[1];return n.oneMinus().mul(r.oneMinus()).oneMinus()})).setLayout({name:"blendScreen",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),rD=vx((function(e){var t=T(e,2),n=t[0],r=t[1];return iS(n.mul(2).mul(r),n.oneMinus().mul(2).mul(r.oneMinus()).oneMinus(),HT(.5,n))})).setLayout({name:"blendOverlay",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),iD=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=r.a.add(n.a.mul(r.a.oneMinus()));return Lx(r.rgb.mul(r.a).add(n.rgb.mul(n.a).mul(r.a.oneMinus())).div(i),i)})).setLayout({name:"blendColor",type:"vec4",inputs:[{name:"base",type:"vec4"},{name:"blend",type:"vec4"}]}),aD=vx((function(e){var t=T(e,1)[0];return lD(t.rgb)})),oD=vx((function(e){var t=T(e,2),n=t[0],r=t[1];return(void 0===r?xx(1):r).mix(lD(n.rgb),n.rgb)})),sD=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=void 0===r?xx(1):r,a=Dw(n.r,n.g,n.b).div(3),o=n.r.max(n.g.max(n.b)),s=o.sub(a).mul(i).mul(-3);return iS(n.rgb,o,s)})),uD=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=void 0===r?xx(1):r,a=Rx(.57735,.57735,.57735),o=i.cos();return Rx(n.rgb.mul(o).add(a.cross(n.rgb).mul(i.sin()).add(a.mul(YT(a,n.rgb).mul(o.oneMinus())))))})),lD=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rx(Dr.getLuminanceCoefficients(new Kr));return YT(e,t)},cD=vx((function(e){var t=T(e,6),n=t[0],r=t[1],i=void 0===r?Rx(1):r,a=t[2],o=void 0===a?Rx(0):a,s=t[3],u=void 0===s?Rx(1):s,l=t[4],c=void 0===l?xx(1):l,h=t[5],f=void 0===h?Rx(Dr.getLuminanceCoefficients(new Kr,Zn)):h,d=n.rgb.dot(Rx(f)),p=GT(n.rgb.mul(i).add(o),0).toVar(),A=p.pow(u).toVar();return yx(p.r.greaterThan(0),(function(){p.r.assign(A.r)})),yx(p.g.greaterThan(0),(function(){p.g.assign(A.g)})),yx(p.b.greaterThan(0),(function(){p.b.assign(A.b)})),p.assign(d.add(p.sub(d).mul(c))),Lx(p.rgb,n.a)})),hD=dx(function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this)).sourceNode=e,i.stepsNode=r,i}return p(n,[{key:"setup",value:function(){var e=this.sourceNode,t=this.stepsNode;return e.mul(t).floor().div(t)}}],[{key:"type",get:function(){return"PosterizeNode"}}]),n}(hb)).setParameterLength(2),fD=new _r,dD=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,r)).passNode=e,i.setUpdateMatrix(!1),i}return p(n,[{key:"setup",value:function(e){return e.object.isQuadMesh&&this.passNode.build(e),ht(m(n.prototype),"setup",this).call(this,e)}},{key:"clone",value:function(){return new this.constructor(this.passNode,this.value)}}],[{key:"type",get:function(){return"PassTextureNode"}}]),n}(yE),pD=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return c(this,n),(i=t.call(this,e,null)).textureName=r,i.previousTexture=a,i}return p(n,[{key:"updateTexture",value:function(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}},{key:"setup",value:function(e){return this.updateTexture(),ht(m(n.prototype),"setup",this).call(this,e)}},{key:"clone",value:function(){return new this.constructor(this.passNode,this.textureName,this.previousTexture)}}],[{key:"type",get:function(){return"PassMultipleTextureNode"}}]),n}(dD),AD=function(e){v(n,e);var t=b(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};c(this,n),(a=t.call(this,"vec4")).scope=e,a.scene=r,a.camera=i,a.options=o,a._pixelRatio=1,a._width=1,a._height=1;var s=new ns;s.isRenderTargetTexture=!0,s.name="depth";var u=new Hr(a._width*a._pixelRatio,a._height*a._pixelRatio,Qe({type:Xt},o));return u.texture.name="output",u.depthTexture=s,a.renderTarget=u,a._textures={output:u.texture,depth:s},a._textureNodes={},a._linearDepthNodes={},a._viewZNodes={},a._previousTextures={},a._previousTextureNodes={},a._cameraNear=Jx(0),a._cameraFar=Jx(0),a._mrt=null,a._layers=null,a._resolution=1,a.isPassNode=!0,a.updateBeforeType=tb.FRAME,a}return p(n,[{key:"setResolution",value:function(e){return this._resolution=e,this}},{key:"getResolution",value:function(){return this._resolution}},{key:"setLayers",value:function(e){return this._layers=e,this}},{key:"getLayers",value:function(){return this._layers}},{key:"setMRT",value:function(e){return this._mrt=e,this}},{key:"getMRT",value:function(){return this._mrt}},{key:"isGlobal",value:function(){return!0}},{key:"getTexture",value:function(e){var t=this._textures[e];void 0===t&&((t=this.renderTarget.texture.clone()).name=e,this._textures[e]=t,this.renderTarget.textures.push(t));return t}},{key:"getPreviousTexture",value:function(e){var t=this._previousTextures[e];return void 0===t&&(t=this.getTexture(e).clone(),this._previousTextures[e]=t),t}},{key:"toggleTexture",value:function(e){var t=this._previousTextures[e];if(void 0!==t){var n=this._textures[e],r=this.renderTarget.textures.indexOf(n);this.renderTarget.textures[r]=t,this._textures[e]=t,this._previousTextures[e]=n,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}},{key:"getTextureNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"output",t=this._textureNodes[e];return void 0===t&&((t=cx(new pD(this,e))).updateTexture(),this._textureNodes[e]=t),t}},{key:"getPreviousTextureNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"output",t=this._previousTextureNodes[e];return void 0===t&&(void 0===this._textureNodes[e]&&this.getTextureNode(e),(t=cx(new pD(this,e,!0))).updateTexture(),this._previousTextureNodes[e]=t),t}},{key:"getViewZNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"depth",t=this._viewZNodes[e];if(void 0===t){var n=this._cameraNear,r=this._cameraFar;this._viewZNodes[e]=t=ZC(this.getTextureNode(e),n,r)}return t}},{key:"getLinearDepthNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"depth",t=this._linearDepthNodes[e];if(void 0===t){var n=this._cameraNear,r=this._cameraFar,i=this.getViewZNode(e);this._linearDepthNodes[e]=t=YC(i,n,r)}return t}},{key:"setup",value:function(e){var t=e.renderer;return this.renderTarget.samples=void 0===this.options.samples?t.samples:this.options.samples,!0===t.backend.isWebGLBackend&&(this.renderTarget.samples=0),this.renderTarget.texture.type=t.getColorBufferType(),this.scope===n.COLOR?this.getTextureNode():this.getLinearDepthNode()}},{key:"updateBefore",value:function(e){var t,n,r=e.renderer,i=this.scene,a=r.getOutputRenderTarget();a&&!0===a.isXRRenderTarget?(n=1,t=r.xr.getCamera(),r.xr.updateCamera(t),fD.set(a.width,a.height)):(t=this.camera,n=r.getPixelRatio(),r.getSize(fD)),this._pixelRatio=n,this.setSize(fD.width,fD.height);var o=r.getRenderTarget(),s=r.getMRT(),u=t.layers.mask;for(var l in this._cameraNear.value=t.near,this._cameraFar.value=t.far,null!==this._layers&&(t.layers.mask=this._layers.mask),this._previousTextures)this.toggleTexture(l);r.setRenderTarget(this.renderTarget),r.setMRT(this._mrt),r.render(i,t),r.setRenderTarget(o),r.setMRT(s),t.layers.mask=u}},{key:"setSize",value:function(e,t){this._width=e,this._height=t;var n=this._width*this._pixelRatio*this._resolution,r=this._height*this._pixelRatio*this._resolution;this.renderTarget.setSize(n,r)}},{key:"setPixelRatio",value:function(e){this._pixelRatio=e,this.setSize(this._width,this._height)}},{key:"dispose",value:function(){this.renderTarget.dispose()}}],[{key:"type",get:function(){return"PassNode"}}]),n}(hb);AD.COLOR="color",AD.DEPTH="depth";var vD=function(e){v(n,e);var t=b(n);function n(e,r,i,a,o){var s;return c(this,n),(s=t.call(this,AD.COLOR,e,r)).colorNode=i,s.thicknessNode=a,s.alphaNode=o,s._materialCache=new WeakMap,s}return p(n,[{key:"updateBefore",value:function(e){var t=this,r=e.renderer,i=r.getRenderObjectFunction();r.setRenderObjectFunction((function(e,n,i,a,o,s,u,l){if((o.isMeshToonMaterial||o.isMeshToonNodeMaterial)&&!1===o.wireframe){var c=t._getOutlineMaterial(o);r.renderObject(e,n,i,a,c,s,u,l)}r.renderObject(e,n,i,a,o,s,u,l)})),ht(m(n.prototype),"updateBefore",this).call(this,e),r.setRenderObjectFunction(i)}},{key:"_createMaterial",value:function(){var e=new uR;e.isMeshToonOutlineMaterial=!0,e.name="Toon_Outline",e.side=1;var t=dk.negate(),n=RE.mul($E),r=xx(1),i=n.mul(Lx(ik,1)),a=n.mul(Lx(ik.add(t),1)),o=bT(i.sub(a));return e.vertexNode=i.add(o.mul(this.thicknessNode).mul(i.w).mul(r)),e.colorNode=Lx(this.colorNode,this.alphaNode),e}},{key:"_getOutlineMaterial",value:function(e){var t=this._materialCache.get(e);return void 0===t&&(t=this._createMaterial(),this._materialCache.set(e,t)),t}}],[{key:"type",get:function(){return"ToonOutlinePassNode"}}]),n}(AD),mD=vx((function(e){var t=T(e,2),n=t[0],r=t[1];return n.mul(r).clamp()})).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),gD=vx((function(e){var t=T(e,2),n=t[0],r=t[1];return(n=n.mul(r)).div(n.add(1)).clamp()})).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),yD=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=(n=(n=n.mul(r)).sub(.004).max(0)).mul(n.mul(6.2).add(.5)),a=n.mul(n.mul(6.2).add(1.7)).add(.06);return i.div(a).pow(2.2)})).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),_D=vx((function(e){var t=T(e,1)[0],n=t.mul(t.add(.0245786)).sub(90537e-9),r=t.mul(t.add(.432951).mul(.983729)).add(.238081);return n.div(r)})),bD=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=Fx(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),a=Fx(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return n=n.mul(r).div(.6),n=i.mul(n),n=_D(n),(n=a.mul(n)).clamp()})).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),xD=Fx(Rx(1.6605,-.1246,-.0182),Rx(-.5876,1.1329,-.1006),Rx(-.0728,-.0083,1.1187)),wD=Fx(Rx(.6274,.0691,.0164),Rx(.3293,.9195,.088),Rx(.0433,.0113,.8956)),TD=vx((function(e){var t=T(e,1)[0],n=Rx(t).toVar(),r=Rx(n.mul(n)).toVar(),i=Rx(r.mul(r)).toVar();return xx(15.5).mul(i.mul(r)).sub(Uw(40.14,i.mul(n))).add(Uw(31.96,i).sub(Uw(6.868,r.mul(n))).add(Uw(.4298,r).add(Uw(.1191,n).sub(.00232))))})),SD=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=Rx(n).toVar(),a=Fx(Rx(.856627153315983,.137318972929847,.11189821299995),Rx(.0951212405381588,.761241990602591,.0767994186031903),Rx(.0482516061458583,.101439036467562,.811302368396859)),o=Fx(Rx(1.1271005818144368,-.1413297634984383,-.14132976349843826),Rx(-.11060664309660323,1.157823702216272,-.11060664309660294),Rx(-.016493938717834573,-.016493938717834257,1.2519364065950405)),s=xx(-12.47393),u=xx(4.026069);return i.mulAssign(r),i.assign(wD.mul(i)),i.assign(a.mul(i)),i.assign(GT(i,1e-10)),i.assign(vT(i)),i.assign(i.sub(s).div(u.sub(s))),i.assign(aS(i,0,1)),i.assign(TD(i)),i.assign(o.mul(i)),i.assign(ZT(GT(Rx(0),i),Rx(2.2))),i.assign(xD.mul(i)),i.assign(aS(i,0,1)),i})).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),ED=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=xx(.76),a=xx(.15);n=n.mul(r);var o=jT(n.r,jT(n.g,n.b)),s=mS(o.lessThan(.08),o.sub(Uw(6.25,o.mul(o))),.04);n.subAssign(s);var u=GT(n.r,GT(n.g,n.b));yx(u.lessThan(i),(function(){return n}));var l=Ow(1,i),c=Ow(1,l.mul(l).div(u.add(l.sub(i))));n.mulAssign(c.div(u));var h=Ow(1,Bw(1,a.mul(u.sub(c)).add(1)));return iS(n,Rx(c),h)})).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),kD=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return c(this,n),(e=t.call(this,"code")).isCodeNode=!0,e.code=r,e.includes=i,e.language=a,e}return p(n,[{key:"isGlobal",value:function(){return!0}},{key:"setIncludes",value:function(e){return this.includes=e,this}},{key:"getIncludes",value:function(){return this.includes}},{key:"generate",value:function(e){var t,n=k(this.getIncludes(e));try{for(n.s();!(t=n.n()).done;){t.value.build(e)}}catch(i){n.e(i)}finally{n.f()}var r=e.getCodeFromNode(this,this.getNodeType(e));return r.code=this.code,r.code}},{key:"serialize",value:function(e){ht(m(n.prototype),"serialize",this).call(this,e),e.code=this.code,e.language=this.language}},{key:"deserialize",value:function(e){ht(m(n.prototype),"deserialize",this).call(this,e),this.code=e.code,this.language=e.language}}],[{key:"type",get:function(){return"CodeNode"}}]),n}(ub),MD=dx(kD).setParameterLength(1,3),CD=function(e){v(n,e);var t=b(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return c(this,n),t.call(this,e,r,i)}return p(n,[{key:"getNodeType",value:function(e){return this.getNodeFunction(e).type}},{key:"getInputs",value:function(e){return this.getNodeFunction(e).inputs}},{key:"getNodeFunction",value:function(e){var t=e.getDataFromNode(this),n=t.nodeFunction;return void 0===n&&(n=e.parser.parseFunction(this.code),t.nodeFunction=n),n}},{key:"generate",value:function(e,t){ht(m(n.prototype),"generate",this).call(this,e);var r=this.getNodeFunction(e),i=r.name,a=r.type,o=e.getCodeFromNode(this,a);""!==i&&(o.name=i);var s=e.getPropertyName(o),u=this.getNodeFunction(e).getCode(s);return o.code=u+"\n","property"===t?s:e.format("".concat(s,"()"),a,t)}}],[{key:"type",get:function(){return"FunctionNode"}}]),n}(kD),RD=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=0;r<t.length;r++){var i=t[r];"function"===typeof i&&(t[r]=i.functionNode)}var a=cx(new CD(e,t,n)),o=function(){return a.call.apply(a,arguments)};return o.functionNode=a,o},PD=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return c(this,n),(e=t.call(this))._value=r,e._cache=null,e.inputType=null,e.outputType=null,e.events=new ur,e.isScriptableValueNode=!0,e}return p(n,[{key:"isScriptableOutputNode",get:function(){return null!==this.outputType}},{key:"value",get:function(){return this._value},set:function(e){this._value!==e&&(this._cache&&"URL"===this.inputType&&this.value.value instanceof ArrayBuffer&&(URL.revokeObjectURL(this._cache),this._cache=null),this._value=e,this.events.dispatchEvent({type:"change"}),this.refresh())}},{key:"refresh",value:function(){this.events.dispatchEvent({type:"refresh"})}},{key:"getValue",value:function(){var e=this.value;if(e&&null===this._cache&&"URL"===this.inputType&&e.value instanceof ArrayBuffer)this._cache=URL.createObjectURL(new Blob([e.value]));else if(e&&null!==e.value&&void 0!==e.value&&(("URL"===this.inputType||"String"===this.inputType)&&"string"===typeof e.value||"Number"===this.inputType&&"number"===typeof e.value||"Vector2"===this.inputType&&e.value.isVector2||"Vector3"===this.inputType&&e.value.isVector3||"Vector4"===this.inputType&&e.value.isVector4||"Color"===this.inputType&&e.value.isColor||"Matrix3"===this.inputType&&e.value.isMatrix3||"Matrix4"===this.inputType&&e.value.isMatrix4))return e.value;return this._cache||e}},{key:"getNodeType",value:function(e){return this.value&&this.value.isNode?this.value.getNodeType(e):"float"}},{key:"setup",value:function(){return this.value&&this.value.isNode?this.value:xx()}},{key:"serialize",value:function(e){ht(m(n.prototype),"serialize",this).call(this,e),null!==this.value?"ArrayBuffer"===this.inputType?e.value=J_(this.value):e.value=this.value?this.value.toJSON(e.meta).uuid:null:e.value=null,e.inputType=this.inputType,e.outputType=this.outputType}},{key:"deserialize",value:function(e){ht(m(n.prototype),"deserialize",this).call(this,e);var t=null;null!==e.value&&(t="ArrayBuffer"===e.inputType?$_(e.value):"Texture"===e.inputType?e.meta.textures[e.value]:e.meta.nodes[e.value]||null),this.value=t,this.inputType=e.inputType,this.outputType=e.outputType}}],[{key:"type",get:function(){return"ScriptableValueNode"}}]),n}(ub),ND=dx(PD).setParameterLength(1),ID=function(e){v(n,e);var t=b(n);function n(){return c(this,n),t.apply(this,arguments)}return p(n,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.has(e))return ht(m(n.prototype),"get",this).call(this,e);if(null!==t){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];var o=t.apply(void 0,i);return this.set(e,o),o}}}]),n}(E(Map)),LD=function(){function e(t){c(this,e),this.scriptableNode=t}return p(e,[{key:"parameters",get:function(){return this.scriptableNode.parameters}},{key:"layout",get:function(){return this.scriptableNode.getLayout()}},{key:"getInputLayout",value:function(e){return this.scriptableNode.getInputLayout(e)}},{key:"get",value:function(e){var t=this.parameters[e];return t?t.getValue():null}}]),e}(),DD=new ID,OD=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c(this,n),(e=t.call(this)).codeNode=r,e.parameters=i,e._local=new ID,e._output=ND(null),e._outputs={},e._source=e.source,e._method=null,e._object=null,e._value=null,e._needsOutputUpdate=!0,e.onRefresh=e.onRefresh.bind(y(e)),e.isScriptableNode=!0,e}return p(n,[{key:"source",get:function(){return this.codeNode?this.codeNode.code:""}},{key:"setLocal",value:function(e,t){return this._local.set(e,t)}},{key:"getLocal",value:function(e){return this._local.get(e)}},{key:"onRefresh",value:function(){this._refresh()}},{key:"getInputLayout",value:function(e){var t,n=k(this.getLayout());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.inputType&&(r.id===e||r.name===e))return r}}catch(i){n.e(i)}finally{n.f()}}},{key:"getOutputLayout",value:function(e){var t,n=k(this.getLayout());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.outputType&&(r.id===e||r.name===e))return r}}catch(i){n.e(i)}finally{n.f()}}},{key:"setOutput",value:function(e,t){var n=this._outputs;return void 0===n[e]?n[e]=ND(t):n[e].value=t,this}},{key:"getOutput",value:function(e){return this._outputs[e]}},{key:"getParameter",value:function(e){return this.parameters[e]}},{key:"setParameter",value:function(e,t){var n=this.parameters;return t&&t.isScriptableNode?(this.deleteParameter(e),n[e]=t,n[e].getDefaultOutput().events.addEventListener("refresh",this.onRefresh)):t&&t.isScriptableValueNode?(this.deleteParameter(e),n[e]=t,n[e].events.addEventListener("refresh",this.onRefresh)):void 0===n[e]?(n[e]=ND(t),n[e].events.addEventListener("refresh",this.onRefresh)):n[e].value=t,this}},{key:"getValue",value:function(){return this.getDefaultOutput().getValue()}},{key:"deleteParameter",value:function(e){var t=this.parameters[e];return t&&(t.isScriptableNode&&(t=t.getDefaultOutput()),t.events.removeEventListener("refresh",this.onRefresh)),this}},{key:"clearParameters",value:function(){for(var e=0,t=Object.keys(this.parameters);e<t.length;e++){var n=t[e];this.deleteParameter(n)}return this.needsUpdate=!0,this}},{key:"call",value:function(e){var t=this.getObject(),n=t[e];if("function"===typeof n){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return n.apply(void 0,i)}}},{key:"callAsync",value:function(){var e=lt(ft().mark((function e(t){var n,r,i,a,o,s=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.getObject(),"function"!==typeof(r=n[t])){e.next=12;break}for(i=s.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=s[o];if("AsyncFunction"!==r.constructor.name){e.next=10;break}return e.next=7,r.apply(void 0,a);case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=r.apply(void 0,a);case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getNodeType",value:function(e){return this.getDefaultOutputNode().getNodeType(e)}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null!==e?this.getOutput(e).refresh():this._refresh()}},{key:"getObject",value:function(){var e=this;if(this.needsUpdate&&this.dispose(),null!==this._object)return this._object;var t=new LD(this),n=DD.get("THREE"),r=DD.get("TSL"),i=this.getMethod(),a=[t,this._local,DD,function(){return e.refresh()},function(t,n){return e.setOutput(t,n)},n,r];this._object=i.apply(void 0,a);var o=this._object.layout;if(o&&(!1===o.cache&&this._local.clear(),this._output.outputType=o.outputType||null,Array.isArray(o.elements))){var s,u=k(o.elements);try{for(u.s();!(s=u.n()).done;){var l=s.value,c=l.id||l.name;l.inputType&&(void 0===this.getParameter(c)&&this.setParameter(c,null),this.getParameter(c).inputType=l.inputType),l.outputType&&(void 0===this.getOutput(c)&&this.setOutput(c,null),this.getOutput(c).outputType=l.outputType)}}catch(h){u.e(h)}finally{u.f()}}return this._object}},{key:"deserialize",value:function(e){for(var t in ht(m(n.prototype),"deserialize",this).call(this,e),this.parameters){var r=this.parameters[t];r.isScriptableNode&&(r=r.getDefaultOutput()),r.events.addEventListener("refresh",this.onRefresh)}}},{key:"getLayout",value:function(){return this.getObject().layout}},{key:"getDefaultOutputNode",value:function(){var e=this.getDefaultOutput().value;return e&&e.isNode?e:xx()}},{key:"getDefaultOutput",value:function(){return this._exec()._output}},{key:"getMethod",value:function(){if(this.needsUpdate&&this.dispose(),null!==this._method)return this._method;var e=["layout","init","main","dispose"].join(", "),t="\nreturn { ...output, "+e+" };",n="var "+e+"; var output = {};\n"+this.codeNode.code+t;return this._method=S(Function,["parameters","local","global","refresh","setOutput","THREE","TSL"].concat([n])),this._method}},{key:"dispose",value:function(){null!==this._method&&(this._object&&"function"===typeof this._object.dispose&&this._object.dispose(),this._method=null,this._object=null,this._source=null,this._value=null,this._needsOutputUpdate=!0,this._output.value=null,this._outputs={})}},{key:"setup",value:function(){return this.getDefaultOutputNode()}},{key:"getCacheKey",value:function(e){var t=[F_(this.source),this.getDefaultOutputNode().getCacheKey(e)];for(var n in this.parameters)t.push(this.parameters[n].getCacheKey(e));return z_(t)}},{key:"needsUpdate",get:function(){return this.source!==this._source},set:function(e){!0===e&&this.dispose()}},{key:"_exec",value:function(){return null===this.codeNode||(!0===this._needsOutputUpdate&&(this._value=this.call("main"),this._needsOutputUpdate=!1),this._output.value=this._value),this}},{key:"_refresh",value:function(){this.needsUpdate=!0,this._exec(),this._output.refresh()}}],[{key:"type",get:function(){return"ScriptableNode"}}]),n}(ub),UD=dx(OD).setParameterLength(1,2);function BD(e){var t,n=e.context.getViewZ;return void 0!==n&&(t=n(this)),(t||uk.z).negate()}var FD=vx((function(e,t){var n=T(e,2),r=n[0],i=n[1],a=BD(t);return uS(r,i,a)})),zD=vx((function(e,t){var n=T(e,1)[0],r=BD(t);return n.mul(n,r,r).negate().exp().oneMinus()})),VD=vx((function(e){var t=T(e,2),n=t[0],r=t[1];return Lx(r.toFloat().mix(_w.rgb,n.toVec3()),_w.a)}));var qD=null,jD=null,GD=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xx(),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xx();return c(this,n),(e=t.call(this)).minNode=r,e.maxNode=i,e}return p(n,[{key:"getVectorLength",value:function(e){var t=e.getTypeLength(Y_(this.minNode.value)),n=e.getTypeLength(Y_(this.maxNode.value));return t>n?t:n}},{key:"getNodeType",value:function(e){return e.object.count>1?e.getTypeFromLength(this.getVectorLength(e)):"float"}},{key:"setup",value:function(e){var t=e.object,n=null;if(t.count>1){var r=this.minNode.value,i=this.maxNode.value,a=e.getTypeLength(Y_(r)),o=e.getTypeLength(Y_(i));qD=qD||new Gr,jD=jD||new Gr,qD.setScalar(0),jD.setScalar(0),1===a?qD.setScalar(r):r.isColor?qD.set(r.r,r.g,r.b,1):qD.set(r.x,r.y,r.z||0,r.w||0),1===o?jD.setScalar(i):i.isColor?jD.set(i.r,i.g,i.b,1):jD.set(i.x,i.y,i.z||0,i.w||0);for(var s=4*t.count,u=new Float32Array(s),l=0;l<s;l++){var c=l%4,h=qD.getComponent(c),f=jD.getComponent(c);u[l]=yr.lerp(h,f,Math.random())}var d=this.getNodeType(e);if(t.count<=4096)n=wE(u,"vec4",t.count).element(ZM).convert(d);else{var p=new ko(u,4);e.geometry.setAttribute("__range"+this.id,p),n=YS(p).convert(d)}}else n=xx(0);return n}}],[{key:"type",get:function(){return"RangeNode"}}]),n}(ub),HD=dx(GD).setParameterLength(2),WD=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,r))._builtinName=e,i}return p(n,[{key:"getHash",value:function(e){return this.getBuiltinName(e)}},{key:"getNodeType",value:function(){return this.nodeType}},{key:"setBuiltinName",value:function(e){return this._builtinName=e,this}},{key:"getBuiltinName",value:function(){return this._builtinName}},{key:"hasBuiltin",value:function(e){return e.hasBuiltin(this._builtinName)}},{key:"generate",value:function(e,t){var n=this.getBuiltinName(e),r=this.getNodeType(e);return"compute"===e.shaderStage?e.format(n,r,t):(console.warn("ComputeBuiltinNode: Compute built-in value ".concat(n," can not be accessed in the ").concat(e.shaderStage," stage")),e.generateConst(r))}},{key:"serialize",value:function(e){ht(m(n.prototype),"serialize",this).call(this,e),e.global=this.global,e._builtinName=this._builtinName}},{key:"deserialize",value:function(e){ht(m(n.prototype),"deserialize",this).call(this,e),this.global=e.global,this._builtinName=e._builtinName}}],[{key:"type",get:function(){return"ComputeBuiltinNode"}}]),n}(ub),XD=function(e,t){return cx(new WD(e,t))},QD=XD("numWorkgroups","uvec3"),YD=XD("workgroupId","uvec3"),KD=XD("globalId","uvec3"),ZD=XD("localId","uvec3"),JD=XD("subgroupSize","uint"),$D=dx(function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).scope=e,r}return p(n,[{key:"generate",value:function(e){var t=this.scope;!0===e.renderer.backend.isWebGLBackend?e.addFlowCode("\t// ".concat(t,"Barrier \n")):e.addLineFlowCode("".concat(t,"Barrier()"),this)}}]),n}(ub)),eO=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,e,r)).isWorkgroupInfoElementNode=!0,i}return p(n,[{key:"generate",value:function(e,t){var r,i=e.context.assign;if(r=ht(m(n.prototype),"generate",this).call(this,e),!0!==i){var a=this.getNodeType(e);r=e.format(r,a,t)}return r}}]),n}(lb),tO=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return c(this,n),(i=t.call(this,r)).bufferType=r,i.bufferCount=a,i.isWorkgroupInfoNode=!0,i.elementType=r,i.scope=e,i}return p(n,[{key:"label",value:function(e){return this.name=e,this}},{key:"setScope",value:function(e){return this.scope=e,this}},{key:"getElementType",value:function(){return this.elementType}},{key:"getInputType",value:function(){return"".concat(this.scope,"Array")}},{key:"element",value:function(e){return cx(new eO(this,e))}},{key:"generate",value:function(e){return e.getScopedArray(this.name||"".concat(this.scope,"Array_").concat(this.id),this.scope.toLowerCase(),this.bufferType,this.bufferCount)}}]),n}(ub),nO=function(e){v(n,e);var t=b(n);function n(e,r,i){var a;return c(this,n),(a=t.call(this,"uint")).method=e,a.pointerNode=r,a.valueNode=i,a}return p(n,[{key:"getInputType",value:function(e){return this.pointerNode.getNodeType(e)}},{key:"getNodeType",value:function(e){return this.getInputType(e)}},{key:"generate",value:function(e){var t=this.method,n=this.getNodeType(e),r=this.getInputType(e),i=this.pointerNode,a=this.valueNode,o=[];o.push("&".concat(i.build(e,r))),null!==a&&o.push(a.build(e,r));var s="".concat(e.getMethod(t,n),"( ").concat(o.join(", ")," )");return null!==a&&e.addLineFlowCode(s,this),s}}],[{key:"type",get:function(){return"AtomicFunctionNode"}}]),n}(hb);nO.ATOMIC_LOAD="atomicLoad",nO.ATOMIC_STORE="atomicStore",nO.ATOMIC_ADD="atomicAdd",nO.ATOMIC_SUB="atomicSub",nO.ATOMIC_MAX="atomicMax",nO.ATOMIC_MIN="atomicMin",nO.ATOMIC_AND="atomicAnd",nO.ATOMIC_OR="atomicOr",nO.ATOMIC_XOR="atomicXor";var rO,iO=dx(nO),aO=function(e,t,n){var r=iO(e,t,n);return r.append(),r};function oO(e){var t=(rO=rO||new WeakMap).get(e);return void 0===t&&rO.set(e,t={}),t}function sO(e){var t=oO(e);return t.shadowMatrix||(t.shadowMatrix=Jx("mat4").setGroup(Yx).onRenderUpdate((function(){return!0!==e.castShadow&&e.shadow.updateMatrices(e),e.shadow.matrix})))}function uO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ok,n=sO(e).mul(t),r=n.xyz.div(n.w);return r}function lO(e){var t=oO(e);return t.position||(t.position=Jx(new Kr).setGroup(Yx).onRenderUpdate((function(t,n){return n.value.setFromMatrixPosition(e.matrixWorld)})))}function cO(e){var t=oO(e);return t.targetPosition||(t.targetPosition=Jx(new Kr).setGroup(Yx).onRenderUpdate((function(t,n){return n.value.setFromMatrixPosition(e.target.matrixWorld)})))}function hO(e){var t=oO(e);return t.viewPosition||(t.viewPosition=Jx(new Kr).setGroup(Yx).onRenderUpdate((function(t,n){var r=t.camera;n.value=n.value||new Kr,n.value.setFromMatrixPosition(e.matrixWorld),n.value.applyMatrix4(r.matrixWorldInverse)})))}var fO=function(e){return NE.transformDirection(lO(e).sub(cO(e)))},dO=function(e,t){var n,r=k(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.isAnalyticLightNode&&i.light.id===e)return i}}catch(a){r.e(a)}finally{r.f()}return null},pO=new WeakMap,AO=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this,"vec3")).totalDiffuseNode=Rx().toVar(),e.totalSpecularNode=Rx().toVar(),e.outgoingLightNode=Rx().toVar(),e._lights=[],e._lightNodes=null,e._lightNodesHash=null,e.global=!0,e}return p(n,[{key:"customCacheKey",value:function(){for(var e=[],t=this._lights,n=0;n<t.length;n++)e.push(t[n].id);return z_(e)}},{key:"getHash",value:function(e){if(null===this._lightNodesHash){null===this._lightNodes&&this.setupLightsNode(e);var t,n=[],r=k(this._lightNodes);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.push(i.getSelf().getHash())}}catch(a){r.e(a)}finally{r.f()}this._lightNodesHash="lights-"+n.join(",")}return this._lightNodesHash}},{key:"analyze",value:function(e){var t,n=k(e.getDataFromNode(this).nodes);try{for(n.s();!(t=n.n()).done;){t.value.build(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"setupLightsNode",value:function(e){var t,n=[],r=this._lightNodes,i=function(e){return e.sort((function(e,t){return e.id-t.id}))}(this._lights),a=e.renderer.library,o=k(i);try{for(o.s();!(t=o.n()).done;){var s=t.value;if(s.isNode)n.push(cx(s));else{var u=null;if(null!==r&&(u=dO(s.id,r)),null===u){var l=a.getLightNodeClass(s.constructor);if(null===l){console.warn("LightsNode.setupNodeLights: Light node not found for ".concat(s.constructor.name));continue}var c=null;pO.has(s)?c=pO.get(s):(c=cx(new l(s)),pO.set(s,c)),n.push(c)}}}}catch(h){o.e(h)}finally{o.f()}this._lightNodes=n}},{key:"setupDirectLight",value:function(e,t,n){var r=e.context,i=r.lightingModel,a=r.reflectedLight;i.direct(Qe(Qe({},n),{},{lightNode:t,reflectedLight:a}),e)}},{key:"setupDirectRectAreaLight",value:function(e,t,n){var r=e.context,i=r.lightingModel,a=r.reflectedLight;i.directRectArea(Qe(Qe({},n),{},{lightNode:t,reflectedLight:a}),e)}},{key:"setupLights",value:function(e,t){var n,r=k(t);try{for(r.s();!(n=r.n()).done;){n.value.build(e)}}catch(i){r.e(i)}finally{r.f()}}},{key:"getLightNodes",value:function(e){return null===this._lightNodes&&this.setupLightsNode(e),this._lightNodes}},{key:"setup",value:function(e){var t=e.lightsNode;e.lightsNode=this;var n=this.outgoingLightNode,r=e.context,i=r.lightingModel,a=e.getDataFromNode(this);if(i){var o=this.totalDiffuseNode,s=this.totalSpecularNode;r.outgoingLight=n;var u=e.addStack();a.nodes=u.nodes,i.start(e);var l=r.backdrop,c=r.backdropAlpha,h=r.reflectedLight,f=h.directDiffuse,d=h.directSpecular,p=h.indirectDiffuse,A=h.indirectSpecular,v=f.add(p);null!==l&&(v=Rx(null!==c?c.mix(v,l):l),r.material.transparent=!0),o.assign(v),s.assign(d.add(A)),n.assign(o.add(s)),i.finish(e),n=n.bypass(e.removeStack())}else a.nodes=[];return e.lightsNode=t,n}},{key:"setLights",value:function(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}},{key:"getLights",value:function(){return this._lights}},{key:"hasLights",get:function(){return this._lights.length>0}}],[{key:"type",get:function(){return"LightsNode"}}]),n}(ub),vO=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).light=e,r.updateBeforeType=tb.RENDER,r.isShadowBaseNode=!0,r}return p(n,[{key:"setupShadowPosition",value:function(e){var t=e.context,n=e.material;mO.assign(n.shadowPositionNode||t.shadowPositionWorld||ok)}},{key:"dispose",value:function(){this.updateBeforeType=tb.NONE}}],[{key:"type",get:function(){return"ShadowBaseNode"}}]),n}(ub),mO=ew("vec3","shadowPositionWorld");function gO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.toneMapping=e.toneMapping,t.toneMappingExposure=e.toneMappingExposure,t.outputColorSpace=e.outputColorSpace,t.renderTarget=e.getRenderTarget(),t.activeCubeFace=e.getActiveCubeFace(),t.activeMipmapLevel=e.getActiveMipmapLevel(),t.renderObjectFunction=e.getRenderObjectFunction(),t.pixelRatio=e.getPixelRatio(),t.mrt=e.getMRT(),t.clearColor=e.getClearColor(t.clearColor||new ga),t.clearAlpha=e.getClearAlpha(),t.autoClear=e.autoClear,t.scissorTest=e.getScissorTest(),t}function yO(e,t){return t=gO(e,t),e.setMRT(null),e.setRenderObjectFunction(null),e.setClearColor(0,1),e.autoClear=!0,t}function _O(e,t){e.toneMapping=t.toneMapping,e.toneMappingExposure=t.toneMappingExposure,e.outputColorSpace=t.outputColorSpace,e.setRenderTarget(t.renderTarget,t.activeCubeFace,t.activeMipmapLevel),e.setRenderObjectFunction(t.renderObjectFunction),e.setPixelRatio(t.pixelRatio),e.setMRT(t.mrt),e.setClearColor(t.clearColor,t.clearAlpha),e.autoClear=t.autoClear,e.setScissorTest(t.scissorTest)}function bO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.background=e.background,t.backgroundNode=e.backgroundNode,t.overrideMaterial=e.overrideMaterial,t}function xO(e,t){return t=bO(e,t),e.background=null,e.backgroundNode=null,e.overrideMaterial=null,t}function wO(e,t){e.background=t.background,e.backgroundNode=t.backgroundNode,e.overrideMaterial=t.overrideMaterial}function TO(e,t,n){return n=xO(t,n=yO(e,n))}function SO(e,t,n){_O(e,n),wO(t,n)}var EO,kO=new WeakMap,MO=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=ok.sub(n).length();return a=(a=a.sub(r).div(i.sub(r))).saturate()})),CO=function(e){var t=kO.get(e);if(void 0===t){var n=e.isPointLight?function(e){var t=e.shadow.camera,n=Dk("near","float",t).setGroup(Yx),r=Dk("far","float",t).setGroup(Yx),i=zE(e);return MO(i,n,r)}(e):null;(t=new uR).colorNode=Lx(0,0,0,1),t.depthNode=n,t.isShadowPassMaterial=!0,t.name="ShadowMaterial",t.fog=!1,kO.set(e,t)}return t},RO=vx((function(e){var t=e.depthTexture,n=e.shadowCoord;return _E(t,n.xy).compare(n.z)})),PO=vx((function(e){var t=e.depthTexture,n=e.shadowCoord,r=e.shadow,i=function(e,n){return _E(t,e).compare(n)},a=Dk("mapSize","vec2",r).setGroup(Yx),o=Dk("radius","float",r).setGroup(Yx),s=Ex(1).div(a),u=s.x.negate().mul(o),l=s.y.negate().mul(o),c=s.x.mul(o),h=s.y.mul(o),f=u.div(2),d=l.div(2),p=c.div(2),A=h.div(2);return Dw(i(n.xy.add(Ex(u,l)),n.z),i(n.xy.add(Ex(0,l)),n.z),i(n.xy.add(Ex(c,l)),n.z),i(n.xy.add(Ex(f,d)),n.z),i(n.xy.add(Ex(0,d)),n.z),i(n.xy.add(Ex(p,d)),n.z),i(n.xy.add(Ex(u,0)),n.z),i(n.xy.add(Ex(f,0)),n.z),i(n.xy,n.z),i(n.xy.add(Ex(p,0)),n.z),i(n.xy.add(Ex(c,0)),n.z),i(n.xy.add(Ex(f,A)),n.z),i(n.xy.add(Ex(0,A)),n.z),i(n.xy.add(Ex(p,A)),n.z),i(n.xy.add(Ex(u,h)),n.z),i(n.xy.add(Ex(0,h)),n.z),i(n.xy.add(Ex(c,h)),n.z)).mul(1/17)})),NO=vx((function(e){var t=e.depthTexture,n=e.shadowCoord,r=e.shadow,i=function(e,n){return _E(t,e).compare(n)},a=Dk("mapSize","vec2",r).setGroup(Yx),o=Ex(1).div(a),s=o.x,u=o.y,l=n.xy,c=xT(l.mul(a).add(.5));return l.subAssign(c.mul(o)),Dw(i(l,n.z),i(l.add(Ex(s,0)),n.z),i(l.add(Ex(0,u)),n.z),i(l.add(o),n.z),iS(i(l.add(Ex(s.negate(),0)),n.z),i(l.add(Ex(s.mul(2),0)),n.z),c.x),iS(i(l.add(Ex(s.negate(),u)),n.z),i(l.add(Ex(s.mul(2),u)),n.z),c.x),iS(i(l.add(Ex(0,u.negate())),n.z),i(l.add(Ex(0,u.mul(2))),n.z),c.y),iS(i(l.add(Ex(s,u.negate())),n.z),i(l.add(Ex(s,u.mul(2))),n.z),c.y),iS(iS(i(l.add(Ex(s.negate(),u.negate())),n.z),i(l.add(Ex(s.mul(2),u.negate())),n.z),c.x),iS(i(l.add(Ex(s.negate(),u.mul(2))),n.z),i(l.add(Ex(s.mul(2),u.mul(2))),n.z),c.x),c.y)).mul(1/9)})),IO=vx((function(e){var t=e.depthTexture,n=e.shadowCoord,r=xx(1).toVar(),i=_E(t).sample(n.xy).rg,a=HT(n.z,i.x);return yx(a.notEqual(xx(1)),(function(){var e=n.z.sub(i.x),t=GT(0,i.y.mul(i.y)),o=t.div(t.add(e.mul(e)));o=aS(Ow(o,.3).div(.95-.3)),r.assign(aS(GT(a,o)))})),r})),LO=vx((function(e){var t=e.samples,n=e.radius,r=e.size,i=e.shadowPass,a=xx(0).toVar(),o=xx(0).toVar(),s=t.lessThanEqual(xx(1)).select(xx(0),xx(2).div(t.sub(1))),u=t.lessThanEqual(xx(1)).select(xx(0),xx(-1));vC({start:wx(0),end:wx(t),type:"int",condition:"<"},(function(e){var t=e.i,l=u.add(xx(t).mul(s)),c=i.sample(Dw(IC.xy,Ex(0,l).mul(n)).div(r)).x;a.addAssign(c),o.addAssign(c.mul(c))})),a.divAssign(t),o.divAssign(t);var l=mT(o.sub(a.mul(a)));return Ex(a,l)})),DO=vx((function(e){var t=e.samples,n=e.radius,r=e.size,i=e.shadowPass,a=xx(0).toVar(),o=xx(0).toVar(),s=t.lessThanEqual(xx(1)).select(xx(0),xx(2).div(t.sub(1))),u=t.lessThanEqual(xx(1)).select(xx(0),xx(-1));vC({start:wx(0),end:wx(t),type:"int",condition:"<"},(function(e){var t=e.i,l=u.add(xx(t).mul(s)),c=i.sample(Dw(IC.xy,Ex(l,0).mul(n)).div(r));a.addAssign(c.x),o.addAssign(Dw(c.y.mul(c.y),c.x.mul(c.x)))})),a.divAssign(t),o.divAssign(t);var l=mT(o.sub(a.mul(a)));return Ex(a,l)})),OO=[RO,PO,NO,IO],UO=new EL,BO=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this,e)).shadow=i||e.shadow,r.shadowMap=null,r.vsmShadowMapVertical=null,r.vsmShadowMapHorizontal=null,r.vsmMaterialVertical=null,r.vsmMaterialHorizontal=null,r._node=null,r._cameraFrameId=new WeakMap,r.isShadowNode=!0,r}return p(n,[{key:"setupShadowFilter",value:function(e,t){var n=t.filterFn,r=t.depthTexture,i=t.shadowCoord,a=t.shadow,o=i.x.greaterThanEqual(0).and(i.x.lessThanEqual(1)).and(i.y.greaterThanEqual(0)).and(i.y.lessThanEqual(1)).and(i.z.lessThanEqual(1)),s=n({depthTexture:r,shadowCoord:i,shadow:a});return o.select(s,xx(1))}},{key:"setupShadowCoord",value:function(e,t){var n,r=this.shadow,i=e.renderer,a=Dk("bias","float",r).setGroup(Yx),o=t;if(r.camera.isOrthographicCamera||!0!==i.logarithmicDepthBuffer)n=(o=o.xyz.div(o.w)).z,i.coordinateSystem===sr&&(n=n.mul(2).sub(1));else{var s=o.w;o=o.xy.div(s);var u=Dk("near","float",r.camera).setGroup(Yx),l=Dk("far","float",r.camera).setGroup(Yx);n=JC(s.negate(),u,l)}return o=Rx(o.x,o.y.oneMinus(),n.add(a))}},{key:"getShadowFilterFn",value:function(e){return OO[e]}},{key:"setupShadow",value:function(e){var t=e.renderer,n=this.light,r=this.shadow,i=t.shadowMap.type,a=new ns(r.mapSize.width,r.mapSize.height);a.compareFunction=tr;var o=e.createRenderTarget(r.mapSize.width,r.mapSize.height);if(o.depthTexture=a,r.camera.updateProjectionMatrix(),3===i){a.compareFunction=null,this.vsmShadowMapVertical=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:un,type:Xt}),this.vsmShadowMapHorizontal=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:un,type:Xt});var s=_E(a),u=_E(this.vsmShadowMapVertical.texture),l=Dk("blurSamples","float",r).setGroup(Yx),c=Dk("radius","float",r).setGroup(Yx),h=Dk("mapSize","vec2",r).setGroup(Yx),f=this.vsmMaterialVertical||(this.vsmMaterialVertical=new uR);f.fragmentNode=LO({samples:l,radius:c,size:h,shadowPass:s}).context(e.getSharedContext()),f.name="VSMVertical",(f=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new uR)).fragmentNode=DO({samples:l,radius:c,size:h,shadowPass:u}).context(e.getSharedContext()),f.name="VSMHorizontal"}var d=Dk("intensity","float",r).setGroup(Yx),p=Dk("normalBias","float",r).setGroup(Yx),A=sO(n).mul(mO.add(gk.mul(p))),v=this.setupShadowCoord(e,A),m=r.filterNode||this.getShadowFilterFn(t.shadowMap.type)||null;if(null===m)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");var g=3===i?this.vsmShadowMapHorizontal.texture:a,y=this.setupShadowFilter(e,{filterFn:m,shadowTexture:o.texture,depthTexture:g,shadowCoord:v,shadow:r}),_=_E(o.texture,v),b=iS(1,y.rgb.mix(_,1),d.mul(_.a)).toVar();return this.shadowMap=o,this.shadow.map=o,b}},{key:"setup",value:function(e){var t=this;if(!1!==e.renderer.shadowMap.enabled)return vx((function(){var n=t._node;return t.setupShadowPosition(e),null===n&&(t._node=n=t.setupShadow(e)),e.material.shadowNode&&console.warn('THREE.NodeMaterial: ".shadowNode" is deprecated. Use ".castShadowNode" instead.'),e.material.receivedShadowNode&&(n=e.material.receivedShadowNode(n)),n}))()}},{key:"renderShadow",value:function(e){var t=this.shadow,n=this.shadowMap,r=this.light,i=e.renderer,a=e.scene;t.updateMatrices(r),n.setSize(t.mapSize.width,t.mapSize.height),i.render(a,t.camera)}},{key:"updateShadow",value:function(e){var t=this.shadowMap,n=this.light,r=this.shadow,i=e.renderer,a=e.scene,o=e.camera,s=i.shadowMap.type,u=t.depthTexture.version;this._depthVersionCached=u,r.camera.layers.mask=o.layers.mask;var l=i.getRenderObjectFunction(),c=i.getMRT(),h=!!c&&c.has("velocity");EO=TO(i,a,EO),a.overrideMaterial=CO(n),i.setRenderObjectFunction((function(e,t,n,a,u,l){if(!0===e.castShadow||e.receiveShadow&&3===s){h&&(Z_(e).useVelocity=!0),e.onBeforeShadow(i,e,o,r.camera,a,t.overrideMaterial,l);for(var c=arguments.length,f=new Array(c>6?c-6:0),d=6;d<c;d++)f[d-6]=arguments[d];i.renderObject.apply(i,[e,t,n,a,u,l].concat(f)),e.onAfterShadow(i,e,o,r.camera,a,t.overrideMaterial,l)}})),i.setRenderTarget(t),this.renderShadow(e),i.setRenderObjectFunction(l),!0!==n.isPointLight&&3===s&&this.vsmPass(i),SO(i,a,EO)}},{key:"vsmPass",value:function(e){var t=this.shadow;this.vsmShadowMapVertical.setSize(t.mapSize.width,t.mapSize.height),this.vsmShadowMapHorizontal.setSize(t.mapSize.width,t.mapSize.height),e.setRenderTarget(this.vsmShadowMapVertical),UO.material=this.vsmMaterialVertical,UO.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),UO.material=this.vsmMaterialHorizontal,UO.render(e)}},{key:"dispose",value:function(){this.shadowMap.dispose(),this.shadowMap=null,null!==this.vsmShadowMapVertical&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),null!==this.vsmShadowMapHorizontal&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null),ht(m(n.prototype),"dispose",this).call(this)}},{key:"updateBefore",value:function(e){var t=this.shadow,n=t.needsUpdate||t.autoUpdate;n&&(this._cameraFrameId[e.camera]===e.frameId&&(n=!1),this._cameraFrameId[e.camera]=e.frameId),n&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(t.needsUpdate=!1))}}],[{key:"type",get:function(){return"ShadowNode"}}]),n}(vO),FO=function(e,t){return cx(new BO(e,t))},zO=new ga,VO=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=n.toVar(),a=CT(i),o=Bw(1,GT(a.x,GT(a.y,a.z)));a.mulAssign(o),i.mulAssign(o.mul(r.mul(2).oneMinus()));var s=Ex(i.xy).toVar(),u=r.mul(1.5).oneMinus();return yx(a.z.greaterThanEqual(u),(function(){yx(i.z.greaterThan(0),(function(){s.x.assign(Ow(4,i.x))}))})).ElseIf(a.x.greaterThanEqual(u),(function(){var e=RT(i.x);s.x.assign(i.z.mul(e).add(e.mul(2)))})).ElseIf(a.y.greaterThanEqual(u),(function(){var e=RT(i.y);s.x.assign(i.x.add(e.mul(2)).add(2)),s.y.assign(i.z.mul(e).sub(2))})),Ex(.125,.25).mul(s).add(Ex(.375,.75)).flipY()})).setLayout({name:"cubeToUV",type:"vec2",inputs:[{name:"pos",type:"vec3"},{name:"texelSizeY",type:"float"}]}),qO=vx((function(e){var t=e.depthTexture,n=e.bd3D,r=e.dp,i=e.texelSize;return _E(t,VO(n,i.y)).compare(r)})),jO=vx((function(e){var t=e.depthTexture,n=e.bd3D,r=e.dp,i=e.texelSize,a=e.shadow,o=Dk("radius","float",a).setGroup(Yx),s=Ex(-1,1).mul(o).mul(i.y);return _E(t,VO(n.add(s.xyy),i.y)).compare(r).add(_E(t,VO(n.add(s.yyy),i.y)).compare(r)).add(_E(t,VO(n.add(s.xyx),i.y)).compare(r)).add(_E(t,VO(n.add(s.yyx),i.y)).compare(r)).add(_E(t,VO(n,i.y)).compare(r)).add(_E(t,VO(n.add(s.xxy),i.y)).compare(r)).add(_E(t,VO(n.add(s.yxy),i.y)).compare(r)).add(_E(t,VO(n.add(s.xxx),i.y)).compare(r)).add(_E(t,VO(n.add(s.yxx),i.y)).compare(r)).mul(1/9)})),GO=vx((function(e){var t=e.filterFn,n=e.depthTexture,r=e.shadowCoord,i=e.shadow,a=r.xyz.toVar(),o=a.length(),s=Jx("float").setGroup(Yx).onRenderUpdate((function(){return i.camera.near})),u=Jx("float").setGroup(Yx).onRenderUpdate((function(){return i.camera.far})),l=Dk("bias","float",i).setGroup(Yx),c=Jx(i.mapSize).setGroup(Yx),h=xx(1).toVar();return yx(o.sub(u).lessThanEqual(0).and(o.sub(s).greaterThanEqual(0)),(function(){var e=o.sub(s).div(u.sub(s)).toVar();e.addAssign(l);var r=a.normalize(),f=Ex(1).div(c.mul(Ex(4,2)));h.assign(t({depthTexture:n,bd3D:r,dp:e,texelSize:f,shadow:i}))})),h})),HO=new Gr,WO=new _r,XO=new _r,QO=function(e){v(n,e);var t=b(n);function n(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),t.call(this,e,r)}return p(n,[{key:"getShadowFilterFn",value:function(e){return 0===e?qO:jO}},{key:"setupShadowCoord",value:function(e,t){return t}},{key:"setupShadowFilter",value:function(e,t){var n=t.filterFn,r=t.shadowTexture,i=t.depthTexture,a=t.shadowCoord,o=t.shadow;return GO({filterFn:n,shadowTexture:r,depthTexture:i,shadowCoord:a,shadow:o})}},{key:"renderShadow",value:function(e){var t=this.shadow,n=this.shadowMap,r=this.light,i=e.renderer,a=e.scene,o=t.getFrameExtents();XO.copy(t.mapSize),XO.multiply(o),n.setSize(XO.width,XO.height),WO.copy(t.mapSize);var s=i.autoClear,u=i.getClearColor(zO),l=i.getClearAlpha();i.autoClear=!1,i.setClearColor(t.clearColor,t.clearAlpha),i.clear();for(var c=t.getViewportCount(),h=0;h<c;h++){var f=t.getViewport(h),d=WO.x*f.x,p=XO.y-WO.y-WO.y*f.y;HO.set(d,p,WO.x*f.z,WO.y*f.w),n.viewport.copy(HO),t.updateMatrices(r,h),i.render(a,t.camera)}i.autoClear=s,i.setClearColor(u,l)}}],[{key:"type",get:function(){return"PointShadowNode"}}]),n}(BO),YO=function(e,t){return cx(new QO(e,t))},KO=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return c(this,n),(e=t.call(this)).light=r,e.color=new ga,e.colorNode=r&&r.colorNode||Jx(e.color).setGroup(Yx),e.baseColorNode=null,e.shadowNode=null,e.shadowColorNode=null,e.isAnalyticLightNode=!0,e.updateType=tb.FRAME,e}return p(n,[{key:"customCacheKey",value:function(){return V_(this.light.id,this.light.castShadow?1:0)}},{key:"getHash",value:function(){return this.light.uuid}},{key:"getLightVector",value:function(e){return hO(this.light).sub(e.context.positionView||uk)}},{key:"setupDirect",value:function(){}},{key:"setupDirectRectArea",value:function(){}},{key:"setupShadowNode",value:function(){return FO(this.light)}},{key:"setupShadow",value:function(e){if(!1!==e.renderer.shadowMap.enabled){var t=this.shadowColorNode;if(null===t){var n,r=this.light.shadow.shadowNode;n=void 0!==r?cx(r):this.setupShadowNode(),this.shadowNode=n,this.shadowColorNode=t=this.colorNode.mul(n),this.baseColorNode=this.colorNode}this.colorNode=t}}},{key:"setup",value:function(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):null!==this.shadowNode&&(this.shadowNode.dispose(),this.shadowNode=null,this.shadowColorNode=null);var t=this.setupDirect(e),n=this.setupDirectRectArea(e);t&&e.lightsNode.setupDirectLight(e,this,t),n&&e.lightsNode.setupDirectRectAreaLight(e,this,n)}},{key:"update",value:function(){var e=this.light;this.color.copy(e.color).multiplyScalar(e.intensity)}}],[{key:"type",get:function(){return"AnalyticLightNode"}}]),n}(SC),ZO=vx((function(e){var t=e.lightDistance,n=e.cutoffDistance,r=e.decayExponent,i=t.pow(r).max(.01).reciprocal();return n.greaterThan(0).select(i.mul(t.div(n).pow4().oneMinus().clamp().pow2()),i)})),JO=function(e){var t=e.color,n=e.lightVector,r=e.cutoffDistance,i=e.decayExponent,a=n.normalize(),o=n.length(),s=ZO({lightDistance:o,cutoffDistance:r,decayExponent:i});return{lightDirection:a,lightColor:t.mul(s)}},$O=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return c(this,n),(e=t.call(this,r)).cutoffDistanceNode=Jx(0).setGroup(Yx),e.decayExponentNode=Jx(2).setGroup(Yx),e}return p(n,[{key:"update",value:function(e){var t=this.light;ht(m(n.prototype),"update",this).call(this,e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}},{key:"setupShadowNode",value:function(){return YO(this.light)}},{key:"setupDirect",value:function(e){return JO({color:this.colorNode,lightVector:this.getLightVector(e),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode})}}],[{key:"type",get:function(){return"PointLightNode"}}]),n}(KO),eU=vx((function(e){var t=T(e,1)[0],n=void 0===t?pE():t;return function(){var e=n.mul(2),t=e.x.floor(),r=e.y.floor();return t.add(r).mod(2).sign()}()})),tU=vx((function(e,t){var n=T(e,1)[0],r=void 0===n?pE():n,i=t.renderer,a=t.material,o=xx(1).toVar(),s=rS(r.mul(2).sub(1));if(a.alphaToCoverage&&i.samples>1){var u=xx(s.fwidth()).toVar();o.assign(uS(u.oneMinus(),u.add(1),s).oneMinus())}else s.greaterThan(1).discard();return o})),nU=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=xx(i).toVar(),o=xx(r).toVar(),s=Sx(n).toVar();return mS(s,o,a)})).setLayout({name:"mx_select",type:"float",inputs:[{name:"b",type:"bool"},{name:"t",type:"float"},{name:"f",type:"float"}]}),rU=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=Sx(r).toVar(),a=xx(n).toVar();return mS(i,a.negate(),a)})).setLayout({name:"mx_negate_if",type:"float",inputs:[{name:"val",type:"float"},{name:"b",type:"bool"}]}),iU=vx((function(e){var t=T(e,1)[0],n=xx(t).toVar();return wx(yT(n))})).setLayout({name:"mx_floor",type:"int",inputs:[{name:"x",type:"float"}]}),aU=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=xx(n).toVar();return r.assign(iU(i)),i.sub(xx(r))})),oU=vx((function(e){var t=T(e,6),n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=xx(s).toVar(),l=xx(o).toVar(),c=xx(a).toVar(),h=xx(i).toVar(),f=xx(r).toVar(),d=xx(n).toVar(),p=xx(Ow(1,l)).toVar();return Ow(1,u).mul(d.mul(p).add(f.mul(l))).add(u.mul(h.mul(p).add(c.mul(l))))})).setLayout({name:"mx_bilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"}]}),sU=vx((function(e){var t=T(e,6),n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=xx(s).toVar(),l=xx(o).toVar(),c=Rx(a).toVar(),h=Rx(i).toVar(),f=Rx(r).toVar(),d=Rx(n).toVar(),p=xx(Ow(1,l)).toVar();return Ow(1,u).mul(d.mul(p).add(f.mul(l))).add(u.mul(h.mul(p).add(c.mul(l))))})).setLayout({name:"mx_bilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"}]}),uU=YI([oU,sU]),lU=vx((function(e){var t=T(e,11),n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],h=t[9],f=t[10],d=xx(f).toVar(),p=xx(h).toVar(),A=xx(c).toVar(),v=xx(l).toVar(),m=xx(u).toVar(),g=xx(s).toVar(),y=xx(o).toVar(),_=xx(a).toVar(),b=xx(i).toVar(),x=xx(r).toVar(),w=xx(n).toVar(),S=xx(Ow(1,A)).toVar(),E=xx(Ow(1,p)).toVar();return xx(Ow(1,d)).toVar().mul(E.mul(w.mul(S).add(x.mul(A))).add(p.mul(b.mul(S).add(_.mul(A))))).add(d.mul(E.mul(y.mul(S).add(g.mul(A))).add(p.mul(m.mul(S).add(v.mul(A))))))})).setLayout({name:"mx_trilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"v4",type:"float"},{name:"v5",type:"float"},{name:"v6",type:"float"},{name:"v7",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),cU=vx((function(e){var t=T(e,11),n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],h=t[9],f=t[10],d=xx(f).toVar(),p=xx(h).toVar(),A=xx(c).toVar(),v=Rx(l).toVar(),m=Rx(u).toVar(),g=Rx(s).toVar(),y=Rx(o).toVar(),_=Rx(a).toVar(),b=Rx(i).toVar(),x=Rx(r).toVar(),w=Rx(n).toVar(),S=xx(Ow(1,A)).toVar(),E=xx(Ow(1,p)).toVar();return xx(Ow(1,d)).toVar().mul(E.mul(w.mul(S).add(x.mul(A))).add(p.mul(b.mul(S).add(_.mul(A))))).add(d.mul(E.mul(y.mul(S).add(g.mul(A))).add(p.mul(m.mul(S).add(v.mul(A))))))})).setLayout({name:"mx_trilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"v4",type:"vec3"},{name:"v5",type:"vec3"},{name:"v6",type:"vec3"},{name:"v7",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),hU=YI([lU,cU]),fU=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=xx(i).toVar(),o=xx(r).toVar(),s=Tx(n).toVar(),u=Tx(s.bitAnd(Tx(7))).toVar(),l=xx(nU(u.lessThan(Tx(4)),o,a)).toVar(),c=xx(Uw(2,nU(u.lessThan(Tx(4)),a,o))).toVar();return rU(l,Sx(u.bitAnd(Tx(1)))).add(rU(c,Sx(u.bitAnd(Tx(2)))))})).setLayout({name:"mx_gradient_float_0",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"}]}),dU=vx((function(e){var t=T(e,4),n=t[0],r=t[1],i=t[2],a=t[3],o=xx(a).toVar(),s=xx(i).toVar(),u=xx(r).toVar(),l=Tx(n).toVar(),c=Tx(l.bitAnd(Tx(15))).toVar(),h=xx(nU(c.lessThan(Tx(8)),u,s)).toVar(),f=xx(nU(c.lessThan(Tx(4)),s,nU(c.equal(Tx(12)).or(c.equal(Tx(14))),u,o))).toVar();return rU(h,Sx(c.bitAnd(Tx(1)))).add(rU(f,Sx(c.bitAnd(Tx(2)))))})).setLayout({name:"mx_gradient_float_1",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),pU=YI([fU,dU]),AU=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=xx(i).toVar(),o=xx(r).toVar(),s=Nx(n).toVar();return Rx(pU(s.x,o,a),pU(s.y,o,a),pU(s.z,o,a))})).setLayout({name:"mx_gradient_vec3_0",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"}]}),vU=vx((function(e){var t=T(e,4),n=t[0],r=t[1],i=t[2],a=t[3],o=xx(a).toVar(),s=xx(i).toVar(),u=xx(r).toVar(),l=Nx(n).toVar();return Rx(pU(l.x,u,s,o),pU(l.y,u,s,o),pU(l.z,u,s,o))})).setLayout({name:"mx_gradient_vec3_1",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),mU=YI([AU,vU]),gU=vx((function(e){var t=T(e,1)[0],n=xx(t).toVar();return Uw(.6616,n)})).setLayout({name:"mx_gradient_scale2d_0",type:"float",inputs:[{name:"v",type:"float"}]}),yU=vx((function(e){var t=T(e,1)[0],n=xx(t).toVar();return Uw(.982,n)})).setLayout({name:"mx_gradient_scale3d_0",type:"float",inputs:[{name:"v",type:"float"}]}),_U=vx((function(e){var t=T(e,1)[0],n=Rx(t).toVar();return Uw(.6616,n)})).setLayout({name:"mx_gradient_scale2d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),bU=YI([gU,_U]),xU=vx((function(e){var t=T(e,1)[0],n=Rx(t).toVar();return Uw(.982,n)})).setLayout({name:"mx_gradient_scale3d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),wU=YI([yU,xU]),TU=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=wx(r).toVar(),a=Tx(n).toVar();return a.shiftLeft(i).bitOr(a.shiftRight(wx(32).sub(i)))})).setLayout({name:"mx_rotl32",type:"uint",inputs:[{name:"x",type:"uint"},{name:"k",type:"int"}]}),SU=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2];n.subAssign(i),n.bitXorAssign(TU(i,wx(4))),i.addAssign(r),r.subAssign(n),r.bitXorAssign(TU(n,wx(6))),n.addAssign(i),i.subAssign(r),i.bitXorAssign(TU(r,wx(8))),r.addAssign(n),n.subAssign(i),n.bitXorAssign(TU(i,wx(16))),i.addAssign(r),r.subAssign(n),r.bitXorAssign(TU(n,wx(19))),n.addAssign(i),i.subAssign(r),i.bitXorAssign(TU(r,wx(4))),r.addAssign(n)})),EU=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=Tx(i).toVar(),o=Tx(r).toVar(),s=Tx(n).toVar();return a.bitXorAssign(o),a.subAssign(TU(o,wx(14))),s.bitXorAssign(a),s.subAssign(TU(a,wx(11))),o.bitXorAssign(s),o.subAssign(TU(s,wx(25))),a.bitXorAssign(o),a.subAssign(TU(o,wx(16))),s.bitXorAssign(a),s.subAssign(TU(a,wx(4))),o.bitXorAssign(s),o.subAssign(TU(s,wx(14))),a.bitXorAssign(o),a.subAssign(TU(o,wx(24))),a})).setLayout({name:"mx_bjfinal",type:"uint",inputs:[{name:"a",type:"uint"},{name:"b",type:"uint"},{name:"c",type:"uint"}]}),kU=vx((function(e){var t=T(e,1)[0],n=Tx(t).toVar();return xx(n).div(xx(Tx(wx(4294967295))))})).setLayout({name:"mx_bits_to_01",type:"float",inputs:[{name:"bits",type:"uint"}]}),MU=vx((function(e){var t=T(e,1)[0],n=xx(t).toVar();return n.mul(n).mul(n).mul(n.mul(n.mul(6).sub(15)).add(10))})).setLayout({name:"mx_fade",type:"float",inputs:[{name:"t",type:"float"}]}),CU=vx((function(e){var t=T(e,1)[0],n=wx(t).toVar(),r=Tx(Tx(1)).toVar(),i=Tx(Tx(wx(3735928559)).add(r.shiftLeft(Tx(2))).add(Tx(13))).toVar();return EU(i.add(Tx(n)),i,i)})).setLayout({name:"mx_hash_int_0",type:"uint",inputs:[{name:"x",type:"int"}]}),RU=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=wx(r).toVar(),a=wx(n).toVar(),o=Tx(Tx(2)).toVar(),s=Tx().toVar(),u=Tx().toVar(),l=Tx().toVar();return s.assign(u.assign(l.assign(Tx(wx(3735928559)).add(o.shiftLeft(Tx(2))).add(Tx(13))))),s.addAssign(Tx(a)),u.addAssign(Tx(i)),EU(s,u,l)})).setLayout({name:"mx_hash_int_1",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),PU=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=wx(i).toVar(),o=wx(r).toVar(),s=wx(n).toVar(),u=Tx(Tx(3)).toVar(),l=Tx().toVar(),c=Tx().toVar(),h=Tx().toVar();return l.assign(c.assign(h.assign(Tx(wx(3735928559)).add(u.shiftLeft(Tx(2))).add(Tx(13))))),l.addAssign(Tx(s)),c.addAssign(Tx(o)),h.addAssign(Tx(a)),EU(l,c,h)})).setLayout({name:"mx_hash_int_2",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),NU=vx((function(e){var t=T(e,4),n=t[0],r=t[1],i=t[2],a=t[3],o=wx(a).toVar(),s=wx(i).toVar(),u=wx(r).toVar(),l=wx(n).toVar(),c=Tx(Tx(4)).toVar(),h=Tx().toVar(),f=Tx().toVar(),d=Tx().toVar();return h.assign(f.assign(d.assign(Tx(wx(3735928559)).add(c.shiftLeft(Tx(2))).add(Tx(13))))),h.addAssign(Tx(l)),f.addAssign(Tx(u)),d.addAssign(Tx(s)),SU(h,f,d),h.addAssign(Tx(o)),EU(h,f,d)})).setLayout({name:"mx_hash_int_3",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"}]}),IU=vx((function(e){var t=T(e,5),n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=wx(o).toVar(),u=wx(a).toVar(),l=wx(i).toVar(),c=wx(r).toVar(),h=wx(n).toVar(),f=Tx(Tx(5)).toVar(),d=Tx().toVar(),p=Tx().toVar(),A=Tx().toVar();return d.assign(p.assign(A.assign(Tx(wx(3735928559)).add(f.shiftLeft(Tx(2))).add(Tx(13))))),d.addAssign(Tx(h)),p.addAssign(Tx(c)),A.addAssign(Tx(l)),SU(d,p,A),d.addAssign(Tx(u)),p.addAssign(Tx(s)),EU(d,p,A)})).setLayout({name:"mx_hash_int_4",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"},{name:"yy",type:"int"}]}),LU=YI([CU,RU,PU,NU,IU]),DU=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=wx(r).toVar(),a=wx(n).toVar(),o=Tx(LU(a,i)).toVar(),s=Nx().toVar();return s.x.assign(o.bitAnd(wx(255))),s.y.assign(o.shiftRight(wx(8)).bitAnd(wx(255))),s.z.assign(o.shiftRight(wx(16)).bitAnd(wx(255))),s})).setLayout({name:"mx_hash_vec3_0",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),OU=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=wx(i).toVar(),o=wx(r).toVar(),s=wx(n).toVar(),u=Tx(LU(s,o,a)).toVar(),l=Nx().toVar();return l.x.assign(u.bitAnd(wx(255))),l.y.assign(u.shiftRight(wx(8)).bitAnd(wx(255))),l.z.assign(u.shiftRight(wx(16)).bitAnd(wx(255))),l})).setLayout({name:"mx_hash_vec3_1",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),UU=YI([DU,OU]),BU=vx((function(e){var t=T(e,1)[0],n=Ex(t).toVar(),r=wx().toVar(),i=wx().toVar(),a=xx(aU(n.x,r)).toVar(),o=xx(aU(n.y,i)).toVar(),s=xx(MU(a)).toVar(),u=xx(MU(o)).toVar(),l=xx(uU(pU(LU(r,i),a,o),pU(LU(r.add(wx(1)),i),a.sub(1),o),pU(LU(r,i.add(wx(1))),a,o.sub(1)),pU(LU(r.add(wx(1)),i.add(wx(1))),a.sub(1),o.sub(1)),s,u)).toVar();return bU(l)})).setLayout({name:"mx_perlin_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"}]}),FU=vx((function(e){var t=T(e,1)[0],n=Rx(t).toVar(),r=wx().toVar(),i=wx().toVar(),a=wx().toVar(),o=xx(aU(n.x,r)).toVar(),s=xx(aU(n.y,i)).toVar(),u=xx(aU(n.z,a)).toVar(),l=xx(MU(o)).toVar(),c=xx(MU(s)).toVar(),h=xx(MU(u)).toVar(),f=xx(hU(pU(LU(r,i,a),o,s,u),pU(LU(r.add(wx(1)),i,a),o.sub(1),s,u),pU(LU(r,i.add(wx(1)),a),o,s.sub(1),u),pU(LU(r.add(wx(1)),i.add(wx(1)),a),o.sub(1),s.sub(1),u),pU(LU(r,i,a.add(wx(1))),o,s,u.sub(1)),pU(LU(r.add(wx(1)),i,a.add(wx(1))),o.sub(1),s,u.sub(1)),pU(LU(r,i.add(wx(1)),a.add(wx(1))),o,s.sub(1),u.sub(1)),pU(LU(r.add(wx(1)),i.add(wx(1)),a.add(wx(1))),o.sub(1),s.sub(1),u.sub(1)),l,c,h)).toVar();return wU(f)})).setLayout({name:"mx_perlin_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"}]}),zU=YI([BU,FU]),VU=vx((function(e){var t=T(e,1)[0],n=Ex(t).toVar(),r=wx().toVar(),i=wx().toVar(),a=xx(aU(n.x,r)).toVar(),o=xx(aU(n.y,i)).toVar(),s=xx(MU(a)).toVar(),u=xx(MU(o)).toVar(),l=Rx(uU(mU(UU(r,i),a,o),mU(UU(r.add(wx(1)),i),a.sub(1),o),mU(UU(r,i.add(wx(1))),a,o.sub(1)),mU(UU(r.add(wx(1)),i.add(wx(1))),a.sub(1),o.sub(1)),s,u)).toVar();return bU(l)})).setLayout({name:"mx_perlin_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),qU=vx((function(e){var t=T(e,1)[0],n=Rx(t).toVar(),r=wx().toVar(),i=wx().toVar(),a=wx().toVar(),o=xx(aU(n.x,r)).toVar(),s=xx(aU(n.y,i)).toVar(),u=xx(aU(n.z,a)).toVar(),l=xx(MU(o)).toVar(),c=xx(MU(s)).toVar(),h=xx(MU(u)).toVar(),f=Rx(hU(mU(UU(r,i,a),o,s,u),mU(UU(r.add(wx(1)),i,a),o.sub(1),s,u),mU(UU(r,i.add(wx(1)),a),o,s.sub(1),u),mU(UU(r.add(wx(1)),i.add(wx(1)),a),o.sub(1),s.sub(1),u),mU(UU(r,i,a.add(wx(1))),o,s,u.sub(1)),mU(UU(r.add(wx(1)),i,a.add(wx(1))),o.sub(1),s,u.sub(1)),mU(UU(r,i.add(wx(1)),a.add(wx(1))),o,s.sub(1),u.sub(1)),mU(UU(r.add(wx(1)),i.add(wx(1)),a.add(wx(1))),o.sub(1),s.sub(1),u.sub(1)),l,c,h)).toVar();return wU(f)})).setLayout({name:"mx_perlin_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),jU=YI([VU,qU]),GU=vx((function(e){var t=T(e,1)[0],n=xx(t).toVar(),r=wx(iU(n)).toVar();return kU(LU(r))})).setLayout({name:"mx_cell_noise_float_0",type:"float",inputs:[{name:"p",type:"float"}]}),HU=vx((function(e){var t=T(e,1)[0],n=Ex(t).toVar(),r=wx(iU(n.x)).toVar(),i=wx(iU(n.y)).toVar();return kU(LU(r,i))})).setLayout({name:"mx_cell_noise_float_1",type:"float",inputs:[{name:"p",type:"vec2"}]}),WU=vx((function(e){var t=T(e,1)[0],n=Rx(t).toVar(),r=wx(iU(n.x)).toVar(),i=wx(iU(n.y)).toVar(),a=wx(iU(n.z)).toVar();return kU(LU(r,i,a))})).setLayout({name:"mx_cell_noise_float_2",type:"float",inputs:[{name:"p",type:"vec3"}]}),XU=vx((function(e){var t=T(e,1)[0],n=Lx(t).toVar(),r=wx(iU(n.x)).toVar(),i=wx(iU(n.y)).toVar(),a=wx(iU(n.z)).toVar(),o=wx(iU(n.w)).toVar();return kU(LU(r,i,a,o))})).setLayout({name:"mx_cell_noise_float_3",type:"float",inputs:[{name:"p",type:"vec4"}]}),QU=YI([GU,HU,WU,XU]),YU=vx((function(e){var t=T(e,1)[0],n=xx(t).toVar(),r=wx(iU(n)).toVar();return Rx(kU(LU(r,wx(0))),kU(LU(r,wx(1))),kU(LU(r,wx(2))))})).setLayout({name:"mx_cell_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"float"}]}),KU=vx((function(e){var t=T(e,1)[0],n=Ex(t).toVar(),r=wx(iU(n.x)).toVar(),i=wx(iU(n.y)).toVar();return Rx(kU(LU(r,i,wx(0))),kU(LU(r,i,wx(1))),kU(LU(r,i,wx(2))))})).setLayout({name:"mx_cell_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),ZU=vx((function(e){var t=T(e,1)[0],n=Rx(t).toVar(),r=wx(iU(n.x)).toVar(),i=wx(iU(n.y)).toVar(),a=wx(iU(n.z)).toVar();return Rx(kU(LU(r,i,a,wx(0))),kU(LU(r,i,a,wx(1))),kU(LU(r,i,a,wx(2))))})).setLayout({name:"mx_cell_noise_vec3_2",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),JU=vx((function(e){var t=T(e,1)[0],n=Lx(t).toVar(),r=wx(iU(n.x)).toVar(),i=wx(iU(n.y)).toVar(),a=wx(iU(n.z)).toVar(),o=wx(iU(n.w)).toVar();return Rx(kU(LU(r,i,a,o,wx(0))),kU(LU(r,i,a,o,wx(1))),kU(LU(r,i,a,o,wx(2))))})).setLayout({name:"mx_cell_noise_vec3_3",type:"vec3",inputs:[{name:"p",type:"vec4"}]}),$U=YI([YU,KU,ZU,JU]),eB=vx((function(e){var t=T(e,4),n=t[0],r=t[1],i=t[2],a=t[3],o=xx(a).toVar(),s=xx(i).toVar(),u=wx(r).toVar(),l=Rx(n).toVar(),c=xx(0).toVar(),h=xx(1).toVar();return vC(u,(function(){c.addAssign(h.mul(zU(l))),h.mulAssign(o),l.mulAssign(s)})),c})).setLayout({name:"mx_fractal_noise_float",type:"float",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),tB=vx((function(e){var t=T(e,4),n=t[0],r=t[1],i=t[2],a=t[3],o=xx(a).toVar(),s=xx(i).toVar(),u=wx(r).toVar(),l=Rx(n).toVar(),c=Rx(0).toVar(),h=xx(1).toVar();return vC(u,(function(){c.addAssign(h.mul(jU(l))),h.mulAssign(o),l.mulAssign(s)})),c})).setLayout({name:"mx_fractal_noise_vec3",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),nB=vx((function(e){var t=T(e,4),n=t[0],r=t[1],i=t[2],a=t[3],o=xx(a).toVar(),s=xx(i).toVar(),u=wx(r).toVar(),l=Rx(n).toVar();return Ex(eB(l,u,s,o),eB(l.add(Rx(wx(19),wx(193),wx(17))),u,s,o))})).setLayout({name:"mx_fractal_noise_vec2",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),rB=vx((function(e){var t=T(e,4),n=t[0],r=t[1],i=t[2],a=t[3],o=xx(a).toVar(),s=xx(i).toVar(),u=wx(r).toVar(),l=Rx(n).toVar(),c=Rx(tB(l,u,s,o)).toVar(),h=xx(eB(l.add(Rx(wx(19),wx(193),wx(17))),u,s,o)).toVar();return Lx(c,h)})).setLayout({name:"mx_fractal_noise_vec4",type:"vec4",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),iB=vx((function(e){var t=T(e,7),n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=wx(u).toVar(),c=xx(s).toVar(),h=wx(o).toVar(),f=wx(a).toVar(),d=wx(i).toVar(),p=wx(r).toVar(),A=Ex(n).toVar(),v=Rx($U(Ex(p.add(f),d.add(h)))).toVar(),m=Ex(v.x,v.y).toVar();m.subAssign(.5),m.mulAssign(c),m.addAssign(.5);var g=Ex(Ex(xx(p),xx(d)).add(m)).toVar(),y=Ex(g.sub(A)).toVar();return yx(l.equal(wx(2)),(function(){return CT(y.x).add(CT(y.y))})),yx(l.equal(wx(3)),(function(){return GT(CT(y.x),CT(y.y))})),YT(y,y)})).setLayout({name:"mx_worley_distance_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),aB=vx((function(e){var t=T(e,9),n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],h=wx(c).toVar(),f=xx(l).toVar(),d=wx(u).toVar(),p=wx(s).toVar(),A=wx(o).toVar(),v=wx(a).toVar(),m=wx(i).toVar(),g=wx(r).toVar(),y=Rx(n).toVar(),_=Rx($U(Rx(g.add(A),m.add(p),v.add(d)))).toVar();_.subAssign(.5),_.mulAssign(f),_.addAssign(.5);var b=Rx(Rx(xx(g),xx(m),xx(v)).add(_)).toVar(),x=Rx(b.sub(y)).toVar();return yx(h.equal(wx(2)),(function(){return CT(x.x).add(CT(x.y)).add(CT(x.z))})),yx(h.equal(wx(3)),(function(){return GT(GT(CT(x.x),CT(x.y)),CT(x.z))})),YT(x,x)})).setLayout({name:"mx_worley_distance_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"zoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),oB=YI([iB,aB]),sB=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=wx(i).toVar(),o=xx(r).toVar(),s=Ex(n).toVar(),u=wx().toVar(),l=wx().toVar(),c=Ex(aU(s.x,u),aU(s.y,l)).toVar(),h=xx(1e6).toVar();return vC({start:-1,end:wx(1),name:"x",condition:"<="},(function(e){var t=e.x;vC({start:-1,end:wx(1),name:"y",condition:"<="},(function(e){var n=e.y,r=xx(oB(c,t,n,u,l,o,a)).toVar();h.assign(jT(h,r))}))})),yx(a.equal(wx(0)),(function(){h.assign(mT(h))})),h})).setLayout({name:"mx_worley_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),uB=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=wx(i).toVar(),o=xx(r).toVar(),s=Ex(n).toVar(),u=wx().toVar(),l=wx().toVar(),c=Ex(aU(s.x,u),aU(s.y,l)).toVar(),h=Ex(1e6,1e6).toVar();return vC({start:-1,end:wx(1),name:"x",condition:"<="},(function(e){var t=e.x;vC({start:-1,end:wx(1),name:"y",condition:"<="},(function(e){var n=e.y,r=xx(oB(c,t,n,u,l,o,a)).toVar();yx(r.lessThan(h.x),(function(){h.y.assign(h.x),h.x.assign(r)})).ElseIf(r.lessThan(h.y),(function(){h.y.assign(r)}))}))})),yx(a.equal(wx(0)),(function(){h.assign(mT(h))})),h})).setLayout({name:"mx_worley_noise_vec2_0",type:"vec2",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),lB=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=wx(i).toVar(),o=xx(r).toVar(),s=Ex(n).toVar(),u=wx().toVar(),l=wx().toVar(),c=Ex(aU(s.x,u),aU(s.y,l)).toVar(),h=Rx(1e6,1e6,1e6).toVar();return vC({start:-1,end:wx(1),name:"x",condition:"<="},(function(e){var t=e.x;vC({start:-1,end:wx(1),name:"y",condition:"<="},(function(e){var n=e.y,r=xx(oB(c,t,n,u,l,o,a)).toVar();yx(r.lessThan(h.x),(function(){h.z.assign(h.y),h.y.assign(h.x),h.x.assign(r)})).ElseIf(r.lessThan(h.y),(function(){h.z.assign(h.y),h.y.assign(r)})).ElseIf(r.lessThan(h.z),(function(){h.z.assign(r)}))}))})),yx(a.equal(wx(0)),(function(){h.assign(mT(h))})),h})).setLayout({name:"mx_worley_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),cB=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=wx(i).toVar(),o=xx(r).toVar(),s=Rx(n).toVar(),u=wx().toVar(),l=wx().toVar(),c=wx().toVar(),h=Rx(aU(s.x,u),aU(s.y,l),aU(s.z,c)).toVar(),f=xx(1e6).toVar();return vC({start:-1,end:wx(1),name:"x",condition:"<="},(function(e){var t=e.x;vC({start:-1,end:wx(1),name:"y",condition:"<="},(function(e){var n=e.y;vC({start:-1,end:wx(1),name:"z",condition:"<="},(function(e){var r=e.z,i=xx(oB(h,t,n,r,u,l,c,o,a)).toVar();f.assign(jT(f,i))}))}))})),yx(a.equal(wx(0)),(function(){f.assign(mT(f))})),f})).setLayout({name:"mx_worley_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),hB=YI([sB,cB]),fB=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=wx(i).toVar(),o=xx(r).toVar(),s=Rx(n).toVar(),u=wx().toVar(),l=wx().toVar(),c=wx().toVar(),h=Rx(aU(s.x,u),aU(s.y,l),aU(s.z,c)).toVar(),f=Ex(1e6,1e6).toVar();return vC({start:-1,end:wx(1),name:"x",condition:"<="},(function(e){var t=e.x;vC({start:-1,end:wx(1),name:"y",condition:"<="},(function(e){var n=e.y;vC({start:-1,end:wx(1),name:"z",condition:"<="},(function(e){var r=e.z,i=xx(oB(h,t,n,r,u,l,c,o,a)).toVar();yx(i.lessThan(f.x),(function(){f.y.assign(f.x),f.x.assign(i)})).ElseIf(i.lessThan(f.y),(function(){f.y.assign(i)}))}))}))})),yx(a.equal(wx(0)),(function(){f.assign(mT(f))})),f})).setLayout({name:"mx_worley_noise_vec2_1",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),dB=YI([uB,fB]),pB=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=wx(i).toVar(),o=xx(r).toVar(),s=Rx(n).toVar(),u=wx().toVar(),l=wx().toVar(),c=wx().toVar(),h=Rx(aU(s.x,u),aU(s.y,l),aU(s.z,c)).toVar(),f=Rx(1e6,1e6,1e6).toVar();return vC({start:-1,end:wx(1),name:"x",condition:"<="},(function(e){var t=e.x;vC({start:-1,end:wx(1),name:"y",condition:"<="},(function(e){var n=e.y;vC({start:-1,end:wx(1),name:"z",condition:"<="},(function(e){var r=e.z,i=xx(oB(h,t,n,r,u,l,c,o,a)).toVar();yx(i.lessThan(f.x),(function(){f.z.assign(f.y),f.y.assign(f.x),f.x.assign(i)})).ElseIf(i.lessThan(f.y),(function(){f.z.assign(f.y),f.y.assign(i)})).ElseIf(i.lessThan(f.z),(function(){f.z.assign(i)}))}))}))})),yx(a.equal(wx(0)),(function(){f.assign(mT(f))})),f})).setLayout({name:"mx_worley_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),AB=YI([lB,pB]),vB=vx((function(e){var t=T(e,1)[0],n=t.y,r=t.z,i=Rx().toVar();return yx(n.lessThan(1e-4),(function(){i.assign(Rx(r,r,r))})).Else((function(){var e=t.x;e=e.sub(yT(e)).mul(6).toVar();var a=wx(BT(e)),o=e.sub(xx(a)),s=r.mul(n.oneMinus()),u=r.mul(n.mul(o).oneMinus()),l=r.mul(n.mul(o.oneMinus()).oneMinus());yx(a.equal(wx(0)),(function(){i.assign(Rx(r,l,s))})).ElseIf(a.equal(wx(1)),(function(){i.assign(Rx(u,r,s))})).ElseIf(a.equal(wx(2)),(function(){i.assign(Rx(s,r,l))})).ElseIf(a.equal(wx(3)),(function(){i.assign(Rx(s,u,r))})).ElseIf(a.equal(wx(4)),(function(){i.assign(Rx(l,s,r))})).Else((function(){i.assign(Rx(r,s,u))}))})),i})).setLayout({name:"mx_hsvtorgb",type:"vec3",inputs:[{name:"hsv",type:"vec3"}]}),mB=vx((function(e){var t=T(e,1)[0],n=Rx(t).toVar(),r=xx(n.x).toVar(),i=xx(n.y).toVar(),a=xx(n.z).toVar(),o=xx(jT(r,jT(i,a))).toVar(),s=xx(GT(r,GT(i,a))).toVar(),u=xx(s.sub(o)).toVar(),l=xx().toVar(),c=xx().toVar(),h=xx().toVar();return h.assign(s),yx(s.greaterThan(0),(function(){c.assign(u.div(s))})).Else((function(){c.assign(0)})),yx(c.lessThanEqual(0),(function(){l.assign(0)})).Else((function(){yx(r.greaterThanEqual(s),(function(){l.assign(i.sub(a).div(u))})).ElseIf(i.greaterThanEqual(s),(function(){l.assign(Dw(2,a.sub(r).div(u)))})).Else((function(){l.assign(Dw(4,r.sub(i).div(u)))})),l.mulAssign(1/6),yx(l.lessThan(0),(function(){l.addAssign(1)}))})),Rx(l,c,h)})).setLayout({name:"mx_rgbtohsv",type:"vec3",inputs:[{name:"c",type:"vec3"}]}),gB=vx((function(e){var t=T(e,1)[0],n=Rx(t).toVar(),r=Ix(jw(n,Rx(.04045))).toVar(),i=Rx(n.div(12.92)).toVar(),a=Rx(ZT(GT(n.add(Rx(.055)),Rx(0)).div(1.055),Rx(2.4))).toVar();return iS(i,a,r)})).setLayout({name:"mx_srgb_texture_to_lin_rec709",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),yB=function(e,t){e=xx(e),t=xx(t);var n=Ex(t.dFdx(),t.dFdy()).length().mul(.7071067811865476);return uS(e.sub(n),e.add(n),t)},_B=function(e,t,n,r){return iS(e,t,n[r].clamp())},bB=function(e,t,n,r,i){return iS(e,t,yB(n,r[i]))},xB=vx((function(e){var t=T(e,3),n=t[0],r=t[1],i=t[2],a=bT(n).toVar(),o=Ow(xx(.5).mul(r.sub(i)),ok).div(a).toVar(),s=Ow(xx(-.5).mul(r.sub(i)),ok).div(a).toVar(),u=Rx().toVar();u.x=a.x.greaterThan(xx(0)).select(o.x,s.x),u.y=a.y.greaterThan(xx(0)).select(o.y,s.y),u.z=a.z.greaterThan(xx(0)).select(o.z,s.z);var l=jT(jT(u.x,u.y),u.z).toVar();return ok.add(a.mul(l)).toVar().sub(i)})),wB=vx((function(e){var t=T(e,2),n=t[0],r=t[1],i=n.x,a=n.y,o=n.z,s=r.element(0).mul(.886227);return s=(s=(s=(s=(s=(s=(s=(s=s.add(r.element(1).mul(1.023328).mul(a))).add(r.element(2).mul(1.023328).mul(o))).add(r.element(3).mul(1.023328).mul(i))).add(r.element(4).mul(.858086).mul(i).mul(a))).add(r.element(5).mul(.858086).mul(a).mul(o))).add(r.element(6).mul(o.mul(o).mul(.743125).sub(.247708)))).add(r.element(7).mul(.858086).mul(i).mul(o))).add(r.element(8).mul(.429043).mul(Uw(i,i).sub(Uw(a,a))))})),TB=Object.freeze({__proto__:null,BRDF_GGX:QR,BRDF_Lambert:IR,BasicPointShadowFilter:qO,BasicShadowFilter:RO,Break:mC,Const:SS,Continue:function(){return oE("continue").append()},DFGApprox:YR,D_GGX:HR,Discard:sE,EPSILON:aT,F_Schlick:NR,Fn:vx,INFINITY:oT,If:yx,Loop:vC,NodeAccess:nb,NodeShaderStage:eb,NodeType:{BOOLEAN:"bool",INTEGER:"int",FLOAT:"float",VECTOR2:"vec2",VECTOR3:"vec3",VECTOR4:"vec4",MATRIX2:"mat2",MATRIX3:"mat3",MATRIX4:"mat4"},NodeUpdateType:tb,PCFShadowFilter:PO,PCFSoftShadowFilter:NO,PI:sT,PI2:uT,PointShadowFilter:jO,Return:function(){return oE("return").append()},Schlick_to_F0:ZR,ScriptableNodeResources:DD,ShaderNode:lx,TBNViewMatrix:Jk,VSMShadowFilter:IO,V_GGX_SmithCorrelated:jR,Var:TS,abs:CT,acesFilmicToneMapping:bD,acos:kT,add:Dw,addMethodChaining:wb,addNodeElement:function(e){console.warn("THREE.TSL: AddNodeElement has been removed in favor of tree-shaking. Trying add",e)},agxToneMapping:SD,all:lT,alphaT:dw,and:Ww,anisotropy:pw,anisotropyB:vw,anisotropyT:Aw,any:cT,append:_x,array:Gx,arrayBuffer:function(e){return cx(new yb(e,"ArrayBuffer"))},asin:ET,assign:Pw,atan:MT,atan2:dS,atomicAdd:function(e,t){return aO(nO.ATOMIC_ADD,e,t)},atomicAnd:function(e,t){return aO(nO.ATOMIC_AND,e,t)},atomicFunc:aO,atomicLoad:function(e){return aO(nO.ATOMIC_LOAD,e,null)},atomicMax:function(e,t){return aO(nO.ATOMIC_MAX,e,t)},atomicMin:function(e,t){return aO(nO.ATOMIC_MIN,e,t)},atomicOr:function(e,t){return aO(nO.ATOMIC_OR,e,t)},atomicStore:function(e,t){return aO(nO.ATOMIC_STORE,e,t)},atomicSub:function(e,t){return aO(nO.ATOMIC_SUB,e,t)},atomicXor:function(e,t){return aO(nO.ATOMIC_XOR,e,t)},attenuationColor:Mw,attenuationDistance:kw,attribute:dE,attributeArray:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float";!0===r.isStruct?(t=r.layout.getLength(),n=X_("float")):(t=Q_(r),n=X_(r));var i=new LL(e,t,n),a=hC(i,r,e);return a},backgroundBlurriness:zL,backgroundIntensity:VL,backgroundRotation:qL,batch:sC,billboarding:tL,bitAnd:Kw,bitNot:Zw,bitOr:Jw,bitXor:$w,bitangentGeometry:Wk,bitangentLocal:Xk,bitangentView:Qk,bitangentWorld:Yk,bitcast:VT,blendBurn:eD,blendColor:iD,blendDodge:tD,blendOverlay:rD,blendScreen:nD,blur:YP,bool:Sx,buffer:wE,bufferAttribute:XS,bumpMap:sM,burn:function(){console.warn('THREE.TSL: "burn" has been renamed. Use "blendBurn" instead.');for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return eD(t)},bvec2:Cx,bvec3:Ix,bvec4:Ux,bypass:tE,cache:eE,call:Iw,cameraFar:CE,cameraIndex:kE,cameraNear:ME,cameraNormalMatrix:LE,cameraPosition:DE,cameraProjectionMatrix:RE,cameraProjectionMatrixInverse:PE,cameraViewMatrix:NE,cameraWorldMatrix:IE,cbrt:nS,cdl:cD,ceil:_T,checker:eU,cineonToneMapping:yD,clamp:aS,clearcoat:ow,clearcoatRoughness:sw,code:MD,color:bx,colorSpaceToWorking:BS,colorToDirection:function(e){return cx(e).mul(2).sub(1)},compute:JS,computeSkinning:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=new dC(e);return n.positionNode=hC(new ko(e.geometry.getAttribute("position").array,3),"vec3").setPBO(!0).toReadOnly().element(ZM).toVar(),n.skinIndexNode=hC(new ko(new Uint32Array(e.geometry.getAttribute("skinIndex").array),4),"uvec4").setPBO(!0).toReadOnly().element(ZM).toVar(),n.skinWeightNode=hC(new ko(e.geometry.getAttribute("skinWeight").array,4),"vec4").setPBO(!0).toReadOnly().element(ZM).toVar(),n.bindMatrixNode=Jx(e.bindMatrix,"mat4"),n.bindMatrixInverseNode=Jx(e.bindMatrixInverse,"mat4"),n.boneMatricesNode=wE(e.skeleton.boneMatrices,"mat4",e.skeleton.bones.length),n.toPositionNode=t,cx(n)},cond:gS,context:_S,convert:qx,convertColorSpace:function(e,t,n){return cx(new LS(cx(e),t,n))},convertToTexture:function(e){if(e.isTextureNode)return e;if(e.isPassNode)return e.getTextureNode();for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return CL.apply(void 0,[e].concat(n))},cos:TT,cross:KT,cubeTexture:Nk,cubeToUV:VO,dFdx:LT,dFdy:DT,dashSize:bw,debug:hE,defaultBuildStages:ib,defaultShaderStages:rb,defined:sx,degrees:fT,deltaTime:ZI,densityFog:function(e,t){return console.warn('THREE.TSL: "densityFog( color, density )" is deprecated. Use "fog( color, densityFogFactor( density ) )" instead.'),VD(e,zD(t))},densityFogFactor:zD,depth:eR,depthPass:function(e,t,n){return cx(new AD(AD.DEPTH,e,t,n))},difference:QT,diffuseColor:nw,directPointLight:JO,directionToColor:vR,dispersion:Cw,distance:XT,div:Bw,dodge:function(){console.warn('THREE.TSL: "dodge" has been renamed. Use "blendDodge" instead.');for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return tD(t)},dot:YT,drawIndex:tC,dynamicBufferAttribute:QS,element:Vx,emissive:rw,equal:zw,equals:qT,equirectUV:_R,exp:dT,exp2:pT,expression:oE,faceDirection:hk,faceForward:lS,faceforward:pS,float:xx,floor:yT,fog:VD,fract:xT,frameGroup:Qx,frameId:JI,frontFacing:ck,fwidth:FT,gain:function(e,t){return e.lessThan(.5)?jI(e.mul(2),t).div(2):Ow(1,jI(Uw(Ow(1,e),2),t).div(2))},gapSize:xw,getConstNodeType:ux,getCurrentStack:gx,getDirection:HP,getDistanceAttenuation:ZO,getGeometryRoughness:VR,getNormalFromDepth:NL,getParallaxCorrectNormal:xB,getRoughness:qR,getScreenPosition:PL,getShIrradianceAt:wB,getTextureIndex:zI,getViewPosition:RL,globalId:KD,glsl:function(e,t){return MD(e,t,"glsl")},glslFn:function(e,t){return RD(e,t,"glsl")},grayscale:aD,greaterThan:jw,greaterThanEqual:Hw,hash:qI,highpModelNormalViewMatrix:nk,highpModelViewMatrix:tk,hue:uD,instance:rC,instanceIndex:ZM,instancedArray:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float";!0===r.isStruct?(t=r.layout.getLength(),n=X_("float")):(t=Q_(r),n=X_(r));var i=new IL(e,t,n),a=hC(i,r,e);return a},instancedBufferAttribute:YS,instancedDynamicBufferAttribute:KS,instancedMesh:aC,int:wx,inverseSqrt:gT,inversesqrt:AS,invocationLocalIndex:eC,invocationSubgroupIndex:$M,ior:Tw,iridescence:cw,iridescenceIOR:hw,iridescenceThickness:fw,ivec2:kx,ivec3:Px,ivec4:Dx,js:function(e,t){return MD(e,t,"js")},label:bS,length:PT,lengthSq:rS,lessThan:qw,lessThanEqual:Gw,lightPosition:lO,lightProjectionUV:uO,lightShadowMatrix:sO,lightTargetDirection:fO,lightTargetPosition:cO,lightViewPosition:hO,lightingContext:MC,lights:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return cx(new AO).setLights(e)},linearDepth:tR,linearToneMapping:mD,localId:ZD,log:AT,log2:vT,logarithmicDepthToViewZ:function(e,t,n){var r=e.mul(AT(n.div(t)));return xx(Math.E).pow(r).mul(t).negate()},loop:function(){return console.warn("THREE.TSL: loop() has been renamed to Loop()."),vC.apply(void 0,arguments)},luminance:lD,mat2:Bx,mat3:Fx,mat4:zx,matcapUV:DN,materialAO:WM,materialAlphaTest:cM,materialAnisotropy:CM,materialAnisotropyVector:XM,materialAttenuationColor:UM,materialAttenuationDistance:OM,materialClearcoat:wM,materialClearcoatNormal:SM,materialClearcoatRoughness:TM,materialColor:hM,materialDispersion:GM,materialEmissive:dM,materialEnvIntensity:Sk,materialEnvRotation:Ek,materialIOR:DM,materialIridescence:RM,materialIridescenceIOR:PM,materialIridescenceThickness:NM,materialLightMap:HM,materialLineDashOffset:qM,materialLineDashSize:FM,materialLineGapSize:zM,materialLineScale:BM,materialLineWidth:VM,materialMetalness:bM,materialNormal:xM,materialOpacity:pM,materialPointSize:jM,materialReference:Bk,materialReflectivity:yM,materialRefractionRatio:Tk,materialRotation:EM,materialRoughness:_M,materialSheen:kM,materialSheenRoughness:MM,materialShininess:fM,materialSpecular:AM,materialSpecularColor:mM,materialSpecularIntensity:vM,materialSpecularStrength:gM,materialThickness:LM,materialTransmission:IM,max:GT,maxMipLevel:gE,mediumpModelViewMatrix:ek,metalness:aw,min:jT,mix:iS,mixElement:hS,mod:Fw,modInt:rT,modelDirection:HE,modelNormalMatrix:ZE,modelPosition:XE,modelRadius:KE,modelScale:QE,modelViewMatrix:$E,modelViewPosition:YE,modelViewProjection:QM,modelWorldMatrix:WE,modelWorldMatrixInverse:JE,morphReference:TC,mrt:VI,mul:Uw,mx_aastep:yB,mx_cell_noise_float:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pE();return QU(e.convert("vec2|vec3"))},mx_contrast:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return xx(e).sub(n).mul(t).add(n)},mx_fractal_noise_float:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return eB(e,wx(t),n,r).mul(i)},mx_fractal_noise_vec2:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return nB(e,wx(t),n,r).mul(i)},mx_fractal_noise_vec3:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return tB(e,wx(t),n,r).mul(i)},mx_fractal_noise_vec4:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return rB(e,wx(t),n,r).mul(i)},mx_hsvtorgb:vB,mx_noise_float:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return zU(e.convert("vec2|vec3")).mul(t).add(n)},mx_noise_vec3:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return jU(e.convert("vec2|vec3")).mul(t).add(n)},mx_noise_vec4:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e=e.convert("vec2|vec3");var r=Lx(jU(e),zU(e.add(Ex(19,73))));return r.mul(t).add(n)},mx_ramplr:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pE();return _B(e,t,n,"x")},mx_ramptb:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pE();return _B(e,t,n,"y")},mx_rgbtohsv:mB,mx_safepower:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(e=xx(e)).abs().pow(t).mul(e.sign())},mx_splitlr:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:pE();return bB(e,t,n,r,"x")},mx_splittb:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:pE();return bB(e,t,n,r,"y")},mx_srgb_texture_to_lin_rec709:gB,mx_transform_uv:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pE();return n.mul(e).add(t)},mx_worley_noise_float:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return hB(e.convert("vec2|vec3"),t,wx(1))},mx_worley_noise_vec2:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return dB(e.convert("vec2|vec3"),t,wx(1))},mx_worley_noise_vec3:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pE(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return AB(e.convert("vec2|vec3"),t,wx(1))},negate:NT,neutralToneMapping:ED,nodeArray:fx,nodeImmutable:px,nodeObject:cx,nodeObjects:hx,nodeProxy:dx,normalFlat:pk,normalGeometry:fk,normalLocal:dk,normalMap:rM,normalView:Ak,normalWorld:vk,normalize:bT,not:Qw,notEqual:Vw,numWorkgroups:QD,objectDirection:BE,objectGroup:Kx,objectPosition:zE,objectRadius:jE,objectScale:VE,objectViewPosition:qE,objectWorldMatrix:FE,oneMinus:IT,or:Xw,orthographicDepthToViewZ:function(e,t,n){return t.sub(n).mul(e).sub(t)},oscSawtooth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:KI;return e.fract()},oscSine:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:KI;return e.add(.75).mul(2*Math.PI).sin().mul(.5).add(.5)},oscSquare:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:KI;return e.fract().round()},oscTriangle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:KI;return e.add(.5).fract().mul(2).sub(1).abs()},output:_w,outputStruct:FI,overlay:function(){console.warn('THREE.TSL: "overlay" has been renamed. Use "blendOverlay" instead.');for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return rD(t)},overloadingFn:YI,parabola:jI,parallaxDirection:$k,parallaxUV:function(e,t){return e.sub($k.mul(t))},parameter:function(e,t){return cx(new NI(e,t))},pass:function(e,t,n){return cx(new AD(AD.COLOR,e,t,n))},passTexture:function(e,t){return cx(new dD(e,t))},pcurve:function(e,t,n){return ZT(Bw(ZT(e,t),Dw(ZT(e,t),ZT(Ow(1,e),n))),1/t)},perspectiveDepthToViewZ:ZC,pmremTexture:bN,pointShadow:YO,pointUV:OL,pointWidth:ww,positionGeometry:rk,positionLocal:ik,positionPrevious:ak,positionView:uk,positionViewDirection:lk,positionWorld:ok,positionWorldDirection:sk,posterize:hD,pow:ZT,pow2:JT,pow3:$T,pow4:eS,property:ew,radians:hT,rand:cS,range:HD,rangeFog:function(e,t,n){return console.warn('THREE.TSL: "rangeFog( color, near, far )" is deprecated. Use "fog( color, rangeFogFactor( near, far ) )" instead.'),VD(e,FD(t,n))},rangeFogFactor:FD,reciprocal:UT,reference:Dk,referenceBuffer:Ok,reflect:WT,reflectVector:Ck,reflectView:kk,reflector:function(e){return cx(new bL(e))},refract:sS,refractVector:Rk,refractView:Mk,reinhardToneMapping:gD,remainder:nT,remap:rE,remapClamp:iE,renderGroup:Yx,renderOutput:lE,rendererReference:qS,rotate:BN,rotateUV:$I,roughness:iw,round:OT,rtt:CL,sRGBTransferEOTF:RS,sRGBTransferOETF:PS,sampler:function(e){return(!0===e.isNode?e:_E(e)).convert("sampler")},samplerComparison:function(e){return(!0===e.isNode?e:_E(e)).convert("samplerComparison")},saturate:oS,saturation:oD,screen:function(){console.warn('THREE.TSL: "screen" has been renamed. Use "blendScreen" instead.');for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return nD(t)},screenCoordinate:IC,screenSize:NC,screenUV:PC,scriptable:UD,scriptableValue:ND,select:mS,setCurrentStack:mx,shaderStages:ab,shadow:FO,shadowPositionWorld:mO,shapeCircle:tU,sharedUniformGroup:Xx,sheen:uw,sheenRoughness:lw,shiftLeft:eT,shiftRight:tT,shininess:yw,sign:RT,sin:wT,sinc:function(e,t){return wT(sT.mul(t.mul(e).sub(1))).div(sT.mul(t.mul(e).sub(1)))},skinning:pC,smoothstep:uS,smoothstepElement:fS,specularColor:mw,specularF90:gw,spherizeUV:eL,split:function(e,t){return cx(new pb(cx(e),t))},spritesheetUV:iL,sqrt:mT,stack:LI,step:HT,storage:hC,storageBarrier:function(){return $D("storage").append()},storageObject:function(e,t,n){return console.warn('THREE.TSL: "storageObject()" is deprecated. Use "storage().setPBO( true )" instead.'),hC(e,t,n).setPBO(!0)},storageTexture:GL,string:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return cx(new yb(e,"string"))},struct:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=new OI(e,t),r=function(){for(var t=null,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];if(i.length>0)if(i[0].isNode){t={};for(var o=Object.keys(e),s=0;s<i.length;s++)t[o[s]]=i[s]}else t=i[0];return cx(new UI(n,t))};return r.layout=n,r.isStruct=!0,r},sub:Ow,subgroupIndex:JM,subgroupSize:JD,tan:ST,tangentGeometry:Fk,tangentLocal:zk,tangentView:Vk,tangentWorld:qk,temp:ES,texture:_E,texture3D:XL,textureBarrier:function(){return $D("texture").append()},textureBicubic:AP,textureCubeUV:WP,textureLoad:bE,textureSize:vE,textureStore:function(e,t,n){var r=GL(e,t,n);return null!==n&&r.append(),r},thickness:Ew,time:KI,timerDelta:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return console.warn('TSL: timerDelta() is deprecated. Use "deltaTime" instead.'),ZI.mul(e)},timerGlobal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return console.warn('TSL: timerGlobal() is deprecated. Use "time" instead.'),KI.mul(e)},timerLocal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return console.warn('TSL: timerLocal() is deprecated. Use "time" instead.'),KI.mul(e)},toOutputColorSpace:DS,toWorkingColorSpace:OS,toneMapping:GS,toneMappingExposure:HS,toonOutlinePass:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ga(0,0,0),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.003,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return cx(new vD(e,t,cx(n),cx(r),cx(i)))},transformDirection:tS,transformNormal:_k,transformNormalToView:bk,transformedBentNormalView:eM,transformedBitangentView:Kk,transformedBitangentWorld:Zk,transformedClearcoatNormalView:yk,transformedNormalView:mk,transformedNormalWorld:gk,transformedTangentView:jk,transformedTangentWorld:Gk,transmission:Sw,transpose:zT,triNoise3D:WI,triplanarTexture:function(){return oL.apply(void 0,arguments)},triplanarTextures:oL,trunc:BT,tslFn:function(){return console.warn("THREE.TSL: tslFn() has been renamed to Fn()."),vx.apply(void 0,arguments)},uint:Tx,uniform:Jx,uniformArray:EE,uniformGroup:Wx,uniforms:function(e,t){return console.warn("THREE.TSL: uniforms() has been renamed to uniformArray()."),cx(new SE(e,t))},userData:function(e,t,n){return cx(new QL(e,t,n))},uv:pE,uvec2:Mx,uvec3:Nx,uvec4:Ox,varying:MS,varyingProperty:tw,vec2:Ex,vec3:Rx,vec4:Lx,vectorComponents:ob,velocity:$L,vertexColor:function(e){return cx(new DL(e))},vertexIndex:KM,vertexStage:CS,vibrance:sD,viewZToLogarithmicDepth:JC,viewZToOrthographicDepth:YC,viewZToPerspectiveDepth:KC,viewport:LC,viewportBottomLeft:zC,viewportCoordinate:OC,viewportDepthTexture:XC,viewportLinearDepth:nR,viewportMipTexture:GC,viewportResolution:BC,viewportSafeUV:nL,viewportSharedTexture:AR,viewportSize:DC,viewportTexture:jC,viewportTopLeft:FC,viewportUV:UC,wgsl:function(e,t){return MD(e,t,"wgsl")},wgslFn:function(e,t){return RD(e,t,"wgsl")},workgroupArray:function(e,t){return cx(new tO("Workgroup",e,t))},workgroupBarrier:function(){return $D("workgroup").append()},workgroupId:YD,workingToColorSpace:US,xor:Yw}),SB=new PI,EB=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this)).renderer=e,i.nodes=r,i}return p(n,[{key:"update",value:function(e,t,n){var r=this.renderer,i=this.nodes.getBackgroundNode(e)||e.background,a=!1;if(null===i)r._clearColor.getRGB(SB),SB.a=r._clearColor.a;else if(!0===i.isColor)i.getRGB(SB),SB.a=1,a=!0;else if(!0===i.isNode){var o=this.get(e),s=i;SB.copy(r._clearColor);var u=o.backgroundMesh;if(void 0===u){var l=_S(Lx(s).mul(VL),{getUV:function(){return qL.mul(vk)},getTextureLevel:function(){return zL}}),c=QM;c=c.setZ(c.w);var h=new uR;h.name="Background.material",h.side=1,h.depthTest=!1,h.depthWrite=!1,h.allowOverride=!1,h.fog=!1,h.lights=!1,h.vertexNode=c,h.colorNode=l,o.backgroundMeshNode=l,o.backgroundMesh=u=new eo(new uu(1,32,32),h),u.frustumCulled=!1,u.name="Background.mesh",u.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)}}var f=s.getCacheKey();o.backgroundCacheKey!==f&&(o.backgroundMeshNode.node=Lx(s).mul(VL),o.backgroundMeshNode.needsUpdate=!0,u.material.needsUpdate=!0,o.backgroundCacheKey=f),t.unshift(u,u.geometry,u.material,0,0,null,null)}else console.error("THREE.Renderer: Unsupported background configuration.",i);var d=r.xr.getEnvironmentBlendMode();if("additive"===d?SB.set(0,0,0,1):"alpha-blend"===d&&SB.set(0,0,0,0),!0===r.autoClear||!0===a){var p=n.clearColorValue;p.r=SB.r,p.g=SB.g,p.b=SB.b,p.a=SB.a,!0!==r.backend.isWebGLBackend&&!0!==r.alpha||(p.r*=p.a,p.g*=p.a,p.b*=p.a),n.depthClearValue=r._clearDepth,n.stencilClearValue=r._clearStencil,n.clearColor=!0===r.autoClearColor,n.clearDepth=!0===r.autoClearDepth,n.clearStencil=!0===r.autoClearStencil}else n.clearColor=!1,n.clearDepth=!1,n.clearStencil=!1}}]),n}(JN),kB=0,MB=p((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];c(this,e),this.name=t,this.bindings=n,this.index=r,this.bindingsReference=i,this.id=kB++})),CB=function(){function e(t,n,r,i,a,o,s,u,l){var h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];c(this,e),this.vertexShader=t,this.fragmentShader=n,this.computeShader=r,this.transforms=h,this.nodeAttributes=i,this.bindings=a,this.updateNodes=o,this.updateBeforeNodes=s,this.updateAfterNodes=u,this.observer=l,this.usedTimes=0}return p(e,[{key:"createBindings",value:function(){var e,t=[],n=k(this.bindings);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(!0!==r.bindings[0].groupNode.shared){var i=new MB(r.name,[],r.index,r);t.push(i);var a,o=k(r.bindings);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.bindings.push(s.clone())}}catch(u){o.e(u)}finally{o.f()}}else t.push(r)}}catch(u){n.e(u)}finally{n.f()}return t}}]),e}(),RB=p((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;c(this,e),this.isNodeAttribute=!0,this.name=t,this.type=n,this.node=r})),PB=function(){function e(t,n,r){c(this,e),this.isNodeUniform=!0,this.name=t,this.type=n,this.node=r.getSelf()}return p(e,[{key:"value",get:function(){return this.node.value},set:function(e){this.node.value=e}},{key:"id",get:function(){return this.node.id}},{key:"groupNode",get:function(){return this.node.groupNode}}]),e}(),NB=p((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;c(this,e),this.isNodeVar=!0,this.name=t,this.type=n,this.readOnly=r,this.count=i})),IB=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,e,r)).needsInterpolation=!1,i.isNodeVarying=!0,i}return p(n)}(NB),LB=p((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";c(this,e),this.name=t,this.type=n,this.code=r,Object.defineProperty(this,"isNodeCode",{value:!0})})),DB=0,OB=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;c(this,e),this.id=DB++,this.nodesData=new WeakMap,this.parent=t}return p(e,[{key:"getData",value:function(e){var t=this.nodesData.get(e);return void 0===t&&null!==this.parent&&(t=this.parent.getData(e)),t}},{key:"setData",value:function(e,t){this.nodesData.set(e,t)}}]),e}(),UB=p((function e(t,n){c(this,e),this.name=t,this.members=n,this.output=!1})),BB=function(){function e(t,n){c(this,e),this.name=t,this.value=n,this.boundary=0,this.itemSize=0,this.offset=0}return p(e,[{key:"setValue",value:function(e){this.value=e}},{key:"getValue",value:function(){return this.value}}]),e}(),FB=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return c(this,n),(r=t.call(this,e,i)).isNumberUniform=!0,r.boundary=4,r.itemSize=1,r}return p(n)}(BB),zB=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _r;return c(this,n),(r=t.call(this,e,i)).isVector2Uniform=!0,r.boundary=8,r.itemSize=2,r}return p(n)}(BB),VB=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Kr;return c(this,n),(r=t.call(this,e,i)).isVector3Uniform=!0,r.boundary=16,r.itemSize=3,r}return p(n)}(BB),qB=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Gr;return c(this,n),(r=t.call(this,e,i)).isVector4Uniform=!0,r.boundary=16,r.itemSize=4,r}return p(n)}(BB),jB=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ga;return c(this,n),(r=t.call(this,e,i)).isColorUniform=!0,r.boundary=16,r.itemSize=3,r}return p(n)}(BB),GB=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new kl;return c(this,n),(r=t.call(this,e,i)).isMatrix2Uniform=!0,r.boundary=16,r.itemSize=4,r}return p(n)}(BB),HB=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new br;return c(this,n),(r=t.call(this,e,i)).isMatrix3Uniform=!0,r.boundary=48,r.itemSize=12,r}return p(n)}(BB),WB=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ei;return c(this,n),(r=t.call(this,e,i)).isMatrix4Uniform=!0,r.boundary=64,r.itemSize=16,r}return p(n)}(BB),XB=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,e.name,e.value)).nodeUniform=e,r}return p(n,[{key:"getValue",value:function(){return this.nodeUniform.value}},{key:"getType",value:function(){return this.nodeUniform.type}}]),n}(FB),QB=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,e.name,e.value)).nodeUniform=e,r}return p(n,[{key:"getValue",value:function(){return this.nodeUniform.value}},{key:"getType",value:function(){return this.nodeUniform.type}}]),n}(zB),YB=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,e.name,e.value)).nodeUniform=e,r}return p(n,[{key:"getValue",value:function(){return this.nodeUniform.value}},{key:"getType",value:function(){return this.nodeUniform.type}}]),n}(VB),KB=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,e.name,e.value)).nodeUniform=e,r}return p(n,[{key:"getValue",value:function(){return this.nodeUniform.value}},{key:"getType",value:function(){return this.nodeUniform.type}}]),n}(qB),ZB=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,e.name,e.value)).nodeUniform=e,r}return p(n,[{key:"getValue",value:function(){return this.nodeUniform.value}},{key:"getType",value:function(){return this.nodeUniform.type}}]),n}(jB),JB=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,e.name,e.value)).nodeUniform=e,r}return p(n,[{key:"getValue",value:function(){return this.nodeUniform.value}},{key:"getType",value:function(){return this.nodeUniform.type}}]),n}(GB),$B=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,e.name,e.value)).nodeUniform=e,r}return p(n,[{key:"getValue",value:function(){return this.nodeUniform.value}},{key:"getType",value:function(){return this.nodeUniform.type}}]),n}(HB),eF=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,e.name,e.value)).nodeUniform=e,r}return p(n,[{key:"getValue",value:function(){return this.nodeUniform.value}},{key:"getType",value:function(){return this.nodeUniform.type}}]),n}(WB),tF=new WeakMap,nF=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),rF=function(e){return/e/g.test(e)?String(e).replace(/\+/g,""):(e=Number(e))+(e%1?"":".0")},iF=function(){function e(t,n,r){c(this,e),this.object=t,this.material=t&&t.material||null,this.geometry=t&&t.geometry||null,this.renderer=n,this.parser=r,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.observer=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.declarations={},this.flow={code:""},this.chaining=[],this.stack=LI(),this.stacks=[],this.tab="\t",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new OB,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null}return p(e,[{key:"getBindGroupsCache",value:function(){var e=tF.get(this.renderer);return void 0===e&&(e=new XN,tF.set(this.renderer,e)),e}},{key:"createRenderTarget",value:function(e,t,n){return new Hr(e,t,n)}},{key:"createCubeRenderTarget",value:function(e,t){return new bR(e,t)}},{key:"includes",value:function(e){return this.nodes.includes(e)}},{key:"getOutputStructName",value:function(){}},{key:"_getBindGroup",value:function(e,t){var n,r,i=this.getBindGroupsCache(),a=[],o=!0,s=k(t);try{for(s.s();!(n=s.n()).done;){var u=n.value;a.push(u),o=o&&!0!==u.groupNode.shared}}catch(l){s.e(l)}finally{s.f()}return o?void 0===(r=i.get(a))&&(r=new MB(e,a,this.bindingsIndexes[e].group,a),i.set(a,r)):r=new MB(e,a,this.bindingsIndexes[e].group,a),r}},{key:"getBindGroupArray",value:function(e,t){var n=this.bindings[t],r=n[e];return void 0===r&&(void 0===this.bindingsIndexes[e]&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),n[e]=r=[]),r}},{key:"getBindings",value:function(){var e=this.bindGroups;if(null===e){var t,n={},r=this.bindings,i=k(ab);try{for(i.s();!(t=i.n()).done;){var a=t.value;for(var o in r[a]){var s=r[a][o],u=n[o]||(n[o]=[]);u.push.apply(u,l(s))}}}catch(d){i.e(d)}finally{i.f()}for(var c in e=[],n){var h=n[c],f=this._getBindGroup(c,h);e.push(f)}this.bindGroups=e}return e}},{key:"sortBindingGroups",value:function(){var e=this.getBindings();e.sort((function(e,t){return e.bindings[0].groupNode.order-t.bindings[0].groupNode.order}));for(var t=0;t<e.length;t++){var n=e[t];this.bindingsIndexes[n.name].group=t,n.index=t}}},{key:"setHashNode",value:function(e,t){this.hashNodes[t]=e}},{key:"addNode",value:function(e){!1===this.nodes.includes(e)&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}},{key:"addSequentialNode",value:function(e){!1===this.sequentialNodes.includes(e)&&this.sequentialNodes.push(e)}},{key:"buildUpdateNodes",value:function(){var e,t=k(this.nodes);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.getUpdateType()!==tb.NONE&&this.updateNodes.push(n.getSelf())}}catch(u){t.e(u)}finally{t.f()}var r,i=k(this.sequentialNodes);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=a.getUpdateBeforeType(),s=a.getUpdateAfterType();o!==tb.NONE&&this.updateBeforeNodes.push(a.getSelf()),s!==tb.NONE&&this.updateAfterNodes.push(a.getSelf())}}catch(u){i.e(u)}finally{i.f()}}},{key:"currentNode",get:function(){return this.chaining[this.chaining.length-1]}},{key:"isFilteredTexture",value:function(e){return e.magFilter===Ut||e.magFilter===Bt||e.magFilter===Ot||e.magFilter===Ft||e.minFilter===Ut||e.minFilter===Bt||e.minFilter===Ot||e.minFilter===Ft}},{key:"addChain",value:function(e){this.chaining.push(e)}},{key:"removeChain",value:function(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}},{key:"getMethod",value:function(e){return e}},{key:"getNodeFromHash",value:function(e){return this.hashNodes[e]}},{key:"addFlow",value:function(e,t){return this.flowNodes[e].push(t),t}},{key:"setContext",value:function(e){this.context=e}},{key:"getContext",value:function(){return this.context}},{key:"getSharedContext",value:function(){return Qe({},this.context),this.context}},{key:"setCache",value:function(e){this.cache=e}},{key:"getCache",value:function(){return this.cache}},{key:"getCacheFromNode",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getDataFromNode(e);return void 0===n.cache&&(n.cache=new OB(t?this.getCache():null)),n.cache}},{key:"isAvailable",value:function(){return!1}},{key:"getVertexIndex",value:function(){console.warn("Abstract function.")}},{key:"getInstanceIndex",value:function(){console.warn("Abstract function.")}},{key:"getDrawIndex",value:function(){console.warn("Abstract function.")}},{key:"getFrontFacing",value:function(){console.warn("Abstract function.")}},{key:"getFragCoord",value:function(){console.warn("Abstract function.")}},{key:"isFlipY",value:function(){return!1}},{key:"increaseUsage",value:function(e){var t=this.getDataFromNode(e);return t.usageCount=void 0===t.usageCount?1:t.usageCount+1,t.usageCount}},{key:"generateTexture",value:function(){console.warn("Abstract function.")}},{key:"generateTextureLod",value:function(){console.warn("Abstract function.")}},{key:"generateArrayDeclaration",value:function(e,t){return this.getType(e)+"[ "+t+" ]"}},{key:"generateArray",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.generateArrayDeclaration(e,t)+"( ",i=0;i<t;i++){var a=n?n[i]:null;r+=null!==a?a.build(this,e):this.generateConst(e),i<t-1&&(r+=", ")}return r+=" )"}},{key:"generateStruct",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=[],a=k(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=o.name,u=o.type;r&&r[s]&&r[s].isNode?i.push(r[s].build(this,u)):i.push(this.generateConst(u))}}catch(l){a.e(l)}finally{a.f()}return e+"( "+i.join(", ")+" )"}},{key:"generateConst",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===n&&("float"===e||"int"===e||"uint"===e?n=0:"bool"===e?n=!1:"color"===e?n=new ga:"vec2"===e?n=new _r:"vec3"===e?n=new Kr:"vec4"===e&&(n=new Gr)),"float"===e)return rF(n);if("int"===e)return"".concat(Math.round(n));if("uint"===e)return n>=0?"".concat(Math.round(n),"u"):"0u";if("bool"===e)return n?"true":"false";if("color"===e)return"".concat(this.getType("vec3"),"( ").concat(rF(n.r),", ").concat(rF(n.g),", ").concat(rF(n.b)," )");var r=this.getTypeLength(e),i=this.getComponentType(e),a=function(e){return t.generateConst(i,e)};if(2===r)return"".concat(this.getType(e),"( ").concat(a(n.x),", ").concat(a(n.y)," )");if(3===r)return"".concat(this.getType(e),"( ").concat(a(n.x),", ").concat(a(n.y),", ").concat(a(n.z)," )");if(4===r&&"mat2"!==e)return"".concat(this.getType(e),"( ").concat(a(n.x),", ").concat(a(n.y),", ").concat(a(n.z),", ").concat(a(n.w)," )");if(r>=4&&n&&(n.isMatrix2||n.isMatrix3||n.isMatrix4))return"".concat(this.getType(e),"( ").concat(n.elements.map(a).join(", ")," )");if(r>4)return"".concat(this.getType(e),"()");throw new Error("NodeBuilder: Type '".concat(e,"' not found in generate constant attempt."))}},{key:"getType",value:function(e){return"color"===e?"vec3":e}},{key:"hasGeometryAttribute",value:function(e){return this.geometry&&void 0!==this.geometry.getAttribute(e)}},{key:"getAttribute",value:function(e,t){var n,r=this.attributes,i=k(r);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.name===e)return a}}catch(s){i.e(s)}finally{i.f()}var o=new RB(e,t);return this.registerDeclaration(o),r.push(o),o}},{key:"getPropertyName",value:function(e){return e.name}},{key:"isVector",value:function(e){return/vec\d/.test(e)}},{key:"isMatrix",value:function(e){return/mat\d/.test(e)}},{key:"isReference",value:function(e){return"void"===e||"property"===e||"sampler"===e||"samplerComparison"===e||"texture"===e||"cubeTexture"===e||"storageTexture"===e||"depthTexture"===e||"texture3D"===e}},{key:"needsToWorkingColorSpace",value:function(){return!1}},{key:"getComponentTypeFromTexture",value:function(e){var t=e.type;if(e.isDataTexture){if(t===Gt)return"int";if(t===Ht)return"uint"}return"float"}},{key:"getElementType",value:function(e){return"mat2"===e?"vec2":"mat3"===e?"vec3":"mat4"===e?"vec4":this.getComponentType(e)}},{key:"getComponentType",value:function(e){if("float"===(e=this.getVectorType(e))||"bool"===e||"int"===e||"uint"===e)return e;var t=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return null===t?null:"b"===t[1]?"bool":"i"===t[1]?"int":"u"===t[1]?"uint":"float"}},{key:"getVectorType",value:function(e){return"color"===e?"vec3":"texture"===e||"cubeTexture"===e||"storageTexture"===e||"texture3D"===e?"vec4":e}},{key:"getTypeFromLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float";if(1===e)return t;var n=W_(e),r="float"===t?"":t[0];return!0===/mat2/.test(t)&&(n=n.replace("vec","mat")),r+n}},{key:"getTypeFromArray",value:function(e){return nF.get(e.constructor)}},{key:"isInteger",value:function(e){return/int|uint|(i|u)vec/.test(e)}},{key:"getTypeFromAttribute",value:function(e){var t=e;e.isInterleavedBufferAttribute&&(t=e.data);var n,r=t.array,i=e.itemSize,a=e.normalized;return e instanceof Ia||!0===a||(n=this.getTypeFromArray(r)),this.getTypeFromLength(i,n)}},{key:"getTypeLength",value:function(e){var t=this.getVectorType(e),n=/vec([2-4])/.exec(t);return null!==n?Number(n[1]):"float"===t||"bool"===t||"int"===t||"uint"===t?1:!0===/mat2/.test(e)?4:!0===/mat3/.test(e)?9:!0===/mat4/.test(e)?16:0}},{key:"getVectorFromMatrix",value:function(e){return e.replace("mat","vec")}},{key:"changeComponentType",value:function(e,t){return this.getTypeFromLength(this.getTypeLength(e),t)}},{key:"getIntegerType",value:function(e){var t=this.getComponentType(e);return"int"===t||"uint"===t?e:this.changeComponentType(e,"int")}},{key:"addStack",value:function(){return this.stack=LI(this.stack),this.stacks.push(gx()||this.stack),mx(this.stack),this.stack}},{key:"removeStack",value:function(){var e=this.stack;return this.stack=e.parent,mx(this.stacks.pop()),e}},{key:"getDataFromNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shaderStage,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=(n=null===n?e.isGlobal(this)?this.globalCache:this.cache:n).getData(e);return void 0===r&&(r={},n.setData(e,r)),void 0===r[t]&&(r[t]={}),r[t]}},{key:"getNodeProperties",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"any",n=this.getDataFromNode(e,t);return n.properties||(n.properties={outputNode:null})}},{key:"getBufferAttributeFromNode",value:function(e,t){var n=this.getDataFromNode(e),r=n.bufferAttribute;if(void 0===r){var i=this.uniforms.index++;r=new RB("nodeAttribute"+i,t,e),this.bufferAttributes.push(r),n.bufferAttribute=r}return r}},{key:"getStructTypeFromNode",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.shaderStage,i=this.getDataFromNode(e,r,this.globalCache),a=i.structType;if(void 0===a){var o=this.structs.index++;null===n&&(n="StructType"+o),a=new UB(n,t),this.structs[r].push(a),i.structType=a}return a}},{key:"getOutputStructTypeFromNode",value:function(e,t){var n=this.getStructTypeFromNode(e,t,"OutputType","fragment");return n.output=!0,n}},{key:"getUniformFromNode",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shaderStage,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=this.getDataFromNode(e,n,this.globalCache),a=i.uniform;if(void 0===a){var o=this.uniforms.index++;a=new PB(r||"nodeUniform"+o,t,e),this.uniforms[n].push(a),this.registerDeclaration(a),i.uniform=a}return a}},{key:"getArrayCount",value:function(e){var t=null;return e.isArrayNode?t=e.count:e.isVarNode&&e.node.isArrayNode&&(t=e.node.count),t}},{key:"getVarFromNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getNodeType(this),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.shaderStage,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this.getDataFromNode(e,r),o=a.variable;if(void 0===o){var s=i?"_const":"_var",u=this.vars[r]||(this.vars[r]=[]),l=this.vars[s]||(this.vars[s]=0);null===t&&(t=(i?"nodeConst":"nodeVar")+l,this.vars[s]++);var c=this.getArrayCount(e);o=new NB(t,n,i,c),i||u.push(o),this.registerDeclaration(o),a.variable=o}return o}},{key:"isDeterministic",value:function(e){if(e.isMathNode)return this.isDeterministic(e.aNode)&&(!e.bNode||this.isDeterministic(e.bNode))&&(!e.cNode||this.isDeterministic(e.cNode));if(e.isOperatorNode)return this.isDeterministic(e.aNode)&&(!e.bNode||this.isDeterministic(e.bNode));if(e.isArrayNode){if(null!==e.values){var t,n=k(e.values);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!this.isDeterministic(r))return!1}}catch(i){n.e(i)}finally{n.f()}}return!0}return!!e.isConstNode}},{key:"getVaryingFromNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getNodeType(this),r=this.getDataFromNode(e,"any"),i=r.varying;if(void 0===i){var a=this.varyings,o=a.length;null===t&&(t="nodeVarying"+o),i=new IB(t,n),a.push(i),this.registerDeclaration(i),r.varying=i}return i}},{key:"registerDeclaration",value:function(e){for(var t=this.shaderStage,n=this.declarations[t]||(this.declarations[t]={}),r=this.getPropertyName(e),i=1,a=r;void 0!==n[a];)a=r+"_"+i++;n[a]=e,i>1&&(e.name=a,console.warn("THREE.TSL: Declaration name '".concat(r,"' of '").concat(e.type,"' already in use. Renamed to '").concat(a,"'.")))}},{key:"getCodeFromNode",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shaderStage,r=this.getDataFromNode(e),i=r.code;if(void 0===i){var a=this.codes[n]||(this.codes[n]=[]),o=a.length;i=new LB("nodeCode"+o,t),a.push(i),r.code=i}return i}},{key:"addFlowCodeHierarchy",value:function(e,t){for(var n=this.getDataFromNode(e),r=n.flowCodes,i=n.flowCodeBlock,a=!0,o=t;o;){if(!0===i.get(o)){a=!1;break}o=this.getDataFromNode(o).parentNodeBlock}if(a){var s,u=k(r);try{for(u.s();!(s=u.n()).done;){var l=s.value;this.addLineFlowCode(l)}}catch(c){u.e(c)}finally{u.f()}}}},{key:"addLineFlowCodeBlock",value:function(e,t,n){var r=this.getDataFromNode(e),i=r.flowCodes||(r.flowCodes=[]),a=r.flowCodeBlock||(r.flowCodeBlock=new WeakMap);i.push(t),a.set(n,!0)}},{key:"addLineFlowCode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return""===e||(null!==t&&this.context.nodeBlock&&this.addLineFlowCodeBlock(t,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e+=";\n"),this.flow.code+=e),this}},{key:"addFlowCode",value:function(e){return this.flow.code+=e,this}},{key:"addFlowTab",value:function(){return this.tab+="\t",this}},{key:"removeFlowTab",value:function(){return this.tab=this.tab.slice(0,-1),this}},{key:"getFlowData",value:function(e){return this.flowsData.get(e)}},{key:"flowNode",value:function(e){var t=e.getNodeType(this),n=this.flowChildNode(e,t);return this.flowsData.set(e,n),n}},{key:"addInclude",value:function(e){null!==this.currentFunctionNode&&this.currentFunctionNode.includes.push(e)}},{key:"buildFunctionNode",value:function(e){var t=new CD,n=this.currentFunctionNode;return this.currentFunctionNode=t,t.code=this.buildFunctionCode(e),this.currentFunctionNode=n,t}},{key:"flowShaderNode",value:function(e){var t,n=e.layout,r=We({},Symbol.iterator,(function(){var e=0,t=Object.values(this);return{next:function(){return{value:t[e],done:e++>=t.length}}}})),i=k(n.inputs);try{for(i.s();!(t=i.n()).done;){var a=t.value;r[a.name]=new NI(a.type,a.name)}}catch(u){i.e(u)}finally{i.f()}e.layout=null;var o=e.call(r),s=this.flowStagesNode(o,n.type);return e.layout=n,s}},{key:"flowStagesNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.flow,r=this.vars,i=this.declarations,a=this.cache,o=this.buildStage,s=this.stack,u={code:""};this.flow=u,this.vars={},this.declarations={},this.cache=new OB,this.stack=LI();for(var l=0,c=ib;l<c.length;l++){var h=c[l];this.setBuildStage(h),u.result=e.build(this,t)}return u.vars=this.getVars(this.shaderStage),this.flow=n,this.vars=r,this.declarations=i,this.cache=a,this.stack=s,this.setBuildStage(o),u}},{key:"getFunctionOperator",value:function(){return null}},{key:"buildFunctionCode",value:function(){console.warn("Abstract function.")}},{key:"flowChildNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.flow,r={code:""};return this.flow=r,r.result=e.build(this,t),this.flow=n,r}},{key:"flowNodeFromShaderStage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=this.shaderStage;this.setShaderStage(e);var a=this.flowChildNode(t,n);return null!==r&&(a.code+="".concat(this.tab+r," = ").concat(a.result,";\n")),this.flowCode[e]=this.flowCode[e]+a.code,this.setShaderStage(i),a}},{key:"getAttributesArray",value:function(){return this.attributes.concat(this.bufferAttributes)}},{key:"getAttributes",value:function(){console.warn("Abstract function.")}},{key:"getVaryings",value:function(){console.warn("Abstract function.")}},{key:"getVar",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"".concat(null!==n?this.generateArrayDeclaration(e,n):this.getType(e)," ").concat(t)}},{key:"getVars",value:function(e){var t="",n=this.vars[e];if(void 0!==n){var r,i=k(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;t+="".concat(this.getVar(a.type,a.name),"; ")}}catch(o){i.e(o)}finally{i.f()}}return t}},{key:"getUniforms",value:function(){console.warn("Abstract function.")}},{key:"getCodes",value:function(e){var t=this.codes[e],n="";if(void 0!==t){var r,i=k(t);try{for(i.s();!(r=i.n()).done;){n+=r.value.code+"\n"}}catch(a){i.e(a)}finally{i.f()}}return n}},{key:"getHash",value:function(){return this.vertexShader+this.fragmentShader+this.computeShader}},{key:"setShaderStage",value:function(e){this.shaderStage=e}},{key:"getShaderStage",value:function(){return this.shaderStage}},{key:"setBuildStage",value:function(e){this.buildStage=e}},{key:"getBuildStage",value:function(){return this.buildStage}},{key:"buildCode",value:function(){console.warn("Abstract function.")}},{key:"build",value:function(){var e=this.object,t=this.material,n=this.renderer;if(null!==t){var r=n.library.fromMaterial(t);null===r&&(console.error('NodeMaterial: Material "'.concat(t.type,'" is not compatible.')),r=new uR),r.build(this)}else this.addFlow("compute",e);for(var i=0,a=ib;i<a.length;i++){var o=a[i];this.setBuildStage(o),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);var s,u=k(ab);try{for(u.s();!(s=u.n()).done;){var l=s.value;this.setShaderStage(l);var c,h=k(this.flowNodes[l]);try{for(h.s();!(c=h.n()).done;){var f=c.value;"generate"===o?this.flowNode(f):f.build(this)}}catch(d){h.e(d)}finally{h.f()}}}catch(d){u.e(d)}finally{u.f()}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}},{key:"getNodeUniform",value:function(e,t){if("float"===t||"int"===t||"uint"===t)return new XB(e);if("vec2"===t||"ivec2"===t||"uvec2"===t)return new QB(e);if("vec3"===t||"ivec3"===t||"uvec3"===t)return new YB(e);if("vec4"===t||"ivec4"===t||"uvec4"===t)return new KB(e);if("color"===t)return new ZB(e);if("mat2"===t)return new JB(e);if("mat3"===t)return new $B(e);if("mat4"===t)return new eF(e);throw new Error('Uniform "'.concat(t,'" not declared.'))}},{key:"format",value:function(e,t,n){if((t=this.getVectorType(t))===(n=this.getVectorType(n))||null===n||this.isReference(n))return e;var r=this.getTypeLength(t),i=this.getTypeLength(n);return 16===r&&9===i?"".concat(this.getType(n),"( ").concat(e,"[ 0 ].xyz, ").concat(e,"[ 1 ].xyz, ").concat(e,"[ 2 ].xyz )"):9===r&&4===i?"".concat(this.getType(n),"( ").concat(e,"[ 0 ].xy, ").concat(e,"[ 1 ].xy )"):r>4||i>4||0===i?e:r===i?"".concat(this.getType(n),"( ").concat(e," )"):r>i?this.format("".concat(e,".").concat("xyz".slice(0,i)),this.getTypeFromLength(i,this.getComponentType(t)),n):4===i&&r>1?"".concat(this.getType(n),"( ").concat(this.format(e,t,"vec3"),", 1.0 )"):2===r?"".concat(this.getType(n),"( ").concat(this.format(e,t,"vec2"),", 0.0 )"):(1===r&&i>1&&t!==this.getComponentType(n)&&(e="".concat(this.getType(this.getComponentType(n)),"( ").concat(e," )")),"".concat(this.getType(n),"( ").concat(e," )"))}},{key:"getSignature",value:function(){return"// Three.js r".concat(dt," - Node System\n")}},{key:"createNodeMaterial",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"NodeMaterial";throw new Error("THREE.NodeBuilder: createNodeMaterial() was deprecated. Use new ".concat(e,"() instead."))}}]),e}(),aF=function(){function e(){c(this,e),this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}return p(e,[{key:"_getMaps",value:function(e,t){var n=e.get(t);return void 0===n&&(n={renderMap:new WeakMap,frameMap:new WeakMap},e.set(t,n)),n}},{key:"updateBeforeNode",value:function(e){var t=e.getUpdateBeforeType(),n=e.updateReference(this);if(t===tb.FRAME){var r=this._getMaps(this.updateBeforeMap,n).frameMap;r.get(n)!==this.frameId&&!1!==e.updateBefore(this)&&r.set(n,this.frameId)}else if(t===tb.RENDER){var i=this._getMaps(this.updateBeforeMap,n).renderMap;i.get(n)!==this.renderId&&!1!==e.updateBefore(this)&&i.set(n,this.renderId)}else t===tb.OBJECT&&e.updateBefore(this)}},{key:"updateAfterNode",value:function(e){var t=e.getUpdateAfterType(),n=e.updateReference(this);if(t===tb.FRAME){var r=this._getMaps(this.updateAfterMap,n).frameMap;r.get(n)!==this.frameId&&!1!==e.updateAfter(this)&&r.set(n,this.frameId)}else if(t===tb.RENDER){var i=this._getMaps(this.updateAfterMap,n).renderMap;i.get(n)!==this.renderId&&!1!==e.updateAfter(this)&&i.set(n,this.renderId)}else t===tb.OBJECT&&e.updateAfter(this)}},{key:"updateNode",value:function(e){var t=e.getUpdateType(),n=e.updateReference(this);if(t===tb.FRAME){var r=this._getMaps(this.updateMap,n).frameMap;r.get(n)!==this.frameId&&!1!==e.update(this)&&r.set(n,this.frameId)}else if(t===tb.RENDER){var i=this._getMaps(this.updateMap,n).renderMap;i.get(n)!==this.renderId&&!1!==e.update(this)&&i.set(n,this.renderId)}else t===tb.OBJECT&&e.update(this)}},{key:"update",value:function(){this.frameId++,void 0===this.lastTime&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}]),e}(),oF=p((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];c(this,e),this.type=t,this.name=n,this.count=r,this.qualifier=i,this.isConst=a}));oF.isNodeFunctionInput=!0;var sF=function(e){v(n,e);var t=b(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return c(this,n),t.call(this,e)}return p(n,[{key:"setupDirect",value:function(){var e=this.colorNode;return{lightDirection:fO(this.light),lightColor:e}}}],[{key:"type",get:function(){return"DirectionalLightNode"}}]),n}(KO),uF=new Ei,lF=new Ei,cF=null,hF=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return c(this,n),(e=t.call(this,r)).halfHeight=Jx(new Kr).setGroup(Yx),e.halfWidth=Jx(new Kr).setGroup(Yx),e.updateType=tb.RENDER,e}return p(n,[{key:"update",value:function(e){ht(m(n.prototype),"update",this).call(this,e);var t=this.light,r=e.camera.matrixWorldInverse;lF.identity(),uF.copy(t.matrixWorld),uF.premultiply(r),lF.extractRotation(uF),this.halfWidth.value.set(.5*t.width,0,0),this.halfHeight.value.set(0,.5*t.height,0),this.halfWidth.value.applyMatrix4(lF),this.halfHeight.value.applyMatrix4(lF)}},{key:"setupDirectRectArea",value:function(e){var t,n;return e.isAvailable("float32Filterable")?(t=_E(cF.LTC_FLOAT_1),n=_E(cF.LTC_FLOAT_2)):(t=_E(cF.LTC_HALF_1),n=_E(cF.LTC_HALF_2)),{lightColor:this.colorNode,lightPosition:hO(this.light),halfWidth:this.halfWidth,halfHeight:this.halfHeight,ltc_1:t,ltc_2:n}}}],[{key:"type",get:function(){return"RectAreaLightNode"}},{key:"setLTC",value:function(e){cF=e}}]),n}(KO),fF=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return c(this,n),(e=t.call(this,r)).coneCosNode=Jx(0).setGroup(Yx),e.penumbraCosNode=Jx(0).setGroup(Yx),e.cutoffDistanceNode=Jx(0).setGroup(Yx),e.decayExponentNode=Jx(0).setGroup(Yx),e}return p(n,[{key:"update",value:function(e){ht(m(n.prototype),"update",this).call(this,e);var t=this.light;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}},{key:"getSpotAttenuation",value:function(e){var t=this.coneCosNode,n=this.penumbraCosNode;return uS(t,n,e)}},{key:"setupDirect",value:function(e){var t=this.colorNode,n=this.cutoffDistanceNode,r=this.decayExponentNode,i=this.light,a=this.getLightVector(e),o=a.normalize(),s=o.dot(fO(i)),u=this.getSpotAttenuation(s),l=a.length(),c=ZO({lightDistance:l,cutoffDistance:n,decayExponent:r}),h=t.mul(u).mul(c);if(i.map){var f=uO(i,e.context.positionWorld),d=_E(i.map,f.xy).onRenderUpdate((function(){return i.map}));h=f.mul(2).sub(1).abs().lessThan(1).all().select(h.mul(d),h)}return{lightColor:h,lightDirection:o}}}],[{key:"type",get:function(){return"SpotLightNode"}}]),n}(KO),dF=function(e){v(n,e);var t=b(n);function n(){return c(this,n),t.apply(this,arguments)}return p(n,[{key:"getSpotAttenuation",value:function(e){var t=this.light.iesMap,r=null;if(t&&!0===t.isTexture){var i=e.acos().mul(1/Math.PI);r=_E(t,Ex(i,0),0).r}else r=ht(m(n.prototype),"getSpotAttenuation",this).call(this,e);return r}}],[{key:"type",get:function(){return"IESSpotLightNode"}}]),n}(fF),pF=function(e){v(n,e);var t=b(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return c(this,n),t.call(this,e)}return p(n,[{key:"setup",value:function(e){e.context.irradiance.addAssign(this.colorNode)}}],[{key:"type",get:function(){return"AmbientLightNode"}}]),n}(KO),AF=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return c(this,n),(e=t.call(this,r)).lightPositionNode=lO(r),e.lightDirectionNode=e.lightPositionNode.normalize(),e.groundColorNode=Jx(new ga).setGroup(Yx),e}return p(n,[{key:"update",value:function(e){var t=this.light;ht(m(n.prototype),"update",this).call(this,e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}},{key:"setup",value:function(e){var t=this.colorNode,n=this.groundColorNode,r=this.lightDirectionNode,i=Ak.dot(r).mul(.5).add(.5),a=iS(n,t,i);e.context.irradiance.addAssign(a)}}],[{key:"type",get:function(){return"HemisphereLightNode"}}]),n}(KO),vF=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;c(this,n),e=t.call(this,r);for(var i=[],a=0;a<9;a++)i.push(new Kr);return e.lightProbe=EE(i),e}return p(n,[{key:"update",value:function(e){var t=this.light;ht(m(n.prototype),"update",this).call(this,e);for(var r=0;r<9;r++)this.lightProbe.array[r].copy(t.sh.coefficients[r]).multiplyScalar(t.intensity)}},{key:"setup",value:function(e){var t=wB(vk,this.lightProbe);e.context.irradiance.addAssign(t)}}],[{key:"type",get:function(){return"LightProbeNode"}}]),n}(KO),mF=function(){function e(){c(this,e)}return p(e,[{key:"parseFunction",value:function(){console.warn("Abstract function.")}}]),e}(),gF=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";c(this,e),this.type=t,this.inputs=n,this.name=r,this.precision=i}return p(e,[{key:"getCode",value:function(){console.warn("Abstract function.")}}]),e}();gF.isNodeFunction=!0;var yF=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,_F=/[a-z_0-9]+/gi,bF="#pragma main",xF=function(e){v(n,e);var t=b(n);function n(e){var r;c(this,n);var i=function(e){var t=(e=e.trim()).indexOf(bF),n=-1!==t?e.slice(t+bF.length):e,r=n.match(yF);if(null!==r&&5===r.length){for(var i=r[4],a=[],o=null;null!==(o=_F.exec(i));)a.push(o);for(var s=[],u=0;u<a.length;){var l="const"===a[u][0];!0===l&&u++;var c=a[u][0];"in"===c||"out"===c||"inout"===c?u++:c="";var h=a[u++][0],f=Number.parseInt(a[u][0]);!1===Number.isNaN(f)?u++:f=null;var d=a[u++][0];s.push(new oF(h,d,f,c,l))}var p=n.substring(r[0].length),A=void 0!==r[3]?r[3]:"";return{type:r[2],inputs:s,name:A,precision:void 0!==r[1]?r[1]:"",inputsCode:i,blockCode:p,headerCode:-1!==t?e.slice(0,t):""}}throw new Error("FunctionNode: Function is not a GLSL code.")}(e),a=i.type,o=i.inputs,s=i.name,u=i.precision,l=i.inputsCode,h=i.blockCode,f=i.headerCode;return(r=t.call(this,a,o,s,u)).inputsCode=l,r.blockCode=h,r.headerCode=f,r}return p(n,[{key:"getCode",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.name,n=this.blockCode;if(""!==n){var r=this.type,i=this.inputsCode,a=this.headerCode,o=this.precision,s="".concat(r," ").concat(t," ( ").concat(i.trim()," )");""!==o&&(s="".concat(o," ").concat(s)),e=a+s+n}else e="";return e}}]),n}(gF),wF=function(e){v(n,e);var t=b(n);function n(){return c(this,n),t.apply(this,arguments)}return p(n,[{key:"parseFunction",value:function(e){return new xF(e)}}]),n}(mF),TF=new WeakMap,SF=[],EF=[],kF=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this)).renderer=e,i.backend=r,i.nodeFrame=new aF,i.nodeBuilderCache=new Map,i.callHashCache=new XN,i.groupsData=new XN,i.cacheLib={},i}return p(n,[{key:"updateGroup",value:function(e){var t=e.groupNode,n=t.name;if(n===Kx.name)return!0;if(n===Yx.name){var r=this.get(e),i=this.nodeFrame.renderId;return r.renderId!==i&&(r.renderId=i,!0)}if(n===Qx.name){var a=this.get(e),o=this.nodeFrame.frameId;return a.frameId!==o&&(a.frameId=o,!0)}SF[0]=t,SF[1]=e;var s=this.groupsData.get(SF);return void 0===s&&this.groupsData.set(SF,s={}),SF.length=0,s.version!==t.version&&(s.version=t.version,!0)}},{key:"getForRenderCacheKey",value:function(e){return e.initialCacheKey}},{key:"getForRender",value:function(e){var t=this.get(e),n=t.nodeBuilderState;if(void 0===n){var r=this.nodeBuilderCache,i=this.getForRenderCacheKey(e);if(void 0===(n=r.get(i))){var a=this.backend.createNodeBuilder(e.object,this.renderer);a.scene=e.scene,a.material=e.material,a.camera=e.camera,a.context.material=e.material,a.lightsNode=e.lightsNode,a.environmentNode=this.getEnvironmentNode(e.scene),a.fogNode=this.getFogNode(e.scene),a.clippingContext=e.clippingContext,a.build(),n=this._createNodeBuilderState(a),r.set(i,n)}n.usedTimes++,t.nodeBuilderState=n}return n}},{key:"delete",value:function(e){if(e.isRenderObject){var t=this.get(e).nodeBuilderState;t.usedTimes--,0===t.usedTimes&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return ht(m(n.prototype),"delete",this).call(this,e)}},{key:"getForCompute",value:function(e){var t=this.get(e),n=t.nodeBuilderState;if(void 0===n){var r=this.backend.createNodeBuilder(e,this.renderer);r.build(),n=this._createNodeBuilderState(r),t.nodeBuilderState=n}return n}},{key:"_createNodeBuilderState",value:function(e){return new CB(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.observer,e.transforms)}},{key:"getEnvironmentNode",value:function(e){this.updateEnvironment(e);var t=null;if(e.environmentNode&&e.environmentNode.isNode)t=e.environmentNode;else{var n=this.get(e);n.environmentNode&&(t=n.environmentNode)}return t}},{key:"getBackgroundNode",value:function(e){this.updateBackground(e);var t=null;if(e.backgroundNode&&e.backgroundNode.isNode)t=e.backgroundNode;else{var n=this.get(e);n.backgroundNode&&(t=n.backgroundNode)}return t}},{key:"getFogNode",value:function(e){return this.updateFog(e),e.fogNode||this.get(e).fogNode||null}},{key:"getCacheKey",value:function(e,t){SF[0]=e,SF[1]=t;var n=this.renderer.info.calls,r=this.callHashCache.get(SF)||{};if(r.callId!==n){var i=this.getEnvironmentNode(e),a=this.getFogNode(e);t&&EF.push(t.getCacheKey(!0)),i&&EF.push(i.getCacheKey()),a&&EF.push(a.getCacheKey()),EF.push(this.renderer.shadowMap.enabled?1:0),r.callId=n,r.cacheKey=z_(EF),this.callHashCache.set(SF,r),EF.length=0}return SF.length=0,r.cacheKey}},{key:"isToneMappingState",get:function(){return!this.renderer.getRenderTarget()}},{key:"updateBackground",value:function(e){var t=this.get(e),n=e.background;if(n){var r=0===e.backgroundBlurriness&&t.backgroundBlurriness>0||e.backgroundBlurriness>0&&0===t.backgroundBlurriness;if(t.background!==n||r){var i=this.getCacheNode("background",n,(function(){var t;return!0===n.isCubeTexture||n.mapping===Mt||n.mapping===Ct||n.mapping===Rt?e.backgroundBlurriness>0||n.mapping===Rt?bN(n):(t=!0===n.isCubeTexture?Nk(n):_E(n),SR(t)):!0===n.isTexture?_E(n,PC.flipY()).setUpdateMatrix(!0):void(!0!==n.isColor&&console.error("WebGPUNodes: Unsupported background configuration.",n))}),r);t.backgroundNode=i,t.background=n,t.backgroundBlurriness=e.backgroundBlurriness}}else t.backgroundNode&&(delete t.backgroundNode,delete t.background)}},{key:"getCacheNode",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.cacheLib[e]||(this.cacheLib[e]=new WeakMap),a=i.get(t);return(void 0===a||r)&&(a=n(),i.set(t,a)),a}},{key:"updateFog",value:function(e){var t=this.get(e),n=e.fog;if(n){if(t.fog!==n){var r=this.getCacheNode("fog",n,(function(){if(n.isFogExp2){var e=Dk("color","color",n).setGroup(Yx),t=Dk("density","float",n).setGroup(Yx);return VD(e,zD(t))}if(n.isFog){var r=Dk("color","color",n).setGroup(Yx),i=Dk("near","float",n).setGroup(Yx),a=Dk("far","float",n).setGroup(Yx);return VD(r,FD(i,a))}console.error("THREE.Renderer: Unsupported fog configuration.",n)}));t.fogNode=r,t.fog=n}}else delete t.fogNode,delete t.fog}},{key:"updateEnvironment",value:function(e){var t=this.get(e),n=e.environment;if(n){if(t.environment!==n){var r=this.getCacheNode("environment",n,(function(){return!0===n.isCubeTexture?Nk(n):!0===n.isTexture?_E(n):void console.error("Nodes: Unsupported environment configuration.",n)}));t.environmentNode=r,t.environment=n}}else t.environmentNode&&(delete t.environmentNode,delete t.environment)}},{key:"getNodeFrame",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.renderer,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=this.nodeFrame;return a.renderer=e,a.scene=t,a.object=n,a.camera=r,a.material=i,a}},{key:"getNodeFrameForRender",value:function(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}},{key:"getOutputCacheKey",value:function(){var e=this.renderer;return e.toneMapping+","+e.currentColorSpace}},{key:"hasOutputChange",value:function(e){return TF.get(e)!==this.getOutputCacheKey()}},{key:"getOutputNode",value:function(e){var t=this.renderer,n=this.getOutputCacheKey(),r=_E(e,PC).renderOutput(t.toneMapping,t.currentColorSpace);return TF.set(e,n),r}},{key:"updateBefore",value:function(e){var t,n=k(e.getNodeBuilderState().updateBeforeNodes);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.getNodeFrameForRender(e).updateBeforeNode(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"updateAfter",value:function(e){var t,n=k(e.getNodeBuilderState().updateAfterNodes);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.getNodeFrameForRender(e).updateAfterNode(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"updateForCompute",value:function(e){var t,n=this.getNodeFrame(),r=k(this.getForCompute(e).updateNodes);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.updateNode(i)}}catch(a){r.e(a)}finally{r.f()}}},{key:"updateForRender",value:function(e){var t,n=this.getNodeFrameForRender(e),r=k(e.getNodeBuilderState().updateNodes);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.updateNode(i)}}catch(a){r.e(a)}finally{r.f()}}},{key:"needsRefresh",value:function(e){var t=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,t)}},{key:"dispose",value:function(){ht(m(n.prototype),"dispose",this).call(this),this.nodeFrame=new aF,this.nodeBuilderCache=new Map,this.cacheLib={}}}]),n}(JN),MF=new Po,CF=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;c(this,e),this.version=0,this.clipIntersection=null,this.cacheKey="",this.shadowPass=!1,this.viewNormalMatrix=new br,this.clippingGroupContexts=new WeakMap,this.intersectionPlanes=[],this.unionPlanes=[],this.parentVersion=null,null!==t&&(this.viewNormalMatrix=t.viewNormalMatrix,this.clippingGroupContexts=t.clippingGroupContexts,this.shadowPass=t.shadowPass,this.viewMatrix=t.viewMatrix)}return p(e,[{key:"projectPlanes",value:function(e,t,n){for(var r=e.length,i=0;i<r;i++){MF.copy(e[i]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);var a=t[n+i],o=MF.normal;a.x=-o.x,a.y=-o.y,a.z=-o.z,a.w=MF.constant}}},{key:"updateGlobal",value:function(e,t){this.shadowPass=null!==e.overrideMaterial&&e.overrideMaterial.isShadowPassMaterial,this.viewMatrix=t.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix)}},{key:"update",value:function(e,t){var n=!1;e.version!==this.parentVersion&&(this.intersectionPlanes=Array.from(e.intersectionPlanes),this.unionPlanes=Array.from(e.unionPlanes),this.parentVersion=e.version),this.clipIntersection!==t.clipIntersection&&(this.clipIntersection=t.clipIntersection,this.clipIntersection?this.unionPlanes.length=e.unionPlanes.length:this.intersectionPlanes.length=e.intersectionPlanes.length);var r,i,a=t.clippingPlanes,o=a.length;if(this.clipIntersection?(r=this.intersectionPlanes,i=e.intersectionPlanes.length):(r=this.unionPlanes,i=e.unionPlanes.length),r.length!==i+o){r.length=i+o;for(var s=0;s<o;s++)r[i+s]=new Gr;n=!0}this.projectPlanes(a,r,i),n&&(this.version++,this.cacheKey="".concat(this.intersectionPlanes.length,":").concat(this.unionPlanes.length))}},{key:"getGroupContext",value:function(t){if(this.shadowPass&&!t.clipShadows)return this;var n=this.clippingGroupContexts.get(t);return void 0===n&&(n=new e(this),this.clippingGroupContexts.set(t,n)),n.update(this,t),n}},{key:"unionClippingCount",get:function(){return this.unionPlanes.length}}]),e}(),RF=p((function e(t,n){c(this,e),this.bundleGroup=t,this.camera=n})),PF=[],NF=function(){function e(){c(this,e),this.bundles=new XN}return p(e,[{key:"get",value:function(e,t){var n=this.bundles;PF[0]=e,PF[1]=t;var r=n.get(PF);return void 0===r&&(r=new RF(e,t),n.set(PF,r)),PF.length=0,r}},{key:"dispose",value:function(){this.bundles=new XN}}]),e}(),IF=function(){function e(){c(this,e),this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}return p(e,[{key:"fromMaterial",value:function(e){if(e.isNodeMaterial)return e;var t=null,n=this.getMaterialNodeClass(e.type);if(null!==n)for(var r in t=new n,e)t[r]=e[r];return t}},{key:"addToneMapping",value:function(e,t){this.addType(e,t,this.toneMappingNodes)}},{key:"getToneMappingFunction",value:function(e){return this.toneMappingNodes.get(e)||null}},{key:"getMaterialNodeClass",value:function(e){return this.materialNodes.get(e)||null}},{key:"addMaterial",value:function(e,t){this.addType(e,t,this.materialNodes)}},{key:"getLightNodeClass",value:function(e){return this.lightNodes.get(e)||null}},{key:"addLight",value:function(e,t){this.addClass(e,t,this.lightNodes)}},{key:"addType",value:function(e,t,n){if(n.has(t))console.warn("Redefinition of node ".concat(t));else{if("function"!==typeof e)throw new Error("Node class ".concat(e.name," is not a class."));if("function"===typeof t||"object"===typeof t)throw new Error("Base class ".concat(t," is not a class."));n.set(t,e)}}},{key:"addClass",value:function(e,t,n){if(n.has(t))console.warn("Redefinition of node ".concat(t.name));else{if("function"!==typeof e)throw new Error("Node class ".concat(e.name," is not a class."));if("function"!==typeof t)throw new Error("Base class ".concat(t.name," is not a class."));n.set(t,e)}}}]),e}(),LF=new AO,DF=[],OF=function(e){v(n,e);var t=b(n);function n(){return c(this,n),t.call(this)}return p(n,[{key:"createNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(new AO).setLights(e)}},{key:"getNode",value:function(e,t){if(e.isQuadMesh)return LF;DF[0]=e,DF[1]=t;var n=this.get(DF);return void 0===n&&(n=this.createNode(),this.set(DF,n)),DF.length=0,n}}]),n}(XN),UF=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return c(this,n),(e=t.call(this,r,i,a)).isXRRenderTarget=!0,e.hasExternalTextures=!1,e.autoAllocateDepthBuffer=!0,e}return p(n,[{key:"copy",value:function(e){return ht(m(n.prototype),"copy",this).call(this,e),this.hasExternalTextures=e.hasExternalTextures,this.autoAllocateDepthBuffer=e.autoAllocateDepthBuffer,this}}]),n}(Hr),BF=new Kr,FF=new Kr,zF=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this)).enabled=!1,r.isPresenting=!1,r.cameraAutoUpdate=!0,r._renderer=e,r._cameraL=new fo,r._cameraL.viewport=new Gr,r._cameraR=new fo,r._cameraR.viewport=new Gr,r._cameras=[r._cameraL,r._cameraR],r._cameraXR=new cl,r._currentDepthNear=null,r._currentDepthFar=null,r._controllers=[],r._controllerInputSources=[],r._xrRenderTarget=null,r._layers=[],r._supportsLayers=!1,r._createXRLayer=HF.bind(y(r)),r._gl=null,r._currentAnimationContext=null,r._currentAnimationLoop=null,r._currentPixelRatio=null,r._currentSize=new _r,r._onSessionEvent=qF.bind(y(r)),r._onSessionEnd=jF.bind(y(r)),r._onInputSourcesChange=GF.bind(y(r)),r._onAnimationFrame=WF.bind(y(r)),r._referenceSpace=null,r._referenceSpaceType="local-floor",r._customReferenceSpace=null,r._framebufferScaleFactor=1,r._foveation=1,r._session=null,r._glBaseLayer=null,r._glBinding=null,r._glProjLayer=null,r._xrFrame=null,r._useLayers="undefined"!==typeof XRWebGLBinding&&"createProjectionLayer"in XRWebGLBinding.prototype,r}return p(n,[{key:"getController",value:function(e){return this._getController(e).getTargetRaySpace()}},{key:"getControllerGrip",value:function(e){return this._getController(e).getGripSpace()}},{key:"getHand",value:function(e){return this._getController(e).getHandSpace()}},{key:"getFoveation",value:function(){if(null!==this._glProjLayer||null!==this._glBaseLayer)return this._foveation}},{key:"setFoveation",value:function(e){this._foveation=e,null!==this._glProjLayer&&(this._glProjLayer.fixedFoveation=e),null!==this._glBaseLayer&&void 0!==this._glBaseLayer.fixedFoveation&&(this._glBaseLayer.fixedFoveation=e)}},{key:"getFramebufferScaleFactor",value:function(){return this._framebufferScaleFactor}},{key:"setFramebufferScaleFactor",value:function(e){this._framebufferScaleFactor=e,!0===this.isPresenting&&console.warn("THREE.XRManager: Cannot change framebuffer scale while presenting.")}},{key:"getReferenceSpaceType",value:function(){return this._referenceSpaceType}},{key:"setReferenceSpaceType",value:function(e){this._referenceSpaceType=e,!0===this.isPresenting&&console.warn("THREE.XRManager: Cannot change reference space type while presenting.")}},{key:"getReferenceSpace",value:function(){return this._customReferenceSpace||this._referenceSpace}},{key:"setReferenceSpace",value:function(e){this._customReferenceSpace=e}},{key:"getCamera",value:function(){return this._cameraXR}},{key:"getEnvironmentBlendMode",value:function(){if(null!==this._session)return this._session.environmentBlendMode}},{key:"getFrame",value:function(){return this._xrFrame}},{key:"createQuadLayer",value:function(e,t,n,r,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],u=new su(e,t),l=new UF(i,a,{format:en,type:zt,depthTexture:new ns(i,a,s.stencil?Kt:Ht,void 0,void 0,void 0,void 0,void 0,void 0,s.stencil?an:rn),stencilBuffer:s.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),c=new xa({color:16777215,side:0});c.map=l.texture,c.map.offset.y=1,c.map.repeat.y=-1;var h=new eo(u,c);h.position.copy(n),h.quaternion.copy(r);var f={type:"quad",width:e,height:t,translation:n,quaternion:r,pixelwidth:i,pixelheight:a,plane:h,material:c,rendercall:o,renderTarget:l};if(this._layers.push(f),null!==this._session){f.plane.material=new xa({color:16777215,side:0}),f.plane.material.blending=5,f.plane.material.blendEquation=bt,f.plane.material.blendSrc=xt,f.plane.material.blendDst=xt,f.xrlayer=this._createXRLayer(f);var d=this._session.renderState.layers;d.unshift(f.xrlayer),this._session.updateRenderState({layers:d})}else l.isXRRenderTarget=!1;return h}},{key:"createCylinderLayer",value:function(e,t,n,r,i,a,o,s){var u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[],l=new Es(e,e,e*t/n,64,64,!0,Math.PI-t/2,t),c=new UF(a,o,{format:en,type:zt,depthTexture:new ns(a,o,u.stencil?Kt:Ht,void 0,void 0,void 0,void 0,void 0,void 0,u.stencil?an:rn),stencilBuffer:u.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),h=new xa({color:16777215,side:1});h.map=c.texture,h.map.offset.y=1,h.map.repeat.y=-1;var f=new eo(l,h);f.position.copy(r),f.quaternion.copy(i);var d={type:"cylinder",radius:e,centralAngle:t,aspectratio:n,translation:r,quaternion:i,pixelwidth:a,pixelheight:o,plane:f,material:h,rendercall:s,renderTarget:c};if(this._layers.push(d),null!==this._session){d.plane.material=new xa({color:16777215,side:1}),d.plane.material.blending=5,d.plane.material.blendEquation=bt,d.plane.material.blendSrc=xt,d.plane.material.blendDst=xt,d.xrlayer=this._createXRLayer(d);var p=this._session.renderState.layers;p.unshift(d.xrlayer),this._session.updateRenderState({layers:p})}else c.isXRRenderTarget=!1;return f}},{key:"renderLayers",value:function(){var e=new Kr,t=new Yr,n=this.isPresenting;this.isPresenting=!1;var r,i=k(this._layers);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.renderTarget.isXRRenderTarget=null!==this._session,a.renderTarget.hasExternalTextures=a.renderTarget.isXRRenderTarget,a.renderTarget.autoAllocateDepthBuffer=!a.renderTarget.isXRRenderTarget,a.renderTarget.isXRRenderTarget&&this._supportsLayers){a.xrlayer.transform=new XRRigidTransform(a.plane.getWorldPosition(e),a.plane.getWorldQuaternion(t));var o=this._glBinding.getSubImage(a.xrlayer,this._xrFrame);this._renderer.backend.setXRRenderTargetTextures(a.renderTarget,o.colorTexture,o.depthStencilTexture)}this._renderer.setRenderTarget(a.renderTarget),a.rendercall()}}catch(s){i.e(s)}finally{i.f()}this.isPresenting=n,this._renderer.setRenderTarget(null)}},{key:"getSession",value:function(){return this._session}},{key:"setSession",value:function(){var e=lt(ft().mark((function e(t){var n,r,i,a,o,s,u,l,c,h,f,d,p,A,v,m;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._renderer,r=n.backend,this._gl=n.getContext(),i=this._gl,a=i.getContextAttributes(),this._session=t,null===t){e.next=60;break}if(!0!==r.isWebGPUBackend){e.next=9;break}throw new Error('THREE.XRManager: XR is currently not supported with a WebGPU backend. Use WebGL by passing "{ forceWebGL: true }" to the constructor of the renderer.');case 9:return t.addEventListener("select",this._onSessionEvent),t.addEventListener("selectstart",this._onSessionEvent),t.addEventListener("selectend",this._onSessionEvent),t.addEventListener("squeeze",this._onSessionEvent),t.addEventListener("squeezestart",this._onSessionEvent),t.addEventListener("squeezeend",this._onSessionEvent),t.addEventListener("end",this._onSessionEnd),t.addEventListener("inputsourceschange",this._onInputSourcesChange),e.next=19,r.makeXRCompatible();case 19:if(this._currentPixelRatio=n.getPixelRatio(),n.getSize(this._currentSize),this._currentAnimationContext=n._animation.getContext(),this._currentAnimationLoop=n._animation.getAnimationLoop(),n._animation.stop(),!0!==this._useLayers){e.next=47;break}return o=null,s=null,u=null,n.depth&&(u=n.stencil?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT24,o=n.stencil?an:rn,s=n.stencil?Kt:Ht),l={colorFormat:i.RGBA8,depthFormat:u,scaleFactor:this._framebufferScaleFactor},c=new XRWebGLBinding(t,i),h=c.createProjectionLayer(l),f=[h],this._glBinding=c,this._glProjLayer=h,n.setPixelRatio(1),n.setSize(h.textureWidth,h.textureHeight,!1),this._xrRenderTarget=new UF(h.textureWidth,h.textureHeight,{format:en,type:zt,colorSpace:n.outputColorSpace,depthTexture:new ns(h.textureWidth,h.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,o),stencilBuffer:n.stencil,samples:a.antialias?4:0,resolveDepthBuffer:!1===h.ignoreDepthValues,resolveStencilBuffer:!1===h.ignoreDepthValues}),this._xrRenderTarget.hasExternalTextures=!0,e.next=41,t.requestReferenceSpace(this.getReferenceSpaceType());case 41:if(this._referenceSpace=e.sent,this._supportsLayers=t.enabledFeatures.includes("layers"),this._supportsLayers){d=k(this._layers);try{for(d.s();!(p=d.n()).done;)(A=p.value).plane.material=new xa({color:16777215,side:"cylinder"===A.type?1:0}),A.plane.material.blending=5,A.plane.material.blendEquation=bt,A.plane.material.blendSrc=xt,A.plane.material.blendDst=xt,A.xrlayer=this._createXRLayer(A),f.unshift(A.xrlayer)}catch(g){d.e(g)}finally{d.f()}}t.updateRenderState({layers:f}),e.next=54;break;case 47:v={antialias:n.samples>0,alpha:!0,depth:n.depth,stencil:n.stencil,framebufferScaleFactor:this.getFramebufferScaleFactor()},m=new XRWebGLLayer(t,i,v),this._glBaseLayer=m,t.updateRenderState({baseLayer:m}),n.setPixelRatio(1),n.setSize(m.framebufferWidth,m.framebufferHeight,!1),this._xrRenderTarget=new UF(m.framebufferWidth,m.framebufferHeight,{format:en,type:zt,colorSpace:n.outputColorSpace,stencilBuffer:n.stencil,resolveDepthBuffer:!1===m.ignoreDepthValues,resolveStencilBuffer:!1===m.ignoreDepthValues});case 54:this.setFoveation(this.getFoveation()),n._animation.setAnimationLoop(this._onAnimationFrame),n._animation.setContext(t),n._animation.start(),this.isPresenting=!0,this.dispatchEvent({type:"sessionstart"});case 60:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateCamera",value:function(e){var t=this._session;if(null!==t){var n=e.near,r=e.far,i=this._cameraXR,a=this._cameraL,o=this._cameraR;i.near=o.near=a.near=n,i.far=o.far=a.far=r,this._currentDepthNear===i.near&&this._currentDepthFar===i.far||(t.updateRenderState({depthNear:i.near,depthFar:i.far}),this._currentDepthNear=i.near,this._currentDepthFar=i.far),a.layers.mask=2|e.layers.mask,o.layers.mask=4|e.layers.mask,i.layers.mask=a.layers.mask|o.layers.mask;var s=e.parent,u=i.cameras;VF(i,s);for(var l=0;l<u.length;l++)VF(u[l],s);2===u.length?function(e,t,n){BF.setFromMatrixPosition(t.matrixWorld),FF.setFromMatrixPosition(n.matrixWorld);var r=BF.distanceTo(FF),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),u=(i[9]+1)/i[5],l=(i[9]-1)/i[5],c=(i[8]-1)/i[0],h=(a[8]+1)/a[0],f=o*c,d=o*h,p=r/(-c+h),A=p*-c;if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(A),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===i[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{var v=o+p,m=s+p,g=f-A,y=d+(r-A),_=u*s/m*v,b=l*s/m*v;e.projectionMatrix.makePerspective(g,y,_,b,v,m),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(i,a,o):i.projectionMatrix.copy(a.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*fr*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,i,s)}}},{key:"_getController",value:function(e){var t=this._controllers[e];return void 0===t&&(t=new _o,this._controllers[e]=t),t}}]),n}(ur);function VF(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}function qF(e){var t=this._controllerInputSources.indexOf(e.inputSource);if(-1!==t){var n=this._controllers[t];if(void 0!==n){var r=this.getReferenceSpace();n.update(e.inputSource,e.frame,r),n.dispatchEvent({type:e.type,data:e.inputSource})}}}function jF(){var e=this._session,t=this._renderer;e.removeEventListener("select",this._onSessionEvent),e.removeEventListener("selectstart",this._onSessionEvent),e.removeEventListener("selectend",this._onSessionEvent),e.removeEventListener("squeeze",this._onSessionEvent),e.removeEventListener("squeezestart",this._onSessionEvent),e.removeEventListener("squeezeend",this._onSessionEvent),e.removeEventListener("end",this._onSessionEnd),e.removeEventListener("inputsourceschange",this._onInputSourcesChange);for(var n=0;n<this._controllers.length;n++){var r=this._controllerInputSources[n];null!==r&&(this._controllerInputSources[n]=null,this._controllers[n].disconnect(r))}if(this._currentDepthNear=null,this._currentDepthFar=null,t.backend.setXRTarget(null),t.setOutputRenderTarget(null),t.setRenderTarget(null),this._session=null,this._xrRenderTarget=null,!0===this._supportsLayers){var i,a=k(this._layers);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.renderTarget=new UF(o.pixelwidth,o.pixelheight,{format:en,type:zt,depthTexture:new ns(o.pixelwidth,o.pixelheight,o.stencilBuffer?Kt:Ht,void 0,void 0,void 0,void 0,void 0,void 0,o.stencilBuffer?an:rn),stencilBuffer:o.stencilBuffer,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),o.renderTarget.isXRRenderTarget=!1,o.plane.material=o.material,o.material.map=o.renderTarget.texture,delete o.xrlayer}}catch(s){a.e(s)}finally{a.f()}}this.isPresenting=!1,t._animation.stop(),t._animation.setAnimationLoop(this._currentAnimationLoop),t._animation.setContext(this._currentAnimationContext),t._animation.start(),t.setPixelRatio(this._currentPixelRatio),t.setSize(this._currentSize.width,this._currentSize.height,!1),this.dispatchEvent({type:"sessionend"})}function GF(e){for(var t=this._controllers,n=this._controllerInputSources,r=0;r<e.removed.length;r++){var i=e.removed[r],a=n.indexOf(i);a>=0&&(n[a]=null,t[a].disconnect(i))}for(var o=0;o<e.added.length;o++){var s=e.added[o],u=n.indexOf(s);if(-1===u){for(var l=0;l<t.length;l++){if(l>=n.length){n.push(s),u=l;break}if(null===n[l]){n[l]=s,u=l;break}}if(-1===u)break}var c=t[u];c&&c.connect(s)}}function HF(e){return"quad"===e.type?this._glBinding.createQuadLayer({transform:new XRRigidTransform(e.translation,e.quaternion),depthFormat:this._gl.DEPTH_COMPONENT,width:e.width/2,height:e.height/2,space:this._referenceSpace,viewPixelWidth:e.pixelwidth,viewPixelHeight:e.pixelheight}):this._glBinding.createCylinderLayer({transform:new XRRigidTransform(e.translation,e.quaternion),depthFormat:this._gl.DEPTH_COMPONENT,radius:e.radius,centralAngle:e.centralAngle,aspectRatio:e.aspectRatio,space:this._referenceSpace,viewPixelWidth:e.pixelwidth,viewPixelHeight:e.pixelheight})}function WF(e,t){if(void 0!==t){var n=this._cameraXR,r=this._renderer,i=r.backend,a=this._glBaseLayer,o=this.getReferenceSpace(),s=t.getViewerPose(o);if(this._xrFrame=t,null!==s){var u=s.views;null!==this._glBaseLayer&&i.setXRTarget(a.framebuffer);var l=!1;u.length!==n.cameras.length&&(n.cameras.length=0,l=!0);for(var c=0;c<u.length;c++){var h=u[c],f=void 0;if(!0===this._useLayers){var d=this._glBinding.getViewSubImage(this._glProjLayer,h);f=d.viewport,0===c&&i.setXRRenderTargetTextures(this._xrRenderTarget,d.colorTexture,this._glProjLayer.ignoreDepthValues?void 0:d.depthStencilTexture)}else f=a.getViewport(h);var p=this._cameras[c];void 0===p&&((p=new fo).layers.enable(c),p.viewport=new Gr,this._cameras[c]=p),p.matrix.fromArray(h.transform.matrix),p.matrix.decompose(p.position,p.quaternion,p.scale),p.projectionMatrix.fromArray(h.projectionMatrix),p.projectionMatrixInverse.copy(p.projectionMatrix).invert(),p.viewport.set(f.x,f.y,f.width,f.height),0===c&&(n.matrix.copy(p.matrix),n.matrix.decompose(n.position,n.quaternion,n.scale)),!0===l&&n.cameras.push(p)}r.setOutputRenderTarget(this._xrRenderTarget)}for(var A=0;A<this._controllers.length;A++){var v=this._controllerInputSources[A],m=this._controllers[A];null!==v&&void 0!==m&&m.update(v,t,o)}this._currentAnimationLoop&&this._currentAnimationLoop(e,t),t.detectedPlanes&&this.dispatchEvent({type:"planesdetected",data:t}),this._xrFrame=null}}var XF=new bo,QF=new _r,YF=new Gr,KF=new Lo,ZF=new Ei,JF=new Gr,$F=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};c(this,e),this.isRenderer=!0;var i=r.logarithmicDepthBuffer,a=void 0!==i&&i,o=r.alpha,s=void 0===o||o,u=r.depth,l=void 0===u||u,h=r.stencil,f=void 0!==h&&h,d=r.antialias,p=void 0!==d&&d,A=r.samples,v=void 0===A?0:A,m=r.getFallback,g=void 0===m?null:m,y=r.colorBufferType,_=void 0===y?Xt:y;this.domElement=t.getDomElement(),this.backend=t,this.samples=v||!0===p?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=s,this.logarithmicDepthBuffer=a,this.outputColorSpace=Kn,this.toneMapping=0,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=l,this.stencil=f,this.info=new uI,this.nodes={modelViewMatrix:null,modelNormalViewMatrix:null},this.library=new IF,this.lighting=new OF,this._getFallback=g,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new Gr(0,0,this._width,this._height),this._scissor=new Gr(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new EL(new uR),this._quad.material.name="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;var b=!0===this.alpha?0:1;this._clearColor=new PI(0,0,0,b),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._outputRenderTarget=null,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._colorBufferType=_,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:1},this.xr=new zF(this),this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:function(){var e=lt(ft().mark((function e(t,r,i){var a,o,s,u,l,c,h;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.compileAsync(t,r);case 2:return a=n._renderLists.get(t,r),o=n._renderContexts.get(t,r,n._renderTarget),s=t.overrideMaterial||i.material,u=n._objects.get(i,s,t,r,a.lightsNode,o,o.clippingContext),l=u.getNodeBuilderState(),c=l.fragmentShader,h=l.vertexShader,e.abrupt("return",{fragmentShader:c,vertexShader:h});case 8:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()}}return p(e,[{key:"init",value:function(){var e=lt(ft().mark((function e(){var t=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._initialized){e.next=2;break}throw new Error("Renderer: Backend has already been initialized.");case 2:if(null===this._initPromise){e.next=4;break}return e.abrupt("return",this._initPromise);case 4:return this._initPromise=new Promise(function(){var e=lt(ft().mark((function e(n,r){var i;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.backend,e.prev=1,e.next=4,i.init(t);case 4:e.next=23;break;case 6:if(e.prev=6,e.t0=e.catch(1),null===t._getFallback){e.next=21;break}return e.prev=9,t.backend=i=t._getFallback(e.t0),e.next=13,i.init(t);case 13:e.next=19;break;case 15:return e.prev=15,e.t1=e.catch(9),r(e.t1),e.abrupt("return");case 19:e.next=23;break;case 21:return r(e.t0),e.abrupt("return");case 23:t._nodes=new kF(t,i),t._animation=new WN(t._nodes,t.info),t._attributes=new iI(i),t._background=new EB(t,t._nodes),t._geometries=new sI(t._attributes,t.info),t._textures=new RI(t,i,t.info),t._pipelines=new pI(i,t._nodes),t._bindings=new AI(i,t._nodes,t._textures,t._attributes,t._pipelines,t.info),t._objects=new ZN(t,t._nodes,t._geometries,t._pipelines,t._bindings,t.info),t._renderLists=new bI(t.lighting),t._bundles=new NF,t._renderContexts=new MI,t._animation.start(),t._initialized=!0,n(t);case 38:case"end":return e.stop()}}),e,null,[[1,6],[9,15]])})));return function(t,n){return e.apply(this,arguments)}}()),e.abrupt("return",this._initPromise);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"coordinateSystem",get:function(){return this.backend.coordinateSystem}},{key:"compileAsync",value:function(){var e=lt(ft().mark((function e(t,n){var r,i,a,o,s,u,l,c,h,f,d,p,A,v,m,g,y,_=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=_.length>2&&void 0!==_[2]?_[2]:null,!0!==this._isDeviceLost){e.next=3;break}return e.abrupt("return");case 3:if(!1!==this._initialized){e.next=6;break}return e.next=6,this.init();case 6:return i=this._nodes.nodeFrame,a=i.renderId,o=this._currentRenderContext,s=this._currentRenderObjectFunction,u=this._compilationPromises,l=!0===t.isScene?t:XF,null===r&&(r=t),c=this._renderTarget,h=this._renderContexts.get(r,n,c),f=this._activeMipmapLevel,d=[],this._currentRenderContext=h,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=d,i.renderId++,i.update(),h.depth=this.depth,h.stencil=this.stencil,h.clippingContext||(h.clippingContext=new CF),h.clippingContext.updateGlobal(l,n),l.onBeforeRender(this,t,n,c),(p=this._renderLists.get(t,n)).begin(),this._projectObject(t,n,0,p,h.clippingContext),r!==t&&r.traverseVisible((function(e){e.isLight&&e.layers.test(n.layers)&&p.pushLight(e)})),p.finish(),null!==c?(this._textures.updateRenderTarget(c,f),A=this._textures.get(c),h.textures=A.textures,h.depthTexture=A.depthTexture):(h.textures=null,h.depthTexture=null),this._background.update(l,p,h),v=p.opaque,m=p.transparent,g=p.transparentDoublePass,y=p.lightsNode,!0===this.opaque&&v.length>0&&this._renderObjects(v,n,l,y),!0===this.transparent&&m.length>0&&this._renderTransparents(m,g,n,l,y),i.renderId=a,this._currentRenderContext=o,this._currentRenderObjectFunction=s,this._compilationPromises=u,this._handleObjectFunction=this._renderObjectDirect,e.next=48,Promise.all(d);case 48:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renderAsync",value:function(){var e=lt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==this._initialized){e.next=3;break}return e.next=3,this.init();case 3:this._renderScene(t,n);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"waitForGPU",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backend.waitForGPU();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setMRT",value:function(e){return this._mrt=e,this}},{key:"getMRT",value:function(){return this._mrt}},{key:"getColorBufferType",value:function(){return this._colorBufferType}},{key:"_onDeviceLost",value:function(e){var t="THREE.WebGPURenderer: ".concat(e.api," Device Lost:\n\nMessage: ").concat(e.message);e.reason&&(t+="\nReason: ".concat(e.reason)),console.error(t),this._isDeviceLost=!0}},{key:"_renderBundle",value:function(e,t,n){var r=e.bundleGroup,i=e.camera,a=e.renderList,o=this._currentRenderContext,s=this._bundles.get(r,i),u=this.backend.get(s);void 0===u.renderContexts&&(u.renderContexts=new Set);var l=r.version!==u.version,c=!1===u.renderContexts.has(o)||l;if(u.renderContexts.add(o),c){this.backend.beginBundle(o),(void 0===u.renderObjects||l)&&(u.renderObjects=[]),this._currentRenderBundle=s;var h=a.transparentDoublePass,f=a.transparent,d=a.opaque;!0===this.opaque&&d.length>0&&this._renderObjects(d,i,t,n),!0===this.transparent&&f.length>0&&this._renderTransparents(f,h,i,t,n),this._currentRenderBundle=null,this.backend.finishBundle(o,s),u.version=r.version}else for(var p=u.renderObjects,A=0,v=p.length;A<v;A++){var m=p[A];this._nodes.needsRefresh(m)&&(this._nodes.updateBefore(m),this._nodes.updateForRender(m),this._bindings.updateForRender(m),this._nodes.updateAfter(m))}this.backend.addBundle(o,s)}},{key:"render",value:function(e,t){if(!1===this._initialized)return console.warn("THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead."),this.renderAsync(e,t);this._renderScene(e,t)}},{key:"_getFrameBufferTarget",value:function(){var e=this.currentToneMapping,t=this.currentColorSpace;if(!1===(0!==e)&&!1===(t!==Zn))return null;var n=this.getDrawingBufferSize(QF),r=n.width,i=n.height,a=this.depth,o=this.stencil,s=this._frameBufferTarget;return null===s&&((s=new Hr(r,i,{depthBuffer:a,stencilBuffer:o,type:this._colorBufferType,format:en,colorSpace:Zn,generateMipmaps:!1,minFilter:Ut,magFilter:Ut,samples:this.samples})).isPostProcessingRenderTarget=!0,this._frameBufferTarget=s),s.depthBuffer=a,s.stencilBuffer=o,s.setSize(r,i),s.viewport.copy(this._viewport),s.scissor.copy(this._scissor),s.viewport.multiplyScalar(this._pixelRatio),s.scissor.multiplyScalar(this._pixelRatio),s.scissorTest=this._scissorTest,s}},{key:"_renderScene",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!0!==this._isDeviceLost){var r,i=n?this._getFrameBufferTarget():null,a=this._nodes.nodeFrame,o=a.renderId,s=this._currentRenderContext,u=this._currentRenderObjectFunction,l=!0===e.isScene?e:XF,c=this._renderTarget||this._outputRenderTarget,h=this._activeCubeFace,f=this._activeMipmapLevel;null!==i?(r=i,this.setRenderTarget(r)):r=c;var d=this._renderContexts.get(e,t,r);this._currentRenderContext=d,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,a.renderId=this.info.calls;var p=this.coordinateSystem,A=this.xr;if(t.coordinateSystem!==p&&!1===A.isPresenting&&(t.coordinateSystem=p,t.updateProjectionMatrix(),t.isArrayCamera)){var v,m=k(t.cameras);try{for(m.s();!(v=m.n()).done;){var g=v.value;g.coordinateSystem=p,g.updateProjectionMatrix()}}catch(N){m.e(N)}finally{m.f()}}!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===A.enabled&&!0===A.isPresenting&&(!0===A.cameraAutoUpdate&&A.updateCamera(t),t=A.getCamera());var y=this._viewport,_=this._scissor,b=this._pixelRatio;null!==r&&(y=r.viewport,_=r.scissor,b=1),this.getDrawingBufferSize(QF),YF.set(0,0,QF.width,QF.height);var x=void 0===y.minDepth?0:y.minDepth,w=void 0===y.maxDepth?1:y.maxDepth;d.viewportValue.copy(y).multiplyScalar(b).floor(),d.viewportValue.width>>=f,d.viewportValue.height>>=f,d.viewportValue.minDepth=x,d.viewportValue.maxDepth=w,d.viewport=!1===d.viewportValue.equals(YF),d.scissorValue.copy(_).multiplyScalar(b).floor(),d.scissor=this._scissorTest&&!1===d.scissorValue.equals(YF),d.scissorValue.width>>=f,d.scissorValue.height>>=f,d.clippingContext||(d.clippingContext=new CF),d.clippingContext.updateGlobal(l,t),l.onBeforeRender(this,e,t,r),ZF.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),KF.setFromProjectionMatrix(ZF,p);var T=this._renderLists.get(e,t);if(T.begin(),this._projectObject(e,t,0,T,d.clippingContext),T.finish(),!0===this.sortObjects&&T.sort(this._opaqueSort,this._transparentSort),null!==r){this._textures.updateRenderTarget(r,f);var S=this._textures.get(r);d.textures=S.textures,d.depthTexture=S.depthTexture,d.width=S.width,d.height=S.height,d.renderTarget=r,d.depth=r.depthBuffer,d.stencil=r.stencilBuffer}else d.textures=null,d.depthTexture=null,d.width=this.domElement.width,d.height=this.domElement.height,d.depth=this.depth,d.stencil=this.stencil;d.width>>=f,d.height>>=f,d.activeCubeFace=h,d.activeMipmapLevel=f,d.occlusionQueryCount=T.occlusionQueryCount,this._background.update(l,T,d),this.backend.beginRender(d);var E=T.bundles,M=T.lightsNode,C=T.transparentDoublePass,R=T.transparent,P=T.opaque;return E.length>0&&this._renderBundles(E,l,M),!0===this.opaque&&P.length>0&&this._renderObjects(P,t,l,M),!0===this.transparent&&R.length>0&&this._renderTransparents(R,C,t,l,M),this.backend.finishRender(d),a.renderId=o,this._currentRenderContext=s,this._currentRenderObjectFunction=u,null!==i&&(this.setRenderTarget(c,h,f),this._renderOutput(r)),l.onAfterRender(this,e,t,r),d}}},{key:"_renderOutput",value:function(e){var t=this._quad;this._nodes.hasOutputChange(e.texture)&&(t.material.fragmentNode=this._nodes.getOutputNode(e.texture),t.material.needsUpdate=!0);var n=this.autoClear,r=this.xr.enabled;this.autoClear=!1,this.xr.enabled=!1,this._renderScene(t,t.camera,!1),this.autoClear=n,this.xr.enabled=r}},{key:"getMaxAnisotropy",value:function(){return this.backend.getMaxAnisotropy()}},{key:"getActiveCubeFace",value:function(){return this._activeCubeFace}},{key:"getActiveMipmapLevel",value:function(){return this._activeMipmapLevel}},{key:"setAnimationLoop",value:function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==this._initialized){e.next=3;break}return e.next=3,this.init();case 3:this._animation.setAnimationLoop(t);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getArrayBufferAsync",value:function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.backend.getArrayBufferAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getContext",value:function(){return this.backend.getContext()}},{key:"getPixelRatio",value:function(){return this._pixelRatio}},{key:"getDrawingBufferSize",value:function(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}},{key:"getSize",value:function(e){return e.set(this._width,this._height)}},{key:"setPixelRatio",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}},{key:"setDrawingBufferSize",value:function(e,t,n){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this._pixelRatio=n,this.domElement.width=Math.floor(e*n),this.domElement.height=Math.floor(t*n),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}},{key:"setSize",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(t*this._pixelRatio),!0===n&&(this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}},{key:"setOpaqueSort",value:function(e){this._opaqueSort=e}},{key:"setTransparentSort",value:function(e){this._transparentSort=e}},{key:"getScissor",value:function(e){var t=this._scissor;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e}},{key:"setScissor",value:function(e,t,n,r){var i=this._scissor;e.isVector4?i.copy(e):i.set(e,t,n,r)}},{key:"getScissorTest",value:function(){return this._scissorTest}},{key:"setScissorTest",value:function(e){this._scissorTest=e,this.backend.setScissorTest(e)}},{key:"getViewport",value:function(e){return e.copy(this._viewport)}},{key:"setViewport",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=this._viewport;e.isVector4?o.copy(e):o.set(e,t,n,r),o.minDepth=i,o.maxDepth=a}},{key:"getClearColor",value:function(e){return e.copy(this._clearColor)}},{key:"setClearColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._clearColor.set(e),this._clearColor.a=t}},{key:"getClearAlpha",value:function(){return this._clearColor.a}},{key:"setClearAlpha",value:function(e){this._clearColor.a=e}},{key:"getClearDepth",value:function(){return this._clearDepth}},{key:"setClearDepth",value:function(e){this._clearDepth=e}},{key:"getClearStencil",value:function(){return this._clearStencil}},{key:"setClearStencil",value:function(e){this._clearStencil=e}},{key:"isOccluded",value:function(e){var t=this._currentRenderContext;return t&&this.backend.isOccluded(t,e)}},{key:"clear",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!1===this._initialized)return console.warn("THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead."),this.clearAsync(e,t,n);var r=this._renderTarget||this._getFrameBufferTarget(),i=null;if(null!==r){this._textures.updateRenderTarget(r);var a=this._textures.get(r);(i=this._renderContexts.getForClear(r)).textures=a.textures,i.depthTexture=a.depthTexture,i.width=a.width,i.height=a.height,i.renderTarget=r,i.depth=r.depthBuffer,i.stencil=r.stencilBuffer,i.clearColorValue=this.backend.getClearColor(),i.activeCubeFace=this.getActiveCubeFace(),i.activeMipmapLevel=this.getActiveMipmapLevel()}this.backend.clear(e,t,n,i),null!==r&&null===this._renderTarget&&this._renderOutput(r)}},{key:"clearColor",value:function(){return this.clear(!0,!1,!1)}},{key:"clearDepth",value:function(){return this.clear(!1,!0,!1)}},{key:"clearStencil",value:function(){return this.clear(!1,!1,!0)}},{key:"clearAsync",value:function(){var e=lt(ft().mark((function e(){var t,n,r,i=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(i.length>0&&void 0!==i[0])||i[0],n=!(i.length>1&&void 0!==i[1])||i[1],r=!(i.length>2&&void 0!==i[2])||i[2],!1!==this._initialized){e.next=6;break}return e.next=6,this.init();case 6:this.clear(t,n,r);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clearColorAsync",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.clearAsync(!0,!1,!1);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clearDepthAsync",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.clearAsync(!1,!0,!1);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clearStencilAsync",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.clearAsync(!1,!1,!0);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"currentToneMapping",get:function(){return this.isOutputTarget?this.toneMapping:0}},{key:"currentColorSpace",get:function(){return this.isOutputTarget?this.outputColorSpace:Zn}},{key:"isOutputTarget",get:function(){return this._renderTarget===this._outputRenderTarget||null===this._renderTarget}},{key:"dispose",value:function(){this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),null!==this._frameBufferTarget&&this._frameBufferTarget.dispose(),Object.values(this.backend.timestampQueryPool).forEach((function(e){null!==e&&e.dispose()})),this.setRenderTarget(null),this.setAnimationLoop(null)}},{key:"setRenderTarget",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._renderTarget=e,this._activeCubeFace=t,this._activeMipmapLevel=n}},{key:"getRenderTarget",value:function(){return this._renderTarget}},{key:"setOutputRenderTarget",value:function(e){this._outputRenderTarget=e}},{key:"getOutputRenderTarget",value:function(){return this._outputRenderTarget}},{key:"setRenderObjectFunction",value:function(e){this._renderObjectFunction=e}},{key:"getRenderObjectFunction",value:function(){return this._renderObjectFunction}},{key:"compute",value:function(e){var t=this;if(!0!==this._isDeviceLost){if(!1===this._initialized)return console.warn("THREE.Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e);var n=this._nodes.nodeFrame,r=n.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,n.renderId=this.info.calls;var i=this.backend,a=this._pipelines,o=this._bindings,s=this._nodes,u=Array.isArray(e)?e:[e];if(void 0===u[0]||!0!==u[0].isComputeNode)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");i.beginCompute(e);var l,c=k(u);try{var h=function(){var n=l.value;if(!1===a.has(n)){n.addEventListener("dispose",(function e(){n.removeEventListener("dispose",e),a.delete(n),o.delete(n),s.delete(n)}));var r=n.onInitFunction;null!==r&&r.call(n,{renderer:t})}s.updateForCompute(n),o.updateForCompute(n);var u=o.getForCompute(n),c=a.getForCompute(n,u);i.compute(e,n,u,c)};for(c.s();!(l=c.n()).done;)h()}catch(f){c.e(f)}finally{c.f()}i.finishCompute(e),n.renderId=r}}},{key:"computeAsync",value:function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==this._initialized){e.next=3;break}return e.next=3,this.init();case 3:this.compute(t);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"hasFeatureAsync",value:function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==this._initialized){e.next=3;break}return e.next=3,this.init();case 3:return e.abrupt("return",this.backend.hasFeature(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resolveTimestampsAsync",value:function(){var e=lt(ft().mark((function e(){var t,n=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:"render",!1!==this._initialized){e.next=4;break}return e.next=4,this.init();case 4:return e.abrupt("return",this.backend.resolveTimestampsAsync(t));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"hasFeature",value:function(e){return!1===this._initialized?(console.warn("THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead."),!1):this.backend.hasFeature(e)}},{key:"hasInitialized",value:function(){return this._initialized}},{key:"initTextureAsync",value:function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==this._initialized){e.next=3;break}return e.next=3,this.init();case 3:this._textures.updateTexture(t);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"initTexture",value:function(e){!1===this._initialized&&console.warn("THREE.Renderer: .initTexture() called before the backend is initialized. Try using .initTextureAsync() instead."),this._textures.updateTexture(e)}},{key:"copyFramebufferToTexture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null!==t)if(t.isVector2)t=JF.set(t.x,t.y,e.image.width,e.image.height).floor();else{if(!t.isVector4)return void console.error("THREE.Renderer.copyFramebufferToTexture: Invalid rectangle.");t=JF.copy(t).floor()}else t=JF.set(0,0,e.image.width,e.image.height);var n,r=this._currentRenderContext;null!==r?n=r.renderTarget:null!==(n=this._renderTarget||this._getFrameBufferTarget())&&(this._textures.updateRenderTarget(n),r=this._textures.get(n)),this._textures.updateTexture(e,{renderTarget:n}),this.backend.copyFramebufferToTexture(e,r,t)}},{key:"copyTextureToTexture",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;this._textures.updateTexture(e),this._textures.updateTexture(t),this.backend.copyTextureToTexture(e,t,n,r,i,a)}},{key:"readRenderTargetPixelsAsync",value:function(){var e=lt(ft().mark((function e(t,n,r,i,a){var o,s,u=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=u.length>5&&void 0!==u[5]?u[5]:0,s=u.length>6&&void 0!==u[6]?u[6]:0,e.abrupt("return",this.backend.copyTextureToBuffer(t.textures[o],n,r,i,a,s));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i,a){return e.apply(this,arguments)}}()},{key:"_projectObject",value:function(e,t,n,r,i){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder,e.isClippingGroup&&e.enabled&&(i=i.getGroupContext(e));else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)r.pushLight(e);else if(e.isSprite){if(!e.frustumCulled||KF.intersectsSprite(e)){!0===this.sortObjects&&JF.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ZF);var a=e.geometry,o=e.material;o.visible&&r.push(e,a,o,n,JF.z,null,i)}}else if(e.isLineLoop)console.error("THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||KF.intersectsObject(e))){var s=e.geometry,u=e.material;if(!0===this.sortObjects&&(null===s.boundingSphere&&s.computeBoundingSphere(),JF.copy(s.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(ZF)),Array.isArray(u))for(var l=s.groups,c=0,h=l.length;c<h;c++){var f=l[c],d=u[f.materialIndex];d&&d.visible&&r.push(e,s,d,n,JF.z,f,i)}else u.visible&&r.push(e,s,u,n,JF.z,null,i)}if(!0===e.isBundleGroup&&void 0!==this.backend.beginBundle){var p=r;(r=this._renderLists.get(e,t)).begin(),p.pushBundle({bundleGroup:e,camera:t,renderList:r}),r.finish()}for(var A=e.children,v=0,m=A.length;v<m;v++)this._projectObject(A[v],t,n,r,i)}}},{key:"_renderBundles",value:function(e,t,n){var r,i=k(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;this._renderBundle(a,t,n)}}catch(o){i.e(o)}finally{i.f()}}},{key:"_renderTransparents",value:function(e,t,n,r,i){if(t.length>0){var a,o=k(t);try{for(o.s();!(a=o.n()).done;){a.value.material.side=1}}catch(h){o.e(h)}finally{o.f()}this._renderObjects(t,n,r,i,"backSide");var s,u=k(t);try{for(u.s();!(s=u.n()).done;){s.value.material.side=0}}catch(h){u.e(h)}finally{u.f()}this._renderObjects(e,n,r,i);var l,c=k(t);try{for(c.s();!(l=c.n()).done;){l.value.material.side=2}}catch(h){c.e(h)}finally{c.f()}}else this._renderObjects(e,n,r,i)}},{key:"_renderObjects",value:function(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=0,o=e.length;a<o;a++){var s=e[a],u=s.object,l=s.geometry,c=s.material,h=s.group,f=s.clippingContext;this._currentRenderObjectFunction(u,n,t,l,c,h,r,f,i)}}},{key:"renderObject",value:function(e,t,n,r,i,a,o){var s,u,l,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;if(e.onBeforeRender(this,t,n,r,i,a),!0===i.allowOverride&&null!==t.overrideMaterial){var f=t.overrideMaterial;i.positionNode&&i.positionNode.isNode&&(s=f.positionNode,f.positionNode=i.positionNode),f.alphaTest=i.alphaTest,f.alphaMap=i.alphaMap,f.transparent=i.transparent||i.transmission>0,f.isShadowPassMaterial&&(f.side=null===i.shadowSide?i.side:i.shadowSide,i.depthNode&&i.depthNode.isNode&&(l=f.depthNode,f.depthNode=i.depthNode),i.castShadowNode&&i.castShadowNode.isNode&&(u=f.colorNode,f.colorNode=i.castShadowNode)),i=f}!0===i.transparent&&2===i.side&&!1===i.forceSinglePass?(i.side=1,this._handleObjectFunction(e,i,t,n,o,a,c,"backSide"),i.side=0,this._handleObjectFunction(e,i,t,n,o,a,c,h),i.side=2):this._handleObjectFunction(e,i,t,n,o,a,c,h),void 0!==s&&(t.overrideMaterial.positionNode=s),void 0!==l&&(t.overrideMaterial.depthNode=l),void 0!==u&&(t.overrideMaterial.colorNode=u),e.onAfterRender(this,t,n,r,i,a)}},{key:"_renderObjectDirect",value:function(e,t,n,r,i,a,o,s){var u=this._objects.get(e,t,n,r,i,this._currentRenderContext,o,s);u.drawRange=e.geometry.drawRange,u.group=a;var l=this._nodes.needsRefresh(u);(l&&(this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u)),this._pipelines.updateForRender(u),null!==this._currentRenderBundle)&&(this.backend.get(this._currentRenderBundle).renderObjects.push(u),u.bundle=this._currentRenderBundle.bundleGroup);this.backend.draw(u,this.info),l&&this._nodes.updateAfter(u)}},{key:"_createObjectPipeline",value:function(e,t,n,r,i,a,o,s){var u=this._objects.get(e,t,n,r,i,this._currentRenderContext,o,s);u.drawRange=e.geometry.drawRange,u.group=a,this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u),this._pipelines.getForRender(u,this._compilationPromises),this._nodes.updateAfter(u)}},{key:"compile",get:function(){return this.compileAsync}}]),e}(),ez=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";c(this,e),this.name=t,this.visibility=0}return p(e,[{key:"setVisibility",value:function(e){this.visibility|=e}},{key:"clone",value:function(){return Object.assign(new this.constructor,this)}}]),e}();var tz=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this,e)).isBuffer=!0,r.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,r._buffer=i,r}return p(n,[{key:"byteLength",get:function(){return(e=this._buffer.byteLength)+(rI-e%rI)%rI;var e}},{key:"buffer",get:function(){return this._buffer}},{key:"update",value:function(){return!0}}]),n}(ez),nz=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this,e,i)).isUniformBuffer=!0,r}return p(n)}(tz),rz=0,iz=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,"UniformBuffer_"+rz++,e?e.value:null)).nodeUniform=e,i.groupNode=r,i}return p(n,[{key:"buffer",get:function(){return this.nodeUniform.value}}]),n}(nz),az=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,e)).isUniformsGroup=!0,r._values=null,r.uniforms=[],r}return p(n,[{key:"addUniform",value:function(e){return this.uniforms.push(e),this}},{key:"removeUniform",value:function(e){var t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}},{key:"values",get:function(){return null===this._values&&(this._values=Array.from(this.buffer)),this._values}},{key:"buffer",get:function(){var e=this._buffer;if(null===e){var t=this.byteLength;e=new Float32Array(new ArrayBuffer(t)),this._buffer=e}return e}},{key:"byteLength",get:function(){for(var e=0,t=0,n=this.uniforms.length;t<n;t++){var r=this.uniforms[t],i=r.boundary,a=r.itemSize,o=e%rI;0!==o&&rI-o-i<0?e+=rI-o:o%i!==0&&(e+=o%i),r.offset=e/this.bytesPerElement,e+=a*this.bytesPerElement}return Math.ceil(e/rI)*rI}},{key:"update",value:function(){var e,t=!1,n=k(this.uniforms);try{for(n.s();!(e=n.n()).done;){var r=e.value;!0===this.updateByType(r)&&(t=!0)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"updateByType",value:function(e){return e.isNumberUniform?this.updateNumber(e):e.isVector2Uniform?this.updateVector2(e):e.isVector3Uniform?this.updateVector3(e):e.isVector4Uniform?this.updateVector4(e):e.isColorUniform?this.updateColor(e):e.isMatrix3Uniform?this.updateMatrix3(e):e.isMatrix4Uniform?this.updateMatrix4(e):void console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",e)}},{key:"updateNumber",value:function(e){var t=!1,n=this.values,r=e.getValue(),i=e.offset,a=e.getType();n[i]!==r&&(this._getBufferForType(a)[i]=n[i]=r,t=!0);return t}},{key:"updateVector2",value:function(e){var t=!1,n=this.values,r=e.getValue(),i=e.offset,a=e.getType();if(n[i+0]!==r.x||n[i+1]!==r.y){var o=this._getBufferForType(a);o[i+0]=n[i+0]=r.x,o[i+1]=n[i+1]=r.y,t=!0}return t}},{key:"updateVector3",value:function(e){var t=!1,n=this.values,r=e.getValue(),i=e.offset,a=e.getType();if(n[i+0]!==r.x||n[i+1]!==r.y||n[i+2]!==r.z){var o=this._getBufferForType(a);o[i+0]=n[i+0]=r.x,o[i+1]=n[i+1]=r.y,o[i+2]=n[i+2]=r.z,t=!0}return t}},{key:"updateVector4",value:function(e){var t=!1,n=this.values,r=e.getValue(),i=e.offset,a=e.getType();if(n[i+0]!==r.x||n[i+1]!==r.y||n[i+2]!==r.z||n[i+4]!==r.w){var o=this._getBufferForType(a);o[i+0]=n[i+0]=r.x,o[i+1]=n[i+1]=r.y,o[i+2]=n[i+2]=r.z,o[i+3]=n[i+3]=r.w,t=!0}return t}},{key:"updateColor",value:function(e){var t=!1,n=this.values,r=e.getValue(),i=e.offset;if(n[i+0]!==r.r||n[i+1]!==r.g||n[i+2]!==r.b){var a=this.buffer;a[i+0]=n[i+0]=r.r,a[i+1]=n[i+1]=r.g,a[i+2]=n[i+2]=r.b,t=!0}return t}},{key:"updateMatrix3",value:function(e){var t=!1,n=this.values,r=e.getValue().elements,i=e.offset;if(n[i+0]!==r[0]||n[i+1]!==r[1]||n[i+2]!==r[2]||n[i+4]!==r[3]||n[i+5]!==r[4]||n[i+6]!==r[5]||n[i+8]!==r[6]||n[i+9]!==r[7]||n[i+10]!==r[8]){var a=this.buffer;a[i+0]=n[i+0]=r[0],a[i+1]=n[i+1]=r[1],a[i+2]=n[i+2]=r[2],a[i+4]=n[i+4]=r[3],a[i+5]=n[i+5]=r[4],a[i+6]=n[i+6]=r[5],a[i+8]=n[i+8]=r[6],a[i+9]=n[i+9]=r[7],a[i+10]=n[i+10]=r[8],t=!0}return t}},{key:"updateMatrix4",value:function(e){var t=!1,n=this.values,r=e.getValue().elements,i=e.offset;!1===function(e,t,n){for(var r=0,i=t.length;r<i;r++)if(e[n+r]!==t[r])return!1;return!0}(n,r,i)&&(this.buffer.set(r,i),function(e,t,n){for(var r=0,i=t.length;r<i;r++)e[n+r]=t[r]}(n,r,i),t=!0);return t}},{key:"_getBufferForType",value:function(e){return"int"===e||"ivec2"===e||"ivec3"===e||"ivec4"===e?new Int32Array(this.buffer.buffer):"uint"===e||"uvec2"===e||"uvec3"===e||"uvec4"===e?new Uint32Array(this.buffer.buffer):this.buffer}}]),n}(nz);var oz,sz,uz,lz,cz,hz=0,fz=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,e)).id=hz++,i.groupNode=r,i.isNodeUniformsGroup=!0,i}return p(n)}(az),dz=0,pz=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,e)).id=dz++,i.texture=r,i.version=r?r.version:0,i.store=!1,i.generation=null,i.isSampledTexture=!0,i}return p(n,[{key:"needsBindingsUpdate",value:function(e){var t=this.texture;return e!==this.generation?(this.generation=e,!0):t.isVideoTexture}},{key:"update",value:function(){var e=this.texture;return this.version!==e.version&&(this.version=e.version,!0)}}]),n}(ez),Az=function(e){v(n,e);var t=b(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return c(this,n),(a=t.call(this,e,r?r.value:null)).textureNode=r,a.groupNode=i,a.access=o,a}return p(n,[{key:"needsBindingsUpdate",value:function(e){return this.textureNode.value!==this.texture||ht(m(n.prototype),"needsBindingsUpdate",this).call(this,e)}},{key:"update",value:function(){var e=this.textureNode;return this.texture!==e.value?(this.texture=e.value,!0):ht(m(n.prototype),"update",this).call(this)}}]),n}(pz),vz=function(e){v(n,e);var t=b(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return c(this,n),(a=t.call(this,e,r,i,o)).isSampledCubeTexture=!0,a}return p(n)}(Az),mz=function(e){v(n,e);var t=b(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return c(this,n),(a=t.call(this,e,r,i,o)).isSampledTexture3D=!0,a}return p(n)}(Az),gz={textureDimensions:"textureSize",equals:"equal"},yz={low:"lowp",medium:"mediump",high:"highp"},_z={swizzleAssign:!0,storageBuffer:!1},bz="\nprecision highp float;\nprecision highp int;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp sampler2DArray;\n\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\n\nprecision lowp sampler2DShadow;\n",xz=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,e,r,new wF)).uniformGroups={},i.transforms=[],i.extensions={},i.builtins={vertex:[],fragment:[],compute:[]},i}return p(n,[{key:"needsToWorkingColorSpace",value:function(e){return!0===e.isVideoTexture&&e.colorSpace!==Yn}},{key:"getMethod",value:function(e){return gz[e]||e}},{key:"getOutputStructName",value:function(){return""}},{key:"buildFunctionCode",value:function(e){var t,n=e.layout,r=this.flowShaderNode(e),i=[],a=k(n.inputs);try{for(a.s();!(t=a.n()).done;){var o=t.value;i.push(this.getType(o.type)+" "+o.name)}}catch(s){a.e(s)}finally{a.f()}return"".concat(this.getType(n.type)," ").concat(n.name,"( ").concat(i.join(", ")," ) {\n\n\t").concat(r.vars,"\n\n").concat(r.code,"\n\treturn ").concat(r.result,";\n\n}")}},{key:"setupPBO",value:function(e){var t=e.value;if(void 0===t.pbo){var n=t.array,r=t.count*t.itemSize,i=t.itemSize,a=t.array.constructor.name.toLowerCase().includes("int"),o=a?sn:on;2===i?o=a?ln:un:3===i?o=a?1032:$t:4===i&&(o=a?cn:en);var s={Float32Array:Wt,Uint8Array:zt,Uint16Array:jt,Uint32Array:Ht,Int8Array:Vt,Int16Array:qt,Int32Array:Gt,Uint8ClampedArray:zt},u=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(r/i)))),l=Math.ceil(r/i/u);u*l*i<r&&l++;var c=u*l*i,h=new n.constructor(c);h.set(n,0),t.array=h;var f=new Eo(t.array,u,l,o,s[t.array.constructor.name]||Wt);f.needsUpdate=!0,f.isPBOTexture=!0;var d=new yE(f,null,null);d.setPrecision("high"),t.pboNode=d,t.pbo=d.value,this.getUniformFromNode(t.pboNode,"texture",this.shaderStage,this.context.label)}}},{key:"getPropertyName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shaderStage;return e.isNodeUniform&&!0!==e.node.isTextureNode&&!0!==e.node.isBufferNode?t.charAt(0)+"_"+e.name:ht(m(n.prototype),"getPropertyName",this).call(this,e,t)}},{key:"generatePBO",value:function(e){var t=e.node,n=e.indexNode,r=t.value;this.renderer.backend.has(r)&&(this.renderer.backend.get(r).pbo=r.pbo);var i=this.getUniformFromNode(r.pboNode,"texture",this.shaderStage,this.context.label),a=this.getPropertyName(i);this.increaseUsage(n);var o=n.build(this,"uint"),s=this.getDataFromNode(e),u=s.propertyName;if(void 0===u){var l=this.getVarFromNode(e);u=this.getPropertyName(l);var c=this.getDataFromNode(t),h=c.propertySizeName;void 0===h&&(h=u+"Size",this.getVarFromNode(t,h,"uint"),this.addLineFlowCode("".concat(h," = uint( textureSize( ").concat(a,", 0 ).x )"),e),c.propertySizeName=h);var f=r.itemSize,d="."+ob.join("").slice(0,f),p="ivec2(".concat(o," % ").concat(h,", ").concat(o," / ").concat(h,")"),A=this.generateTextureLoad(null,a,p,null,"0"),v="vec4";r.pbo.type===Ht?v="uvec4":r.pbo.type===Gt&&(v="ivec4"),this.addLineFlowCode("".concat(u," = ").concat(v,"(").concat(A,")").concat(d),e),s.propertyName=u}return u}},{key:"generateTextureLoad",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"0";return r?"texelFetch( ".concat(t,", ivec3( ").concat(n,", ").concat(r," ), ").concat(i," )"):"texelFetch( ".concat(t,", ").concat(n,", ").concat(i," )")}},{key:"generateTexture",value:function(e,t,n,r){return e.isDepthTexture?"texture( ".concat(t,", ").concat(n," ).x"):(r&&(n="vec3( ".concat(n,", ").concat(r," )")),"texture( ".concat(t,", ").concat(n," )"))}},{key:"generateTextureLevel",value:function(e,t,n,r){return"textureLod( ".concat(t,", ").concat(n,", ").concat(r," )")}},{key:"generateTextureBias",value:function(e,t,n,r){return"texture( ".concat(t,", ").concat(n,", ").concat(r," )")}},{key:"generateTextureGrad",value:function(e,t,n,r){return"textureGrad( ".concat(t,", ").concat(n,", ").concat(r[0],", ").concat(r[1]," )")}},{key:"generateTextureCompare",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.shaderStage;if("fragment"===a)return"texture( ".concat(t,", vec3( ").concat(n,", ").concat(r," ) )");console.error("WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ".concat(a," shader."))}},{key:"getVars",value:function(e){var t=[],n=this.vars[e];if(void 0!==n){var r,i=k(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;t.push("".concat(this.getVar(a.type,a.name,a.count),";"))}}catch(o){i.e(o)}finally{i.f()}}return t.join("\n\t")}},{key:"getUniforms",value:function(e){var t,n=[],r={},i=k(this.uniforms[e]);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=null,s=!1;if("texture"===a.type||"texture3D"===a.type){var u=a.node.value,l="";!0!==u.isDataTexture&&!0!==u.isData3DTexture||(u.type===Ht?l="u":u.type===Gt&&(l="i")),o="texture3D"===a.type?"".concat(l,"sampler3D ").concat(a.name,";"):u.compareFunction?"sampler2DShadow ".concat(a.name,";"):!0===u.isDataArrayTexture||!0===u.isCompressedArrayTexture?"".concat(l,"sampler2DArray ").concat(a.name,";"):"".concat(l,"sampler2D ").concat(a.name,";")}else if("cubeTexture"===a.type)o="samplerCube ".concat(a.name,";");else if("buffer"===a.type){var c=a.node,h=this.getType(c.bufferType),f=c.bufferCount,d=f>0?f:"";o="".concat(c.name," {\n\t").concat(h," ").concat(a.name,"[").concat(d,"];\n};\n")}else{var p=this.getVectorType(a.type);o="".concat(p," ").concat(this.getPropertyName(a,e),";"),s=!0}var A=a.node.precision;if(null!==A&&(o=yz[A]+" "+o),s){o="\t"+o;var v=a.groupNode.name;(r[v]||(r[v]=[])).push(o)}else o="uniform "+o,n.push(o)}}catch(_){i.e(_)}finally{i.f()}var m="";for(var g in r){var y=r[g];m+=this._getGLSLUniformStruct(e+"_"+g,y.join("\n"))+"\n"}return m+=n.join("\n")}},{key:"getTypeFromAttribute",value:function(e){var t=ht(m(n.prototype),"getTypeFromAttribute",this).call(this,e);if(/^[iu]/.test(t)&&e.gpuType!==Gt){var r=e;e.isInterleavedBufferAttribute&&(r=e.data);var i=r.array;!1===(i instanceof Uint32Array||i instanceof Int32Array)&&(t=t.slice(1))}return t}},{key:"getAttributes",value:function(e){var t="";if("vertex"===e||"compute"===e){var n,r=0,i=k(this.getAttributesArray());try{for(i.s();!(n=i.n()).done;){var a=n.value;t+="layout( location = ".concat(r++," ) in ").concat(a.type," ").concat(a.name,";\n")}}catch(o){i.e(o)}finally{i.f()}}return t}},{key:"getStructMembers",value:function(e){var t,n=[],r=k(e.members);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.push("\t".concat(i.type," ").concat(i.name,";"))}}catch(a){r.e(a)}finally{r.f()}return n.join("\n")}},{key:"getStructs",value:function(e){var t,n=[],r=[],i=k(this.structs[e]);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a.output){var o,s=k(a.members);try{for(s.s();!(o=s.n()).done;){var u=o.value;r.push("layout( location = ".concat(u.index," ) out ").concat(u.type," ").concat(u.name,";"))}}catch(c){s.e(c)}finally{s.f()}}else{var l="struct "+a.name+" {\n";l+=this.getStructMembers(a),l+="\n};\n",n.push(l)}}}catch(c){i.e(c)}finally{i.f()}return 0===r.length&&r.push("layout( location = 0 ) out vec4 fragColor;"),"\n"+r.join("\n")+"\n\n"+n.join("\n")}},{key:"getVaryings",value:function(e){var t="",n=this.varyings;if("vertex"===e||"compute"===e){var r,i=k(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;"compute"===e&&(a.needsInterpolation=!0);var o=this.getType(a.type);if(a.needsInterpolation){var s=o.includes("int")||o.includes("uv")||o.includes("iv")?"flat ":"";t+="".concat(s,"out ").concat(o," ").concat(a.name,";\n")}else t+="".concat(o," ").concat(a.name,";\n")}}catch(v){i.e(v)}finally{i.f()}}else if("fragment"===e){var u,l=k(n);try{for(l.s();!(u=l.n()).done;){var c=u.value;if(c.needsInterpolation){var h=this.getType(c.type),f=h.includes("int")||h.includes("uv")||h.includes("iv")?"flat ":"";t+="".concat(f,"in ").concat(h," ").concat(c.name,";\n")}}}catch(v){l.e(v)}finally{l.f()}}var d,p=k(this.builtins[e]);try{for(p.s();!(d=p.n()).done;){var A=d.value;t+="".concat(A,";\n")}}catch(v){p.e(v)}finally{p.f()}return t}},{key:"getVertexIndex",value:function(){return"uint( gl_VertexID )"}},{key:"getInstanceIndex",value:function(){return"uint( gl_InstanceID )"}},{key:"getInvocationLocalIndex",value:function(){var e=this.object.workgroupSize.reduce((function(e,t){return e*t}),1);return"uint( gl_InstanceID ) % ".concat(e,"u")}},{key:"getDrawIndex",value:function(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}},{key:"getFrontFacing",value:function(){return"gl_FrontFacing"}},{key:"getFragCoord",value:function(){return"gl_FragCoord.xy"}},{key:"getFragDepth",value:function(){return"gl_FragDepth"}},{key:"enableExtension",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shaderStage,r=this.extensions[n]||(this.extensions[n]=new Map);!1===r.has(e)&&r.set(e,{name:e,behavior:t})}},{key:"getExtensions",value:function(e){var t=[];if("vertex"===e){var n=this.renderer.backend.extensions;this.object.isBatchedMesh&&n.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}var r=this.extensions[e];if(void 0!==r){var i,a=k(r.values());try{for(a.s();!(i=a.n()).done;){var o=i.value,s=o.name,u=o.behavior;t.push("#extension ".concat(s," : ").concat(u))}}catch(l){a.e(l)}finally{a.f()}}return t.join("\n")}},{key:"getClipDistance",value:function(){return"gl_ClipDistance"}},{key:"isAvailable",value:function(e){var t=_z[e];if(void 0===t){var n;switch(t=!1,e){case"float32Filterable":n="OES_texture_float_linear";break;case"clipDistance":n="WEBGL_clip_cull_distance"}if(void 0!==n){var r=this.renderer.backend.extensions;r.has(n)&&(r.get(n),t=!0)}_z[e]=t}return t}},{key:"isFlipY",value:function(){return!0}},{key:"enableHardwareClipping",value:function(e){this.enableExtension("GL_ANGLE_clip_cull_distance","require"),this.builtins.vertex.push("out float gl_ClipDistance[ ".concat(e," ]"))}},{key:"registerTransform",value:function(e,t){this.transforms.push({varyingName:e,attributeNode:t})}},{key:"getTransforms",value:function(){for(var e=this.transforms,t="",n=0;n<e.length;n++){var r=e[n],i=this.getPropertyName(r.attributeNode);i&&(t+="".concat(r.varyingName," = ").concat(i,";\n\t"))}return t}},{key:"_getGLSLUniformStruct",value:function(e,t){return"\nlayout( std140 ) uniform ".concat(e," {\n").concat(t,"\n};")}},{key:"_getGLSLVertexCode",value:function(e){return"#version 300 es\n\n".concat(this.getSignature(),"\n\n// extensions\n").concat(e.extensions,"\n\n// precision\n").concat(bz,"\n\n// uniforms\n").concat(e.uniforms,"\n\n// varyings\n").concat(e.varyings,"\n\n// attributes\n").concat(e.attributes,"\n\n// codes\n").concat(e.codes,"\n\nvoid main() {\n\n\t// vars\n\t").concat(e.vars,"\n\n\t// transforms\n\t").concat(e.transforms,"\n\n\t// flow\n\t").concat(e.flow,"\n\n\tgl_PointSize = 1.0;\n\n}\n")}},{key:"_getGLSLFragmentCode",value:function(e){return"#version 300 es\n\n".concat(this.getSignature(),"\n\n// precision\n").concat(bz,"\n\n// uniforms\n").concat(e.uniforms,"\n\n// varyings\n").concat(e.varyings,"\n\n// codes\n").concat(e.codes,"\n\n// structs\n").concat(e.structs,"\n\nvoid main() {\n\n\t// vars\n\t").concat(e.vars,"\n\n\t// flow\n\t").concat(e.flow,"\n\n}\n")}},{key:"buildCode",value:function(){var e=null!==this.material?{fragment:{},vertex:{}}:{compute:{}};for(var t in this.sortBindingGroups(),e){var n="// code\n\n";n+=this.flowCode[t];var r,i=this.flowNodes[t],a=i[i.length-1],o=k(i);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=this.getFlowData(s),l=s.name;l&&(n.length>0&&(n+="\n"),n+="\t// flow -> ".concat(l,"\n\t")),n+="".concat(u.code,"\n\t"),s===a&&"compute"!==t&&(n+="// result\n\t","vertex"===t?(n+="gl_Position = ",n+="".concat(u.result,";")):"fragment"===t&&(s.outputNode.isOutputStructNode||(n+="fragColor = ",n+="".concat(u.result,";"))))}}catch(h){o.e(h)}finally{o.f()}var c=e[t];c.extensions=this.getExtensions(t),c.uniforms=this.getUniforms(t),c.attributes=this.getAttributes(t),c.varyings=this.getVaryings(t),c.vars=this.getVars(t),c.structs=this.getStructs(t),c.codes=this.getCodes(t),c.transforms=this.getTransforms(t),c.flow=n}null!==this.material?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}},{key:"getUniformFromNode",value:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=ht(m(n.prototype),"getUniformFromNode",this).call(this,e,t,r,i),o=this.getDataFromNode(e,r,this.globalCache),s=o.uniformGPU;if(void 0===s){var u=e.groupNode,l=u.name,c=this.getBindGroupArray(l,r);if("texture"===t)s=new Az(a.name,a.node,u),c.push(s);else if("cubeTexture"===t)s=new vz(a.name,a.node,u),c.push(s);else if("texture3D"===t)s=new mz(a.name,a.node,u),c.push(s);else if("buffer"===t){e.name="NodeBuffer_".concat(e.id),a.name="buffer".concat(e.id);var h=new iz(e,u);h.name=e.name,c.push(h),s=h}else{var f=this.uniformGroups[r]||(this.uniformGroups[r]={}),d=f[l];void 0===d&&(d=new fz(r+"_"+l,u),f[l]=d,c.push(d)),s=this.getNodeUniform(a,t),d.addUniform(s)}o.uniformGPU=s}return a}}]),n}(iF),wz=null,Tz=null,Sz=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,e),this.parameters=Object.assign({},t),this.data=new WeakMap,this.renderer=null,this.domElement=null,this.timestampQueryPool={render:null,compute:null},this.trackTimestamp=!0===t.trackTimestamp}return p(e,[{key:"init",value:function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.renderer=t;case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"coordinateSystem",get:function(){}},{key:"beginRender",value:function(){}},{key:"finishRender",value:function(){}},{key:"beginCompute",value:function(){}},{key:"finishCompute",value:function(){}},{key:"draw",value:function(){}},{key:"compute",value:function(){}},{key:"createProgram",value:function(){}},{key:"destroyProgram",value:function(){}},{key:"createBindings",value:function(){}},{key:"updateBindings",value:function(){}},{key:"updateBinding",value:function(){}},{key:"createRenderPipeline",value:function(){}},{key:"createComputePipeline",value:function(){}},{key:"needsRenderUpdate",value:function(){}},{key:"getRenderCacheKey",value:function(){}},{key:"createNodeBuilder",value:function(){}},{key:"createSampler",value:function(){}},{key:"destroySampler",value:function(){}},{key:"createDefaultTexture",value:function(){}},{key:"createTexture",value:function(){}},{key:"updateTexture",value:function(){}},{key:"generateMipmaps",value:function(){}},{key:"destroyTexture",value:function(){}},{key:"copyTextureToBuffer",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"copyTextureToTexture",value:function(){}},{key:"copyFramebufferToTexture",value:function(){}},{key:"createAttribute",value:function(){}},{key:"createIndexAttribute",value:function(){}},{key:"createStorageAttribute",value:function(){}},{key:"updateAttribute",value:function(){}},{key:"destroyAttribute",value:function(){}},{key:"getContext",value:function(){}},{key:"updateSize",value:function(){}},{key:"updateViewport",value:function(){}},{key:"isOccluded",value:function(){}},{key:"resolveTimestampsAsync",value:function(){var e=lt(ft().mark((function e(){var t,n,r,i=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:"render",this.trackTimestamp){e.next=4;break}return kr("WebGPURenderer: Timestamp tracking is disabled."),e.abrupt("return");case 4:if(n=this.timestampQueryPool[t]){e.next=8;break}return kr("WebGPURenderer: No timestamp query pool for type '".concat(t,"' found.")),e.abrupt("return");case 8:return e.next=10,n.resolveQueriesAsync();case 10:return r=e.sent,this.renderer.info[t].timestamp=r,e.abrupt("return",r);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"waitForGPU",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getArrayBufferAsync",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"hasFeatureAsync",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"hasFeature",value:function(){}},{key:"getMaxAnisotropy",value:function(){}},{key:"getDrawingBufferSize",value:function(){return wz=wz||new _r,this.renderer.getDrawingBufferSize(wz)}},{key:"setScissorTest",value:function(){}},{key:"getClearColor",value:function(){var e=this.renderer;return Tz=Tz||new PI,e.getClearColor(Tz),Tz.getRGB(Tz),Tz}},{key:"getDomElement",value:function(){var e=this.domElement;return null===e&&("setAttribute"in(e=void 0!==this.parameters.canvas?this.parameters.canvas:Sr())&&e.setAttribute("data-engine","three.js r".concat(dt," webgpu")),this.domElement=e),e}},{key:"set",value:function(e,t){this.data.set(e,t)}},{key:"get",value:function(e){var t=this.data.get(e);return void 0===t&&(t={},this.data.set(e,t)),t}},{key:"has",value:function(e){return this.data.has(e)}},{key:"delete",value:function(e){this.data.delete(e)}},{key:"dispose",value:function(){}}]),e}(),Ez=0,kz=function(){function e(t,n){c(this,e),this.buffers=[t.bufferGPU,n],this.type=t.type,this.bufferType=t.bufferType,this.pbo=t.pbo,this.byteLength=t.byteLength,this.bytesPerElement=t.BYTES_PER_ELEMENT,this.version=t.version,this.isInteger=t.isInteger,this.activeBufferIndex=0,this.baseId=t.id}return p(e,[{key:"id",get:function(){return"".concat(this.baseId,"|").concat(this.activeBufferIndex)}},{key:"bufferGPU",get:function(){return this.buffers[this.activeBufferIndex]}},{key:"transformBuffer",get:function(){return this.buffers[1^this.activeBufferIndex]}},{key:"switchBuffers",value:function(){this.activeBufferIndex^=1}}]),e}(),Mz=function(){function e(t){c(this,e),this.backend=t}return p(e,[{key:"createAttribute",value:function(e,t){var n,r=this.backend,i=r.gl,a=e.array,o=e.usage||i.STATIC_DRAW,s=e.isInterleavedBufferAttribute?e.data:e,u=r.get(s),l=u.bufferGPU;if(void 0===l&&(l=this._createBuffer(i,t,a,o),u.bufferGPU=l,u.bufferType=t,u.version=s.version),a instanceof Float32Array)n=i.FLOAT;else if(a instanceof Uint16Array)n=e.isFloat16BufferAttribute?i.HALF_FLOAT:i.UNSIGNED_SHORT;else if(a instanceof Int16Array)n=i.SHORT;else if(a instanceof Uint32Array)n=i.UNSIGNED_INT;else if(a instanceof Int32Array)n=i.INT;else if(a instanceof Int8Array)n=i.BYTE;else if(a instanceof Uint8Array)n=i.UNSIGNED_BYTE;else{if(!(a instanceof Uint8ClampedArray))throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+a);n=i.UNSIGNED_BYTE}var c={bufferGPU:l,bufferType:t,type:n,byteLength:a.byteLength,bytesPerElement:a.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:n===i.INT||n===i.UNSIGNED_INT||e.gpuType===Gt,id:Ez++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){var h=this._createBuffer(i,t,a,o);c=new kz(c,h)}r.set(e,c)}},{key:"updateAttribute",value:function(e){var t=this.backend,n=t.gl,r=e.array,i=e.isInterleavedBufferAttribute?e.data:e,a=t.get(i),o=a.bufferType,s=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(n.bindBuffer(o,a.bufferGPU),0===s.length)n.bufferSubData(o,0,r);else{for(var u=0,l=s.length;u<l;u++){var c=s[u];n.bufferSubData(o,c.start*r.BYTES_PER_ELEMENT,r,c.start,c.count)}i.clearUpdateRanges()}n.bindBuffer(o,null),a.version=i.version}},{key:"destroyAttribute",value:function(e){var t=this.backend,n=t.gl;e.isInterleavedBufferAttribute&&t.delete(e.data);var r=t.get(e);n.deleteBuffer(r.bufferGPU),t.delete(e)}},{key:"getArrayBufferAsync",value:function(){var e=lt(ft().mark((function e(t){var n,r,i,a,o,s,u,l,c;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.backend,r=n.gl,i=t.isInterleavedBufferAttribute?t.data:t,a=n.get(i),o=a.bufferGPU,s=t.array,u=s.byteLength,r.bindBuffer(r.COPY_READ_BUFFER,o),l=r.createBuffer(),r.bindBuffer(r.COPY_WRITE_BUFFER,l),r.bufferData(r.COPY_WRITE_BUFFER,u,r.STREAM_READ),r.copyBufferSubData(r.COPY_READ_BUFFER,r.COPY_WRITE_BUFFER,0,0,u),e.next=13,n.utils._clientWaitAsync();case 13:return c=new t.array.constructor(s.length),r.bindBuffer(r.COPY_WRITE_BUFFER,l),r.getBufferSubData(r.COPY_WRITE_BUFFER,0,c),r.deleteBuffer(l),r.bindBuffer(r.COPY_READ_BUFFER,null),r.bindBuffer(r.COPY_WRITE_BUFFER,null),e.abrupt("return",c.buffer);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createBuffer",value:function(e,t,n,r){var i=e.createBuffer();return e.bindBuffer(t,i),e.bufferData(t,n,r),e.bindBuffer(t,null),i}}]),e}(),Cz=function(){function e(t){c(this,e),this.backend=t,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentClippingPlanes=0,this.currentVAO=null,this.currentIndex=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},this._init()}return p(e,[{key:"_init",value:function(){var e,t,n=this.gl;We(e={},bt,n.FUNC_ADD),We(e,101,n.FUNC_SUBTRACT),We(e,102,n.FUNC_REVERSE_SUBTRACT),oz=e,We(t={},xt,n.ZERO),We(t,201,n.ONE),We(t,202,n.SRC_COLOR),We(t,wt,n.SRC_ALPHA),We(t,210,n.SRC_ALPHA_SATURATE),We(t,208,n.DST_COLOR),We(t,206,n.DST_ALPHA),We(t,203,n.ONE_MINUS_SRC_COLOR),We(t,Tt,n.ONE_MINUS_SRC_ALPHA),We(t,209,n.ONE_MINUS_DST_COLOR),We(t,207,n.ONE_MINUS_DST_ALPHA),sz=t;var r=n.getParameter(n.SCISSOR_BOX),i=n.getParameter(n.VIEWPORT);this.currentScissor=(new Gr).fromArray(r),this.currentViewport=(new Gr).fromArray(i),this._tempVec4=new Gr}},{key:"enable",value:function(e){var t=this.enabled;!0!==t[e]&&(this.gl.enable(e),t[e]=!0)}},{key:"disable",value:function(e){var t=this.enabled;!1!==t[e]&&(this.gl.disable(e),t[e]=!1)}},{key:"setFlipSided",value:function(e){if(this.currentFlipSided!==e){var t=this.gl;e?t.frontFace(t.CW):t.frontFace(t.CCW),this.currentFlipSided=e}}},{key:"setCullFace",value:function(e){var t=this.gl;0!==e?(this.enable(t.CULL_FACE),e!==this.currentCullFace&&(1===e?t.cullFace(t.BACK):2===e?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),this.currentCullFace=e}},{key:"setLineWidth",value:function(e){var t=this.currentLineWidth,n=this.gl;e!==t&&(n.lineWidth(e),this.currentLineWidth=e)}},{key:"setBlending",value:function(e,t,n,r,i,a,o,s){var u=this.gl;if(0!==e){if(!1===this.currentBlendingEnabled&&(this.enable(u.BLEND),this.currentBlendingEnabled=!0),5===e)i=i||t,a=a||n,o=o||r,t===this.currentBlendEquation&&i===this.currentBlendEquationAlpha||(u.blendEquationSeparate(oz[t],oz[i]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=i),n===this.currentBlendSrc&&r===this.currentBlendDst&&a===this.currentBlendSrcAlpha&&o===this.currentBlendDstAlpha||(u.blendFuncSeparate(sz[n],sz[r],sz[a],sz[o]),this.currentBlendSrc=n,this.currentBlendDst=r,this.currentBlendSrcAlpha=a,this.currentBlendDstAlpha=o),this.currentBlending=e,this.currentPremultipledAlpha=!1;else if(e!==this.currentBlending||s!==this.currentPremultipledAlpha){if(this.currentBlendEquation===bt&&this.currentBlendEquationAlpha===bt||(u.blendEquation(u.FUNC_ADD),this.currentBlendEquation=bt,this.currentBlendEquationAlpha=bt),s)switch(e){case 1:u.blendFuncSeparate(u.ONE,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case 2:u.blendFunc(u.ONE,u.ONE);break;case 3:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case 4:u.blendFuncSeparate(u.ZERO,u.SRC_COLOR,u.ZERO,u.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case 1:u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case 2:u.blendFunc(u.SRC_ALPHA,u.ONE);break;case 3:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case 4:u.blendFunc(u.ZERO,u.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=s}}else!0===this.currentBlendingEnabled&&(this.disable(u.BLEND),this.currentBlendingEnabled=!1)}},{key:"setColorMask",value:function(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}},{key:"setDepthTest",value:function(e){var t=this.gl;e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)}},{key:"setDepthMask",value:function(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}},{key:"setDepthFunc",value:function(e){if(this.currentDepthFunc!==e){var t=this.gl;switch(e){case 0:t.depthFunc(t.NEVER);break;case 1:t.depthFunc(t.ALWAYS);break;case 2:t.depthFunc(t.LESS);break;case 3:default:t.depthFunc(t.LEQUAL);break;case 4:t.depthFunc(t.EQUAL);break;case 5:t.depthFunc(t.GEQUAL);break;case 6:t.depthFunc(t.GREATER);break;case 7:t.depthFunc(t.NOTEQUAL)}this.currentDepthFunc=e}}},{key:"scissor",value:function(e,t,n,r){var i=this._tempVec4.set(e,t,n,r);!1===this.currentScissor.equals(i)&&(this.gl.scissor(i.x,i.y,i.z,i.w),this.currentScissor.copy(i))}},{key:"viewport",value:function(e,t,n,r){var i=this._tempVec4.set(e,t,n,r);!1===this.currentViewport.equals(i)&&(this.gl.viewport(i.x,i.y,i.z,i.w),this.currentViewport.copy(i))}},{key:"setScissorTest",value:function(e){var t=this.gl;e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)}},{key:"setStencilTest",value:function(e){var t=this.gl;e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)}},{key:"setStencilMask",value:function(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}},{key:"setStencilFunc",value:function(e,t,n){this.currentStencilFunc===e&&this.currentStencilRef===t&&this.currentStencilFuncMask===n||(this.gl.stencilFunc(e,t,n),this.currentStencilFunc=e,this.currentStencilRef=t,this.currentStencilFuncMask=n)}},{key:"setStencilOp",value:function(e,t,n){this.currentStencilFail===e&&this.currentStencilZFail===t&&this.currentStencilZPass===n||(this.gl.stencilOp(e,t,n),this.currentStencilFail=e,this.currentStencilZFail=t,this.currentStencilZPass=n)}},{key:"setMaterial",value:function(e,t,n){var r=this.gl;2===e.side?this.disable(r.CULL_FACE):this.enable(r.CULL_FACE);var i=1===e.side;t&&(i=!i),this.setFlipSided(i),1===e.blending&&!1===e.transparent?this.setBlending(0):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);var a=e.stencilWrite;if(this.setStencilTest(a),a&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage&&this.backend.renderer.samples>1?this.enable(r.SAMPLE_ALPHA_TO_COVERAGE):this.disable(r.SAMPLE_ALPHA_TO_COVERAGE),n>0&&this.currentClippingPlanes!==n)for(var o=0;o<8;o++)o<n?this.enable(12288+o):this.disable(12288+o)}},{key:"setPolygonOffset",value:function(e,t,n){var r=this.gl;e?(this.enable(r.POLYGON_OFFSET_FILL),this.currentPolygonOffsetFactor===t&&this.currentPolygonOffsetUnits===n||(r.polygonOffset(t,n),this.currentPolygonOffsetFactor=t,this.currentPolygonOffsetUnits=n)):this.disable(r.POLYGON_OFFSET_FILL)}},{key:"useProgram",value:function(e){return this.currentProgram!==e&&(this.gl.useProgram(e),this.currentProgram=e,!0)}},{key:"setVertexState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.gl;return(this.currentVAO!==e||this.currentIndex!==t)&&(n.bindVertexArray(e),null!==t&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t),this.currentVAO=e,this.currentIndex=t,!0)}},{key:"resetVertexState",value:function(){var e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.currentVAO=null,this.currentIndex=null}},{key:"bindFramebuffer",value:function(e,t){var n=this.gl,r=this.currentBoundFramebuffers;return r[e]!==t&&(n.bindFramebuffer(e,t),r[e]=t,e===n.DRAW_FRAMEBUFFER&&(r[n.FRAMEBUFFER]=t),e===n.FRAMEBUFFER&&(r[n.DRAW_FRAMEBUFFER]=t),!0)}},{key:"drawBuffers",value:function(e,t){var n=this.gl,r=[],i=!1;if(null!==e.textures){r=this.currentDrawbuffers.get(t),void 0===r&&(r=[],this.currentDrawbuffers.set(t,r));var a=e.textures;if(r.length!==a.length||r[0]!==n.COLOR_ATTACHMENT0){for(var o=0,s=a.length;o<s;o++)r[o]=n.COLOR_ATTACHMENT0+o;r.length=a.length,i=!0}}else r[0]!==n.BACK&&(r[0]=n.BACK,i=!0);i&&n.drawBuffers(r)}},{key:"activeTexture",value:function(e){var t=this.gl,n=this.currentTextureSlot,r=this.maxTextures;void 0===e&&(e=t.TEXTURE0+r-1),n!==e&&(t.activeTexture(e),this.currentTextureSlot=e)}},{key:"bindTexture",value:function(e,t,n){var r=this.gl,i=this.currentTextureSlot,a=this.currentBoundTextures,o=this.maxTextures;void 0===n&&(n=null===i?r.TEXTURE0+o-1:i);var s=a[n];void 0===s&&(s={type:void 0,texture:void 0},a[n]=s),s.type===e&&s.texture===t||(i!==n&&(r.activeTexture(n),this.currentTextureSlot=n),r.bindTexture(e,t),s.type=e,s.texture=t)}},{key:"bindBufferBase",value:function(e,t,n){var r=this.gl,i="".concat(e,"-").concat(t);return this.currentBoundBufferBases[i]!==n&&(r.bindBufferBase(e,t,n),this.currentBoundBufferBases[i]=n,!0)}},{key:"unbindTexture",value:function(){var e=this.gl,t=this.currentTextureSlot,n=this.currentBoundTextures[t];void 0!==n&&void 0!==n.type&&(e.bindTexture(n.type,null),n.type=void 0,n.texture=void 0)}}]),e}(),Rz=function(){function e(t){c(this,e),this.backend=t,this.gl=this.backend.gl,this.extensions=t.extensions}return p(e,[{key:"convert",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Yn,r=this.gl,i=this.extensions;if(e===zt)return r.UNSIGNED_BYTE;if(e===Qt)return r.UNSIGNED_SHORT_4_4_4_4;if(e===Yt)return r.UNSIGNED_SHORT_5_5_5_1;if(e===Zt)return r.UNSIGNED_INT_5_9_9_9_REV;if(e===Vt)return r.BYTE;if(e===qt)return r.SHORT;if(e===jt)return r.UNSIGNED_SHORT;if(e===Gt)return r.INT;if(e===Ht)return r.UNSIGNED_INT;if(e===Wt)return r.FLOAT;if(e===Xt)return r.HALF_FLOAT;if(e===Jt)return r.ALPHA;if(e===$t)return r.RGB;if(e===en)return r.RGBA;if(e===tn)return r.LUMINANCE;if(e===nn)return r.LUMINANCE_ALPHA;if(e===rn)return r.DEPTH_COMPONENT;if(e===an)return r.DEPTH_STENCIL;if(e===on)return r.RED;if(e===sn)return r.RED_INTEGER;if(e===un)return r.RG;if(e===ln)return r.RG_INTEGER;if(e===cn)return r.RGBA_INTEGER;if(e===hn||e===fn||e===dn||e===pn)if(n===Kn){if(null===(t=i.get("WEBGL_compressed_texture_s3tc_srgb")))return null;if(e===hn)return t.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===fn)return t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===dn)return t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===pn)return t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(null===(t=i.get("WEBGL_compressed_texture_s3tc")))return null;if(e===hn)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===fn)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===dn)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===pn)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===An||e===vn||e===mn||e===gn){if(null===(t=i.get("WEBGL_compressed_texture_pvrtc")))return null;if(e===An)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===vn)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===mn)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===gn)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===yn||e===_n||e===bn){if(null===(t=i.get("WEBGL_compressed_texture_etc")))return null;if(e===yn||e===_n)return n===Kn?t.COMPRESSED_SRGB8_ETC2:t.COMPRESSED_RGB8_ETC2;if(e===bn)return n===Kn?t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:t.COMPRESSED_RGBA8_ETC2_EAC}if(e===xn||e===wn||e===Tn||e===Sn||e===En||e===kn||e===Mn||e===Cn||e===Rn||e===Pn||e===Nn||e===In||e===Ln||e===Dn){if(null===(t=i.get("WEBGL_compressed_texture_astc")))return null;if(e===xn)return n===Kn?t.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:t.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===wn)return n===Kn?t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:t.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===Tn)return n===Kn?t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:t.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===Sn)return n===Kn?t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:t.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===En)return n===Kn?t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:t.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===kn)return n===Kn?t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:t.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===Mn)return n===Kn?t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:t.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===Cn)return n===Kn?t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:t.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===Rn)return n===Kn?t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:t.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===Pn)return n===Kn?t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:t.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===Nn)return n===Kn?t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:t.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===In)return n===Kn?t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:t.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===Ln)return n===Kn?t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:t.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===Dn)return n===Kn?t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:t.COMPRESSED_RGBA_ASTC_12x12_KHR}if(e===On){if(null===(t=i.get("EXT_texture_compression_bptc")))return null;if(e===On)return n===Kn?t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:t.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(e===Fn||e===zn||e===Vn||e===qn){if(null===(t=i.get("EXT_texture_compression_rgtc")))return null;if(e===On)return t.COMPRESSED_RED_RGTC1_EXT;if(e===zn)return t.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===Vn)return t.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===qn)return t.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return e===Kt?r.UNSIGNED_INT_24_8:void 0!==r[e]?r[e]:null}},{key:"_clientWaitAsync",value:function(){var e=this.gl,t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((function(n,r){!function i(){var a=e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0);if(a===e.WAIT_FAILED)return e.deleteSync(t),void r();a!==e.TIMEOUT_EXPIRED?(e.deleteSync(t),n()):requestAnimationFrame(i)}()}))}}]),e}(),Pz=!1,Nz=function(){function e(t){c(this,e),this.backend=t,this.gl=t.gl,this.extensions=t.extensions,this.defaultTextures={},!1===Pz&&(this._init(),Pz=!0)}return p(e,[{key:"_init",value:function(){var e,t,n,r=this.gl;We(e={},Pt,r.REPEAT),We(e,Nt,r.CLAMP_TO_EDGE),We(e,It,r.MIRRORED_REPEAT),uz=e,We(t={},Lt,r.NEAREST),We(t,Dt,r.NEAREST_MIPMAP_NEAREST),We(t,Ot,r.NEAREST_MIPMAP_LINEAR),We(t,Ut,r.LINEAR),We(t,Bt,r.LINEAR_MIPMAP_NEAREST),We(t,Ft,r.LINEAR_MIPMAP_LINEAR),lz=t,We(n={},512,r.NEVER),We(n,519,r.ALWAYS),We(n,tr,r.LESS),We(n,nr,r.LEQUAL),We(n,514,r.EQUAL),We(n,518,r.GEQUAL),We(n,516,r.GREATER),We(n,517,r.NOTEQUAL),cz=n}},{key:"getGLTextureType",value:function(e){var t=this.gl;return!0===e.isCubeTexture?t.TEXTURE_CUBE_MAP:!0===e.isDataArrayTexture||!0===e.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:!0===e.isData3DTexture?t.TEXTURE_3D:t.TEXTURE_2D}},{key:"getInternalFormat",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this.gl,o=this.extensions;if(null!==e){if(void 0!==a[e])return a[e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+e+"'")}var s=t;return t===a.RED&&(n===a.FLOAT&&(s=a.R32F),n===a.HALF_FLOAT&&(s=a.R16F),n===a.UNSIGNED_BYTE&&(s=a.R8),n===a.UNSIGNED_SHORT&&(s=a.R16),n===a.UNSIGNED_INT&&(s=a.R32UI),n===a.BYTE&&(s=a.R8I),n===a.SHORT&&(s=a.R16I),n===a.INT&&(s=a.R32I)),t===a.RED_INTEGER&&(n===a.UNSIGNED_BYTE&&(s=a.R8UI),n===a.UNSIGNED_SHORT&&(s=a.R16UI),n===a.UNSIGNED_INT&&(s=a.R32UI),n===a.BYTE&&(s=a.R8I),n===a.SHORT&&(s=a.R16I),n===a.INT&&(s=a.R32I)),t===a.RG&&(n===a.FLOAT&&(s=a.RG32F),n===a.HALF_FLOAT&&(s=a.RG16F),n===a.UNSIGNED_BYTE&&(s=a.RG8),n===a.UNSIGNED_SHORT&&(s=a.RG16),n===a.UNSIGNED_INT&&(s=a.RG32UI),n===a.BYTE&&(s=a.RG8I),n===a.SHORT&&(s=a.RG16I),n===a.INT&&(s=a.RG32I)),t===a.RG_INTEGER&&(n===a.UNSIGNED_BYTE&&(s=a.RG8UI),n===a.UNSIGNED_SHORT&&(s=a.RG16UI),n===a.UNSIGNED_INT&&(s=a.RG32UI),n===a.BYTE&&(s=a.RG8I),n===a.SHORT&&(s=a.RG16I),n===a.INT&&(s=a.RG32I)),t===a.RGB&&(n===a.FLOAT&&(s=a.RGB32F),n===a.HALF_FLOAT&&(s=a.RGB16F),n===a.UNSIGNED_BYTE&&(s=a.RGB8),n===a.UNSIGNED_SHORT&&(s=a.RGB16),n===a.UNSIGNED_INT&&(s=a.RGB32UI),n===a.BYTE&&(s=a.RGB8I),n===a.SHORT&&(s=a.RGB16I),n===a.INT&&(s=a.RGB32I),n===a.UNSIGNED_BYTE&&(s=r===Kn&&!1===i?a.SRGB8:a.RGB8),n===a.UNSIGNED_SHORT_5_6_5&&(s=a.RGB565),n===a.UNSIGNED_SHORT_5_5_5_1&&(s=a.RGB5_A1),n===a.UNSIGNED_SHORT_4_4_4_4&&(s=a.RGB4),n===a.UNSIGNED_INT_5_9_9_9_REV&&(s=a.RGB9_E5)),t===a.RGB_INTEGER&&(n===a.UNSIGNED_BYTE&&(s=a.RGB8UI),n===a.UNSIGNED_SHORT&&(s=a.RGB16UI),n===a.UNSIGNED_INT&&(s=a.RGB32UI),n===a.BYTE&&(s=a.RGB8I),n===a.SHORT&&(s=a.RGB16I),n===a.INT&&(s=a.RGB32I)),t===a.RGBA&&(n===a.FLOAT&&(s=a.RGBA32F),n===a.HALF_FLOAT&&(s=a.RGBA16F),n===a.UNSIGNED_BYTE&&(s=a.RGBA8),n===a.UNSIGNED_SHORT&&(s=a.RGBA16),n===a.UNSIGNED_INT&&(s=a.RGBA32UI),n===a.BYTE&&(s=a.RGBA8I),n===a.SHORT&&(s=a.RGBA16I),n===a.INT&&(s=a.RGBA32I),n===a.UNSIGNED_BYTE&&(s=r===Kn&&!1===i?a.SRGB8_ALPHA8:a.RGBA8),n===a.UNSIGNED_SHORT_4_4_4_4&&(s=a.RGBA4),n===a.UNSIGNED_SHORT_5_5_5_1&&(s=a.RGB5_A1)),t===a.RGBA_INTEGER&&(n===a.UNSIGNED_BYTE&&(s=a.RGBA8UI),n===a.UNSIGNED_SHORT&&(s=a.RGBA16UI),n===a.UNSIGNED_INT&&(s=a.RGBA32UI),n===a.BYTE&&(s=a.RGBA8I),n===a.SHORT&&(s=a.RGBA16I),n===a.INT&&(s=a.RGBA32I)),t===a.DEPTH_COMPONENT&&(n===a.UNSIGNED_SHORT&&(s=a.DEPTH_COMPONENT16),n===a.UNSIGNED_INT&&(s=a.DEPTH_COMPONENT24),n===a.FLOAT&&(s=a.DEPTH_COMPONENT32F)),t===a.DEPTH_STENCIL&&n===a.UNSIGNED_INT_24_8&&(s=a.DEPTH24_STENCIL8),s!==a.R16F&&s!==a.R32F&&s!==a.RG16F&&s!==a.RG32F&&s!==a.RGBA16F&&s!==a.RGBA32F||o.get("EXT_color_buffer_float"),s}},{key:"setTextureParameters",value:function(e,t){var n=this.gl,r=this.extensions,i=this.backend;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,t.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,t.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE),n.texParameteri(e,n.TEXTURE_WRAP_S,uz[t.wrapS]),n.texParameteri(e,n.TEXTURE_WRAP_T,uz[t.wrapT]),e!==n.TEXTURE_3D&&e!==n.TEXTURE_2D_ARRAY||n.texParameteri(e,n.TEXTURE_WRAP_R,uz[t.wrapR]),n.texParameteri(e,n.TEXTURE_MAG_FILTER,lz[t.magFilter]);var a=void 0!==t.mipmaps&&t.mipmaps.length>0,o=t.minFilter===Ut&&a?Ft:t.minFilter;if(n.texParameteri(e,n.TEXTURE_MIN_FILTER,lz[o]),t.compareFunction&&(n.texParameteri(e,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(e,n.TEXTURE_COMPARE_FUNC,cz[t.compareFunction])),!0===r.has("EXT_texture_filter_anisotropic")){if(t.magFilter===Lt)return;if(t.minFilter!==Ot&&t.minFilter!==Ft)return;if(t.type===Wt&&!1===r.has("OES_texture_float_linear"))return;if(t.anisotropy>1){var s=r.get("EXT_texture_filter_anisotropic");n.texParameterf(e,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,i.getMaxAnisotropy()))}}}},{key:"createDefaultTexture",value:function(e){var t=this.gl,n=this.backend,r=this.defaultTextures,i=this.getGLTextureType(e),a=r[i];void 0===a&&(a=t.createTexture(),n.state.bindTexture(i,a),t.texParameteri(i,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(i,t.TEXTURE_MAG_FILTER,t.NEAREST),r[i]=a),n.set(e,{textureGPU:a,glTextureType:i,isDefault:!0})}},{key:"createTexture",value:function(e,t){var n=this.gl,r=this.backend,i=t.levels,a=t.width,o=t.height,s=t.depth,u=r.utils.convert(e.format,e.colorSpace),l=r.utils.convert(e.type),c=this.getInternalFormat(e.internalFormat,u,l,e.colorSpace,e.isVideoTexture),h=n.createTexture(),f=this.getGLTextureType(e);r.state.bindTexture(f,h),this.setTextureParameters(f,e),e.isDataArrayTexture||e.isCompressedArrayTexture?n.texStorage3D(n.TEXTURE_2D_ARRAY,i,c,a,o,s):e.isData3DTexture?n.texStorage3D(n.TEXTURE_3D,i,c,a,o,s):e.isVideoTexture||n.texStorage2D(f,i,c,a,o),r.set(e,{textureGPU:h,glTextureType:f,glFormat:u,glType:l,glInternalFormat:c})}},{key:"copyBufferToTexture",value:function(e,t){var n=this.gl,r=this.backend,i=r.get(t),a=i.textureGPU,o=i.glTextureType,s=i.glFormat,u=i.glType,l=t.source.data,c=l.width,h=l.height;n.bindBuffer(n.PIXEL_UNPACK_BUFFER,e),r.state.bindTexture(o,a),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.texSubImage2D(o,0,0,0,c,h,s,u,0),n.bindBuffer(n.PIXEL_UNPACK_BUFFER,null),r.state.unbindTexture()}},{key:"updateTexture",value:function(e,t){var n=this.gl,r=t.width,i=t.height,a=this.backend.get(e),o=a.textureGPU,s=a.glTextureType,u=a.glFormat,l=a.glType,c=a.glInternalFormat;if(!e.isRenderTargetTexture&&void 0!==o){var h=function(e){return e.isDataTexture?e.image.data:"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||e instanceof OffscreenCanvas?e:e.data};if(this.backend.state.bindTexture(s,o),this.setTextureParameters(s,e),e.isCompressedTexture)for(var f=e.mipmaps,d=t.image,p=0;p<f.length;p++){var A=f[p];e.isCompressedArrayTexture?e.format!==n.RGBA?null!==u?n.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,p,0,0,0,A.width,A.height,d.depth,u,A.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texSubImage3D(n.TEXTURE_2D_ARRAY,p,0,0,0,A.width,A.height,d.depth,u,l,A.data):null!==u?n.compressedTexSubImage2D(n.TEXTURE_2D,p,0,0,A.width,A.height,u,A.data):console.warn("Unsupported compressed texture format")}else if(e.isCubeTexture)for(var v=t.images,m=0;m<6;m++){var g=h(v[m]);n.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,0,0,r,i,u,l,g)}else if(e.isDataArrayTexture){var y=t.image;n.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,y.width,y.height,y.depth,u,l,y.data)}else if(e.isData3DTexture){var _=t.image;n.texSubImage3D(n.TEXTURE_3D,0,0,0,0,_.width,_.height,_.depth,u,l,_.data)}else if(e.isVideoTexture)e.update(),n.texImage2D(s,0,c,u,l,t.image);else{var b=h(t.image);n.texSubImage2D(s,0,0,0,r,i,u,l,b)}}}},{key:"generateMipmaps",value:function(e){var t=this.gl,n=this.backend,r=n.get(e),i=r.textureGPU,a=r.glTextureType;n.state.bindTexture(a,i),t.generateMipmap(a)}},{key:"deallocateRenderBuffers",value:function(e){var t=this.gl,n=this.backend;if(e){var r=n.get(e);if(r.renderBufferStorageSetup=void 0,r.framebuffers){for(var i in r.framebuffers)t.deleteFramebuffer(r.framebuffers[i]);delete r.framebuffers}if(r.depthRenderbuffer&&(t.deleteRenderbuffer(r.depthRenderbuffer),delete r.depthRenderbuffer),r.stencilRenderbuffer&&(t.deleteRenderbuffer(r.stencilRenderbuffer),delete r.stencilRenderbuffer),r.msaaFrameBuffer&&(t.deleteFramebuffer(r.msaaFrameBuffer),delete r.msaaFrameBuffer),r.msaaRenderbuffers){for(var a=0;a<r.msaaRenderbuffers.length;a++)t.deleteRenderbuffer(r.msaaRenderbuffers[a]);delete r.msaaRenderbuffers}}}},{key:"destroyTexture",value:function(e){var t=this.gl,n=this.backend,r=n.get(e),i=r.textureGPU,a=r.renderTarget;this.deallocateRenderBuffers(a),t.deleteTexture(i),n.delete(e)}},{key:"copyTextureToTexture",value:function(e,t){var n,r,i,a,o,s,u,l,c,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,A=this.gl,v=this.backend,m=this.backend.state,g=v.get(t),y=g.textureGPU,_=g.glTextureType,b=g.glType,x=g.glFormat;m.bindTexture(_,y);var w=e.isCompressedTexture?e.mipmaps[p]:e.image;if(null!==h)n=h.max.x-h.min.x,r=h.max.y-h.min.y,i=h.isBox3?h.max.z-h.min.z:1,a=h.min.x,o=h.min.y,s=h.isBox3?h.min.z:0;else{var T=Math.pow(2,-d);n=Math.floor(w.width*T),r=Math.floor(w.height*T),i=e.isDataArrayTexture?w.depth:e.isData3DTexture?Math.floor(w.depth*T):1,a=0,o=0,s=0}null!==f?(u=f.x,l=f.y,c=f.z):(u=0,l=0,c=0),A.pixelStorei(A.UNPACK_FLIP_Y_WEBGL,t.flipY),A.pixelStorei(A.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),A.pixelStorei(A.UNPACK_ALIGNMENT,t.unpackAlignment);var S=A.getParameter(A.UNPACK_ROW_LENGTH),E=A.getParameter(A.UNPACK_IMAGE_HEIGHT),k=A.getParameter(A.UNPACK_SKIP_PIXELS),M=A.getParameter(A.UNPACK_SKIP_ROWS),C=A.getParameter(A.UNPACK_SKIP_IMAGES);A.pixelStorei(A.UNPACK_ROW_LENGTH,w.width),A.pixelStorei(A.UNPACK_IMAGE_HEIGHT,w.height),A.pixelStorei(A.UNPACK_SKIP_PIXELS,a),A.pixelStorei(A.UNPACK_SKIP_ROWS,o),A.pixelStorei(A.UNPACK_SKIP_IMAGES,s);var R=t.isDataArrayTexture||t.isData3DTexture;if(e.isRenderTargetTexture||e.isDepthTexture){var P=v.get(e),N=v.get(t),I=v.get(P.renderTarget),L=v.get(N.renderTarget),D=I.framebuffers[P.cacheKey],O=L.framebuffers[N.cacheKey];m.bindFramebuffer(A.READ_FRAMEBUFFER,D),m.bindFramebuffer(A.DRAW_FRAMEBUFFER,O);var U=A.COLOR_BUFFER_BIT;e.isDepthTexture&&(U=A.DEPTH_BUFFER_BIT),A.blitFramebuffer(a,o,n,r,u,l,n,r,U,A.NEAREST),m.bindFramebuffer(A.READ_FRAMEBUFFER,null),m.bindFramebuffer(A.DRAW_FRAMEBUFFER,null)}else R?e.isDataTexture||e.isData3DTexture?A.texSubImage3D(_,p,u,l,c,n,r,i,x,b,w.data):t.isCompressedArrayTexture?A.compressedTexSubImage3D(_,p,u,l,c,n,r,i,x,w.data):A.texSubImage3D(_,p,u,l,c,n,r,i,x,b,w):e.isDataTexture?A.texSubImage2D(_,p,u,l,n,r,x,b,w.data):e.isCompressedTexture?A.compressedTexSubImage2D(_,p,u,l,w.width,w.height,x,w.data):A.texSubImage2D(_,p,u,l,n,r,x,b,w);A.pixelStorei(A.UNPACK_ROW_LENGTH,S),A.pixelStorei(A.UNPACK_IMAGE_HEIGHT,E),A.pixelStorei(A.UNPACK_SKIP_PIXELS,k),A.pixelStorei(A.UNPACK_SKIP_ROWS,M),A.pixelStorei(A.UNPACK_SKIP_IMAGES,C),0===p&&t.generateMipmaps&&A.generateMipmap(_),m.unbindTexture()}},{key:"copyFramebufferToTexture",value:function(e,t,n){var r=this.gl,i=this.backend.state,a=this.backend.get(e).textureGPU,o=n.x,s=n.y,u=n.z,l=n.w,c=!0===e.isDepthTexture||t.renderTarget&&t.renderTarget.samples>0,h=t.renderTarget?t.renderTarget.height:this.backend.getDrawingBufferSize().y;if(c){var f,d,p=0!==o||0!==s;if(!0===e.isDepthTexture?(f=r.DEPTH_BUFFER_BIT,d=r.DEPTH_ATTACHMENT,t.stencil&&(f|=r.STENCIL_BUFFER_BIT)):(f=r.COLOR_BUFFER_BIT,d=r.COLOR_ATTACHMENT0),p){var A=this.backend.get(t.renderTarget),v=A.framebuffers[t.getCacheKey()],m=A.msaaFrameBuffer;i.bindFramebuffer(r.DRAW_FRAMEBUFFER,v),i.bindFramebuffer(r.READ_FRAMEBUFFER,m);var g=h-s-l;r.blitFramebuffer(o,g,o+u,g+l,o,g,o+u,g+l,f,r.NEAREST),i.bindFramebuffer(r.READ_FRAMEBUFFER,v),i.bindTexture(r.TEXTURE_2D,a),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,o,g,u,l),i.unbindTexture()}else{var y=r.createFramebuffer();i.bindFramebuffer(r.DRAW_FRAMEBUFFER,y),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,d,r.TEXTURE_2D,a,0),r.blitFramebuffer(0,0,u,l,0,0,u,l,f,r.NEAREST),r.deleteFramebuffer(y)}}else i.bindTexture(r.TEXTURE_2D,a),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,o,h-l-s,u,l),i.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(t)}},{key:"setupRenderBufferStorage",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.gl,a=t.renderTarget,o=a.depthTexture,s=a.depthBuffer,u=a.stencilBuffer,l=a.width,c=a.height;if(i.bindRenderbuffer(i.RENDERBUFFER,e),s&&!u){var h=i.DEPTH_COMPONENT24;if(!0===r){var f=this.extensions.get("WEBGL_multisampled_render_to_texture");f.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,a.samples,h,l,c)}else n>0?(o&&o.isDepthTexture&&o.type===i.FLOAT&&(h=i.DEPTH_COMPONENT32F),i.renderbufferStorageMultisample(i.RENDERBUFFER,n,h,l,c)):i.renderbufferStorage(i.RENDERBUFFER,h,l,c);i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,e)}else s&&u&&(n>0?i.renderbufferStorageMultisample(i.RENDERBUFFER,n,i.DEPTH24_STENCIL8,l,c):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,l,c),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,e))}},{key:"copyTextureToBuffer",value:function(){var e=lt(ft().mark((function e(t,n,r,i,a,o){var s,u,l,c,h,f,d,p,A,v,m,g,y;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.backend,u=this.gl,l=this.backend.get(t),c=l.textureGPU,h=l.glFormat,f=l.glType,d=u.createFramebuffer(),u.bindFramebuffer(u.READ_FRAMEBUFFER,d),p=t.isCubeTexture?u.TEXTURE_CUBE_MAP_POSITIVE_X+o:u.TEXTURE_2D,u.framebufferTexture2D(u.READ_FRAMEBUFFER,u.COLOR_ATTACHMENT0,p,c,0),A=this._getTypedArrayType(f),v=this._getBytesPerTexel(f,h),m=i*a*v,g=u.createBuffer(),u.bindBuffer(u.PIXEL_PACK_BUFFER,g),u.bufferData(u.PIXEL_PACK_BUFFER,m,u.STREAM_READ),u.readPixels(n,r,i,a,h,f,0),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),e.next=17,s.utils._clientWaitAsync();case 17:return y=new A(m/A.BYTES_PER_ELEMENT),u.bindBuffer(u.PIXEL_PACK_BUFFER,g),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,y),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),u.deleteFramebuffer(d),e.abrupt("return",y);case 23:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i,a,o){return e.apply(this,arguments)}}()},{key:"_getTypedArrayType",value:function(e){var t=this.gl;if(e===t.UNSIGNED_BYTE)return Uint8Array;if(e===t.UNSIGNED_SHORT_4_4_4_4)return Uint16Array;if(e===t.UNSIGNED_SHORT_5_5_5_1)return Uint16Array;if(e===t.UNSIGNED_SHORT_5_6_5)return Uint16Array;if(e===t.UNSIGNED_SHORT)return Uint16Array;if(e===t.UNSIGNED_INT)return Uint32Array;if(e===t.HALF_FLOAT)return Uint16Array;if(e===t.FLOAT)return Float32Array;throw new Error("Unsupported WebGL type: ".concat(e))}},{key:"_getBytesPerTexel",value:function(e,t){var n=this.gl,r=0;return e===n.UNSIGNED_BYTE&&(r=1),e!==n.UNSIGNED_SHORT_4_4_4_4&&e!==n.UNSIGNED_SHORT_5_5_5_1&&e!==n.UNSIGNED_SHORT_5_6_5&&e!==n.UNSIGNED_SHORT&&e!==n.HALF_FLOAT||(r=2),e!==n.UNSIGNED_INT&&e!==n.FLOAT||(r=4),t===n.RGBA?4*r:t===n.RGB?3*r:t===n.ALPHA?r:void 0}}]),e}(),Iz=function(){function e(t){c(this,e),this.backend=t,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}return p(e,[{key:"get",value:function(e){var t=this.extensions[e];return void 0===t&&(t=this.gl.getExtension(e),this.extensions[e]=t),t}},{key:"has",value:function(e){return this.availableExtensions.includes(e)}}]),e}(),Lz=function(){function e(t){c(this,e),this.backend=t,this.maxAnisotropy=null}return p(e,[{key:"getMaxAnisotropy",value:function(){if(null!==this.maxAnisotropy)return this.maxAnisotropy;var e=this.backend.gl,t=this.backend.extensions;if(!0===t.has("EXT_texture_filter_anisotropic")){var n=t.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}]),e}(),Dz={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query"},Oz=function(){function e(t){c(this,e),this.gl=t.gl,this.extensions=t.extensions,this.info=t.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}return p(e,[{key:"render",value:function(e,t){var n=this.gl,r=this.mode,i=this.object,a=this.type,o=this.info;0!==this.index?n.drawElements(r,t,a,e):n.drawArrays(r,e,t),o.update(i,t,1)}},{key:"renderInstances",value:function(e,t,n){var r=this.gl,i=this.mode,a=this.type,o=this.index,s=this.object,u=this.info;0!==n&&(0!==o?r.drawElementsInstanced(i,t,a,e,n):r.drawArraysInstanced(i,e,t,n),u.update(s,t,n))}},{key:"renderMultiDraw",value:function(e,t,n){var r=this.extensions,i=this.mode,a=this.object,o=this.info;if(0!==n){var s=r.get("WEBGL_multi_draw");if(null===s)for(var u=0;u<n;u++)this.render(e[u],t[u]);else{0!==this.index?s.multiDrawElementsWEBGL(i,t,0,this.type,e,0,n):s.multiDrawArraysWEBGL(i,e,0,t,0,n);for(var l=0,c=0;c<n;c++)l+=t[c];o.update(a,l,1)}}}},{key:"renderMultiDrawInstances",value:function(e,t,n,r){var i=this.extensions,a=this.mode,o=this.object,s=this.info;if(0!==n){var u=i.get("WEBGL_multi_draw");if(null===u)for(var l=0;l<n;l++)this.renderInstances(e[l],t[l],r[l]);else{0!==this.index?u.multiDrawElementsInstancedWEBGL(a,t,0,this.type,e,0,r,0,n):u.multiDrawArraysInstancedWEBGL(a,e,0,t,0,r,0,n);for(var c=0,h=0;h<n;h++)c+=t[h]*r[h];s.update(o,c,1)}}}}]),e}(),Uz=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256;c(this,e),this.trackTimestamp=!0,this.maxQueries=t,this.currentQueryIndex=0,this.queryOffsets=new Map,this.isDisposed=!1,this.lastValue=0,this.pendingResolve=!1}return p(e,[{key:"allocateQueriesForContext",value:function(){}},{key:"resolveQueriesAsync",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){}}]),e}(),Bz=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2048;if(c(this,n),(i=t.call(this,a)).gl=e,i.type=r,i.ext=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query"),!i.ext)return console.warn("EXT_disjoint_timer_query not supported; timestamps will be disabled."),i.trackTimestamp=!1,_(i);i.queries=[];for(var o=0;o<i.maxQueries;o++)i.queries.push(e.createQuery());return i.activeQuery=null,i.queryStates=new Map,i}return p(n,[{key:"allocateQueriesForContext",value:function(e){if(!this.trackTimestamp)return null;if(this.currentQueryIndex+2>this.maxQueries)return kr("WebGPUTimestampQueryPool [".concat(this.type,"]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.").concat(this.type.toUpperCase()," ).")),null;var t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryStates.set(t,"inactive"),this.queryOffsets.set(e.id,t),t}},{key:"beginQuery",value:function(e){if(this.trackTimestamp&&!this.isDisposed){var t=this.queryOffsets.get(e.id);if(null!=t&&null===this.activeQuery){var n=this.queries[t];if(n)try{"inactive"===this.queryStates.get(t)&&(this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,n),this.activeQuery=t,this.queryStates.set(t,"started"))}catch(r){console.error("Error in beginQuery:",r),this.activeQuery=null,this.queryStates.set(t,"inactive")}}}}},{key:"endQuery",value:function(e){if(this.trackTimestamp&&!this.isDisposed){var t=this.queryOffsets.get(e.id);if(null!=t&&this.activeQuery===t)try{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.queryStates.set(t,"ended"),this.activeQuery=null}catch(n){console.error("Error in endQuery:",n),this.queryStates.set(t,"inactive"),this.activeQuery=null}}}},{key:"resolveQueriesAsync",value:function(){var e=lt(ft().mark((function e(){var t,n,r,i,a,o,s,u;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.trackTimestamp&&!this.pendingResolve){e.next=2;break}return e.abrupt("return",this.lastValue);case 2:this.pendingResolve=!0,e.prev=3,t=[],n=k(this.queryStates);try{for(n.s();!(r=n.n()).done;)i=T(r.value,2),a=i[0],"ended"===i[1]&&(o=this.queries[a],t.push(this.resolveQuery(o)))}catch(l){n.e(l)}finally{n.f()}if(0!==t.length){e.next=9;break}return e.abrupt("return",this.lastValue);case 9:return e.next=11,Promise.all(t);case 11:return s=e.sent,u=s.reduce((function(e,t){return e+t}),0),this.lastValue=u,this.currentQueryIndex=0,this.queryOffsets.clear(),this.queryStates.clear(),this.activeQuery=null,e.abrupt("return",u);case 21:return e.prev=21,e.t0=e.catch(3),console.error("Error resolving queries:",e.t0),e.abrupt("return",this.lastValue);case 25:return e.prev=25,this.pendingResolve=!1,e.finish(25);case 28:case"end":return e.stop()}}),e,this,[[3,21,25,28]])})));return function(){return e.apply(this,arguments)}}()},{key:"resolveQuery",value:function(){var e=lt(ft().mark((function e(t){var n=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){if(n.isDisposed)e(n.lastValue);else{var r,i=!1,a=function(t){i||(i=!0,r&&(clearTimeout(r),r=null),e(t))};!function i(){if(n.isDisposed)a(n.lastValue);else try{if(n.gl.getParameter(n.ext.GPU_DISJOINT_EXT))return void a(n.lastValue);if(!n.gl.getQueryParameter(t,n.gl.QUERY_RESULT_AVAILABLE))return void(r=setTimeout(i,1));var o=n.gl.getQueryParameter(t,n.gl.QUERY_RESULT);e(Number(o)/1e6)}catch(s){console.error("Error checking query:",s),e(n.lastValue)}}()}})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){if(!this.isDisposed&&(this.isDisposed=!0,this.trackTimestamp)){var e,t=k(this.queries);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.gl.deleteQuery(n)}}catch(r){t.e(r)}finally{t.f()}this.queries=[],this.queryStates.clear(),this.queryOffsets.clear(),this.lastValue=0,this.activeQuery=null}}}]),n}(Uz),Fz=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c(this,n),(e=t.call(this,r)).isWebGLBackend=!0,e.attributeUtils=null,e.extensions=null,e.capabilities=null,e.textureUtils=null,e.bufferRenderer=null,e.gl=null,e.state=null,e.utils=null,e.vaoCache={},e.transformFeedbackCache={},e.discard=!1,e.disjoint=null,e.parallel=null,e._currentContext=null,e._knownBindings=new WeakSet,e._supportsInvalidateFramebuffer="undefined"!==typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),e._xrFramebuffer=null,e}return p(n,[{key:"init",value:function(e){ht(m(n.prototype),"init",this).call(this,e);var t=this.parameters,r={antialias:e.samples>0,alpha:!0,depth:e.depth,stencil:e.stencil},i=void 0!==t.context?t.context:e.domElement.getContext("webgl2",r);function a(t){t.preventDefault();var n={api:"WebGL",message:t.statusMessage||"Unknown reason",reason:null,originalEvent:t};e.onDeviceLost(n)}this._onContextLost=a,e.domElement.addEventListener("webglcontextlost",a,!1),this.gl=i,this.extensions=new Iz(this),this.capabilities=new Lz(this),this.attributeUtils=new Mz(this),this.textureUtils=new Nz(this),this.bufferRenderer=new Oz(this),this.state=new Cz(this),this.utils=new Rz(this),this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile")}},{key:"coordinateSystem",get:function(){return or}},{key:"getArrayBufferAsync",value:function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.attributeUtils.getArrayBufferAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"waitForGPU",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.utils._clientWaitAsync();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"makeXRCompatible",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===this.gl.getContextAttributes().xrCompatible){e.next=4;break}return e.next=4,this.gl.makeXRCompatible();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setXRTarget",value:function(e){this._xrFramebuffer=e}},{key:"setXRRenderTargetTextures",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.gl;if(this.set(e.texture,{textureGPU:t,glInternalFormat:r.RGBA8}),null!==n){var i=e.stencilBuffer?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24;this.set(e.depthTexture,{textureGPU:n,glInternalFormat:i}),!0===this.extensions.has("WEBGL_multisampled_render_to_texture")&&e.autoAllocateDepthBuffer&&console.warn("THREE.WebGLBackend: Render-to-texture extension was disabled because an external texture was provided"),e.autoAllocateDepthBuffer=!1}}},{key:"initTimestampQuery",value:function(e){if(this.disjoint&&this.trackTimestamp){var t=e.isComputeNode?"compute":"render";this.timestampQueryPool[t]||(this.timestampQueryPool[t]=new Bz(this.gl,t,2048));var n=this.timestampQueryPool[t];null!==n.allocateQueriesForContext(e)&&n.beginQuery(e)}}},{key:"prepareTimestampBuffer",value:function(e){if(this.disjoint&&this.trackTimestamp){var t=e.isComputeNode?"compute":"render";this.timestampQueryPool[t].endQuery(e)}}},{key:"getContext",value:function(){return this.gl}},{key:"beginRender",value:function(e){var t=this.state,n=this.gl,r=this.get(e);if(e.viewport?this.updateViewport(e):t.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),e.scissor){var i=e.scissorValue,a=i.x,o=i.y,s=i.width,u=i.height;t.scissor(a,e.height-u-o,s,u)}this.initTimestampQuery(e),r.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1);var l=e.occlusionQueryCount;l>0&&(r.currentOcclusionQueries=r.occlusionQueries,r.currentOcclusionQueryObjects=r.occlusionQueryObjects,r.lastOcclusionObject=null,r.occlusionQueries=new Array(l),r.occlusionQueryObjects=new Array(l),r.occlusionQueryIndex=0)}},{key:"finishRender",value:function(e){var t=this.gl,n=this.state,r=this.get(e),i=r.previousContext;n.resetVertexState();var a=e.occlusionQueryCount;a>0&&(a>r.occlusionQueryIndex&&t.endQuery(t.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));var o=e.textures;if(null!==o)for(var s=0;s<o.length;s++){var u=o[s];u.generateMipmaps&&this.generateMipmaps(u)}if(this._currentContext=i,null!==e.textures&&e.renderTarget){var l=this.get(e.renderTarget);if(e.renderTarget.samples>0&&!1===this._useMultisampledRTT(e.renderTarget)){var c=l.framebuffers[e.getCacheKey()],h=t.COLOR_BUFFER_BIT,f=l.msaaFrameBuffer,d=e.textures;n.bindFramebuffer(t.READ_FRAMEBUFFER,f),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,c);for(var p=0;p<d.length;p++)if(e.scissor){var A=e.scissorValue,v=A.x,m=A.y,g=A.width,y=A.height,_=e.height-y-m;t.blitFramebuffer(v,_,v+g,_+y,v,_,v+g,_+y,h,t.NEAREST),!0===this._supportsInvalidateFramebuffer&&t.invalidateSubFramebuffer(t.READ_FRAMEBUFFER,l.invalidationArray,v,_,g,y)}else t.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,h,t.NEAREST),!0===this._supportsInvalidateFramebuffer&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,l.invalidationArray)}}null!==i&&(this._setFramebuffer(i),i.viewport?this.updateViewport(i):n.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight)),this.prepareTimestampBuffer(e)}},{key:"resolveOccludedAsync",value:function(e){var t=this.get(e),n=t.currentOcclusionQueries,r=t.currentOcclusionQueryObjects;if(n&&r){var i=new WeakSet,a=this.gl;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueries=null;!function e(){for(var o=0,s=0;s<n.length;s++){var u=n[s];null!==u&&(a.getQueryParameter(u,a.QUERY_RESULT_AVAILABLE)&&(0===a.getQueryParameter(u,a.QUERY_RESULT)&&i.add(r[s]),n[s]=null,a.deleteQuery(u),o++))}o<n.length?requestAnimationFrame(e):t.occluded=i}()}}},{key:"isOccluded",value:function(e,t){var n=this.get(e);return n.occluded&&n.occluded.has(t)}},{key:"updateViewport",value:function(e){var t=this.state,n=e.viewportValue,r=n.x,i=n.y,a=n.width,o=n.height;t.viewport(r,e.height-o-i,a,o)}},{key:"setScissorTest",value:function(e){this.state.setScissorTest(e)}},{key:"getClearColor",value:function(){var e=ht(m(n.prototype),"getClearColor",this).call(this);return e.r*=e.a,e.g*=e.a,e.b*=e.a,e}},{key:"clear",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=this.gl,o=this.renderer;if(null===r){var s=this.getClearColor();r={textures:null,clearColorValue:s}}var u=0;if(e&&(u|=a.COLOR_BUFFER_BIT),t&&(u|=a.DEPTH_BUFFER_BIT),n&&(u|=a.STENCIL_BUFFER_BIT),0!==u){var l;l=r.clearColorValue?r.clearColorValue:this.getClearColor();var c=o.getClearDepth(),h=o.getClearStencil();if(t&&this.state.setDepthMask(!0),null===r.textures)a.clearColor(l.r,l.g,l.b,l.a),a.clear(u);else{if(i&&this._setFramebuffer(r),e)for(var f=0;f<r.textures.length;f++)0===f?a.clearBufferfv(a.COLOR,f,[l.r,l.g,l.b,l.a]):a.clearBufferfv(a.COLOR,f,[0,0,0,1]);t&&n?a.clearBufferfi(a.DEPTH_STENCIL,0,c,h):t?a.clearBufferfv(a.DEPTH,0,[c]):n&&a.clearBufferiv(a.STENCIL,0,[h])}}}},{key:"beginCompute",value:function(e){var t=this.state,n=this.gl;t.bindFramebuffer(n.FRAMEBUFFER,null),this.initTimestampQuery(e)}},{key:"compute",value:function(e,t,n,r){var i=this.state,a=this.gl;!1===this.discard&&(a.enable(a.RASTERIZER_DISCARD),this.discard=!0);var o=this.get(r),s=o.programGPU,u=o.transformBuffers,l=o.attributes,c=this._getVaoKey(l),h=this.vaoCache[c];void 0===h?this._createVao(l):i.setVertexState(h),i.useProgram(s),this._bindUniforms(n);var f=this._getTransformFeedback(u);a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,f),a.beginTransformFeedback(a.POINTS),l[0].isStorageInstancedBufferAttribute?a.drawArraysInstanced(a.POINTS,0,1,t.count):a.drawArrays(a.POINTS,0,t.count),a.endTransformFeedback(),a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,null);for(var d=0;d<u.length;d++){var p=u[d];p.pbo&&this.textureUtils.copyBufferToTexture(p.transformBuffer,p.pbo),p.switchBuffers()}}},{key:"finishCompute",value:function(e){var t=this.gl;this.discard=!1,t.disable(t.RASTERIZER_DISCARD),this.prepareTimestampBuffer(e),this._currentContext&&this._setFramebuffer(this._currentContext)}},{key:"draw",value:function(e){var t=this,n=e.object,r=e.pipeline,i=e.material,a=e.context,o=e.hardwareClippingPlanes,s=this.get(r).programGPU,u=this.gl,l=this.state,c=this.get(a),h=e.getDrawParameters();if(null!==h){this._bindUniforms(e.getBindings());var f=n.isMesh&&n.matrixWorld.determinant()<0;l.setMaterial(i,f,o),l.useProgram(s);var d=this.get(e),p=d.staticVao;if(void 0===p||d.geometryId!==e.geometry.id){var A=this._getVaoKey(e.getAttributes());if(void 0===(p=this.vaoCache[A])){var v=this._createVao(e.getAttributes());p=v.vaoGPU,v.staticVao&&(d.staticVao=p,d.geometryId=e.geometry.id)}}var m=e.getIndex(),g=null!==m?this.get(m).bufferGPU:null;l.setVertexState(p,g);var y=c.lastOcclusionObject;if(y!==n&&void 0!==y){if(null!==y&&!0===y.occlusionTest&&(u.endQuery(u.ANY_SAMPLES_PASSED),c.occlusionQueryIndex++),!0===n.occlusionTest){var _=u.createQuery();u.beginQuery(u.ANY_SAMPLES_PASSED,_),c.occlusionQueries[c.occlusionQueryIndex]=_,c.occlusionQueryObjects[c.occlusionQueryIndex]=n}c.lastOcclusionObject=n}var b=this.bufferRenderer;n.isPoints?b.mode=u.POINTS:n.isLineSegments?b.mode=u.LINES:n.isLine?b.mode=u.LINE_STRIP:n.isLineLoop?b.mode=u.LINE_LOOP:!0===i.wireframe?(l.setLineWidth(i.wireframeLinewidth*this.renderer.getPixelRatio()),b.mode=u.LINES):b.mode=u.TRIANGLES;var x=h.vertexCount,w=h.instanceCount,T=h.firstVertex;if(b.object=n,null!==m){T*=m.array.BYTES_PER_ELEMENT;var S=this.get(m);b.index=m.count,b.type=S.type}else b.index=0;var E=function(){n.isBatchedMesh?null!==n._multiDrawInstances?(kr("THREE.WebGLBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),b.renderMultiDrawInstances(n._multiDrawStarts,n._multiDrawCounts,n._multiDrawCount,n._multiDrawInstances)):t.hasFeature("WEBGL_multi_draw")?b.renderMultiDraw(n._multiDrawStarts,n._multiDrawCounts,n._multiDrawCount):kr("THREE.WebGLRenderer: WEBGL_multi_draw not supported."):w>1?b.renderInstances(T,x,w):b.render(T,x)};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){var k=this.get(e.camera),M=e.camera.cameras,C=e.getBindingGroup("cameraIndex").bindings[0];if(void 0===k.indexesGPU||k.indexesGPU.length!==M.length){for(var R=new Uint32Array([0,0,0,0]),P=[],N=0,I=M.length;N<I;N++){var L=u.createBuffer();R[0]=N,u.bindBuffer(u.UNIFORM_BUFFER,L),u.bufferData(u.UNIFORM_BUFFER,R,u.STATIC_DRAW),P.push(L)}k.indexesGPU=P}for(var D=this.get(C),O=this.renderer.getPixelRatio(),U=0,B=M.length;U<B;U++){var F=M[U];if(n.layers.test(F.layers)){var z=F.viewport,V=z.x*O,q=z.y*O,j=z.width*O,G=z.height*O;l.viewport(Math.floor(V),Math.floor(e.context.height-G-q),Math.floor(j),Math.floor(G)),l.bindBufferBase(u.UNIFORM_BUFFER,D.index,k.indexesGPU[U]),E()}}}else E()}}},{key:"needsRenderUpdate",value:function(){return!1}},{key:"getRenderCacheKey",value:function(){return""}},{key:"createDefaultTexture",value:function(e){this.textureUtils.createDefaultTexture(e)}},{key:"createTexture",value:function(e,t){this.textureUtils.createTexture(e,t)}},{key:"updateTexture",value:function(e,t){this.textureUtils.updateTexture(e,t)}},{key:"generateMipmaps",value:function(e){this.textureUtils.generateMipmaps(e)}},{key:"destroyTexture",value:function(e){this.textureUtils.destroyTexture(e)}},{key:"copyTextureToBuffer",value:function(){var e=lt(ft().mark((function e(t,n,r,i,a,o){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.textureUtils.copyTextureToBuffer(t,n,r,i,a,o));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i,a,o){return e.apply(this,arguments)}}()},{key:"createSampler",value:function(){}},{key:"destroySampler",value:function(){}},{key:"createNodeBuilder",value:function(e,t){return new xz(e,t)}},{key:"createProgram",value:function(e){var t=this.gl,n=e.stage,r=e.code,i="fragment"===n?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);t.shaderSource(i,r),t.compileShader(i),this.set(e,{shaderGPU:i})}},{key:"destroyProgram",value:function(e){this.delete(e)}},{key:"createRenderPipeline",value:function(e,t){var n=this,r=this.gl,i=e.pipeline,a=i.fragmentProgram,o=i.vertexProgram,s=r.createProgram(),u=this.get(a).shaderGPU,l=this.get(o).shaderGPU;if(r.attachShader(s,u),r.attachShader(s,l),r.linkProgram(s),this.set(i,{programGPU:s,fragmentShader:u,vertexShader:l}),null!==t&&this.parallel){var c=new Promise((function(t){var a=n.parallel;!function o(){r.getProgramParameter(s,a.COMPLETION_STATUS_KHR)?(n._completeCompile(e,i),t()):requestAnimationFrame(o)}()}));t.push(c)}else this._completeCompile(e,i)}},{key:"_handleSource",value:function(e,t){for(var n=e.split("\n"),r=[],i=Math.max(t-6,0),a=Math.min(t+6,n.length),o=i;o<a;o++){var s=o+1;r.push("".concat(s===t?">":" "," ").concat(s,": ").concat(n[o]))}return r.join("\n")}},{key:"_getShaderErrors",value:function(e,t,n){var r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(r&&""===i)return"";var a=/ERROR: 0:(\d+)/.exec(i);if(a){var o=parseInt(a[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+this._handleSource(e.getShaderSource(t),o)}return i}},{key:"_logProgramError",value:function(e,t,n){if(this.renderer.debug.checkShaderErrors){var r=this.gl,i=r.getProgramInfoLog(e).trim();if(!1===r.getProgramParameter(e,r.LINK_STATUS))if("function"===typeof this.renderer.debug.onShaderError)this.renderer.debug.onShaderError(r,e,n,t);else{var a=this._getShaderErrors(r,n,"vertex"),o=this._getShaderErrors(r,t,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(e,r.VALIDATE_STATUS)+"\n\nProgram Info Log: "+i+"\n"+a+"\n"+o)}else""!==i&&console.warn("THREE.WebGLProgram: Program Info Log:",i)}}},{key:"_completeCompile",value:function(e,t){var n=this.state,r=this.gl,i=this.get(t),a=i.programGPU,o=i.fragmentShader,s=i.vertexShader;!1===r.getProgramParameter(a,r.LINK_STATUS)&&this._logProgramError(a,o,s),n.useProgram(a);var u=e.getBindings();this._setupBindings(u,a),this.set(t,{programGPU:a})}},{key:"createComputePipeline",value:function(e,t){var n=this.state,r=this.gl,i={stage:"fragment",code:"#version 300 es\nprecision highp float;\nvoid main() {}"};this.createProgram(i);for(var a=e.computeProgram,o=r.createProgram(),s=this.get(i).shaderGPU,u=this.get(a).shaderGPU,l=a.transforms,c=[],h=[],f=0;f<l.length;f++){var d=l[f];c.push(d.varyingName),h.push(d.attributeNode)}r.attachShader(o,s),r.attachShader(o,u),r.transformFeedbackVaryings(o,c,r.SEPARATE_ATTRIBS),r.linkProgram(o),!1===r.getProgramParameter(o,r.LINK_STATUS)&&this._logProgramError(o,s,u),n.useProgram(o),this._setupBindings(t,o);for(var p=a.attributes,A=[],v=[],m=0;m<p.length;m++){var g=p[m].node.attribute;A.push(g),this.has(g)||this.attributeUtils.createAttribute(g,r.ARRAY_BUFFER)}for(var y=0;y<h.length;y++){var _=h[y].attribute;this.has(_)||this.attributeUtils.createAttribute(_,r.ARRAY_BUFFER);var b=this.get(_);v.push(b)}this.set(e,{programGPU:o,transformBuffers:v,attributes:A})}},{key:"createBindings",value:function(e,t){if(!1===this._knownBindings.has(t)){this._knownBindings.add(t);var n,r=0,i=0,a=k(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;this.set(o,{textures:i,uniformBuffers:r});var s,u=k(o.bindings);try{for(u.s();!(s=u.n()).done;){var l=s.value;l.isUniformBuffer&&r++,l.isSampledTexture&&i++}}catch(c){u.e(c)}finally{u.f()}}}catch(c){a.e(c)}finally{a.f()}}this.updateBindings(e,t)}},{key:"updateBindings",value:function(e){var t,n=this.gl,r=this.get(e),i=r.uniformBuffers,a=r.textures,o=k(e.bindings);try{for(o.s();!(t=o.n()).done;){var s=t.value;if(s.isUniformsGroup||s.isUniformBuffer){var u=s.buffer,l=n.createBuffer();n.bindBuffer(n.UNIFORM_BUFFER,l),n.bufferData(n.UNIFORM_BUFFER,u,n.DYNAMIC_DRAW),this.set(s,{index:i++,bufferGPU:l})}else if(s.isSampledTexture){var c=this.get(s.texture),h=c.textureGPU,f=c.glTextureType;this.set(s,{index:a++,textureGPU:h,glTextureType:f})}}}catch(d){o.e(d)}finally{o.f()}}},{key:"updateBinding",value:function(e){var t=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){var n=this.get(e).bufferGPU,r=e.buffer;t.bindBuffer(t.UNIFORM_BUFFER,n),t.bufferData(t.UNIFORM_BUFFER,r,t.DYNAMIC_DRAW)}}},{key:"createIndexAttribute",value:function(e){var t=this.gl;this.attributeUtils.createAttribute(e,t.ELEMENT_ARRAY_BUFFER)}},{key:"createAttribute",value:function(e){if(!this.has(e)){var t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}}},{key:"createStorageAttribute",value:function(e){if(!this.has(e)){var t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}}},{key:"updateAttribute",value:function(e){this.attributeUtils.updateAttribute(e)}},{key:"destroyAttribute",value:function(e){this.attributeUtils.destroyAttribute(e)}},{key:"hasFeature",value:function(e){for(var t=Object.keys(Dz).filter((function(t){return Dz[t]===e})),n=this.extensions,r=0;r<t.length;r++)if(n.has(t[r]))return!0;return!1}},{key:"getMaxAnisotropy",value:function(){return this.capabilities.getMaxAnisotropy()}},{key:"copyTextureToTexture",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;this.textureUtils.copyTextureToTexture(e,t,n,r,i,a)}},{key:"copyFramebufferToTexture",value:function(e,t,n){this.textureUtils.copyFramebufferToTexture(e,t,n)}},{key:"_setFramebuffer",value:function(e){var t=this.gl,n=this.state,r=null;if(null!==e.textures){var i,a=e.renderTarget,o=this.get(a),s=a.samples,u=a.depthBuffer,l=a.stencilBuffer,c=!0===a.isWebGLCubeRenderTarget,h=!0===a.isRenderTarget3D,f=!0===a.isRenderTargetArray,d=!0===a.isXRRenderTarget,p=!0===d&&!0===a.hasExternalTextures,A=o.msaaFrameBuffer,v=o.depthRenderbuffer,m=this.extensions.get("WEBGL_multisampled_render_to_texture"),g=this._useMultisampledRTT(a),y=TI(e);if(c?(o.cubeFramebuffers||(o.cubeFramebuffers={}),i=o.cubeFramebuffers[y]):d&&!1===p?i=this._xrFramebuffer:(o.framebuffers||(o.framebuffers={}),i=o.framebuffers[y]),void 0===i){i=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,i);var _=e.textures;if(c){o.cubeFramebuffers[y]=i;var b=this.get(_[0]).textureGPU,x=this.renderer._activeCubeFace;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+x,b,0)}else{o.framebuffers[y]=i;for(var w=0;w<_.length;w++){var T=_[w],S=this.get(T);S.renderTarget=e.renderTarget,S.cacheKey=y;var E=t.COLOR_ATTACHMENT0+w;if(h||f){var k=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,E,S.textureGPU,0,k)}else p&&g?m.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,E,t.TEXTURE_2D,S.textureGPU,0,s):t.framebufferTexture2D(t.FRAMEBUFFER,E,t.TEXTURE_2D,S.textureGPU,0)}n.drawBuffers(e,i)}if(a.isXRRenderTarget&&!0===a.autoAllocateDepthBuffer){var M=t.createRenderbuffer();this.textureUtils.setupRenderBufferStorage(M,e,0,g),o.xrDepthRenderbuffer=M}else if(null!==e.depthTexture){var C=this.get(e.depthTexture),R=l?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;C.renderTarget=e.renderTarget,C.cacheKey=y,p&&g?m.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,R,t.TEXTURE_2D,C.textureGPU,0,s):t.framebufferTexture2D(t.FRAMEBUFFER,R,t.TEXTURE_2D,C.textureGPU,0)}}else if(d&&p){n.bindFramebuffer(t.FRAMEBUFFER,i);var P=this.get(e.textures[0]);g?m.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,P.textureGPU,0,s):t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,P.textureGPU,0);var N=l?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(!0===a.autoAllocateDepthBuffer){var I=o.xrDepthRenderbuffer;t.bindRenderbuffer(t.RENDERBUFFER,I),t.framebufferRenderbuffer(t.FRAMEBUFFER,N,t.RENDERBUFFER,I)}else{var L=this.get(e.depthTexture);g?m.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,N,t.TEXTURE_2D,L.textureGPU,0,s):t.framebufferTexture2D(t.FRAMEBUFFER,N,t.TEXTURE_2D,L.textureGPU,0)}}if(s>0&&!1===g){if(void 0===A){var D=[];A=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,A);for(var O=[],U=e.textures,B=0;B<U.length;B++){if(O[B]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,O[B]),D.push(t.COLOR_ATTACHMENT0+B),u){var F=l?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;D.push(F)}var z=e.textures[B],V=this.get(z);t.renderbufferStorageMultisample(t.RENDERBUFFER,s,V.glInternalFormat,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+B,t.RENDERBUFFER,O[B])}if(o.msaaFrameBuffer=A,o.msaaRenderbuffers=O,void 0===v){v=t.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(v,e,s),o.depthRenderbuffer=v;var q=l?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;D.push(q)}o.invalidationArray=D}r=o.msaaFrameBuffer}else r=i}n.bindFramebuffer(t.FRAMEBUFFER,r)}},{key:"_getVaoKey",value:function(e){for(var t="",n=0;n<e.length;n++){t+=":"+this.get(e[n]).id}return t}},{key:"_createVao",value:function(e){var t=this.gl,n=t.createVertexArray(),r="",i=!0;t.bindVertexArray(n);for(var a=0;a<e.length;a++){var o=e[a],s=this.get(o);r+=":"+s.id,t.bindBuffer(t.ARRAY_BUFFER,s.bufferGPU),t.enableVertexAttribArray(a),(o.isStorageBufferAttribute||o.isStorageInstancedBufferAttribute)&&(i=!1);var u=void 0,l=void 0;!0===o.isInterleavedBufferAttribute?(u=o.data.stride*s.bytesPerElement,l=o.offset*s.bytesPerElement):(u=0,l=0),s.isInteger?t.vertexAttribIPointer(a,o.itemSize,s.type,u,l):t.vertexAttribPointer(a,o.itemSize,s.type,o.normalized,u,l),o.isInstancedBufferAttribute&&!o.isInterleavedBufferAttribute?t.vertexAttribDivisor(a,o.meshPerAttribute):o.isInterleavedBufferAttribute&&o.data.isInstancedInterleavedBuffer&&t.vertexAttribDivisor(a,o.data.meshPerAttribute)}return t.bindBuffer(t.ARRAY_BUFFER,null),this.vaoCache[r]=n,{vaoGPU:n,staticVao:i}}},{key:"_getTransformFeedback",value:function(e){for(var t="",n=0;n<e.length;n++)t+=":"+e[n].id;var r=this.transformFeedbackCache[t];if(void 0!==r)return r;var i=this.gl;r=i.createTransformFeedback(),i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,r);for(var a=0;a<e.length;a++){var o=e[a];i.bindBufferBase(i.TRANSFORM_FEEDBACK_BUFFER,a,o.transformBuffer)}return i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[t]=r,r}},{key:"_setupBindings",value:function(e,t){var n,r=this.gl,i=k(e);try{for(i.s();!(n=i.n()).done;){var a,o=k(n.value.bindings);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=this.get(s).index;if(s.isUniformsGroup||s.isUniformBuffer){var l=r.getUniformBlockIndex(t,s.name);r.uniformBlockBinding(t,l,u)}else if(s.isSampledTexture){var c=r.getUniformLocation(t,s.name);r.uniform1i(c,u)}}}catch(h){o.e(h)}finally{o.f()}}}catch(h){i.e(h)}finally{i.f()}}},{key:"_bindUniforms",value:function(e){var t,n=this.gl,r=this.state,i=k(e);try{for(i.s();!(t=i.n()).done;){var a,o=k(t.value.bindings);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=this.get(s),l=u.index;s.isUniformsGroup||s.isUniformBuffer?r.bindBufferBase(n.UNIFORM_BUFFER,l,u.bufferGPU):s.isSampledTexture&&r.bindTexture(u.glTextureType,u.textureGPU,n.TEXTURE0+l)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){i.e(c)}finally{i.f()}}},{key:"_useMultisampledRTT",value:function(e){return e.samples>0&&!0===this.extensions.has("WEBGL_multisampled_render_to_texture")&&!1!==e.autoAllocateDepthBuffer}},{key:"dispose",value:function(){var e=this.extensions.get("WEBGL_lose_context");e&&e.loseContext(),this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}]),n}(Sz),zz="point-list",Vz="line-list",qz="line-strip",jz="triangle-list",Gz="triangle-strip",Hz="never",Wz="less",Xz="equal",Qz="less-equal",Yz="greater",Kz="not-equal",Zz="greater-equal",Jz="always",$z="store",eV="load",tV="clear",nV="ccw",rV="none",iV="front",aV="back",oV="uint16",sV="uint32",uV="r8unorm",lV="r8snorm",cV="r8uint",hV="r8sint",fV="r16uint",dV="r16sint",pV="r16float",AV="rg8unorm",vV="rg8snorm",mV="rg8uint",gV="rg8sint",yV="r32uint",_V="r32sint",bV="r32float",xV="rg16uint",wV="rg16sint",TV="rg16float",SV="rgba8unorm",EV="rgba8unorm-srgb",kV="rgba8snorm",MV="rgba8uint",CV="rgba8sint",RV="bgra8unorm",PV="bgra8unorm-srgb",NV="rgb9e5ufloat",IV="rgb10a2unorm",LV="rgb10a2unorm",DV="rg32uint",OV="rg32sint",UV="rg32float",BV="rgba16uint",FV="rgba16sint",zV="rgba16float",VV="rgba32uint",qV="rgba32sint",jV="rgba32float",GV="depth16unorm",HV="depth24plus",WV="depth24plus-stencil8",XV="depth32float",QV="depth32float-stencil8",YV="bc1-rgba-unorm",KV="bc1-rgba-unorm-srgb",ZV="bc2-rgba-unorm",JV="bc2-rgba-unorm-srgb",$V="bc3-rgba-unorm",eq="bc3-rgba-unorm-srgb",tq="bc4-r-unorm",nq="bc4-r-snorm",rq="bc5-rg-unorm",iq="bc5-rg-snorm",aq="bc6h-rgb-ufloat",oq="bc6h-rgb-float",sq="bc7-rgba-unorm",uq="bc7-rgba-srgb",lq="etc2-rgb8unorm",cq="etc2-rgb8unorm-srgb",hq="etc2-rgb8a1unorm",fq="etc2-rgb8a1unorm-srgb",dq="etc2-rgba8unorm",pq="etc2-rgba8unorm-srgb",Aq="eac-r11unorm",vq="eac-r11snorm",mq="eac-rg11unorm",gq="eac-rg11snorm",yq="astc-4x4-unorm",_q="astc-4x4-unorm-srgb",bq="astc-5x4-unorm",xq="astc-5x4-unorm-srgb",wq="astc-5x5-unorm",Tq="astc-5x5-unorm-srgb",Sq="astc-6x5-unorm",Eq="astc-6x5-unorm-srgb",kq="astc-6x6-unorm",Mq="astc-6x6-unorm-srgb",Cq="astc-8x5-unorm",Rq="astc-8x5-unorm-srgb",Pq="astc-8x6-unorm",Nq="astc-8x6-unorm-srgb",Iq="astc-8x8-unorm",Lq="astc-8x8-unorm-srgb",Dq="astc-10x5-unorm",Oq="astc-10x5-unorm-srgb",Uq="astc-10x6-unorm",Bq="astc-10x6-unorm-srgb",Fq="astc-10x8-unorm",zq="astc-10x8-unorm-srgb",Vq="astc-10x10-unorm",qq="astc-10x10-unorm-srgb",jq="astc-12x10-unorm",Gq="astc-12x10-unorm-srgb",Hq="astc-12x12-unorm",Wq="astc-12x12-unorm-srgb",Xq="clamp-to-edge",Qq="repeat",Yq="mirror-repeat",Kq="linear",Zq="nearest",Jq="zero",$q="one",ej="src",tj="one-minus-src",nj="src-alpha",rj="one-minus-src-alpha",ij="dst",aj="one-minus-dst",oj="dst-alpha",sj="one-minus-dst-alpha",uj="src-alpha-saturated",lj="constant",cj="one-minus-constant",hj="add",fj="subtract",dj="reverse-subtract",pj="min",Aj="max",vj=0,mj=15,gj="keep",yj="zero",_j="replace",bj="invert",xj="increment-clamp",wj="decrement-clamp",Tj="increment-wrap",Sj="decrement-wrap",Ej="storage",kj="read-only-storage",Mj="write-only",Cj="read-only",Rj="read-write",Pj="float",Nj="unfilterable-float",Ij="depth",Lj="sint",Dj="uint",Oj="2d",Uj="3d",Bj="2d",Fj="2d-array",zj="cube",Vj="3d",qj="all",jj="vertex",Gj="instance",Hj={DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups"},Wj=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,e)).texture=r,i.version=r?r.version:0,i.isSampler=!0,i}return p(n)}(ez),Xj=function(e){v(n,e);var t=b(n);function n(e,r,i){var a;return c(this,n),(a=t.call(this,e,r?r.value:null)).textureNode=r,a.groupNode=i,a}return p(n,[{key:"update",value:function(){this.texture=this.textureNode.value}}]),n}(Wj),Qj=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,e,r?r.array:null)).attribute=r,i.isStorageBuffer=!0,i}return p(n)}(tz),Yj=0,Kj=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,"StorageBuffer_"+Yj++,e?e.value:null)).nodeUniform=e,i.access=e?e.access:nb.READ_WRITE,i.groupNode=r,i}return p(n,[{key:"buffer",get:function(){return this.nodeUniform.value}}]),n}(Qj),Zj=function(e){v(n,e);var t=b(n);function n(e){var r;c(this,n),(r=t.call(this)).device=e;return r.mipmapSampler=e.createSampler({minFilter:Kq}),r.flipYSampler=e.createSampler({minFilter:Zq}),r.transferPipelines={},r.flipYPipelines={},r.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:"\nstruct VarysStruct {\n\t@builtin( position ) Position: vec4<f32>,\n\t@location( 0 ) vTex : vec2<f32>\n};\n\n@vertex\nfn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {\n\n\tvar Varys : VarysStruct;\n\n\tvar pos = array< vec2<f32>, 4 >(\n\t\tvec2<f32>( -1.0,  1.0 ),\n\t\tvec2<f32>(  1.0,  1.0 ),\n\t\tvec2<f32>( -1.0, -1.0 ),\n\t\tvec2<f32>(  1.0, -1.0 )\n\t);\n\n\tvar tex = array< vec2<f32>, 4 >(\n\t\tvec2<f32>( 0.0, 0.0 ),\n\t\tvec2<f32>( 1.0, 0.0 ),\n\t\tvec2<f32>( 0.0, 1.0 ),\n\t\tvec2<f32>( 1.0, 1.0 )\n\t);\n\n\tVarys.vTex = tex[ vertexIndex ];\n\tVarys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );\n\n\treturn Varys;\n\n}\n"}),r.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:"\n@group( 0 ) @binding( 0 )\nvar imgSampler : sampler;\n\n@group( 0 ) @binding( 1 )\nvar img : texture_2d<f32>;\n\n@fragment\nfn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {\n\n\treturn textureSample( img, imgSampler, vTex );\n\n}\n"}),r.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:"\n@group( 0 ) @binding( 0 )\nvar imgSampler : sampler;\n\n@group( 0 ) @binding( 1 )\nvar img : texture_2d<f32>;\n\n@fragment\nfn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {\n\n\treturn textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );\n\n}\n"}),r}return p(n,[{key:"getTransferPipeline",value:function(e){var t=this.transferPipelines[e];return void 0===t&&(t=this.device.createRenderPipeline({label:"mipmap-".concat(e),vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:Gz,stripIndexFormat:sV},layout:"auto"}),this.transferPipelines[e]=t),t}},{key:"getFlipYPipeline",value:function(e){var t=this.flipYPipelines[e];return void 0===t&&(t=this.device.createRenderPipeline({label:"flipY-".concat(e),vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:Gz,stripIndexFormat:sV},layout:"auto"}),this.flipYPipelines[e]=t),t}},{key:"flipY",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=t.format,a=t.size,o=a.width,s=a.height,u=this.getTransferPipeline(i),l=this.getFlipYPipeline(i),c=this.device.createTexture({size:{width:o,height:s,depthOrArrayLayers:1},format:i,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),h=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Bj,baseArrayLayer:r}),f=c.createView({baseMipLevel:0,mipLevelCount:1,dimension:Bj,baseArrayLayer:0}),d=this.device.createCommandEncoder({}),p=function(e,t,r){var i=e.getBindGroupLayout(0),a=n.device.createBindGroup({layout:i,entries:[{binding:0,resource:n.flipYSampler},{binding:1,resource:t}]}),o=d.beginRenderPass({colorAttachments:[{view:r,loadOp:tV,storeOp:$z,clearValue:[0,0,0,0]}]});o.setPipeline(e),o.setBindGroup(0,a),o.draw(4,1,0,0),o.end()};p(u,h,f),p(l,f,h),this.device.queue.submit([d.finish()]),c.destroy()}},{key:"generateMipmaps",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.get(e);void 0===r.useCount&&(r.useCount=0,r.layers=[]);var i=r.layers[n]||this._mipmapCreateBundles(e,t,n),a=this.device.createCommandEncoder({});this._mipmapRunBundles(a,i),this.device.queue.submit([a.finish()]),0!==r.useCount&&(r.layers[n]=i),r.useCount++}},{key:"_mipmapCreateBundles",value:function(e,t,n){for(var r=this.getTransferPipeline(t.format),i=r.getBindGroupLayout(0),a=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Bj,baseArrayLayer:n}),o=[],s=1;s<t.mipLevelCount;s++){var u=this.device.createBindGroup({layout:i,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:a}]}),l=e.createView({baseMipLevel:s,mipLevelCount:1,dimension:Bj,baseArrayLayer:n}),c={colorAttachments:[{view:l,loadOp:tV,storeOp:$z,clearValue:[0,0,0,0]}]},h=this.device.createRenderBundleEncoder({colorFormats:[t.format]});h.setPipeline(r),h.setBindGroup(0,u),h.draw(4,1,0,0),o.push({renderBundles:[h.finish()],passDescriptor:c}),a=l}return o}},{key:"_mipmapRunBundles",value:function(e,t){for(var n=t.length,r=0;r<n;r++){var i=t[r],a=e.beginRenderPass(i.passDescriptor);a.executeBundles(i.renderBundles),a.end()}}}]),n}(JN),Jj=(We(P_={},512,"never"),We(P_,tr,"less"),We(P_,514,"equal"),We(P_,nr,"less-equal"),We(P_,516,"greater"),We(P_,518,"greater-equal"),We(P_,519,"always"),We(P_,517,"not-equal"),P_),$j=[0,1,3,2,4,5],eG=function(){function e(t){c(this,e),this.backend=t,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new ns,this.depthTexture.name="depthBuffer"}return p(e,[{key:"createSampler",value:function(e){var t=this.backend,n=t.device,r=t.get(e),i={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};i.magFilter===Kq&&i.minFilter===Kq&&i.mipmapFilter===Kq&&(i.maxAnisotropy=e.anisotropy),e.isDepthTexture&&null!==e.compareFunction&&(i.compare=Jj[e.compareFunction]),r.sampler=n.createSampler(i)}},{key:"createDefaultTexture",value:function(e){var t,n=tG(e);e.isCubeTexture?t=this._getDefaultCubeTextureGPU(n):e.isVideoTexture?this.backend.get(e).externalTexture=this._getDefaultVideoFrame():t=this._getDefaultTextureGPU(n),this.backend.get(e).texture=t}},{key:"createTexture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.backend,r=n.get(e);if(r.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");void 0===t.needsMipmaps&&(t.needsMipmaps=!1),void 0===t.levels&&(t.levels=1),void 0===t.depth&&(t.depth=1);var i=t.width,a=t.height,o=t.depth,s=t.levels;e.isFramebufferTexture&&(t.renderTarget?t.format=this.backend.utils.getCurrentColorFormat(t.renderTarget):t.format=this.backend.utils.getPreferredCanvasFormat());var u=this._getDimension(e),l=e.internalFormat||t.format||tG(e,n.device);r.format=l;var c=n.utils.getTextureSampleData(e),h=c.samples,f=c.primarySamples,d=c.isMSAA,p=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;!0===e.isStorageTexture&&(p|=GPUTextureUsage.STORAGE_BINDING),!0!==e.isCompressedTexture&&!0!==e.isCompressedArrayTexture&&(p|=GPUTextureUsage.RENDER_ATTACHMENT);var A={label:e.name,size:{width:i,height:a,depthOrArrayLayers:o},mipLevelCount:s,sampleCount:f,dimension:u,format:l,usage:p};if(e.isVideoTexture){var v=e.source.data,m=new VideoFrame(v);A.size.width=m.displayWidth,A.size.height=m.displayHeight,m.close(),r.externalTexture=v}else{if(void 0===l)return console.warn("WebGPURenderer: Texture format not supported."),void this.createDefaultTexture(e);r.texture=n.device.createTexture(A)}if(d){var g=Object.assign({},A);g.label=g.label+"-msaa",g.sampleCount=h,r.msaaTexture=n.device.createTexture(g)}r.initialized=!0,r.textureDescriptorGPU=A}},{key:"destroyTexture",value:function(e){var t=this.backend,n=t.get(e);void 0!==n.texture&&n.texture.destroy(),void 0!==n.msaaTexture&&n.msaaTexture.destroy(),t.delete(e)}},{key:"destroySampler",value:function(e){delete this.backend.get(e).sampler}},{key:"generateMipmaps",value:function(e){var t=this.backend.get(e);if(e.isCubeTexture)for(var n=0;n<6;n++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,n);else for(var r=e.image.depth||1,i=0;i<r;i++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,i)}},{key:"getColorBuffer",value:function(){this.colorBuffer&&this.colorBuffer.destroy();var e=this.backend,t=e.getDrawingBufferSize(),n=t.width,r=t.height;return this.colorBuffer=e.device.createTexture({label:"colorBuffer",size:{width:n,height:r,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.samples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}},{key:"getDepthBuffer",value:function(){var e,t,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.backend,a=i.getDrawingBufferSize(),o=a.width,s=a.height,u=this.depthTexture,l=i.get(u).texture;if(r?(e=an,t=Kt):n&&(e=rn,t=Ht),void 0!==l){if(u.image.width===o&&u.image.height===s&&u.format===e&&u.type===t)return l;this.destroyTexture(u)}return u.name="depthBuffer",u.format=e,u.type=t,u.image.width=o,u.image.height=s,this.createTexture(u,{width:o,height:s}),i.get(u).texture}},{key:"updateTexture",value:function(e,t){var n=this.backend.get(e),r=n.textureDescriptorGPU;if(!e.isRenderTargetTexture&&void 0!==r){if(e.isDataTexture)this._copyBufferToTexture(t.image,n.texture,r,0,e.flipY);else if(e.isDataArrayTexture||e.isData3DTexture)for(var i=0;i<t.image.depth;i++)this._copyBufferToTexture(t.image,n.texture,r,i,e.flipY,i);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,n.texture,r);else if(e.isCubeTexture)this._copyCubeMapToTexture(t.images,n.texture,r,e.flipY);else if(e.isVideoTexture){var a=e.source.data;n.externalTexture=a}else this._copyImageToTexture(t.image,n.texture,r,0,e.flipY);n.version=e.version,e.onUpdate&&e.onUpdate(e)}}},{key:"copyTextureToBuffer",value:function(){var e=lt(ft().mark((function e(t,n,r,i,a,o){var s,u,l,c,h,f,d,p,A,v;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.backend.device,u=this.backend.get(t),l=u.texture,c=u.textureDescriptorGPU.format,h=this._getBytesPerTexel(c),f=i*h,f=256*Math.ceil(f/256),d=s.createBuffer({size:i*a*h,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),(p=s.createCommandEncoder()).copyTextureToBuffer({texture:l,origin:{x:n,y:r,z:o}},{buffer:d,bytesPerRow:f},{width:i,height:a}),A=this._getTypedArrayType(c),s.queue.submit([p.finish()]),e.next=14,d.mapAsync(GPUMapMode.READ);case 14:return v=d.getMappedRange(),e.abrupt("return",new A(v));case 16:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i,a,o){return e.apply(this,arguments)}}()},{key:"_isEnvironmentTexture",value:function(e){var t=e.mapping;return t===Mt||t===Ct||t===Et||t===kt}},{key:"_getDefaultTextureGPU",value:function(e){var t=this.defaultTexture[e];if(void 0===t){var n=new jr;n.minFilter=Lt,n.magFilter=Lt,this.createTexture(n,{width:1,height:1,format:e}),this.defaultTexture[e]=t=n}return this.backend.get(t).texture}},{key:"_getDefaultCubeTextureGPU",value:function(e){var t=this.defaultTexture[e];if(void 0===t){var n=new vo;n.minFilter=Lt,n.magFilter=Lt,this.createTexture(n,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=t=n}return this.backend.get(t).texture}},{key:"_getDefaultVideoFrame",value:function(){var e=this.defaultVideoFrame;if(null===e){this.defaultVideoFrame=e=new VideoFrame(new Uint8Array([0,0,0,255]),{timestamp:0,codedWidth:1,codedHeight:1,format:"RGBA"})}return e}},{key:"_copyCubeMapToTexture",value:function(e,t,n,r){for(var i=0;i<6;i++){var a=e[i],o=!0===r?$j[i]:i;a.isDataTexture?this._copyBufferToTexture(a.image,t,n,o,r):this._copyImageToTexture(a,t,n,o,r)}}},{key:"_copyImageToTexture",value:function(e,t,n,r,i){this.backend.device.queue.copyExternalImageToTexture({source:e,flipY:i},{texture:t,mipLevel:0,origin:{x:0,y:0,z:r}},{width:e.width,height:e.height,depthOrArrayLayers:1})}},{key:"_getPassUtils",value:function(){var e=this._passUtils;return null===e&&(this._passUtils=e=new Zj(this.backend.device)),e}},{key:"_generateMipmaps",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._getPassUtils().generateMipmaps(e,t,n)}},{key:"_flipY",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._getPassUtils().flipY(e,t,n)}},{key:"_copyBufferToTexture",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=this.backend.device,s=e.data,u=this._getBytesPerTexel(n.format),l=e.width*u;o.queue.writeTexture({texture:t,mipLevel:0,origin:{x:0,y:0,z:r}},s,{offset:e.width*e.height*u*a,bytesPerRow:l},{width:e.width,height:e.height,depthOrArrayLayers:1}),!0===i&&this._flipY(t,n,r)}},{key:"_copyCompressedBufferToTexture",value:function(e,t,n){for(var r=this.backend.device,i=this._getBlockData(n.format),a=n.size.depthOrArrayLayers>1,o=0;o<e.length;o++)for(var s=e[o],u=s.width,l=s.height,c=a?n.size.depthOrArrayLayers:1,h=Math.ceil(u/i.width)*i.byteLength,f=h*Math.ceil(l/i.height),d=0;d<c;d++)r.queue.writeTexture({texture:t,mipLevel:o,origin:{x:0,y:0,z:d}},s.data,{offset:d*f,bytesPerRow:h,rowsPerImage:Math.ceil(l/i.height)},{width:Math.ceil(u/i.width)*i.width,height:Math.ceil(l/i.height)*i.height,depthOrArrayLayers:1})}},{key:"_getBlockData",value:function(e){return e===YV||e===KV?{byteLength:8,width:4,height:4}:e===ZV||e===JV||e===$V||e===eq?{byteLength:16,width:4,height:4}:e===tq||e===nq?{byteLength:8,width:4,height:4}:e===rq||e===iq||e===aq||e===oq||e===sq||e===uq?{byteLength:16,width:4,height:4}:e===lq||e===cq||e===hq||e===fq?{byteLength:8,width:4,height:4}:e===dq||e===pq?{byteLength:16,width:4,height:4}:e===Aq||e===vq?{byteLength:8,width:4,height:4}:e===mq||e===gq||e===yq||e===_q?{byteLength:16,width:4,height:4}:e===bq||e===xq?{byteLength:16,width:5,height:4}:e===wq||e===Tq?{byteLength:16,width:5,height:5}:e===Sq||e===Eq?{byteLength:16,width:6,height:5}:e===kq||e===Mq?{byteLength:16,width:6,height:6}:e===Cq||e===Rq?{byteLength:16,width:8,height:5}:e===Pq||e===Nq?{byteLength:16,width:8,height:6}:e===Iq||e===Lq?{byteLength:16,width:8,height:8}:e===Dq||e===Oq?{byteLength:16,width:10,height:5}:e===Uq||e===Bq?{byteLength:16,width:10,height:6}:e===Fq||e===zq?{byteLength:16,width:10,height:8}:e===Vq||e===qq?{byteLength:16,width:10,height:10}:e===jq||e===Gq?{byteLength:16,width:12,height:10}:e===Hq||e===Wq?{byteLength:16,width:12,height:12}:void 0}},{key:"_convertAddressMode",value:function(e){var t=Xq;return e===Pt?t=Qq:e===It&&(t=Yq),t}},{key:"_convertFilterMode",value:function(e){var t=Kq;return e!==Lt&&e!==Dt&&e!==Ot||(t=Zq),t}},{key:"_getBytesPerTexel",value:function(e){return e===uV||e===lV||e===cV||e===hV?1:e===fV||e===dV||e===pV||e===AV||e===vV||e===mV||e===gV?2:e===yV||e===_V||e===bV||e===xV||e===wV||e===TV||e===SV||e===EV||e===kV||e===MV||e===CV||e===RV||e===PV||e===NV||e===IV||e===LV||e===XV||e===HV||e===WV||e===QV?4:e===DV||e===OV||e===UV||e===BV||e===FV||e===zV?8:e===VV||e===qV||e===jV?16:void 0}},{key:"_getTypedArrayType",value:function(e){return e===cV?Uint8Array:e===hV?Int8Array:e===uV?Uint8Array:e===lV?Int8Array:e===mV?Uint8Array:e===gV?Int8Array:e===AV?Uint8Array:e===vV?Int8Array:e===MV?Uint8Array:e===CV?Int8Array:e===SV?Uint8Array:e===kV?Int8Array:e===fV?Uint16Array:e===dV?Int16Array:e===xV?Uint16Array:e===wV?Int16Array:e===BV?Uint16Array:e===FV?Int16Array:e===pV||e===TV||e===zV?Uint16Array:e===yV?Uint32Array:e===_V?Int32Array:e===bV?Float32Array:e===DV?Uint32Array:e===OV?Int32Array:e===UV?Float32Array:e===VV?Uint32Array:e===qV?Int32Array:e===jV?Float32Array:e===RV||e===PV?Uint8Array:e===IV||e===NV||e===LV?Uint32Array:e===XV?Float32Array:e===HV||e===WV?Uint32Array:e===QV?Float32Array:void 0}},{key:"_getDimension",value:function(e){return e.isData3DTexture?Uj:Oj}}]),e}();function tG(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e.format,i=e.type,a=e.colorSpace;if(!0===e.isCompressedTexture||!0===e.isCompressedArrayTexture)switch(r){case fn:t=a===Kn?KV:YV;break;case dn:t=a===Kn?JV:ZV;break;case pn:t=a===Kn?eq:$V;break;case _n:t=a===Kn?cq:lq;break;case bn:t=a===Kn?pq:dq;break;case xn:t=a===Kn?_q:yq;break;case wn:t=a===Kn?xq:bq;break;case Tn:t=a===Kn?Tq:wq;break;case Sn:t=a===Kn?Eq:Sq;break;case En:t=a===Kn?Mq:kq;break;case kn:t=a===Kn?Rq:Cq;break;case Mn:t=a===Kn?Nq:Pq;break;case Cn:t=a===Kn?Lq:Iq;break;case Rn:t=a===Kn?Oq:Dq;break;case Pn:t=a===Kn?Bq:Uq;break;case Nn:t=a===Kn?zq:Fq;break;case In:t=a===Kn?qq:Vq;break;case Ln:t=a===Kn?Gq:jq;break;case Dn:t=a===Kn?Wq:Hq;break;case en:t=a===Kn?EV:SV;break;default:console.error("WebGPURenderer: Unsupported texture format.",r)}else switch(r){case en:switch(i){case Vt:t=kV;break;case qt:t=FV;break;case jt:t=BV;break;case Ht:t=VV;break;case Gt:t=qV;break;case zt:t=a===Kn?EV:SV;break;case Xt:t=zV;break;case Wt:t=jV;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAFormat.",i)}break;case $t:if(i===Zt)t=NV;else console.error("WebGPURenderer: Unsupported texture type with RGBFormat.",i);break;case on:switch(i){case Vt:t=lV;break;case qt:t=dV;break;case jt:t=fV;break;case Ht:t=yV;break;case Gt:t=_V;break;case zt:t=uV;break;case Xt:t=pV;break;case Wt:t=bV;break;default:console.error("WebGPURenderer: Unsupported texture type with RedFormat.",i)}break;case un:switch(i){case Vt:t=vV;break;case qt:t=wV;break;case jt:t=xV;break;case Ht:t=DV;break;case Gt:t=OV;break;case zt:t=AV;break;case Xt:t=TV;break;case Wt:t=UV;break;default:console.error("WebGPURenderer: Unsupported texture type with RGFormat.",i)}break;case rn:switch(i){case jt:t=GV;break;case Ht:t=HV;break;case Wt:t=XV;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthFormat.",i)}break;case an:switch(i){case Kt:t=WV;break;case Wt:n&&!1===n.features.has(Hj.Depth32FloatStencil8)&&console.error('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),t=QV;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",i)}break;case sn:switch(i){case Gt:t=_V;break;case Ht:t=yV;break;default:console.error("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",i)}break;case ln:switch(i){case Gt:t=OV;break;case Ht:t=DV;break;default:console.error("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",i)}break;case cn:switch(i){case Gt:t=qV;break;case Ht:t=VV;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",i)}break;default:console.error("WebGPURenderer: Unsupported texture format.",r)}return t}var nG=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,rG=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/gi,iG={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_depth_multisampled_2d:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"},aG=function(e){v(n,e);var t=b(n);function n(e){var r;c(this,n);var i=function(e){var t=(e=e.trim()).match(nG);if(null!==t&&4===t.length){for(var n=t[2],r=[],i=null;null!==(i=rG.exec(n));)r.push({name:i[1],type:i[2]});for(var a=[],o=0;o<r.length;o++){var s=r[o],u=s.name,l=s.type,c=l;c.startsWith("ptr")?c="pointer":(c.startsWith("texture")&&(c=l.split("<")[0]),c=iG[c]),a.push(new oF(c,u))}var h=e.substring(t[0].length),f=t[3]||"void",d=void 0!==t[1]?t[1]:"";return{type:iG[f]||f,inputs:a,name:d,inputsCode:n,blockCode:h,outputType:f}}throw new Error("FunctionNode: Function is not a WGSL code.")}(e),a=i.type,o=i.inputs,s=i.name,u=i.inputsCode,l=i.blockCode,h=i.outputType;return(r=t.call(this,a,o,s)).inputsCode=u,r.blockCode=l,r.outputType=h,r}return p(n,[{key:"getCode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.name,t="void"!==this.outputType?"-> "+this.outputType:"";return"fn ".concat(e," ( ").concat(this.inputsCode.trim()," ) ").concat(t)+this.blockCode}}]),n}(gF),oG=function(e){v(n,e);var t=b(n);function n(){return c(this,n),t.apply(this,arguments)}return p(n,[{key:"parseFunction",value:function(e){return new aG(e)}}]),n}(mF),sG="undefined"!==typeof self?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4},uG=(We(N_={},nb.READ_ONLY,"read"),We(N_,nb.WRITE_ONLY,"write"),We(N_,nb.READ_WRITE,"read_write"),N_),lG=(We(I_={},Pt,"repeat"),We(I_,Nt,"clamp"),We(I_,It,"mirror"),I_),cG={vertex:sG?sG.VERTEX:1,fragment:sG?sG.FRAGMENT:2,compute:sG?sG.COMPUTE:4},hG={instance:!0,swizzleAssign:!1,storageBuffer:!0},fG={"^^":"tsl_xor"},dG={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},pG={},AG={tsl_xor:new kD("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new kD("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new kD("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new kD("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new kD("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new kD("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new kD("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new kD("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new kD("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping_float:new kD("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),mirrorWrapping_float:new kD("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),clampWrapping_float:new kD("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),biquadraticTexture:new kD("\nfn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {\n\n\tlet res = vec2f( iRes );\n\n\tlet uvScaled = coord * res;\n\tlet uvWrapping = ( ( uvScaled % res ) + res ) % res;\n\n\t// https://www.shadertoy.com/view/WtyXRy\n\n\tlet uv = uvWrapping - 0.5;\n\tlet iuv = floor( uv );\n\tlet f = fract( uv );\n\n\tlet rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );\n\tlet rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );\n\tlet rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );\n\tlet rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );\n\n\treturn mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );\n\n}\n")},vG={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"};"undefined"!==typeof navigator&&/Windows/g.test(navigator.userAgent)&&(AG.pow_float=new kD("fn tsl_pow_float( a : f32, b : f32 ) -> f32 { return select( -pow( -a, b ), pow( a, b ), a > 0.0 ); }"),AG.pow_vec2=new kD("fn tsl_pow_vec2( a : vec2f, b : vec2f ) -> vec2f { return vec2f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ) ); }",[AG.pow_float]),AG.pow_vec3=new kD("fn tsl_pow_vec3( a : vec3f, b : vec3f ) -> vec3f { return vec3f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ) ); }",[AG.pow_float]),AG.pow_vec4=new kD("fn tsl_pow_vec4( a : vec4f, b : vec4f ) -> vec4f { return vec4f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ), tsl_pow_float( a.w, b.w ) ); }",[AG.pow_float]),vG.pow_float="tsl_pow_float",vG.pow_vec2="tsl_pow_vec2",vG.pow_vec3="tsl_pow_vec3",vG.pow_vec4="tsl_pow_vec4");var mG="";!0!==("undefined"!==typeof navigator&&/Firefox|Deno/g.test(navigator.userAgent))&&(mG+="diagnostic( off, derivative_uniformity );\n");var gG,yG=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this,e,r,new oG)).uniformGroups={},i.builtins={},i.directives={},i.scopedArrays=new Map,i}return p(n,[{key:"needsToWorkingColorSpace",value:function(e){return!0===e.isVideoTexture&&e.colorSpace!==Yn}},{key:"_generateTextureSample",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.shaderStage;return"fragment"===i?r?"textureSample( ".concat(t,", ").concat(t,"_sampler, ").concat(n,", ").concat(r," )"):"textureSample( ".concat(t,", ").concat(t,"_sampler, ").concat(n," )"):this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,n):this.generateTextureLod(e,t,n,r,"0")}},{key:"_generateVideoSample",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shaderStage;if("fragment"===n)return"textureSampleBaseClampToEdge( ".concat(e,", ").concat(e,"_sampler, vec2<f32>( ").concat(t,".x, 1.0 - ").concat(t,".y ) )");console.error("WebGPURenderer: THREE.VideoTexture does not support ".concat(n," shader."))}},{key:"_generateTextureSampleLevel",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.shaderStage;return"fragment"!==a&&"compute"!==a||!1!==this.isUnfilterable(e)?this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,n,r):this.generateTextureLod(e,t,n,i,r):"textureSampleLevel( ".concat(t,", ").concat(t,"_sampler, ").concat(n,", ").concat(r," )")}},{key:"generateWrapFunction",value:function(e){var t="tsl_coord_".concat(lG[e.wrapS],"S_").concat(lG[e.wrapT],"_").concat(e.isData3DTexture?"3d":"2d","T"),n=pG[t];if(void 0===n){var r=[],i=e.isData3DTexture?"vec3f":"vec2f",a="fn ".concat(t,"( coord : ").concat(i," ) -> ").concat(i," {\n\n\treturn ").concat(i,"(\n"),o=function(e,t){e===Pt?(r.push(AG.repeatWrapping_float),a+="\t\ttsl_repeatWrapping_float( coord.".concat(t," )")):e===Nt?(r.push(AG.clampWrapping_float),a+="\t\ttsl_clampWrapping_float( coord.".concat(t," )")):e===It?(r.push(AG.mirrorWrapping_float),a+="\t\ttsl_mirrorWrapping_float( coord.".concat(t," )")):(a+="\t\tcoord.".concat(t),console.warn('WebGPURenderer: Unsupported texture wrap type "'.concat(e,'" for vertex shader.')))};o(e.wrapS,"x"),a+=",\n",o(e.wrapT,"y"),e.isData3DTexture&&(a+=",\n",o(e.wrapR,"z")),a+="\n\t);\n\n}\n",pG[t]=n=new kD(a,r)}return n.build(this),t}},{key:"generateArrayDeclaration",value:function(e,t){return"array< ".concat(this.getType(e),", ").concat(t," >")}},{key:"generateTextureDimension",value:function(e,t,n){var r=this.getDataFromNode(e,this.shaderStage,this.globalCache);void 0===r.dimensionsSnippet&&(r.dimensionsSnippet={});var i=r.dimensionsSnippet[n];if(void 0===r.dimensionsSnippet[n]){var a,o,s=this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1;o=e.isData3DTexture?"vec3<u32>":"vec2<u32>",a=s||e.isVideoTexture||e.isStorageTexture?t:"".concat(t).concat(n?", u32( ".concat(n," )"):""),i=new xS(new aE("textureDimensions( ".concat(a," )"),o)),r.dimensionsSnippet[n]=i,(e.isDataArrayTexture||e.isData3DTexture)&&(r.arrayLayerCount=new xS(new aE("textureNumLayers(".concat(t,")"),"u32"))),e.isTextureCube&&(r.cubeFaceCount=new xS(new aE("6u","u32")))}return i.build(this)}},{key:"generateFilteredTexture",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"0u";this._include("biquadraticTexture");var i=this.generateWrapFunction(e),a=this.generateTextureDimension(e,t,r);return"tsl_biquadraticTexture( ".concat(t,", ").concat(i,"( ").concat(n," ), ").concat(a,", u32( ").concat(r," ) )")}},{key:"generateTextureLod",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"0u",a=this.generateWrapFunction(e),o=this.generateTextureDimension(e,t,i),s=e.isData3DTexture?"vec3":"vec2",u="".concat(s,"<u32>(").concat(a,"(").concat(n,") * ").concat(s,"<f32>(").concat(o,"))");return this.generateTextureLoad(e,t,u,r,i)}},{key:"generateTextureLoad",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"0u";return!0===e.isVideoTexture||!0===e.isStorageTexture?"textureLoad( ".concat(t,", ").concat(n," )"):r?"textureLoad( ".concat(t,", ").concat(n,", ").concat(r,", u32( ").concat(i," ) )"):"textureLoad( ".concat(t,", ").concat(n,", u32( ").concat(i," ) )")}},{key:"generateTextureStore",value:function(e,t,n,r){return"textureStore( ".concat(t,", ").concat(n,", ").concat(r," )")}},{key:"isSampleCompare",value:function(e){return!0===e.isDepthTexture&&null!==e.compareFunction}},{key:"isUnfilterable",value:function(e){return"float"!==this.getComponentTypeFromTexture(e)||!this.isAvailable("float32Filterable")&&!0===e.isDataTexture&&e.type===Wt||!1===this.isSampleCompare(e)&&e.minFilter===Lt&&e.magFilter===Lt||this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1}},{key:"generateTexture",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.shaderStage;return!0===e.isVideoTexture?this._generateVideoSample(t,n,i):this.isUnfilterable(e)?this.generateTextureLod(e,t,n,r,"0",i):this._generateTextureSample(e,t,n,r,i)}},{key:"generateTextureGrad",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.shaderStage;if("fragment"===a)return"textureSampleGrad( ".concat(t,", ").concat(t,"_sampler, ").concat(n,",  ").concat(r[0],", ").concat(r[1]," )");console.error("WebGPURenderer: THREE.TextureNode.gradient() does not support ".concat(a," shader."))}},{key:"generateTextureCompare",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.shaderStage;if("fragment"===a)return"textureSampleCompare( ".concat(t,", ").concat(t,"_sampler, ").concat(n,", ").concat(r," )");console.error("WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ".concat(a," shader."))}},{key:"generateTextureLevel",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.shaderStage;return!0===e.isVideoTexture?this._generateVideoSample(t,n,a):this._generateTextureSampleLevel(e,t,n,r,i,a)}},{key:"generateTextureBias",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.shaderStage;if("fragment"===a)return"textureSampleBias( ".concat(t,", ").concat(t,"_sampler, ").concat(n,", ").concat(r," )");console.error("WebGPURenderer: THREE.TextureNode.biasNode does not support ".concat(a," shader."))}},{key:"getPropertyName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shaderStage;if(!0===e.isNodeVarying&&!0===e.needsInterpolation){if("vertex"===t)return"varyings.".concat(e.name)}else if(!0===e.isNodeUniform){var r=e.name,i=e.type;return"texture"===i||"cubeTexture"===i||"storageTexture"===i||"texture3D"===i?r:"buffer"===i||"storageBuffer"===i||"indirectStorageBuffer"===i?this.isCustomStruct(e)?r:r+".value":e.groupNode.name+"."+r}return ht(m(n.prototype),"getPropertyName",this).call(this,e)}},{key:"getOutputStructName",value:function(){return"output"}},{key:"getFunctionOperator",value:function(e){var t=fG[e];return void 0!==t?(this._include(t),t):null}},{key:"getNodeAccess",value:function(e,t){return"compute"!==t?nb.READ_ONLY:e.access}},{key:"getStorageAccess",value:function(e,t){return uG[this.getNodeAccess(e,t)]}},{key:"getUniformFromNode",value:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=ht(m(n.prototype),"getUniformFromNode",this).call(this,e,t,r,i),o=this.getDataFromNode(e,r,this.globalCache);if(void 0===o.uniformGPU){var s,u=e.groupNode,l=u.name,c=this.getBindGroupArray(l,r);if("texture"===t||"cubeTexture"===t||"storageTexture"===t||"texture3D"===t){var h=null,f=this.getNodeAccess(e,r);if("texture"===t||"storageTexture"===t?h=new Az(a.name,a.node,u,f):"cubeTexture"===t?h=new vz(a.name,a.node,u,f):"texture3D"===t&&(h=new mz(a.name,a.node,u,f)),h.store=!0===e.isStorageTextureNode,h.setVisibility(cG[r]),"fragment"!==r&&"compute"!==r||!1!==this.isUnfilterable(e.value)||!1!==h.store)c.push(h),s=[h];else{var d=new Xj("".concat(a.name,"_sampler"),a.node,u);d.setVisibility(cG[r]),c.push(d,h),s=[d,h]}}else if("buffer"===t||"storageBuffer"===t||"indirectStorageBuffer"===t){var p="buffer"===t?iz:Kj,A=new p(e,u);A.setVisibility(cG[r]),c.push(A),s=A,a.name=i||"NodeBuffer_"+a.id}else{var v=this.uniformGroups[r]||(this.uniformGroups[r]={}),g=v[l];void 0===g&&((g=new fz(l,u)).setVisibility(cG[r]),v[l]=g,c.push(g)),s=this.getNodeUniform(a,t),g.addUniform(s)}o.uniformGPU=s}return a}},{key:"getBuiltin",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.shaderStage,i=this.builtins[r]||(this.builtins[r]=new Map);return!1===i.has(e)&&i.set(e,{name:e,property:t,type:n}),t}},{key:"hasBuiltin",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shaderStage;return void 0!==this.builtins[t]&&this.builtins[t].has(e)}},{key:"getVertexIndex",value:function(){return"vertex"===this.shaderStage?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}},{key:"buildFunctionCode",value:function(e){var t,n=e.layout,r=this.flowShaderNode(e),i=[],a=k(n.inputs);try{for(a.s();!(t=a.n()).done;){var o=t.value;i.push(o.name+" : "+this.getType(o.type))}}catch(u){a.e(u)}finally{a.f()}var s="fn ".concat(n.name,"( ").concat(i.join(", ")," ) -> ").concat(this.getType(n.type)," {\n").concat(r.vars,"\n").concat(r.code,"\n");return r.result&&(s+="\treturn ".concat(r.result,";\n")),s+="\n}\n"}},{key:"getInstanceIndex",value:function(){return"vertex"===this.shaderStage?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}},{key:"getInvocationLocalIndex",value:function(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}},{key:"getSubgroupSize",value:function(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}},{key:"getInvocationSubgroupIndex",value:function(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}},{key:"getSubgroupIndex",value:function(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}},{key:"getDrawIndex",value:function(){return null}},{key:"getFrontFacing",value:function(){return this.getBuiltin("front_facing","isFront","bool")}},{key:"getFragCoord",value:function(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}},{key:"getFragDepth",value:function(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}},{key:"getClipDistance",value:function(){return"varyings.hw_clip_distances"}},{key:"isFlipY",value:function(){return!1}},{key:"enableDirective",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shaderStage,n=this.directives[t]||(this.directives[t]=new Set);n.add(e)}},{key:"getDirectives",value:function(e){var t=[],n=this.directives[e];if(void 0!==n){var r,i=k(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;t.push("enable ".concat(a,";"))}}catch(o){i.e(o)}finally{i.f()}}return t.join("\n")}},{key:"enableSubGroups",value:function(){this.enableDirective("subgroups")}},{key:"enableSubgroupsF16",value:function(){this.enableDirective("subgroups-f16")}},{key:"enableClipDistances",value:function(){this.enableDirective("clip_distances")}},{key:"enableShaderF16",value:function(){this.enableDirective("f16")}},{key:"enableDualSourceBlending",value:function(){this.enableDirective("dual_source_blending")}},{key:"enableHardwareClipping",value:function(e){this.enableClipDistances(),this.getBuiltin("clip_distances","hw_clip_distances","array<f32, ".concat(e," >"),"vertex")}},{key:"getBuiltins",value:function(e){var t=[],n=this.builtins[e];if(void 0!==n){var r,i=k(n.values());try{for(i.s();!(r=i.n()).done;){var a=r.value,o=a.name,s=a.property,u=a.type;t.push("@builtin( ".concat(o," ) ").concat(s," : ").concat(u))}}catch(l){i.e(l)}finally{i.f()}}return t.join(",\n\t")}},{key:"getScopedArray",value:function(e,t,n,r){return!1===this.scopedArrays.has(e)&&this.scopedArrays.set(e,{name:e,scope:t,bufferType:n,bufferCount:r}),e}},{key:"getScopedArrays",value:function(e){if("compute"===e){var t,n=[],r=k(this.scopedArrays.values());try{for(r.s();!(t=r.n()).done;){var i=t.value,a=i.name,o=i.scope,s=i.bufferType,u=i.bufferCount,l=this.getType(s);n.push("var<".concat(o,"> ").concat(a,": array< ").concat(l,", ").concat(u," >;"))}}catch(c){r.e(c)}finally{r.f()}return n.join("\n")}}},{key:"getAttributes",value:function(e){var t=[];if("compute"===e&&(this.getBuiltin("global_invocation_id","globalId","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),"vertex"===e||"compute"===e){var n=this.getBuiltins("attribute");n&&t.push(n);for(var r=this.getAttributesArray(),i=0,a=r.length;i<a;i++){var o=r[i],s=o.name,u=this.getType(o.type);t.push("@location( ".concat(i," ) ").concat(s," : ").concat(u))}}return t.join(",\n\t")}},{key:"getStructMembers",value:function(e){var t,n=[],r=k(e.members);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=e.output?"@location( "+i.index+" ) ":"",o=this.getType(i.type);i.atomic&&(o="atomic< "+o+" >"),n.push("\t".concat(a+i.name," : ").concat(o))}}catch(s){r.e(s)}finally{r.f()}return e.output&&n.push("\t".concat(this.getBuiltins("output"))),n.join(",\n")}},{key:"getStructs",value:function(e){var t="",n=this.structs[e];if(n.length>0){var r,i=[],a=k(n);try{for(a.s();!(r=a.n()).done;){var o=r.value,s="struct ".concat(o.name," {\n");s+=this.getStructMembers(o),s+="\n};",i.push(s)}}catch(u){a.e(u)}finally{a.f()}t="\n"+i.join("\n\n")+"\n"}return t}},{key:"getVar",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r="var ".concat(t," : ");return r+=null!==n?this.generateArrayDeclaration(e,n):this.getType(e)}},{key:"getVars",value:function(e){var t=[],n=this.vars[e];if(void 0!==n){var r,i=k(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;t.push("\t".concat(this.getVar(a.type,a.name,a.count),";"))}}catch(o){i.e(o)}finally{i.f()}}return"\n".concat(t.join("\n"),"\n")}},{key:"getVaryings",value:function(e){var t=[];if("vertex"===e&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),"vertex"===e||"fragment"===e)for(var n=this.varyings,r=this.vars[e],i=0;i<n.length;i++){var a=n[i];if(a.needsInterpolation){var o="@location( ".concat(i," )");/^(int|uint|ivec|uvec)/.test(a.type)&&(o+=" @interpolate( flat )"),t.push("".concat(o," ").concat(a.name," : ").concat(this.getType(a.type)))}else"vertex"===e&&!1===r.includes(a)&&r.push(a)}var s=this.getBuiltins(e);s&&t.push(s);var u=t.join(",\n\t");return"vertex"===e?this._getWGSLStruct("VaryingsStruct","\t"+u):u}},{key:"isCustomStruct",value:function(e){return e.value.isStorageBufferAttribute&&null!==e.node.structTypeNode}},{key:"getUniforms",value:function(e){var t,n=[],r=[],i=[],a={},o=k(this.uniforms[e]);try{for(o.s();!(t=o.n()).done;){var s=t.value,u=s.groupNode.name,l=this.bindingsIndexes[u];if("texture"===s.type||"cubeTexture"===s.type||"storageTexture"===s.type||"texture3D"===s.type){var c=s.node.value;"fragment"!==e&&"compute"!==e||!1!==this.isUnfilterable(c)||!0===s.node.isStorageTextureNode||(this.isSampleCompare(c)?n.push("@binding( ".concat(l.binding++," ) @group( ").concat(l.group," ) var ").concat(s.name,"_sampler : sampler_comparison;")):n.push("@binding( ".concat(l.binding++," ) @group( ").concat(l.group," ) var ").concat(s.name,"_sampler : sampler;")));var h=void 0,f="";if(this.renderer.backend.utils.getTextureSampleData(c).primarySamples>1&&(f="_multisampled"),!0===c.isCubeTexture)h="texture_cube<f32>";else if(!0===c.isDataArrayTexture||!0===c.isCompressedArrayTexture)h="texture_2d_array<f32>";else if(!0===c.isDepthTexture)h="texture_depth".concat(f,"_2d");else if(!0===c.isVideoTexture)h="texture_external";else if(!0===c.isData3DTexture)h="texture_3d<f32>";else if(!0===s.node.isStorageTextureNode){var d=tG(c),p=this.getStorageAccess(s.node,e);h="texture_storage_2d<".concat(d,", ").concat(p,">")}else{var A=this.getComponentTypeFromTexture(c).charAt(0);h="texture".concat(f,"_2d<").concat(A,"32>")}n.push("@binding( ".concat(l.binding++," ) @group( ").concat(l.group," ) var ").concat(s.name," : ").concat(h,";"))}else if("buffer"===s.type||"storageBuffer"===s.type||"indirectStorageBuffer"===s.type){var v=s.node,m=this.getType(v.getNodeType(this)),g=v.bufferCount,y=g>0&&"buffer"===s.type?", "+g:"",_=v.isStorageBufferNode?"storage, ".concat(this.getStorageAccess(v,e)):"uniform";if(this.isCustomStruct(s))r.push("@binding( ".concat(l.binding++," ) @group( ").concat(l.group," ) var<").concat(_,"> ").concat(s.name," : ").concat(m,";"));else{var b=v.isAtomic?"atomic<".concat(m,">"):"".concat(m),x="\tvalue : array< ".concat(b).concat(y," >");r.push(this._getWGSLStructBinding(s.name,x,_,l.binding++,l.group))}}else{var w=this.getType(this.getVectorType(s.type)),T=s.groupNode.name;(a[T]||(a[T]={index:l.binding++,id:l.group,snippets:[]})).snippets.push("\t".concat(s.name," : ").concat(w))}}}catch(C){o.e(C)}finally{o.f()}for(var S in a){var E=a[S];i.push(this._getWGSLStructBinding(S,E.snippets.join(",\n"),"uniform",E.index,E.id))}var M=n.join("\n");return M+=r.join("\n"),M+=i.join("\n")}},{key:"buildCode",value:function(){var e=null!==this.material?{fragment:{},vertex:{}}:{compute:{}};for(var t in this.sortBindingGroups(),e){this.shaderStage=t;var n=e[t];n.uniforms=this.getUniforms(t),n.attributes=this.getAttributes(t),n.varyings=this.getVaryings(t),n.structs=this.getStructs(t),n.vars=this.getVars(t),n.codes=this.getCodes(t),n.directives=this.getDirectives(t),n.scopedArrays=this.getScopedArrays(t);var r="// code\n\n";r+=this.flowCode[t];var i,a=this.flowNodes[t],o=a[a.length-1],s=o.outputNode,u=void 0!==s&&!0===s.isOutputStructNode,l=k(a);try{for(l.s();!(i=l.n()).done;){var c=i.value,h=this.getFlowData(c),f=c.name;if(f&&(r.length>0&&(r+="\n"),r+="\t// flow -> ".concat(f,"\n")),r+="".concat(h.code,"\n\t"),c===o&&"compute"!==t)if(r+="// result\n\n\t","vertex"===t)r+="varyings.Vertex = ".concat(h.result,";");else if("fragment"===t)if(u)n.returnType=s.getNodeType(this),n.structs+="var<private> output : "+n.returnType+";",r+="return ".concat(h.result,";");else{var d="\t@location(0) color: vec4<f32>",p=this.getBuiltins("output");p&&(d+=",\n\t"+p),n.returnType="OutputStruct",n.structs+=this._getWGSLStruct("OutputStruct",d),n.structs+="\nvar<private> output : OutputStruct;",r+="output.color = ".concat(h.result,";\n\n\treturn output;")}}}catch(A){l.e(A)}finally{l.f()}n.flow=r}this.shaderStage=null,null!==this.material?(this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment)):this.computeShader=this._getWGSLComputeCode(e.compute,(this.object.workgroupSize||[64]).join(", "))}},{key:"getMethod",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null!==n&&(t=this._getWGSLMethod(e+"_"+n)),void 0===t&&(t=this._getWGSLMethod(e)),t||e}},{key:"getType",value:function(e){return dG[e]||e}},{key:"isAvailable",value:function(e){var t=hG[e];return void 0===t&&("float32Filterable"===e?t=this.renderer.hasFeature("float32-filterable"):"clipDistance"===e&&(t=this.renderer.hasFeature("clip-distances")),hG[e]=t),t}},{key:"_getWGSLMethod",value:function(e){return void 0!==AG[e]&&this._include(e),vG[e]}},{key:"_include",value:function(e){var t=AG[e];return t.build(this),null!==this.currentFunctionNode&&this.currentFunctionNode.includes.push(t),t}},{key:"_getWGSLVertexCode",value:function(e){return"".concat(this.getSignature(),"\n// directives\n").concat(e.directives,"\n\n// structs\n").concat(e.structs,"\n\n// uniforms\n").concat(e.uniforms,"\n\n// varyings\n").concat(e.varyings,"\nvar<private> varyings : VaryingsStruct;\n\n// codes\n").concat(e.codes,"\n\n@vertex\nfn main( ").concat(e.attributes," ) -> VaryingsStruct {\n\n\t// vars\n\t").concat(e.vars,"\n\n\t// flow\n\t").concat(e.flow,"\n\n\treturn varyings;\n\n}\n")}},{key:"_getWGSLFragmentCode",value:function(e){return"".concat(this.getSignature(),"\n// global\n").concat(mG,"\n\n// structs\n").concat(e.structs,"\n\n// uniforms\n").concat(e.uniforms,"\n\n// codes\n").concat(e.codes,"\n\n@fragment\nfn main( ").concat(e.varyings," ) -> ").concat(e.returnType," {\n\n\t// vars\n\t").concat(e.vars,"\n\n\t// flow\n\t").concat(e.flow,"\n\n}\n")}},{key:"_getWGSLComputeCode",value:function(e,t){return"".concat(this.getSignature(),"\n// directives\n").concat(e.directives,"\n\n// system\nvar<private> instanceIndex : u32;\n\n// locals\n").concat(e.scopedArrays,"\n\n// structs\n").concat(e.structs,"\n\n// uniforms\n").concat(e.uniforms,"\n\n// codes\n").concat(e.codes,"\n\n@compute @workgroup_size( ").concat(t," )\nfn main( ").concat(e.attributes," ) {\n\n\t// system\n\tinstanceIndex = globalId.x + globalId.y * numWorkgroups.x * u32(").concat(t,") + globalId.z * numWorkgroups.x * numWorkgroups.y * u32(").concat(t,");\n\n\t// vars\n\t").concat(e.vars,"\n\n\t// flow\n\t").concat(e.flow,"\n\n}\n")}},{key:"_getWGSLStruct",value:function(e,t){return"\nstruct ".concat(e," {\n").concat(t,"\n};")}},{key:"_getWGSLStructBinding",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=e+"Struct",o=this._getWGSLStruct(a,t);return"".concat(o,"\n@binding( ").concat(r," ) @group( ").concat(i," )\nvar<").concat(n,"> ").concat(e," : ").concat(a,";")}}]),n}(iF),_G=function(){function e(t){c(this,e),this.backend=t}return p(e,[{key:"getCurrentDepthStencilFormat",value:function(e){var t;return null!==e.depthTexture?t=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?t=WV:e.depth&&(t=HV),t}},{key:"getTextureFormatGPU",value:function(e){return this.backend.get(e).format}},{key:"getTextureSampleData",value:function(e){var t;if(e.isFramebufferTexture)t=1;else if(e.isDepthTexture&&!e.renderTarget){var n=this.backend.renderer,r=n.getRenderTarget();t=r?r.samples:n.samples}else e.renderTarget&&(t=e.renderTarget.samples);var i=(t=t||1)>1&&null!==e.renderTarget&&!0!==e.isDepthTexture&&!0!==e.isFramebufferTexture;return{samples:t,primarySamples:i?1:t,isMSAA:i}}},{key:"getCurrentColorFormat",value:function(e){return null!==e.textures?this.getTextureFormatGPU(e.textures[0]):this.getPreferredCanvasFormat()}},{key:"getCurrentColorSpace",value:function(e){return null!==e.textures?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}},{key:"getPrimitiveTopology",value:function(e,t){return e.isPoints?zz:e.isLineSegments||e.isMesh&&!0===t.wireframe?Vz:e.isLine?qz:e.isMesh?jz:void 0}},{key:"getSampleCount",value:function(e){var t=1;return e>1&&2===(t=Math.pow(2,Math.floor(Math.log2(e))))&&(t=4),t}},{key:"getSampleCountRenderContext",value:function(e){return null!==e.textures?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}},{key:"getPreferredCanvasFormat",value:function(){var e=this.backend.parameters.outputType;if(void 0===e)return navigator.gpu.getPreferredCanvasFormat();if(e===zt)return RV;if(e===Xt)return zV;throw new Error("Unsupported outputType")}}]),e}(),bG=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]),xG=new Map([[Ia,["float16"]]]),wG=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]),TG=function(){function e(t){c(this,e),this.backend=t}return p(e,[{key:"createAttribute",value:function(e,t){var n=this._getBufferAttribute(e),r=this.backend,i=r.get(n),a=i.buffer;if(void 0===a){var o=r.device,s=n.array;if(!1===e.normalized)if(s.constructor===Int16Array||s.constructor===Int8Array)s=new Int32Array(s);else if((s.constructor===Uint16Array||s.constructor===Uint8Array)&&(s=new Uint32Array(s),t&GPUBufferUsage.INDEX))for(var u=0;u<s.length;u++)65535===s[u]&&(s[u]=4294967295);if(n.array=s,(n.isStorageBufferAttribute||n.isStorageInstancedBufferAttribute)&&3===n.itemSize){s=new s.constructor(4*n.count);for(var l=0;l<n.count;l++)s.set(n.array.subarray(3*l,3*l+3),4*l);n.itemSize=4,n.array=s,i._force3to4BytesAlignment=!0}var c=s.byteLength+(4-s.byteLength%4)%4;a=o.createBuffer({label:n.name,size:c,usage:t,mappedAtCreation:!0}),new s.constructor(a.getMappedRange()).set(s),a.unmap(),i.buffer=a}}},{key:"updateAttribute",value:function(e){var t=this._getBufferAttribute(e),n=this.backend,r=n.device,i=n.get(t),a=n.get(t).buffer,o=t.array;if(!0===i._force3to4BytesAlignment){o=new o.constructor(4*t.count);for(var s=0;s<t.count;s++)o.set(t.array.subarray(3*s,3*s+3),4*s);t.array=o}var u=this._isTypedArray(o),l=t.updateRanges;if(0===l.length)r.queue.writeBuffer(a,0,o,0);else{for(var c=u?1:o.BYTES_PER_ELEMENT,h=0,f=l.length;h<f;h++){var d=l[h],p=void 0,A=void 0;if(!0===i._force3to4BytesAlignment)p=4*Math.floor(d.start/3)*c,A=4*Math.ceil(d.count/3)*c;else p=d.start*c,A=d.count*c;var v=p*(u?o.BYTES_PER_ELEMENT:1);r.queue.writeBuffer(a,v,o,p,A)}t.clearUpdateRanges()}}},{key:"createShaderVertexBuffers",value:function(e){for(var t=e.getAttributes(),n=new Map,r=0;r<t.length;r++){var i=t[r],a=i.array.BYTES_PER_ELEMENT,o=this._getBufferAttribute(i),s=n.get(o);if(void 0===s){var u=void 0,l=void 0;!0===i.isInterleavedBufferAttribute?(u=i.data.stride*a,l=i.data.isInstancedInterleavedBuffer?Gj:jj):(u=i.itemSize*a,l=i.isInstancedBufferAttribute?Gj:jj),!1!==i.normalized||i.array.constructor!==Int16Array&&i.array.constructor!==Uint16Array||(u=4),s={arrayStride:u,attributes:[],stepMode:l},n.set(o,s)}var c=this._getVertexFormat(i),h=!0===i.isInterleavedBufferAttribute?i.offset*a:0;s.attributes.push({shaderLocation:r,offset:h,format:c})}return Array.from(n.values())}},{key:"destroyAttribute",value:function(e){var t=this.backend;t.get(this._getBufferAttribute(e)).buffer.destroy(),t.delete(e)}},{key:"getArrayBufferAsync",value:function(){var e=lt(ft().mark((function e(t){var n,r,i,a,o,s,u,l,c,h;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.backend,r=n.device,i=n.get(this._getBufferAttribute(t)),a=i.buffer,o=a.size,s=r.createBuffer({label:"".concat(t.name,"_readback"),size:o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),(u=r.createCommandEncoder({label:"readback_encoder_".concat(t.name)})).copyBufferToBuffer(a,0,s,0,o),l=u.finish(),r.queue.submit([l]),e.next=12,s.mapAsync(GPUMapMode.READ);case 12:return c=s.getMappedRange(),h=new t.array.constructor(c.slice(0)),s.unmap(),e.abrupt("return",h.buffer);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getVertexFormat",value:function(e){var t,n=e.itemSize,r=e.normalized,i=e.array.constructor,a=e.constructor;if(1===n)t=wG.get(i);else{var o=(xG.get(a)||bG.get(i))[r?1:0];if(o){var s=i.BYTES_PER_ELEMENT*n,u=4*Math.floor((s+3)/4)/i.BYTES_PER_ELEMENT;if(u%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");t="".concat(o,"x").concat(u)}}return t||console.error("THREE.WebGPUAttributeUtils: Vertex format not supported yet."),t}},{key:"_isTypedArray",value:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}},{key:"_getBufferAttribute",value:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}]),e}(),SG=function(){function e(t){c(this,e),this.backend=t,this.bindGroupLayoutCache=new WeakMap}return p(e,[{key:"createBindingsLayout",value:function(e){var t,n=this.backend,r=n.device,i=[],a=0,o=k(e.bindings);try{for(o.s();!(t=o.n()).done;){var s=t.value,u={binding:a++,visibility:s.visibility};if(s.isUniformBuffer||s.isStorageBuffer){var l={};s.isStorageBuffer&&(4&s.visibility&&(s.access===nb.READ_WRITE||s.access===nb.WRITE_ONLY)?l.type=Ej:l.type=kj),u.buffer=l}else if(s.isSampler){var c={};s.texture.isDepthTexture&&null!==s.texture.compareFunction&&(c.type="comparison"),u.sampler=c}else if(s.isSampledTexture&&s.texture.isVideoTexture)u.externalTexture={};else if(s.isSampledTexture&&s.store){var h={};h.format=this.backend.get(s.texture).texture.format;var f=s.access;h.access=f===nb.READ_WRITE?Rj:f===nb.WRITE_ONLY?Mj:Cj,u.storageTexture=h}else if(s.isSampledTexture){var d={};if(n.utils.getTextureSampleData(s.texture).primarySamples>1&&(d.multisampled=!0,s.texture.isDepthTexture||(d.sampleType=Nj)),s.texture.isDepthTexture)d.sampleType=Ij;else if(s.texture.isDataTexture||s.texture.isDataArrayTexture||s.texture.isData3DTexture){var p=s.texture.type;p===Gt?d.sampleType=Lj:p===Ht?d.sampleType=Dj:p===Wt&&(this.backend.hasFeature("float32-filterable")?d.sampleType=Pj:d.sampleType=Nj)}s.isSampledCubeTexture?d.viewDimension=zj:s.texture.isDataArrayTexture||s.texture.isCompressedArrayTexture?d.viewDimension=Fj:s.isSampledTexture3D&&(d.viewDimension=Vj),u.texture=d}else console.error('WebGPUBindingUtils: Unsupported binding "'.concat(s,'".'));i.push(u)}}catch(A){o.e(A)}finally{o.f()}return r.createBindGroupLayout({entries:i})}},{key:"createBindings",value:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=this.backend,o=this.bindGroupLayoutCache,s=a.get(e),u=o.get(e.bindingsReference);void 0===u&&(u=this.createBindingsLayout(e),o.set(e.bindingsReference,u)),n>0&&(void 0===s.groups&&(s.groups=[],s.versions=[]),s.versions[n]===i&&(r=s.groups[n])),void 0===r&&(r=this.createBindGroup(e,u),n>0&&(s.groups[n]=r,s.versions[n]=i)),s.group=r,s.layout=u}},{key:"updateBinding",value:function(e){var t=this.backend,n=t.device,r=e.buffer,i=t.get(e).buffer;n.queue.writeBuffer(i,0,r,0)}},{key:"createBindGroupIndex",value:function(e,t){var n=this.backend.device,r=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,i=e[0],a=n.createBuffer({label:"bindingCameraIndex_"+i,size:16,usage:r});n.queue.writeBuffer(a,0,e,0);var o=[{binding:0,resource:{buffer:a}}];return n.createBindGroup({label:"bindGroupCameraIndex_"+i,layout:t,entries:o})}},{key:"createBindGroup",value:function(e,t){var n,r=this.backend,i=r.device,a=0,o=[],s=k(e.bindings);try{for(s.s();!(n=s.n()).done;){var u=n.value;if(u.isUniformBuffer){var l=r.get(u);if(void 0===l.buffer){var c=u.byteLength,h=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,f=i.createBuffer({label:"bindingBuffer_"+u.name,size:c,usage:h});l.buffer=f}o.push({binding:a,resource:{buffer:l.buffer}})}else if(u.isStorageBuffer){var d=r.get(u);if(void 0===d.buffer){var p=u.attribute;d.buffer=r.get(p).buffer}o.push({binding:a,resource:{buffer:d.buffer}})}else if(u.isSampler){var A=r.get(u.texture);o.push({binding:a,resource:A.sampler})}else if(u.isSampledTexture){var v=r.get(u.texture),m=void 0;if(void 0!==v.externalTexture)m=i.importExternalTexture({source:v.externalTexture});else{var g=u.store?1:v.texture.mipLevelCount,y="view-".concat(v.texture.width,"-").concat(v.texture.height,"-").concat(g);if(void 0===(m=v[y])){var _=qj,b=void 0;b=u.isSampledCubeTexture?zj:u.isSampledTexture3D?Vj:u.texture.isDataArrayTexture||u.texture.isCompressedArrayTexture?Fj:Bj,m=v[y]=v.texture.createView({aspect:_,dimension:b,mipLevelCount:g})}}o.push({binding:a,resource:m})}a++}}catch(x){s.e(x)}finally{s.f()}return i.createBindGroup({label:"bindGroup_"+e.name,layout:t,entries:o})}}]),e}(),EG=function(){function e(t){c(this,e),this.backend=t}return p(e,[{key:"_getSampleCount",value:function(e){return this.backend.utils.getSampleCountRenderContext(e)}},{key:"createRenderPipeline",value:function(e,t){var n,r=e.object,i=e.material,a=e.geometry,o=e.pipeline,s=o.vertexProgram,u=o.fragmentProgram,l=this.backend,c=l.device,h=l.utils,f=l.get(o),d=[],p=k(e.getBindings());try{for(p.s();!(n=p.n()).done;){var A=n.value,v=l.get(A);d.push(v.layout)}}catch(B){p.e(B)}finally{p.f()}var m,g=l.attributeUtils.createShaderVertexBuffers(e);!0===i.transparent&&0!==i.blending&&(m=this._getBlending(i));var y={};!0===i.stencilWrite&&(y={compare:this._getStencilCompare(i),failOp:this._getStencilOperation(i.stencilFail),depthFailOp:this._getStencilOperation(i.stencilZFail),passOp:this._getStencilOperation(i.stencilZPass)});var _=this._getColorWriteMask(i),b=[];if(null!==e.context.textures)for(var x=e.context.textures,w=0;w<x.length;w++){var T=h.getTextureFormatGPU(x[w]);b.push({format:T,blend:m,writeMask:_})}else{var S=h.getCurrentColorFormat(e.context);b.push({format:S,blend:m,writeMask:_})}var E=l.get(s).module,M=l.get(u).module,C=this._getPrimitiveState(r,a,i),R=this._getDepthCompare(i),P=h.getCurrentDepthStencilFormat(e.context),N=this._getSampleCount(e.context),I={label:"renderPipeline_".concat(i.name||i.type,"_").concat(i.id),vertex:Object.assign({},E,{buffers:g}),fragment:Object.assign({},M,{targets:b}),primitive:C,multisample:{count:N,alphaToCoverageEnabled:i.alphaToCoverage&&N>1},layout:c.createPipelineLayout({bindGroupLayouts:d})},L={},D=e.context.depth,O=e.context.stencil;if(!0!==D&&!0!==O||(!0===D&&(L.format=P,L.depthWriteEnabled=i.depthWrite,L.depthCompare=R),!0===O&&(L.stencilFront=y,L.stencilBack={},L.stencilReadMask=i.stencilFuncMask,L.stencilWriteMask=i.stencilWriteMask),!0===i.polygonOffset&&(L.depthBias=i.polygonOffsetUnits,L.depthBiasSlopeScale=i.polygonOffsetFactor,L.depthBiasClamp=0),I.depthStencil=L),null===t)f.pipeline=c.createRenderPipeline(I);else{var U=new Promise((function(e){c.createRenderPipelineAsync(I).then((function(t){f.pipeline=t,e()}))}));t.push(U)}}},{key:"createBundleEncoder",value:function(e){var t=this.backend,n=t.utils,r=t.device,i=n.getCurrentDepthStencilFormat(e),a={label:"renderBundleEncoder",colorFormats:[n.getCurrentColorFormat(e)],depthStencilFormat:i,sampleCount:this._getSampleCount(e)};return r.createRenderBundleEncoder(a)}},{key:"createComputePipeline",value:function(e,t){var n,r=this.backend,i=r.device,a=r.get(e.computeProgram).module,o=r.get(e),s=[],u=k(t);try{for(u.s();!(n=u.n()).done;){var l=n.value,c=r.get(l);s.push(c.layout)}}catch(h){u.e(h)}finally{u.f()}o.pipeline=i.createComputePipeline({compute:a,layout:i.createPipelineLayout({bindGroupLayouts:s})})}},{key:"_getBlending",value:function(e){var t,n,r=e.blending,i=e.blendSrc,a=e.blendDst,o=e.blendEquation;if(5===r){var s=null!==e.blendSrcAlpha?e.blendSrcAlpha:i,u=null!==e.blendDstAlpha?e.blendDstAlpha:a,l=null!==e.blendEquationAlpha?e.blendEquationAlpha:o;t={srcFactor:this._getBlendFactor(i),dstFactor:this._getBlendFactor(a),operation:this._getBlendOperation(o)},n={srcFactor:this._getBlendFactor(s),dstFactor:this._getBlendFactor(u),operation:this._getBlendOperation(l)}}else{var c=function(e,r,i,a){t={srcFactor:e,dstFactor:r,operation:hj},n={srcFactor:i,dstFactor:a,operation:hj}};if(e.premultipliedAlpha)switch(r){case 1:c($q,rj,$q,rj);break;case 2:c($q,$q,$q,$q);break;case 3:c(Jq,tj,Jq,$q);break;case 4:c(Jq,ej,Jq,nj)}else switch(r){case 1:c(nj,rj,$q,rj);break;case 2:c(nj,$q,nj,$q);break;case 3:c(Jq,tj,Jq,$q);break;case 4:c(Jq,ej,Jq,ej)}}if(void 0!==t&&void 0!==n)return{color:t,alpha:n};console.error("THREE.WebGPURenderer: Invalid blending: ",r)}},{key:"_getBlendFactor",value:function(e){var t;switch(e){case xt:t=Jq;break;case 201:t=$q;break;case 202:t=ej;break;case 203:t=tj;break;case wt:t=nj;break;case Tt:t=rj;break;case 208:t=ij;break;case 209:t=aj;break;case 206:t=oj;break;case 207:t=sj;break;case 210:t=uj;break;case 211:t=lj;break;case 212:t=cj;break;default:console.error("THREE.WebGPURenderer: Blend factor not supported.",e)}return t}},{key:"_getStencilCompare",value:function(e){var t,n=e.stencilFunc;switch(n){case 512:t=Hz;break;case 519:t=Jz;break;case 513:t=Wz;break;case 515:t=Qz;break;case 514:t=Xz;break;case 518:t=Zz;break;case 516:t=Yz;break;case 517:t=Kz;break;default:console.error("THREE.WebGPURenderer: Invalid stencil function.",n)}return t}},{key:"_getStencilOperation",value:function(e){var t;switch(e){case er:t=gj;break;case 0:t=yj;break;case 7681:t=_j;break;case 5386:t=bj;break;case 7682:t=xj;break;case 7683:t=wj;break;case 34055:t=Tj;break;case 34056:t=Sj;break;default:console.error("THREE.WebGPURenderer: Invalid stencil operation.",t)}return t}},{key:"_getBlendOperation",value:function(e){var t;switch(e){case bt:t=hj;break;case 101:t=fj;break;case 102:t=dj;break;case 103:t=pj;break;case 104:t=Aj;break;default:console.error("THREE.WebGPUPipelineUtils: Blend equation not supported.",e)}return t}},{key:"_getPrimitiveState",value:function(e,t,n){var r={},i=this.backend.utils;switch(r.topology=i.getPrimitiveTopology(e,n),null!==t.index&&!0===e.isLine&&!0!==e.isLineSegments&&(r.stripIndexFormat=t.index.array instanceof Uint16Array?oV:sV),n.side){case 0:r.frontFace=nV,r.cullMode=aV;break;case 1:r.frontFace=nV,r.cullMode=iV;break;case 2:r.frontFace=nV,r.cullMode=rV;break;default:console.error("THREE.WebGPUPipelineUtils: Unknown material.side value.",n.side)}return r}},{key:"_getColorWriteMask",value:function(e){return!0===e.colorWrite?mj:vj}},{key:"_getDepthCompare",value:function(e){var t;if(!1===e.depthTest)t=Jz;else{var n=e.depthFunc;switch(n){case 0:t=Hz;break;case 1:t=Jz;break;case 2:t=Wz;break;case 3:t=Qz;break;case 4:t=Xz;break;case 5:t=Zz;break;case 6:t=Yz;break;case 7:t=Kz;break;default:console.error("THREE.WebGPUPipelineUtils: Invalid depth function.",n)}}return t}}]),e}(),kG=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2048;c(this,n),(i=t.call(this,a)).device=e,i.type=r,i.querySet=i.device.createQuerySet({type:"timestamp",count:i.maxQueries,label:"queryset_global_timestamp_".concat(r)});var o=8*i.maxQueries;return i.resolveBuffer=i.device.createBuffer({label:"buffer_timestamp_resolve_".concat(r),size:o,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),i.resultBuffer=i.device.createBuffer({label:"buffer_timestamp_result_".concat(r),size:o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),i}return p(n,[{key:"allocateQueriesForContext",value:function(e){if(!this.trackTimestamp||this.isDisposed)return null;if(this.currentQueryIndex+2>this.maxQueries)return kr("WebGPUTimestampQueryPool [".concat(this.type,"]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.").concat(this.type.toUpperCase()," ).")),null;var t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryOffsets.set(e.id,t),t}},{key:"resolveQueriesAsync",value:function(){var e=lt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.trackTimestamp&&0!==this.currentQueryIndex&&!this.isDisposed){e.next=2;break}return e.abrupt("return",this.lastValue);case 2:if(!this.pendingResolve){e.next=4;break}return e.abrupt("return",this.pendingResolve);case 4:return this.pendingResolve=this._resolveQueries(),e.prev=5,e.next=8,this.pendingResolve;case 8:return t=e.sent,e.abrupt("return",t);case 10:return e.prev=10,this.pendingResolve=null,e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[5,,10,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"_resolveQueries",value:function(){var e=lt(ft().mark((function e(){var t,n,r,i,a,o,s,u,l,c,h,f,d,p;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isDisposed){e.next=2;break}return e.abrupt("return",this.lastValue);case 2:if(e.prev=2,"unmapped"===this.resultBuffer.mapState){e.next=5;break}return e.abrupt("return",this.lastValue);case 5:if(t=new Map(this.queryOffsets),n=this.currentQueryIndex,r=8*n,this.currentQueryIndex=0,this.queryOffsets.clear(),(i=this.device.createCommandEncoder()).resolveQuerySet(this.querySet,0,n,this.resolveBuffer,0),i.copyBufferToBuffer(this.resolveBuffer,0,this.resultBuffer,0,r),a=i.finish(),this.device.queue.submit([a]),"unmapped"===this.resultBuffer.mapState){e.next=17;break}return e.abrupt("return",this.lastValue);case 17:return e.next=19,this.resultBuffer.mapAsync(GPUMapMode.READ,0,r);case 19:if(!this.isDisposed){e.next=22;break}return"mapped"===this.resultBuffer.mapState&&this.resultBuffer.unmap(),e.abrupt("return",this.lastValue);case 22:o=new BigUint64Array(this.resultBuffer.getMappedRange(0,r)),s=0,u=k(t);try{for(u.s();!(l=u.n()).done;)c=T(l.value,2),h=c[1],f=o[h],d=o[h+1],p=Number(d-f)/1e6,s+=p}catch(A){u.e(A)}finally{u.f()}return this.resultBuffer.unmap(),this.lastValue=s,e.abrupt("return",s);case 31:return e.prev=31,e.t0=e.catch(2),console.error("Error resolving queries:",e.t0),"mapped"===this.resultBuffer.mapState&&this.resultBuffer.unmap(),e.abrupt("return",this.lastValue);case 36:case"end":return e.stop()}}),e,this,[[2,31]])})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isDisposed){e.next=2;break}return e.abrupt("return");case 2:if(this.isDisposed=!0,!this.pendingResolve){e.next=12;break}return e.prev=4,e.next=7,this.pendingResolve;case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),console.error("Error waiting for pending resolve:",e.t0);case 12:if(this.resultBuffer&&"mapped"===this.resultBuffer.mapState)try{this.resultBuffer.unmap()}catch(t){console.error("Error unmapping buffer:",t)}this.querySet&&(this.querySet.destroy(),this.querySet=null),this.resolveBuffer&&(this.resolveBuffer.destroy(),this.resolveBuffer=null),this.resultBuffer&&(this.resultBuffer.destroy(),this.resultBuffer=null),this.queryOffsets.clear(),this.pendingResolve=null;case 18:case"end":return e.stop()}}),e,this,[[4,9]])})));return function(){return e.apply(this,arguments)}}()}]),n}(Uz),MG=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c(this,n),(e=t.call(this,r)).isWebGPUBackend=!0,e.parameters.alpha=void 0===r.alpha||r.alpha,e.parameters.requiredLimits=void 0===r.requiredLimits?{}:r.requiredLimits,e.device=null,e.context=null,e.colorBuffer=null,e.defaultRenderPassdescriptor=null,e.utils=new _G(y(e)),e.attributeUtils=new TG(y(e)),e.bindingUtils=new SG(y(e)),e.pipelineUtils=new EG(y(e)),e.textureUtils=new eG(y(e)),e.occludedResolveCache=new Map,e}return p(n,[{key:"init",value:function(){var e=lt(ft().mark((function e(t){var r,i,a,o,s,u,l,c,h,f,d,p;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ht(m(n.prototype),"init",this).call(this,t);case 2:if(void 0!==(r=this.parameters).device){e.next=24;break}if(a={powerPreference:r.powerPreference},"undefined"===typeof navigator){e.next=11;break}return e.next=8,navigator.gpu.requestAdapter(a);case 8:e.t0=e.sent,e.next=12;break;case 11:e.t0=null;case 12:if(null!==(o=e.t0)){e.next=15;break}throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");case 15:for(s=Object.values(Hj),u=[],l=0,c=s;l<c.length;l++)h=c[l],o.features.has(h)&&u.push(h);return f={requiredFeatures:u,requiredLimits:r.requiredLimits},e.next=21,o.requestDevice(f);case 21:i=e.sent,e.next=25;break;case 24:i=r.device;case 25:i.lost.then((function(e){var n={api:"WebGPU",message:e.message||"Unknown reason",reason:e.reason||null,originalEvent:e};t.onDeviceLost(n)})),d=void 0!==r.context?r.context:t.domElement.getContext("webgpu"),this.device=i,this.context=d,p=r.alpha?"premultiplied":"opaque",this.trackTimestamp=this.trackTimestamp&&this.hasFeature(Hj.TimestampQuery),this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:p}),this.updateSize();case 33:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"coordinateSystem",get:function(){return sr}},{key:"getArrayBufferAsync",value:function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.attributeUtils.getArrayBufferAsync(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getContext",value:function(){return this.context}},{key:"_getDefaultRenderPassDescriptor",value:function(){var e=this.defaultRenderPassdescriptor;if(null===e){var t=this.renderer;e={colorAttachments:[{view:null}]},!0!==this.renderer.depth&&!0!==this.renderer.stencil||(e.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(t.depth,t.stencil).createView()});var n=e.colorAttachments[0];this.renderer.samples>0?n.view=this.colorBuffer.createView():n.resolveTarget=void 0,this.defaultRenderPassdescriptor=e}var r=e.colorAttachments[0];return this.renderer.samples>0?r.resolveTarget=this.context.getCurrentTexture().createView():r.view=this.context.getCurrentTexture().createView(),e}},{key:"_getRenderPassDescriptor",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.renderTarget,i=this.get(r),a=i.descriptors;if(void 0===a||i.width!==r.width||i.height!==r.height||i.dimensions!==r.dimensions||i.activeMipmapLevel!==e.activeMipmapLevel||i.activeCubeFace!==e.activeCubeFace||i.samples!==r.samples){a={},i.descriptors=a;var o=function e(){r.removeEventListener("dispose",e),t.delete(r)};!1===r.hasEventListener("dispose",o)&&r.addEventListener("dispose",o)}var s=e.getCacheKey(),u=a[s];if(void 0===u){for(var l,c=e.textures,h=[],f=0;f<c.length;f++){var d=this.get(c[f]),p={label:"colorAttachment_".concat(f),baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,arrayLayerCount:1,dimension:Bj};r.isRenderTarget3D?(l=e.activeCubeFace,p.baseArrayLayer=0,p.dimension=Vj,p.depthOrArrayLayers=c[f].image.depth):r.isRenderTargetArray&&(p.dimension=Fj,p.depthOrArrayLayers=c[f].image.depth);var A=d.texture.createView(p),v=void 0,m=void 0;void 0!==d.msaaTexture?(v=d.msaaTexture.createView(),m=A):(v=A,m=void 0),h.push({view:v,resolveTarget:m,depthSlice:l})}if(u={textureViews:h},e.depth){var g=this.get(e.depthTexture);u.depthStencilView=g.texture.createView()}a[s]=u,i.width=r.width,i.height=r.height,i.samples=r.samples,i.activeMipmapLevel=e.activeMipmapLevel,i.activeCubeFace=e.activeCubeFace,i.dimensions=r.dimensions}for(var y={colorAttachments:[]},_=0;_<u.textureViews.length;_++){var b=u.textureViews[_],x={r:0,g:0,b:0,a:1};0===_&&n.clearValue&&(x=n.clearValue),y.colorAttachments.push({view:b.view,depthSlice:b.depthSlice,resolveTarget:b.resolveTarget,loadOp:n.loadOp||eV,storeOp:n.storeOp||$z,clearValue:x})}return u.depthStencilView&&(y.depthStencilAttachment={view:u.depthStencilView}),y}},{key:"beginRender",value:function(e){var t,n,r=this.get(e),i=this.device,a=e.occlusionQueryCount;a>0&&(r.currentOcclusionQuerySet&&r.currentOcclusionQuerySet.destroy(),r.currentOcclusionQueryBuffer&&r.currentOcclusionQueryBuffer.destroy(),r.currentOcclusionQuerySet=r.occlusionQuerySet,r.currentOcclusionQueryBuffer=r.occlusionQueryBuffer,r.currentOcclusionQueryObjects=r.occlusionQueryObjects,t=i.createQuerySet({type:"occlusion",count:a,label:"occlusionQuerySet_".concat(e.id)}),r.occlusionQuerySet=t,r.occlusionQueryIndex=0,r.occlusionQueryObjects=new Array(a),r.lastOcclusionObject=null),n=null===e.textures?this._getDefaultRenderPassDescriptor():this._getRenderPassDescriptor(e,{loadOp:eV}),this.initTimestampQuery(e,n),n.occlusionQuerySet=t;var o=n.depthStencilAttachment;if(null!==e.textures)for(var s=n.colorAttachments,u=0;u<s.length;u++){var l=s[u];e.clearColor?(l.clearValue=0===u?e.clearColorValue:{r:0,g:0,b:0,a:1},l.loadOp=tV,l.storeOp=$z):(l.loadOp=eV,l.storeOp=$z)}else{var c=n.colorAttachments[0];e.clearColor?(c.clearValue=e.clearColorValue,c.loadOp=tV,c.storeOp=$z):(c.loadOp=eV,c.storeOp=$z)}e.depth&&(e.clearDepth?(o.depthClearValue=e.clearDepthValue,o.depthLoadOp=tV,o.depthStoreOp=$z):(o.depthLoadOp=eV,o.depthStoreOp=$z)),e.stencil&&(e.clearStencil?(o.stencilClearValue=e.clearStencilValue,o.stencilLoadOp=tV,o.stencilStoreOp=$z):(o.stencilLoadOp=eV,o.stencilStoreOp=$z));var h=i.createCommandEncoder({label:"renderContext_"+e.id}),f=h.beginRenderPass(n);if(r.descriptor=n,r.encoder=h,r.currentPass=f,r.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},r.renderBundles=[],e.viewport&&this.updateViewport(e),e.scissor){var d=e.scissorValue,p=d.x,A=d.y,v=d.width,m=d.height;f.setScissorRect(p,A,v,m)}}},{key:"finishRender",value:function(e){var t=this.get(e),n=e.occlusionQueryCount;if(t.renderBundles.length>0&&t.currentPass.executeBundles(t.renderBundles),n>t.occlusionQueryIndex&&t.currentPass.endOcclusionQuery(),t.currentPass.end(),n>0){var r=8*n,i=this.occludedResolveCache.get(r);void 0===i&&(i=this.device.createBuffer({size:r,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(r,i));var a=this.device.createBuffer({size:r,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});t.encoder.resolveQuerySet(t.occlusionQuerySet,0,n,i,0),t.encoder.copyBufferToBuffer(i,0,a,0,r),t.occlusionQueryBuffer=a,this.resolveOccludedAsync(e)}if(this.device.queue.submit([t.encoder.finish()]),null!==e.textures)for(var o=e.textures,s=0;s<o.length;s++){var u=o[s];!0===u.generateMipmaps&&this.textureUtils.generateMipmaps(u)}}},{key:"isOccluded",value:function(e,t){var n=this.get(e);return n.occluded&&n.occluded.has(t)}},{key:"resolveOccludedAsync",value:function(){var e=lt(ft().mark((function e(t){var n,r,i,a,o,s,u;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.get(t),r=n.currentOcclusionQueryBuffer,i=n.currentOcclusionQueryObjects,!r||!i){e.next=13;break}return a=new WeakSet,n.currentOcclusionQueryObjects=null,n.currentOcclusionQueryBuffer=null,e.next=8,r.mapAsync(GPUMapMode.READ);case 8:for(o=r.getMappedRange(),s=new BigUint64Array(o),u=0;u<i.length;u++)s[u]===BigInt(0)&&a.add(i[u]);r.destroy(),n.occluded=a;case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateViewport",value:function(e){var t=this.get(e).currentPass,n=e.viewportValue,r=n.x,i=n.y,a=n.width,o=n.height,s=n.minDepth,u=n.maxDepth;t.setViewport(r,i,a,o,s,u)}},{key:"getClearColor",value:function(){var e=ht(m(n.prototype),"getClearColor",this).call(this);return!0===this.renderer.alpha&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),e}},{key:"clear",value:function(e,t,n){var r,i,a,o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=this.device,l=this.renderer,c=[];if(e){var h=this.getClearColor();i={r:h.r,g:h.g,b:h.b,a:h.a}}if(null===s){a=l.depth,o=l.stencil;var f=this._getDefaultRenderPassDescriptor();if(e){var d=(c=f.colorAttachments)[0];d.clearValue=i,d.loadOp=tV,d.storeOp=$z}(a||o)&&(r=f.depthStencilAttachment)}else{a=s.depth,o=s.stencil;var p={loadOp:e?tV:eV,clearValue:e?i:void 0};a&&(p.depthLoadOp=t?tV:eV,p.depthClearValue=t?l.getClearDepth():void 0,p.depthStoreOp=$z),o&&(p.stencilLoadOp=n?tV:eV,p.stencilClearValue=n?l.getClearStencil():void 0,p.stencilStoreOp=$z);var A=this._getRenderPassDescriptor(s,p);c=A.colorAttachments,r=A.depthStencilAttachment}a&&r&&void 0===r.depthLoadOp&&(t?(r.depthLoadOp=tV,r.depthClearValue=l.getClearDepth(),r.depthStoreOp=$z):(r.depthLoadOp=eV,r.depthStoreOp=$z)),o&&r&&void 0===r.stencilLoadOp&&(n?(r.stencilLoadOp=tV,r.stencilClearValue=l.getClearStencil(),r.stencilStoreOp=$z):(r.stencilLoadOp=eV,r.stencilStoreOp=$z));var v=u.createCommandEncoder({label:"clear"}),m=v.beginRenderPass({colorAttachments:c,depthStencilAttachment:r});m.end(),u.queue.submit([v.finish()])}},{key:"beginCompute",value:function(e){var t=this.get(e),n={label:"computeGroup_"+e.id};this.initTimestampQuery(e,n),t.cmdEncoderGPU=this.device.createCommandEncoder({label:"computeGroup_"+e.id}),t.passEncoderGPU=t.cmdEncoderGPU.beginComputePass(n)}},{key:"compute",value:function(e,t,n,r){var i=this.get(e).passEncoderGPU,a=this.get(r).pipeline;i.setPipeline(a);for(var o=0,s=n.length;o<s;o++){var u=n[o],l=this.get(u);i.setBindGroup(o,l.group)}var c=this.device.limits.maxComputeWorkgroupsPerDimension,h=this.get(t);void 0===h.dispatchSize&&(h.dispatchSize={x:0,y:1,z:1});var f=h.dispatchSize;t.dispatchCount>c?(f.x=Math.min(t.dispatchCount,c),f.y=Math.ceil(t.dispatchCount/c)):f.x=t.dispatchCount,i.dispatchWorkgroups(f.x,f.y,f.z)}},{key:"finishCompute",value:function(e){var t=this.get(e);t.passEncoderGPU.end(),this.device.queue.submit([t.cmdEncoderGPU.finish()])}},{key:"waitForGPU",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.device.queue.onSubmittedWorkDone();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"draw",value:function(e,t){var n=this,r=e.object,i=e.material,a=e.context,o=e.pipeline,s=e.getBindings(),u=this.get(a),l=this.get(o).pipeline,c=u.currentSets,h=u.currentPass,f=e.getDrawParameters();if(null!==f){c.pipeline!==l&&(h.setPipeline(l),c.pipeline=l);for(var d=c.bindingGroups,p=0,A=s.length;p<A;p++){var v=s[p],m=this.get(v);d[v.index]!==v.id&&(h.setBindGroup(v.index,m.group),d[v.index]=v.id)}var g=e.getIndex(),y=null!==g;if(!0===y&&c.index!==g){var _=this.get(g).buffer,b=g.array instanceof Uint16Array?oV:sV;h.setIndexBuffer(_,b),c.index=g}for(var x=e.getVertexBuffers(),w=0,T=x.length;w<T;w++){var S=x[w];if(c.attributes[w]!==S){var E=this.get(S).buffer;h.setVertexBuffer(w,E),c.attributes[w]=S}}if(void 0!==u.occlusionQuerySet){var k=u.lastOcclusionObject;k!==r&&(null!==k&&!0===k.occlusionTest&&(h.endOcclusionQuery(),u.occlusionQueryIndex++),!0===r.occlusionTest&&(h.beginOcclusionQuery(u.occlusionQueryIndex),u.occlusionQueryObjects[u.occlusionQueryIndex]=r),u.lastOcclusionObject=r)}!0===a.stencil&&!0===i.stencilWrite&&u.currentStencilRef!==i.stencilRef&&(h.setStencilReference(i.stencilRef),u.currentStencilRef=i.stencilRef);var M=function(){if(!0===r.isBatchedMesh){var i=r._multiDrawStarts,a=r._multiDrawCounts,o=r._multiDrawCount,s=r._multiDrawInstances;null!==s&&kr("THREE.WebGPUBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection.");for(var u=0;u<o;u++){var l=s?s[u]:1,c=l>1?0:u;!0===y?h.drawIndexed(a[u],l,i[u]/g.array.BYTES_PER_ELEMENT,0,c):h.draw(a[u],l,i[u],c),t.update(r,a[u],l)}}else if(!0===y){var d=f.vertexCount,p=f.instanceCount,A=f.firstVertex,v=e.getIndirect();if(null!==v){var m=n.get(v).buffer;h.drawIndexedIndirect(m,0)}else h.drawIndexed(d,p,A,0,0);t.update(r,d,p)}else{var _=f.vertexCount,b=f.instanceCount,x=f.firstVertex,w=e.getIndirect();if(null!==w){var T=n.get(w).buffer;h.drawIndirect(T,0)}else h.draw(_,b,x,0);t.update(r,_,b)}};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){var C=this.get(e.camera),R=e.camera.cameras,P=e.getBindingGroup("cameraIndex");if(void 0===C.indexesGPU||C.indexesGPU.length!==R.length){for(var N=this.get(P),I=[],L=new Uint32Array([0,0,0,0]),D=0,O=R.length;D<O;D++){L[0]=D;var U=this.bindingUtils.createBindGroupIndex(L,N.layout);I.push(U)}C.indexesGPU=I}for(var B=this.renderer.getPixelRatio(),F=0,z=R.length;F<z;F++){var V=R[F];if(r.layers.test(V.layers)){var q=V.viewport;h.setViewport(Math.floor(q.x*B),Math.floor(q.y*B),Math.floor(q.width*B),Math.floor(q.height*B),a.viewportValue.minDepth,a.viewportValue.maxDepth),h.setBindGroup(P.index,C.indexesGPU[F]),M()}}}else M()}}},{key:"needsRenderUpdate",value:function(e){var t=this.get(e),n=e.object,r=e.material,i=this.utils,a=i.getSampleCountRenderContext(e.context),o=i.getCurrentColorSpace(e.context),s=i.getCurrentColorFormat(e.context),u=i.getCurrentDepthStencilFormat(e.context),l=i.getPrimitiveTopology(n,r),c=!1;return t.material===r&&t.materialVersion===r.version&&t.transparent===r.transparent&&t.blending===r.blending&&t.premultipliedAlpha===r.premultipliedAlpha&&t.blendSrc===r.blendSrc&&t.blendDst===r.blendDst&&t.blendEquation===r.blendEquation&&t.blendSrcAlpha===r.blendSrcAlpha&&t.blendDstAlpha===r.blendDstAlpha&&t.blendEquationAlpha===r.blendEquationAlpha&&t.colorWrite===r.colorWrite&&t.depthWrite===r.depthWrite&&t.depthTest===r.depthTest&&t.depthFunc===r.depthFunc&&t.stencilWrite===r.stencilWrite&&t.stencilFunc===r.stencilFunc&&t.stencilFail===r.stencilFail&&t.stencilZFail===r.stencilZFail&&t.stencilZPass===r.stencilZPass&&t.stencilFuncMask===r.stencilFuncMask&&t.stencilWriteMask===r.stencilWriteMask&&t.side===r.side&&t.alphaToCoverage===r.alphaToCoverage&&t.sampleCount===a&&t.colorSpace===o&&t.colorFormat===s&&t.depthStencilFormat===u&&t.primitiveTopology===l&&t.clippingContextCacheKey===e.clippingContextCacheKey||(t.material=r,t.materialVersion=r.version,t.transparent=r.transparent,t.blending=r.blending,t.premultipliedAlpha=r.premultipliedAlpha,t.blendSrc=r.blendSrc,t.blendDst=r.blendDst,t.blendEquation=r.blendEquation,t.blendSrcAlpha=r.blendSrcAlpha,t.blendDstAlpha=r.blendDstAlpha,t.blendEquationAlpha=r.blendEquationAlpha,t.colorWrite=r.colorWrite,t.depthWrite=r.depthWrite,t.depthTest=r.depthTest,t.depthFunc=r.depthFunc,t.stencilWrite=r.stencilWrite,t.stencilFunc=r.stencilFunc,t.stencilFail=r.stencilFail,t.stencilZFail=r.stencilZFail,t.stencilZPass=r.stencilZPass,t.stencilFuncMask=r.stencilFuncMask,t.stencilWriteMask=r.stencilWriteMask,t.side=r.side,t.alphaToCoverage=r.alphaToCoverage,t.sampleCount=a,t.colorSpace=o,t.colorFormat=s,t.depthStencilFormat=u,t.primitiveTopology=l,t.clippingContextCacheKey=e.clippingContextCacheKey,c=!0),c}},{key:"getRenderCacheKey",value:function(e){var t=e.object,n=e.material,r=this.utils,i=e.context;return[n.transparent,n.blending,n.premultipliedAlpha,n.blendSrc,n.blendDst,n.blendEquation,n.blendSrcAlpha,n.blendDstAlpha,n.blendEquationAlpha,n.colorWrite,n.depthWrite,n.depthTest,n.depthFunc,n.stencilWrite,n.stencilFunc,n.stencilFail,n.stencilZFail,n.stencilZPass,n.stencilFuncMask,n.stencilWriteMask,n.side,r.getSampleCountRenderContext(i),r.getCurrentColorSpace(i),r.getCurrentColorFormat(i),r.getCurrentDepthStencilFormat(i),r.getPrimitiveTopology(t,n),e.getGeometryCacheKey(),e.clippingContextCacheKey].join()}},{key:"createSampler",value:function(e){this.textureUtils.createSampler(e)}},{key:"destroySampler",value:function(e){this.textureUtils.destroySampler(e)}},{key:"createDefaultTexture",value:function(e){this.textureUtils.createDefaultTexture(e)}},{key:"createTexture",value:function(e,t){this.textureUtils.createTexture(e,t)}},{key:"updateTexture",value:function(e,t){this.textureUtils.updateTexture(e,t)}},{key:"generateMipmaps",value:function(e){this.textureUtils.generateMipmaps(e)}},{key:"destroyTexture",value:function(e){this.textureUtils.destroyTexture(e)}},{key:"copyTextureToBuffer",value:function(){var e=lt(ft().mark((function e(t,n,r,i,a,o){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.textureUtils.copyTextureToBuffer(t,n,r,i,a,o));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i,a,o){return e.apply(this,arguments)}}()},{key:"initTimestampQuery",value:function(e,t){if(this.trackTimestamp){var n=e.isComputeNode?"compute":"render";this.timestampQueryPool[n]||(this.timestampQueryPool[n]=new kG(this.device,n,2048));var r=this.timestampQueryPool[n],i=r.allocateQueriesForContext(e);t.timestampWrites={querySet:r.querySet,beginningOfPassWriteIndex:i,endOfPassWriteIndex:i+1}}}},{key:"createNodeBuilder",value:function(e,t){return new yG(e,t)}},{key:"createProgram",value:function(e){this.get(e).module={module:this.device.createShaderModule({code:e.code,label:e.stage+(""!==e.name?"_".concat(e.name):"")}),entryPoint:"main"}}},{key:"destroyProgram",value:function(e){this.delete(e)}},{key:"createRenderPipeline",value:function(e,t){this.pipelineUtils.createRenderPipeline(e,t)}},{key:"createComputePipeline",value:function(e,t){this.pipelineUtils.createComputePipeline(e,t)}},{key:"beginBundle",value:function(e){var t=this.get(e);t._currentPass=t.currentPass,t._currentSets=t.currentSets,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.currentPass=this.pipelineUtils.createBundleEncoder(e)}},{key:"finishBundle",value:function(e,t){var n=this.get(e),r=n.currentPass.finish();this.get(t).bundleGPU=r,n.currentSets=n._currentSets,n.currentPass=n._currentPass}},{key:"addBundle",value:function(e,t){this.get(e).renderBundles.push(this.get(t).bundleGPU)}},{key:"createBindings",value:function(e,t,n,r){this.bindingUtils.createBindings(e,t,n,r)}},{key:"updateBindings",value:function(e,t,n,r){this.bindingUtils.createBindings(e,t,n,r)}},{key:"updateBinding",value:function(e){this.bindingUtils.updateBinding(e)}},{key:"createIndexAttribute",value:function(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}},{key:"createAttribute",value:function(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}},{key:"createStorageAttribute",value:function(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}},{key:"createIndirectStorageAttribute",value:function(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}},{key:"updateAttribute",value:function(e){this.attributeUtils.updateAttribute(e)}},{key:"destroyAttribute",value:function(e){this.attributeUtils.destroyAttribute(e)}},{key:"updateSize",value:function(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}},{key:"getMaxAnisotropy",value:function(){return 16}},{key:"hasFeature",value:function(e){return this.device.features.has(e)}},{key:"copyTextureToTexture",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=0,s=0,u=0,l=0,c=0,h=0,f=e.image.width,d=e.image.height,p=1;null!==n&&(!0===n.isBox3?(l=n.min.x,c=n.min.y,h=n.min.z,f=n.max.x-n.min.x,d=n.max.y-n.min.y,p=n.max.z-n.min.z):(l=n.min.x,c=n.min.y,f=n.max.x-n.min.x,d=n.max.y-n.min.y,p=1)),null!==r&&(o=r.x,s=r.y,u=r.z||0);var A=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+t.id}),v=this.get(e).texture,m=this.get(t).texture;A.copyTextureToTexture({texture:v,mipLevel:i,origin:{x:l,y:c,z:h}},{texture:m,mipLevel:a,origin:{x:o,y:s,z:u}},[f,d,p]),this.device.queue.submit([A.finish()]),0===a&&t.generateMipmaps&&this.textureUtils.generateMipmaps(t)}},{key:"copyFramebufferToTexture",value:function(e,t,n){var r=this.get(t),i=null;i=t.renderTarget?e.isDepthTexture?this.get(t.depthTexture).texture:this.get(t.textures[0]).texture:e.isDepthTexture?this.textureUtils.getDepthBuffer(t.depth,t.stencil):this.context.getCurrentTexture();var a,o=this.get(e).texture;if(i.format===o.format)if(r.currentPass?(r.currentPass.end(),a=r.encoder):a=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),a.copyTextureToTexture({texture:i,origin:[n.x,n.y,0]},{texture:o},[n.z,n.w]),e.generateMipmaps&&this.textureUtils.generateMipmaps(e),r.currentPass){for(var s=r.descriptor,u=0;u<s.colorAttachments.length;u++)s.colorAttachments[u].loadOp=eV;if(t.depth&&(s.depthStencilAttachment.depthLoadOp=eV),t.stencil&&(s.depthStencilAttachment.stencilLoadOp=eV),r.currentPass=a.beginRenderPass(s),r.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.viewport&&this.updateViewport(t),t.scissor){var l=t.scissorValue,c=l.x,h=l.y,f=l.width,d=l.height;r.currentPass.setScissorRect(c,h,f,d)}}else this.device.queue.submit([a.finish()]);else console.error("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",i.format,o.format)}}]),n}(Sz),CG=function(e){v(n,e);var t=b(n);function n(e,r,i,a,o,s){var u;return c(this,n),(u=t.call(this,e,r,i,a,o,s)).iesMap=null,u}return p(n,[{key:"copy",value:function(e,t){return ht(m(n.prototype),"copy",this).call(this,e,t),this.iesMap=e.iesMap,this}}]),n}(Ku),RG=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this)).addMaterial(zR,"MeshPhongMaterial"),e.addMaterial(kN,"MeshStandardMaterial"),e.addMaterial(CN,"MeshPhysicalMaterial"),e.addMaterial(IN,"MeshToonMaterial"),e.addMaterial(PR,"MeshBasicMaterial"),e.addMaterial(BR,"MeshLambertMaterial"),e.addMaterial(gR,"MeshNormalMaterial"),e.addMaterial(UN,"MeshMatcapMaterial"),e.addMaterial(cR,"LineBasicMaterial"),e.addMaterial(fR,"LineDashedMaterial"),e.addMaterial(qN,"PointsMaterial"),e.addMaterial(zN,"SpriteMaterial"),e.addMaterial(HN,"ShadowMaterial"),e.addLight($O,tl),e.addLight(sF,il),e.addLight(hF,ol),e.addLight(fF,Ku),e.addLight(pF,al),e.addLight(AF,Gu),e.addLight(vF,ul),e.addLight(dF,CG),e.addToneMapping(mD,1),e.addToneMapping(gD,2),e.addToneMapping(yD,3),e.addToneMapping(bD,4),e.addToneMapping(SD,6),e.addToneMapping(ED,7),e}return p(n)}(IF),PG=function(e){v(n,e);var t=b(n);function n(){var e,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,n),i.forceWebGL?r=Fz:(r=MG,i.getFallback=function(){return console.warn("THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new Fz(i)});var a=new r(i);return(e=t.call(this,a,i)).library=new RG,e.isWebGPURenderer=!0,e}return p(n)}($F),NG=(TB.BRDF_GGX,TB.BRDF_Lambert,TB.BasicShadowFilter,TB.Break,TB.Continue,TB.DFGApprox,TB.D_GGX,TB.Discard,TB.EPSILON,TB.F_Schlick,TB.Fn),IG=(TB.INFINITY,TB.If),LG=TB.Loop,DG=(TB.NodeShaderStage,TB.NodeType,TB.NodeUpdateType,TB.NodeAccess,TB.PCFShadowFilter,TB.PCFSoftShadowFilter,TB.PI,TB.PI2,TB.Return,TB.Schlick_to_F0,TB.ScriptableNodeResources,TB.ShaderNode,TB.TBNViewMatrix,TB.VSMShadowFilter,TB.V_GGX_SmithCorrelated,TB.abs,TB.acesFilmicToneMapping,TB.acos,TB.add,TB.addNodeElement,TB.agxToneMapping,TB.all,TB.alphaT,TB.and,TB.anisotropy,TB.anisotropyB,TB.anisotropyT,TB.any,TB.append,TB.array,TB.arrayBuffer,TB.asin),OG=(TB.assign,TB.atan,TB.atan2,TB.atomicAdd,TB.atomicAnd,TB.atomicFunc,TB.atomicMax,TB.atomicMin,TB.atomicOr,TB.atomicStore,TB.atomicSub,TB.atomicXor,TB.atomicLoad,TB.attenuationColor,TB.attenuationDistance,TB.attribute,TB.attributeArray,TB.backgroundBlurriness,TB.backgroundIntensity,TB.backgroundRotation,TB.batch,TB.billboarding,TB.bitAnd,TB.bitNot,TB.bitOr,TB.bitXor,TB.bitangentGeometry,TB.bitangentLocal,TB.bitangentView,TB.bitangentWorld,TB.bitcast,TB.blendBurn,TB.blendColor,TB.blendDodge,TB.blendOverlay,TB.blendScreen,TB.blur,TB.bool,TB.buffer,TB.bufferAttribute,TB.bumpMap,TB.burn,TB.bvec2,TB.bvec3,TB.bvec4,TB.bypass,TB.cache,TB.call,TB.cameraFar,TB.cameraIndex,TB.cameraNear,TB.cameraNormalMatrix,TB.cameraPosition,TB.cameraProjectionMatrix,TB.cameraProjectionMatrixInverse,TB.cameraViewMatrix,TB.cameraWorldMatrix,TB.cbrt,TB.cdl,TB.ceil,TB.checker,TB.cineonToneMapping,TB.clamp,TB.clearcoat,TB.clearcoatRoughness,TB.code,TB.color,TB.colorSpaceToWorking,TB.colorToDirection,TB.compute,TB.computeSkinning,TB.cond,TB.Const,TB.context,TB.convert,TB.convertColorSpace,TB.convertToTexture,TB.cos),UG=(TB.cross,TB.cubeTexture,TB.dFdx,TB.dFdy,TB.dashSize,TB.debug,TB.defaultBuildStages,TB.defaultShaderStages,TB.defined,TB.degrees,TB.deltaTime,TB.densityFog,TB.densityFogFactor,TB.depth,TB.depthPass,TB.difference,TB.diffuseColor,TB.directPointLight,TB.directionToColor,TB.dispersion,TB.distance,TB.div,TB.dodge,TB.dot,TB.drawIndex,TB.dynamicBufferAttribute,TB.element,TB.emissive,TB.equal,TB.equals,TB.equirectUV,TB.exp),BG=(TB.exp2,TB.expression,TB.faceDirection,TB.faceForward,TB.faceforward,TB.float),FG=(TB.floor,TB.fog,TB.fract,TB.frameGroup,TB.frameId,TB.frontFacing,TB.fwidth,TB.gain,TB.gapSize,TB.getConstNodeType,TB.getCurrentStack,TB.getDirection,TB.getDistanceAttenuation,TB.getGeometryRoughness,TB.getNormalFromDepth,TB.getParallaxCorrectNormal,TB.getRoughness,TB.getScreenPosition,TB.getShIrradianceAt,TB.getTextureIndex,TB.getViewPosition,TB.glsl,TB.glslFn,TB.grayscale,TB.greaterThan,TB.greaterThanEqual,TB.hash,TB.highpModelNormalViewMatrix,TB.highpModelViewMatrix,TB.hue,TB.instance,TB.instanceIndex),zG=(TB.instancedArray,TB.instancedBufferAttribute,TB.instancedDynamicBufferAttribute,TB.instancedMesh,TB.int,TB.inverseSqrt,TB.inversesqrt,TB.invocationLocalIndex,TB.invocationSubgroupIndex,TB.ior,TB.iridescence,TB.iridescenceIOR,TB.iridescenceThickness,TB.ivec2,TB.ivec3,TB.ivec4,TB.js,TB.label,TB.length,TB.lengthSq,TB.lessThan,TB.lessThanEqual,TB.lightPosition,TB.lightTargetDirection,TB.lightTargetPosition,TB.lightViewPosition,TB.lightingContext,TB.lights,TB.linearDepth,TB.linearToneMapping,TB.localId,TB.globalId,TB.log,TB.log2,TB.logarithmicDepthToViewZ,TB.loop,TB.luminance,TB.mediumpModelViewMatrix,TB.mat2,TB.mat3,TB.mat4,TB.matcapUV,TB.materialAO,TB.materialAlphaTest,TB.materialAnisotropy,TB.materialAnisotropyVector,TB.materialAttenuationColor,TB.materialAttenuationDistance,TB.materialClearcoat,TB.materialClearcoatNormal,TB.materialClearcoatRoughness,TB.materialColor,TB.materialDispersion,TB.materialEmissive,TB.materialIOR,TB.materialIridescence,TB.materialIridescenceIOR,TB.materialIridescenceThickness,TB.materialLightMap,TB.materialLineDashOffset,TB.materialLineDashSize,TB.materialLineGapSize,TB.materialLineScale,TB.materialLineWidth,TB.materialMetalness,TB.materialNormal,TB.materialOpacity,TB.materialPointSize,TB.materialReference,TB.materialReflectivity,TB.materialRefractionRatio,TB.materialRotation,TB.materialRoughness,TB.materialSheen,TB.materialSheenRoughness,TB.materialShininess,TB.materialSpecular,TB.materialSpecularColor,TB.materialSpecularIntensity,TB.materialSpecularStrength,TB.materialThickness,TB.materialTransmission,TB.max,TB.maxMipLevel,TB.metalness,TB.min,TB.mix,TB.mixElement,TB.mod,TB.modInt,TB.modelDirection,TB.modelNormalMatrix,TB.modelPosition,TB.modelRadius,TB.modelScale,TB.modelViewMatrix,TB.modelViewPosition,TB.modelViewProjection,TB.modelWorldMatrix,TB.modelWorldMatrixInverse,TB.morphReference,TB.mrt,TB.mul,TB.mx_aastep,TB.mx_cell_noise_float,TB.mx_contrast,TB.mx_fractal_noise_float,TB.mx_fractal_noise_vec2,TB.mx_fractal_noise_vec3,TB.mx_fractal_noise_vec4,TB.mx_hsvtorgb,TB.mx_noise_float,TB.mx_noise_vec3,TB.mx_noise_vec4,TB.mx_ramplr,TB.mx_ramptb,TB.mx_rgbtohsv,TB.mx_safepower,TB.mx_splitlr,TB.mx_splittb,TB.mx_srgb_texture_to_lin_rec709,TB.mx_transform_uv,TB.mx_worley_noise_float,TB.mx_worley_noise_vec2,TB.mx_worley_noise_vec3,TB.negate),VG=(TB.neutralToneMapping,TB.nodeArray,TB.nodeImmutable,TB.nodeObject,TB.nodeObjects,TB.nodeProxy,TB.normalFlat,TB.normalGeometry,TB.normalLocal,TB.normalMap,TB.normalView,TB.normalWorld,TB.normalize,TB.not,TB.notEqual,TB.numWorkgroups,TB.objectDirection,TB.objectGroup,TB.objectPosition,TB.objectRadius,TB.objectScale,TB.objectViewPosition,TB.objectWorldMatrix,TB.oneMinus,TB.or,TB.orthographicDepthToViewZ,TB.oscSawtooth,TB.oscSine,TB.oscSquare,TB.oscTriangle,TB.output,TB.outputStruct,TB.overlay,TB.overloadingFn,TB.parabola,TB.parallaxDirection,TB.parallaxUV,TB.parameter,TB.pass,TB.passTexture,TB.pcurve,TB.perspectiveDepthToViewZ,TB.pmremTexture,TB.pointUV,TB.pointWidth,TB.positionGeometry,TB.positionLocal,TB.positionPrevious,TB.positionView,TB.positionViewDirection,TB.positionWorld,TB.positionWorldDirection,TB.posterize,TB.pow,TB.pow2,TB.pow3,TB.pow4,TB.property,TB.radians,TB.rand,TB.range,TB.rangeFog,TB.rangeFogFactor,TB.reciprocal,TB.lightProjectionUV,TB.reference,TB.referenceBuffer,TB.reflect,TB.reflectVector,TB.reflectView,TB.reflector,TB.refract,TB.refractVector,TB.refractView,TB.reinhardToneMapping,TB.remainder,TB.remap,TB.remapClamp,TB.renderGroup,TB.renderOutput,TB.rendererReference,TB.rotate,TB.rotateUV,TB.roughness,TB.round,TB.rtt,TB.sRGBTransferEOTF,TB.sRGBTransferOETF,TB.sampler,TB.samplerComparison,TB.saturate,TB.saturation,TB.screen,TB.screenCoordinate,TB.screenSize,TB.screenUV,TB.scriptable,TB.scriptableValue,TB.select,TB.setCurrentStack,TB.shaderStages,TB.shadow,TB.pointShadow,TB.shadowPositionWorld,TB.sharedUniformGroup,TB.shapeCircle,TB.sheen,TB.sheenRoughness,TB.shiftLeft,TB.shiftRight,TB.shininess,TB.sign,TB.sin),qG=(TB.sinc,TB.skinning,TB.smoothstep,TB.smoothstepElement,TB.specularColor,TB.specularF90,TB.spherizeUV,TB.split,TB.spritesheetUV,TB.sqrt),jG=(TB.stack,TB.step,TB.storage),GG=(TB.storageBarrier,TB.storageObject,TB.storageTexture,TB.string,TB.struct,TB.sub,TB.subgroupIndex,TB.subgroupSize,TB.tan,TB.tangentGeometry,TB.tangentLocal,TB.tangentView,TB.tangentWorld,TB.temp,TB.texture,TB.texture3D,TB.textureBarrier,TB.textureBicubic,TB.textureCubeUV,TB.textureLoad,TB.textureSize,TB.textureStore,TB.thickness,TB.threshold,TB.time,TB.timerDelta,TB.timerGlobal,TB.timerLocal,TB.toOutputColorSpace,TB.toWorkingColorSpace,TB.toneMapping,TB.toneMappingExposure,TB.toonOutlinePass,TB.transformDirection,TB.transformNormal,TB.transformNormalToView,TB.transformedBentNormalView,TB.transformedBitangentView,TB.transformedBitangentWorld,TB.transformedClearcoatNormalView,TB.transformedNormalView,TB.transformedNormalWorld,TB.transformedTangentView,TB.transformedTangentWorld,TB.transmission,TB.transpose,TB.tri,TB.tri3,TB.triNoise3D,TB.triplanarTexture,TB.triplanarTextures,TB.trunc,TB.tslFn,TB.uint,TB.uniform),HG=(TB.uniformArray,TB.uniformGroup,TB.uniforms,TB.userData,TB.uv,TB.uvec2,TB.uvec3,TB.uvec4,TB.Var,TB.varying,TB.varyingProperty,TB.vec2,TB.vec3,TB.vec4,TB.vectorComponents,TB.velocity,TB.vertexColor,TB.vertexIndex,TB.vibrance,TB.viewZToLogarithmicDepth,TB.viewZToOrthographicDepth,TB.viewZToPerspectiveDepth,TB.viewport,TB.viewportBottomLeft,TB.viewportCoordinate,TB.viewportDepthTexture,TB.viewportLinearDepth,TB.viewportMipTexture,TB.viewportResolution,TB.viewportSafeUV,TB.viewportSharedTexture,TB.viewportSize,TB.viewportTexture,TB.viewportTopLeft,TB.viewportUV,TB.wgsl,TB.wgslFn,TB.workgroupArray,TB.workgroupBarrier,TB.workgroupId,TB.workingToColorSpace,TB.xor,new $r),WG=new Kr,XG=function(e){v(n,e);var t=b(n);function n(){var e;c(this,n),(e=t.call(this)).isLineSegmentsGeometry=!0,e.type="LineSegmentsGeometry";return e.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),e.setAttribute("position",new La([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),e.setAttribute("uv",new La([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2)),e}return p(n,[{key:"applyMatrix4",value:function(e){var t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}},{key:"setPositions",value:function(e){var t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));var n=new bl(t,6,1);return this.setAttribute("instanceStart",new To(n,3,0)),this.setAttribute("instanceEnd",new To(n,3,3)),this.instanceCount=this.attributes.instanceStart.count,this.computeBoundingBox(),this.computeBoundingSphere(),this}},{key:"setColors",value:function(e){var t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));var n=new bl(t,6,1);return this.setAttribute("instanceColorStart",new To(n,3,0)),this.setAttribute("instanceColorEnd",new To(n,3,3)),this}},{key:"fromWireframeGeometry",value:function(e){return this.setPositions(e.attributes.position.array),this}},{key:"fromEdgesGeometry",value:function(e){return this.setPositions(e.attributes.position.array),this}},{key:"fromMesh",value:function(e){return this.fromWireframeGeometry(new cu(e.geometry)),this}},{key:"fromLineSegments",value:function(e){var t=e.geometry;return this.setPositions(t.attributes.position.array),this}},{key:"computeBoundingBox",value:function(){null===this.boundingBox&&(this.boundingBox=new $r);var e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),HG.setFromBufferAttribute(t),this.boundingBox.union(HG))}},{key:"computeBoundingSphere",value:function(){null===this.boundingSphere&&(this.boundingSphere=new mi),null===this.boundingBox&&this.computeBoundingBox();var e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){var n=this.boundingSphere.center;this.boundingBox.getCenter(n);for(var r=0,i=0,a=e.count;i<a;i++)WG.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(WG)),WG.fromBufferAttribute(t,i),r=Math.max(r,n.distanceToSquared(WG));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}},{key:"toJSON",value:function(){}}]),n}(ll);function QG(){var e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function YG(e){var t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);var r=t.get(n);r&&(e.deleteBuffer(r.buffer),t.delete(n))},update:function(n,r){if(n.isInterleavedBufferAttribute&&(n=n.data),n.isGLBufferAttribute){var i=t.get(n);(!i||i.version<n.version)&&t.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version})}else{var a=t.get(n);if(void 0===a)t.set(n,function(t,n){var r,i=t.array,a=t.usage,o=i.byteLength,s=e.createBuffer();if(e.bindBuffer(n,s),e.bufferData(n,i,a),t.onUploadCallback(),i instanceof Float32Array)r=e.FLOAT;else if(i instanceof Uint16Array)r=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(i instanceof Int16Array)r=e.SHORT;else if(i instanceof Uint32Array)r=e.UNSIGNED_INT;else if(i instanceof Int32Array)r=e.INT;else if(i instanceof Int8Array)r=e.BYTE;else if(i instanceof Uint8Array)r=e.UNSIGNED_BYTE;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);r=e.UNSIGNED_BYTE}return{buffer:s,type:r,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version,size:o}}(n,r));else if(a.version<n.version){if(a.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,n,r){var i=n.array,a=n.updateRanges;if(e.bindBuffer(r,t),0===a.length)e.bufferSubData(r,0,i);else{a.sort((function(e,t){return e.start-t.start}));for(var o=0,s=1;s<a.length;s++){var u=a[o],l=a[s];l.start<=u.start+u.count+1?u.count=Math.max(u.count,l.start+l.count-u.start):a[++o]=l}a.length=o+1;for(var c=0,h=a.length;c<h;c++){var f=a[c];e.bufferSubData(r,f.start*i.BYTES_PER_ELEMENT,i,f.start,f.count)}n.clearUpdateRanges()}n.onUploadCallback()}(a.buffer,n,r),a.version=n.version}}}}}var KG={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},ZG={common:{diffuse:{value:new ga(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new br},alphaMap:{value:null},alphaMapTransform:{value:new br},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new br}},envmap:{envMap:{value:null},envMapRotation:{value:new br},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new br}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new br}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new br},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new br},normalScale:{value:new _r(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new br},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new br}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new br}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new br}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ga(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ga(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new br},alphaTest:{value:0},uvTransform:{value:new br}},sprite:{diffuse:{value:new ga(16777215)},opacity:{value:1},center:{value:new _r(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new br},alphaMap:{value:null},alphaMapTransform:{value:new br},alphaTest:{value:0}}},JG={basic:{uniforms:io([ZG.common,ZG.specularmap,ZG.envmap,ZG.aomap,ZG.lightmap,ZG.fog]),vertexShader:KG.meshbasic_vert,fragmentShader:KG.meshbasic_frag},lambert:{uniforms:io([ZG.common,ZG.specularmap,ZG.envmap,ZG.aomap,ZG.lightmap,ZG.emissivemap,ZG.bumpmap,ZG.normalmap,ZG.displacementmap,ZG.fog,ZG.lights,{emissive:{value:new ga(0)}}]),vertexShader:KG.meshlambert_vert,fragmentShader:KG.meshlambert_frag},phong:{uniforms:io([ZG.common,ZG.specularmap,ZG.envmap,ZG.aomap,ZG.lightmap,ZG.emissivemap,ZG.bumpmap,ZG.normalmap,ZG.displacementmap,ZG.fog,ZG.lights,{emissive:{value:new ga(0)},specular:{value:new ga(1118481)},shininess:{value:30}}]),vertexShader:KG.meshphong_vert,fragmentShader:KG.meshphong_frag},standard:{uniforms:io([ZG.common,ZG.envmap,ZG.aomap,ZG.lightmap,ZG.emissivemap,ZG.bumpmap,ZG.normalmap,ZG.displacementmap,ZG.roughnessmap,ZG.metalnessmap,ZG.fog,ZG.lights,{emissive:{value:new ga(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:KG.meshphysical_vert,fragmentShader:KG.meshphysical_frag},toon:{uniforms:io([ZG.common,ZG.aomap,ZG.lightmap,ZG.emissivemap,ZG.bumpmap,ZG.normalmap,ZG.displacementmap,ZG.gradientmap,ZG.fog,ZG.lights,{emissive:{value:new ga(0)}}]),vertexShader:KG.meshtoon_vert,fragmentShader:KG.meshtoon_frag},matcap:{uniforms:io([ZG.common,ZG.bumpmap,ZG.normalmap,ZG.displacementmap,ZG.fog,{matcap:{value:null}}]),vertexShader:KG.meshmatcap_vert,fragmentShader:KG.meshmatcap_frag},points:{uniforms:io([ZG.points,ZG.fog]),vertexShader:KG.points_vert,fragmentShader:KG.points_frag},dashed:{uniforms:io([ZG.common,ZG.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:KG.linedashed_vert,fragmentShader:KG.linedashed_frag},depth:{uniforms:io([ZG.common,ZG.displacementmap]),vertexShader:KG.depth_vert,fragmentShader:KG.depth_frag},normal:{uniforms:io([ZG.common,ZG.bumpmap,ZG.normalmap,ZG.displacementmap,{opacity:{value:1}}]),vertexShader:KG.meshnormal_vert,fragmentShader:KG.meshnormal_frag},sprite:{uniforms:io([ZG.sprite,ZG.fog]),vertexShader:KG.sprite_vert,fragmentShader:KG.sprite_frag},background:{uniforms:{uvTransform:{value:new br},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:KG.background_vert,fragmentShader:KG.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new br}},vertexShader:KG.backgroundCube_vert,fragmentShader:KG.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:KG.cube_vert,fragmentShader:KG.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:KG.equirect_vert,fragmentShader:KG.equirect_frag},distanceRGBA:{uniforms:io([ZG.common,ZG.displacementmap,{referencePosition:{value:new Kr},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:KG.distanceRGBA_vert,fragmentShader:KG.distanceRGBA_frag},shadow:{uniforms:io([ZG.lights,ZG.fog,{color:{value:new ga(0)},opacity:{value:1}}]),vertexShader:KG.shadow_vert,fragmentShader:KG.shadow_frag}};JG.physical={uniforms:io([JG.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new br},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new br},clearcoatNormalScale:{value:new _r(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new br},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new br},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new br},sheen:{value:0},sheenColor:{value:new ga(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new br},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new br},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new br},transmissionSamplerSize:{value:new _r},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new br},attenuationDistance:{value:0},attenuationColor:{value:new ga(0)},specularColor:{value:new ga(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new br},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new br},anisotropyVector:{value:new _r},anisotropyMap:{value:null},anisotropyMapTransform:{value:new br}}]),vertexShader:KG.meshphysical_vert,fragmentShader:KG.meshphysical_frag};var $G={r:0,b:0,g:0},eH=new Oi,tH=new Ei;function nH(e,t,n,r,i,a,o){var s,u,l=new ga(0),c=!0===a?0:1,h=null,f=0,d=null;function p(e){var r=!0===e.isScene?e.background:null;r&&r.isTexture&&(r=(e.backgroundBlurriness>0?n:t).get(r));return r}function A(t,n){t.getRGB($G,ao(e)),r.buffers.color.setClear($G.r,$G.g,$G.b,n,o)}return{getClearColor:function(){return l},setClearColor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;l.set(e),A(l,c=t)},getClearAlpha:function(){return c},setClearAlpha:function(e){A(l,c=e)},render:function(t){var n=!1,i=p(t);null===i?A(l,c):i&&i.isColor&&(A(i,1),n=!0);var a=e.xr.getEnvironmentBlendMode();"additive"===a?r.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===a&&r.buffers.color.setClear(0,0,0,0,o),(e.autoClear||n)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))},addToRenderList:function(t,n){var r=p(n);r&&(r.isCubeTexture||r.mapping===Rt)?(void 0===u&&((u=new eo(new no(1,1,1),new so({name:"BackgroundCubeMaterial",uniforms:ro(JG.backgroundCube.uniforms),vertexShader:JG.backgroundCube.vertexShader,fragmentShader:JG.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1}))).geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(u)),eH.copy(n.backgroundRotation),eH.x*=-1,eH.y*=-1,eH.z*=-1,r.isCubeTexture&&!1===r.isRenderTargetTexture&&(eH.y*=-1,eH.z*=-1),u.material.uniforms.envMap.value=r,u.material.uniforms.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(tH.makeRotationFromEuler(eH)),u.material.toneMapped=Dr.getTransfer(r.colorSpace)!==$n,h===r&&f===r.version&&d===e.toneMapping||(u.material.needsUpdate=!0,h=r,f=r.version,d=e.toneMapping),u.layers.enableAll(),t.unshift(u,u.geometry,u.material,0,0,null)):r&&r.isTexture&&(void 0===s&&((s=new eo(new su(2,2),new so({name:"BackgroundMaterial",uniforms:ro(JG.background.uniforms),vertexShader:JG.background.vertexShader,fragmentShader:JG.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(s)),s.material.uniforms.t2D.value=r,s.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,s.material.toneMapped=Dr.getTransfer(r.colorSpace)!==$n,!0===r.matrixAutoUpdate&&r.updateMatrix(),s.material.uniforms.uvTransform.value.copy(r.matrix),h===r&&f===r.version&&d===e.toneMapping||(s.material.needsUpdate=!0,h=r,f=r.version,d=e.toneMapping),s.layers.enableAll(),t.unshift(s,s.geometry,s.material,0,0,null))},dispose:function(){void 0!==u&&(u.geometry.dispose(),u.material.dispose(),u=void 0),void 0!==s&&(s.geometry.dispose(),s.material.dispose(),s=void 0)}}}function rH(e,t){var n=e.getParameter(e.MAX_VERTEX_ATTRIBS),r={},i=l(null),a=i,o=!1;function s(t){return e.bindVertexArray(t)}function u(t){return e.deleteVertexArray(t)}function l(e){for(var t=[],r=[],i=[],a=0;a<n;a++)t[a]=0,r[a]=0,i[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:i,object:e,attributes:{},index:null}}function c(){for(var e=a.newAttributes,t=0,n=e.length;t<n;t++)e[t]=0}function h(e){f(e,0)}function f(t,n){var r=a.newAttributes,i=a.enabledAttributes,o=a.attributeDivisors;r[t]=1,0===i[t]&&(e.enableVertexAttribArray(t),i[t]=1),o[t]!==n&&(e.vertexAttribDivisor(t,n),o[t]=n)}function d(){for(var t=a.newAttributes,n=a.enabledAttributes,r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function p(t,n,r,i,a,o,s){!0===s?e.vertexAttribIPointer(t,n,r,a,o):e.vertexAttribPointer(t,n,r,i,a,o)}function A(){v(),o=!0,a!==i&&s((a=i).object)}function v(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:function(n,i,u,A,v){var m,g=function(t,n,i){var a=!0===i.wireframe,o=r[t.id];void 0===o&&(o={},r[t.id]=o);var s=o[n.id];void 0===s&&(s={},o[n.id]=s);var u=s[a];void 0===u&&(u=l(e.createVertexArray()),s[a]=u);return u}(A,u,i);a!==g&&s((a=g).object),m=function(e,t,n,r){var i=a.attributes,o=t.attributes,s=0,u=n.getAttributes();for(var l in u){if(u[l].location>=0){var c=i[l],h=o[l];if(void 0===h&&("instanceMatrix"===l&&e.instanceMatrix&&(h=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(h=e.instanceColor)),void 0===c)return!0;if(c.attribute!==h)return!0;if(h&&c.data!==h.data)return!0;s++}}return a.attributesNum!==s||a.index!==r}(n,A,u,v),m&&function(e,t,n,r){var i={},o=t.attributes,s=0,u=n.getAttributes();for(var l in u){if(u[l].location>=0){var c=o[l];void 0===c&&("instanceMatrix"===l&&e.instanceMatrix&&(c=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(c=e.instanceColor));var h={};h.attribute=c,c&&c.data&&(h.data=c.data),i[l]=h,s++}}a.attributes=i,a.attributesNum=s,a.index=r}(n,A,u,v),null!==v&&t.update(v,e.ELEMENT_ARRAY_BUFFER),(m||o)&&(o=!1,function(n,r,i,a){c();var o=a.attributes,s=i.getAttributes(),u=r.defaultAttributeValues;for(var l in s){var A=s[l];if(A.location>=0){var v=o[l];if(void 0===v&&("instanceMatrix"===l&&n.instanceMatrix&&(v=n.instanceMatrix),"instanceColor"===l&&n.instanceColor&&(v=n.instanceColor)),void 0!==v){var m=v.normalized,g=v.itemSize,y=t.get(v);if(void 0===y)continue;var _=y.buffer,b=y.type,x=y.bytesPerElement,w=b===e.INT||b===e.UNSIGNED_INT||v.gpuType===Gt;if(v.isInterleavedBufferAttribute){var T=v.data,S=T.stride,E=v.offset;if(T.isInstancedInterleavedBuffer){for(var k=0;k<A.locationSize;k++)f(A.location+k,T.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=T.meshPerAttribute*T.count)}else for(var M=0;M<A.locationSize;M++)h(A.location+M);e.bindBuffer(e.ARRAY_BUFFER,_);for(var C=0;C<A.locationSize;C++)p(A.location+C,g/A.locationSize,b,m,S*x,(E+g/A.locationSize*C)*x,w)}else{if(v.isInstancedBufferAttribute){for(var R=0;R<A.locationSize;R++)f(A.location+R,v.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=v.meshPerAttribute*v.count)}else for(var P=0;P<A.locationSize;P++)h(A.location+P);e.bindBuffer(e.ARRAY_BUFFER,_);for(var N=0;N<A.locationSize;N++)p(A.location+N,g/A.locationSize,b,m,g*x,g/A.locationSize*N*x,w)}}else if(void 0!==u){var I=u[l];if(void 0!==I)switch(I.length){case 2:e.vertexAttrib2fv(A.location,I);break;case 3:e.vertexAttrib3fv(A.location,I);break;case 4:e.vertexAttrib4fv(A.location,I);break;default:e.vertexAttrib1fv(A.location,I)}}}}d()}(n,i,u,A),null!==v&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(v).buffer))},reset:A,resetDefaultState:v,dispose:function(){for(var e in A(),r){var t=r[e];for(var n in t){var i=t[n];for(var a in i)u(i[a].object),delete i[a];delete t[n]}delete r[e]}},releaseStatesOfGeometry:function(e){if(void 0!==r[e.id]){var t=r[e.id];for(var n in t){var i=t[n];for(var a in i)u(i[a].object),delete i[a];delete t[n]}delete r[e.id]}},releaseStatesOfProgram:function(e){for(var t in r){var n=r[t];if(void 0!==n[e.id]){var i=n[e.id];for(var a in i)u(i[a].object),delete i[a];delete n[e.id]}}},initAttributes:c,enableAttribute:h,disableUnusedAttributes:d}}function iH(e,t,n){var r;function i(t,i,a){0!==a&&(e.drawArraysInstanced(r,t,i,a),n.update(i,r,a))}this.setMode=function(e){r=e},this.render=function(t,i){e.drawArrays(r,t,i),n.update(i,r,1)},this.renderInstances=i,this.renderMultiDraw=function(e,i,a){if(0!==a){t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,e,0,i,0,a);for(var o=0,s=0;s<a;s++)o+=i[s];n.update(o,r,1)}},this.renderMultiDrawInstances=function(e,a,o,s){if(0!==o){var u=t.get("WEBGL_multi_draw");if(null===u)for(var l=0;l<e.length;l++)i(e[l],a[l],s[l]);else{u.multiDrawArraysInstancedWEBGL(r,e,0,a,0,s,0,o);for(var c=0,h=0;h<o;h++)c+=a[h]*s[h];n.update(c,r,1)}}}}function aH(e,t,n,r){var i;function a(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o=void 0!==n.precision?n.precision:"highp",s=a(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var u=!0===n.logarithmicDepthBuffer,l=!0===n.reverseDepthBuffer&&t.has("EXT_clip_control"),c=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===t.has("EXT_texture_filter_anisotropic")){var n=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:a,textureFormatReadable:function(t){return t===en||r.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){var i=n===Xt&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(n!==zt&&r.convert(n)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==Wt&&!i)},precision:o,logarithmicDepthBuffer:u,reverseDepthBuffer:l,maxTextures:c,maxVertexTextures:h,maxTextureSize:e.getParameter(e.MAX_TEXTURE_SIZE),maxCubemapSize:e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:e.getParameter(e.MAX_VERTEX_ATTRIBS),maxVertexUniforms:e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:e.getParameter(e.MAX_VARYING_VECTORS),maxFragmentUniforms:e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:h>0,maxSamples:e.getParameter(e.MAX_SAMPLES)}}function oH(e){var t=this,n=null,r=0,i=!1,a=!1,o=new Po,s=new br,u={value:null,needsUpdate:!1};function l(e,n,r,i){var a=null!==e?e.length:0,l=null;if(0!==a){if(l=u.value,!0!==i||null===l){var c=r+4*a,h=n.matrixWorldInverse;s.getNormalMatrix(h),(null===l||l.length<c)&&(l=new Float32Array(c));for(var f=0,d=r;f!==a;++f,d+=4)o.copy(e[f]).applyMatrix4(h,s),o.normal.toArray(l,d),l[d+3]=o.constant}u.value=l,u.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,l}this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){var n=0!==e.length||t||0!==r||i;return i=t,r=e.length,n},this.beginShadows=function(){a=!0,l(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(e,t){n=l(e,t,0)},this.setState=function(o,s,c){var h=o.clippingPlanes,f=o.clipIntersection,d=o.clipShadows,p=e.get(o);if(!i||null===h||0===h.length||a&&!d)a?l(null):function(){u.value!==n&&(u.value=n,u.needsUpdate=r>0);t.numPlanes=r,t.numIntersection=0}();else{var A=a?0:r,v=4*A,m=p.clippingState||null;u.value=m,m=l(h,s,v,c);for(var g=0;g!==v;++g)m[g]=n[g];p.clippingState=m,this.numIntersection=f?this.numPlanes:0,this.numPlanes+=A}}}function sH(e){var t=new WeakMap;function n(e,t){return t===Mt?e.mapping=Et:t===Ct&&(e.mapping=kt),e}function r(e){var n=e.target;n.removeEventListener("dispose",r);var i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){var a=i.mapping;if(a===Mt||a===Ct){if(t.has(i))return n(t.get(i).texture,i.mapping);var o=i.image;if(o&&o.height>0){var s=new mo(o.height);return s.fromEquirectangularTexture(e,i),t.set(i,s),i.addEventListener("dispose",r),n(s.texture,i.mapping)}return null}}return i},dispose:function(){t=new WeakMap}}}var uH=[.125,.215,.35,.446,.526,.582],lH=20,cH=new nl,hH=new ga,fH=null,dH=0,pH=0,AH=!1,vH=(1+Math.sqrt(5))/2,mH=1/vH,gH=[new Kr(-vH,mH,0),new Kr(vH,mH,0),new Kr(-mH,0,vH),new Kr(mH,0,vH),new Kr(0,vH,-mH),new Kr(0,vH,mH),new Kr(-1,1,-1),new Kr(1,1,-1),new Kr(-1,1,1),new Kr(1,1,1)],yH=new Kr,_H=function(){function e(t){c(this,e),this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}return p(e,[{key:"fromScene",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=i.size,o=void 0===a?256:a,s=i.position,u=void 0===s?yH:s;fH=this._renderer.getRenderTarget(),dH=this._renderer.getActiveCubeFace(),pH=this._renderer.getActiveMipmapLevel(),AH=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);var l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,n,r,l,u),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}},{key:"fromEquirectangular",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}},{key:"fromCubemap",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}},{key:"compileCubemapShader",value:function(){null===this._cubemapMaterial&&(this._cubemapMaterial=TH(),this._compileMaterial(this._cubemapMaterial))}},{key:"compileEquirectangularShader",value:function(){null===this._equirectMaterial&&(this._equirectMaterial=wH(),this._compileMaterial(this._equirectMaterial))}},{key:"dispose",value:function(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}},{key:"_setSize",value:function(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}},{key:"_dispose",value:function(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(var e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}},{key:"_cleanup",value:function(e){this._renderer.setRenderTarget(fH,dH,pH),this._renderer.xr.enabled=AH,e.scissorTest=!1,xH(e,0,0,e.width,e.height)}},{key:"_fromTexture",value:function(e,t){e.mapping===Et||e.mapping===kt?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),fH=this._renderer.getRenderTarget(),dH=this._renderer.getActiveCubeFace(),pH=this._renderer.getActiveMipmapLevel(),AH=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;var n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}},{key:"_allocateTargets",value:function(){var e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Ut,minFilter:Ut,generateMipmaps:!1,type:Xt,format:en,colorSpace:Zn,depthBuffer:!1},r=bH(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=bH(e,t,n);var i=this._lodMax,a=function(e){for(var t=[],n=[],r=[],i=e,a=e-4+1+uH.length,o=0;o<a;o++){var s=Math.pow(2,i);n.push(s);var u=1/s;o>e-4?u=uH[o-e+4-1]:0===o&&(u=0),r.push(u);for(var l=1/(s-2),c=-l,h=1+l,f=[c,c,h,c,h,h,c,c,h,h,c,h],d=6,p=6,A=3,v=2,m=1,g=new Float32Array(A*p*d),y=new Float32Array(v*p*d),_=new Float32Array(m*p*d),b=0;b<d;b++){var x=b%3*2/3-1,w=b>2?0:-1,T=[x,w,0,x+2/3,w,0,x+2/3,w+1,0,x,w,0,x+2/3,w+1,0,x,w+1,0];g.set(T,A*p*b),y.set(f,v*p*b);var S=[b,b,b,b,b,b];_.set(S,m*p*b)}var E=new qa;E.setAttribute("position",new Ra(g,A)),E.setAttribute("uv",new Ra(y,v)),E.setAttribute("faceIndex",new Ra(_,m)),t.push(E),i>4&&i--}return{lodPlanes:t,sizeLods:n,sigmas:r}}(i);this._sizeLods=a.sizeLods,this._lodPlanes=a.lodPlanes,this._sigmas=a.sigmas,this._blurMaterial=function(e,t,n){var r=new Float32Array(lH),i=new Kr(0,1,0),a=new so({name:"SphericalGaussianBlur",defines:{n:lH,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1});return a}(i,e,t)}return r}},{key:"_compileMaterial",value:function(e){var t=new eo(this._lodPlanes[0],e);this._renderer.compile(t,cH)}},{key:"_sceneToCubeUV",value:function(e,t,n,r,i){var a=new fo(90,1,t,n),o=[1,-1,1,1,1,1],s=[1,1,1,-1,-1,-1],u=this._renderer,l=u.autoClear,c=u.toneMapping;u.getClearColor(hH),u.toneMapping=0,u.autoClear=!1;var h=new xa({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),f=new eo(new no,h),d=!1,p=e.background;p?p.isColor&&(h.color.copy(p),e.background=null,d=!0):(h.color.copy(hH),d=!0);for(var A=0;A<6;A++){var v=A%3;0===v?(a.up.set(0,o[A],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x+s[A],i.y,i.z)):1===v?(a.up.set(0,0,o[A]),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y+s[A],i.z)):(a.up.set(0,o[A],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y,i.z+s[A]));var m=this._cubeSize;xH(r,v*m,A>2?m:0,m,m),u.setRenderTarget(r),d&&u.render(f,a),u.render(e,a)}f.geometry.dispose(),f.material.dispose(),u.toneMapping=c,u.autoClear=l,e.background=p}},{key:"_textureToCubeUV",value:function(e,t){var n=this._renderer,r=e.mapping===Et||e.mapping===kt;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=TH()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=wH());var i=r?this._cubemapMaterial:this._equirectMaterial,a=new eo(this._lodPlanes[0],i);i.uniforms.envMap.value=e;var o=this._cubeSize;xH(t,0,0,3*o,2*o),n.setRenderTarget(t),n.render(a,cH)}},{key:"_applyPMREM",value:function(e){var t=this._renderer,n=t.autoClear;t.autoClear=!1;for(var r=this._lodPlanes.length,i=1;i<r;i++){var a=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),o=gH[(r-i-1)%gH.length];this._blur(e,i-1,i,a,o)}t.autoClear=n}},{key:"_blur",value:function(e,t,n,r,i){var a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}},{key:"_halfBlur",value:function(e,t,n,r,i,a,o){var s=this._renderer,u=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var l=new eo(this._lodPlanes[r],u),c=u.uniforms,h=this._sizeLods[n]-1,f=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,d=i/f,p=isFinite(i)?1+Math.floor(3*d):lH;p>lH&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(p," samples when the maximum is set to ").concat(lH));for(var A=[],v=0,m=0;m<lH;++m){var g=m/d,y=Math.exp(-g*g/2);A.push(y),0===m?v+=y:m<p&&(v+=2*y)}for(var _=0;_<A.length;_++)A[_]=A[_]/v;c.envMap.value=e.texture,c.samples.value=p,c.weights.value=A,c.latitudinal.value="latitudinal"===a,o&&(c.poleAxis.value=o);var b=this._lodMax;c.dTheta.value=f,c.mipInt.value=b-n;var x=this._sizeLods[r];xH(t,3*x*(r>b-4?r-b+4:0),4*(this._cubeSize-x),3*x,2*x),s.setRenderTarget(t),s.render(l,cH)}}]),e}();function bH(e,t,n){var r=new Wr(e,t,n);return r.texture.mapping=Rt,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function xH(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function wH(){return new so({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function TH(){return new so({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function SH(e){var t=new WeakMap,n=null;function r(e){var n=e.target;n.removeEventListener("dispose",r);var i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){var a=i.mapping,o=a===Mt||a===Ct,s=a===Et||a===kt;if(o||s){var u=t.get(i),l=void 0!==u?u.texture.pmremVersion:0;if(i.isRenderTargetTexture&&i.pmremVersion!==l)return null===n&&(n=new _H(e)),(u=o?n.fromEquirectangular(i,u):n.fromCubemap(i,u)).texture.pmremVersion=i.pmremVersion,t.set(i,u),u.texture;if(void 0!==u)return u.texture;var c=i.image;return o&&c&&c.height>0||s&&c&&function(e){for(var t=0,n=6,r=0;r<n;r++)void 0!==e[r]&&t++;return t===n}(c)?(null===n&&(n=new _H(e)),(u=o?n.fromEquirectangular(i):n.fromCubemap(i)).texture.pmremVersion=i.pmremVersion,t.set(i,u),i.addEventListener("dispose",r),u.texture):null}}return i},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function EH(e){var t={};function n(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(e){var t=n(e);return null===t&&kr("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function kH(e,t,n,r){var i={},a=new WeakMap;function o(e){var s=e.target;for(var u in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[u]);s.removeEventListener("dispose",o),delete i[s.id];var l=a.get(s);l&&(t.remove(l),a.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){var n=[],r=e.index,i=e.attributes.position,o=0;if(null!==r){var s=r.array;o=r.version;for(var u=0,l=s.length;u<l;u+=3){var c=s[u+0],h=s[u+1],f=s[u+2];n.push(c,h,h,f,f,c)}}else{if(void 0===i)return;var d=i.array;o=i.version;for(var p=0,A=d.length/3-1;p<A;p+=3){var v=p+0,m=p+1,g=p+2;n.push(v,m,m,g,g,v)}}var y=new(wr(n)?Na:Pa)(n,1);y.version=o;var _=a.get(e);_&&t.remove(_),a.set(e,y)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",o),i[t.id]=!0,n.memory.geometries++),t},update:function(n){var r=n.attributes;for(var i in r)t.update(r[i],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){var t=a.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return a.get(e)}}}function MH(e,t,n){var r,i,a;function o(t,o,s){0!==s&&(e.drawElementsInstanced(r,o,i,t*a,s),n.update(o,r,s))}this.setMode=function(e){r=e},this.setIndex=function(e){i=e.type,a=e.bytesPerElement},this.render=function(t,o){e.drawElements(r,o,i,t*a),n.update(o,r,1)},this.renderInstances=o,this.renderMultiDraw=function(e,a,o){if(0!==o){t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,a,0,i,e,0,o);for(var s=0,u=0;u<o;u++)s+=a[u];n.update(s,r,1)}},this.renderMultiDrawInstances=function(e,s,u,l){if(0!==u){var c=t.get("WEBGL_multi_draw");if(null===c)for(var h=0;h<e.length;h++)o(e[h]/a,s[h],l[h]);else{c.multiDrawElementsInstancedWEBGL(r,s,0,i,e,0,l,0,u);for(var f=0,d=0;d<u;d++)f+=s[d]*l[d];n.update(f,r,1)}}}}function CH(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,i){switch(t.calls++,r){case e.TRIANGLES:t.triangles+=i*(n/3);break;case e.LINES:t.lines+=i*(n/2);break;case e.LINE_STRIP:t.lines+=i*(n-1);break;case e.LINE_LOOP:t.lines+=i*n;break;case e.POINTS:t.points+=i*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function RH(e,t,n){var r=new WeakMap,i=new Gr;return{update:function(a,o,s){var u=a.morphTargetInfluences,l=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,c=void 0!==l?l.length:0,h=r.get(o);if(void 0===h||h.count!==c){void 0!==h&&h.texture.dispose();var f=void 0!==o.morphAttributes.position,d=void 0!==o.morphAttributes.normal,p=void 0!==o.morphAttributes.color,A=o.morphAttributes.position||[],v=o.morphAttributes.normal||[],m=o.morphAttributes.color||[],g=0;!0===f&&(g=1),!0===d&&(g=2),!0===p&&(g=3);var y=o.attributes.position.count*g,_=1;y>t.maxTextureSize&&(_=Math.ceil(y/t.maxTextureSize),y=t.maxTextureSize);var b=new Float32Array(y*_*4*c),x=new Xr(b,y,_,c);x.type=Wt,x.needsUpdate=!0;for(var w=4*g,T=0;T<c;T++)for(var S=A[T],E=v[T],k=m[T],M=y*_*4*T,C=0;C<S.count;C++){var R=C*w;!0===f&&(i.fromBufferAttribute(S,C),b[M+R+0]=i.x,b[M+R+1]=i.y,b[M+R+2]=i.z,b[M+R+3]=0),!0===d&&(i.fromBufferAttribute(E,C),b[M+R+4]=i.x,b[M+R+5]=i.y,b[M+R+6]=i.z,b[M+R+7]=0),!0===p&&(i.fromBufferAttribute(k,C),b[M+R+8]=i.x,b[M+R+9]=i.y,b[M+R+10]=i.z,b[M+R+11]=4===k.itemSize?i.w:1)}h={count:c,texture:x,size:new _r(y,_)},r.set(o,h),o.addEventListener("dispose",(function e(){x.dispose(),r.delete(o),o.removeEventListener("dispose",e)}))}if(!0===a.isInstancedMesh&&null!==a.morphTexture)s.getUniforms().setValue(e,"morphTexture",a.morphTexture,n);else{for(var P=0,N=0;N<u.length;N++)P+=u[N];var I=o.morphTargetsRelative?1:1-P;s.getUniforms().setValue(e,"morphTargetBaseInfluence",I),s.getUniforms().setValue(e,"morphTargetInfluences",u)}s.getUniforms().setValue(e,"morphTargetsTexture",h.texture,n),s.getUniforms().setValue(e,"morphTargetsTextureSize",h.size)}}}function PH(e,t,n,r){var i=new WeakMap;function a(e){var t=e.target;t.removeEventListener("dispose",a),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(o){var s=r.render.frame,u=o.geometry,l=t.get(o,u);if(i.get(l)!==s&&(t.update(l),i.set(l,s)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",a)&&o.addEventListener("dispose",a),i.get(o)!==s&&(n.update(o.instanceMatrix,e.ARRAY_BUFFER),null!==o.instanceColor&&n.update(o.instanceColor,e.ARRAY_BUFFER),i.set(o,s))),o.isSkinnedMesh){var c=o.skeleton;i.get(c)!==s&&(c.update(),i.set(c,s))}return l},dispose:function(){i=new WeakMap}}}var NH=new jr,IH=new ns(1,1),LH=new Xr,DH=new Qr,OH=new vo,UH=[],BH=[],FH=new Float32Array(16),zH=new Float32Array(9),VH=new Float32Array(4);function qH(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,a=UH[i];if(void 0===a&&(a=new Float32Array(i),UH[i]=a),0!==t){r.toArray(a,0);for(var o=1,s=0;o!==t;++o)s+=n,e[o].toArray(a,s)}return a}function jH(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function GH(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function HH(e,t){var n=BH[t];void 0===n&&(n=new Int32Array(t),BH[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function WH(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function XH(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(jH(n,t))return;e.uniform2fv(this.addr,t),GH(n,t)}}function QH(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(jH(n,t))return;e.uniform3fv(this.addr,t),GH(n,t)}}function YH(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(jH(n,t))return;e.uniform4fv(this.addr,t),GH(n,t)}}function KH(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(jH(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),GH(n,t)}else{if(jH(n,r))return;VH.set(r),e.uniformMatrix2fv(this.addr,!1,VH),GH(n,r)}}function ZH(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(jH(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),GH(n,t)}else{if(jH(n,r))return;zH.set(r),e.uniformMatrix3fv(this.addr,!1,zH),GH(n,r)}}function JH(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(jH(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),GH(n,t)}else{if(jH(n,r))return;FH.set(r),e.uniformMatrix4fv(this.addr,!1,FH),GH(n,r)}}function $H(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function eW(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(jH(n,t))return;e.uniform2iv(this.addr,t),GH(n,t)}}function tW(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(jH(n,t))return;e.uniform3iv(this.addr,t),GH(n,t)}}function nW(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(jH(n,t))return;e.uniform4iv(this.addr,t),GH(n,t)}}function rW(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function iW(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(jH(n,t))return;e.uniform2uiv(this.addr,t),GH(n,t)}}function aW(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(jH(n,t))return;e.uniform3uiv(this.addr,t),GH(n,t)}}function oW(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(jH(n,t))return;e.uniform4uiv(this.addr,t),GH(n,t)}}function sW(e,t,n){var r,i=this.cache,a=n.allocateTextureUnit();i[0]!==a&&(e.uniform1i(this.addr,a),i[0]=a),this.type===e.SAMPLER_2D_SHADOW?(IH.compareFunction=nr,r=IH):r=NH,n.setTexture2D(t||r,a)}function uW(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||DH,i)}function lW(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||OH,i)}function cW(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||LH,i)}function hW(e,t){e.uniform1fv(this.addr,t)}function fW(e,t){var n=qH(t,this.size,2);e.uniform2fv(this.addr,n)}function dW(e,t){var n=qH(t,this.size,3);e.uniform3fv(this.addr,n)}function pW(e,t){var n=qH(t,this.size,4);e.uniform4fv(this.addr,n)}function AW(e,t){var n=qH(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function vW(e,t){var n=qH(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function mW(e,t){var n=qH(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function gW(e,t){e.uniform1iv(this.addr,t)}function yW(e,t){e.uniform2iv(this.addr,t)}function _W(e,t){e.uniform3iv(this.addr,t)}function bW(e,t){e.uniform4iv(this.addr,t)}function xW(e,t){e.uniform1uiv(this.addr,t)}function wW(e,t){e.uniform2uiv(this.addr,t)}function TW(e,t){e.uniform3uiv(this.addr,t)}function SW(e,t){e.uniform4uiv(this.addr,t)}function EW(e,t,n){var r=this.cache,i=t.length,a=HH(n,i);jH(r,a)||(e.uniform1iv(this.addr,a),GH(r,a));for(var o=0;o!==i;++o)n.setTexture2D(t[o]||NH,a[o])}function kW(e,t,n){var r=this.cache,i=t.length,a=HH(n,i);jH(r,a)||(e.uniform1iv(this.addr,a),GH(r,a));for(var o=0;o!==i;++o)n.setTexture3D(t[o]||DH,a[o])}function MW(e,t,n){var r=this.cache,i=t.length,a=HH(n,i);jH(r,a)||(e.uniform1iv(this.addr,a),GH(r,a));for(var o=0;o!==i;++o)n.setTextureCube(t[o]||OH,a[o])}function CW(e,t,n){var r=this.cache,i=t.length,a=HH(n,i);jH(r,a)||(e.uniform1iv(this.addr,a),GH(r,a));for(var o=0;o!==i;++o)n.setTexture2DArray(t[o]||LH,a[o])}var RW=p((function e(t,n,r){c(this,e),this.id=t,this.addr=r,this.cache=[],this.type=n.type,this.setValue=function(e){switch(e){case 5126:return WH;case 35664:return XH;case 35665:return QH;case 35666:return YH;case 35674:return KH;case 35675:return ZH;case 35676:return JH;case 5124:case 35670:return $H;case 35667:case 35671:return eW;case 35668:case 35672:return tW;case 35669:case 35673:return nW;case 5125:return rW;case 36294:return iW;case 36295:return aW;case 36296:return oW;case 35678:case 36198:case 36298:case 36306:case 35682:return sW;case 35679:case 36299:case 36307:return uW;case 35680:case 36300:case 36308:case 36293:return lW;case 36289:case 36303:case 36311:case 36292:return cW}}(n.type)})),PW=p((function e(t,n,r){c(this,e),this.id=t,this.addr=r,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=function(e){switch(e){case 5126:return hW;case 35664:return fW;case 35665:return dW;case 35666:return pW;case 35674:return AW;case 35675:return vW;case 35676:return mW;case 5124:case 35670:return gW;case 35667:case 35671:return yW;case 35668:case 35672:return _W;case 35669:case 35673:return bW;case 5125:return xW;case 36294:return wW;case 36295:return TW;case 36296:return SW;case 35678:case 36198:case 36298:case 36306:case 35682:return EW;case 35679:case 36299:case 36307:return kW;case 35680:case 36300:case 36308:case 36293:return MW;case 36289:case 36303:case 36311:case 36292:return CW}}(n.type)})),NW=function(){function e(t){c(this,e),this.id=t,this.seq=[],this.map={}}return p(e,[{key:"setValue",value:function(e,t,n){for(var r=this.seq,i=0,a=r.length;i!==a;++i){var o=r[i];o.setValue(e,t[o.id],n)}}}]),e}(),IW=/(\w+)(\])?(\[|\.)?/g;function LW(e,t){e.seq.push(t),e.map[t.id]=t}function DW(e,t,n){var r=e.name,i=r.length;for(IW.lastIndex=0;;){var a=IW.exec(r),o=IW.lastIndex,s=a[1],u="]"===a[2],l=a[3];if(u&&(s|=0),void 0===l||"["===l&&o+2===i){LW(n,void 0===l?new RW(s,e,t):new PW(s,e,t));break}var c=n.map[s];void 0===c&&LW(n,c=new NW(s)),n=c}}var OW=function(){function e(t,n){c(this,e),this.seq=[],this.map={};for(var r=t.getProgramParameter(n,t.ACTIVE_UNIFORMS),i=0;i<r;++i){var a=t.getActiveUniform(n,i);DW(a,t.getUniformLocation(n,a.name),this)}}return p(e,[{key:"setValue",value:function(e,t,n,r){var i=this.map[t];void 0!==i&&i.setValue(e,n,r)}},{key:"setOptional",value:function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)}}],[{key:"upload",value:function(e,t,n,r){for(var i=0,a=t.length;i!==a;++i){var o=t[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}}},{key:"seqWithValue",value:function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var a=e[r];a.id in t&&n.push(a)}return n}}]),e}();function UW(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}var BW=0;var FW=new br;function zW(e,t,n){var r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(r&&""===i)return"";var a=/ERROR: 0:(\d+)/.exec(i);if(a){var o=parseInt(a[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){for(var n=e.split("\n"),r=[],i=Math.max(t-6,0),a=Math.min(t+6,n.length),o=i;o<a;o++){var s=o+1;r.push("".concat(s===t?">":" "," ").concat(s,": ").concat(n[o]))}return r.join("\n")}(e.getShaderSource(t),o)}return i}function VW(e,t){var n=function(e){Dr._getMatrix(FW,Dr.workingColorSpace,e);var t="mat3( ".concat(FW.elements.map((function(e){return e.toFixed(4)}))," )");switch(Dr.getTransfer(e)){case Jn:return[t,"LinearTransferOETF"];case $n:return[t,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",e),[t,"LinearTransferOETF"]}}(t);return["vec4 ".concat(e,"( vec4 value ) {"),"\treturn ".concat(n[1],"( vec4( value.rgb * ").concat(n[0],", value.a ) );"),"}"].join("\n")}function qW(e,t){var n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Cineon";break;case 4:n="ACESFilmic";break;case 6:n="AgX";break;case 7:n="Neutral";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}var jW=new Kr;function GW(){Dr.getLuminanceCoefficients(jW);var e=jW.x.toFixed(4),t=jW.y.toFixed(4),n=jW.z.toFixed(4);return["float luminance( const in vec3 rgb ) {","\tconst vec3 weights = vec3( ".concat(e,", ").concat(t,", ").concat(n," );"),"\treturn dot( weights, rgb );","}"].join("\n")}function HW(e){return""!==e}function WW(e,t){var n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function XW(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var QW=/^[ \t]*#include +<([\w\d./]+)>/gm;function YW(e){return e.replace(QW,ZW)}var KW=new Map;function ZW(e,t){var n=KG[t];if(void 0===n){var r=KW.get(t);if(void 0===r)throw new Error("Can not resolve #include <"+t+">");n=KG[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,r)}return YW(n)}var JW=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function $W(e){return e.replace(JW,eX)}function eX(e,t,n,r){for(var i="",a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function tX(e){var t="precision ".concat(e.precision," float;\n\tprecision ").concat(e.precision," int;\n\tprecision ").concat(e.precision," sampler2D;\n\tprecision ").concat(e.precision," samplerCube;\n\tprecision ").concat(e.precision," sampler3D;\n\tprecision ").concat(e.precision," sampler2DArray;\n\tprecision ").concat(e.precision," sampler2DShadow;\n\tprecision ").concat(e.precision," samplerCubeShadow;\n\tprecision ").concat(e.precision," sampler2DArrayShadow;\n\tprecision ").concat(e.precision," isampler2D;\n\tprecision ").concat(e.precision," isampler3D;\n\tprecision ").concat(e.precision," isamplerCube;\n\tprecision ").concat(e.precision," isampler2DArray;\n\tprecision ").concat(e.precision," usampler2D;\n\tprecision ").concat(e.precision," usampler3D;\n\tprecision ").concat(e.precision," usamplerCube;\n\tprecision ").concat(e.precision," usampler2DArray;\n\t");return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function nX(e,t,n,r){var i,a,o=e.getContext(),s=n.defines,u=n.vertexShader,l=n.fragmentShader,c=function(e){var t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),h=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Et:case kt:t="ENVMAP_TYPE_CUBE";break;case Rt:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),f=function(e){var t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===kt&&(t="ENVMAP_MODE_REFRACTION");return t}(n),d=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),p=function(e){var t=e.envMapCubeUVHeight;if(null===t)return null;var n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),A=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(HW).join("\n")}(n),v=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(s),m=o.createProgram(),g=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?((i=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v].filter(HW).join("\n")).length>0&&(i+="\n"),(a=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v].filter(HW).join("\n")).length>0&&(a+="\n")):(i=[tX(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+f:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(HW).join("\n"),a=[tX(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.envMap?"#define "+f:"",n.envMap?"#define "+d:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?KG.tonemapping_pars_fragment:"",0!==n.toneMapping?qW("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",KG.colorspace_pars_fragment,VW("linearToOutputTexel",n.outputColorSpace),GW(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(HW).join("\n")),u=XW(u=WW(u=YW(u),n),n),l=XW(l=WW(l=YW(l),n),n),u=$W(u),l=$W(l),!0!==n.isRawShaderMaterial&&(g="#version 300 es\n",i=[A,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+i,a=["#define varying in",n.glslVersion===ar?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===ar?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+a);var y,_,b=g+i+u,x=g+a+l,w=UW(o,o.VERTEX_SHADER,b),T=UW(o,o.FRAGMENT_SHADER,x);function S(t){if(e.debug.checkShaderErrors){var n=o.getProgramInfoLog(m).trim(),r=o.getShaderInfoLog(w).trim(),s=o.getShaderInfoLog(T).trim(),u=!0,l=!0;if(!1===o.getProgramParameter(m,o.LINK_STATUS))if(u=!1,"function"===typeof e.debug.onShaderError)e.debug.onShaderError(o,m,w,T);else{var c=zW(o,w,"vertex"),h=zW(o,T,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(m,o.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+n+"\n"+c+"\n"+h)}else""!==n?console.warn("THREE.WebGLProgram: Program Info Log:",n):""!==r&&""!==s||(l=!1);l&&(t.diagnostics={runnable:u,programLog:n,vertexShader:{log:r,prefix:i},fragmentShader:{log:s,prefix:a}})}o.deleteShader(w),o.deleteShader(T),y=new OW(o,m),_=function(e,t){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var a=e.getActiveAttrib(t,i),o=a.name,s=1;a.type===e.FLOAT_MAT2&&(s=2),a.type===e.FLOAT_MAT3&&(s=3),a.type===e.FLOAT_MAT4&&(s=4),n[o]={type:a.type,location:e.getAttribLocation(t,o),locationSize:s}}return n}(o,m)}o.attachShader(m,w),o.attachShader(m,T),void 0!==n.index0AttributeName?o.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&o.bindAttribLocation(m,0,"position"),o.linkProgram(m),this.getUniforms=function(){return void 0===y&&S(this),y},this.getAttributes=function(){return void 0===_&&S(this),_};var E=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===E&&(E=o.getProgramParameter(m,37297)),E},this.destroy=function(){r.releaseStatesOfProgram(this),o.deleteProgram(m),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=BW++,this.cacheKey=t,this.usedTimes=1,this.program=m,this.vertexShader=w,this.fragmentShader=T,this}var rX=0,iX=function(){function e(){c(this,e),this.shaderCache=new Map,this.materialCache=new Map}return p(e,[{key:"update",value:function(e){var t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return!1===a.has(r)&&(a.add(r),r.usedTimes++),!1===a.has(i)&&(a.add(i),i.usedTimes++),this}},{key:"remove",value:function(e){var t,n=k(this.materialCache.get(e));try{for(n.s();!(t=n.n()).done;){var r=t.value;r.usedTimes--,0===r.usedTimes&&this.shaderCache.delete(r.code)}}catch(i){n.e(i)}finally{n.f()}return this.materialCache.delete(e),this}},{key:"getVertexShaderID",value:function(e){return this._getShaderStage(e.vertexShader).id}},{key:"getFragmentShaderID",value:function(e){return this._getShaderStage(e.fragmentShader).id}},{key:"dispose",value:function(){this.shaderCache.clear(),this.materialCache.clear()}},{key:"_getShaderCacheForMaterial",value:function(e){var t=this.materialCache,n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}},{key:"_getShaderStage",value:function(e){var t=this.shaderCache,n=t.get(e);return void 0===n&&(n=new aX(e),t.set(e,n)),n}}]),e}(),aX=p((function e(t){c(this,e),this.id=rX++,this.code=t,this.usedTimes=0}));function oX(e,t,n,r,i,a,o){var s=new Ui,u=new iX,l=new Set,c=[],h=i.logarithmicDepthBuffer,f=i.vertexTextures,d=i.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function A(e){return l.add(e),0===e?"uv":"uv".concat(e)}return{getParameters:function(a,s,c,v,m){var g=v.fog,y=m.geometry,_=a.isMeshStandardMaterial?v.environment:null,b=(a.isMeshStandardMaterial?n:t).get(a.envMap||_),x=b&&b.mapping===Rt?b.image.height:null,w=p[a.type];null!==a.precision&&(d=i.getMaxPrecision(a.precision))!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",d,"instead.");var T,S,E,k,M=y.morphAttributes.position||y.morphAttributes.normal||y.morphAttributes.color,C=void 0!==M?M.length:0,R=0;if(void 0!==y.morphAttributes.position&&(R=1),void 0!==y.morphAttributes.normal&&(R=2),void 0!==y.morphAttributes.color&&(R=3),w){var P=JG[w];T=P.vertexShader,S=P.fragmentShader}else T=a.vertexShader,S=a.fragmentShader,u.update(a),E=u.getVertexShaderID(a),k=u.getFragmentShaderID(a);var N=e.getRenderTarget(),I=e.state.buffers.depth.getReversed(),L=!0===m.isInstancedMesh,D=!0===m.isBatchedMesh,O=!!a.map,U=!!a.matcap,B=!!b,F=!!a.aoMap,z=!!a.lightMap,V=!!a.bumpMap,q=!!a.normalMap,j=!!a.displacementMap,G=!!a.emissiveMap,H=!!a.metalnessMap,W=!!a.roughnessMap,X=a.anisotropy>0,Q=a.clearcoat>0,Y=a.dispersion>0,K=a.iridescence>0,Z=a.sheen>0,J=a.transmission>0,$=X&&!!a.anisotropyMap,ee=Q&&!!a.clearcoatMap,te=Q&&!!a.clearcoatNormalMap,ne=Q&&!!a.clearcoatRoughnessMap,re=K&&!!a.iridescenceMap,ie=K&&!!a.iridescenceThicknessMap,ae=Z&&!!a.sheenColorMap,oe=Z&&!!a.sheenRoughnessMap,se=!!a.specularMap,ue=!!a.specularColorMap,le=!!a.specularIntensityMap,ce=J&&!!a.transmissionMap,he=J&&!!a.thicknessMap,fe=!!a.gradientMap,de=!!a.alphaMap,pe=a.alphaTest>0,Ae=!!a.alphaHash,ve=!!a.extensions,me=0;a.toneMapped&&(null!==N&&!0!==N.isXRRenderTarget||(me=e.toneMapping));var ge={shaderID:w,shaderType:a.type,shaderName:a.name,vertexShader:T,fragmentShader:S,defines:a.defines,customVertexShaderID:E,customFragmentShaderID:k,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:d,batching:D,batchingColor:D&&null!==m._colorsTexture,instancing:L,instancingColor:L&&null!==m.instanceColor,instancingMorph:L&&null!==m.morphTexture,supportsVertexTextures:f,outputColorSpace:null===N?e.outputColorSpace:!0===N.isXRRenderTarget?N.texture.colorSpace:Zn,alphaToCoverage:!!a.alphaToCoverage,map:O,matcap:U,envMap:B,envMapMode:B&&b.mapping,envMapCubeUVHeight:x,aoMap:F,lightMap:z,bumpMap:V,normalMap:q,displacementMap:f&&j,emissiveMap:G,normalMapObjectSpace:q&&1===a.normalMapType,normalMapTangentSpace:q&&0===a.normalMapType,metalnessMap:H,roughnessMap:W,anisotropy:X,anisotropyMap:$,clearcoat:Q,clearcoatMap:ee,clearcoatNormalMap:te,clearcoatRoughnessMap:ne,dispersion:Y,iridescence:K,iridescenceMap:re,iridescenceThicknessMap:ie,sheen:Z,sheenColorMap:ae,sheenRoughnessMap:oe,specularMap:se,specularColorMap:ue,specularIntensityMap:le,transmission:J,transmissionMap:ce,thicknessMap:he,gradientMap:fe,opaque:!1===a.transparent&&1===a.blending&&!1===a.alphaToCoverage,alphaMap:de,alphaTest:pe,alphaHash:Ae,combine:a.combine,mapUv:O&&A(a.map.channel),aoMapUv:F&&A(a.aoMap.channel),lightMapUv:z&&A(a.lightMap.channel),bumpMapUv:V&&A(a.bumpMap.channel),normalMapUv:q&&A(a.normalMap.channel),displacementMapUv:j&&A(a.displacementMap.channel),emissiveMapUv:G&&A(a.emissiveMap.channel),metalnessMapUv:H&&A(a.metalnessMap.channel),roughnessMapUv:W&&A(a.roughnessMap.channel),anisotropyMapUv:$&&A(a.anisotropyMap.channel),clearcoatMapUv:ee&&A(a.clearcoatMap.channel),clearcoatNormalMapUv:te&&A(a.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ne&&A(a.clearcoatRoughnessMap.channel),iridescenceMapUv:re&&A(a.iridescenceMap.channel),iridescenceThicknessMapUv:ie&&A(a.iridescenceThicknessMap.channel),sheenColorMapUv:ae&&A(a.sheenColorMap.channel),sheenRoughnessMapUv:oe&&A(a.sheenRoughnessMap.channel),specularMapUv:se&&A(a.specularMap.channel),specularColorMapUv:ue&&A(a.specularColorMap.channel),specularIntensityMapUv:le&&A(a.specularIntensityMap.channel),transmissionMapUv:ce&&A(a.transmissionMap.channel),thicknessMapUv:he&&A(a.thicknessMap.channel),alphaMapUv:de&&A(a.alphaMap.channel),vertexTangents:!!y.attributes.tangent&&(q||X),vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!y.attributes.color&&4===y.attributes.color.itemSize,pointsUvs:!0===m.isPoints&&!!y.attributes.uv&&(O||de),fog:!!g,useFog:!0===a.fog,fogExp2:!!g&&g.isFogExp2,flatShading:!0===a.flatShading,sizeAttenuation:!0===a.sizeAttenuation,logarithmicDepthBuffer:h,reverseDepthBuffer:I,skinning:!0===m.isSkinnedMesh,morphTargets:void 0!==y.morphAttributes.position,morphNormals:void 0!==y.morphAttributes.normal,morphColors:void 0!==y.morphAttributes.color,morphTargetsCount:C,morphTextureStride:R,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numSpotLightMaps:s.spotLightMap.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numSpotLightShadowsWithMaps:s.numSpotLightShadowsWithMaps,numLightProbes:s.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.length>0,shadowMapType:e.shadowMap.type,toneMapping:me,decodeVideoTexture:O&&!0===a.map.isVideoTexture&&Dr.getTransfer(a.map.colorSpace)===$n,decodeVideoTextureEmissive:G&&!0===a.emissiveMap.isVideoTexture&&Dr.getTransfer(a.emissiveMap.colorSpace)===$n,premultipliedAlpha:a.premultipliedAlpha,doubleSided:2===a.side,flipSided:1===a.side,useDepthPacking:a.depthPacking>=0,depthPacking:a.depthPacking||0,index0AttributeName:a.index0AttributeName,extensionClipCullDistance:ve&&!0===a.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ve&&!0===a.extensions.multiDraw||D)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:a.customProgramCacheKey()};return ge.vertexUv1s=l.has(1),ge.vertexUv2s=l.has(2),ge.vertexUv3s=l.has(3),l.clear(),ge},getProgramCacheKey:function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){s.disableAll(),t.supportsVertexTextures&&s.enable(0);t.instancing&&s.enable(1);t.instancingColor&&s.enable(2);t.instancingMorph&&s.enable(3);t.matcap&&s.enable(4);t.envMap&&s.enable(5);t.normalMapObjectSpace&&s.enable(6);t.normalMapTangentSpace&&s.enable(7);t.clearcoat&&s.enable(8);t.iridescence&&s.enable(9);t.alphaTest&&s.enable(10);t.vertexColors&&s.enable(11);t.vertexAlphas&&s.enable(12);t.vertexUv1s&&s.enable(13);t.vertexUv2s&&s.enable(14);t.vertexUv3s&&s.enable(15);t.vertexTangents&&s.enable(16);t.anisotropy&&s.enable(17);t.alphaHash&&s.enable(18);t.batching&&s.enable(19);t.dispersion&&s.enable(20);t.batchingColor&&s.enable(21);e.push(s.mask),s.disableAll(),t.fog&&s.enable(0);t.useFog&&s.enable(1);t.flatShading&&s.enable(2);t.logarithmicDepthBuffer&&s.enable(3);t.reverseDepthBuffer&&s.enable(4);t.skinning&&s.enable(5);t.morphTargets&&s.enable(6);t.morphNormals&&s.enable(7);t.morphColors&&s.enable(8);t.premultipliedAlpha&&s.enable(9);t.shadowMapEnabled&&s.enable(10);t.doubleSided&&s.enable(11);t.flipSided&&s.enable(12);t.useDepthPacking&&s.enable(13);t.dithering&&s.enable(14);t.transmission&&s.enable(15);t.sheen&&s.enable(16);t.opaque&&s.enable(17);t.pointsUvs&&s.enable(18);t.decodeVideoTexture&&s.enable(19);t.decodeVideoTextureEmissive&&s.enable(20);t.alphaToCoverage&&s.enable(21);e.push(s.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){var t,n=p[e.type];if(n){var r=JG[n];t=oo.clone(r.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,n){for(var r,i=0,o=c.length;i<o;i++){var s=c[i];if(s.cacheKey===n){++(r=s).usedTimes;break}}return void 0===r&&(r=new nX(e,n,t,a),c.push(r)),r},releaseProgram:function(e){if(0===--e.usedTimes){var t=c.indexOf(e);c[t]=c[c.length-1],c.pop(),e.destroy()}},releaseShaderCache:function(e){u.remove(e)},programs:c,dispose:function(){u.dispose()}}}function sX(){var e=new WeakMap;return{has:function(t){return e.has(t)},get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function uX(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function lX(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function cX(){var e=[],t=0,n=[],r=[],i=[];function a(n,r,i,a,o,s){var u=e[t];return void 0===u?(u={id:n.id,object:n,geometry:r,material:i,groupOrder:a,renderOrder:n.renderOrder,z:o,group:s},e[t]=u):(u.id=n.id,u.object=n,u.geometry=r,u.material=i,u.groupOrder=a,u.renderOrder=n.renderOrder,u.z=o,u.group=s),t++,u}return{opaque:n,transmissive:r,transparent:i,init:function(){t=0,n.length=0,r.length=0,i.length=0},push:function(e,t,o,s,u,l){var c=a(e,t,o,s,u,l);o.transmission>0?r.push(c):!0===o.transparent?i.push(c):n.push(c)},unshift:function(e,t,o,s,u,l){var c=a(e,t,o,s,u,l);o.transmission>0?r.unshift(c):!0===o.transparent?i.unshift(c):n.unshift(c)},finish:function(){for(var n=t,r=e.length;n<r;n++){var i=e[n];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.group=null}},sort:function(e,t){n.length>1&&n.sort(e||uX),r.length>1&&r.sort(t||lX),i.length>1&&i.sort(t||lX)}}}function hX(){var e=new WeakMap;return{get:function(t,n){var r,i=e.get(t);return void 0===i?(r=new cX,e.set(t,[r])):n>=i.length?(r=new cX,i.push(r)):r=i[n],r},dispose:function(){e=new WeakMap}}}function fX(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new Kr,color:new ga};break;case"SpotLight":n={position:new Kr,direction:new Kr,color:new ga,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Kr,color:new ga,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Kr,skyColor:new ga,groundColor:new ga};break;case"RectAreaLight":n={color:new ga,position:new Kr,halfWidth:new Kr,halfHeight:new Kr}}return e[t.id]=n,n}}}var dX=0;function pX(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function AX(e){for(var t=new fX,n=function(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new _r};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new _r,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0},i=0;i<9;i++)r.probe.push(new Kr);var a=new Kr,o=new Ei,s=new Ei;return{setup:function(i){for(var a=0,o=0,s=0,u=0;u<9;u++)r.probe[u].set(0,0,0);var l=0,c=0,h=0,f=0,d=0,p=0,A=0,v=0,m=0,g=0,y=0;i.sort(pX);for(var _=0,b=i.length;_<b;_++){var x=i[_],w=x.color,T=x.intensity,S=x.distance,E=x.shadow&&x.shadow.map?x.shadow.map.texture:null;if(x.isAmbientLight)a+=w.r*T,o+=w.g*T,s+=w.b*T;else if(x.isLightProbe){for(var k=0;k<9;k++)r.probe[k].addScaledVector(x.sh.coefficients[k],T);y++}else if(x.isDirectionalLight){var M=t.get(x);if(M.color.copy(x.color).multiplyScalar(x.intensity),x.castShadow){var C=x.shadow,R=n.get(x);R.shadowIntensity=C.intensity,R.shadowBias=C.bias,R.shadowNormalBias=C.normalBias,R.shadowRadius=C.radius,R.shadowMapSize=C.mapSize,r.directionalShadow[l]=R,r.directionalShadowMap[l]=E,r.directionalShadowMatrix[l]=x.shadow.matrix,p++}r.directional[l]=M,l++}else if(x.isSpotLight){var P=t.get(x);P.position.setFromMatrixPosition(x.matrixWorld),P.color.copy(w).multiplyScalar(T),P.distance=S,P.coneCos=Math.cos(x.angle),P.penumbraCos=Math.cos(x.angle*(1-x.penumbra)),P.decay=x.decay,r.spot[h]=P;var N=x.shadow;if(x.map&&(r.spotLightMap[m]=x.map,m++,N.updateMatrices(x),x.castShadow&&g++),r.spotLightMatrix[h]=N.matrix,x.castShadow){var I=n.get(x);I.shadowIntensity=N.intensity,I.shadowBias=N.bias,I.shadowNormalBias=N.normalBias,I.shadowRadius=N.radius,I.shadowMapSize=N.mapSize,r.spotShadow[h]=I,r.spotShadowMap[h]=E,v++}h++}else if(x.isRectAreaLight){var L=t.get(x);L.color.copy(w).multiplyScalar(T),L.halfWidth.set(.5*x.width,0,0),L.halfHeight.set(0,.5*x.height,0),r.rectArea[f]=L,f++}else if(x.isPointLight){var D=t.get(x);if(D.color.copy(x.color).multiplyScalar(x.intensity),D.distance=x.distance,D.decay=x.decay,x.castShadow){var O=x.shadow,U=n.get(x);U.shadowIntensity=O.intensity,U.shadowBias=O.bias,U.shadowNormalBias=O.normalBias,U.shadowRadius=O.radius,U.shadowMapSize=O.mapSize,U.shadowCameraNear=O.camera.near,U.shadowCameraFar=O.camera.far,r.pointShadow[c]=U,r.pointShadowMap[c]=E,r.pointShadowMatrix[c]=x.shadow.matrix,A++}r.point[c]=D,c++}else if(x.isHemisphereLight){var B=t.get(x);B.skyColor.copy(x.color).multiplyScalar(T),B.groundColor.copy(x.groundColor).multiplyScalar(T),r.hemi[d]=B,d++}}f>0&&(!0===e.has("OES_texture_float_linear")?(r.rectAreaLTC1=ZG.LTC_FLOAT_1,r.rectAreaLTC2=ZG.LTC_FLOAT_2):(r.rectAreaLTC1=ZG.LTC_HALF_1,r.rectAreaLTC2=ZG.LTC_HALF_2)),r.ambient[0]=a,r.ambient[1]=o,r.ambient[2]=s;var F=r.hash;F.directionalLength===l&&F.pointLength===c&&F.spotLength===h&&F.rectAreaLength===f&&F.hemiLength===d&&F.numDirectionalShadows===p&&F.numPointShadows===A&&F.numSpotShadows===v&&F.numSpotMaps===m&&F.numLightProbes===y||(r.directional.length=l,r.spot.length=h,r.rectArea.length=f,r.point.length=c,r.hemi.length=d,r.directionalShadow.length=p,r.directionalShadowMap.length=p,r.pointShadow.length=A,r.pointShadowMap.length=A,r.spotShadow.length=v,r.spotShadowMap.length=v,r.directionalShadowMatrix.length=p,r.pointShadowMatrix.length=A,r.spotLightMatrix.length=v+m-g,r.spotLightMap.length=m,r.numSpotLightShadowsWithMaps=g,r.numLightProbes=y,F.directionalLength=l,F.pointLength=c,F.spotLength=h,F.rectAreaLength=f,F.hemiLength=d,F.numDirectionalShadows=p,F.numPointShadows=A,F.numSpotShadows=v,F.numSpotMaps=m,F.numLightProbes=y,r.version=dX++)},setupView:function(e,t){for(var n=0,i=0,u=0,l=0,c=0,h=t.matrixWorldInverse,f=0,d=e.length;f<d;f++){var p=e[f];if(p.isDirectionalLight){var A=r.directional[n];A.direction.setFromMatrixPosition(p.matrixWorld),a.setFromMatrixPosition(p.target.matrixWorld),A.direction.sub(a),A.direction.transformDirection(h),n++}else if(p.isSpotLight){var v=r.spot[u];v.position.setFromMatrixPosition(p.matrixWorld),v.position.applyMatrix4(h),v.direction.setFromMatrixPosition(p.matrixWorld),a.setFromMatrixPosition(p.target.matrixWorld),v.direction.sub(a),v.direction.transformDirection(h),u++}else if(p.isRectAreaLight){var m=r.rectArea[l];m.position.setFromMatrixPosition(p.matrixWorld),m.position.applyMatrix4(h),s.identity(),o.copy(p.matrixWorld),o.premultiply(h),s.extractRotation(o),m.halfWidth.set(.5*p.width,0,0),m.halfHeight.set(0,.5*p.height,0),m.halfWidth.applyMatrix4(s),m.halfHeight.applyMatrix4(s),l++}else if(p.isPointLight){var g=r.point[i];g.position.setFromMatrixPosition(p.matrixWorld),g.position.applyMatrix4(h),i++}else if(p.isHemisphereLight){var y=r.hemi[c];y.direction.setFromMatrixPosition(p.matrixWorld),y.direction.transformDirection(h),c++}}},state:r}}function vX(e){var t=new AX(e),n=[],r=[];var i={lightsArray:n,shadowsArray:r,camera:null,lights:t,transmissionRenderTarget:{}};return{init:function(e){i.camera=e,n.length=0,r.length=0},state:i,setupLights:function(){t.setup(n)},setupLightsView:function(e){t.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){r.push(e)}}}function mX(e){var t=new WeakMap;return{get:function(n){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=t.get(n);return void 0===a?(r=new vX(e),t.set(n,[r])):i>=a.length?(r=new vX(e),a.push(r)):r=a[i],r},dispose:function(){t=new WeakMap}}}function gX(e,t,n){var r,i=new Lo,a=new _r,o=new _r,s=new Gr,u=new yu({depthPacking:3201}),l=new _u,c={},h=n.maxTextureSize,f=(We(r={},0,1),We(r,1,0),We(r,2,2),r),d=new so({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new _r},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=d.clone();p.defines.HORIZONTAL_PASS=1;var A=new qa;A.setAttribute("position",new Ra(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var v=new eo(A,d),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;var g=this.type;function y(n,r){var i=t.update(v);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new Wr(a.x,a.y)),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,d,v,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,p,v,null)}function _(t,n,r,i){var a=null,o=!0===r.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==o)a=o;else if(a=!0===r.isPointLight?l:u,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0){var s=a.uuid,h=n.uuid,d=c[s];void 0===d&&(d={},c[s]=d);var p=d[h];void 0===p&&(p=a.clone(),d[h]=p,n.addEventListener("dispose",x)),a=p}(a.visible=n.visible,a.wireframe=n.wireframe,a.side=3===i?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:f[n.side],a.alphaMap=n.alphaMap,a.alphaTest=n.alphaTest,a.map=n.map,a.clipShadows=n.clipShadows,a.clippingPlanes=n.clippingPlanes,a.clipIntersection=n.clipIntersection,a.displacementMap=n.displacementMap,a.displacementScale=n.displacementScale,a.displacementBias=n.displacementBias,a.wireframeLinewidth=n.wireframeLinewidth,a.linewidth=n.linewidth,!0===r.isPointLight&&!0===a.isMeshDistanceMaterial)&&(e.properties.get(a).light=r);return a}function b(n,r,a,o,s){if(!1!==n.visible){if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);var u=t.update(n),l=n.material;if(Array.isArray(l))for(var c=u.groups,h=0,f=c.length;h<f;h++){var d=c[h],p=l[d.materialIndex];if(p&&p.visible){var A=_(n,p,o,s);n.onBeforeShadow(e,n,r,a,u,A,d),e.renderBufferDirect(a,null,u,A,n,d),n.onAfterShadow(e,n,r,a,u,A,d)}}else if(l.visible){var v=_(n,l,o,s);n.onBeforeShadow(e,n,r,a,u,v,null),e.renderBufferDirect(a,null,u,v,n,null),n.onAfterShadow(e,n,r,a,u,v,null)}}for(var m=n.children,g=0,y=m.length;g<y;g++)b(m[g],r,a,o,s)}}function x(e){var t=e.target;for(var n in t.removeEventListener("dispose",x),c){var r=c[n],i=e.target.uuid;if(i in r)r[i].dispose(),delete r[i]}}this.render=function(t,n,r){if(!1!==m.enabled&&(!1!==m.autoUpdate||!1!==m.needsUpdate)&&0!==t.length){var u=e.getRenderTarget(),l=e.getActiveCubeFace(),c=e.getActiveMipmapLevel(),f=e.state;f.setBlending(0),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(var d=3!==g&&3===this.type,p=3===g&&3!==this.type,A=0,v=t.length;A<v;A++){var _=t[A],x=_.shadow;if(void 0!==x){if(!1!==x.autoUpdate||!1!==x.needsUpdate){a.copy(x.mapSize);var w=x.getFrameExtents();if(a.multiply(w),o.copy(x.mapSize),(a.x>h||a.y>h)&&(a.x>h&&(o.x=Math.floor(h/w.x),a.x=o.x*w.x,x.mapSize.x=o.x),a.y>h&&(o.y=Math.floor(h/w.y),a.y=o.y*w.y,x.mapSize.y=o.y)),null===x.map||!0===d||!0===p){var T=3!==this.type?{minFilter:Lt,magFilter:Lt}:{};null!==x.map&&x.map.dispose(),x.map=new Wr(a.x,a.y,T),x.map.texture.name=_.name+".shadowMap",x.camera.updateProjectionMatrix()}e.setRenderTarget(x.map),e.clear();for(var S=x.getViewportCount(),E=0;E<S;E++){var k=x.getViewport(E);s.set(o.x*k.x,o.y*k.y,o.x*k.z,o.y*k.w),f.viewport(s),x.updateMatrices(_,E),i=x.getFrustum(),b(n,r,x.camera,_,this.type)}!0!==x.isPointLightShadow&&3===this.type&&y(x,r),x.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",_,"has no shadow.")}g=this.type,m.needsUpdate=!1,e.setRenderTarget(u,l,c)}}}var yX=(We(gG={},0,1),We(gG,2,6),We(gG,4,7),We(gG,3,5),We(gG,1,0),We(gG,6,2),We(gG,7,4),We(gG,5,3),gG);function _X(e,t){var n,r;var i=new function(){var t=!1,n=new Gr,r=null,i=new Gr(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){!0===s&&(t*=o,r*=o,a*=o),n.set(t,r,a,o),!1===i.equals(n)&&(e.clearColor(t,r,a,o),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},a=new function(){var n=!1,r=!1,i=null,a=null,o=null;return{setReversed:function(e){if(r!==e){var n=t.get("EXT_clip_control");e?n.clipControlEXT(n.LOWER_LEFT_EXT,n.ZERO_TO_ONE_EXT):n.clipControlEXT(n.LOWER_LEFT_EXT,n.NEGATIVE_ONE_TO_ONE_EXT),r=e;var i=o;o=null,this.setClear(i)}},getReversed:function(){return r},setTest:function(t){t?q(e.DEPTH_TEST):j(e.DEPTH_TEST)},setMask:function(t){i===t||n||(e.depthMask(t),i=t)},setFunc:function(t){if(r&&(t=yX[t]),a!==t){switch(t){case 0:e.depthFunc(e.NEVER);break;case 1:e.depthFunc(e.ALWAYS);break;case 2:e.depthFunc(e.LESS);break;case 3:default:e.depthFunc(e.LEQUAL);break;case 4:e.depthFunc(e.EQUAL);break;case 5:e.depthFunc(e.GEQUAL);break;case 6:e.depthFunc(e.GREATER);break;case 7:e.depthFunc(e.NOTEQUAL)}a=t}},setLocked:function(e){n=e},setClear:function(t){o!==t&&(r&&(t=1-t),e.clearDepth(t),o=t)},reset:function(){n=!1,i=null,a=null,o=null,r=!1}}},o=new function(){var t=!1,n=null,r=null,i=null,a=null,o=null,s=null,u=null,l=null;return{setTest:function(n){t||(n?q(e.STENCIL_TEST):j(e.STENCIL_TEST))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&i===n&&a===o||(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){o===t&&s===n&&u===r||(e.stencilOp(t,n,r),o=t,s=n,u=r)},setLocked:function(e){t=e},setClear:function(t){l!==t&&(e.clearStencil(t),l=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,o=null,s=null,u=null,l=null}}},s=new WeakMap,u=new WeakMap,l={},c={},h=new WeakMap,f=[],d=null,p=!1,A=null,v=null,m=null,g=null,y=null,_=null,b=null,x=new ga(0,0,0),w=0,T=!1,S=null,E=null,k=null,M=null,C=null,R=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),P=!1,N=0,I=e.getParameter(e.VERSION);-1!==I.indexOf("WebGL")?(N=parseFloat(/^WebGL (\d)/.exec(I)[1]),P=N>=1):-1!==I.indexOf("OpenGL ES")&&(N=parseFloat(/^OpenGL ES (\d)/.exec(I)[1]),P=N>=2);var L=null,D={},O=e.getParameter(e.SCISSOR_BOX),U=e.getParameter(e.VIEWPORT),B=(new Gr).fromArray(O),F=(new Gr).fromArray(U);function z(t,n,r,i){var a=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var s=0;s<r;s++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,i,0,e.RGBA,e.UNSIGNED_BYTE,a):e.texImage2D(n+s,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,a);return o}var V={};function q(t){!0!==l[t]&&(e.enable(t),l[t]=!0)}function j(t){!1!==l[t]&&(e.disable(t),l[t]=!1)}V[e.TEXTURE_2D]=z(e.TEXTURE_2D,e.TEXTURE_2D,1),V[e.TEXTURE_CUBE_MAP]=z(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),V[e.TEXTURE_2D_ARRAY]=z(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),V[e.TEXTURE_3D]=z(e.TEXTURE_3D,e.TEXTURE_3D,1,1),i.setClear(0,0,0,1),a.setClear(1),o.setClear(0),q(e.DEPTH_TEST),a.setFunc(3),X(!1),Q(1),q(e.CULL_FACE),W(0);var G=(We(n={},bt,e.FUNC_ADD),We(n,101,e.FUNC_SUBTRACT),We(n,102,e.FUNC_REVERSE_SUBTRACT),n);G[103]=e.MIN,G[104]=e.MAX;var H=(We(r={},xt,e.ZERO),We(r,201,e.ONE),We(r,202,e.SRC_COLOR),We(r,wt,e.SRC_ALPHA),We(r,210,e.SRC_ALPHA_SATURATE),We(r,208,e.DST_COLOR),We(r,206,e.DST_ALPHA),We(r,203,e.ONE_MINUS_SRC_COLOR),We(r,Tt,e.ONE_MINUS_SRC_ALPHA),We(r,209,e.ONE_MINUS_DST_COLOR),We(r,207,e.ONE_MINUS_DST_ALPHA),We(r,211,e.CONSTANT_COLOR),We(r,212,e.ONE_MINUS_CONSTANT_COLOR),We(r,213,e.CONSTANT_ALPHA),We(r,214,e.ONE_MINUS_CONSTANT_ALPHA),r);function W(t,n,r,i,a,o,s,u,l,c){if(0!==t){if(!1===p&&(q(e.BLEND),p=!0),5===t)a=a||n,o=o||r,s=s||i,n===v&&a===y||(e.blendEquationSeparate(G[n],G[a]),v=n,y=a),r===m&&i===g&&o===_&&s===b||(e.blendFuncSeparate(H[r],H[i],H[o],H[s]),m=r,g=i,_=o,b=s),!1!==u.equals(x)&&l===w||(e.blendColor(u.r,u.g,u.b,l),x.copy(u),w=l),A=t,T=!1;else if(t!==A||c!==T){if(v===bt&&y===bt||(e.blendEquation(e.FUNC_ADD),v=bt,y=bt),c)switch(t){case 1:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.ONE,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}m=null,g=null,_=null,b=null,x.set(0,0,0),w=0,A=t,T=c}}else!0===p&&(j(e.BLEND),p=!1)}function X(t){S!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),S=t)}function Q(t){0!==t?(q(e.CULL_FACE),t!==E&&(1===t?e.cullFace(e.BACK):2===t?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):j(e.CULL_FACE),E=t}function Y(t,n,r){t?(q(e.POLYGON_OFFSET_FILL),M===n&&C===r||(e.polygonOffset(n,r),M=n,C=r)):j(e.POLYGON_OFFSET_FILL)}return{buffers:{color:i,depth:a,stencil:o},enable:q,disable:j,bindFramebuffer:function(t,n){return c[t]!==n&&(e.bindFramebuffer(t,n),c[t]=n,t===e.DRAW_FRAMEBUFFER&&(c[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(c[e.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(t,n){var r=f,i=!1;if(t){void 0===(r=h.get(n))&&(r=[],h.set(n,r));var a=t.textures;if(r.length!==a.length||r[0]!==e.COLOR_ATTACHMENT0){for(var o=0,s=a.length;o<s;o++)r[o]=e.COLOR_ATTACHMENT0+o;r.length=a.length,i=!0}}else r[0]!==e.BACK&&(r[0]=e.BACK,i=!0);i&&e.drawBuffers(r)},useProgram:function(t){return d!==t&&(e.useProgram(t),d=t,!0)},setBlending:W,setMaterial:function(t,n){2===t.side?j(e.CULL_FACE):q(e.CULL_FACE);var r=1===t.side;n&&(r=!r),X(r),1===t.blending&&!1===t.transparent?W(0):W(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),a.setFunc(t.depthFunc),a.setTest(t.depthTest),a.setMask(t.depthWrite),i.setMask(t.colorWrite);var s=t.stencilWrite;o.setTest(s),s&&(o.setMask(t.stencilWriteMask),o.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),o.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Y(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?q(e.SAMPLE_ALPHA_TO_COVERAGE):j(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:X,setCullFace:Q,setLineWidth:function(t){t!==k&&(P&&e.lineWidth(t),k=t)},setPolygonOffset:Y,setScissorTest:function(t){t?q(e.SCISSOR_TEST):j(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+R-1),L!==t&&(e.activeTexture(t),L=t)},bindTexture:function(t,n,r){void 0===r&&(r=null===L?e.TEXTURE0+R-1:L);var i=D[r];void 0===i&&(i={type:void 0,texture:void 0},D[r]=i),i.type===t&&i.texture===n||(L!==r&&(e.activeTexture(r),L=r),e.bindTexture(t,n||V[t]),i.type=t,i.texture=n)},unbindTexture:function(){var t=D[L];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},updateUBOMapping:function(t,n){var r=u.get(n);void 0===r&&(r=new WeakMap,u.set(n,r));var i=r.get(t);void 0===i&&(i=e.getUniformBlockIndex(n,t.name),r.set(t,i))},uniformBlockBinding:function(t,n){var r=u.get(n).get(t);s.get(n)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),s.set(n,r))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===B.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),B.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),a.setReversed(!1),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),l={},L=null,D={},c={},h=new WeakMap,f=[],d=null,p=!1,A=null,v=null,m=null,g=null,y=null,_=null,b=null,x=new ga(0,0,0),w=0,T=!1,S=null,E=null,k=null,M=null,C=null,B.set(0,0,e.canvas.width,e.canvas.height),F.set(0,0,e.canvas.width,e.canvas.height),i.reset(),a.reset(),o.reset()}}}function bX(e,t,n,r,i,a,o){var s,u,l,c,h=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,f="undefined"!==typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),d=new _r,p=new WeakMap,A=new WeakMap,v=!1;try{v="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(W){}function m(e,t){return v?new OffscreenCanvas(e,t):Tr("canvas")}function g(e,t,n){var r=1,i=H(e);if((i.width>n||i.height>n)&&(r=n/Math.max(i.width,i.height)),r<1){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof VideoFrame&&e instanceof VideoFrame){var a=Math.floor(r*i.width),o=Math.floor(r*i.height);void 0===c&&(c=m(a,o));var s=t?m(a,o):c;return s.width=a,s.height=o,s.getContext("2d").drawImage(e,0,0,a,o),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+i.width+"x"+i.height+") to ("+a+"x"+o+")."),s}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+i.width+"x"+i.height+")."),e}return e}function y(e){return e.generateMipmaps}function _(t){e.generateMipmap(t)}function b(t){return t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:t.isWebGL3DRenderTarget?e.TEXTURE_3D:t.isWebGLArrayRenderTarget||t.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D}function x(n,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var s=r;if(r===e.RED&&(i===e.FLOAT&&(s=e.R32F),i===e.HALF_FLOAT&&(s=e.R16F),i===e.UNSIGNED_BYTE&&(s=e.R8)),r===e.RED_INTEGER&&(i===e.UNSIGNED_BYTE&&(s=e.R8UI),i===e.UNSIGNED_SHORT&&(s=e.R16UI),i===e.UNSIGNED_INT&&(s=e.R32UI),i===e.BYTE&&(s=e.R8I),i===e.SHORT&&(s=e.R16I),i===e.INT&&(s=e.R32I)),r===e.RG&&(i===e.FLOAT&&(s=e.RG32F),i===e.HALF_FLOAT&&(s=e.RG16F),i===e.UNSIGNED_BYTE&&(s=e.RG8)),r===e.RG_INTEGER&&(i===e.UNSIGNED_BYTE&&(s=e.RG8UI),i===e.UNSIGNED_SHORT&&(s=e.RG16UI),i===e.UNSIGNED_INT&&(s=e.RG32UI),i===e.BYTE&&(s=e.RG8I),i===e.SHORT&&(s=e.RG16I),i===e.INT&&(s=e.RG32I)),r===e.RGB_INTEGER&&(i===e.UNSIGNED_BYTE&&(s=e.RGB8UI),i===e.UNSIGNED_SHORT&&(s=e.RGB16UI),i===e.UNSIGNED_INT&&(s=e.RGB32UI),i===e.BYTE&&(s=e.RGB8I),i===e.SHORT&&(s=e.RGB16I),i===e.INT&&(s=e.RGB32I)),r===e.RGBA_INTEGER&&(i===e.UNSIGNED_BYTE&&(s=e.RGBA8UI),i===e.UNSIGNED_SHORT&&(s=e.RGBA16UI),i===e.UNSIGNED_INT&&(s=e.RGBA32UI),i===e.BYTE&&(s=e.RGBA8I),i===e.SHORT&&(s=e.RGBA16I),i===e.INT&&(s=e.RGBA32I)),r===e.RGB&&i===e.UNSIGNED_INT_5_9_9_9_REV&&(s=e.RGB9_E5),r===e.RGBA){var u=o?Jn:Dr.getTransfer(a);i===e.FLOAT&&(s=e.RGBA32F),i===e.HALF_FLOAT&&(s=e.RGBA16F),i===e.UNSIGNED_BYTE&&(s=u===$n?e.SRGB8_ALPHA8:e.RGBA8),i===e.UNSIGNED_SHORT_4_4_4_4&&(s=e.RGBA4),i===e.UNSIGNED_SHORT_5_5_5_1&&(s=e.RGB5_A1)}return s!==e.R16F&&s!==e.R32F&&s!==e.RG16F&&s!==e.RG32F&&s!==e.RGBA16F&&s!==e.RGBA32F||t.get("EXT_color_buffer_float"),s}function w(t,n){var r;return t?null===n||n===Ht||n===Kt?r=e.DEPTH24_STENCIL8:n===Wt?r=e.DEPTH32F_STENCIL8:n===jt&&(r=e.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===n||n===Ht||n===Kt?r=e.DEPTH_COMPONENT24:n===Wt?r=e.DEPTH_COMPONENT32F:n===jt&&(r=e.DEPTH_COMPONENT16),r}function T(e,t){return!0===y(e)||e.isFramebufferTexture&&e.minFilter!==Lt&&e.minFilter!==Ut?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function S(e){var t=e.target;t.removeEventListener("dispose",S),function(e){var t=r.get(e);if(void 0===t.__webglInit)return;var n=e.source,i=A.get(n);if(i){var a=i[t.__cacheKey];a.usedTimes--,0===a.usedTimes&&M(e),0===Object.keys(i).length&&A.delete(n)}r.remove(e)}(t),t.isVideoTexture&&p.delete(t)}function E(t){var n=t.target;n.removeEventListener("dispose",E),function(t){var n=r.get(t);t.depthTexture&&(t.depthTexture.dispose(),r.remove(t.depthTexture));if(t.isWebGLCubeRenderTarget)for(var i=0;i<6;i++){if(Array.isArray(n.__webglFramebuffer[i]))for(var a=0;a<n.__webglFramebuffer[i].length;a++)e.deleteFramebuffer(n.__webglFramebuffer[i][a]);else e.deleteFramebuffer(n.__webglFramebuffer[i]);n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[i])}else{if(Array.isArray(n.__webglFramebuffer))for(var s=0;s<n.__webglFramebuffer.length;s++)e.deleteFramebuffer(n.__webglFramebuffer[s]);else e.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(var u=0;u<n.__webglColorRenderbuffer.length;u++)n.__webglColorRenderbuffer[u]&&e.deleteRenderbuffer(n.__webglColorRenderbuffer[u]);n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer)}for(var l=t.textures,c=0,h=l.length;c<h;c++){var f=r.get(l[c]);f.__webglTexture&&(e.deleteTexture(f.__webglTexture),o.memory.textures--),r.remove(l[c])}r.remove(t)}(n)}function M(t){var n=r.get(t);e.deleteTexture(n.__webglTexture);var i=t.source;delete A.get(i)[n.__cacheKey],o.memory.textures--}var C=0;function R(t,i){var a=r.get(t);if(t.isVideoTexture&&function(e){var t=o.render.frame;p.get(e)!==t&&(p.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version){var s=t.image;if(null===s)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==s.complete)return void O(a,t,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.bindTexture(e.TEXTURE_2D,a.__webglTexture,e.TEXTURE0+i)}var P=(We(s={},Pt,e.REPEAT),We(s,Nt,e.CLAMP_TO_EDGE),We(s,It,e.MIRRORED_REPEAT),s),N=(We(u={},Lt,e.NEAREST),We(u,Dt,e.NEAREST_MIPMAP_NEAREST),We(u,Ot,e.NEAREST_MIPMAP_LINEAR),We(u,Ut,e.LINEAR),We(u,Bt,e.LINEAR_MIPMAP_NEAREST),We(u,Ft,e.LINEAR_MIPMAP_LINEAR),u),I=(We(l={},512,e.NEVER),We(l,519,e.ALWAYS),We(l,tr,e.LESS),We(l,nr,e.LEQUAL),We(l,514,e.EQUAL),We(l,518,e.GEQUAL),We(l,516,e.GREATER),We(l,517,e.NOTEQUAL),l);function L(n,a){if(a.type!==Wt||!1!==t.has("OES_texture_float_linear")||a.magFilter!==Ut&&a.magFilter!==Bt&&a.magFilter!==Ot&&a.magFilter!==Ft&&a.minFilter!==Ut&&a.minFilter!==Bt&&a.minFilter!==Ot&&a.minFilter!==Ft||console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(n,e.TEXTURE_WRAP_S,P[a.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,P[a.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,P[a.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,N[a.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,N[a.minFilter]),a.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,I[a.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){if(a.magFilter===Lt)return;if(a.minFilter!==Ot&&a.minFilter!==Ft)return;if(a.type===Wt&&!1===t.has("OES_texture_float_linear"))return;if(a.anisotropy>1||r.get(a).__currentAnisotropy){var o=t.get("EXT_texture_filter_anisotropic");e.texParameterf(n,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy}}}function D(t,n){var r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",S));var i=n.source,a=A.get(i);void 0===a&&(a={},A.set(i,a));var s=function(e){var t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(s!==t.__cacheKey){void 0===a[s]&&(a[s]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,r=!0),a[s].usedTimes++;var u=a[t.__cacheKey];void 0!==u&&(a[t.__cacheKey].usedTimes--,0===u.usedTimes&&M(n)),t.__cacheKey=s,t.__webglTexture=a[s].texture}return r}function O(t,o,s){var u=e.TEXTURE_2D;(o.isDataArrayTexture||o.isCompressedArrayTexture)&&(u=e.TEXTURE_2D_ARRAY),o.isData3DTexture&&(u=e.TEXTURE_3D);var l=D(t,o),c=o.source;n.bindTexture(u,t.__webglTexture,e.TEXTURE0+s);var h=r.get(c);if(c.version!==h.__version||!0===l){n.activeTexture(e.TEXTURE0+s);var f=Dr.getPrimaries(Dr.workingColorSpace),d=o.colorSpace===Yn?null:Dr.getPrimaries(o.colorSpace),p=o.colorSpace===Yn||f===d?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,o.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,o.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,p);var A=g(o.image,!1,i.maxTextureSize);A=G(o,A);var v,m=a.convert(o.format,o.colorSpace),b=a.convert(o.type),S=x(o.internalFormat,m,b,o.colorSpace,o.isVideoTexture);L(u,o);var E=o.mipmaps,M=!0!==o.isVideoTexture,C=void 0===h.__version||!0===l,R=c.dataReady,P=T(o,A);if(o.isDepthTexture)S=w(o.format===an,o.type),C&&(M?n.texStorage2D(e.TEXTURE_2D,1,S,A.width,A.height):n.texImage2D(e.TEXTURE_2D,0,S,A.width,A.height,0,m,b,null));else if(o.isDataTexture)if(E.length>0){M&&C&&n.texStorage2D(e.TEXTURE_2D,P,S,E[0].width,E[0].height);for(var N=0,I=E.length;N<I;N++)v=E[N],M?R&&n.texSubImage2D(e.TEXTURE_2D,N,0,0,v.width,v.height,m,b,v.data):n.texImage2D(e.TEXTURE_2D,N,S,v.width,v.height,0,m,b,v.data);o.generateMipmaps=!1}else M?(C&&n.texStorage2D(e.TEXTURE_2D,P,S,A.width,A.height),R&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,A.width,A.height,m,b,A.data)):n.texImage2D(e.TEXTURE_2D,0,S,A.width,A.height,0,m,b,A.data);else if(o.isCompressedTexture)if(o.isCompressedArrayTexture){M&&C&&n.texStorage3D(e.TEXTURE_2D_ARRAY,P,S,E[0].width,E[0].height,A.depth);for(var O=0,U=E.length;O<U;O++)if(v=E[O],o.format!==en)if(null!==m)if(M){if(R)if(o.layerUpdates.size>0){var B,F=Il(v.width,v.height,o.format,o.type),z=k(o.layerUpdates);try{for(z.s();!(B=z.n()).done;){var V=B.value,q=v.data.subarray(V*F/v.data.BYTES_PER_ELEMENT,(V+1)*F/v.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,O,0,0,V,v.width,v.height,1,m,q)}}catch(W){z.e(W)}finally{z.f()}o.clearLayerUpdates()}else n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,O,0,0,0,v.width,v.height,A.depth,m,v.data)}else n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,O,S,v.width,v.height,A.depth,0,v.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else M?R&&n.texSubImage3D(e.TEXTURE_2D_ARRAY,O,0,0,0,v.width,v.height,A.depth,m,b,v.data):n.texImage3D(e.TEXTURE_2D_ARRAY,O,S,v.width,v.height,A.depth,0,m,b,v.data)}else{M&&C&&n.texStorage2D(e.TEXTURE_2D,P,S,E[0].width,E[0].height);for(var j=0,X=E.length;j<X;j++)v=E[j],o.format!==en?null!==m?M?R&&n.compressedTexSubImage2D(e.TEXTURE_2D,j,0,0,v.width,v.height,m,v.data):n.compressedTexImage2D(e.TEXTURE_2D,j,S,v.width,v.height,0,v.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):M?R&&n.texSubImage2D(e.TEXTURE_2D,j,0,0,v.width,v.height,m,b,v.data):n.texImage2D(e.TEXTURE_2D,j,S,v.width,v.height,0,m,b,v.data)}else if(o.isDataArrayTexture)if(M){if(C&&n.texStorage3D(e.TEXTURE_2D_ARRAY,P,S,A.width,A.height,A.depth),R)if(o.layerUpdates.size>0){var Q,Y=Il(A.width,A.height,o.format,o.type),K=k(o.layerUpdates);try{for(K.s();!(Q=K.n()).done;){var Z=Q.value,J=A.data.subarray(Z*Y/A.data.BYTES_PER_ELEMENT,(Z+1)*Y/A.data.BYTES_PER_ELEMENT);n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,Z,A.width,A.height,1,m,b,J)}}catch(W){K.e(W)}finally{K.f()}o.clearLayerUpdates()}else n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,A.width,A.height,A.depth,m,b,A.data)}else n.texImage3D(e.TEXTURE_2D_ARRAY,0,S,A.width,A.height,A.depth,0,m,b,A.data);else if(o.isData3DTexture)M?(C&&n.texStorage3D(e.TEXTURE_3D,P,S,A.width,A.height,A.depth),R&&n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,A.width,A.height,A.depth,m,b,A.data)):n.texImage3D(e.TEXTURE_3D,0,S,A.width,A.height,A.depth,0,m,b,A.data);else if(o.isFramebufferTexture){if(C)if(M)n.texStorage2D(e.TEXTURE_2D,P,S,A.width,A.height);else for(var $=A.width,ee=A.height,te=0;te<P;te++)n.texImage2D(e.TEXTURE_2D,te,S,$,ee,0,m,b,null),$>>=1,ee>>=1}else if(E.length>0){if(M&&C){var ne=H(E[0]);n.texStorage2D(e.TEXTURE_2D,P,S,ne.width,ne.height)}for(var re=0,ie=E.length;re<ie;re++)v=E[re],M?R&&n.texSubImage2D(e.TEXTURE_2D,re,0,0,m,b,v):n.texImage2D(e.TEXTURE_2D,re,S,m,b,v);o.generateMipmaps=!1}else if(M){if(C){var ae=H(A);n.texStorage2D(e.TEXTURE_2D,P,S,ae.width,ae.height)}R&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,m,b,A)}else n.texImage2D(e.TEXTURE_2D,0,S,m,b,A);y(o)&&_(u),h.__version=c.version,o.onUpdate&&o.onUpdate(o)}t.__version=o.version}function U(t,i,o,s,u,l){var c=a.convert(o.format,o.colorSpace),f=a.convert(o.type),d=x(o.internalFormat,c,f,o.colorSpace),p=r.get(i),A=r.get(o);if(A.__renderTarget=i,!p.__hasExternalTextures){var v=Math.max(1,i.width>>l),m=Math.max(1,i.height>>l);u===e.TEXTURE_3D||u===e.TEXTURE_2D_ARRAY?n.texImage3D(u,l,d,v,m,i.depth,0,c,f,null):n.texImage2D(u,l,d,v,m,0,c,f,null)}n.bindFramebuffer(e.FRAMEBUFFER,t),j(i)?h.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,s,u,A.__webglTexture,0,q(i)):(u===e.TEXTURE_2D||u>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&u<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,s,u,A.__webglTexture,l),n.bindFramebuffer(e.FRAMEBUFFER,null)}function B(t,n,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer){var i=n.depthTexture,o=i&&i.isDepthTexture?i.type:null,s=w(n.stencilBuffer,o),u=n.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,l=q(n);j(n)?h.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,l,s,n.width,n.height):r?e.renderbufferStorageMultisample(e.RENDERBUFFER,l,s,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,s,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,u,e.RENDERBUFFER,t)}else for(var c=n.textures,f=0;f<c.length;f++){var d=c[f],p=a.convert(d.format,d.colorSpace),A=a.convert(d.type),v=x(d.internalFormat,p,A,d.colorSpace),m=q(n);r&&!1===j(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,m,v,n.width,n.height):j(n)?h.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,m,v,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,v,n.width,n.height)}e.bindRenderbuffer(e.RENDERBUFFER,null)}function F(t){var i=r.get(t),a=!0===t.isWebGLCubeRenderTarget;if(i.__boundDepthTexture!==t.depthTexture){var o=t.depthTexture;if(i.__depthDisposeCallback&&i.__depthDisposeCallback(),o){var s=function e(){delete i.__boundDepthTexture,delete i.__depthDisposeCallback,o.removeEventListener("dispose",e)};o.addEventListener("dispose",s),i.__depthDisposeCallback=s}i.__boundDepthTexture=o}if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(a)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");var a=r.get(i.depthTexture);a.__renderTarget=i,a.__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),R(i.depthTexture,0);var o=a.__webglTexture,s=q(i);if(i.depthTexture.format===rn)j(i)?h.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,o,0,s):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,o,0);else{if(i.depthTexture.format!==an)throw new Error("Unknown depthTexture format");j(i)?h.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,o,0,s):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,o,0)}}(i.__webglFramebuffer,t)}else if(a){i.__webglDepthbuffer=[];for(var u=0;u<6;u++)if(n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[u]),void 0===i.__webglDepthbuffer[u])i.__webglDepthbuffer[u]=e.createRenderbuffer(),B(i.__webglDepthbuffer[u],t,!1);else{var l=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,c=i.__webglDepthbuffer[u];e.bindRenderbuffer(e.RENDERBUFFER,c),e.framebufferRenderbuffer(e.FRAMEBUFFER,l,e.RENDERBUFFER,c)}}else if(n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer),void 0===i.__webglDepthbuffer)i.__webglDepthbuffer=e.createRenderbuffer(),B(i.__webglDepthbuffer,t,!1);else{var f=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,d=i.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,d),e.framebufferRenderbuffer(e.FRAMEBUFFER,f,e.RENDERBUFFER,d)}n.bindFramebuffer(e.FRAMEBUFFER,null)}var z=[],V=[];function q(e){return Math.min(i.maxSamples,e.samples)}function j(e){var n=r.get(e);return e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function G(e,t){var n=e.colorSpace,r=e.format,i=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||n!==Zn&&n!==Yn&&(Dr.getTransfer(n)===$n?r===en&&i===zt||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",n)),t}function H(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement?(d.width=e.naturalWidth||e.width,d.height=e.naturalHeight||e.height):"undefined"!==typeof VideoFrame&&e instanceof VideoFrame?(d.width=e.displayWidth,d.height=e.displayHeight):(d.width=e.width,d.height=e.height),d}this.allocateTextureUnit=function(){var e=C;return e>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+i.maxTextures),C+=1,e},this.resetTextureUnits=function(){C=0},this.setTexture2D=R,this.setTexture2DArray=function(t,i){var a=r.get(t);t.version>0&&a.__version!==t.version?O(a,t,i):n.bindTexture(e.TEXTURE_2D_ARRAY,a.__webglTexture,e.TEXTURE0+i)},this.setTexture3D=function(t,i){var a=r.get(t);t.version>0&&a.__version!==t.version?O(a,t,i):n.bindTexture(e.TEXTURE_3D,a.__webglTexture,e.TEXTURE0+i)},this.setTextureCube=function(t,o){var s=r.get(t);t.version>0&&s.__version!==t.version?function(t,o,s){if(6!==o.image.length)return;var u=D(t,o),l=o.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+s);var c=r.get(l);if(l.version!==c.__version||!0===u){n.activeTexture(e.TEXTURE0+s);var h=Dr.getPrimaries(Dr.workingColorSpace),f=o.colorSpace===Yn?null:Dr.getPrimaries(o.colorSpace),d=o.colorSpace===Yn||h===f?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,o.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,o.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);for(var p=o.isCompressedTexture||o.image[0].isCompressedTexture,A=o.image[0]&&o.image[0].isDataTexture,v=[],m=0;m<6;m++)v[m]=p||A?A?o.image[m].image:o.image[m]:g(o.image[m],!0,i.maxCubemapSize),v[m]=G(o,v[m]);var b,w=v[0],S=a.convert(o.format,o.colorSpace),E=a.convert(o.type),k=x(o.internalFormat,S,E,o.colorSpace),M=!0!==o.isVideoTexture,C=void 0===c.__version||!0===u,R=l.dataReady,P=T(o,w);if(L(e.TEXTURE_CUBE_MAP,o),p){M&&C&&n.texStorage2D(e.TEXTURE_CUBE_MAP,P,k,w.width,w.height);for(var N=0;N<6;N++){b=v[N].mipmaps;for(var I=0;I<b.length;I++){var O=b[I];o.format!==en?null!==S?M?R&&n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+N,I,0,0,O.width,O.height,S,O.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+N,I,k,O.width,O.height,0,O.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):M?R&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+N,I,0,0,O.width,O.height,S,E,O.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+N,I,k,O.width,O.height,0,S,E,O.data)}}}else{if(b=o.mipmaps,M&&C){b.length>0&&P++;var U=H(v[0]);n.texStorage2D(e.TEXTURE_CUBE_MAP,P,k,U.width,U.height)}for(var B=0;B<6;B++)if(A){M?R&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+B,0,0,0,v[B].width,v[B].height,S,E,v[B].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+B,0,k,v[B].width,v[B].height,0,S,E,v[B].data);for(var F=0;F<b.length;F++){var z=b[F].image[B].image;M?R&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+B,F+1,0,0,z.width,z.height,S,E,z.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+B,F+1,k,z.width,z.height,0,S,E,z.data)}}else{M?R&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+B,0,0,0,S,E,v[B]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+B,0,k,S,E,v[B]);for(var V=0;V<b.length;V++){var q=b[V];M?R&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+B,V+1,0,0,S,E,q.image[B]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+B,V+1,k,S,E,q.image[B])}}}y(o)&&_(e.TEXTURE_CUBE_MAP),c.__version=l.version,o.onUpdate&&o.onUpdate(o)}t.__version=o.version}(s,t,o):n.bindTexture(e.TEXTURE_CUBE_MAP,s.__webglTexture,e.TEXTURE0+o)},this.rebindTextures=function(t,n,i){var a=r.get(t);void 0!==n&&U(a.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==i&&F(t)},this.setupRenderTarget=function(t){var i=t.texture,s=r.get(t),u=r.get(i);t.addEventListener("dispose",E);var l=t.textures,c=!0===t.isWebGLCubeRenderTarget,h=l.length>1;if(h||(void 0===u.__webglTexture&&(u.__webglTexture=e.createTexture()),u.__version=i.version,o.memory.textures++),c){s.__webglFramebuffer=[];for(var f=0;f<6;f++)if(i.mipmaps&&i.mipmaps.length>0){s.__webglFramebuffer[f]=[];for(var d=0;d<i.mipmaps.length;d++)s.__webglFramebuffer[f][d]=e.createFramebuffer()}else s.__webglFramebuffer[f]=e.createFramebuffer()}else{if(i.mipmaps&&i.mipmaps.length>0){s.__webglFramebuffer=[];for(var p=0;p<i.mipmaps.length;p++)s.__webglFramebuffer[p]=e.createFramebuffer()}else s.__webglFramebuffer=e.createFramebuffer();if(h)for(var A=0,v=l.length;A<v;A++){var m=r.get(l[A]);void 0===m.__webglTexture&&(m.__webglTexture=e.createTexture(),o.memory.textures++)}if(t.samples>0&&!1===j(t)){s.__webglMultisampledFramebuffer=e.createFramebuffer(),s.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,s.__webglMultisampledFramebuffer);for(var g=0;g<l.length;g++){var b=l[g];s.__webglColorRenderbuffer[g]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,s.__webglColorRenderbuffer[g]);var w=a.convert(b.format,b.colorSpace),T=a.convert(b.type),S=x(b.internalFormat,w,T,b.colorSpace,!0===t.isXRRenderTarget),k=q(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,k,S,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+g,e.RENDERBUFFER,s.__webglColorRenderbuffer[g])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(s.__webglDepthRenderbuffer=e.createRenderbuffer(),B(s.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(c){n.bindTexture(e.TEXTURE_CUBE_MAP,u.__webglTexture),L(e.TEXTURE_CUBE_MAP,i);for(var M=0;M<6;M++)if(i.mipmaps&&i.mipmaps.length>0)for(var C=0;C<i.mipmaps.length;C++)U(s.__webglFramebuffer[M][C],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+M,C);else U(s.__webglFramebuffer[M],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+M,0);y(i)&&_(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(h){for(var R=0,P=l.length;R<P;R++){var N=l[R],I=r.get(N);n.bindTexture(e.TEXTURE_2D,I.__webglTexture),L(e.TEXTURE_2D,N),U(s.__webglFramebuffer,t,N,e.COLOR_ATTACHMENT0+R,e.TEXTURE_2D,0),y(N)&&_(e.TEXTURE_2D)}n.unbindTexture()}else{var D=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(D=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(D,u.__webglTexture),L(D,i),i.mipmaps&&i.mipmaps.length>0)for(var O=0;O<i.mipmaps.length;O++)U(s.__webglFramebuffer[O],t,i,e.COLOR_ATTACHMENT0,D,O);else U(s.__webglFramebuffer,t,i,e.COLOR_ATTACHMENT0,D,0);y(i)&&_(D),n.unbindTexture()}t.depthBuffer&&F(t)},this.updateRenderTargetMipmap=function(e){for(var t=e.textures,i=0,a=t.length;i<a;i++){var o=t[i];if(y(o)){var s=b(e),u=r.get(o).__webglTexture;n.bindTexture(s,u),_(s),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.samples>0)if(!1===j(t)){var i=t.textures,a=t.width,o=t.height,s=e.COLOR_BUFFER_BIT,u=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,l=r.get(t),c=i.length>1;if(c)for(var h=0;h<i.length;h++)n.bindFramebuffer(e.FRAMEBUFFER,l.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+h,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,l.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+h,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,l.__webglMultisampledFramebuffer),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,l.__webglFramebuffer);for(var d=0;d<i.length;d++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(s|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(s|=e.STENCIL_BUFFER_BIT)),c){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,l.__webglColorRenderbuffer[d]);var p=r.get(i[d]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,p,0)}e.blitFramebuffer(0,0,a,o,0,0,a,o,s,e.NEAREST),!0===f&&(z.length=0,V.length=0,z.push(e.COLOR_ATTACHMENT0+d),t.depthBuffer&&!1===t.resolveDepthBuffer&&(z.push(u),V.push(u),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,V)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,z))}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),c)for(var A=0;A<i.length;A++){n.bindFramebuffer(e.FRAMEBUFFER,l.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+A,e.RENDERBUFFER,l.__webglColorRenderbuffer[A]);var v=r.get(i[A]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,l.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+A,e.TEXTURE_2D,v,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,l.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&f){var m=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[m])}},this.setupDepthRenderbuffer=F,this.setupFrameBufferTexture=U,this.useMultisampledRTT=j}function xX(e,t){return{convert:function(n){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Yn,a=Dr.getTransfer(i);if(n===zt)return e.UNSIGNED_BYTE;if(n===Qt)return e.UNSIGNED_SHORT_4_4_4_4;if(n===Yt)return e.UNSIGNED_SHORT_5_5_5_1;if(n===Zt)return e.UNSIGNED_INT_5_9_9_9_REV;if(n===Vt)return e.BYTE;if(n===qt)return e.SHORT;if(n===jt)return e.UNSIGNED_SHORT;if(n===Gt)return e.INT;if(n===Ht)return e.UNSIGNED_INT;if(n===Wt)return e.FLOAT;if(n===Xt)return e.HALF_FLOAT;if(n===Jt)return e.ALPHA;if(n===$t)return e.RGB;if(n===en)return e.RGBA;if(n===tn)return e.LUMINANCE;if(n===nn)return e.LUMINANCE_ALPHA;if(n===rn)return e.DEPTH_COMPONENT;if(n===an)return e.DEPTH_STENCIL;if(n===on)return e.RED;if(n===sn)return e.RED_INTEGER;if(n===un)return e.RG;if(n===ln)return e.RG_INTEGER;if(n===cn)return e.RGBA_INTEGER;if(n===hn||n===fn||n===dn||n===pn)if(a===$n){if(null===(r=t.get("WEBGL_compressed_texture_s3tc_srgb")))return null;if(n===hn)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===fn)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===dn)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===pn)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(null===(r=t.get("WEBGL_compressed_texture_s3tc")))return null;if(n===hn)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===fn)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===dn)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===pn)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===An||n===vn||n===mn||n===gn){if(null===(r=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(n===An)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===vn)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===mn)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===gn)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===yn||n===_n||n===bn){if(null===(r=t.get("WEBGL_compressed_texture_etc")))return null;if(n===yn||n===_n)return a===$n?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(n===bn)return a===$n?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}if(n===xn||n===wn||n===Tn||n===Sn||n===En||n===kn||n===Mn||n===Cn||n===Rn||n===Pn||n===Nn||n===In||n===Ln||n===Dn){if(null===(r=t.get("WEBGL_compressed_texture_astc")))return null;if(n===xn)return a===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===wn)return a===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Tn)return a===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Sn)return a===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===En)return a===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===kn)return a===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Mn)return a===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Cn)return a===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===Rn)return a===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Pn)return a===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Nn)return a===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===In)return a===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Ln)return a===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Dn)return a===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===On||n===Un||n===Bn){if(null===(r=t.get("EXT_texture_compression_bptc")))return null;if(n===On)return a===$n?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===Un)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Bn)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===Fn||n===zn||n===Vn||n===qn){if(null===(r=t.get("EXT_texture_compression_rgtc")))return null;if(n===On)return r.COMPRESSED_RED_RGTC1_EXT;if(n===zn)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===Vn)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===qn)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===Kt?e.UNSIGNED_INT_24_8:void 0!==e[n]?e[n]:null}}}var wX=function(){function e(){c(this,e),this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}return p(e,[{key:"init",value:function(e,t,n){if(null===this.texture){var r=new jr;e.properties.get(r).__webglTexture=t.texture,t.depthNear===n.depthNear&&t.depthFar===n.depthFar||(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}},{key:"getMesh",value:function(e){if(null!==this.texture&&null===this.mesh){var t=e.cameras[0].viewport,n=new so({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new eo(new su(20,20),n)}return this.mesh}},{key:"reset",value:function(){this.texture=null,this.mesh=null}},{key:"getDepthTexture",value:function(){return this.texture}}]),e}(),TX=function(e){v(n,e);var t=b(n);function n(e,r){var i;c(this,n);var a=y(i=t.call(this)),o=null,s=1,u=null,l="local-floor",h=1,f=null,d=null,p=null,A=null,v=null,m=null,g=new wX,_=r.getContextAttributes(),b=null,x=null,w=[],T=[],S=new _r,E=null,k=new fo;k.viewport=new Gr;var M=new fo;M.viewport=new Gr;var C=[k,M],R=new cl,P=null,N=null;function I(e){var t=T.indexOf(e.inputSource);if(-1!==t){var n=w[t];void 0!==n&&(n.update(e.inputSource,e.frame,f||u),n.dispatchEvent({type:e.type,data:e.inputSource}))}}function L(){o.removeEventListener("select",I),o.removeEventListener("selectstart",I),o.removeEventListener("selectend",I),o.removeEventListener("squeeze",I),o.removeEventListener("squeezestart",I),o.removeEventListener("squeezeend",I),o.removeEventListener("end",L),o.removeEventListener("inputsourceschange",D);for(var t=0;t<w.length;t++){var n=T[t];null!==n&&(T[t]=null,w[t].disconnect(n))}P=null,N=null,g.reset(),e.setRenderTarget(b),v=null,A=null,p=null,o=null,x=null,z.stop(),a.isPresenting=!1,e.setPixelRatio(E),e.setSize(S.width,S.height,!1),a.dispatchEvent({type:"sessionend"})}function D(e){for(var t=0;t<e.removed.length;t++){var n=e.removed[t],r=T.indexOf(n);r>=0&&(T[r]=null,w[r].disconnect(n))}for(var i=0;i<e.added.length;i++){var a=e.added[i],o=T.indexOf(a);if(-1===o){for(var s=0;s<w.length;s++){if(s>=T.length){T.push(a),o=s;break}if(null===T[s]){T[s]=a,o=s;break}}if(-1===o)break}var u=w[o];u&&u.connect(a)}}i.cameraAutoUpdate=!0,i.enabled=!1,i.isPresenting=!1,i.getController=function(e){var t=w[e];return void 0===t&&(t=new _o,w[e]=t),t.getTargetRaySpace()},i.getControllerGrip=function(e){var t=w[e];return void 0===t&&(t=new _o,w[e]=t),t.getGripSpace()},i.getHand=function(e){var t=w[e];return void 0===t&&(t=new _o,w[e]=t),t.getHandSpace()},i.setFramebufferScaleFactor=function(e){s=e,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},i.setReferenceSpaceType=function(e){l=e,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},i.getReferenceSpace=function(){return f||u},i.setReferenceSpace=function(e){f=e},i.getBaseLayer=function(){return null!==A?A:v},i.getBinding=function(){return p},i.getFrame=function(){return m},i.getSession=function(){return o},i.setSession=function(){var t=lt(ft().mark((function t(n){var i,c,d,m,g;return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(o=n)){t.next=28;break}if(b=e.getRenderTarget(),o.addEventListener("select",I),o.addEventListener("selectstart",I),o.addEventListener("selectend",I),o.addEventListener("squeeze",I),o.addEventListener("squeezestart",I),o.addEventListener("squeezeend",I),o.addEventListener("end",L),o.addEventListener("inputsourceschange",D),!0===_.xrCompatible){t.next=14;break}return t.next=14,r.makeXRCompatible();case 14:return E=e.getPixelRatio(),e.getSize(S),"undefined"!==typeof XRWebGLBinding&&"createProjectionLayer"in XRWebGLBinding.prototype?(c=null,d=null,m=null,_.depth&&(m=_.stencil?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24,c=_.stencil?an:rn,d=_.stencil?Kt:Ht),g={colorFormat:r.RGBA8,depthFormat:m,scaleFactor:s},p=new XRWebGLBinding(o,r),A=p.createProjectionLayer(g),o.updateRenderState({layers:[A]}),e.setPixelRatio(1),e.setSize(A.textureWidth,A.textureHeight,!1),x=new Wr(A.textureWidth,A.textureHeight,{format:en,type:zt,depthTexture:new ns(A.textureWidth,A.textureHeight,d,void 0,void 0,void 0,void 0,void 0,void 0,c),stencilBuffer:_.stencil,colorSpace:e.outputColorSpace,samples:_.antialias?4:0,resolveDepthBuffer:!1===A.ignoreDepthValues,resolveStencilBuffer:!1===A.ignoreDepthValues})):(i={antialias:_.antialias,alpha:!0,depth:_.depth,stencil:_.stencil,framebufferScaleFactor:s},v=new XRWebGLLayer(o,r,i),o.updateRenderState({baseLayer:v}),e.setPixelRatio(1),e.setSize(v.framebufferWidth,v.framebufferHeight,!1),x=new Wr(v.framebufferWidth,v.framebufferHeight,{format:en,type:zt,colorSpace:e.outputColorSpace,stencilBuffer:_.stencil,resolveDepthBuffer:!1===v.ignoreDepthValues,resolveStencilBuffer:!1===v.ignoreDepthValues})),x.isXRRenderTarget=!0,this.setFoveation(h),f=null,t.next=23,o.requestReferenceSpace(l);case 23:u=t.sent,z.setContext(o),z.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"});case 28:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),i.getEnvironmentBlendMode=function(){if(null!==o)return o.environmentBlendMode},i.getDepthTexture=function(){return g.getDepthTexture()};var O=new Kr,U=new Kr;function B(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}i.updateCamera=function(e){if(null!==o){var t=e.near,n=e.far;null!==g.texture&&(g.depthNear>0&&(t=g.depthNear),g.depthFar>0&&(n=g.depthFar)),R.near=M.near=k.near=t,R.far=M.far=k.far=n,P===R.near&&N===R.far||(o.updateRenderState({depthNear:R.near,depthFar:R.far}),P=R.near,N=R.far),k.layers.mask=2|e.layers.mask,M.layers.mask=4|e.layers.mask,R.layers.mask=k.layers.mask|M.layers.mask;var r=e.parent,i=R.cameras;B(R,r);for(var a=0;a<i.length;a++)B(i[a],r);2===i.length?function(e,t,n){O.setFromMatrixPosition(t.matrixWorld),U.setFromMatrixPosition(n.matrixWorld);var r=O.distanceTo(U),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),u=(i[9]+1)/i[5],l=(i[9]-1)/i[5],c=(i[8]-1)/i[0],h=(a[8]+1)/a[0],f=o*c,d=o*h,p=r/(-c+h),A=p*-c;if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(A),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===i[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{var v=o+p,m=s+p,g=f-A,y=d+(r-A),_=u*s/m*v,b=l*s/m*v;e.projectionMatrix.makePerspective(g,y,_,b,v,m),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(R,k,M):R.projectionMatrix.copy(k.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*fr*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,R,r)}},i.getCamera=function(){return R},i.getFoveation=function(){if(null!==A||null!==v)return h},i.setFoveation=function(e){h=e,null!==A&&(A.fixedFoveation=e),null!==v&&void 0!==v.fixedFoveation&&(v.fixedFoveation=e)},i.hasDepthSensing=function(){return null!==g.texture},i.getDepthSensingMesh=function(){return g.getMesh(R)};var F=null;var z=new QG;return z.setAnimationLoop((function(t,n){if(d=n.getViewerPose(f||u),m=n,null!==d){var r=d.views;null!==v&&(e.setRenderTargetFramebuffer(x,v.framebuffer),e.setRenderTarget(x));var i=!1;r.length!==R.cameras.length&&(R.cameras.length=0,i=!0);for(var s=0;s<r.length;s++){var l=r[s],c=null;if(null!==v)c=v.getViewport(l);else{var h=p.getViewSubImage(A,l);c=h.viewport,0===s&&(e.setRenderTargetTextures(x,h.colorTexture,h.depthStencilTexture),e.setRenderTarget(x))}var y=C[s];void 0===y&&((y=new fo).layers.enable(s),y.viewport=new Gr,C[s]=y),y.matrix.fromArray(l.transform.matrix),y.matrix.decompose(y.position,y.quaternion,y.scale),y.projectionMatrix.fromArray(l.projectionMatrix),y.projectionMatrixInverse.copy(y.projectionMatrix).invert(),y.viewport.set(c.x,c.y,c.width,c.height),0===s&&(R.matrix.copy(y.matrix),R.matrix.decompose(R.position,R.quaternion,R.scale)),!0===i&&R.cameras.push(y)}var _=o.enabledFeatures;if(_&&_.includes("depth-sensing")&&"gpu-optimized"==o.depthUsage&&p){var b=p.getDepthInformation(r[0]);b&&b.isValid&&b.texture&&g.init(e,b,o.renderState)}}for(var S=0;S<w.length;S++){var E=T[S],k=w[S];null!==E&&void 0!==k&&k.update(E,n,f||u)}F&&F(t,n),n.detectedPlanes&&a.dispatchEvent({type:"planesdetected",data:n}),m=null})),i.setAnimationLoop=function(e){F=e},i.dispose=function(){},i}return p(n)}(ur),SX=new Oi,EX=new Ei;function kX(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function r(e,r){e.opacity.value=r.opacity,r.color&&e.diffuse.value.copy(r.color),r.emissive&&e.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(e.map.value=r.map,n(r.map,e.mapTransform)),r.alphaMap&&(e.alphaMap.value=r.alphaMap,n(r.alphaMap,e.alphaMapTransform)),r.bumpMap&&(e.bumpMap.value=r.bumpMap,n(r.bumpMap,e.bumpMapTransform),e.bumpScale.value=r.bumpScale,1===r.side&&(e.bumpScale.value*=-1)),r.normalMap&&(e.normalMap.value=r.normalMap,n(r.normalMap,e.normalMapTransform),e.normalScale.value.copy(r.normalScale),1===r.side&&e.normalScale.value.negate()),r.displacementMap&&(e.displacementMap.value=r.displacementMap,n(r.displacementMap,e.displacementMapTransform),e.displacementScale.value=r.displacementScale,e.displacementBias.value=r.displacementBias),r.emissiveMap&&(e.emissiveMap.value=r.emissiveMap,n(r.emissiveMap,e.emissiveMapTransform)),r.specularMap&&(e.specularMap.value=r.specularMap,n(r.specularMap,e.specularMapTransform)),r.alphaTest>0&&(e.alphaTest.value=r.alphaTest);var i=t.get(r),a=i.envMap,o=i.envMapRotation;a&&(e.envMap.value=a,SX.copy(o),SX.x*=-1,SX.y*=-1,SX.z*=-1,a.isCubeTexture&&!1===a.isRenderTargetTexture&&(SX.y*=-1,SX.z*=-1),e.envMapRotation.value.setFromMatrix4(EX.makeRotationFromEuler(SX)),e.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,e.reflectivity.value=r.reflectivity,e.ior.value=r.ior,e.refractionRatio.value=r.refractionRatio),r.lightMap&&(e.lightMap.value=r.lightMap,e.lightMapIntensity.value=r.lightMapIntensity,n(r.lightMap,e.lightMapTransform)),r.aoMap&&(e.aoMap.value=r.aoMap,e.aoMapIntensity.value=r.aoMapIntensity,n(r.aoMap,e.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,ao(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,i,a,o,s){i.isMeshBasicMaterial||i.isMeshLambertMaterial?r(e,i):i.isMeshToonMaterial?(r(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,i)):i.isMeshPhongMaterial?(r(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,i)):i.isMeshStandardMaterial?(r(e,i),function(e,t){e.metalness.value=t.metalness,t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap,n(t.metalnessMap,e.metalnessMapTransform));e.roughness.value=t.roughness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap,n(t.roughnessMap,e.roughnessMapTransform));t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}(e,i),i.isMeshPhysicalMaterial&&function(e,t,r){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),1===t.side&&e.clearcoatNormalScale.value.negate()));t.dispersion>0&&(e.dispersion.value=t.dispersion);t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform)));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform));t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,i,s)):i.isMeshMatcapMaterial?(r(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,i)):i.isMeshDepthMaterial?r(e,i):i.isMeshDistanceMaterial?(r(e,i),function(e,n){var r=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(r.matrixWorld),e.nearDistance.value=r.shadow.camera.near,e.farDistance.value=r.shadow.camera.far}(e,i)):i.isMeshNormalMaterial?r(e,i):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,r,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*i,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i,a,o):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function MX(e,t,n,r){var i={},a={},o=[],s=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function u(e,t,n,r){var i=e.value,a=t+"_"+n;if(void 0===r[a])return r[a]="number"===typeof i||"boolean"===typeof i?i:i.clone(),!0;var o=r[a];if("number"===typeof i||"boolean"===typeof i){if(o!==i)return r[a]=i,!0}else if(!1===o.equals(i))return o.copy(i),!0;return!1}function l(e){var t={boundary:0,storage:0};return"number"===typeof e||"boolean"===typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function c(t){var n=t.target;n.removeEventListener("dispose",c);var r=o.indexOf(n.__bindingPointIndex);o.splice(r,1),e.deleteBuffer(i[n.id]),delete i[n.id],delete a[n.id]}return{bind:function(e,t){var n=t.program;r.uniformBlockBinding(e,n)},update:function(n,h){var f=i[n.id];void 0===f&&(!function(e){for(var t=e.uniforms,n=0,r=16,i=0,a=t.length;i<a;i++)for(var o=Array.isArray(t[i])?t[i]:[t[i]],s=0,u=o.length;s<u;s++)for(var c=o[s],h=Array.isArray(c.value)?c.value:[c.value],f=0,d=h.length;f<d;f++){var p=l(h[f]),A=n%r,v=A%p.boundary,m=A+v;n+=v,0!==m&&r-m<p.storage&&(n+=r-m),c.__data=new Float32Array(p.storage/Float32Array.BYTES_PER_ELEMENT),c.__offset=n,n+=p.storage}var g=n%r;g>0&&(n+=r-g);e.__size=n,e.__cache={}}(n),f=function(t){var n=function(){for(var e=0;e<s;e++)if(-1===o.indexOf(e))return o.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;var r=e.createBuffer(),i=t.__size,a=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,r),e.bufferData(e.UNIFORM_BUFFER,i,a),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,r),r}(n),i[n.id]=f,n.addEventListener("dispose",c));var d=h.program;r.updateUBOMapping(n,d);var p=t.render.frame;a[n.id]!==p&&(!function(t){var n=i[t.id],r=t.uniforms,a=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(var o=0,s=r.length;o<s;o++)for(var c=Array.isArray(r[o])?r[o]:[r[o]],h=0,f=c.length;h<f;h++){var d=c[h];if(!0===u(d,o,h,a)){for(var p=d.__offset,A=Array.isArray(d.value)?d.value:[d.value],v=0,m=0;m<A.length;m++){var g=A[m],y=l(g);"number"===typeof g||"boolean"===typeof g?(d.__data[0]=g,e.bufferSubData(e.UNIFORM_BUFFER,p+v,d.__data)):g.isMatrix3?(d.__data[0]=g.elements[0],d.__data[1]=g.elements[1],d.__data[2]=g.elements[2],d.__data[3]=0,d.__data[4]=g.elements[3],d.__data[5]=g.elements[4],d.__data[6]=g.elements[5],d.__data[7]=0,d.__data[8]=g.elements[6],d.__data[9]=g.elements[7],d.__data[10]=g.elements[8],d.__data[11]=0):(g.toArray(d.__data,v),v+=y.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,p,d.__data)}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),a[n.id]=p)},dispose:function(){for(var t in i)e.deleteBuffer(i[t]);o=[],i={},a={}}}}var CX=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,e);var n,r=t.canvas,i=void 0===r?Sr():r,a=t.context,o=void 0===a?null:a,s=t.depth,u=void 0===s||s,l=t.stencil,h=void 0!==l&&l,f=t.alpha,d=void 0!==f&&f,p=t.antialias,A=void 0!==p&&p,v=t.premultipliedAlpha,m=void 0===v||v,g=t.preserveDrawingBuffer,y=void 0!==g&&g,_=t.powerPreference,b=void 0===_?"default":_,x=t.failIfMajorPerformanceCaveat,w=void 0!==x&&x,T=t.reverseDepthBuffer,S=void 0!==T&&T;if(this.isWebGLRenderer=!0,null!==o){if("undefined"!==typeof WebGLRenderingContext&&o instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");n=o.getContextAttributes().alpha}else n=d;var E=new Uint32Array(4),k=new Int32Array(4),M=null,C=null,R=[],P=[];this.domElement=i,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=0,this.toneMappingExposure=1,this.transmissionResolutionScale=1;var N=this,I=!1;this._outputColorSpace=Kn;var L=0,D=0,O=null,U=-1,B=null,F=new Gr,z=new Gr,V=null,q=new ga(0),j=0,G=i.width,H=i.height,W=1,X=null,Q=null,Y=new Gr(0,0,G,H),K=new Gr(0,0,G,H),Z=!1,J=new Lo,$=!1,ee=!1,te=new Ei,ne=new Ei,re=new Kr,ie=new Gr,ae={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},oe=!1;function se(){return null===O?W:1}var ue,le,ce,he,fe,de,pe,Ae,ve,me,ge,ye,_e,be,xe,we,Te,Se,Ee,ke,Me,Ce,Re,Pe,Ne=o;function Ie(e,t){return i.getContext(e,t)}try{var Le={alpha:!0,depth:u,stencil:h,antialias:A,premultipliedAlpha:m,preserveDrawingBuffer:y,powerPreference:b,failIfMajorPerformanceCaveat:w};if("setAttribute"in i&&i.setAttribute("data-engine","three.js r".concat(dt)),i.addEventListener("webglcontextlost",Be,!1),i.addEventListener("webglcontextrestored",Fe,!1),i.addEventListener("webglcontextcreationerror",ze,!1),null===Ne){var De="webgl2";if(null===(Ne=Ie(De,Le)))throw Ie(De)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(ht){throw console.error("THREE.WebGLRenderer: "+ht.message),ht}function Oe(){(ue=new EH(Ne)).init(),Ce=new xX(Ne,ue),le=new aH(Ne,ue,t,Ce),ce=new _X(Ne,ue),le.reverseDepthBuffer&&S&&ce.buffers.depth.setReversed(!0),he=new CH(Ne),fe=new sX,de=new bX(Ne,ue,ce,fe,le,Ce,he),pe=new sH(N),Ae=new SH(N),ve=new YG(Ne),Re=new rH(Ne,ve),me=new kH(Ne,ve,he,Re),ge=new PH(Ne,me,ve,he),Ee=new RH(Ne,le,de),we=new oH(fe),ye=new oX(N,pe,Ae,ue,le,Re,we),_e=new kX(N,fe),be=new hX,xe=new mX(ue),Se=new nH(N,pe,Ae,ce,ge,n,m),Te=new gX(N,ge,le),Pe=new MX(Ne,he,le,ce),ke=new iH(Ne,ue,he),Me=new MH(Ne,ue,he),he.programs=ye.programs,N.capabilities=le,N.extensions=ue,N.properties=fe,N.renderLists=be,N.shadowMap=Te,N.state=ce,N.info=he}Oe();var Ue=new TX(N,Ne);function Be(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),I=!0}function Fe(){console.log("THREE.WebGLRenderer: Context Restored."),I=!1;var e=he.autoReset,t=Te.enabled,n=Te.autoUpdate,r=Te.needsUpdate,i=Te.type;Oe(),he.autoReset=e,Te.enabled=t,Te.autoUpdate=n,Te.needsUpdate=r,Te.type=i}function ze(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Ve(e){var t=e.target;t.removeEventListener("dispose",Ve),qe(t)}function qe(e){je(e),fe.remove(e)}function je(e){var t=fe.get(e).programs;void 0!==t&&(t.forEach((function(e){ye.releaseProgram(e)})),e.isShaderMaterial&&ye.releaseShaderCache(e))}function Ge(e,t,n){!0===e.transparent&&2===e.side&&!1===e.forceSinglePass?(e.side=1,e.needsUpdate=!0,tt(e,t,n),e.side=0,e.needsUpdate=!0,tt(e,t,n),e.side=2):tt(e,t,n)}this.xr=Ue,this.getContext=function(){return Ne},this.getContextAttributes=function(){return Ne.getContextAttributes()},this.forceContextLoss=function(){var e=ue.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=ue.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return W},this.setPixelRatio=function(e){void 0!==e&&(W=e,this.setSize(G,H,!1))},this.getSize=function(e){return e.set(G,H)},this.setSize=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Ue.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(G=e,H=t,i.width=Math.floor(e*W),i.height=Math.floor(t*W),!0===n&&(i.style.width=e+"px",i.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(e){return e.set(G*W,H*W).floor()},this.setDrawingBufferSize=function(e,t,n){G=e,H=t,W=n,i.width=Math.floor(e*n),i.height=Math.floor(t*n),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return e.copy(F)},this.getViewport=function(e){return e.copy(Y)},this.setViewport=function(e,t,n,r){e.isVector4?Y.set(e.x,e.y,e.z,e.w):Y.set(e,t,n,r),ce.viewport(F.copy(Y).multiplyScalar(W).round())},this.getScissor=function(e){return e.copy(K)},this.setScissor=function(e,t,n,r){e.isVector4?K.set(e.x,e.y,e.z,e.w):K.set(e,t,n,r),ce.scissor(z.copy(K).multiplyScalar(W).round())},this.getScissorTest=function(){return Z},this.setScissorTest=function(e){ce.setScissorTest(Z=e)},this.setOpaqueSort=function(e){X=e},this.setTransparentSort=function(e){Q=e},this.getClearColor=function(e){return e.copy(Se.getClearColor())},this.setClearColor=function(){var e;(e=Se).setClearColor.apply(e,arguments)},this.getClearAlpha=function(){return Se.getClearAlpha()},this.setClearAlpha=function(){var e;(e=Se).setClearAlpha.apply(e,arguments)},this.clear=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=0;if(e){var i=!1;if(null!==O){var a=O.texture.format;i=a===cn||a===ln||a===sn}if(i){var o=O.texture.type,s=o===zt||o===Ht||o===jt||o===Kt||o===Qt||o===Yt,u=Se.getClearColor(),l=Se.getClearAlpha(),c=u.r,h=u.g,f=u.b;s?(E[0]=c,E[1]=h,E[2]=f,E[3]=l,Ne.clearBufferuiv(Ne.COLOR,0,E)):(k[0]=c,k[1]=h,k[2]=f,k[3]=l,Ne.clearBufferiv(Ne.COLOR,0,k))}else r|=Ne.COLOR_BUFFER_BIT}t&&(r|=Ne.DEPTH_BUFFER_BIT),n&&(r|=Ne.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Ne.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",Be,!1),i.removeEventListener("webglcontextrestored",Fe,!1),i.removeEventListener("webglcontextcreationerror",ze,!1),Se.dispose(),be.dispose(),xe.dispose(),fe.dispose(),pe.dispose(),Ae.dispose(),ge.dispose(),Re.dispose(),Pe.dispose(),ye.dispose(),Ue.dispose(),Ue.removeEventListener("sessionstart",Xe),Ue.removeEventListener("sessionend",Qe),Ye.stop()},this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=ae);var o=i.isMesh&&i.matrixWorld.determinant()<0,s=it(e,t,n,r,i);ce.setMaterial(r,o);var u=n.index,l=1;if(!0===r.wireframe){if(void 0===(u=me.getWireframeAttribute(n)))return;l=2}var c=n.drawRange,h=n.attributes.position,f=c.start*l,d=(c.start+c.count)*l;null!==a&&(f=Math.max(f,a.start*l),d=Math.min(d,(a.start+a.count)*l)),null!==u?(f=Math.max(f,0),d=Math.min(d,u.count)):void 0!==h&&null!==h&&(f=Math.max(f,0),d=Math.min(d,h.count));var p=d-f;if(!(p<0||p===1/0)){var A;Re.setup(i,r,s,n,u);var v=ke;if(null!==u&&(A=ve.get(u),(v=Me).setIndex(A)),i.isMesh)!0===r.wireframe?(ce.setLineWidth(r.wireframeLinewidth*se()),v.setMode(Ne.LINES)):v.setMode(Ne.TRIANGLES);else if(i.isLine){var m=r.linewidth;void 0===m&&(m=1),ce.setLineWidth(m*se()),i.isLineSegments?v.setMode(Ne.LINES):i.isLineLoop?v.setMode(Ne.LINE_LOOP):v.setMode(Ne.LINE_STRIP)}else i.isPoints?v.setMode(Ne.POINTS):i.isSprite&&v.setMode(Ne.TRIANGLES);if(i.isBatchedMesh)if(null!==i._multiDrawInstances)kr("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),v.renderMultiDrawInstances(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount,i._multiDrawInstances);else if(ue.get("WEBGL_multi_draw"))v.renderMultiDraw(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount);else for(var g=i._multiDrawStarts,y=i._multiDrawCounts,_=i._multiDrawCount,b=u?ve.get(u).bytesPerElement:1,x=fe.get(r).currentProgram.getUniforms(),w=0;w<_;w++)x.setValue(Ne,"_gl_DrawID",w),v.render(g[w]/b,y[w]);else if(i.isInstancedMesh)v.renderInstances(f,p,i.count);else if(n.isInstancedBufferGeometry){var T=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,S=Math.min(n.instanceCount,T);v.renderInstances(f,p,S)}else v.render(f,p)}},this.compile=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===n&&(n=e),(C=xe.get(n)).init(t),P.push(C),n.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(C.pushLight(e),e.castShadow&&C.pushShadow(e))})),e!==n&&e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(C.pushLight(e),e.castShadow&&C.pushShadow(e))})),C.setupLights();var r=new Set;return e.traverse((function(e){if(e.isMesh||e.isPoints||e.isLine||e.isSprite){var t=e.material;if(t)if(Array.isArray(t))for(var i=0;i<t.length;i++){var a=t[i];Ge(a,n,e),r.add(a)}else Ge(t,n,e),r.add(t)}})),C=P.pop(),r},this.compileAsync=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.compile(e,t,n);return new Promise((function(t){function n(){r.forEach((function(e){fe.get(e).currentProgram.isReady()&&r.delete(e)})),0!==r.size?setTimeout(n,10):t(e)}null!==ue.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)}))};var He=null;function We(e){He&&He(e)}function Xe(){Ye.stop()}function Qe(){Ye.start()}var Ye=new QG;function Ke(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)C.pushLight(e),e.castShadow&&C.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||J.intersectsSprite(e)){r&&ie.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ne);var i=ge.update(e),a=e.material;a.visible&&M.push(e,i,a,n,ie.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||J.intersectsObject(e))){var o=ge.update(e),s=e.material;if(r&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),ie.copy(e.boundingSphere.center)):(null===o.boundingSphere&&o.computeBoundingSphere(),ie.copy(o.boundingSphere.center)),ie.applyMatrix4(e.matrixWorld).applyMatrix4(ne)),Array.isArray(s))for(var u=o.groups,l=0,c=u.length;l<c;l++){var h=u[l],f=s[h.materialIndex];f&&f.visible&&M.push(e,o,f,n,ie.z,h)}else s.visible&&M.push(e,o,s,n,ie.z,null)}for(var d=e.children,p=0,A=d.length;p<A;p++)Ke(d[p],t,n,r)}}function Ze(e,t,n,r){var i=e.opaque,a=e.transmissive,o=e.transparent;C.setupLightsView(n),!0===$&&we.setGlobalState(N.clippingPlanes,n),r&&ce.viewport(F.copy(r)),i.length>0&&$e(i,t,n),a.length>0&&$e(a,t,n),o.length>0&&$e(o,t,n),ce.buffers.depth.setTest(!0),ce.buffers.depth.setMask(!0),ce.buffers.color.setMask(!0),ce.setPolygonOffset(!1)}function Je(e,t,n,r){if(null===(!0===n.isScene?n.overrideMaterial:null)){void 0===C.state.transmissionRenderTarget[r.id]&&(C.state.transmissionRenderTarget[r.id]=new Wr(1,1,{generateMipmaps:!0,type:ue.has("EXT_color_buffer_half_float")||ue.has("EXT_color_buffer_float")?Xt:zt,minFilter:Ft,samples:4,stencilBuffer:h,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Dr.workingColorSpace}));var i=C.state.transmissionRenderTarget[r.id],a=r.viewport||F;i.setSize(a.z*N.transmissionResolutionScale,a.w*N.transmissionResolutionScale);var o=N.getRenderTarget();N.setRenderTarget(i),N.getClearColor(q),(j=N.getClearAlpha())<1&&N.setClearColor(16777215,.5),N.clear(),oe&&Se.render(n);var s=N.toneMapping;N.toneMapping=0;var u=r.viewport;if(void 0!==r.viewport&&(r.viewport=void 0),C.setupLightsView(r),!0===$&&we.setGlobalState(N.clippingPlanes,r),$e(e,n,r),de.updateMultisampleRenderTarget(i),de.updateRenderTargetMipmap(i),!1===ue.has("WEBGL_multisampled_render_to_texture")){for(var l=!1,c=0,f=t.length;c<f;c++){var d=t[c],p=d.object,A=d.geometry,v=d.material,m=d.group;if(2===v.side&&p.layers.test(r.layers)){var g=v.side;v.side=1,v.needsUpdate=!0,et(p,n,r,A,v,m),v.side=g,v.needsUpdate=!0,l=!0}}!0===l&&(de.updateMultisampleRenderTarget(i),de.updateRenderTargetMipmap(i))}N.setRenderTarget(o),N.setClearColor(q,j),void 0!==u&&(r.viewport=u),N.toneMapping=s}}function $e(e,t,n){for(var r=!0===t.isScene?t.overrideMaterial:null,i=0,a=e.length;i<a;i++){var o=e[i],s=o.object,u=o.geometry,l=o.group,c=o.material;!0===c.allowOverride&&null!==r&&(c=r),s.layers.test(n.layers)&&et(s,t,n,u,c,l)}}function et(e,t,n,r,i,a){e.onBeforeRender(N,t,n,r,i,a),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(N,t,n,r,e,a),!0===i.transparent&&2===i.side&&!1===i.forceSinglePass?(i.side=1,i.needsUpdate=!0,N.renderBufferDirect(n,t,r,i,e,a),i.side=0,i.needsUpdate=!0,N.renderBufferDirect(n,t,r,i,e,a),i.side=2):N.renderBufferDirect(n,t,r,i,e,a),e.onAfterRender(N,t,n,r,i,a)}function tt(e,t,n){!0!==t.isScene&&(t=ae);var r=fe.get(e),i=C.state.lights,a=C.state.shadowsArray,o=i.state.version,s=ye.getParameters(e,i.state,a,t,n),u=ye.getProgramCacheKey(s),l=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?Ae:pe).get(e.envMap||r.environment),r.envMapRotation=null!==r.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===l&&(e.addEventListener("dispose",Ve),l=new Map,r.programs=l);var c=l.get(u);if(void 0!==c){if(r.currentProgram===c&&r.lightsStateVersion===o)return rt(e,s),c}else s.uniforms=ye.getUniforms(e),e.onBeforeCompile(s,N),c=ye.acquireProgram(s,u),l.set(u,c),r.uniforms=s.uniforms;var h=r.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=we.uniform),rt(e,s),r.needsLights=ot(e),r.lightsStateVersion=o,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotLightMatrix.value=i.state.spotLightMatrix,h.spotLightMap.value=i.state.spotLightMap,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix),r.currentProgram=c,r.uniformsList=null,c}function nt(e){if(null===e.uniformsList){var t=e.currentProgram.getUniforms();e.uniformsList=OW.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function rt(e,t){var n=fe.get(e);n.outputColorSpace=t.outputColorSpace,n.batching=t.batching,n.batchingColor=t.batchingColor,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.instancingMorph=t.instancingMorph,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}function it(e,t,n,r,i){!0!==t.isScene&&(t=ae),de.resetTextureUnits();var a=t.fog,o=r.isMeshStandardMaterial?t.environment:null,s=null===O?N.outputColorSpace:!0===O.isXRRenderTarget?O.texture.colorSpace:Zn,u=(r.isMeshStandardMaterial?Ae:pe).get(r.envMap||o),l=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,c=!!n.attributes.tangent&&(!!r.normalMap||r.anisotropy>0),h=!!n.morphAttributes.position,f=!!n.morphAttributes.normal,d=!!n.morphAttributes.color,p=0;r.toneMapped&&(null!==O&&!0!==O.isXRRenderTarget||(p=N.toneMapping));var A=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=void 0!==A?A.length:0,m=fe.get(r),g=C.state.lights;if(!0===$&&(!0===ee||e!==B)){var y=e===B&&r.id===U;we.setState(r,e,y)}var _=!1;r.version===m.__version?m.needsLights&&m.lightsStateVersion!==g.state.version||m.outputColorSpace!==s||i.isBatchedMesh&&!1===m.batching?_=!0:i.isBatchedMesh||!0!==m.batching?i.isBatchedMesh&&!0===m.batchingColor&&null===i.colorTexture||i.isBatchedMesh&&!1===m.batchingColor&&null!==i.colorTexture||i.isInstancedMesh&&!1===m.instancing?_=!0:i.isInstancedMesh||!0!==m.instancing?i.isSkinnedMesh&&!1===m.skinning?_=!0:i.isSkinnedMesh||!0!==m.skinning?i.isInstancedMesh&&!0===m.instancingColor&&null===i.instanceColor||i.isInstancedMesh&&!1===m.instancingColor&&null!==i.instanceColor||i.isInstancedMesh&&!0===m.instancingMorph&&null===i.morphTexture||i.isInstancedMesh&&!1===m.instancingMorph&&null!==i.morphTexture||m.envMap!==u||!0===r.fog&&m.fog!==a?_=!0:void 0===m.numClippingPlanes||m.numClippingPlanes===we.numPlanes&&m.numIntersection===we.numIntersection?(m.vertexAlphas!==l||m.vertexTangents!==c||m.morphTargets!==h||m.morphNormals!==f||m.morphColors!==d||m.toneMapping!==p||m.morphTargetsCount!==v)&&(_=!0):_=!0:_=!0:_=!0:_=!0:(_=!0,m.__version=r.version);var b=m.currentProgram;!0===_&&(b=tt(r,t,i));var x=!1,w=!1,T=!1,S=b.getUniforms(),E=m.uniforms;if(ce.useProgram(b.program)&&(x=!0,w=!0,T=!0),r.id!==U&&(U=r.id,w=!0),x||B!==e){ce.buffers.depth.getReversed()?(te.copy(e.projectionMatrix),Cr(te),Rr(te),S.setValue(Ne,"projectionMatrix",te)):S.setValue(Ne,"projectionMatrix",e.projectionMatrix),S.setValue(Ne,"viewMatrix",e.matrixWorldInverse);var k=S.map.cameraPosition;void 0!==k&&k.setValue(Ne,re.setFromMatrixPosition(e.matrixWorld)),le.logarithmicDepthBuffer&&S.setValue(Ne,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&S.setValue(Ne,"isOrthographic",!0===e.isOrthographicCamera),B!==e&&(B=e,w=!0,T=!0)}if(i.isSkinnedMesh){S.setOptional(Ne,i,"bindMatrix"),S.setOptional(Ne,i,"bindMatrixInverse");var M=i.skeleton;M&&(null===M.boneTexture&&M.computeBoneTexture(),S.setValue(Ne,"boneTexture",M.boneTexture,de))}i.isBatchedMesh&&(S.setOptional(Ne,i,"batchingTexture"),S.setValue(Ne,"batchingTexture",i._matricesTexture,de),S.setOptional(Ne,i,"batchingIdTexture"),S.setValue(Ne,"batchingIdTexture",i._indirectTexture,de),S.setOptional(Ne,i,"batchingColorTexture"),null!==i._colorsTexture&&S.setValue(Ne,"batchingColorTexture",i._colorsTexture,de));var R=n.morphAttributes;if(void 0===R.position&&void 0===R.normal&&void 0===R.color||Ee.update(i,n,b),(w||m.receiveShadow!==i.receiveShadow)&&(m.receiveShadow=i.receiveShadow,S.setValue(Ne,"receiveShadow",i.receiveShadow)),r.isMeshGouraudMaterial&&null!==r.envMap&&(E.envMap.value=u,E.flipEnvMap.value=u.isCubeTexture&&!1===u.isRenderTargetTexture?-1:1),r.isMeshStandardMaterial&&null===r.envMap&&null!==t.environment&&(E.envMapIntensity.value=t.environmentIntensity),w&&(S.setValue(Ne,"toneMappingExposure",N.toneMappingExposure),m.needsLights&&at(E,T),a&&!0===r.fog&&_e.refreshFogUniforms(E,a),_e.refreshMaterialUniforms(E,r,W,H,C.state.transmissionRenderTarget[e.id]),OW.upload(Ne,nt(m),E,de)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(OW.upload(Ne,nt(m),E,de),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&S.setValue(Ne,"center",i.center),S.setValue(Ne,"modelViewMatrix",i.modelViewMatrix),S.setValue(Ne,"normalMatrix",i.normalMatrix),S.setValue(Ne,"modelMatrix",i.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial)for(var P=r.uniformsGroups,I=0,L=P.length;I<L;I++){var D=P[I];Pe.update(D,b),Pe.bind(D,b)}return b}function at(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}function ot(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}Ye.setAnimationLoop(We),"undefined"!==typeof self&&Ye.setContext(self),this.setAnimationLoop=function(e){He=e,Ue.setAnimationLoop(e),null===e?Ye.stop():Ye.start()},Ue.addEventListener("sessionstart",Xe),Ue.addEventListener("sessionend",Qe),this.render=function(e,t){if(void 0===t||!0===t.isCamera){if(!0!==I){if(!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===Ue.enabled&&!0===Ue.isPresenting&&(!0===Ue.cameraAutoUpdate&&Ue.updateCamera(t),t=Ue.getCamera()),!0===e.isScene&&e.onBeforeRender(N,e,t,O),(C=xe.get(e,P.length)).init(t),P.push(C),ne.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),J.setFromProjectionMatrix(ne),ee=this.localClippingEnabled,$=we.init(this.clippingPlanes,ee),(M=be.get(e,R.length)).init(),R.push(M),!0===Ue.enabled&&!0===Ue.isPresenting){var n=N.xr.getDepthSensingMesh();null!==n&&Ke(n,t,-1/0,N.sortObjects)}Ke(e,t,0,N.sortObjects),M.finish(),!0===N.sortObjects&&M.sort(X,Q),(oe=!1===Ue.enabled||!1===Ue.isPresenting||!1===Ue.hasDepthSensing())&&Se.addToRenderList(M,e),this.info.render.frame++,!0===$&&we.beginShadows();var r=C.state.shadowsArray;Te.render(r,e,t),!0===$&&we.endShadows(),!0===this.info.autoReset&&this.info.reset();var i=M.opaque,a=M.transmissive;if(C.setupLights(),t.isArrayCamera){var o=t.cameras;if(a.length>0)for(var s=0,u=o.length;s<u;s++){Je(i,a,e,o[s])}oe&&Se.render(e);for(var l=0,c=o.length;l<c;l++){var h=o[l];Ze(M,e,h,h.viewport)}}else a.length>0&&Je(i,a,e,t),oe&&Se.render(e),Ze(M,e,t);null!==O&&0===D&&(de.updateMultisampleRenderTarget(O),de.updateRenderTargetMipmap(O)),!0===e.isScene&&e.onAfterRender(N,e,t),Re.resetDefaultState(),U=-1,B=null,P.pop(),P.length>0?(C=P[P.length-1],!0===$&&we.setGlobalState(N.clippingPlanes,C.state.camera)):C=null,R.pop(),M=R.length>0?R[R.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return L},this.getActiveMipmapLevel=function(){return D},this.getRenderTarget=function(){return O},this.setRenderTargetTextures=function(e,t,n){var r=fe.get(e);r.__autoAllocateDepthBuffer=!1===e.resolveDepthBuffer,!1===r.__autoAllocateDepthBuffer&&(r.__useRenderToTexture=!1),fe.get(e.texture).__webglTexture=t,fe.get(e.depthTexture).__webglTexture=r.__autoAllocateDepthBuffer?void 0:n,r.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(e,t){var n=fe.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t};var st=Ne.createFramebuffer();this.setRenderTarget=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;O=e,L=t,D=n;var r=!0,i=null,a=!1,o=!1;if(e){var s=fe.get(e);if(void 0!==s.__useDefaultFramebuffer)ce.bindFramebuffer(Ne.FRAMEBUFFER,null),r=!1;else if(void 0===s.__webglFramebuffer)de.setupRenderTarget(e);else if(s.__hasExternalTextures)de.rebindTextures(e,fe.get(e.texture).__webglTexture,fe.get(e.depthTexture).__webglTexture);else if(e.depthBuffer){var u=e.depthTexture;if(s.__boundDepthTexture!==u){if(null!==u&&fe.has(u)&&(e.width!==u.image.width||e.height!==u.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");de.setupDepthRenderbuffer(e)}}var l=e.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(o=!0);var c=fe.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=Array.isArray(c[t])?c[t][n]:c[t],a=!0):i=e.samples>0&&!1===de.useMultisampledRTT(e)?fe.get(e).__webglMultisampledFramebuffer:Array.isArray(c)?c[n]:c,F.copy(e.viewport),z.copy(e.scissor),V=e.scissorTest}else F.copy(Y).multiplyScalar(W).floor(),z.copy(K).multiplyScalar(W).floor(),V=Z;0!==n&&(i=st);var h=ce.bindFramebuffer(Ne.FRAMEBUFFER,i);if(h&&r&&ce.drawBuffers(e,i),ce.viewport(F),ce.scissor(z),ce.setScissorTest(V),a){var f=fe.get(e.texture);Ne.framebufferTexture2D(Ne.FRAMEBUFFER,Ne.COLOR_ATTACHMENT0,Ne.TEXTURE_CUBE_MAP_POSITIVE_X+t,f.__webglTexture,n)}else if(o){var d=fe.get(e.texture),p=t;Ne.framebufferTextureLayer(Ne.FRAMEBUFFER,Ne.COLOR_ATTACHMENT0,d.__webglTexture,n,p)}else if(null!==e&&0!==n){var A=fe.get(e.texture);Ne.framebufferTexture2D(Ne.FRAMEBUFFER,Ne.COLOR_ATTACHMENT0,Ne.TEXTURE_2D,A.__webglTexture,n)}U=-1},this.readRenderTargetPixels=function(e,t,n,r,i,a,o){if(e&&e.isWebGLRenderTarget){var s=fe.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){ce.bindFramebuffer(Ne.FRAMEBUFFER,s);try{var u=e.texture,l=u.format,c=u.type;if(!le.textureFormatReadable(l))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!le.textureTypeReadable(c))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&Ne.readPixels(t,n,r,i,Ce.convert(l),Ce.convert(c),a)}finally{var h=null!==O?fe.get(O).__webglFramebuffer:null;ce.bindFramebuffer(Ne.FRAMEBUFFER,h)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.readRenderTargetPixelsAsync=function(){var e=lt(ft().mark((function e(t,n,r,i,a,o,s){var u,l,c,h,f,d,p;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.isWebGLRenderTarget){e.next=2;break}throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");case 2:if(u=fe.get(t).__webglFramebuffer,t.isWebGLCubeRenderTarget&&void 0!==s&&(u=u[s]),!u){e.next=32;break}if(!(n>=0&&n<=t.width-i&&r>=0&&r<=t.height-a)){e.next=31;break}if(ce.bindFramebuffer(Ne.FRAMEBUFFER,u),l=t.texture,c=l.format,h=l.type,le.textureFormatReadable(c)){e.next=12;break}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");case 12:if(le.textureTypeReadable(h)){e.next=14;break}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");case 14:return f=Ne.createBuffer(),Ne.bindBuffer(Ne.PIXEL_PACK_BUFFER,f),Ne.bufferData(Ne.PIXEL_PACK_BUFFER,o.byteLength,Ne.STREAM_READ),Ne.readPixels(n,r,i,a,Ce.convert(c),Ce.convert(h),0),d=null!==O?fe.get(O).__webglFramebuffer:null,ce.bindFramebuffer(Ne.FRAMEBUFFER,d),p=Ne.fenceSync(Ne.SYNC_GPU_COMMANDS_COMPLETE,0),Ne.flush(),e.next=24,Mr(Ne,p,4);case 24:return Ne.bindBuffer(Ne.PIXEL_PACK_BUFFER,f),Ne.getBufferSubData(Ne.PIXEL_PACK_BUFFER,0,o),Ne.deleteBuffer(f),Ne.deleteSync(p),e.abrupt("return",o);case 31:throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.");case 32:case"end":return e.stop()}}),e)})));return function(t,n,r,i,a,o,s){return e.apply(this,arguments)}}(),this.copyFramebufferToTexture=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.pow(2,-n),i=Math.floor(e.image.width*r),a=Math.floor(e.image.height*r),o=null!==t?t.x:0,s=null!==t?t.y:0;de.setTexture2D(e,0),Ne.copyTexSubImage2D(Ne.TEXTURE_2D,n,0,0,o,s,i,a),ce.unbindTexture()};var ut=Ne.createFramebuffer(),ct=Ne.createFramebuffer();this.copyTextureToTexture=function(e,t){var n,r,i,a,o,s,u,l,c,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;null===p&&(0!==d?(kr("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),p=d,d=0):p=0);var A=e.isCompressedTexture?e.mipmaps[p]:e.image;if(null!==h)n=h.max.x-h.min.x,r=h.max.y-h.min.y,i=h.isBox3?h.max.z-h.min.z:1,a=h.min.x,o=h.min.y,s=h.isBox3?h.min.z:0;else{var v=Math.pow(2,-d);n=Math.floor(A.width*v),r=Math.floor(A.height*v),i=e.isDataArrayTexture?A.depth:e.isData3DTexture?Math.floor(A.depth*v):1,a=0,o=0,s=0}null!==f?(u=f.x,l=f.y,c=f.z):(u=0,l=0,c=0);var m,g=Ce.convert(t.format),y=Ce.convert(t.type);t.isData3DTexture?(de.setTexture3D(t,0),m=Ne.TEXTURE_3D):t.isDataArrayTexture||t.isCompressedArrayTexture?(de.setTexture2DArray(t,0),m=Ne.TEXTURE_2D_ARRAY):(de.setTexture2D(t,0),m=Ne.TEXTURE_2D),Ne.pixelStorei(Ne.UNPACK_FLIP_Y_WEBGL,t.flipY),Ne.pixelStorei(Ne.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),Ne.pixelStorei(Ne.UNPACK_ALIGNMENT,t.unpackAlignment);var _=Ne.getParameter(Ne.UNPACK_ROW_LENGTH),b=Ne.getParameter(Ne.UNPACK_IMAGE_HEIGHT),x=Ne.getParameter(Ne.UNPACK_SKIP_PIXELS),w=Ne.getParameter(Ne.UNPACK_SKIP_ROWS),T=Ne.getParameter(Ne.UNPACK_SKIP_IMAGES);Ne.pixelStorei(Ne.UNPACK_ROW_LENGTH,A.width),Ne.pixelStorei(Ne.UNPACK_IMAGE_HEIGHT,A.height),Ne.pixelStorei(Ne.UNPACK_SKIP_PIXELS,a),Ne.pixelStorei(Ne.UNPACK_SKIP_ROWS,o),Ne.pixelStorei(Ne.UNPACK_SKIP_IMAGES,s);var S=e.isDataArrayTexture||e.isData3DTexture,E=t.isDataArrayTexture||t.isData3DTexture;if(e.isDepthTexture){var k=fe.get(e),M=fe.get(t),C=fe.get(k.__renderTarget),R=fe.get(M.__renderTarget);ce.bindFramebuffer(Ne.READ_FRAMEBUFFER,C.__webglFramebuffer),ce.bindFramebuffer(Ne.DRAW_FRAMEBUFFER,R.__webglFramebuffer);for(var P=0;P<i;P++)S&&(Ne.framebufferTextureLayer(Ne.READ_FRAMEBUFFER,Ne.COLOR_ATTACHMENT0,fe.get(e).__webglTexture,d,s+P),Ne.framebufferTextureLayer(Ne.DRAW_FRAMEBUFFER,Ne.COLOR_ATTACHMENT0,fe.get(t).__webglTexture,p,c+P)),Ne.blitFramebuffer(a,o,n,r,u,l,n,r,Ne.DEPTH_BUFFER_BIT,Ne.NEAREST);ce.bindFramebuffer(Ne.READ_FRAMEBUFFER,null),ce.bindFramebuffer(Ne.DRAW_FRAMEBUFFER,null)}else if(0!==d||e.isRenderTargetTexture||fe.has(e)){var N=fe.get(e),I=fe.get(t);ce.bindFramebuffer(Ne.READ_FRAMEBUFFER,ut),ce.bindFramebuffer(Ne.DRAW_FRAMEBUFFER,ct);for(var L=0;L<i;L++)S?Ne.framebufferTextureLayer(Ne.READ_FRAMEBUFFER,Ne.COLOR_ATTACHMENT0,N.__webglTexture,d,s+L):Ne.framebufferTexture2D(Ne.READ_FRAMEBUFFER,Ne.COLOR_ATTACHMENT0,Ne.TEXTURE_2D,N.__webglTexture,d),E?Ne.framebufferTextureLayer(Ne.DRAW_FRAMEBUFFER,Ne.COLOR_ATTACHMENT0,I.__webglTexture,p,c+L):Ne.framebufferTexture2D(Ne.DRAW_FRAMEBUFFER,Ne.COLOR_ATTACHMENT0,Ne.TEXTURE_2D,I.__webglTexture,p),0!==d?Ne.blitFramebuffer(a,o,n,r,u,l,n,r,Ne.COLOR_BUFFER_BIT,Ne.NEAREST):E?Ne.copyTexSubImage3D(m,p,u,l,c+L,a,o,n,r):Ne.copyTexSubImage2D(m,p,u,l,a,o,n,r);ce.bindFramebuffer(Ne.READ_FRAMEBUFFER,null),ce.bindFramebuffer(Ne.DRAW_FRAMEBUFFER,null)}else E?e.isDataTexture||e.isData3DTexture?Ne.texSubImage3D(m,p,u,l,c,n,r,i,g,y,A.data):t.isCompressedArrayTexture?Ne.compressedTexSubImage3D(m,p,u,l,c,n,r,i,g,A.data):Ne.texSubImage3D(m,p,u,l,c,n,r,i,g,y,A):e.isDataTexture?Ne.texSubImage2D(Ne.TEXTURE_2D,p,u,l,n,r,g,y,A.data):e.isCompressedTexture?Ne.compressedTexSubImage2D(Ne.TEXTURE_2D,p,u,l,A.width,A.height,g,A.data):Ne.texSubImage2D(Ne.TEXTURE_2D,p,u,l,n,r,g,y,A);Ne.pixelStorei(Ne.UNPACK_ROW_LENGTH,_),Ne.pixelStorei(Ne.UNPACK_IMAGE_HEIGHT,b),Ne.pixelStorei(Ne.UNPACK_SKIP_PIXELS,x),Ne.pixelStorei(Ne.UNPACK_SKIP_ROWS,w),Ne.pixelStorei(Ne.UNPACK_SKIP_IMAGES,T),0===p&&t.generateMipmaps&&Ne.generateMipmap(m),ce.unbindTexture()},this.copyTextureToTexture3D=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return kr('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(e,t,n,r,i)},this.initRenderTarget=function(e){void 0===fe.get(e).__webglFramebuffer&&de.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?de.setTextureCube(e,0):e.isData3DTexture?de.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?de.setTexture2DArray(e,0):de.setTexture2D(e,0),ce.unbindTexture()},this.resetState=function(){L=0,D=0,O=null,ce.reset(),Re.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}return p(e,[{key:"coordinateSystem",get:function(){return or}},{key:"outputColorSpace",get:function(){return this._outputColorSpace},set:function(e){this._outputColorSpace=e;var t=this.getContext();t.drawingBufferColorSpace=Dr._getDrawingBufferColorSpace(e),t.unpackColorSpace=Dr._getUnpackColorSpace()}}]),e}();ZG.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new _r(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},JG.line={uniforms:oo.merge([ZG.common,ZG.fog,ZG.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\tworldStart = start.xyz;\n\t\t\t\tworldEnd = end.xyz;\n\n\t\t\t#else\n\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec3 ndcStart = clipStart.xyz / clipStart.w;\n\t\t\tvec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd.xy - ndcStart.xy;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\tvec3 worldDir = normalize( end.xyz - start.xyz );\n\t\t\t\tvec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );\n\t\t\t\tvec3 worldUp = normalize( cross( worldDir, tmpFwd ) );\n\t\t\t\tvec3 worldFwd = cross( worldDir, worldUp );\n\t\t\t\tworldPos = position.y < 0.5 ? start: end;\n\n\t\t\t\t// height offset\n\t\t\t\tfloat hw = linewidth * 0.5;\n\t\t\t\tworldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;\n\n\t\t\t\t// don't extend the line if we're rendering dashes because we\n\t\t\t\t// won't be rendering the endcaps\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t// cap extension\n\t\t\t\t\tworldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;\n\n\t\t\t\t\t// add width to the box\n\t\t\t\t\tworldPos.xyz += worldFwd * hw;\n\n\t\t\t\t\t// endcaps\n\t\t\t\t\tif ( position.y > 1.0 || position.y < 0.0 ) {\n\n\t\t\t\t\t\tworldPos.xyz -= worldFwd * 2.0 * hw;\n\n\t\t\t\t\t}\n\n\t\t\t\t#endif\n\n\t\t\t\t// project the worldpos\n\t\t\t\tvec4 clip = projectionMatrix * worldPos;\n\n\t\t\t\t// shift the depth of the projected points so the line\n\t\t\t\t// segments overlap neatly\n\t\t\t\tvec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n\t\t\t\tclip.z = clipPose.z * clip.w;\n\n\t\t\t#else\n\n\t\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\t\t\t\t// undo aspect ratio adjustment\n\t\t\t\tdir.x /= aspect;\n\t\t\t\toffset.x /= aspect;\n\n\t\t\t\t// sign flip\n\t\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t\t// endcaps\n\t\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\t\toffset += - dir;\n\n\t\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\t\toffset += dir;\n\n\t\t\t\t}\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset *= linewidth;\n\n\t\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\t\toffset /= resolution.y;\n\n\t\t\t\t// select end\n\t\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t\t// back to clip space\n\t\t\t\toffset *= clip.w;\n\n\t\t\t\tclip.xy += offset;\n\n\t\t\t#endif\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\t\tuniform float linewidth;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashOffset;\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n\t\t\tfloat mua;\n\t\t\tfloat mub;\n\n\t\t\tvec3 p13 = p1 - p3;\n\t\t\tvec3 p43 = p4 - p3;\n\n\t\t\tvec3 p21 = p2 - p1;\n\n\t\t\tfloat d1343 = dot( p13, p43 );\n\t\t\tfloat d4321 = dot( p43, p21 );\n\t\t\tfloat d1321 = dot( p13, p21 );\n\t\t\tfloat d4343 = dot( p43, p43 );\n\t\t\tfloat d2121 = dot( p21, p21 );\n\n\t\t\tfloat denom = d2121 * d4343 - d4321 * d4321;\n\n\t\t\tfloat numer = d1343 * d4321 - d1321 * d4343;\n\n\t\t\tmua = numer / denom;\n\t\t\tmua = clamp( mua, 0.0, 1.0 );\n\t\t\tmub = ( d1343 + d4321 * ( mua ) ) / d4343;\n\t\t\tmub = clamp( mub, 0.0, 1.0 );\n\n\t\t\treturn vec2( mua, mub );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tfloat alpha = opacity;\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t// Find the closest points on the view ray and the line segment\n\t\t\t\tvec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n\t\t\t\tvec3 lineDir = worldEnd - worldStart;\n\t\t\t\tvec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n\t\t\t\tvec3 p1 = worldStart + lineDir * params.x;\n\t\t\t\tvec3 p2 = rayEnd * params.y;\n\t\t\t\tvec3 delta = p1 - p2;\n\t\t\t\tfloat len = length( delta );\n\t\t\t\tfloat norm = len / linewidth;\n\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t\tfloat dnorm = fwidth( norm );\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n\t\t\t\t\t#else\n\n\t\t\t\t\t\tif ( norm > 0.5 ) {\n\n\t\t\t\t\t\t\tdiscard;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t#endif\n\n\t\t\t\t#endif\n\n\t\t\t#else\n\n\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t// artifacts appear on some hardware if a derivative is taken within a conditional\n\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\tfloat len2 = a * a + b * b;\n\t\t\t\t\tfloat dlen = fwidth( len2 );\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t#else\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t\t\t}\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, alpha );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <colorspace_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"};var RX,PX,NX=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,{type:"LineMaterial",uniforms:oo.clone(JG.line.uniforms),vertexShader:JG.line.vertexShader,fragmentShader:JG.line.fragmentShader,clipping:!0})).isLineMaterial=!0,r.setValues(e),r}return p(n,[{key:"color",get:function(){return this.uniforms.diffuse.value},set:function(e){this.uniforms.diffuse.value=e}},{key:"worldUnits",get:function(){return"WORLD_UNITS"in this.defines},set:function(e){!0===e?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},{key:"linewidth",get:function(){return this.uniforms.linewidth.value},set:function(e){this.uniforms.linewidth&&(this.uniforms.linewidth.value=e)}},{key:"dashed",get:function(){return"USE_DASH"in this.defines},set:function(e){!0===e!==this.dashed&&(this.needsUpdate=!0),!0===e?this.defines.USE_DASH="":delete this.defines.USE_DASH}},{key:"dashScale",get:function(){return this.uniforms.dashScale.value},set:function(e){this.uniforms.dashScale.value=e}},{key:"dashSize",get:function(){return this.uniforms.dashSize.value},set:function(e){this.uniforms.dashSize.value=e}},{key:"dashOffset",get:function(){return this.uniforms.dashOffset.value},set:function(e){this.uniforms.dashOffset.value=e}},{key:"gapSize",get:function(){return this.uniforms.gapSize.value},set:function(e){this.uniforms.gapSize.value=e}},{key:"opacity",get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms&&(this.uniforms.opacity.value=e)}},{key:"resolution",get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}},{key:"alphaToCoverage",get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(e){this.defines&&(!0===e!==this.alphaToCoverage&&(this.needsUpdate=!0),!0===e?this.defines.USE_ALPHA_TO_COVERAGE="":delete this.defines.USE_ALPHA_TO_COVERAGE)}}]),n}(so),IX=new Gr,LX=new Kr,DX=new Kr,OX=new Gr,UX=new Gr,BX=new Gr,FX=new Kr,zX=new Ei,VX=new Rl,qX=new Kr,jX=new $r,GX=new mi,HX=new Gr;function WX(e,t,n){return HX.set(0,0,-t,1).applyMatrix4(e.projectionMatrix),HX.multiplyScalar(1/HX.w),HX.x=PX/n.width,HX.y=PX/n.height,HX.applyMatrix4(e.projectionMatrixInverse),HX.multiplyScalar(1/HX.w),Math.abs(Math.max(HX.x,HX.y))}var XX=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new XG,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new NX({color:16777215*Math.random()});return c(this,n),(e=t.call(this,r,i)).isLineSegments2=!0,e.type="LineSegments2",e}return p(n,[{key:"computeLineDistances",value:function(){for(var e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,r=new Float32Array(2*t.count),i=0,a=0,o=t.count;i<o;i++,a+=2)LX.fromBufferAttribute(t,i),DX.fromBufferAttribute(n,i),r[a]=0===a?0:r[a-1],r[a+1]=r[a]+LX.distanceTo(DX);var s=new bl(r,2,1);return e.setAttribute("instanceDistanceStart",new To(s,1,0)),e.setAttribute("instanceDistanceEnd",new To(s,1,1)),this}},{key:"raycast",value:function(e,t){var n=this.material.worldUnits,r=e.camera;null!==r||n||console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');var i=void 0!==e.params.Line2&&e.params.Line2.threshold||0;RX=e.ray;var a,o=this.matrixWorld,s=this.geometry,u=this.material;(PX=u.linewidth+i,null===s.boundingSphere&&s.computeBoundingSphere(),GX.copy(s.boundingSphere).applyMatrix4(o),n)?a=.5*PX:a=WX(r,Math.max(r.near,GX.distanceToPoint(RX.origin)),u.resolution);if(GX.radius+=a,!1!==RX.intersectsSphere(GX)){var l;if(null===s.boundingBox&&s.computeBoundingBox(),jX.copy(s.boundingBox).applyMatrix4(o),n)l=.5*PX;else l=WX(r,Math.max(r.near,jX.distanceToPoint(RX.origin)),u.resolution);jX.expandByScalar(l),!1!==RX.intersectsBox(jX)&&(n?function(e,t){for(var n=e.matrixWorld,r=e.geometry,i=r.attributes.instanceStart,a=r.attributes.instanceEnd,o=0,s=Math.min(r.instanceCount,i.count);o<s;o++){VX.start.fromBufferAttribute(i,o),VX.end.fromBufferAttribute(a,o),VX.applyMatrix4(n);var u=new Kr,l=new Kr;RX.distanceSqToSegment(VX.start,VX.end,l,u),l.distanceTo(u)<.5*PX&&t.push({point:l,pointOnLine:u,distance:RX.origin.distanceTo(l),object:e,face:null,faceIndex:o,uv:null,uv1:null})}}(this,t):function(e,t,n){var r=t.projectionMatrix,i=e.material.resolution,a=e.matrixWorld,o=e.geometry,s=o.attributes.instanceStart,u=o.attributes.instanceEnd,l=Math.min(o.instanceCount,s.count),c=-t.near;RX.at(1,BX),BX.w=1,BX.applyMatrix4(t.matrixWorldInverse),BX.applyMatrix4(r),BX.multiplyScalar(1/BX.w),BX.x*=i.x/2,BX.y*=i.y/2,BX.z=0,FX.copy(BX),zX.multiplyMatrices(t.matrixWorldInverse,a);for(var h=0,f=l;h<f;h++)if(OX.fromBufferAttribute(s,h),UX.fromBufferAttribute(u,h),OX.w=1,UX.w=1,OX.applyMatrix4(zX),UX.applyMatrix4(zX),!(OX.z>c&&UX.z>c)){if(OX.z>c){var d=OX.z-UX.z,p=(OX.z-c)/d;OX.lerp(UX,p)}else if(UX.z>c){var A=UX.z-OX.z,v=(UX.z-c)/A;UX.lerp(OX,v)}OX.applyMatrix4(r),UX.applyMatrix4(r),OX.multiplyScalar(1/OX.w),UX.multiplyScalar(1/UX.w),OX.x*=i.x/2,OX.y*=i.y/2,UX.x*=i.x/2,UX.y*=i.y/2,VX.start.copy(OX),VX.start.z=0,VX.end.copy(UX),VX.end.z=0;var m=VX.closestPointToPointParameter(FX,!0);VX.at(m,qX);var g=yr.lerp(OX.z,UX.z,m),y=g>=-1&&g<=1,_=FX.distanceTo(qX)<.5*PX;if(y&&_){VX.start.fromBufferAttribute(s,h),VX.end.fromBufferAttribute(u,h),VX.start.applyMatrix4(a),VX.end.applyMatrix4(a);var b=new Kr,x=new Kr;RX.distanceSqToSegment(VX.start,VX.end,x,b),n.push({point:x,pointOnLine:b,distance:RX.origin.distanceTo(x),object:e,face:null,faceIndex:h,uv:null,uv1:null})}}}(this,r,t))}}},{key:"onBeforeRender",value:function(e){var t=this.material.uniforms;t&&t.resolution&&(e.getViewport(IX),this.material.uniforms.resolution.value.set(IX.z,IX.w))}}]),n}(eo),QX=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this)).isLineGeometry=!0,e.type="LineGeometry",e}return p(n,[{key:"setPositions",value:function(e){for(var t=e.length-3,r=new Float32Array(2*t),i=0;i<t;i+=3)r[2*i]=e[i],r[2*i+1]=e[i+1],r[2*i+2]=e[i+2],r[2*i+3]=e[i+3],r[2*i+4]=e[i+4],r[2*i+5]=e[i+5];return ht(m(n.prototype),"setPositions",this).call(this,r),this}},{key:"setColors",value:function(e){for(var t=e.length-3,r=new Float32Array(2*t),i=0;i<t;i+=3)r[2*i]=e[i],r[2*i+1]=e[i+1],r[2*i+2]=e[i+2],r[2*i+3]=e[i+3],r[2*i+4]=e[i+4],r[2*i+5]=e[i+5];return ht(m(n.prototype),"setColors",this).call(this,r),this}},{key:"setFromPoints",value:function(e){for(var t=e.length-1,r=new Float32Array(6*t),i=0;i<t;i++)r[6*i]=e[i].x,r[6*i+1]=e[i].y,r[6*i+2]=e[i].z||0,r[6*i+3]=e[i+1].x,r[6*i+4]=e[i+1].y,r[6*i+5]=e[i+1].z||0;return ht(m(n.prototype),"setPositions",this).call(this,r),this}},{key:"fromLine",value:function(e){var t=e.geometry;return this.setPositions(t.attributes.position.array),this}}]),n}(XG),YX=function(e){v(n,e);var t=b(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new QX,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new NX({color:16777215*Math.random()});return c(this,n),(e=t.call(this,r,i)).isLine2=!0,e.type="Line2",e}return p(n)}(XX),KX=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};c(this,n);var a=i.font;if(void 0===a)r=t.call(this);else{var o=a.generateShapes(e,i.size);void 0===i.depth&&(i.depth=50),void 0===i.bevelThickness&&(i.bevelThickness=10),void 0===i.bevelSize&&(i.bevelSize=8),void 0===i.bevelEnabled&&(i.bevelEnabled=!1),r=t.call(this,o,i)}return r.type="TextGeometry",_(r)}return p(n)}(au),ZX=function(){function e(t){c(this,e),this.isFont=!0,this.type="Font",this.data=t}return p(e,[{key:"generateShapes",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=[],r=JX(e,t,this.data),i=0,a=r.length;i<a;i++)n.push.apply(n,l(r[i].toShapes()));return n}}]),e}();function JX(e,t,n){for(var r=Array.from(e),i=t/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,o=[],s=0,u=0,l=0;l<r.length;l++){var c=r[l];if("\n"===c)s=0,u-=a;else{var h=$X(c,i,s,u,n);s+=h.offsetX,o.push(h.path)}}return o}function $X(e,t,n,r,i){var a=i.glyphs[e]||i.glyphs["?"];if(a){var o,s,u,l,c,h,f,d,p=new Pl;if(a.o)for(var A=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),v=0,m=A.length;v<m;){switch(A[v++]){case"m":o=A[v++]*t+n,s=A[v++]*t+r,p.moveTo(o,s);break;case"l":o=A[v++]*t+n,s=A[v++]*t+r,p.lineTo(o,s);break;case"q":u=A[v++]*t+n,l=A[v++]*t+r,c=A[v++]*t+n,h=A[v++]*t+r,p.quadraticCurveTo(c,h,u,l);break;case"b":u=A[v++]*t+n,l=A[v++]*t+r,c=A[v++]*t+n,h=A[v++]*t+r,f=A[v++]*t+n,d=A[v++]*t+r,p.bezierCurveTo(c,h,f,d,u,l)}}return{offsetX:a.ha*t,path:p}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".")}function eQ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function tQ(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function nQ(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function rQ(e,t,n){return t=fQ(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,pQ()?Reflect.construct(t,n||[],fQ(e).constructor):t.apply(e,n))}function iQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aQ(e,t){return e.get(tQ(e,t))}function oQ(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function sQ(e,t,n){return e.set(tQ(e,t),n),n}function uQ(e,t,n){if(pQ())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var i=new(e.bind.apply(e,r));return i}function lQ(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,wQ(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function cQ(e,t,n){return(t=wQ(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hQ(){return hQ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=_Q(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},hQ.apply(null,arguments)}function fQ(e){return fQ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fQ(e)}function dQ(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gQ(e,t)}function pQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(pQ=function(){return!!e})()}function AQ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vQ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?AQ(Object(n),!0).forEach((function(t){cQ(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AQ(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mQ(){mQ=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,o=Object.create(a.prototype),s=new C(r||[]);return i(o,"_invoke",{value:S(e,n,s)}),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var f="suspendedStart",d="executing",p="completed",A={};function v(){}function m(){}function g(){}var y={};l(y,o,(function(){return this}));var _=Object.getPrototypeOf,b=_&&_(_(R([])));b&&b!==n&&r.call(b,o)&&(y=b);var x=g.prototype=v.prototype=Object.create(y);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function n(i,a,o,s){var u=h(e[i],e,a);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==typeof c&&r.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(c).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,s)}))}s(u.arg)}var a;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return a=a?a.then(i,i):i()}})}function S(t,n,r){var i=f;return function(a,o){if(i===d)throw Error("Generator is already running");if(i===p){if("throw"===a)throw o;return{value:e,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var u=E(s,r);if(u){if(u===A)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=d;var l=h(t,n,r);if("normal"===l.type){if(i=r.done?p:"suspendedYield",l.arg===A)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=p,r.method="throw",r.arg=l.arg)}}}function E(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,E(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),A;var a=h(i,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,A;var o=a.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,A):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,A)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function R(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(typeof t+" is not iterable")}return m.prototype=g,i(x,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:m,configurable:!0}),m.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,u,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},w(T.prototype),l(T.prototype,s,(function(){return this})),t.AsyncIterator=T,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new T(c(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},w(x),l(x,u,"Generator"),l(x,o,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=R,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,A):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),A},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),M(n),A}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:R(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),A}},t}function gQ(e,t){return gQ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},gQ(e,t)}function yQ(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(e,t)||TQ(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _Q(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=fQ(e)););return e}function bQ(e,t,n,r){var i=hQ(fQ(e.prototype),t,n);return"function"==typeof i?function(e){return i.apply(n,e)}:i}function xQ(e){return function(e){if(Array.isArray(e))return eQ(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||TQ(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wQ(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function TQ(e,t){if(e){if("string"==typeof e)return eQ(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eQ(e,t):void 0}}var SQ=function(e){e instanceof Array?e.forEach(SQ):(e.map&&e.map.dispose(),e.dispose())},EQ=function(e){e.geometry&&e.geometry.dispose(),e.material&&SQ(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(EQ)},kQ=function(e){if(e&&e.children)for(;e.children.length;){var t=e.children[0];e.remove(t),EQ(t)}};function MQ(e,t){var n=new t;return{linkProp:function(t){return{default:n[t](),onChange:function(n,r){r[e][t](n)},triggerUpdate:!1}},linkMethod:function(t){return function(n){for(var r=n[e],i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];var s=r[t].apply(r,a);return s===r?this:s}}}}var CQ=100;function RQ(){return CQ}function PQ(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=(90-e)*Math.PI/180,i=(90-t)*Math.PI/180,a=CQ*(1+n),o=Math.sin(r);return{x:a*o*Math.cos(i),y:a*Math.cos(r),z:a*o*Math.sin(i)}}function NQ(e){var t=e.x,n=e.y,r=e.z,i=Math.sqrt(t*t+n*n+r*r),a=Math.acos(n/i),o=Math.atan2(r,t);return{lat:90-180*a/Math.PI,lng:90-180*o/Math.PI-(o<-Math.PI/2?360:0),altitude:i/CQ-1}}function IQ(e){return e*Math.PI/180}var LQ=window.THREE?window.THREE:{BackSide:1,BufferAttribute:Ra,Color:ga,Mesh:eo,ShaderMaterial:so};function DQ(e,t,n,r){return new LQ.ShaderMaterial({depthWrite:!1,transparent:!0,vertexShader:"\nuniform float hollowRadius;\n\nvarying vec3 vVertexWorldPosition;\nvarying vec3 vVertexNormal;\nvarying float vCameraDistanceToObjCenter;\nvarying float vVertexAngularDistanceToHollowRadius;\n\nvoid main() {    \n  vVertexNormal\t= normalize(normalMatrix * normal);\n  vVertexWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\n  \n  vec4 objCenterViewPosition = modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0);\n  vCameraDistanceToObjCenter = length(objCenterViewPosition);\n  \n  float edgeAngle = atan(hollowRadius / vCameraDistanceToObjCenter);\n  float vertexAngle = acos(dot(normalize(modelViewMatrix * vec4(position, 1.0)), normalize(objCenterViewPosition)));\n  vVertexAngularDistanceToHollowRadius = vertexAngle - edgeAngle;\n\n  gl_Position\t= projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"\nuniform vec3 color;\nuniform float coefficient;\nuniform float power;\nuniform float hollowRadius;\n\nvarying vec3 vVertexNormal;\nvarying vec3 vVertexWorldPosition;\nvarying float vCameraDistanceToObjCenter;\nvarying float vVertexAngularDistanceToHollowRadius;\n\nvoid main() {\n  if (vCameraDistanceToObjCenter < hollowRadius) discard; // inside the hollowRadius\n  if (vVertexAngularDistanceToHollowRadius < 0.0) discard; // frag position is within the hollow radius\n\n  vec3 worldCameraToVertex = vVertexWorldPosition - cameraPosition;\n  vec3 viewCameraToVertex\t= (viewMatrix * vec4(worldCameraToVertex, 0.0)).xyz;\n  viewCameraToVertex = normalize(viewCameraToVertex);\n  float intensity\t= pow(\n    coefficient + dot(vVertexNormal, viewCameraToVertex),\n    power\n  );\n  gl_FragColor = vec4(color, intensity);\n}",uniforms:{coefficient:{value:e},color:{value:new LQ.Color(t)},power:{value:n},hollowRadius:{value:r}}})}function OQ(e,t){for(var n=e.clone(),r=new Float32Array(3*e.attributes.position.count),i=0,a=r.length;i<a;i++){var o=e.attributes.normal.array[i],s=e.attributes.position.array[i];r[i]=s+o*t}return n.setAttribute("position",new LQ.BufferAttribute(r,3)),n}var UQ=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.color,a=void 0===i?"gold":i,o=r.size,s=void 0===o?2:o,u=r.coefficient,l=void 0===u?.5:u,c=r.power,h=void 0===c?1:c,f=r.hollowRadius,d=void 0===f?0:f,p=r.backside,A=void 0===p||p;iQ(this,t),n=rQ(this,t);var v=OQ(e,s),m=DQ(l,a,h,d);return A&&(m.side=LQ.BackSide),n.geometry=v,n.material=m,n}return dQ(t,e),lQ(t)}(LQ.Mesh),BQ=window.THREE?window.THREE:{Color:ga,Group:go,LineBasicMaterial:Do,LineSegments:Xo,Mesh:eo,MeshPhongMaterial:Au,SphereGeometry:uu,SRGBColorSpace:Kn,TextureLoader:qu},FQ=_c({props:{globeImageUrl:{},bumpImageUrl:{},showGlobe:{default:!0,onChange:function(e,t){t.globeGroup.visible=!!e},triggerUpdate:!1},showGraticules:{default:!1,onChange:function(e,t){t.graticulesObj.visible=!!e},triggerUpdate:!1},showAtmosphere:{default:!0,onChange:function(e,t){t.atmosphereObj&&(t.atmosphereObj.visible=!!e)},triggerUpdate:!1},atmosphereColor:{default:"lightskyblue"},atmosphereAltitude:{default:.15},globeTileEngineUrl:{onChange:function(e,t){t.tileEngine.tileUrl=e}},globeTileEngineMaxLevel:{default:17,onChange:function(e,t){t.tileEngine.maxLevel=e},triggerUpdate:!1},updatePov:{onChange:function(e,t){t.tileEngine.updatePov(e)},triggerUpdate:!1},onReady:{default:function(){},triggerUpdate:!1}},methods:{globeMaterial:function(e,t){return void 0!==t?(e.globeObj.material=t||e.defaultGlobeMaterial,this):e.globeObj.material},_destructor:function(e){kQ(e.globeObj),kQ(e.tileEngine),kQ(e.graticulesObj)}},stateInit:function(){var e=new BQ.SphereGeometry(CQ,75,75),t=new BQ.MeshPhongMaterial({color:0}),n=new BQ.Mesh(e,t);n.rotation.y=-Math.PI/2;var r=new Nd(CQ),i=new BQ.Group;return i.__globeObjType="globe",i.add(n),i.add(r),{globeGroup:i,globeObj:n,graticulesObj:new BQ.LineSegments(new qp(Yp(),CQ,2),new BQ.LineBasicMaterial({color:"lightgrey",transparent:!0,opacity:.1})),defaultGlobeMaterial:t,tileEngine:r}},init:function(e,t){kQ(e),t.scene=e,t.scene.add(t.globeGroup),t.scene.add(t.graticulesObj),t.ready=!1},update:function(e,t){var n=e.globeObj.material;if(e.tileEngine.visible=!(e.globeObj.visible=!e.globeTileEngineUrl),t.hasOwnProperty("globeImageUrl")&&(e.globeImageUrl?(new BQ.TextureLoader).load(e.globeImageUrl,(function(t){t.colorSpace=BQ.SRGBColorSpace,n.map=t,n.color=null,n.needsUpdate=!0,!e.ready&&(e.ready=!0)&&setTimeout(e.onReady)})):!n.color&&(n.color=new BQ.Color(0))),t.hasOwnProperty("bumpImageUrl")&&(e.bumpImageUrl?e.bumpImageUrl&&(new BQ.TextureLoader).load(e.bumpImageUrl,(function(e){n.bumpMap=e,n.needsUpdate=!0})):(n.bumpMap=null,n.needsUpdate=!0)),(t.hasOwnProperty("atmosphereColor")||t.hasOwnProperty("atmosphereAltitude"))&&(e.atmosphereObj&&(e.scene.remove(e.atmosphereObj),kQ(e.atmosphereObj)),e.atmosphereColor&&e.atmosphereAltitude)){var r=e.atmosphereObj=new UQ(e.globeObj.geometry,{color:e.atmosphereColor,size:CQ*e.atmosphereAltitude,hollowRadius:CQ,coefficient:.1,power:3.5});r.visible=!!e.showAtmosphere,r.__globeObjType="atmosphere",e.scene.add(r)}e.ready||e.globeImageUrl&&!e.globeTileEngineUrl||(e.ready=!0,e.onReady())}}),zQ=function(e){return isNaN(e)?parseInt(dA(e).toHex(),16):e},VQ=function(e){return e&&isNaN(e)?Ah(e).opacity:1},qQ=function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=1,a=/^rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.eE+-]+)\s*\)$/.exec(e.trim().toLowerCase());if(a){var o=a.slice(1),s=yQ(o,4),u=s[0],l=s[1],c=s[2],h=s[3];t=new ga("rgb(".concat(+u,",").concat(+l,",").concat(+c,")")),i=Math.min(+h,1)}else t=new ga(e);r&&t.convertLinearToSRGB();var f=t.toArray();return n?[].concat(xQ(f),[i]):f};var jQ=window.THREE?window.THREE:{BufferAttribute:Ra};function GQ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float32Array;if(1===t)return new jQ.BufferAttribute(new n(e),t);for(var r=new jQ.BufferAttribute(new n(e.length*t),t),i=0,a=e.length;i<a;i++)r.set(e[i],i*t);return r}var HQ=new WeakMap,WQ=new WeakMap,XQ=new WeakMap,QQ=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.dataBindAttr,a=void 0===i?"__data":i,o=r.objBindAttr,s=void 0===o?"__threeObj":o,u=r.removeDelay,l=void 0===u?0:u;return iQ(this,t),cQ(n=rQ(this,t),"scene",void 0),oQ(n,HQ,void 0),oQ(n,WQ,void 0),oQ(n,XQ,void 0),n.scene=e,sQ(HQ,n,a),sQ(WQ,n,s),sQ(XQ,n,l),n.onRemoveObj((function(){})),n}return dQ(t,e),lQ(t,[{key:"onCreateObj",value:function(e){var n=this;return bQ(t,"onCreateObj",this)([function(t){var r=e(t);return t[aQ(WQ,n)]=r,r[aQ(HQ,n)]=t,n.scene.add(r),r}]),this}},{key:"onRemoveObj",value:function(e){var n=this;return bQ(t,"onRemoveObj",this)([function(r,i){var a=bQ(t,"getData",n)([r]);e(r,i);var o=function(){n.scene.remove(r),kQ(r),delete a[aQ(WQ,n)]};aQ(XQ,n)?setTimeout(o,aQ(XQ,n)):o()}]),this}}])}(iv),YQ=window.THREE?window.THREE:{BufferGeometry:qa,CylinderGeometry:Es,Matrix4:Ei,Mesh:eo,MeshLambertMaterial:gu,Object3D:$i,Vector3:Kr},KQ=Object.assign({},e),ZQ=KQ.BufferGeometryUtils||KQ,JQ=_c({props:{pointsData:{default:[]},pointLat:{default:"lat"},pointLng:{default:"lng"},pointColor:{default:function(){return"#ffffaa"}},pointAltitude:{default:.1},pointRadius:{default:.25},pointResolution:{default:12,triggerUpdate:!1},pointsMerge:{default:!1},pointsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,n){var r=n.tweenGroup;kQ(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new QQ(e,{objBindAttr:"__threeObjPoint"})},update:function(e,t){var n=lA(e.pointLat),r=lA(e.pointLng),i=lA(e.pointAltitude),a=lA(e.pointRadius),o=lA(e.pointColor),s=new YQ.CylinderGeometry(1,1,1,e.pointResolution);s.applyMatrix4((new YQ.Matrix4).makeRotationX(Math.PI/2)),s.applyMatrix4((new YQ.Matrix4).makeTranslation(0,0,-.5));var u=2*Math.PI*CQ/360,l={};if(!e.pointsMerge&&t.hasOwnProperty("pointsMerge")&&kQ(e.scene),e.dataMapper.scene=e.pointsMerge?new YQ.Object3D:e.scene,e.dataMapper.onCreateObj((function(){var e=new YQ.Mesh(s);return e.__globeObjType="point",e})).onUpdateObj((function(t,s){var c=function(n){var r=t.__currentTargetD=n,i=r.r,a=r.alt,o=r.lat,s=r.lng;Object.assign(t.position,PQ(o,s));var l=e.pointsMerge?new YQ.Vector3(0,0,0):e.scene.localToWorld(new YQ.Vector3(0,0,0));t.lookAt(l),t.scale.x=t.scale.y=Math.min(30,i)*u,t.scale.z=Math.max(a*CQ,.1)},h={alt:+i(s),r:+a(s),lat:+n(s),lng:+r(s)},f=t.__currentTargetD||Object.assign({},h,{alt:-.001});Object.keys(h).some((function(e){return f[e]!==h[e]}))&&(e.pointsMerge||!e.pointsTransitionDuration||e.pointsTransitionDuration<0?c(h):e.tweenGroup.add(new kc(f).to(h,e.pointsTransitionDuration).easing(bc.Quadratic.InOut).onUpdate(c).start()));if(!e.pointsMerge){var d=o(s),p=d?VQ(d):0,A=!!p;t.visible=A,A&&(l.hasOwnProperty(d)||(l[d]=new YQ.MeshLambertMaterial({color:zQ(d),transparent:p<1,opacity:p})),t.material=l[d])}})).digest(e.pointsData),e.pointsMerge){var c=e.pointsData.length?(ZQ.mergeGeometries||ZQ.mergeBufferGeometries)(e.pointsData.map((function(t){var n=e.dataMapper.getObj(t),r=n.geometry.clone();n.updateMatrix(),r.applyMatrix4(n.matrix);var i=qQ(o(t));return r.setAttribute("color",GQ(Array(r.getAttribute("position").count).fill(i),4)),r}))):new YQ.BufferGeometry,h=new YQ.Mesh(c,new YQ.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0}));h.__globeObjType="points",h.__data=e.pointsData,e.dataMapper.clear(),kQ(e.scene),e.scene.add(h)}}}),$Q=function(e){return e.uniforms.surfaceRadius={type:"float",value:0},e.vertexShader=("attribute float surfaceRadius;\nvarying float vSurfaceRadius;\nvarying vec3 vPos;\n"+e.vertexShader).replace("void main() {",["void main() {","vSurfaceRadius = surfaceRadius;","vPos = position;"].join("\n")),e.fragmentShader=("uniform float surfaceRadius;\nvarying float vSurfaceRadius;\nvarying vec3 vPos;\n"+e.fragmentShader).replace("void main() {",["void main() {","if (length(vPos) < max(surfaceRadius, vSurfaceRadius)) discard;"].join("\n")),e},eY=function(e){return e.vertexShader="\n    attribute float r;\n    \n    const float PI = 3.1415926535897932384626433832795;\n    float toRad(in float a) {\n      return a * PI / 180.0;\n    }\n    \n    vec3 Polar2Cartesian(in vec3 c) { // [lat, lng, r]\n      float phi = toRad(90.0 - c.x);\n      float theta = toRad(90.0 - c.y);\n      float r = c.z;\n      return vec3( // x,y,z\n        r * sin(phi) * cos(theta),\n        r * cos(phi),\n        r * sin(phi) * sin(theta)\n      );\n    }\n    \n    vec2 Cartesian2Polar(in vec3 p) {\n      float r = sqrt(p.x * p.x + p.y * p.y + p.z * p.z);\n      float phi = acos(p.y / r);\n      float theta = atan(p.z, p.x);\n      return vec2( // lat,lng\n        90.0 - phi * 180.0 / PI,\n        90.0 - theta * 180.0 / PI - (theta < -PI / 2.0 ? 360.0 : 0.0)\n      );\n    }\n    ".concat(e.vertexShader.replace("}","                  \n        vec3 pos = Polar2Cartesian(vec3(Cartesian2Polar(position), r));\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n      }\n    "),"\n  "),e},tY=function(e,t){return e.onBeforeCompile=function(n){e.userData.shader=t(n)},e},nY=["stroke"],rY=window.THREE?window.THREE:{BufferGeometry:qa,CubicBezierCurve3:vs,Curve:rs,Group:go,Line:jo,Mesh:eo,NormalBlending:1,ShaderMaterial:so,TubeGeometry:lu,Vector3:Kr},iY=av.default||av,aY=_c({props:{arcsData:{default:[]},arcStartLat:{default:"startLat"},arcStartLng:{default:"startLng"},arcEndLat:{default:"endLat"},arcEndLng:{default:"endLng"},arcColor:{default:function(){return"#ffffaa"}},arcAltitude:{},arcAltitudeAutoScale:{default:.5},arcStroke:{},arcCurveResolution:{default:64,triggerUpdate:!1},arcCircularResolution:{default:6,triggerUpdate:!1},arcDashLength:{default:1},arcDashGap:{default:0},arcDashInitialGap:{default:0},arcDashAnimateTime:{default:0},arcsTransitionDuration:{default:1e3,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var t;null===(t=e.ticker)||void 0===t||t.pause()},resumeAnimation:function(e){var t;null===(t=e.ticker)||void 0===t||t.resume()},_destructor:function(e){var t;e.sharedMaterial.dispose(),null===(t=e.ticker)||void 0===t||t.dispose()}},stateInit:function(e){return{tweenGroup:e.tweenGroup,ticker:new iY,sharedMaterial:new rY.ShaderMaterial(vQ(vQ({},{uniforms:{dashOffset:{value:0},dashSize:{value:1},gapSize:{value:0},dashTranslate:{value:0}},vertexShader:"\n    uniform float dashTranslate; \n\n    attribute vec4 color;\n    varying vec4 vColor;\n    \n    attribute float relDistance;\n    varying float vRelDistance;\n\n    void main() {\n      // pass through colors and distances\n      vColor = color;\n      vRelDistance = relDistance + dashTranslate;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  ",fragmentShader:"\n    uniform float dashOffset; \n    uniform float dashSize;\n    uniform float gapSize; \n    \n    varying vec4 vColor;\n    varying float vRelDistance;\n    \n    void main() {\n      // ignore pixels in the gap\n      if (vRelDistance < dashOffset) discard;\n      if (mod(vRelDistance - dashOffset, dashSize + gapSize) > dashSize) discard;\n    \n      // set px color: [r, g, b, a], interpolated between vertices \n      gl_FragColor = vColor; \n    }\n  "}),{},{transparent:!0,blending:rY.NormalBlending}))}},init:function(e,t){kQ(e),t.scene=e,t.dataMapper=new QQ(e,{objBindAttr:"__threeObjArc"}).onCreateObj((function(){var e=new rY.Group;return e.__globeObjType="arc",e})),t.ticker.onTick.add((function(e,n){t.dataMapper.entries().map((function(e){return yQ(e,2)[1]})).filter((function(e){return e.children.length&&e.children[0].material&&e.children[0].__dashAnimateStep})).forEach((function(e){var t=e.children[0],r=t.__dashAnimateStep*n,i=t.material.uniforms.dashTranslate.value%1e9;t.material.uniforms.dashTranslate.value=i+r}))}))},update:function(e){var t=lA(e.arcStartLat),n=lA(e.arcStartLng),r=lA(e.arcEndLat),i=lA(e.arcEndLng),a=lA(e.arcAltitude),o=lA(e.arcAltitudeAutoScale),s=lA(e.arcStroke),u=lA(e.arcColor),l=lA(e.arcDashLength),c=lA(e.arcDashGap),h=lA(e.arcDashInitialGap),f=lA(e.arcDashAnimateTime);e.dataMapper.onUpdateObj((function(d,p){var A=s(p),v=null!==A&&void 0!==A;if(!d.children.length||v!==("Mesh"===d.children[0].type)){kQ(d);var m=v?new rY.Mesh:new rY.Line(new rY.BufferGeometry);m.material=e.sharedMaterial.clone(),d.add(m)}var g=d.children[0];Object.assign(g.material.uniforms,{dashSize:{value:l(p)},gapSize:{value:c(p)},dashOffset:{value:h(p)}});var y=f(p);g.__dashAnimateStep=y>0?1e3/y:0;var _=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=t+1;if(e instanceof Array||e instanceof Function){var a=e instanceof Array?Sf().domain(e.map((function(t,n){return n/(e.length-1)}))).range(e):e;n=function(e){return qQ(a(e),!0,!0)}}else{var o=qQ(e,!0,!0);n=function(){return o}}for(var s=[],u=0,l=i;u<l;u++)for(var c=n(u/(l-1)),h=0;h<r;h++)s.push(c);return GQ(s,4)}(u(p),e.arcCurveResolution,v?e.arcCircularResolution+1:1),b=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[],i=0,a=e+1;i<a;i++)for(var o=i/(a-1),s=0;s<t;s++)r.push(o);return n&&r.reverse(),GQ(r,1)}(e.arcCurveResolution,v?e.arcCircularResolution+1:1,!0);g.geometry.setAttribute("color",_),g.geometry.setAttribute("relDistance",b);var x=function(t){var n=d.__currentTargetD=t,r=n.stroke,i=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(n,nY),a=function(e){var t=e.alt,n=e.altAutoScale,r=e.startLat,i=e.startLng,a=e.endLat,o=e.endLng,s=function(e){var t=yQ(e,3),n=t[0],r=PQ(t[1],n,t[2]),i=r.x,a=r.y,o=r.z;return new rY.Vector3(i,a,o)},u=[i,r],l=[o,a],c=t;if((null===c||void 0===c)&&(c=Mp(u,l)/2*n),c){var h=Cp(u,l),f=[.25,.75].map((function(e){return[].concat(xQ(h(e)),[1.5*c])})),d=yQ(f,2),p=d[0],A=d[1];return uQ(rY.CubicBezierCurve3,xQ([u,p,A,l].map(s)))}var v=.001;return m.apply(void 0,xQ([[].concat(u,[v]),[].concat(l,[v])].map(s)));function m(e,t){var n=e.angleTo(t),r=0===n?function(){return e.clone()}:function(r){return(new rY.Vector3).addVectors(e.clone().multiplyScalar(Math.sin((1-r)*n)),t.clone().multiplyScalar(Math.sin(r*n))).divideScalar(Math.sin(n))},i=new rY.Curve;return i.getPoint=r,i}}(i);v?(g.geometry&&g.geometry.dispose(),g.geometry=new rY.TubeGeometry(a,e.arcCurveResolution,r/2,e.arcCircularResolution),g.geometry.setAttribute("color",_),g.geometry.setAttribute("relDistance",b)):g.geometry.setFromPoints(a.getPoints(e.arcCurveResolution))},w={stroke:A,alt:a(p),altAutoScale:+o(p),startLat:+t(p),startLng:+n(p),endLat:+r(p),endLng:+i(p)},T=d.__currentTargetD||Object.assign({},w,{altAutoScale:-.001});Object.keys(w).some((function(e){return T[e]!==w[e]}))&&(!e.arcsTransitionDuration||e.arcsTransitionDuration<0?x(w):e.tweenGroup.add(new kc(T).to(w,e.arcsTransitionDuration).easing(bc.Quadratic.InOut).onUpdate(x).start()))})).digest(e.arcsData)}}),oY=window.THREE?window.THREE:{BufferGeometry:qa,DoubleSide:2,Mesh:eo,MeshLambertMaterial:gu,Object3D:$i},sY=Object.assign({},e),uY=sY.BufferGeometryUtils||sY,lY=_c({props:{hexBinPointsData:{default:[]},hexBinPointLat:{default:"lat"},hexBinPointLng:{default:"lng"},hexBinPointWeight:{default:1},hexBinResolution:{default:4},hexMargin:{default:.2},hexTopCurvatureResolution:{default:5},hexTopColor:{default:function(){return"#ffffaa"}},hexSideColor:{default:function(){return"#ffffaa"}},hexAltitude:{default:function(e){return.01*e.sumWeight}},hexBinMerge:{default:!1},hexTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,n){var r=n.tweenGroup;kQ(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new QQ(e,{objBindAttr:"__threeObjHexbin"})},update:function(e,t){var n=lA(e.hexBinPointLat),r=lA(e.hexBinPointLng),i=lA(e.hexBinPointWeight),a=lA(e.hexAltitude),o=lA(e.hexTopColor),s=lA(e.hexSideColor),u=lA(e.hexMargin),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=(t instanceof Array?t.length?t:[void 0]:[t]).map((function(e){return{keyAccessor:e,isProp:!(e instanceof Function)}})),a=e.reduce((function(e,t){var r=e,a=t;return i.forEach((function(e,t){var o,s=e.keyAccessor;if(e.isProp){var u=a,l=u[s],c=jy(u,[s].map(Wy));o=l,a=c}else o=s(a,t);t+1<i.length?(r.hasOwnProperty(o)||(r[o]={}),r=r[o]):n?(r.hasOwnProperty(o)||(r[o]=[]),r[o].push(a)):r[o]=a})),e}),{});n instanceof Function&&function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;r===i.length?Object.keys(t).forEach((function(e){return t[e]=n(t[e])})):Object.values(t).forEach((function(t){return e(t,r+1)}))}(a);var o=a;return r&&(o=[],function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];n.length===i.length?o.push({keys:n,vals:t}):Object.entries(t).forEach((function(t){var r=Gy(t,2),i=r[0],a=r[1];return e(a,[].concat(Hy(n),[i]))}))}(a),t instanceof Array&&0===t.length&&1===o.length&&(o[0].keys=[])),o}(e.hexBinPointsData.map((function(t){return vQ(vQ({},t),{},{h3Idx:k_(n(t),r(t),e.hexBinResolution)})})),"h3Idx"),c=Object.entries(l).map((function(e){var t=yQ(e,2),n=t[0],r=t[1];return{h3Idx:n,points:r,sumWeight:r.reduce((function(e,t){return e+ +i(t)}),0)}})),h={};if(!e.hexBinMerge&&t.hasOwnProperty("hexBinMerge")&&kQ(e.scene),e.dataMapper.scene=e.hexBinMerge?new oY.Object3D:e.scene,e.dataMapper.id((function(e){return e.h3Idx})).onCreateObj((function(e){var t=new oY.Mesh;t.__hexCenter=M_(e.h3Idx),t.__hexGeoJson=C_(e.h3Idx,!0).reverse();var n=t.__hexCenter[1];return t.__hexGeoJson.forEach((function(e){var t=e[0];Math.abs(n-t)>170&&(e[0]+=n>t?360:-360)})),t.__globeObjType="hexbin",t})).onUpdateObj((function(t,n){var r=Math.max(0,Math.min(1,+u(n))),i=yQ(t.__hexCenter,2),l=i[0],c=i[1],f=0===r?t.__hexGeoJson:t.__hexGeoJson.map((function(e){var t=yQ(e,2),n=t[0],i=t[1];return[[n,c],[i,l]].map((function(e){var t=yQ(e,2);return function(e,t,n){return e-(e-t)*n}(t[0],t[1],r)}))})),d=e.hexTopCurvatureResolution;t.geometry&&t.geometry.dispose(),t.geometry=new Vy([f],0,CQ,!1,!0,!0,d);var p={alt:+a(n)},A=function(e){var n=(t.__currentTargetD=e).alt;t.scale.x=t.scale.y=t.scale.z=1+n;var r=CQ/(n+1);t.geometry.setAttribute("surfaceRadius",GQ(Array(t.geometry.getAttribute("position").count).fill(r),1))},v=t.__currentTargetD||Object.assign({},p,{alt:-.001});Object.keys(p).some((function(e){return v[e]!==p[e]}))&&(e.hexBinMerge||!e.hexTransitionDuration||e.hexTransitionDuration<0?A(p):e.tweenGroup.add(new kc(v).to(p,e.hexTransitionDuration).easing(bc.Quadratic.InOut).onUpdate(A).start()));if(!e.hexBinMerge){var m=s(n),g=o(n);[m,g].forEach((function(e){if(!h.hasOwnProperty(e)){var t=VQ(e);h[e]=tY(new oY.MeshLambertMaterial({color:zQ(e),transparent:t<1,opacity:t,side:oY.DoubleSide}),$Q)}})),t.material=[m,g].map((function(e){return h[e]}))}})).digest(c),e.hexBinMerge){var f=c.length?(uY.mergeGeometries||uY.mergeBufferGeometries)(c.map((function(t){var n=e.dataMapper.getObj(t),r=n.geometry.toNonIndexed();n.updateMatrix(),r.applyMatrix4(n.matrix);var i=qQ(o(t)),a=qQ(s(t)),u=r.getAttribute("position").count,l=r.groups[0].count;return r.setAttribute("color",GQ(xQ(new Array(u)).map((function(e,t){return t>=l?i:a})),4)),r}))):new oY.BufferGeometry,d=new oY.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0,side:oY.DoubleSide});d.onBeforeCompile=function(e){d.userData.shader=$Q(e)};var p=new oY.Mesh(f,d);p.__globeObjType="hexBinPoints",p.__data=c,e.dataMapper.clear(),kQ(e.scene),e.scene.add(p)}}}),cY=function(e){return e*e},hY=function(e){return e*Math.PI/180};function fY(e,t){var n=Math.sqrt,r=Math.cos,i=function(e){return cY(Math.sin(e/2))},a=hY(e[1]),o=hY(t[1]),s=hY(e[0]),u=hY(t[0]);return 2*Math.asin(n(i(o-a)+r(a)*r(o)*i(u-s)))}var dY=Math.sqrt(2*Math.PI);function pY(e,t){return Math.exp(-cY(e/t)/2)/(t*dY)}var AY=function(e){var t=yQ(e,2),n=t[0],r=t[1],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=a.lngAccessor,s=void 0===o?function(e){return e[0]}:o,u=a.latAccessor,l=void 0===u?function(e){return e[1]}:u,c=a.weightAccessor,h=void 0===c?function(){return 1}:c,f=a.bandwidth,d=[n,r],p=f*Math.PI/180;return D_(i.map((function(e){var t=h(e);return t?pY(fY(d,[s(e),l(e)]),p)*t:0})))},vY=function(){var e=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){nQ(a,r,i,o,s,"next",e)}function s(e){nQ(a,r,i,o,s,"throw",e)}o(void 0)}))}}(mQ().mark((function e(t){var n,r,i,a,o,s,u,l,c,h,f,d,p,A,v,m,g,y,_,b,x,w,T,S,E,k,M,C,R,P,N,I,L,D,O,U,B,F,z,V,q=arguments;return mQ().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=q.length>1&&void 0!==q[1]?q[1]:[],i=q.length>2&&void 0!==q[2]?q[2]:{},a=i.lngAccessor,o=void 0===a?function(e){return e[0]}:a,s=i.latAccessor,u=void 0===s?function(e){return e[1]}:s,l=i.weightAccessor,c=void 0===l?function(){return 1}:l,h=i.bandwidth,null!==(n=navigator)&&void 0!==n&&n.gpu){e.next=5;break}return console.warn("WebGPU not enabled in browser. Please consider enabling it to improve performance."),e.abrupt("return",t.map((function(e){return AY(e,r,{lngAccessor:o,latAccessor:u,weightAccessor:c,bandwidth:h})})));case 5:return f=4,d=NG,p=IG,A=GG,m=BG,g=FG,y=LG,_=qG,b=VG,x=OG,w=DG,T=UG,S=zG,E=(v=jG)(new IL(new Float32Array(t.flat().map(hY)),2),"vec2",t.length),k=v(new IL(new Float32Array(r.map((function(e){return[hY(o(e)),hY(u(e)),c(e)]})).flat()),3),"vec3",r.length),M=new IL(t.length,1),C=v(M,"float",t.length),R=m(Math.PI),P=_(R.mul(2)),N=function(e){return e.mul(e)},I=function(e){return N(b(e.div(2)))},L=function(e,t){var n=m(e[1]),r=m(t[1]),i=m(e[0]),a=m(t[0]);return m(2).mul(w(_(I(r.sub(n)).add(x(n).mul(x(r)).mul(I(a.sub(i)))))))},D=function(e,t){return T(S(N(e.div(t)).div(2))).div(t.mul(P))},O=A(hY(h)),U=A(hY(h*f)),B=A(r.length),F=d((function(){var e=E.element(g),t=C.element(g);t.assign(0),y(B,(function(n){var r=n.i,i=k.element(r),a=i.z;p(a,(function(){var n=L(i.xy,e.xy);p(n&&n.lessThan(U),(function(){t.addAssign(D(n,O).mul(a))}))}))}))})),z=F().compute(t.length),V=new PG,e.next=25,V.computeAsync(z);case 25:return e.t0=Array,e.t1=Float32Array,e.next=29,V.getArrayBufferAsync(M);case 29:return e.t2=e.sent,e.t3=new e.t1(e.t2),e.abrupt("return",e.t0.from.call(e.t0,e.t3));case 32:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),mY=window.THREE?window.THREE:{Mesh:eo,MeshLambertMaterial:gu,SphereGeometry:uu},gY=function(e){var t=Ah(function(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-14825.05*e)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+707.56*e)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-6838.66*e)))))))+")"}(e));return t.opacity=Math.cbrt(e),t.formatRgb()},yY=_c({props:{heatmapsData:{default:[]},heatmapPoints:{default:function(e){return e}},heatmapPointLat:{default:function(e){return e[0]}},heatmapPointLng:{default:function(e){return e[1]}},heatmapPointWeight:{default:1},heatmapBandwidth:{default:2.5},heatmapColorFn:{default:function(){return gY}},heatmapColorSaturation:{default:1.5},heatmapBaseAltitude:{default:.01},heatmapTopAltitude:{},heatmapsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,t,n){var r=n.tweenGroup;kQ(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new QQ(e,{objBindAttr:"__threeObjHeatmap"}).onCreateObj((function(){var e=new mY.Mesh(new mY.SphereGeometry(CQ),tY(new mY.MeshLambertMaterial({vertexColors:!0,transparent:!0}),eY));return e.__globeObjType="heatmap",e}))},update:function(e){var t=lA(e.heatmapPoints),n=lA(e.heatmapPointLat),r=lA(e.heatmapPointLng),i=lA(e.heatmapPointWeight),a=lA(e.heatmapBandwidth),o=lA(e.heatmapColorFn),s=lA(e.heatmapColorSaturation),u=lA(e.heatmapBaseAltitude),l=lA(e.heatmapTopAltitude);e.dataMapper.onUpdateObj((function(c,h){var f=a(h),d=o(h),p=s(h),A=u(h),v=l(h),m=t(h).map((function(e){var t=n(e),a=r(e),o=PQ(t,a);return{x:o.x,y:o.y,z:o.z,lat:t,lng:a,weight:i(e)}})),g=Math.max(.1,f/3.5),y=Math.ceil(360/(g||-1));c.geometry.parameters.widthSegments!==y&&(c.geometry.dispose(),c.geometry=new mY.SphereGeometry(CQ,y,y/2));var _=function(e){for(var t=e.itemSize,n=[],r=0;r<e.count;r++)n.push(e.array.slice(r*t,(r+1)*t));return n}(c.geometry.getAttribute("position")),b=_.map((function(e){var t=yQ(e,3),n=NQ({x:t[0],y:t[1],z:t[2]});return[n.lng,n.lat]}));vY(b,m,{latAccessor:function(e){return e.lat},lngAccessor:function(e){return e.lng},weightAccessor:function(e){return e.weight},bandwidth:f}).then((function(t){var n=xQ(new Array(100)).map((function(e,t){return qQ(d(t/99))})),r=function(e){var t=c.__currentTargetD=e,r=t.kdeVals,i=t.topAlt,a=t.saturation,o=function(e,t){var n;if(void 0===t){var r,i=k(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;null!=a&&(n<a||void 0===n&&a>=a)&&(n=a)}}catch(c){i.e(c)}finally{i.f()}}else{var o,s=-1,u=k(e);try{for(u.s();!(o=u.n()).done;){var l=o.value;null!=(l=t(l,++s,e))&&(n<l||void 0===n&&l>=l)&&(n=l)}}catch(c){u.e(c)}finally{u.f()}}return n}(r.map(Math.abs))||1e-15,s=ov([0,o/a],n);c.geometry.setAttribute("color",GQ(r.map((function(e){return s(Math.abs(e))})),4));var u=Sf([0,o],[CQ*(1+A),CQ*(1+(i||A))]);c.geometry.setAttribute("r",GQ(r.map(u)))},i={kdeVals:t,topAlt:v,saturation:p},a=c.__currentTargetD||Object.assign({},i,{kdeVals:t.map((function(){return 0})),topAlt:v?A:v,saturation:.5});a.kdeVals.length!==t.length&&(a.kdeVals=t.slice()),Object.keys(i).some((function(e){return a[e]!==i[e]}))&&(!e.heatmapsTransitionDuration||e.heatmapsTransitionDuration<0?r(i):e.tweenGroup.add(new kc(a).to(i,e.heatmapsTransitionDuration).easing(bc.Quadratic.InOut).onUpdate(r).start()))}))})).digest(e.heatmapsData)}}),_Y=window.THREE?window.THREE:{DoubleSide:2,Group:go,LineBasicMaterial:Do,LineSegments:Xo,Mesh:eo,MeshBasicMaterial:xa},bY=_c({props:{polygonsData:{default:[]},polygonGeoJsonGeometry:{default:"geometry"},polygonSideColor:{default:function(){return"#ffffaa"}},polygonSideMaterial:{},polygonCapColor:{default:function(){return"#ffffaa"}},polygonCapMaterial:{},polygonStrokeColor:{},polygonAltitude:{default:.01},polygonCapCurvatureResolution:{default:5},polygonsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,n){var r=n.tweenGroup;kQ(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new QQ(e,{objBindAttr:"__threeObjPolygon"}).id((function(e){return e.id})).onCreateObj((function(){var e=new _Y.Group;return e.__defaultSideMaterial=tY(new _Y.MeshBasicMaterial({side:_Y.DoubleSide,depthWrite:!0}),$Q),e.__defaultCapMaterial=new _Y.MeshBasicMaterial({side:_Y.DoubleSide,depthWrite:!0}),e.add(new _Y.Mesh(void 0,[e.__defaultSideMaterial,e.__defaultCapMaterial])),e.add(new _Y.LineSegments(void 0,new _Y.LineBasicMaterial)),e.__globeObjType="polygon",e}))},update:function(e){var t=lA(e.polygonGeoJsonGeometry),n=lA(e.polygonAltitude),r=lA(e.polygonCapCurvatureResolution),i=lA(e.polygonCapColor),a=lA(e.polygonCapMaterial),o=lA(e.polygonSideColor),s=lA(e.polygonSideMaterial),u=lA(e.polygonStrokeColor),l=[];e.polygonsData.forEach((function(e){var c={data:e,capColor:i(e),capMaterial:a(e),sideColor:o(e),sideMaterial:s(e),strokeColor:u(e),altitude:+n(e),capCurvatureResolution:+r(e)},h=t(e),f=e.__id||"".concat(Math.round(1e9*Math.random()));e.__id=f,"Polygon"===h.type?l.push(vQ({id:"".concat(f,"_0"),coords:h.coordinates},c)):"MultiPolygon"===h.type?l.push.apply(l,xQ(h.coordinates.map((function(e,t){return vQ({id:"".concat(f,"_").concat(t),coords:e},c)})))):console.warn("Unsupported GeoJson geometry type: ".concat(h.type,". Skipping geometry..."))})),e.dataMapper.onUpdateObj((function(t,n){var r=n.coords,i=n.capColor,a=n.capMaterial,o=n.sideColor,s=n.sideMaterial,u=n.strokeColor,l=n.altitude,c=n.capCurvatureResolution,h=yQ(t.children,2),f=h[0],d=h[1],p=!!u;d.visible=p;var A=!(!i&&!a),v=!(!o&&!s);(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return function(e,t){return e===t}};return Object.entries(t).every((function(t){var r=yQ(t,2),i=r[0],a=r[1];return e.hasOwnProperty(i)&&n(i)(e[i],a)}))})(f.geometry.parameters||{},{polygonGeoJson:r,curvatureResolution:c,closedTop:A,includeSides:v})||(f.geometry&&f.geometry.dispose(),f.geometry=new Vy(r,0,CQ,!1,A,v,c)),!p||d.geometry.parameters&&d.geometry.parameters.geoJson.coordinates===r&&d.geometry.parameters.resolution===c||(d.geometry&&d.geometry.dispose(),d.geometry=new qp({type:"Polygon",coordinates:r},CQ,c));var m=v?0:-1,g=A?v?1:0:-1;if(m>=0&&(f.material[m]=s||t.__defaultSideMaterial),g>=0&&(f.material[g]=a||t.__defaultCapMaterial),[[!s&&o,m],[!a&&i,g]].forEach((function(e){var t=yQ(e,2),n=t[0],r=t[1];if(n&&!(r<0)){var i=f.material[r],a=VQ(n);i.color.set(zQ(n)),i.transparent=a<1,i.opacity=a}})),p){var y=d.material,_=VQ(u);y.color.set(zQ(u)),y.transparent=_<1,y.opacity=_}var b={alt:l},x=function(e){var n=(t.__currentTargetD=e).alt;f.scale.x=f.scale.y=f.scale.z=1+n,p&&(d.scale.x=d.scale.y=d.scale.z=1+n+1e-4),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};if(e.userData.shader)t(e.userData.shader.uniforms);else{var n=e.onBeforeCompile;e.onBeforeCompile=function(e){n(e),t(e.uniforms)}}}(t.__defaultSideMaterial,(function(e){return e.surfaceRadius.value=CQ/(n+1)}))},w=t.__currentTargetD||Object.assign({},b,{alt:-.001});Object.keys(b).some((function(e){return w[e]!==b[e]}))&&(!e.polygonsTransitionDuration||e.polygonsTransitionDuration<0||w.alt===b.alt?x(b):e.tweenGroup.add(new kc(w).to(b,e.polygonsTransitionDuration).easing(bc.Quadratic.InOut).onUpdate(x).start()))})).digest(l)}});var xY=window.THREE?window.THREE:{BufferGeometry:qa,DoubleSide:2,Mesh:eo,MeshLambertMaterial:gu,Vector3:Kr},wY=Object.assign({},e),TY=wY.BufferGeometryUtils||wY,SY=_c({props:{hexPolygonsData:{default:[]},hexPolygonGeoJsonGeometry:{default:"geometry"},hexPolygonColor:{default:function(){return"#ffffaa"}},hexPolygonAltitude:{default:.001},hexPolygonResolution:{default:3},hexPolygonMargin:{default:.2},hexPolygonUseDots:{default:!1},hexPolygonCurvatureResolution:{default:5},hexPolygonDotResolution:{default:12},hexPolygonsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,t,n){var r=n.tweenGroup;kQ(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new QQ(e,{objBindAttr:"__threeObjHexPolygon"}).onCreateObj((function(){var e=new xY.Mesh(void 0,new xY.MeshLambertMaterial({side:xY.DoubleSide}));return e.__globeObjType="hexPolygon",e}))},update:function(e){var t=lA(e.hexPolygonGeoJsonGeometry),n=lA(e.hexPolygonColor),r=lA(e.hexPolygonAltitude),i=lA(e.hexPolygonResolution),a=lA(e.hexPolygonMargin),o=lA(e.hexPolygonUseDots),s=lA(e.hexPolygonCurvatureResolution),u=lA(e.hexPolygonDotResolution);e.dataMapper.onUpdateObj((function(l,c){var h=t(c),f=i(c),d=r(c),p=Math.max(0,Math.min(1,+a(c))),A=o(c),v=s(c),m=u(c),g=n(c),y=VQ(g);l.material.color.set(zQ(g)),l.material.transparent=y<1,l.material.opacity=y;var _={alt:d,margin:p,curvatureResolution:v},b={geoJson:h,h3Res:f},x=l.__currentTargetD||Object.assign({},_,{alt:-.001}),w=l.__currentMemD||b;if(Object.keys(_).some((function(e){return x[e]!==_[e]}))||Object.keys(b).some((function(e){return w[e]!==b[e]}))){l.__currentMemD=b;var T=[];"Polygon"===h.type?R_(h.coordinates,f,!0).forEach((function(e){return T.push(e)})):"MultiPolygon"===h.type?h.coordinates.forEach((function(e){return R_(e,f,!0).forEach((function(e){return T.push(e)}))})):console.warn("Unsupported GeoJson geometry type: ".concat(h.type,". Skipping geometry..."));var S=T.map((function(e){var t=M_(e),n=C_(e,!0).reverse(),r=t[1];return n.forEach((function(e){var t=e[0];Math.abs(r-t)>170&&(e[0]+=r>t?360:-360)})),{h3Idx:e,hexCenter:t,hexGeoJson:n}})),E=function(e){var t=l.__currentTargetD=e,n=t.alt,r=t.margin,i=t.curvatureResolution;l.geometry&&l.geometry.dispose(),l.geometry=S.length?(TY.mergeGeometries||TY.mergeBufferGeometries)(S.map((function(e){var t=yQ(e.hexCenter,2),a=t[0],o=t[1];if(A){var s=PQ(a,o,n),u=PQ(e.hexGeoJson[0][1],e.hexGeoJson[0][0],n),l=.85*(1-r)*new xY.Vector3(s.x,s.y,s.z).distanceTo(new xY.Vector3(u.x,u.y,u.z)),c=new Ss(l,m);return c.rotateX(IQ(-a)),c.rotateY(IQ(o)),c.translate(s.x,s.y,s.z),c}var h=0===r?e.hexGeoJson:e.hexGeoJson.map((function(e){var t=yQ(e,2),n=t[0],i=t[1];return[[n,o],[i,a]].map((function(e){var t=yQ(e,2);return function(e,t,n){return e-(e-t)*n}(t[0],t[1],r)}))}));return new Vy([h],CQ,CQ*(1+n),!1,!0,!1,i)}))):new xY.BufferGeometry};!e.hexPolygonsTransitionDuration||e.hexPolygonsTransitionDuration<0?E(_):e.tweenGroup.add(new kc(x).to(_,e.hexPolygonsTransitionDuration).easing(bc.Quadratic.InOut).onUpdate(E).start())}})).digest(e.hexPolygonsData)}}),EY=window.THREE?window.THREE:{Vector3:Kr};function kY(e,t){var n=Math.max(e.length,t.length),r=Vh.apply(void 0,xQ([e,t].map((function(e){return e.map((function(e){return[e.x,e.y,e.z]}))})).map((function(e){return function(e,t){var n=e[e.length-1];return[].concat(xQ(e),xQ(Array(t-e.length).fill(n)))}(e,n)}))));return function(n){return 0===n?e:1===n?t:r(n).map((function(e){var t=yQ(e,3),n=t[0],r=t[1],i=t[2];return new EY.Vector3(n,r,i)}))}}var MY=window.THREE?window.THREE:{BufferGeometry:qa,Color:ga,Group:go,Line:jo,NormalBlending:1,ShaderMaterial:so,Vector3:Kr},CY=av.default||av,RY=_c({props:{pathsData:{default:[]},pathPoints:{default:function(e){return e}},pathPointLat:{default:function(e){return e[0]}},pathPointLng:{default:function(e){return e[1]}},pathPointAlt:{default:.001},pathResolution:{default:2},pathColor:{default:function(){return"#ffffaa"}},pathStroke:{},pathDashLength:{default:1},pathDashGap:{default:0},pathDashInitialGap:{default:0},pathDashAnimateTime:{default:0},pathTransitionDuration:{default:1e3,triggerUpdate:!1},rendererSize:{}},methods:{pauseAnimation:function(e){var t;null===(t=e.ticker)||void 0===t||t.pause()},resumeAnimation:function(e){var t;null===(t=e.ticker)||void 0===t||t.resume()},_destructor:function(e){var t;null===(t=e.ticker)||void 0===t||t.dispose()}},stateInit:function(e){return{tweenGroup:e.tweenGroup,ticker:new CY,sharedMaterial:new MY.ShaderMaterial(vQ(vQ({},{uniforms:{dashOffset:{value:0},dashSize:{value:1},gapSize:{value:0},dashTranslate:{value:0}},vertexShader:"\n    uniform float dashTranslate; \n\n    attribute vec4 color;\n    varying vec4 vColor;\n    \n    attribute float relDistance;\n    varying float vRelDistance;\n\n    void main() {\n      // pass through colors and distances\n      vColor = color;\n      vRelDistance = relDistance + dashTranslate;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  ",fragmentShader:"\n    uniform float dashOffset; \n    uniform float dashSize;\n    uniform float gapSize; \n    \n    varying vec4 vColor;\n    varying float vRelDistance;\n    \n    void main() {\n      // ignore pixels in the gap\n      if (vRelDistance < dashOffset) discard;\n      if (mod(vRelDistance - dashOffset, dashSize + gapSize) > dashSize) discard;\n    \n      // set px color: [r, g, b, a], interpolated between vertices \n      gl_FragColor = vColor; \n    }\n  "}),{},{transparent:!0,blending:MY.NormalBlending}))}},init:function(e,t){kQ(e),t.scene=e,t.dataMapper=new QQ(e,{objBindAttr:"__threeObjPath"}).onCreateObj((function(){var e=new MY.Group;return e.__globeObjType="path",e})),t.ticker.onTick.add((function(e,n){t.dataMapper.entries().map((function(e){return yQ(e,2)[1]})).filter((function(e){return e.children.length&&e.children[0].material&&e.children[0].__dashAnimateStep})).forEach((function(e){var t=e.children[0],r=t.__dashAnimateStep*n;if("Line"===t.type){var i=t.material.uniforms.dashTranslate.value%1e9;t.material.uniforms.dashTranslate.value=i+r}else if("Line2"===t.type){for(var a=t.material.dashOffset-r,o=t.material.dashSize+t.material.gapSize;a<=-o;)a+=o;t.material.dashOffset=a}}))}))},update:function(e){var t=lA(e.pathPoints),n=lA(e.pathPointLat),r=lA(e.pathPointLng),i=lA(e.pathPointAlt),a=lA(e.pathStroke),o=lA(e.pathColor),s=lA(e.pathDashLength),u=lA(e.pathDashGap),l=lA(e.pathDashInitialGap),c=lA(e.pathDashAnimateTime);function h(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=t+1;if(e instanceof Array||e instanceof Function){var o=e instanceof Array?Sf().domain(e.map((function(t,n){return n/(e.length-1)}))).range(e):e;n=function(e){return qQ(o(e),i,!0)}}else{var s=qQ(e,i,!0);n=function(){return s}}for(var u=[],l=0,c=a;l<c;l++)for(var h=n(l/(c-1)),f=0;f<r;f++)u.push(h);return GQ(u,i?4:3)}e.dataMapper.onUpdateObj((function(f,d){var p=a(d),A=null!==p&&void 0!==p;if(!f.children.length||A===("Line"===f.children[0].type)){kQ(f);var v=A?new YX(new QX,new NX):new MY.Line(new MY.BufferGeometry,e.sharedMaterial.clone());f.add(v)}var m=f.children[0],g=function(e,t,n,r,i){var a=function(e,t,n){for(var r=[],i=1;i<=n;i++)r.push(e+(t-e)*i/(n+1));return r},o=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=[],n=null;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(r){if(n){for(;Math.abs(n[1]-r[1])>180;)n[1]+=360*(n[1]<r[1]?1:-1);var i=Math.sqrt(Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2));if(i>e)for(var o=Math.floor(i/e),s=a(n[0],r[0],o),u=a(n[1],r[1],o),l=a(n[2],r[2],o),c=0,h=s.length;c<h;c++)t.push([s[c],u[c],l[c]])}t.push(n=r)})),t},s=function(e){var t=yQ(e,3),n=PQ(t[0],t[1],t[2]),r=n.x,i=n.y,a=n.z;return new MY.Vector3(r,i,a)};return o(e.map((function(e){return[t(e),n(e),r(e)]})),i).map(s)}(t(d),n,r,i,e.pathResolution),y=c(d);if(m.__dashAnimateStep=y>0?1e3/y:0,A){m.material.resolution=e.rendererSize;var _=s(d),b=u(d),x=l(d);m.material.dashed=b>0,m.material.dashed?m.material.defines.USE_DASH="":delete m.material.defines.USE_DASH,m.material.dashed&&(m.material.dashScale=1/function(e){var t,n=0;return e.forEach((function(e){t&&(n+=t.distanceTo(e)),t=e})),n}(g),m.material.dashSize=_,m.material.gapSize=b,m.material.dashOffset=-x);var w=o(d);if(w instanceof Array){var T=h(o(d),g.length-1,1,!1);m.geometry.setColors(T.array),m.material.vertexColors=!0}else{var S=w,E=VQ(S);m.material.color=new MY.Color(zQ(S)),m.material.transparent=E<1,m.material.opacity=E,m.material.vertexColors=!1}m.material.needsUpdate=!0}else{Object.assign(m.material.uniforms,{dashSize:{value:s(d)},gapSize:{value:u(d)},dashOffset:{value:l(d)}});var k=h(o(d),g.length),M=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[],i=0,a=e+1;i<a;i++)for(var o=i/(a-1),s=0;s<t;s++)r.push(o);return n&&r.reverse(),GQ(r,1)}(g.length,1,!0);m.geometry.setAttribute("color",k),m.geometry.setAttribute("relDistance",M)}var C=kY(f.__currentTargetD&&f.__currentTargetD.points||[g[0]],g),R=function(e){var t,n=f.__currentTargetD=e,r=n.stroke,i=n.interpolK,a=f.__currentTargetD.points=C(i);A?(m.geometry.setPositions((t=[]).concat.apply(t,xQ(a.map((function(e){return[e.x,e.y,e.z]}))))),m.material.linewidth=r,m.material.dashed&&m.computeLineDistances()):(m.geometry.setFromPoints(a),m.geometry.computeBoundingSphere())},P={stroke:p,interpolK:1},N=Object.assign({},f.__currentTargetD||P,{interpolK:0});Object.keys(P).some((function(e){return N[e]!==P[e]}))&&(!e.pathTransitionDuration||e.pathTransitionDuration<0?R(P):e.tweenGroup.add(new kc(N).to(P,e.pathTransitionDuration).easing(bc.Quadratic.InOut).onUpdate(R).start()))})).digest(e.pathsData)}}),PY=window.THREE?window.THREE:{Euler:Oi,Mesh:eo,MeshLambertMaterial:gu,SphereGeometry:uu},NY=_c({props:{tilesData:{default:[]},tileLat:{default:"lat"},tileLng:{default:"lng"},tileAltitude:{default:.01},tileWidth:{default:1},tileHeight:{default:1},tileUseGlobeProjection:{default:!0},tileMaterial:{default:function(){return new PY.MeshLambertMaterial({color:"#ffbb88",opacity:.4,transparent:!0})}},tileCurvatureResolution:{default:5},tilesTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,n){var r=n.tweenGroup;kQ(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new QQ(e,{objBindAttr:"__threeObjTile"}).onCreateObj((function(){var e=new PY.Mesh;return e.__globeObjType="tile",e}))},update:function(e){var t=lA(e.tileLat),n=lA(e.tileLng),r=lA(e.tileAltitude),i=lA(e.tileWidth),a=lA(e.tileHeight),o=lA(e.tileUseGlobeProjection),s=lA(e.tileMaterial),u=lA(e.tileCurvatureResolution);e.dataMapper.onUpdateObj((function(l,c){l.material=s(c);var h=o(c),f=u(c),d=function(e){var t=l.__currentTargetD=e,n=t.lat,r=t.lng,i=t.alt,a=t.width,o=t.height,s=IY(r),u=IY(-n);l.geometry&&l.geometry.dispose(),l.geometry=new PY.SphereGeometry(CQ*(1+i),Math.ceil(a/(f||-1)),Math.ceil(o/(f||-1)),IY(90-a/2)+(h?s:0),IY(a),IY(90-o/2)+(h?u:0),IY(o)),h||l.setRotationFromEuler(new PY.Euler(u,s,0,"YXZ"))},p={lat:+t(c),lng:+n(c),alt:+r(c),width:+i(c),height:+a(c)},A=l.__currentTargetD||Object.assign({},p,{width:0,height:0});Object.keys(p).some((function(e){return A[e]!==p[e]}))&&(!e.tilesTransitionDuration||e.tilesTransitionDuration<0?d(p):e.tweenGroup.add(new kc(A).to(p,e.tilesTransitionDuration).easing(bc.Quadratic.InOut).onUpdate(d).start()))})).digest(e.tilesData)}}),IY=function(e){return e*Math.PI/180},LY=window.THREE?window.THREE:{BufferGeometry:qa,Color:ga,Points:$o,PointsMaterial:Qo},DY=_c({props:{particlesData:{default:[]},particlesList:{default:function(e){return e}},particleLat:{default:"lat"},particleLng:{default:"lng"},particleAltitude:{default:.01},particlesSize:{default:.5},particlesSizeAttenuation:{default:!0},particlesColor:{default:function(){return"white"}},particlesTexture:{}},init:function(e,t){kQ(e),t.scene=e,t.dataMapper=new QQ(e,{objBindAttr:"__threeObjParticles"}).onCreateObj((function(){var e=new LY.Points(new LY.BufferGeometry,new LY.PointsMaterial);return e.__globeObjType="particles",e})).onUpdateObj((function(e,n){var r=lA(t.particlesList),i=lA(t.particleLat),a=lA(t.particleLng),o=lA(t.particleAltitude);e.geometry.setAttribute("position",GQ(r(n).map((function(e){return Object.values(PQ(i(e),a(e),o(e)))})),3))}))},update:function(e,t){["particlesData","particlesList","particleLat","particleLng","particleAltitude"].some((function(e){return t.hasOwnProperty(e)}))&&e.dataMapper.digest(e.particlesData);var n=lA(e.particlesColor),r=lA(e.particlesSize),i=lA(e.particlesSizeAttenuation),a=lA(e.particlesTexture);e.dataMapper.entries().forEach((function(t){var o=yQ(t,2),s=o[0],u=o[1];if(u.material.size=r(s),u.material.sizeAttenuation=i(s),e.particlesTexture)u.material.color=new LY.Color(16777215),u.material.transparent=!1,u.material.alphaTest=.5,u.material.map=a(s);else{var l=n(s),c=VQ(l);u.material.color=new LY.Color(zQ(l)),u.material.transparent=c<1,u.material.opacity=c,u.material.alphaTest=0}}))}}),OY=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32;iQ(this,t),(e=rQ(this,t)).type="CircleLineGeometry",e.parameters={radius:n,segmentCount:r};for(var i=[],a=0;a<=r;a++){var o=(a/r-.25)*Math.PI*2;i.push({x:Math.cos(o)*n,y:Math.sin(o)*n,z:0})}return e.setFromPoints(i),e}return dQ(t,e),lQ(t)}((window.THREE?window.THREE:{BufferGeometry:qa}).BufferGeometry),UY=window.THREE?window.THREE:{Color:ga,Group:go,Line:jo,LineBasicMaterial:Do,Vector3:Kr},BY=av.default||av,FY=_c({props:{ringsData:{default:[]},ringLat:{default:"lat"},ringLng:{default:"lng"},ringAltitude:{default:.0015},ringColor:{default:function(){return"#ffffaa"},triggerUpdate:!1},ringResolution:{default:64,triggerUpdate:!1},ringMaxRadius:{default:2,triggerUpdate:!1},ringPropagationSpeed:{default:1,triggerUpdate:!1},ringRepeatPeriod:{default:700,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var t;null===(t=e.ticker)||void 0===t||t.pause()},resumeAnimation:function(e){var t;null===(t=e.ticker)||void 0===t||t.resume()},_destructor:function(e){var t;null===(t=e.ticker)||void 0===t||t.dispose()}},init:function(e,t,n){var r=n.tweenGroup;kQ(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new QQ(e,{objBindAttr:"__threeObjRing",removeDelay:3e4}).onCreateObj((function(){var e=new UY.Group;return e.__globeObjType="ring",e})),t.ticker=new BY,t.ticker.onTick.add((function(e){if(t.ringsData.length){var n=lA(t.ringColor),r=lA(t.ringAltitude),i=lA(t.ringMaxRadius),a=lA(t.ringPropagationSpeed),o=lA(t.ringRepeatPeriod);t.dataMapper.entries().filter((function(e){return yQ(e,2)[1]})).forEach((function(s){var u,l,c=yQ(s,2),h=c[0],f=c[1];if((f.__nextRingTime||0)<=e){var d=o(h)/1e3;f.__nextRingTime=e+(d<=0?1/0:d);var p,A=new UY.Line(new OY(1,t.ringResolution),new UY.LineBasicMaterial),v=n(h),m=v instanceof Array||v instanceof Function;m?v instanceof Array?(p=Sf().domain(v.map((function(e,t){return t/(v.length-1)}))).range(v),A.material.transparent=v.some((function(e){return VQ(e)<1}))):(p=v,A.material.transparent=!0):(A.material.color=new UY.Color(zQ(v)),u=A.material,l=VQ(v),u.opacity=l,u.transparent=l<1,u.depthWrite=l>=1);var g=CQ*(1+r(h)),y=i(h),_=y*Math.PI/180,b=a(h),x=b<=0,w=function(e){var t=e.t,n=(x?1-t:t)*_;if(A.scale.x=A.scale.y=g*Math.sin(n),A.position.z=g*(1-Math.cos(n)),m){var r=p(t);A.material.color=new UY.Color(zQ(r)),A.material.transparent&&(A.material.opacity=VQ(r))}};if(0===b)w({t:0}),f.add(A);else{var T=1e3*Math.abs(y/b);t.tweenGroup.add(new kc({t:0}).to({t:1},T).onUpdate(w).onStart((function(){return f.add(A)})).onComplete((function(){f.remove(A),EQ(A)})).start())}}}))}}))},update:function(e){var t=lA(e.ringLat),n=lA(e.ringLng),r=lA(e.ringAltitude),i=e.scene.localToWorld(new UY.Vector3(0,0,0));e.dataMapper.onUpdateObj((function(e,a){var o=t(a),s=n(a),u=r(a);Object.assign(e.position,PQ(o,s,u)),e.lookAt(i)})).digest(e.ringsData)}}),zY={glyphs:{0:{x_min:73,x_max:715,ha:792,o:"m 394 -29 q 153 129 242 -29 q 73 479 73 272 q 152 829 73 687 q 394 989 241 989 q 634 829 545 989 q 715 479 715 684 q 635 129 715 270 q 394 -29 546 -29 m 394 89 q 546 211 489 89 q 598 479 598 322 q 548 748 598 640 q 394 871 491 871 q 241 748 298 871 q 190 479 190 637 q 239 211 190 319 q 394 89 296 89 "},1:{x_min:215.671875,x_max:574,ha:792,o:"m 574 0 l 442 0 l 442 697 l 215 697 l 215 796 q 386 833 330 796 q 475 986 447 875 l 574 986 l 574 0 "},2:{x_min:59,x_max:731,ha:792,o:"m 731 0 l 59 0 q 197 314 59 188 q 457 487 199 315 q 598 691 598 580 q 543 819 598 772 q 411 867 488 867 q 272 811 328 867 q 209 630 209 747 l 81 630 q 182 901 81 805 q 408 986 271 986 q 629 909 536 986 q 731 694 731 826 q 613 449 731 541 q 378 316 495 383 q 201 122 235 234 l 731 122 l 731 0 "},3:{x_min:54,x_max:737,ha:792,o:"m 737 284 q 635 55 737 141 q 399 -25 541 -25 q 156 52 248 -25 q 54 308 54 140 l 185 308 q 245 147 185 202 q 395 96 302 96 q 539 140 484 96 q 602 280 602 190 q 510 429 602 390 q 324 454 451 454 l 324 565 q 487 584 441 565 q 565 719 565 617 q 515 835 565 791 q 395 879 466 879 q 255 824 307 879 q 203 661 203 769 l 78 661 q 166 909 78 822 q 387 992 250 992 q 603 921 513 992 q 701 723 701 844 q 669 607 701 656 q 578 524 637 558 q 696 434 655 499 q 737 284 737 369 "},4:{x_min:48,x_max:742.453125,ha:792,o:"m 742 243 l 602 243 l 602 0 l 476 0 l 476 243 l 48 243 l 48 368 l 476 958 l 602 958 l 602 354 l 742 354 l 742 243 m 476 354 l 476 792 l 162 354 l 476 354 "},5:{x_min:54.171875,x_max:738,ha:792,o:"m 738 314 q 626 60 738 153 q 382 -23 526 -23 q 155 47 248 -23 q 54 256 54 125 l 183 256 q 259 132 204 174 q 382 91 314 91 q 533 149 471 91 q 602 314 602 213 q 538 469 602 411 q 386 528 475 528 q 284 506 332 528 q 197 439 237 484 l 81 439 l 159 958 l 684 958 l 684 840 l 254 840 l 214 579 q 306 627 258 612 q 407 643 354 643 q 636 552 540 643 q 738 314 738 457 "},6:{x_min:53,x_max:739,ha:792,o:"m 739 312 q 633 62 739 162 q 400 -31 534 -31 q 162 78 257 -31 q 53 439 53 206 q 178 859 53 712 q 441 986 284 986 q 643 912 559 986 q 732 713 732 833 l 601 713 q 544 830 594 786 q 426 875 494 875 q 268 793 331 875 q 193 517 193 697 q 301 597 240 570 q 427 624 362 624 q 643 540 552 624 q 739 312 739 451 m 603 298 q 540 461 603 400 q 404 516 484 516 q 268 461 323 516 q 207 300 207 401 q 269 137 207 198 q 405 83 325 83 q 541 137 486 83 q 603 298 603 197 "},7:{x_min:58.71875,x_max:730.953125,ha:792,o:"m 730 839 q 469 448 560 641 q 335 0 378 255 l 192 0 q 328 441 235 252 q 593 830 421 630 l 58 830 l 58 958 l 730 958 l 730 839 "},8:{x_min:55,x_max:736,ha:792,o:"m 571 527 q 694 424 652 491 q 736 280 736 358 q 648 71 736 158 q 395 -26 551 -26 q 142 69 238 -26 q 55 279 55 157 q 96 425 55 359 q 220 527 138 491 q 120 615 153 562 q 88 726 88 668 q 171 904 88 827 q 395 986 261 986 q 618 905 529 986 q 702 727 702 830 q 670 616 702 667 q 571 527 638 565 m 394 565 q 519 610 475 565 q 563 717 563 655 q 521 823 563 781 q 392 872 474 872 q 265 824 312 872 q 224 720 224 783 q 265 613 224 656 q 394 565 312 565 m 395 91 q 545 150 488 91 q 597 280 597 204 q 546 408 597 355 q 395 465 492 465 q 244 408 299 465 q 194 280 194 356 q 244 150 194 203 q 395 91 299 91 "},9:{x_min:53,x_max:739,ha:792,o:"m 739 524 q 619 94 739 241 q 362 -32 516 -32 q 150 47 242 -32 q 59 244 59 126 l 191 244 q 246 129 191 176 q 373 82 301 82 q 526 161 466 82 q 597 440 597 255 q 363 334 501 334 q 130 432 216 334 q 53 650 53 521 q 134 880 53 786 q 383 986 226 986 q 659 841 566 986 q 739 524 739 719 m 388 449 q 535 514 480 449 q 585 658 585 573 q 535 805 585 744 q 388 873 480 873 q 242 809 294 873 q 191 658 191 745 q 239 514 191 572 q 388 449 292 449 "},"\u03bf":{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 96 88 192 -25 q 0 368 0 201 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 "},S:{x_min:0,x_max:788,ha:890,o:"m 788 291 q 662 54 788 144 q 397 -26 550 -26 q 116 68 226 -26 q 0 337 0 168 l 131 337 q 200 152 131 220 q 384 85 269 85 q 557 129 479 85 q 650 270 650 183 q 490 429 650 379 q 194 513 341 470 q 33 739 33 584 q 142 964 33 881 q 388 1041 242 1041 q 644 957 543 1041 q 756 716 756 867 l 625 716 q 561 874 625 816 q 395 933 497 933 q 243 891 309 933 q 164 759 164 841 q 325 609 164 656 q 625 526 475 568 q 788 291 788 454 "},"\xa6":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"/":{x_min:183.25,x_max:608.328125,ha:792,o:"m 608 1041 l 266 -129 l 183 -129 l 520 1041 l 608 1041 "},"\u03a4":{x_min:-.4375,x_max:777.453125,ha:839,o:"m 777 893 l 458 893 l 458 0 l 319 0 l 319 892 l 0 892 l 0 1013 l 777 1013 l 777 893 "},y:{x_min:0,x_max:684.78125,ha:771,o:"m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "},"\u03a0":{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 803 1012 l 803 0 "},"\u0390":{x_min:-111,x_max:339,ha:361,o:"m 339 800 l 229 800 l 229 925 l 339 925 l 339 800 m -1 800 l -111 800 l -111 925 l -1 925 l -1 800 m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 m 302 1040 l 113 819 l 30 819 l 165 1040 l 302 1040 "},g:{x_min:0,x_max:686,ha:838,o:"m 686 34 q 586 -213 686 -121 q 331 -306 487 -306 q 131 -252 216 -306 q 31 -84 31 -190 l 155 -84 q 228 -174 166 -138 q 345 -207 284 -207 q 514 -109 454 -207 q 564 89 564 -27 q 461 6 521 36 q 335 -23 401 -23 q 88 100 184 -23 q 0 370 0 215 q 87 634 0 522 q 330 758 183 758 q 457 728 398 758 q 564 644 515 699 l 564 737 l 686 737 l 686 34 m 582 367 q 529 560 582 481 q 358 652 468 652 q 189 561 250 652 q 135 369 135 482 q 189 176 135 255 q 361 85 251 85 q 529 176 468 85 q 582 367 582 255 "},"\xb2":{x_min:0,x_max:442,ha:539,o:"m 442 383 l 0 383 q 91 566 0 492 q 260 668 176 617 q 354 798 354 727 q 315 875 354 845 q 227 905 277 905 q 136 869 173 905 q 99 761 99 833 l 14 761 q 82 922 14 864 q 232 974 141 974 q 379 926 316 974 q 442 797 442 878 q 351 635 442 704 q 183 539 321 611 q 92 455 92 491 l 442 455 l 442 383 "},"\u2013":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},"\u039a":{x_min:0,x_max:819.5625,ha:893,o:"m 819 0 l 650 0 l 294 509 l 139 356 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},"\u0192":{x_min:-46.265625,x_max:392,ha:513,o:"m 392 651 l 259 651 l 79 -279 l -46 -278 l 134 651 l 14 651 l 14 751 l 135 751 q 151 948 135 900 q 304 1041 185 1041 q 334 1040 319 1041 q 392 1034 348 1039 l 392 922 q 337 931 360 931 q 271 883 287 931 q 260 793 260 853 l 260 751 l 392 751 l 392 651 "},e:{x_min:0,x_max:714,ha:813,o:"m 714 326 l 140 326 q 200 157 140 227 q 359 87 260 87 q 488 130 431 87 q 561 245 545 174 l 697 245 q 577 48 670 123 q 358 -26 484 -26 q 97 85 195 -26 q 0 363 0 197 q 94 642 0 529 q 358 765 195 765 q 626 627 529 765 q 714 326 714 503 m 576 429 q 507 583 564 522 q 355 650 445 650 q 206 583 266 650 q 140 429 152 522 l 576 429 "},"\u03cc":{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 94 91 194 -25 q 0 368 0 202 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 m 576 1040 l 387 819 l 303 819 l 438 1040 l 576 1040 "},J:{x_min:0,x_max:588,ha:699,o:"m 588 279 q 287 -26 588 -26 q 58 73 126 -26 q 0 327 0 158 l 133 327 q 160 172 133 227 q 288 96 198 96 q 426 171 391 96 q 449 336 449 219 l 449 1013 l 588 1013 l 588 279 "},"\xbb":{x_min:-1,x_max:503,ha:601,o:"m 503 302 l 280 136 l 281 256 l 429 373 l 281 486 l 280 608 l 503 440 l 503 302 m 221 302 l 0 136 l 0 255 l 145 372 l 0 486 l -1 608 l 221 440 l 221 302 "},"\xa9":{x_min:-3,x_max:1008,ha:1106,o:"m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 741 394 q 661 246 731 302 q 496 190 591 190 q 294 285 369 190 q 228 497 228 370 q 295 714 228 625 q 499 813 370 813 q 656 762 588 813 q 733 625 724 711 l 634 625 q 589 704 629 673 q 498 735 550 735 q 377 666 421 735 q 334 504 334 597 q 374 340 334 408 q 490 272 415 272 q 589 304 549 272 q 638 394 628 337 l 741 394 "},"\u03ce":{x_min:0,x_max:922,ha:1030,o:"m 687 1040 l 498 819 l 415 819 l 549 1040 l 687 1040 m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 338 0 202 q 45 551 0 444 q 161 737 84 643 l 302 737 q 175 552 219 647 q 124 336 124 446 q 155 179 124 248 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 341 797 257 q 745 555 797 450 q 619 737 705 637 l 760 737 q 874 551 835 640 q 922 339 922 444 "},"^":{x_min:193.0625,x_max:598.609375,ha:792,o:"m 598 772 l 515 772 l 395 931 l 277 772 l 193 772 l 326 1013 l 462 1013 l 598 772 "},"\xab":{x_min:0,x_max:507.203125,ha:604,o:"m 506 136 l 284 302 l 284 440 l 506 608 l 507 485 l 360 371 l 506 255 l 506 136 m 222 136 l 0 302 l 0 440 l 222 608 l 221 486 l 73 373 l 222 256 l 222 136 "},D:{x_min:0,x_max:828,ha:935,o:"m 389 1013 q 714 867 593 1013 q 828 521 828 729 q 712 161 828 309 q 382 0 587 0 l 0 0 l 0 1013 l 389 1013 m 376 124 q 607 247 523 124 q 681 510 681 355 q 607 771 681 662 q 376 896 522 896 l 139 896 l 139 124 l 376 124 "},"\u2219":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},"\xff":{x_min:0,x_max:47,ha:125,o:"m 47 3 q 37 -7 47 -7 q 28 0 30 -7 q 39 -4 32 -4 q 45 3 45 -1 l 37 0 q 28 9 28 0 q 39 19 28 19 l 47 16 l 47 19 l 47 3 m 37 1 q 44 8 44 1 q 37 16 44 16 q 30 8 30 16 q 37 1 30 1 m 26 1 l 23 22 l 14 0 l 3 22 l 3 3 l 0 25 l 13 1 l 22 25 l 26 1 "},w:{x_min:0,x_max:1009.71875,ha:1100,o:"m 1009 738 l 783 0 l 658 0 l 501 567 l 345 0 l 222 0 l 0 738 l 130 738 l 284 174 l 432 737 l 576 738 l 721 173 l 881 737 l 1009 738 "},$:{x_min:0,x_max:700,ha:793,o:"m 664 717 l 542 717 q 490 825 531 785 q 381 872 450 865 l 381 551 q 620 446 540 522 q 700 241 700 370 q 618 45 700 116 q 381 -25 536 -25 l 381 -152 l 307 -152 l 307 -25 q 81 62 162 -25 q 0 297 0 149 l 124 297 q 169 146 124 204 q 307 81 215 89 l 307 441 q 80 536 148 469 q 13 725 13 603 q 96 910 13 839 q 307 982 180 982 l 307 1077 l 381 1077 l 381 982 q 574 917 494 982 q 664 717 664 845 m 307 565 l 307 872 q 187 831 233 872 q 142 724 142 791 q 180 618 142 656 q 307 565 218 580 m 381 76 q 562 237 562 96 q 517 361 562 313 q 381 423 472 409 l 381 76 "},"\\":{x_min:-.015625,x_max:425.0625,ha:522,o:"m 425 -129 l 337 -129 l 0 1041 l 83 1041 l 425 -129 "},"\xb5":{x_min:0,x_max:697.21875,ha:747,o:"m 697 -4 q 629 -14 658 -14 q 498 97 513 -14 q 422 9 470 41 q 313 -23 374 -23 q 207 4 258 -23 q 119 81 156 32 l 119 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 173 124 246 q 308 83 216 83 q 452 178 402 83 q 493 359 493 255 l 493 738 l 617 738 l 617 214 q 623 136 617 160 q 673 92 637 92 q 697 96 684 92 l 697 -4 "},"\u0399":{x_min:42,x_max:181,ha:297,o:"m 181 0 l 42 0 l 42 1013 l 181 1013 l 181 0 "},"\u038e":{x_min:0,x_max:1144.5,ha:1214,o:"m 1144 1012 l 807 416 l 807 0 l 667 0 l 667 416 l 325 1012 l 465 1012 l 736 533 l 1004 1012 l 1144 1012 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u2019":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},"\u039d":{x_min:0,x_max:801,ha:915,o:"m 801 0 l 651 0 l 131 822 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 191 l 670 1013 l 801 1013 l 801 0 "},"-":{x_min:8.71875,x_max:350.390625,ha:478,o:"m 350 317 l 8 317 l 8 428 l 350 428 l 350 317 "},Q:{x_min:0,x_max:968,ha:1072,o:"m 954 5 l 887 -79 l 744 35 q 622 -11 687 2 q 483 -26 556 -26 q 127 130 262 -26 q 0 504 0 279 q 127 880 0 728 q 484 1041 262 1041 q 841 884 708 1041 q 968 507 968 735 q 933 293 968 398 q 832 104 899 188 l 954 5 m 723 191 q 802 330 777 248 q 828 499 828 412 q 744 790 828 673 q 483 922 650 922 q 228 791 322 922 q 142 505 142 673 q 227 221 142 337 q 487 91 323 91 q 632 123 566 91 l 520 215 l 587 301 l 723 191 "},"\u03c2":{x_min:1,x_max:676.28125,ha:740,o:"m 676 460 l 551 460 q 498 595 542 546 q 365 651 448 651 q 199 578 263 651 q 136 401 136 505 q 266 178 136 241 q 508 106 387 142 q 640 -50 640 62 q 625 -158 640 -105 q 583 -278 611 -211 l 465 -278 q 498 -182 490 -211 q 515 -80 515 -126 q 381 12 515 -15 q 134 91 197 51 q 1 388 1 179 q 100 651 1 542 q 354 761 199 761 q 587 680 498 761 q 676 460 676 599 "},M:{x_min:0,x_max:954,ha:1067,o:"m 954 0 l 819 0 l 819 869 l 537 0 l 405 0 l 128 866 l 128 0 l 0 0 l 0 1013 l 200 1013 l 472 160 l 757 1013 l 954 1013 l 954 0 "},"\u03a8":{x_min:0,x_max:1006,ha:1094,o:"m 1006 678 q 914 319 1006 429 q 571 200 814 200 l 571 0 l 433 0 l 433 200 q 92 319 194 200 q 0 678 0 429 l 0 1013 l 139 1013 l 139 679 q 191 417 139 492 q 433 326 255 326 l 433 1013 l 571 1013 l 571 326 l 580 326 q 813 423 747 326 q 868 679 868 502 l 868 1013 l 1006 1013 l 1006 678 "},C:{x_min:0,x_max:886,ha:944,o:"m 886 379 q 760 87 886 201 q 455 -26 634 -26 q 112 136 236 -26 q 0 509 0 283 q 118 882 0 737 q 469 1041 245 1041 q 748 955 630 1041 q 879 708 879 859 l 745 708 q 649 862 724 805 q 473 920 573 920 q 219 791 312 920 q 136 509 136 675 q 217 229 136 344 q 470 99 311 99 q 672 179 591 99 q 753 379 753 259 l 886 379 "},"!":{x_min:0,x_max:138,ha:236,o:"m 138 684 q 116 409 138 629 q 105 244 105 299 l 33 244 q 16 465 33 313 q 0 684 0 616 l 0 1013 l 138 1013 l 138 684 m 138 0 l 0 0 l 0 151 l 138 151 l 138 0 "},"{":{x_min:0,x_max:480.5625,ha:578,o:"m 480 -286 q 237 -213 303 -286 q 187 -45 187 -159 q 194 48 187 -15 q 201 141 201 112 q 164 264 201 225 q 0 314 118 314 l 0 417 q 164 471 119 417 q 201 605 201 514 q 199 665 201 644 q 193 772 193 769 q 241 941 193 887 q 480 1015 308 1015 l 480 915 q 336 866 375 915 q 306 742 306 828 q 310 662 306 717 q 314 577 314 606 q 288 452 314 500 q 176 365 256 391 q 289 275 257 337 q 314 143 314 226 q 313 84 314 107 q 310 -11 310 -5 q 339 -131 310 -94 q 480 -182 377 -182 l 480 -286 "},X:{x_min:-.015625,x_max:854.15625,ha:940,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 428 637 l 675 1013 l 836 1013 l 504 520 l 854 0 "},"#":{x_min:0,x_max:963.890625,ha:1061,o:"m 963 690 l 927 590 l 719 590 l 655 410 l 876 410 l 840 310 l 618 310 l 508 -3 l 393 -2 l 506 309 l 329 310 l 215 -2 l 102 -3 l 212 310 l 0 310 l 36 410 l 248 409 l 312 590 l 86 590 l 120 690 l 347 690 l 459 1006 l 573 1006 l 462 690 l 640 690 l 751 1006 l 865 1006 l 754 690 l 963 690 m 606 590 l 425 590 l 362 410 l 543 410 l 606 590 "},"\u03b9":{x_min:42,x_max:284,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 738 l 167 738 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 "},"\u0386":{x_min:0,x_max:906.953125,ha:982,o:"m 283 1040 l 88 799 l 5 799 l 145 1040 l 283 1040 m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1012 l 529 1012 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},")":{x_min:0,x_max:318,ha:415,o:"m 318 365 q 257 25 318 191 q 87 -290 197 -141 l 0 -290 q 140 21 93 -128 q 193 360 193 189 q 141 704 193 537 q 0 1024 97 850 l 87 1024 q 257 706 197 871 q 318 365 318 542 "},"\u03b5":{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 314 0 265 q 128 390 67 353 q 56 460 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 "},"\u0394":{x_min:0,x_max:952.78125,ha:1028,o:"m 952 0 l 0 0 l 400 1013 l 551 1013 l 952 0 m 762 124 l 476 867 l 187 124 l 762 124 "},"}":{x_min:0,x_max:481,ha:578,o:"m 481 314 q 318 262 364 314 q 282 136 282 222 q 284 65 282 97 q 293 -58 293 -48 q 241 -217 293 -166 q 0 -286 174 -286 l 0 -182 q 143 -130 105 -182 q 171 -2 171 -93 q 168 81 171 22 q 165 144 165 140 q 188 275 165 229 q 306 365 220 339 q 191 455 224 391 q 165 588 165 505 q 168 681 165 624 q 171 742 171 737 q 141 865 171 827 q 0 915 102 915 l 0 1015 q 243 942 176 1015 q 293 773 293 888 q 287 675 293 741 q 282 590 282 608 q 318 466 282 505 q 481 417 364 417 l 481 314 "},"\u2030":{x_min:-3,x_max:1672,ha:1821,o:"m 846 0 q 664 76 732 0 q 603 244 603 145 q 662 412 603 344 q 846 489 729 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 846 0 962 0 m 845 103 q 945 143 910 103 q 981 243 981 184 q 947 340 981 301 q 845 385 910 385 q 745 342 782 385 q 709 243 709 300 q 742 147 709 186 q 845 103 781 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 m 1428 0 q 1246 76 1314 0 q 1185 244 1185 145 q 1244 412 1185 344 q 1428 489 1311 489 q 1610 412 1542 489 q 1672 244 1672 343 q 1612 76 1672 144 q 1428 0 1545 0 m 1427 103 q 1528 143 1492 103 q 1564 243 1564 184 q 1530 340 1564 301 q 1427 385 1492 385 q 1327 342 1364 385 q 1291 243 1291 300 q 1324 147 1291 186 q 1427 103 1363 103 "},a:{x_min:0,x_max:698.609375,ha:794,o:"m 698 0 q 661 -12 679 -7 q 615 -17 643 -17 q 536 12 564 -17 q 500 96 508 41 q 384 6 456 37 q 236 -25 312 -25 q 65 31 130 -25 q 0 194 0 88 q 118 390 0 334 q 328 435 180 420 q 488 483 476 451 q 495 523 495 504 q 442 619 495 584 q 325 654 389 654 q 209 617 257 654 q 152 513 161 580 l 33 513 q 123 705 33 633 q 332 772 207 772 q 528 712 448 772 q 617 531 617 645 l 617 163 q 624 108 617 126 q 664 90 632 90 l 698 94 l 698 0 m 491 262 l 491 372 q 272 329 350 347 q 128 201 128 294 q 166 113 128 144 q 264 83 205 83 q 414 130 346 83 q 491 262 491 183 "},"\u2014":{x_min:0,x_max:941.671875,ha:1039,o:"m 941 334 l 0 334 l 0 410 l 941 410 l 941 334 "},"=":{x_min:8.71875,x_max:780.953125,ha:792,o:"m 780 510 l 8 510 l 8 606 l 780 606 l 780 510 m 780 235 l 8 235 l 8 332 l 780 332 l 780 235 "},N:{x_min:0,x_max:801,ha:914,o:"m 801 0 l 651 0 l 131 823 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 193 l 670 1013 l 801 1013 l 801 0 "},"\u03c1":{x_min:0,x_max:712,ha:797,o:"m 712 369 q 620 94 712 207 q 362 -26 521 -26 q 230 2 292 -26 q 119 83 167 30 l 119 -278 l 0 -278 l 0 362 q 91 643 0 531 q 355 764 190 764 q 617 647 517 764 q 712 369 712 536 m 583 366 q 530 559 583 480 q 359 651 469 651 q 190 562 252 651 q 135 370 135 483 q 189 176 135 257 q 359 85 250 85 q 528 175 466 85 q 583 366 583 254 "},"\xaf":{x_min:0,x_max:941.671875,ha:938,o:"m 941 1033 l 0 1033 l 0 1109 l 941 1109 l 941 1033 "},Z:{x_min:0,x_max:779,ha:849,o:"m 779 0 l 0 0 l 0 113 l 621 896 l 40 896 l 40 1013 l 779 1013 l 778 887 l 171 124 l 779 124 l 779 0 "},u:{x_min:0,x_max:617,ha:729,o:"m 617 0 l 499 0 l 499 110 q 391 10 460 45 q 246 -25 322 -25 q 61 58 127 -25 q 0 258 0 136 l 0 738 l 125 738 l 125 284 q 156 148 125 202 q 273 82 197 82 q 433 165 369 82 q 493 340 493 243 l 493 738 l 617 738 l 617 0 "},k:{x_min:0,x_max:612.484375,ha:697,o:"m 612 738 l 338 465 l 608 0 l 469 0 l 251 382 l 121 251 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 402 l 456 738 l 612 738 "},"\u0397":{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},"\u0391":{x_min:0,x_max:906.953125,ha:985,o:"m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},s:{x_min:0,x_max:604,ha:697,o:"m 604 217 q 501 36 604 104 q 292 -23 411 -23 q 86 43 166 -23 q 0 238 0 114 l 121 237 q 175 122 121 164 q 300 85 223 85 q 415 112 363 85 q 479 207 479 147 q 361 309 479 276 q 140 372 141 370 q 21 544 21 426 q 111 708 21 647 q 298 761 190 761 q 492 705 413 761 q 583 531 583 643 l 462 531 q 412 625 462 594 q 298 657 363 657 q 199 636 242 657 q 143 558 143 608 q 262 454 143 486 q 484 394 479 397 q 604 217 604 341 "},B:{x_min:0,x_max:778,ha:876,o:"m 580 546 q 724 469 670 535 q 778 311 778 403 q 673 83 778 171 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 892 q 691 633 732 693 q 580 546 650 572 m 393 899 l 139 899 l 139 588 l 379 588 q 521 624 462 588 q 592 744 592 667 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 303 635 219 q 559 436 635 389 q 402 477 494 477 l 139 477 l 139 124 l 419 124 "},"\u2026":{x_min:0,x_max:614,ha:708,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 m 378 0 l 236 0 l 236 151 l 378 151 l 378 0 m 614 0 l 472 0 l 472 151 l 614 151 l 614 0 "},"?":{x_min:0,x_max:607,ha:704,o:"m 607 777 q 543 599 607 674 q 422 474 482 537 q 357 272 357 391 l 236 272 q 297 487 236 395 q 411 619 298 490 q 474 762 474 691 q 422 885 474 838 q 301 933 371 933 q 179 880 228 933 q 124 706 124 819 l 0 706 q 94 963 0 872 q 302 1044 177 1044 q 511 973 423 1044 q 607 777 607 895 m 370 0 l 230 0 l 230 151 l 370 151 l 370 0 "},H:{x_min:0,x_max:803,ha:915,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},"\u03bd":{x_min:0,x_max:675,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 738 l 340 147 l 541 738 l 675 738 "},c:{x_min:1,x_max:701.390625,ha:775,o:"m 701 264 q 584 53 681 133 q 353 -26 487 -26 q 91 91 188 -26 q 1 370 1 201 q 92 645 1 537 q 353 761 190 761 q 572 688 479 761 q 690 493 666 615 l 556 493 q 487 606 545 562 q 356 650 428 650 q 186 563 246 650 q 134 372 134 487 q 188 179 134 258 q 359 88 250 88 q 492 136 437 88 q 566 264 548 185 l 701 264 "},"\xb6":{x_min:0,x_max:566.671875,ha:678,o:"m 21 892 l 52 892 l 98 761 l 145 892 l 176 892 l 178 741 l 157 741 l 157 867 l 108 741 l 88 741 l 40 871 l 40 741 l 21 741 l 21 892 m 308 854 l 308 731 q 252 691 308 691 q 227 691 240 691 q 207 696 213 695 l 207 712 l 253 706 q 288 733 288 706 l 288 763 q 244 741 279 741 q 193 797 193 741 q 261 860 193 860 q 287 860 273 860 q 308 854 302 855 m 288 842 l 263 843 q 213 796 213 843 q 248 756 213 756 q 288 796 288 756 l 288 842 m 566 988 l 502 988 l 502 -1 l 439 -1 l 439 988 l 317 988 l 317 -1 l 252 -1 l 252 602 q 81 653 155 602 q 0 805 0 711 q 101 989 0 918 q 309 1053 194 1053 l 566 1053 l 566 988 "},"\u03b2":{x_min:0,x_max:660,ha:745,o:"m 471 550 q 610 450 561 522 q 660 280 660 378 q 578 64 660 151 q 367 -22 497 -22 q 239 5 299 -22 q 126 82 178 32 l 126 -278 l 0 -278 l 0 593 q 54 903 0 801 q 318 1042 127 1042 q 519 964 436 1042 q 603 771 603 887 q 567 644 603 701 q 471 550 532 586 m 337 79 q 476 138 418 79 q 535 279 535 198 q 427 437 535 386 q 226 477 344 477 l 226 583 q 398 620 329 583 q 486 762 486 668 q 435 884 486 833 q 312 935 384 935 q 169 861 219 935 q 126 698 126 797 l 126 362 q 170 169 126 242 q 337 79 224 79 "},"\u039c":{x_min:0,x_max:954,ha:1068,o:"m 954 0 l 819 0 l 819 868 l 537 0 l 405 0 l 128 865 l 128 0 l 0 0 l 0 1013 l 199 1013 l 472 158 l 758 1013 l 954 1013 l 954 0 "},"\u038c":{x_min:.109375,x_max:1120,ha:1217,o:"m 1120 505 q 994 132 1120 282 q 642 -29 861 -29 q 290 130 422 -29 q 167 505 167 280 q 294 883 167 730 q 650 1046 430 1046 q 999 882 868 1046 q 1120 505 1120 730 m 977 504 q 896 784 977 669 q 644 915 804 915 q 391 785 484 915 q 307 504 307 669 q 391 224 307 339 q 644 95 486 95 q 894 224 803 95 q 977 504 977 339 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u0389":{x_min:0,x_max:1158,ha:1275,o:"m 1158 0 l 1022 0 l 1022 475 l 496 475 l 496 0 l 356 0 l 356 1012 l 496 1012 l 496 599 l 1022 599 l 1022 1012 l 1158 1012 l 1158 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u2022":{x_min:0,x_max:663.890625,ha:775,o:"m 663 529 q 566 293 663 391 q 331 196 469 196 q 97 294 194 196 q 0 529 0 393 q 96 763 0 665 q 331 861 193 861 q 566 763 469 861 q 663 529 663 665 "},"\xa5":{x_min:.1875,x_max:819.546875,ha:886,o:"m 563 561 l 697 561 l 696 487 l 520 487 l 482 416 l 482 380 l 697 380 l 695 308 l 482 308 l 482 0 l 342 0 l 342 308 l 125 308 l 125 380 l 342 380 l 342 417 l 303 487 l 125 487 l 125 561 l 258 561 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 l 563 561 "},"(":{x_min:0,x_max:318.0625,ha:415,o:"m 318 -290 l 230 -290 q 61 23 122 -142 q 0 365 0 190 q 62 712 0 540 q 230 1024 119 869 l 318 1024 q 175 705 219 853 q 125 360 125 542 q 176 22 125 187 q 318 -290 223 -127 "},U:{x_min:0,x_max:796,ha:904,o:"m 796 393 q 681 93 796 212 q 386 -25 566 -25 q 101 95 208 -25 q 0 393 0 211 l 0 1013 l 138 1013 l 138 391 q 204 191 138 270 q 394 107 276 107 q 586 191 512 107 q 656 391 656 270 l 656 1013 l 796 1013 l 796 393 "},"\u03b3":{x_min:.5,x_max:744.953125,ha:822,o:"m 744 737 l 463 54 l 463 -278 l 338 -278 l 338 54 l 154 495 q 104 597 124 569 q 13 651 67 651 l 0 651 l 0 751 l 39 753 q 168 711 121 753 q 242 594 207 676 l 403 208 l 617 737 l 744 737 "},"\u03b1":{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 728 407 760 q 563 637 524 696 l 563 739 l 685 739 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 96 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 "},F:{x_min:0,x_max:683.328125,ha:717,o:"m 683 888 l 140 888 l 140 583 l 613 583 l 613 458 l 140 458 l 140 0 l 0 0 l 0 1013 l 683 1013 l 683 888 "},"\xad":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},":":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},"\u03a7":{x_min:0,x_max:854.171875,ha:935,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 427 637 l 675 1013 l 836 1013 l 504 521 l 854 0 "},"*":{x_min:116,x_max:674,ha:792,o:"m 674 768 l 475 713 l 610 544 l 517 477 l 394 652 l 272 478 l 178 544 l 314 713 l 116 766 l 153 876 l 341 812 l 342 1013 l 446 1013 l 446 811 l 635 874 l 674 768 "},"\u2020":{x_min:0,x_max:777,ha:835,o:"m 458 804 l 777 804 l 777 683 l 458 683 l 458 0 l 319 0 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 "},"\xb0":{x_min:0,x_max:347,ha:444,o:"m 173 802 q 43 856 91 802 q 0 977 0 905 q 45 1101 0 1049 q 173 1153 90 1153 q 303 1098 255 1153 q 347 977 347 1049 q 303 856 347 905 q 173 802 256 802 m 173 884 q 238 910 214 884 q 262 973 262 937 q 239 1038 262 1012 q 173 1064 217 1064 q 108 1037 132 1064 q 85 973 85 1010 q 108 910 85 937 q 173 884 132 884 "},V:{x_min:0,x_max:862.71875,ha:940,o:"m 862 1013 l 505 0 l 361 0 l 0 1013 l 143 1013 l 434 165 l 718 1012 l 862 1013 "},"\u039e":{x_min:0,x_max:734.71875,ha:763,o:"m 723 889 l 9 889 l 9 1013 l 723 1013 l 723 889 m 673 463 l 61 463 l 61 589 l 673 589 l 673 463 m 734 0 l 0 0 l 0 124 l 734 124 l 734 0 "},"\xa0":{x_min:0,x_max:0,ha:853},"\u03ab":{x_min:.328125,x_max:819.515625,ha:889,o:"m 588 1046 l 460 1046 l 460 1189 l 588 1189 l 588 1046 m 360 1046 l 232 1046 l 232 1189 l 360 1189 l 360 1046 m 819 1012 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1012 l 140 1012 l 411 533 l 679 1012 l 819 1012 "},"\u201d":{x_min:0,x_max:347,ha:454,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 m 347 851 q 310 737 347 784 q 208 669 273 690 l 208 734 q 267 787 250 741 q 280 873 280 821 l 208 873 l 208 1013 l 347 1013 l 347 851 "},"@":{x_min:0,x_max:1260,ha:1357,o:"m 1098 -45 q 877 -160 1001 -117 q 633 -203 752 -203 q 155 -29 327 -203 q 0 360 0 127 q 176 802 0 616 q 687 1008 372 1008 q 1123 854 969 1008 q 1260 517 1260 718 q 1155 216 1260 341 q 868 82 1044 82 q 772 106 801 82 q 737 202 737 135 q 647 113 700 144 q 527 82 594 82 q 367 147 420 82 q 314 312 314 212 q 401 565 314 452 q 639 690 498 690 q 810 588 760 690 l 849 668 l 938 668 q 877 441 900 532 q 833 226 833 268 q 853 182 833 198 q 902 167 873 167 q 1088 272 1012 167 q 1159 512 1159 372 q 1051 793 1159 681 q 687 925 925 925 q 248 747 415 925 q 97 361 97 586 q 226 26 97 159 q 627 -122 370 -122 q 856 -87 737 -122 q 1061 8 976 -53 l 1098 -45 m 786 488 q 738 580 777 545 q 643 615 700 615 q 483 517 548 615 q 425 322 425 430 q 457 203 425 250 q 552 156 490 156 q 722 273 665 156 q 786 488 738 309 "},"\u038a":{x_min:0,x_max:499,ha:613,o:"m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 m 499 0 l 360 0 l 360 1012 l 499 1012 l 499 0 "},i:{x_min:14,x_max:136,ha:275,o:"m 136 873 l 14 873 l 14 1013 l 136 1013 l 136 873 m 136 0 l 14 0 l 14 737 l 136 737 l 136 0 "},"\u0392":{x_min:0,x_max:778,ha:877,o:"m 580 545 q 724 468 671 534 q 778 310 778 402 q 673 83 778 170 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 891 q 691 632 732 692 q 580 545 650 571 m 393 899 l 139 899 l 139 587 l 379 587 q 521 623 462 587 q 592 744 592 666 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 302 635 219 q 559 435 635 388 q 402 476 494 476 l 139 476 l 139 124 l 419 124 "},"\u03c5":{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 94 617 199 q 308 -24 455 -24 q 76 94 161 -24 q 0 352 0 199 l 0 739 l 126 739 l 126 355 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 355 492 257 l 492 739 l 617 739 l 617 352 "},"]":{x_min:0,x_max:275,ha:372,o:"m 275 -281 l 0 -281 l 0 -187 l 151 -187 l 151 920 l 0 920 l 0 1013 l 275 1013 l 275 -281 "},m:{x_min:0,x_max:1019,ha:1128,o:"m 1019 0 l 897 0 l 897 454 q 860 591 897 536 q 739 660 816 660 q 613 586 659 660 q 573 436 573 522 l 573 0 l 447 0 l 447 455 q 412 591 447 535 q 294 657 372 657 q 165 586 213 657 q 122 437 122 521 l 122 0 l 0 0 l 0 738 l 117 738 l 117 640 q 202 730 150 697 q 316 763 254 763 q 437 730 381 763 q 525 642 494 697 q 621 731 559 700 q 753 763 682 763 q 943 694 867 763 q 1019 512 1019 625 l 1019 0 "},"\u03c7":{x_min:8.328125,x_max:780.5625,ha:815,o:"m 780 -278 q 715 -294 747 -294 q 616 -257 663 -294 q 548 -175 576 -227 l 379 133 l 143 -277 l 9 -277 l 313 254 l 163 522 q 127 586 131 580 q 36 640 91 640 q 8 637 27 640 l 8 752 l 52 757 q 162 719 113 757 q 236 627 200 690 l 383 372 l 594 737 l 726 737 l 448 250 l 625 -69 q 670 -153 647 -110 q 743 -188 695 -188 q 780 -184 759 -188 l 780 -278 "},"\u03af":{x_min:42,x_max:326.71875,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 102 239 101 q 284 112 257 104 l 284 3 m 326 1040 l 137 819 l 54 819 l 189 1040 l 326 1040 "},"\u0396":{x_min:0,x_max:779.171875,ha:850,o:"m 779 0 l 0 0 l 0 113 l 620 896 l 40 896 l 40 1013 l 779 1013 l 779 887 l 170 124 l 779 124 l 779 0 "},R:{x_min:0,x_max:781.953125,ha:907,o:"m 781 0 l 623 0 q 587 242 590 52 q 407 433 585 433 l 138 433 l 138 0 l 0 0 l 0 1013 l 396 1013 q 636 946 539 1013 q 749 731 749 868 q 711 597 749 659 q 608 502 674 534 q 718 370 696 474 q 729 207 722 352 q 781 26 736 62 l 781 0 m 373 551 q 533 594 465 551 q 614 731 614 645 q 532 859 614 815 q 373 896 465 896 l 138 896 l 138 551 l 373 551 "},o:{x_min:0,x_max:713,ha:821,o:"m 357 -25 q 94 91 194 -25 q 0 368 0 202 q 93 642 0 533 q 357 761 193 761 q 618 644 518 761 q 713 368 713 533 q 619 91 713 201 q 357 -25 521 -25 m 357 85 q 528 175 465 85 q 584 369 584 255 q 529 562 584 484 q 357 651 467 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 357 85 250 85 "},K:{x_min:0,x_max:819.46875,ha:906,o:"m 819 0 l 649 0 l 294 509 l 139 355 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},",":{x_min:0,x_max:142,ha:239,o:"m 142 -12 q 105 -132 142 -82 q 0 -205 68 -182 l 0 -138 q 57 -82 40 -124 q 70 0 70 -51 l 0 0 l 0 151 l 142 151 l 142 -12 "},d:{x_min:0,x_max:683,ha:796,o:"m 683 0 l 564 0 l 564 93 q 456 6 516 38 q 327 -25 395 -25 q 87 100 181 -25 q 0 365 0 215 q 90 639 0 525 q 343 763 187 763 q 564 647 486 763 l 564 1013 l 683 1013 l 683 0 m 582 373 q 529 562 582 484 q 361 653 468 653 q 190 561 253 653 q 135 365 135 479 q 189 175 135 254 q 358 85 251 85 q 529 178 468 85 q 582 373 582 258 "},"\xa8":{x_min:-109,x_max:247,ha:232,o:"m 247 1046 l 119 1046 l 119 1189 l 247 1189 l 247 1046 m 19 1046 l -109 1046 l -109 1189 l 19 1189 l 19 1046 "},E:{x_min:0,x_max:736.109375,ha:789,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},Y:{x_min:0,x_max:820,ha:886,o:"m 820 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 534 l 679 1012 l 820 1013 "},'"':{x_min:0,x_max:299,ha:396,o:"m 299 606 l 203 606 l 203 988 l 299 988 l 299 606 m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"\u2039":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"\u201e":{x_min:0,x_max:364,ha:467,o:"m 141 -12 q 104 -132 141 -82 q 0 -205 67 -182 l 0 -138 q 56 -82 40 -124 q 69 0 69 -51 l 0 0 l 0 151 l 141 151 l 141 -12 m 364 -12 q 327 -132 364 -82 q 222 -205 290 -182 l 222 -138 q 279 -82 262 -124 q 292 0 292 -51 l 222 0 l 222 151 l 364 151 l 364 -12 "},"\u03b4":{x_min:1,x_max:710,ha:810,o:"m 710 360 q 616 87 710 196 q 356 -28 518 -28 q 99 82 197 -28 q 1 356 1 192 q 100 606 1 509 q 355 703 199 703 q 180 829 288 754 q 70 903 124 866 l 70 1012 l 643 1012 l 643 901 l 258 901 q 462 763 422 794 q 636 592 577 677 q 710 360 710 485 m 584 365 q 552 501 584 447 q 451 602 521 555 q 372 611 411 611 q 197 541 258 611 q 136 355 136 472 q 190 171 136 245 q 358 85 252 85 q 528 173 465 85 q 584 365 584 252 "},"\u03ad":{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 313 0 265 q 128 390 67 352 q 56 459 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 m 520 1040 l 331 819 l 248 819 l 383 1040 l 520 1040 "},"\u03c9":{x_min:0,x_max:922,ha:1031,o:"m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 339 0 203 q 45 551 0 444 q 161 738 84 643 l 302 738 q 175 553 219 647 q 124 336 124 446 q 155 179 124 249 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 342 797 257 q 745 556 797 450 q 619 738 705 638 l 760 738 q 874 551 835 640 q 922 339 922 444 "},"\xb4":{x_min:0,x_max:96,ha:251,o:"m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"\xb1":{x_min:11,x_max:781,ha:792,o:"m 781 490 l 446 490 l 446 255 l 349 255 l 349 490 l 11 490 l 11 586 l 349 586 l 349 819 l 446 819 l 446 586 l 781 586 l 781 490 m 781 21 l 11 21 l 11 115 l 781 115 l 781 21 "},"|":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"\u03cb":{x_min:0,x_max:617,ha:725,o:"m 482 800 l 372 800 l 372 925 l 482 925 l 482 800 m 239 800 l 129 800 l 129 925 l 239 925 l 239 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 "},"\xa7":{x_min:0,x_max:593,ha:690,o:"m 593 425 q 554 312 593 369 q 467 233 516 254 q 537 83 537 172 q 459 -74 537 -12 q 288 -133 387 -133 q 115 -69 184 -133 q 47 96 47 -6 l 166 96 q 199 7 166 40 q 288 -26 232 -26 q 371 -5 332 -26 q 420 60 420 21 q 311 201 420 139 q 108 309 210 255 q 0 490 0 383 q 33 602 0 551 q 124 687 66 654 q 75 743 93 712 q 58 812 58 773 q 133 984 58 920 q 300 1043 201 1043 q 458 987 394 1043 q 529 814 529 925 l 411 814 q 370 908 404 877 q 289 939 336 939 q 213 911 246 939 q 180 841 180 883 q 286 720 180 779 q 484 612 480 615 q 593 425 593 534 m 467 409 q 355 544 467 473 q 196 630 228 612 q 146 587 162 609 q 124 525 124 558 q 239 387 124 462 q 398 298 369 315 q 448 345 429 316 q 467 409 467 375 "},b:{x_min:0,x_max:685,ha:783,o:"m 685 372 q 597 99 685 213 q 347 -25 501 -25 q 219 5 277 -25 q 121 93 161 36 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 634 q 214 723 157 692 q 341 754 272 754 q 591 637 493 754 q 685 372 685 526 m 554 356 q 499 550 554 470 q 328 644 437 644 q 162 556 223 644 q 108 369 108 478 q 160 176 108 256 q 330 83 221 83 q 498 169 435 83 q 554 356 554 245 "},q:{x_min:0,x_max:683,ha:876,o:"m 683 -278 l 564 -278 l 564 97 q 474 8 533 39 q 345 -23 415 -23 q 91 93 188 -23 q 0 364 0 203 q 87 635 0 522 q 337 760 184 760 q 466 727 408 760 q 564 637 523 695 l 564 737 l 683 737 l 683 -278 m 582 375 q 527 564 582 488 q 358 652 466 652 q 190 565 253 652 q 135 377 135 488 q 189 179 135 261 q 361 84 251 84 q 530 179 469 84 q 582 375 582 260 "},"\u03a9":{x_min:-.171875,x_max:969.5625,ha:1068,o:"m 969 0 l 555 0 l 555 123 q 744 308 675 194 q 814 558 814 423 q 726 812 814 709 q 484 922 633 922 q 244 820 334 922 q 154 567 154 719 q 223 316 154 433 q 412 123 292 199 l 412 0 l 0 0 l 0 124 l 217 124 q 68 327 122 210 q 15 572 15 444 q 144 911 15 781 q 484 1041 274 1041 q 822 909 691 1041 q 953 569 953 777 q 899 326 953 443 q 750 124 846 210 l 969 124 l 969 0 "},"\u03cd":{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 535 1040 l 346 819 l 262 819 l 397 1040 l 535 1040 "},z:{x_min:-.015625,x_max:613.890625,ha:697,o:"m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "},"\u2122":{x_min:0,x_max:894,ha:1e3,o:"m 389 951 l 229 951 l 229 503 l 160 503 l 160 951 l 0 951 l 0 1011 l 389 1011 l 389 951 m 894 503 l 827 503 l 827 939 l 685 503 l 620 503 l 481 937 l 481 503 l 417 503 l 417 1011 l 517 1011 l 653 580 l 796 1010 l 894 1011 l 894 503 "},"\u03ae":{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 721 124 755 q 200 630 193 687 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 m 479 1040 l 290 819 l 207 819 l 341 1040 l 479 1040 "},"\u0398":{x_min:0,x_max:960,ha:1056,o:"m 960 507 q 833 129 960 280 q 476 -32 698 -32 q 123 129 255 -32 q 0 507 0 280 q 123 883 0 732 q 476 1045 255 1045 q 832 883 696 1045 q 960 507 960 732 m 817 500 q 733 789 817 669 q 476 924 639 924 q 223 792 317 924 q 142 507 142 675 q 222 222 142 339 q 476 89 315 89 q 730 218 636 89 q 817 500 817 334 m 716 449 l 243 449 l 243 571 l 716 571 l 716 449 "},"\xae":{x_min:-3,x_max:1008,ha:1106,o:"m 503 532 q 614 562 566 532 q 672 658 672 598 q 614 747 672 716 q 503 772 569 772 l 338 772 l 338 532 l 503 532 m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 788 146 l 678 146 q 653 316 655 183 q 527 449 652 449 l 338 449 l 338 146 l 241 146 l 241 854 l 518 854 q 688 808 621 854 q 766 658 766 755 q 739 563 766 607 q 668 497 713 519 q 751 331 747 472 q 788 164 756 190 l 788 146 "},"~":{x_min:0,x_max:833,ha:931,o:"m 833 958 q 778 753 833 831 q 594 665 716 665 q 402 761 502 665 q 240 857 302 857 q 131 795 166 857 q 104 665 104 745 l 0 665 q 54 867 0 789 q 237 958 116 958 q 429 861 331 958 q 594 765 527 765 q 704 827 670 765 q 729 958 729 874 l 833 958 "},"\u0395":{x_min:0,x_max:736.21875,ha:778,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"\xb3":{x_min:0,x_max:450,ha:547,o:"m 450 552 q 379 413 450 464 q 220 366 313 366 q 69 414 130 366 q 0 567 0 470 l 85 567 q 126 470 85 504 q 225 437 168 437 q 320 467 280 437 q 360 552 360 498 q 318 632 360 608 q 213 657 276 657 q 195 657 203 657 q 176 657 181 657 l 176 722 q 279 733 249 722 q 334 815 334 752 q 300 881 334 856 q 220 907 267 907 q 133 875 169 907 q 97 781 97 844 l 15 781 q 78 926 15 875 q 220 972 135 972 q 364 930 303 972 q 426 817 426 888 q 344 697 426 733 q 421 642 392 681 q 450 552 450 603 "},"[":{x_min:0,x_max:273.609375,ha:371,o:"m 273 -281 l 0 -281 l 0 1013 l 273 1013 l 273 920 l 124 920 l 124 -187 l 273 -187 l 273 -281 "},L:{x_min:0,x_max:645.828125,ha:696,o:"m 645 0 l 0 0 l 0 1013 l 140 1013 l 140 126 l 645 126 l 645 0 "},"\u03c3":{x_min:0,x_max:803.390625,ha:894,o:"m 803 628 l 633 628 q 713 368 713 512 q 618 93 713 204 q 357 -25 518 -25 q 94 91 194 -25 q 0 368 0 201 q 94 644 0 533 q 356 761 194 761 q 481 750 398 761 q 608 739 564 739 l 803 739 l 803 628 m 360 85 q 529 180 467 85 q 584 374 584 262 q 527 566 584 490 q 352 651 463 651 q 187 559 247 651 q 135 368 135 478 q 189 175 135 254 q 360 85 251 85 "},"\u03b6":{x_min:0,x_max:573,ha:642,o:"m 573 -40 q 553 -162 573 -97 q 510 -278 543 -193 l 400 -278 q 441 -187 428 -219 q 462 -90 462 -132 q 378 -14 462 -14 q 108 45 197 -14 q 0 290 0 117 q 108 631 0 462 q 353 901 194 767 l 55 901 l 55 1012 l 561 1012 l 561 924 q 261 669 382 831 q 128 301 128 489 q 243 117 128 149 q 458 98 350 108 q 573 -40 573 80 "},"\u03b8":{x_min:0,x_max:674,ha:778,o:"m 674 496 q 601 160 674 304 q 336 -26 508 -26 q 73 153 165 -26 q 0 485 0 296 q 72 840 0 683 q 343 1045 166 1045 q 605 844 516 1045 q 674 496 674 692 m 546 579 q 498 798 546 691 q 336 935 437 935 q 178 798 237 935 q 126 579 137 701 l 546 579 m 546 475 l 126 475 q 170 233 126 348 q 338 80 230 80 q 504 233 447 80 q 546 475 546 346 "},"\u039f":{x_min:0,x_max:958,ha:1054,o:"m 485 1042 q 834 883 703 1042 q 958 511 958 735 q 834 136 958 287 q 481 -26 701 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 729 q 485 1042 263 1042 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 670 q 480 913 640 913 q 226 785 321 913 q 142 504 142 671 q 226 224 142 339 q 480 98 319 98 "},"\u0393":{x_min:0,x_max:705.28125,ha:749,o:"m 705 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 705 1012 l 705 886 "}," ":{x_min:0,x_max:0,ha:375},"%":{x_min:-3,x_max:1089,ha:1186,o:"m 845 0 q 663 76 731 0 q 602 244 602 145 q 661 412 602 344 q 845 489 728 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 845 0 962 0 m 844 103 q 945 143 909 103 q 981 243 981 184 q 947 340 981 301 q 844 385 909 385 q 744 342 781 385 q 708 243 708 300 q 741 147 708 186 q 844 103 780 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 "},P:{x_min:0,x_max:726,ha:806,o:"m 424 1013 q 640 931 555 1013 q 726 719 726 850 q 637 506 726 587 q 413 426 548 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 379 889 l 140 889 l 140 548 l 372 548 q 522 589 459 548 q 593 720 593 637 q 528 845 593 801 q 379 889 463 889 "},"\u0388":{x_min:0,x_max:1078.21875,ha:1118,o:"m 1078 0 l 342 0 l 342 1013 l 1067 1013 l 1067 889 l 481 889 l 481 585 l 1019 585 l 1019 467 l 481 467 l 481 125 l 1078 125 l 1078 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"\u038f":{x_min:.125,x_max:1136.546875,ha:1235,o:"m 1136 0 l 722 0 l 722 123 q 911 309 842 194 q 981 558 981 423 q 893 813 981 710 q 651 923 800 923 q 411 821 501 923 q 321 568 321 720 q 390 316 321 433 q 579 123 459 200 l 579 0 l 166 0 l 166 124 l 384 124 q 235 327 289 210 q 182 572 182 444 q 311 912 182 782 q 651 1042 441 1042 q 989 910 858 1042 q 1120 569 1120 778 q 1066 326 1120 443 q 917 124 1013 210 l 1136 124 l 1136 0 m 277 1040 l 83 800 l 0 800 l 140 1041 l 277 1040 "},_:{x_min:0,x_max:705.5625,ha:803,o:"m 705 -334 l 0 -334 l 0 -234 l 705 -234 l 705 -334 "},"\u03aa":{x_min:-110,x_max:246,ha:275,o:"m 246 1046 l 118 1046 l 118 1189 l 246 1189 l 246 1046 m 18 1046 l -110 1046 l -110 1189 l 18 1189 l 18 1046 m 136 0 l 0 0 l 0 1012 l 136 1012 l 136 0 "},"+":{x_min:23,x_max:768,ha:792,o:"m 768 372 l 444 372 l 444 0 l 347 0 l 347 372 l 23 372 l 23 468 l 347 468 l 347 840 l 444 840 l 444 468 l 768 468 l 768 372 "},"\xbd":{x_min:0,x_max:1050,ha:1149,o:"m 1050 0 l 625 0 q 712 178 625 108 q 878 277 722 187 q 967 385 967 328 q 932 456 967 429 q 850 484 897 484 q 759 450 798 484 q 721 352 721 416 l 640 352 q 706 502 640 448 q 851 551 766 551 q 987 509 931 551 q 1050 385 1050 462 q 976 251 1050 301 q 829 179 902 215 q 717 68 740 133 l 1050 68 l 1050 0 m 834 985 l 215 -28 l 130 -28 l 750 984 l 834 985 m 224 422 l 142 422 l 142 811 l 0 811 l 0 867 q 104 889 62 867 q 164 973 157 916 l 224 973 l 224 422 "},"\u03a1":{x_min:0,x_max:720,ha:783,o:"m 424 1013 q 637 933 554 1013 q 720 723 720 853 q 633 508 720 591 q 413 426 546 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 378 889 l 140 889 l 140 548 l 371 548 q 521 589 458 548 q 592 720 592 637 q 527 845 592 801 q 378 889 463 889 "},"'":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},"\xaa":{x_min:0,x_max:350,ha:397,o:"m 350 625 q 307 616 328 616 q 266 631 281 616 q 247 673 251 645 q 190 628 225 644 q 116 613 156 613 q 32 641 64 613 q 0 722 0 669 q 72 826 0 800 q 247 866 159 846 l 247 887 q 220 934 247 916 q 162 953 194 953 q 104 934 129 953 q 76 882 80 915 l 16 882 q 60 976 16 941 q 166 1011 104 1011 q 266 979 224 1011 q 308 891 308 948 l 308 706 q 311 679 308 688 q 331 670 315 670 l 350 672 l 350 625 m 247 757 l 247 811 q 136 790 175 798 q 64 726 64 773 q 83 682 64 697 q 132 667 103 667 q 207 690 174 667 q 247 757 247 718 "},"\u0385":{x_min:0,x_max:450,ha:553,o:"m 450 800 l 340 800 l 340 925 l 450 925 l 450 800 m 406 1040 l 212 800 l 129 800 l 269 1040 l 406 1040 m 110 800 l 0 800 l 0 925 l 110 925 l 110 800 "},T:{x_min:0,x_max:777,ha:835,o:"m 777 894 l 458 894 l 458 0 l 319 0 l 319 894 l 0 894 l 0 1013 l 777 1013 l 777 894 "},"\u03a6":{x_min:0,x_max:915,ha:997,o:"m 527 0 l 389 0 l 389 122 q 110 231 220 122 q 0 509 0 340 q 110 785 0 677 q 389 893 220 893 l 389 1013 l 527 1013 l 527 893 q 804 786 693 893 q 915 509 915 679 q 805 231 915 341 q 527 122 696 122 l 527 0 m 527 226 q 712 310 641 226 q 779 507 779 389 q 712 705 779 627 q 527 787 641 787 l 527 226 m 389 226 l 389 787 q 205 698 275 775 q 136 505 136 620 q 206 308 136 391 q 389 226 276 226 "},"\u204b":{x_min:0,x_max:0,ha:694},j:{x_min:-77.78125,x_max:167,ha:349,o:"m 167 871 l 42 871 l 42 1013 l 167 1013 l 167 871 m 167 -80 q 121 -231 167 -184 q -26 -278 76 -278 l -77 -278 l -77 -164 l -41 -164 q 26 -143 11 -164 q 42 -65 42 -122 l 42 737 l 167 737 l 167 -80 "},"\u03a3":{x_min:0,x_max:756.953125,ha:819,o:"m 756 0 l 0 0 l 0 107 l 395 523 l 22 904 l 22 1013 l 745 1013 l 745 889 l 209 889 l 566 523 l 187 125 l 756 125 l 756 0 "},"\u203a":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"<":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"\xa3":{x_min:0,x_max:704.484375,ha:801,o:"m 704 41 q 623 -10 664 5 q 543 -26 583 -26 q 359 15 501 -26 q 243 36 288 36 q 158 23 197 36 q 73 -21 119 10 l 6 76 q 125 195 90 150 q 175 331 175 262 q 147 443 175 383 l 0 443 l 0 512 l 108 512 q 43 734 43 623 q 120 929 43 854 q 358 1010 204 1010 q 579 936 487 1010 q 678 729 678 857 l 678 684 l 552 684 q 504 838 552 780 q 362 896 457 896 q 216 852 263 896 q 176 747 176 815 q 199 627 176 697 q 248 512 217 574 l 468 512 l 468 443 l 279 443 q 297 356 297 398 q 230 194 297 279 q 153 107 211 170 q 227 133 190 125 q 293 142 264 142 q 410 119 339 142 q 516 96 482 96 q 579 105 550 96 q 648 142 608 115 l 704 41 "},t:{x_min:0,x_max:367,ha:458,o:"m 367 0 q 312 -5 339 -2 q 262 -8 284 -8 q 145 28 183 -8 q 108 143 108 64 l 108 638 l 0 638 l 0 738 l 108 738 l 108 944 l 232 944 l 232 738 l 367 738 l 367 638 l 232 638 l 232 185 q 248 121 232 140 q 307 102 264 102 q 345 104 330 102 q 367 107 360 107 l 367 0 "},"\xac":{x_min:0,x_max:706,ha:803,o:"m 706 411 l 706 158 l 630 158 l 630 335 l 0 335 l 0 411 l 706 411 "},"\u03bb":{x_min:0,x_max:750,ha:803,o:"m 750 -7 q 679 -15 716 -15 q 538 59 591 -15 q 466 214 512 97 l 336 551 l 126 0 l 0 0 l 270 705 q 223 837 247 770 q 116 899 190 899 q 90 898 100 899 l 90 1004 q 152 1011 125 1011 q 298 938 244 1011 q 373 783 326 901 l 605 192 q 649 115 629 136 q 716 95 669 95 l 736 95 q 750 97 745 97 l 750 -7 "},W:{x_min:0,x_max:1263.890625,ha:1351,o:"m 1263 1013 l 995 0 l 859 0 l 627 837 l 405 0 l 265 0 l 0 1013 l 136 1013 l 342 202 l 556 1013 l 701 1013 l 921 207 l 1133 1012 l 1263 1013 "},">":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},v:{x_min:0,x_max:675.15625,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 737 l 340 147 l 541 737 l 675 738 "},"\u03c4":{x_min:.28125,x_max:644.5,ha:703,o:"m 644 628 l 382 628 l 382 179 q 388 120 382 137 q 436 91 401 91 q 474 94 447 91 q 504 97 501 97 l 504 0 q 454 -9 482 -5 q 401 -14 426 -14 q 278 67 308 -14 q 260 233 260 118 l 260 628 l 0 628 l 0 739 l 644 739 l 644 628 "},"\u03be":{x_min:0,x_max:624.9375,ha:699,o:"m 624 -37 q 608 -153 624 -96 q 563 -278 593 -211 l 454 -278 q 491 -183 486 -200 q 511 -83 511 -126 q 484 -23 511 -44 q 370 1 452 1 q 323 0 354 1 q 283 -1 293 -1 q 84 76 169 -1 q 0 266 0 154 q 56 431 0 358 q 197 538 108 498 q 94 613 134 562 q 54 730 54 665 q 77 823 54 780 q 143 901 101 867 l 27 901 l 27 1012 l 576 1012 l 576 901 l 380 901 q 244 863 303 901 q 178 745 178 820 q 312 600 178 636 q 532 582 380 582 l 532 479 q 276 455 361 479 q 118 281 118 410 q 165 173 118 217 q 274 120 208 133 q 494 101 384 110 q 624 -37 624 76 "},"&":{x_min:-3,x_max:894.25,ha:992,o:"m 894 0 l 725 0 l 624 123 q 471 0 553 40 q 306 -41 390 -41 q 168 -7 231 -41 q 62 92 105 26 q 14 187 31 139 q -3 276 -3 235 q 55 433 -3 358 q 248 581 114 508 q 170 689 196 640 q 137 817 137 751 q 214 985 137 922 q 384 1041 284 1041 q 548 988 483 1041 q 622 824 622 928 q 563 666 622 739 q 431 556 516 608 l 621 326 q 649 407 639 361 q 663 493 653 426 l 781 493 q 703 229 781 352 l 894 0 m 504 818 q 468 908 504 877 q 384 940 433 940 q 293 907 331 940 q 255 818 255 875 q 289 714 255 767 q 363 628 313 678 q 477 729 446 682 q 504 818 504 771 m 556 209 l 314 499 q 179 395 223 449 q 135 283 135 341 q 146 222 135 253 q 183 158 158 192 q 333 80 241 80 q 556 209 448 80 "},"\u039b":{x_min:0,x_max:862.5,ha:942,o:"m 862 0 l 719 0 l 426 847 l 143 0 l 0 0 l 356 1013 l 501 1013 l 862 0 "},I:{x_min:41,x_max:180,ha:293,o:"m 180 0 l 41 0 l 41 1013 l 180 1013 l 180 0 "},G:{x_min:0,x_max:921,ha:1011,o:"m 921 0 l 832 0 l 801 136 q 655 15 741 58 q 470 -28 568 -28 q 126 133 259 -28 q 0 499 0 284 q 125 881 0 731 q 486 1043 259 1043 q 763 957 647 1043 q 905 709 890 864 l 772 709 q 668 866 747 807 q 486 926 589 926 q 228 795 322 926 q 142 507 142 677 q 228 224 142 342 q 483 94 323 94 q 712 195 625 94 q 796 435 796 291 l 477 435 l 477 549 l 921 549 l 921 0 "},"\u03b0":{x_min:0,x_max:617,ha:725,o:"m 524 800 l 414 800 l 414 925 l 524 925 l 524 800 m 183 800 l 73 800 l 73 925 l 183 925 l 183 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 489 1040 l 300 819 l 216 819 l 351 1040 l 489 1040 "},"`":{x_min:0,x_max:138.890625,ha:236,o:"m 138 699 l 0 699 l 0 861 q 36 974 0 929 q 138 1041 72 1020 l 138 977 q 82 931 95 969 q 69 839 69 893 l 138 839 l 138 699 "},"\xb7":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},"\u03a5":{x_min:.328125,x_max:819.515625,ha:889,o:"m 819 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 "},r:{x_min:0,x_max:355.5625,ha:432,o:"m 355 621 l 343 621 q 179 569 236 621 q 122 411 122 518 l 122 0 l 0 0 l 0 737 l 117 737 l 117 604 q 204 719 146 686 q 355 753 262 753 l 355 621 "},x:{x_min:0,x_max:675,ha:764,o:"m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "},"\u03bc":{x_min:0,x_max:696.609375,ha:747,o:"m 696 -4 q 628 -14 657 -14 q 498 97 513 -14 q 422 8 470 41 q 313 -24 374 -24 q 207 3 258 -24 q 120 80 157 31 l 120 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 172 124 246 q 308 82 216 82 q 451 177 402 82 q 492 358 492 254 l 492 738 l 616 738 l 616 214 q 623 136 616 160 q 673 92 636 92 q 696 95 684 92 l 696 -4 "},h:{x_min:0,x_max:615,ha:724,o:"m 615 472 l 615 0 l 490 0 l 490 454 q 456 590 490 535 q 338 654 416 654 q 186 588 251 654 q 122 436 122 522 l 122 0 l 0 0 l 0 1013 l 122 1013 l 122 633 q 218 727 149 694 q 362 760 287 760 q 552 676 484 760 q 615 472 615 600 "},".":{x_min:0,x_max:142,ha:239,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},"\u03c6":{x_min:-2,x_max:878,ha:974,o:"m 496 -279 l 378 -279 l 378 -17 q 101 88 204 -17 q -2 367 -2 194 q 68 626 -2 510 q 283 758 151 758 l 283 646 q 167 537 209 626 q 133 373 133 462 q 192 177 133 254 q 378 93 259 93 l 378 758 q 445 764 426 763 q 476 765 464 765 q 765 659 653 765 q 878 377 878 553 q 771 96 878 209 q 496 -17 665 -17 l 496 -279 m 496 93 l 514 93 q 687 183 623 93 q 746 380 746 265 q 691 569 746 491 q 522 658 629 658 l 496 656 l 496 93 "},";":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 -12 q 105 -132 142 -82 q 0 -206 68 -182 l 0 -138 q 58 -82 43 -123 q 68 0 68 -56 l 0 0 l 0 151 l 142 151 l 142 -12 "},f:{x_min:0,x_max:378,ha:472,o:"m 378 638 l 246 638 l 246 0 l 121 0 l 121 638 l 0 638 l 0 738 l 121 738 q 137 935 121 887 q 290 1028 171 1028 q 320 1027 305 1028 q 378 1021 334 1026 l 378 908 q 323 918 346 918 q 257 870 273 918 q 246 780 246 840 l 246 738 l 378 738 l 378 638 "},"\u201c":{x_min:1,x_max:348.21875,ha:454,o:"m 140 670 l 1 670 l 1 830 q 37 943 1 897 q 140 1011 74 990 l 140 947 q 82 900 97 940 q 68 810 68 861 l 140 810 l 140 670 m 348 670 l 209 670 l 209 830 q 245 943 209 897 q 348 1011 282 990 l 348 947 q 290 900 305 940 q 276 810 276 861 l 348 810 l 348 670 "},A:{x_min:.03125,x_max:906.953125,ha:1008,o:"m 906 0 l 756 0 l 648 303 l 251 303 l 142 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 610 421 l 452 867 l 293 421 l 610 421 "},"\u2018":{x_min:1,x_max:139.890625,ha:236,o:"m 139 670 l 1 670 l 1 830 q 37 943 1 897 q 139 1011 74 990 l 139 947 q 82 900 97 940 q 68 810 68 861 l 139 810 l 139 670 "},"\u03ca":{x_min:-70,x_max:283,ha:361,o:"m 283 800 l 173 800 l 173 925 l 283 925 l 283 800 m 40 800 l -70 800 l -70 925 l 40 925 l 40 800 m 283 3 q 232 -10 257 -5 q 181 -15 206 -15 q 84 26 118 -15 q 41 200 41 79 l 41 737 l 166 737 l 167 215 q 171 141 167 157 q 225 101 182 101 q 247 103 238 101 q 283 112 256 104 l 283 3 "},"\u03c0":{x_min:-.21875,x_max:773.21875,ha:857,o:"m 773 -7 l 707 -11 q 575 40 607 -11 q 552 174 552 77 l 552 226 l 552 626 l 222 626 l 222 0 l 97 0 l 97 626 l 0 626 l 0 737 l 773 737 l 773 626 l 676 626 l 676 171 q 695 103 676 117 q 773 90 714 90 l 773 -7 "},"\u03ac":{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 727 407 760 q 563 637 524 695 l 563 738 l 685 738 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 95 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 m 604 1040 l 415 819 l 332 819 l 466 1040 l 604 1040 "},O:{x_min:0,x_max:958,ha:1057,o:"m 485 1041 q 834 882 702 1041 q 958 512 958 734 q 834 136 958 287 q 481 -26 702 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 728 q 485 1041 263 1041 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 669 q 480 912 640 912 q 226 784 321 912 q 142 504 142 670 q 226 224 142 339 q 480 98 319 98 "},n:{x_min:0,x_max:615,ha:724,o:"m 615 463 l 615 0 l 490 0 l 490 454 q 453 592 490 537 q 331 656 410 656 q 178 585 240 656 q 117 421 117 514 l 117 0 l 0 0 l 0 738 l 117 738 l 117 630 q 218 728 150 693 q 359 764 286 764 q 552 675 484 764 q 615 463 615 593 "},l:{x_min:41,x_max:166,ha:279,o:"m 166 0 l 41 0 l 41 1013 l 166 1013 l 166 0 "},"\xa4":{x_min:40.09375,x_max:728.796875,ha:825,o:"m 728 304 l 649 224 l 512 363 q 383 331 458 331 q 256 363 310 331 l 119 224 l 40 304 l 177 441 q 150 553 150 493 q 184 673 150 621 l 40 818 l 119 898 l 267 749 q 321 766 291 759 q 384 773 351 773 q 447 766 417 773 q 501 749 477 759 l 649 898 l 728 818 l 585 675 q 612 618 604 648 q 621 553 621 587 q 591 441 621 491 l 728 304 m 384 682 q 280 643 318 682 q 243 551 243 604 q 279 461 243 499 q 383 423 316 423 q 487 461 449 423 q 525 553 525 500 q 490 641 525 605 q 384 682 451 682 "},"\u03ba":{x_min:0,x_max:632.328125,ha:679,o:"m 632 0 l 482 0 l 225 384 l 124 288 l 124 0 l 0 0 l 0 738 l 124 738 l 124 446 l 433 738 l 596 738 l 312 466 l 632 0 "},p:{x_min:0,x_max:685,ha:786,o:"m 685 364 q 598 96 685 205 q 350 -23 504 -23 q 121 89 205 -23 l 121 -278 l 0 -278 l 0 738 l 121 738 l 121 633 q 220 726 159 691 q 351 761 280 761 q 598 636 504 761 q 685 364 685 522 m 557 371 q 501 560 557 481 q 330 651 437 651 q 162 559 223 651 q 108 366 108 479 q 162 177 108 254 q 333 87 224 87 q 502 178 441 87 q 557 371 557 258 "},"\u2021":{x_min:0,x_max:777,ha:835,o:"m 458 238 l 458 0 l 319 0 l 319 238 l 0 238 l 0 360 l 319 360 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 l 777 804 l 777 683 l 458 683 l 458 360 l 777 360 l 777 238 l 458 238 "},"\u03c8":{x_min:0,x_max:808,ha:907,o:"m 465 -278 l 341 -278 l 341 -15 q 87 102 180 -15 q 0 378 0 210 l 0 739 l 133 739 l 133 379 q 182 195 133 275 q 341 98 242 98 l 341 922 l 465 922 l 465 98 q 623 195 563 98 q 675 382 675 278 l 675 742 l 808 742 l 808 381 q 720 104 808 213 q 466 -13 627 -13 l 465 -278 "},"\u03b7":{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 720 124 755 q 200 630 193 686 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 "}},cssFontWeight:"normal",ascender:1189,underlinePosition:-100,cssFontStyle:"normal",boundingBox:{yMin:-334,xMin:-111,yMax:1189,xMax:1672},resolution:1e3,original_font_information:{postscript_name:"Helvetiker-Regular",version_string:"Version 1.00 2004 initial release",vendor_url:"http://www.magenta.gr/",full_font_name:"Helvetiker",font_family_name:"Helvetiker",copyright:"Copyright (c) \u039cagenta ltd, 2004",description:"",trademark:"",designer:"",designer_url:"",unique_font_identifier:"\u039cagenta ltd:Helvetiker:22-10-104",license_url:"http://www.ellak.gr/fonts/MgOpen/license.html",license_description:'Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license ("Fonts") and associated documentation files (the "Font Software"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \r\n\r\nThe above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\r\n\r\nThe Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word "MgOpen", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\r\n\r\nThis License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the "MgOpen" name.\r\n\r\nThe Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \r\n\r\nTHE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.',manufacturer_name:"\u039cagenta ltd",font_sub_family_name:"Regular"},descender:-334,familyName:"Helvetiker",lineHeight:1522,underlineThickness:50},VY=vQ(vQ({},window.THREE?window.THREE:{BoxGeometry:no,CircleGeometry:Ss,DoubleSide:2,Group:go,Mesh:eo,MeshLambertMaterial:gu,TextGeometry:KX,Vector3:Kr}),{},{Font:ZX,TextGeometry:KX}),qY=_c({props:{labelsData:{default:[]},labelLat:{default:"lat"},labelLng:{default:"lng"},labelAltitude:{default:0},labelText:{default:"text"},labelSize:{default:.5},labelTypeFace:{default:zY,onChange:function(e,t){t.font=new VY.Font(e)}},labelColor:{default:function(){return"lightgrey"}},labelRotation:{default:0},labelResolution:{default:3},labelIncludeDot:{default:!0},labelDotRadius:{default:.1},labelDotOrientation:{default:function(){return"bottom"}},labelsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,n){var r=n.tweenGroup;kQ(e),t.scene=e,t.tweenGroup=r;var i=new VY.CircleGeometry(1,32);t.dataMapper=new QQ(e,{objBindAttr:"__threeObjLabel"}).onCreateObj((function(){var e=new VY.MeshLambertMaterial;e.side=2;var t=new VY.Group;t.add(new VY.Mesh(i,e));var n=new VY.Mesh(void 0,e);t.add(n);var r=new VY.Mesh;return r.visible=!1,n.add(r),t.__globeObjType="label",t}))},update:function(e){var t=lA(e.labelLat),n=lA(e.labelLng),r=lA(e.labelAltitude),i=lA(e.labelText),a=lA(e.labelSize),o=lA(e.labelRotation),s=lA(e.labelColor),u=lA(e.labelIncludeDot),l=lA(e.labelDotRadius),c=lA(e.labelDotOrientation),h=new Set(["right","top","bottom"]),f=2*Math.PI*CQ/360;e.dataMapper.onUpdateObj((function(d,p){var A=yQ(d.children,2),v=A[0],m=A[1],g=yQ(m.children,1)[0],y=s(p),_=VQ(y);m.material.color.set(zQ(y)),m.material.transparent=_<1,m.material.opacity=_;var b=u(p),x=c(p);!b||!h.has(x)&&(x="bottom");var w=b?+l(p)*f:1e-12;v.scale.x=v.scale.y=w;var T=+a(p)*f;if(m.geometry&&m.geometry.dispose(),m.geometry=new VY.TextGeometry(i(p),{font:e.font,size:T,depth:0,bevelEnabled:!0,bevelThickness:0,bevelSize:0,curveSegments:e.labelResolution}),g.geometry&&g.geometry.dispose(),m.geometry.computeBoundingBox(),g.geometry=uQ(VY.BoxGeometry,xQ((new VY.Vector3).subVectors(m.geometry.boundingBox.max,m.geometry.boundingBox.min).toArray())),"right"!==x&&m.geometry.center(),b){var S=w+T/2;"right"===x&&(m.position.x=S),m.position.y={right:-T/2,top:S+T/2,bottom:-S-T/2}[x]}var E=function(t){var n=d.__currentTargetD=t,r=n.lat,i=n.lng,a=n.alt,o=n.rot,s=n.scale;Object.assign(d.position,PQ(r,i,a)),d.lookAt(e.scene.localToWorld(new VY.Vector3(0,0,0))),d.rotateY(Math.PI),d.rotateZ(-o*Math.PI/180),d.scale.x=d.scale.y=d.scale.z=s},k={lat:+t(p),lng:+n(p),alt:+r(p),rot:+o(p),scale:1},M=d.__currentTargetD||Object.assign({},k,{scale:1e-12});Object.keys(k).some((function(e){return M[e]!==k[e]}))&&(!e.labelsTransitionDuration||e.labelsTransitionDuration<0?E(k):e.tweenGroup.add(new kc(M).to(k,e.labelsTransitionDuration).easing(bc.Quadratic.InOut).onUpdate(E).start()))})).digest(e.labelsData)}}),jY=vQ(vQ({},window.THREE?window.THREE:{}),{},{CSS2DObject:Ll}),GY=_c({props:{htmlElementsData:{default:[]},htmlLat:{default:"lat"},htmlLng:{default:"lng"},htmlAltitude:{default:0},htmlElement:{},htmlElementVisibilityModifier:{triggerUpdate:!1},htmlTransitionDuration:{default:1e3,triggerUpdate:!1},isBehindGlobe:{onChange:function(){this.updateObjVisibility()},triggerUpdate:!1}},methods:{updateObjVisibility:function(e,t){if(e.dataMapper){var n=t?[t]:e.dataMapper.entries().map((function(e){return yQ(e,2)[1]})).filter((function(e){return e}));n.forEach((function(t){var n=!e.isBehindGlobe||!e.isBehindGlobe(t.position);e.htmlElementVisibilityModifier?(t.visible=!0,e.htmlElementVisibilityModifier(t.element,n)):t.visible=n}))}}},init:function(e,t,n){var r=n.tweenGroup;kQ(e),t.scene=e,t.tweenGroup=r,t.dataMapper=new QQ(e,{objBindAttr:"__threeObjHtml"}).onCreateObj((function(e){var n=lA(t.htmlElement)(e),r=new jY.CSS2DObject(n);return r.__globeObjType="html",r}))},update:function(e,t){var n=this,r=lA(e.htmlLat),i=lA(e.htmlLng),a=lA(e.htmlAltitude);t.hasOwnProperty("htmlElement")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj((function(t,o){var s=function(e){var r=t.__currentTargetD=e,i=r.alt,a=r.lat,o=r.lng;Object.assign(t.position,PQ(a,o,i)),n.updateObjVisibility(t)},u={lat:+r(o),lng:+i(o),alt:+a(o)};!e.htmlTransitionDuration||e.htmlTransitionDuration<0||!t.__currentTargetD?s(u):e.tweenGroup.add(new kc(t.__currentTargetD).to(u,e.htmlTransitionDuration).easing(bc.Quadratic.InOut).onUpdate(s).start())})).digest(e.htmlElementsData)}}),HY=window.THREE?window.THREE:{Group:go,Mesh:eo,MeshLambertMaterial:gu,SphereGeometry:uu},WY=_c({props:{objectsData:{default:[]},objectLat:{default:"lat"},objectLng:{default:"lng"},objectAltitude:{default:.01},objectFacesSurface:{default:!0},objectRotation:{},objectThreeObject:{default:new HY.Mesh(new HY.SphereGeometry(1,16,8),new HY.MeshLambertMaterial({color:"#ffffaa",transparent:!0,opacity:.7}))}},init:function(e,t){kQ(e),t.scene=e,t.dataMapper=new QQ(e,{objBindAttr:"__threeObjObject"}).onCreateObj((function(e){var n=lA(t.objectThreeObject)(e);t.objectThreeObject===n&&(n=n.clone());var r=new HY.Group;return r.add(n),r.__globeObjType="object",r}))},update:function(e,t){var n=lA(e.objectLat),r=lA(e.objectLng),i=lA(e.objectAltitude),a=lA(e.objectFacesSurface),o=lA(e.objectRotation);t.hasOwnProperty("objectThreeObject")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj((function(e,t){var s=+n(t),u=+r(t),l=+i(t);Object.assign(e.position,PQ(s,u,l)),a(t)?e.setRotationFromEuler(new Oi(IQ(-s),IQ(u),0,"YXZ")):e.rotation.set(0,0,0);var c=e.children[0],h=o(t);h&&c.setRotationFromEuler(new Oi(IQ(h.x||0),IQ(h.y||0),IQ(h.z||0)))})).digest(e.objectsData)}}),XY=_c({props:{customLayerData:{default:[]},customThreeObject:{},customThreeObjectUpdate:{triggerUpdate:!1}},init:function(e,t){kQ(e),t.scene=e,t.dataMapper=new QQ(e,{objBindAttr:"__threeObjCustom"}).onCreateObj((function(e){var n=lA(t.customThreeObject)(e,CQ);return n&&(t.customThreeObject===n&&(n=n.clone()),n.__globeObjType="custom"),n}))},update:function(e,t){e.customThreeObjectUpdate||kQ(e.scene);var n=lA(e.customThreeObjectUpdate);t.hasOwnProperty("customThreeObject")&&e.dataMapper.clear(),e.dataMapper.onUpdateObj((function(e,t){return n(e,t,CQ)})).digest(e.customLayerData)}}),QY=window.THREE?window.THREE:{Camera:uo,Group:go,Vector2:_r,Vector3:Kr},YY=["globeLayer","pointsLayer","arcsLayer","hexBinLayer","heatmapsLayer","polygonsLayer","hexedPolygonsLayer","pathsLayer","tilesLayer","particlesLayer","ringsLayer","labelsLayer","htmlElementsLayer","objectsLayer","customLayer"],KY=MQ("globeLayer",FQ),ZY=Object.assign.apply(Object,xQ(["globeImageUrl","bumpImageUrl","globeTileEngineUrl","globeTileEngineMaxLevel","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude"].map((function(e){return cQ({},e,KY.linkProp(e))})))),JY=Object.assign.apply(Object,xQ(["globeMaterial"].map((function(e){return cQ({},e,KY.linkMethod(e))})))),$Y=MQ("pointsLayer",JQ),eK=Object.assign.apply(Object,xQ(["pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration"].map((function(e){return cQ({},e,$Y.linkProp(e))})))),tK=MQ("arcsLayer",aY),nK=Object.assign.apply(Object,xQ(["arcsData","arcStartLat","arcStartLng","arcEndLat","arcEndLng","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration"].map((function(e){return cQ({},e,tK.linkProp(e))})))),rK=MQ("hexBinLayer",lY),iK=Object.assign.apply(Object,xQ(["hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration"].map((function(e){return cQ({},e,rK.linkProp(e))})))),aK=MQ("heatmapsLayer",yY),oK=Object.assign.apply(Object,xQ(["heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration"].map((function(e){return cQ({},e,aK.linkProp(e))})))),sK=MQ("hexedPolygonsLayer",SY),uK=Object.assign.apply(Object,xQ(["hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration"].map((function(e){return cQ({},e,sK.linkProp(e))})))),lK=MQ("polygonsLayer",bY),cK=Object.assign.apply(Object,xQ(["polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration"].map((function(e){return cQ({},e,lK.linkProp(e))})))),hK=MQ("pathsLayer",RY),fK=Object.assign.apply(Object,xQ(["pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration"].map((function(e){return cQ({},e,hK.linkProp(e))})))),dK=MQ("tilesLayer",NY),pK=Object.assign.apply(Object,xQ(["tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration"].map((function(e){return cQ({},e,dK.linkProp(e))})))),AK=MQ("particlesLayer",DY),vK=Object.assign.apply(Object,xQ(["particlesData","particlesList","particleLat","particleLng","particleAltitude","particlesSize","particlesSizeAttenuation","particlesColor","particlesTexture"].map((function(e){return cQ({},e,AK.linkProp(e))})))),mK=MQ("ringsLayer",FY),gK=Object.assign.apply(Object,xQ(["ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod"].map((function(e){return cQ({},e,mK.linkProp(e))})))),yK=MQ("labelsLayer",qY),_K=Object.assign.apply(Object,xQ(["labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration"].map((function(e){return cQ({},e,yK.linkProp(e))})))),bK=MQ("htmlElementsLayer",GY),xK=Object.assign.apply(Object,xQ(["htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlElementVisibilityModifier","htmlTransitionDuration"].map((function(e){return cQ({},e,bK.linkProp(e))})))),wK=MQ("objectsLayer",WY),TK=Object.assign.apply(Object,xQ(["objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject"].map((function(e){return cQ({},e,wK.linkProp(e))})))),SK=MQ("customLayer",XY),EK=Object.assign.apply(Object,xQ(["customLayerData","customThreeObject","customThreeObjectUpdate"].map((function(e){return cQ({},e,SK.linkProp(e))})))),kK=_c({props:vQ(vQ(vQ(vQ(vQ(vQ(vQ(vQ(vQ(vQ(vQ(vQ(vQ(vQ(vQ({onGlobeReady:{triggerUpdate:!1},rendererSize:{default:new QY.Vector2(window.innerWidth,window.innerHeight),onChange:function(e,t){t.pathsLayer.rendererSize(e)},triggerUpdate:!1}},ZY),eK),nK),iK),oK),cK),uK),fK),pK),vK),gK),_K),xK),TK),EK),methods:vQ({getGlobeRadius:RQ,getCoords:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return PQ.apply(void 0,n)},toGeoCoords:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return NQ.apply(void 0,n)},setPointOfView:function(e,t){var n,r,i,a,o=t instanceof QY.Camera?t.position:t,s=RQ(),u=void 0;e.scene&&o&&(u=function(t){void 0===n&&(n=o.clone().applyMatrix4(e.scene.matrixWorld.clone().invert())),void 0===r&&(r=n.length()),void 0===i&&(i=Math.sqrt(Math.pow(r,2)-Math.pow(s,2))),void 0===a&&(a=Math.acos(i/r));var u=n.distanceTo(t);if(u<i)return!1;var l=t.length();return Math.acos((Math.pow(r,2)+Math.pow(u,2)-Math.pow(l,2))/(2*r*u))<a});e.layersThatNeedUpdatePov.forEach((function(e){return e.updatePov(t)})),e.layersThatNeedBehindGlobeChecker.forEach((function(e){return e.isBehindGlobe(u)}))},pauseAnimation:function(e){return null!==e.animationFrameRequestId&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),e.pausableLayers.forEach((function(e){var t;return null===(t=e.pauseAnimation)||void 0===t?void 0:t.call(e)})),this},resumeAnimation:function(e){return null===e.animationFrameRequestId&&this._animationCycle(),e.pausableLayers.forEach((function(e){var t;return null===(t=e.resumeAnimation)||void 0===t?void 0:t.call(e)})),this},_animationCycle:function(e){e.animationFrameRequestId=requestAnimationFrame(this._animationCycle),e.tweenGroup.update()},_destructor:function(e){this.pauseAnimation(),e.destructableLayers.forEach((function(e){return e._destructor()}))}},JY),stateInit:function(){var e=new wc,t={tweenGroup:e},n={globeLayer:FQ(t),pointsLayer:JQ(t),arcsLayer:aY(t),hexBinLayer:lY(t),heatmapsLayer:yY(t),polygonsLayer:bY(t),hexedPolygonsLayer:SY(t),pathsLayer:RY(t),tilesLayer:NY(t),particlesLayer:DY(t),ringsLayer:FY(t),labelsLayer:qY(t),htmlElementsLayer:GY(t),objectsLayer:WY(t),customLayer:XY(t)};return vQ(vQ({tweenGroup:e},n),{},{layersThatNeedUpdatePov:Object.values(n).filter((function(e){return e.hasOwnProperty("updatePov")})),layersThatNeedBehindGlobeChecker:Object.values(n).filter((function(e){return e.hasOwnProperty("isBehindGlobe")})),destructableLayers:Object.values(n).filter((function(e){return e.hasOwnProperty("_destructor")})),pausableLayers:Object.values(n).filter((function(e){return e.hasOwnProperty("pauseAnimation")}))})},init:function(e,t,n){var r=n.animateIn,i=void 0===r||r,a=n.waitForGlobeReady,o=void 0===a||a;kQ(e),t.scene=e,t.scene.visible=!1,YY.forEach((function(e){var n=new QY.Group;t.scene.add(n),t[e](n)}));var s=function(){if(i){t.scene.scale.set(1e-6,1e-6,1e-6),t.tweenGroup.add(new kc({k:1e-6}).to({k:1},600).easing(bc.Quadratic.Out).onUpdate((function(e){var n=e.k;return t.scene.scale.set(n,n,n)})).start());var e=new QY.Vector3(0,1,0);t.tweenGroup.add(new kc({rot:2*Math.PI}).to({rot:0},1200).easing(bc.Quintic.Out).onUpdate((function(n){var r=n.rot;return t.scene.setRotationFromAxisAngle(e,r)})).start())}t.scene.visible=!0,t.onGlobeReady&&t.onGlobeReady()};o?t.globeLayer.onReady(s):s(),this._animationCycle()},update:function(e){}});var MK=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(t){function r(){var t;iQ(this,r);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(t=rQ(this,r,[].concat(a))).__kapsuleInstance=uQ(e,[].concat(xQ(n?[t]:[]),a)),t}return dQ(r,t),lQ(r)}(t);return Object.keys(e()).forEach((function(e){return r.prototype[e]=function(){var t,n=(t=this.__kapsuleInstance)[e].apply(t,arguments);return n===this.__kapsuleInstance?this:n}})),r}(kK,(window.THREE?window.THREE:{Group:go}).Group,!0),CK={type:"change"},RK={type:"start"},PK={type:"end"},NK=1e-6,IK=-1,LK=0,DK=1,OK=2,UK=3,BK=4,FK=new _r,zK=new _r,VK=new Kr,qK=new Kr,jK=new Kr,GK=new Yr,HK=new Kr,WK=new Kr,XK=new Kr,QK=new Kr,YK=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this,e,i)).screen={left:0,top:0,width:0,height:0},r.rotateSpeed=1,r.zoomSpeed=1.2,r.panSpeed=.3,r.noRotate=!1,r.noZoom=!1,r.noPan=!1,r.staticMoving=!1,r.dynamicDampingFactor=.2,r.minDistance=0,r.maxDistance=1/0,r.minZoom=0,r.maxZoom=1/0,r.keys=["KeyA","KeyS","KeyD"],r.mouseButtons={LEFT:pt,MIDDLE:At,RIGHT:vt},r.target=new Kr,r.state=IK,r.keyState=IK,r._lastPosition=new Kr,r._lastZoom=1,r._touchZoomDistanceStart=0,r._touchZoomDistanceEnd=0,r._lastAngle=0,r._eye=new Kr,r._movePrev=new _r,r._moveCurr=new _r,r._lastAxis=new Kr,r._zoomStart=new _r,r._zoomEnd=new _r,r._panStart=new _r,r._panEnd=new _r,r._pointers=[],r._pointerPositions={},r._onPointerMove=ZK.bind(y(r)),r._onPointerDown=KK.bind(y(r)),r._onPointerUp=JK.bind(y(r)),r._onPointerCancel=$K.bind(y(r)),r._onContextMenu=oZ.bind(y(r)),r._onMouseWheel=aZ.bind(y(r)),r._onKeyDown=tZ.bind(y(r)),r._onKeyUp=eZ.bind(y(r)),r._onTouchStart=sZ.bind(y(r)),r._onTouchMove=uZ.bind(y(r)),r._onTouchEnd=lZ.bind(y(r)),r._onMouseDown=nZ.bind(y(r)),r._onMouseMove=rZ.bind(y(r)),r._onMouseUp=iZ.bind(y(r)),r._target0=r.target.clone(),r._position0=r.object.position.clone(),r._up0=r.object.up.clone(),r._zoom0=r.object.zoom,null!==i&&(r.connect(i),r.handleResize()),r.update(),r}return p(n,[{key:"connect",value:function(e){ht(m(n.prototype),"connect",this).call(this,e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}},{key:"disconnect",value:function(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto"}},{key:"dispose",value:function(){this.disconnect()}},{key:"handleResize",value:function(){var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}},{key:"update",value:function(){this._eye.subVectors(this.object.position,this.target),this.noRotate||this._rotateCamera(),this.noZoom||this._zoomCamera(),this.noPan||this._panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this._checkDistances(),this.object.lookAt(this.target),this._lastPosition.distanceToSquared(this.object.position)>NK&&(this.dispatchEvent(CK),this._lastPosition.copy(this.object.position))):this.object.isOrthographicCamera?(this.object.lookAt(this.target),(this._lastPosition.distanceToSquared(this.object.position)>NK||this._lastZoom!==this.object.zoom)&&(this.dispatchEvent(CK),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type.")}},{key:"reset",value:function(){this.state=IK,this.keyState=IK,this.target.copy(this._target0),this.object.position.copy(this._position0),this.object.up.copy(this._up0),this.object.zoom=this._zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(CK),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom}},{key:"_panCamera",value:function(){if(zK.copy(this._panEnd).sub(this._panStart),zK.lengthSq()){if(this.object.isOrthographicCamera){var e=(this.object.right-this.object.left)/this.object.zoom/this.domElement.clientWidth,t=(this.object.top-this.object.bottom)/this.object.zoom/this.domElement.clientWidth;zK.x*=e,zK.y*=t}zK.multiplyScalar(this._eye.length()*this.panSpeed),qK.copy(this._eye).cross(this.object.up).setLength(zK.x),qK.add(VK.copy(this.object.up).setLength(zK.y)),this.object.position.add(qK),this.target.add(qK),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(zK.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}},{key:"_rotateCamera",value:function(){QK.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0);var e=QK.length();e?(this._eye.copy(this.object.position).sub(this.target),HK.copy(this._eye).normalize(),WK.copy(this.object.up).normalize(),XK.crossVectors(WK,HK).normalize(),WK.setLength(this._moveCurr.y-this._movePrev.y),XK.setLength(this._moveCurr.x-this._movePrev.x),QK.copy(WK.add(XK)),jK.crossVectors(QK,this._eye).normalize(),e*=this.rotateSpeed,GK.setFromAxisAngle(jK,e),this._eye.applyQuaternion(GK),this.object.up.applyQuaternion(GK),this._lastAxis.copy(jK),this._lastAngle=e):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),GK.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(GK),this.object.up.applyQuaternion(GK)),this._movePrev.copy(this._moveCurr)}},{key:"_zoomCamera",value:function(){var e;this.state===BK?(e=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=yr.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(1!==(e=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed)&&e>0&&(this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=yr.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor)}},{key:"_getMouseOnScreen",value:function(e,t){return FK.set((e-this.screen.left)/this.screen.width,(t-this.screen.top)/this.screen.height),FK}},{key:"_getMouseOnCircle",value:function(e,t){return FK.set((e-.5*this.screen.width-this.screen.left)/(.5*this.screen.width),(this.screen.height+2*(this.screen.top-t))/this.screen.width),FK}},{key:"_addPointer",value:function(e){this._pointers.push(e)}},{key:"_removePointer",value:function(e){delete this._pointerPositions[e.pointerId];for(var t=0;t<this._pointers.length;t++)if(this._pointers[t].pointerId==e.pointerId)return void this._pointers.splice(t,1)}},{key:"_trackPointer",value:function(e){var t=this._pointerPositions[e.pointerId];void 0===t&&(t=new _r,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}},{key:"_getSecondPointerPosition",value:function(e){var t=e.pointerId===this._pointers[0].pointerId?this._pointers[1]:this._pointers[0];return this._pointerPositions[t.pointerId]}},{key:"_checkDistances",value:function(){this.noZoom&&this.noPan||(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}}]),n}(Nl);function KK(e){!1!==this.enabled&&(0===this._pointers.length&&(this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._addPointer(e),"touch"===e.pointerType?this._onTouchStart(e):this._onMouseDown(e))}function ZK(e){!1!==this.enabled&&("touch"===e.pointerType?this._onTouchMove(e):this._onMouseMove(e))}function JK(e){!1!==this.enabled&&("touch"===e.pointerType?this._onTouchEnd(e):this._onMouseUp(),this._removePointer(e),0===this._pointers.length&&(this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp)))}function $K(e){this._removePointer(e)}function eZ(){!1!==this.enabled&&(this.keyState=IK,window.addEventListener("keydown",this._onKeyDown))}function tZ(e){!1!==this.enabled&&(window.removeEventListener("keydown",this._onKeyDown),this.keyState===IK&&(e.code!==this.keys[LK]||this.noRotate?e.code!==this.keys[DK]||this.noZoom?e.code!==this.keys[OK]||this.noPan||(this.keyState=OK):this.keyState=DK:this.keyState=LK))}function nZ(e){var t;switch(e.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case At:this.state=DK;break;case pt:this.state=LK;break;case vt:this.state=OK;break;default:this.state=IK}var n=this.keyState!==IK?this.keyState:this.state;n!==LK||this.noRotate?n!==DK||this.noZoom?n!==OK||this.noPan||(this._panStart.copy(this._getMouseOnScreen(e.pageX,e.pageY)),this._panEnd.copy(this._panStart)):(this._zoomStart.copy(this._getMouseOnScreen(e.pageX,e.pageY)),this._zoomEnd.copy(this._zoomStart)):(this._moveCurr.copy(this._getMouseOnCircle(e.pageX,e.pageY)),this._movePrev.copy(this._moveCurr)),this.dispatchEvent(RK)}function rZ(e){var t=this.keyState!==IK?this.keyState:this.state;t!==LK||this.noRotate?t!==DK||this.noZoom?t!==OK||this.noPan||this._panEnd.copy(this._getMouseOnScreen(e.pageX,e.pageY)):this._zoomEnd.copy(this._getMouseOnScreen(e.pageX,e.pageY)):(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(e.pageX,e.pageY)))}function iZ(){this.state=IK,this.dispatchEvent(PK)}function aZ(e){if(!1!==this.enabled&&!0!==this.noZoom){switch(e.preventDefault(),e.deltaMode){case 2:this._zoomStart.y-=.025*e.deltaY;break;case 1:this._zoomStart.y-=.01*e.deltaY;break;default:this._zoomStart.y-=25e-5*e.deltaY}this.dispatchEvent(RK),this.dispatchEvent(PK)}}function oZ(e){!1!==this.enabled&&e.preventDefault()}function sZ(e){if(this._trackPointer(e),1===this._pointers.length)this.state=UK,this._moveCurr.copy(this._getMouseOnCircle(this._pointers[0].pageX,this._pointers[0].pageY)),this._movePrev.copy(this._moveCurr);else{this.state=BK;var t=this._pointers[0].pageX-this._pointers[1].pageX,n=this._pointers[0].pageY-this._pointers[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(t*t+n*n);var r=(this._pointers[0].pageX+this._pointers[1].pageX)/2,i=(this._pointers[0].pageY+this._pointers[1].pageY)/2;this._panStart.copy(this._getMouseOnScreen(r,i)),this._panEnd.copy(this._panStart)}this.dispatchEvent(RK)}function uZ(e){if(this._trackPointer(e),1===this._pointers.length)this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(e.pageX,e.pageY));else{var t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y;this._touchZoomDistanceEnd=Math.sqrt(n*n+r*r);var i=(e.pageX+t.x)/2,a=(e.pageY+t.y)/2;this._panEnd.copy(this._getMouseOnScreen(i,a))}}function lZ(e){switch(this._pointers.length){case 0:this.state=IK;break;case 1:this.state=UK,this._moveCurr.copy(this._getMouseOnCircle(e.pageX,e.pageY)),this._movePrev.copy(this._moveCurr);break;case 2:this.state=BK;for(var t=0;t<this._pointers.length;t++)if(this._pointers[t].pointerId!==e.pointerId){var n=this._pointerPositions[this._pointers[t].pointerId];this._moveCurr.copy(this._getMouseOnCircle(n.x,n.y)),this._movePrev.copy(this._moveCurr);break}}this.dispatchEvent(PK)}var cZ={type:"change"},hZ={type:"start"},fZ={type:"end"},dZ=new Si,pZ=new Po,AZ=Math.cos(70*yr.DEG2RAD),vZ=new Kr,mZ=2*Math.PI,gZ=-1,yZ=0,_Z=1,bZ=2,xZ=3,wZ=4,TZ=5,SZ=6,EZ=1e-6,kZ=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this,e,i)).state=gZ,r.target=new Kr,r.cursor=new Kr,r.minDistance=0,r.maxDistance=1/0,r.minZoom=0,r.maxZoom=1/0,r.minTargetRadius=0,r.maxTargetRadius=1/0,r.minPolarAngle=0,r.maxPolarAngle=Math.PI,r.minAzimuthAngle=-1/0,r.maxAzimuthAngle=1/0,r.enableDamping=!1,r.dampingFactor=.05,r.enableZoom=!0,r.zoomSpeed=1,r.enableRotate=!0,r.rotateSpeed=1,r.keyRotateSpeed=1,r.enablePan=!0,r.panSpeed=1,r.screenSpacePanning=!0,r.keyPanSpeed=7,r.zoomToCursor=!1,r.autoRotate=!1,r.autoRotateSpeed=2,r.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},r.mouseButtons={LEFT:pt,MIDDLE:At,RIGHT:vt},r.touches={ONE:mt,TWO:yt},r.target0=r.target.clone(),r.position0=r.object.position.clone(),r.zoom0=r.object.zoom,r._domElementKeyEvents=null,r._lastPosition=new Kr,r._lastQuaternion=new Yr,r._lastTargetPosition=new Kr,r._quat=(new Yr).setFromUnitVectors(e.up,new Kr(0,1,0)),r._quatInverse=r._quat.clone().invert(),r._spherical=new El,r._sphericalDelta=new El,r._scale=1,r._panOffset=new Kr,r._rotateStart=new _r,r._rotateEnd=new _r,r._rotateDelta=new _r,r._panStart=new _r,r._panEnd=new _r,r._panDelta=new _r,r._dollyStart=new _r,r._dollyEnd=new _r,r._dollyDelta=new _r,r._dollyDirection=new Kr,r._mouse=new _r,r._performCursorZoom=!1,r._pointers=[],r._pointerPositions={},r._controlActive=!1,r._onPointerMove=CZ.bind(y(r)),r._onPointerDown=MZ.bind(y(r)),r._onPointerUp=RZ.bind(y(r)),r._onContextMenu=UZ.bind(y(r)),r._onMouseWheel=IZ.bind(y(r)),r._onKeyDown=LZ.bind(y(r)),r._onTouchStart=DZ.bind(y(r)),r._onTouchMove=OZ.bind(y(r)),r._onMouseDown=PZ.bind(y(r)),r._onMouseMove=NZ.bind(y(r)),r._interceptControlDown=BZ.bind(y(r)),r._interceptControlUp=FZ.bind(y(r)),null!==r.domElement&&r.connect(r.domElement),r.update(),r}return p(n,[{key:"connect",value:function(e){ht(m(n.prototype),"connect",this).call(this,e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}},{key:"disconnect",value:function(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}},{key:"dispose",value:function(){this.disconnect()}},{key:"getPolarAngle",value:function(){return this._spherical.phi}},{key:"getAzimuthalAngle",value:function(){return this._spherical.theta}},{key:"getDistance",value:function(){return this.object.position.distanceTo(this.target)}},{key:"listenToKeyEvents",value:function(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}},{key:"stopListenToKeyEvents",value:function(){null!==this._domElementKeyEvents&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}},{key:"saveState",value:function(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}},{key:"reset",value:function(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(cZ),this.update(),this.state=gZ}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.object.position;vZ.copy(t).sub(this.target),vZ.applyQuaternion(this._quat),this._spherical.setFromVector3(vZ),this.autoRotate&&this.state===gZ&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);var n=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(n)&&isFinite(r)&&(n<-Math.PI?n+=mZ:n>Math.PI&&(n-=mZ),r<-Math.PI?r+=mZ:r>Math.PI&&(r-=mZ),this._spherical.theta=n<=r?Math.max(n,Math.min(r,this._spherical.theta)):this._spherical.theta>(n+r)/2?Math.max(n,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),!0===this.enableDamping?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);var i=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{var a=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),i=a!=this._spherical.radius}if(vZ.setFromSpherical(this._spherical),vZ.applyQuaternion(this._quatInverse),t.copy(this.target).add(vZ),this.object.lookAt(this.target),!0===this.enableDamping?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){var o=null;if(this.object.isPerspectiveCamera){var s=vZ.length(),u=s-(o=this._clampDistance(s*this._scale));this.object.position.addScaledVector(this._dollyDirection,u),this.object.updateMatrixWorld(),i=!!u}else if(this.object.isOrthographicCamera){var l=new Kr(this._mouse.x,this._mouse.y,0);l.unproject(this.object);var c=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),i=c!==this.object.zoom;var h=new Kr(this._mouse.x,this._mouse.y,0);h.unproject(this.object),this.object.position.sub(h).add(l),this.object.updateMatrixWorld(),o=vZ.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;null!==o&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(o).add(this.object.position):(dZ.origin.copy(this.object.position),dZ.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(dZ.direction))<AZ?this.object.lookAt(this.target):(pZ.setFromNormalAndCoplanarPoint(this.object.up,this.target),dZ.intersectPlane(pZ,this.target))))}else if(this.object.isOrthographicCamera){var f=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),f!==this.object.zoom&&(this.object.updateProjectionMatrix(),i=!0)}return this._scale=1,this._performCursorZoom=!1,!!(i||this._lastPosition.distanceToSquared(this.object.position)>EZ||8*(1-this._lastQuaternion.dot(this.object.quaternion))>EZ||this._lastTargetPosition.distanceToSquared(this.target)>EZ)&&(this.dispatchEvent(cZ),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0)}},{key:"_getAutoRotationAngle",value:function(e){return null!==e?mZ/60*this.autoRotateSpeed*e:mZ/60/60*this.autoRotateSpeed}},{key:"_getZoomScale",value:function(e){var t=Math.abs(.01*e);return Math.pow(.95,this.zoomSpeed*t)}},{key:"_rotateLeft",value:function(e){this._sphericalDelta.theta-=e}},{key:"_rotateUp",value:function(e){this._sphericalDelta.phi-=e}},{key:"_panLeft",value:function(e,t){vZ.setFromMatrixColumn(t,0),vZ.multiplyScalar(-e),this._panOffset.add(vZ)}},{key:"_panUp",value:function(e,t){!0===this.screenSpacePanning?vZ.setFromMatrixColumn(t,1):(vZ.setFromMatrixColumn(t,0),vZ.crossVectors(this.object.up,vZ)),vZ.multiplyScalar(e),this._panOffset.add(vZ)}},{key:"_pan",value:function(e,t){var n=this.domElement;if(this.object.isPerspectiveCamera){var r=this.object.position;vZ.copy(r).sub(this.target);var i=vZ.length();i*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*i/n.clientHeight,this.object.matrix),this._panUp(2*t*i/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}},{key:"_dollyOut",value:function(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}},{key:"_dollyIn",value:function(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}},{key:"_updateZoomParameters",value:function(e,t){if(this.zoomToCursor){this._performCursorZoom=!0;var n=this.domElement.getBoundingClientRect(),r=e-n.left,i=t-n.top,a=n.width,o=n.height;this._mouse.x=r/a*2-1,this._mouse.y=-i/o*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}}},{key:"_clampDistance",value:function(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}},{key:"_handleMouseDownRotate",value:function(e){this._rotateStart.set(e.clientX,e.clientY)}},{key:"_handleMouseDownDolly",value:function(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}},{key:"_handleMouseDownPan",value:function(e){this._panStart.set(e.clientX,e.clientY)}},{key:"_handleMouseMoveRotate",value:function(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);var t=this.domElement;this._rotateLeft(mZ*this._rotateDelta.x/t.clientHeight),this._rotateUp(mZ*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}},{key:"_handleMouseMoveDolly",value:function(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}},{key:"_handleMouseMovePan",value:function(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}},{key:"_handleMouseWheel",value:function(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}},{key:"_handleKeyDown",value:function(e){var t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(mZ*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-mZ*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(mZ*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-mZ*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),this.update())}},{key:"_handleTouchStartRotate",value:function(e){if(1===this._pointers.length)this._rotateStart.set(e.pageX,e.pageY);else{var t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateStart.set(n,r)}}},{key:"_handleTouchStartPan",value:function(e){if(1===this._pointers.length)this._panStart.set(e.pageX,e.pageY);else{var t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panStart.set(n,r)}}},{key:"_handleTouchStartDolly",value:function(e){var t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,i=Math.sqrt(n*n+r*r);this._dollyStart.set(0,i)}},{key:"_handleTouchStartDollyPan",value:function(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}},{key:"_handleTouchStartDollyRotate",value:function(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}},{key:"_handleTouchMoveRotate",value:function(e){if(1==this._pointers.length)this._rotateEnd.set(e.pageX,e.pageY);else{var t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateEnd.set(n,r)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);var i=this.domElement;this._rotateLeft(mZ*this._rotateDelta.x/i.clientHeight),this._rotateUp(mZ*this._rotateDelta.y/i.clientHeight),this._rotateStart.copy(this._rotateEnd)}},{key:"_handleTouchMovePan",value:function(e){if(1===this._pointers.length)this._panEnd.set(e.pageX,e.pageY);else{var t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panEnd.set(n,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}},{key:"_handleTouchMoveDolly",value:function(e){var t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,i=Math.sqrt(n*n+r*r);this._dollyEnd.set(0,i),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);var a=.5*(e.pageX+t.x),o=.5*(e.pageY+t.y);this._updateZoomParameters(a,o)}},{key:"_handleTouchMoveDollyPan",value:function(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}},{key:"_handleTouchMoveDollyRotate",value:function(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}},{key:"_addPointer",value:function(e){this._pointers.push(e.pointerId)}},{key:"_removePointer",value:function(e){delete this._pointerPositions[e.pointerId];for(var t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return void this._pointers.splice(t,1)}},{key:"_isTrackingPointer",value:function(e){for(var t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}},{key:"_trackPointer",value:function(e){var t=this._pointerPositions[e.pointerId];void 0===t&&(t=new _r,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}},{key:"_getSecondPointerPosition",value:function(e){var t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}},{key:"_customWheelEvent",value:function(e){var t=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}]),n}(Nl);function MZ(e){!1!==this.enabled&&(0===this._pointers.length&&(this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._isTrackingPointer(e)||(this._addPointer(e),"touch"===e.pointerType?this._onTouchStart(e):this._onMouseDown(e)))}function CZ(e){!1!==this.enabled&&("touch"===e.pointerType?this._onTouchMove(e):this._onMouseMove(e))}function RZ(e){switch(this._removePointer(e),this._pointers.length){case 0:this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(fZ),this.state=gZ;break;case 1:var t=this._pointers[0],n=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:n.x,pageY:n.y})}}function PZ(e){var t;switch(e.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case At:if(!1===this.enableZoom)return;this._handleMouseDownDolly(e),this.state=_Z;break;case pt:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===this.enablePan)return;this._handleMouseDownPan(e),this.state=bZ}else{if(!1===this.enableRotate)return;this._handleMouseDownRotate(e),this.state=yZ}break;case vt:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===this.enableRotate)return;this._handleMouseDownRotate(e),this.state=yZ}else{if(!1===this.enablePan)return;this._handleMouseDownPan(e),this.state=bZ}break;default:this.state=gZ}this.state!==gZ&&this.dispatchEvent(hZ)}function NZ(e){switch(this.state){case yZ:if(!1===this.enableRotate)return;this._handleMouseMoveRotate(e);break;case _Z:if(!1===this.enableZoom)return;this._handleMouseMoveDolly(e);break;case bZ:if(!1===this.enablePan)return;this._handleMouseMovePan(e)}}function IZ(e){!1!==this.enabled&&!1!==this.enableZoom&&this.state===gZ&&(e.preventDefault(),this.dispatchEvent(hZ),this._handleMouseWheel(this._customWheelEvent(e)),this.dispatchEvent(fZ))}function LZ(e){!1!==this.enabled&&this._handleKeyDown(e)}function DZ(e){switch(this._trackPointer(e),this._pointers.length){case 1:switch(this.touches.ONE){case mt:if(!1===this.enableRotate)return;this._handleTouchStartRotate(e),this.state=xZ;break;case gt:if(!1===this.enablePan)return;this._handleTouchStartPan(e),this.state=wZ;break;default:this.state=gZ}break;case 2:switch(this.touches.TWO){case yt:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchStartDollyPan(e),this.state=TZ;break;case _t:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchStartDollyRotate(e),this.state=SZ;break;default:this.state=gZ}break;default:this.state=gZ}this.state!==gZ&&this.dispatchEvent(hZ)}function OZ(e){switch(this._trackPointer(e),this.state){case xZ:if(!1===this.enableRotate)return;this._handleTouchMoveRotate(e),this.update();break;case wZ:if(!1===this.enablePan)return;this._handleTouchMovePan(e),this.update();break;case TZ:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchMoveDollyPan(e),this.update();break;case SZ:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchMoveDollyRotate(e),this.update();break;default:this.state=gZ}}function UZ(e){!1!==this.enabled&&e.preventDefault()}function BZ(e){"Control"===e.key&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function FZ(e){"Control"===e.key&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}var zZ={type:"change"},VZ=1e-6,qZ=new Yr,jZ=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return c(this,n),(r=t.call(this,e,i)).movementSpeed=1,r.rollSpeed=.005,r.dragToLook=!1,r.autoForward=!1,r._moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},r._moveVector=new Kr(0,0,0),r._rotationVector=new Kr(0,0,0),r._lastQuaternion=new Yr,r._lastPosition=new Kr,r._status=0,r._onKeyDown=GZ.bind(y(r)),r._onKeyUp=HZ.bind(y(r)),r._onPointerMove=XZ.bind(y(r)),r._onPointerDown=WZ.bind(y(r)),r._onPointerUp=QZ.bind(y(r)),r._onPointerCancel=YZ.bind(y(r)),r._onContextMenu=KZ.bind(y(r)),null!==i&&r.connect(i),r}return p(n,[{key:"connect",value:function(e){ht(m(n.prototype),"connect",this).call(this,e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu)}},{key:"disconnect",value:function(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu)}},{key:"dispose",value:function(){this.disconnect()}},{key:"update",value:function(e){if(!1!==this.enabled){var t=this.object,n=e*this.movementSpeed,r=e*this.rollSpeed;t.translateX(this._moveVector.x*n),t.translateY(this._moveVector.y*n),t.translateZ(this._moveVector.z*n),qZ.set(this._rotationVector.x*r,this._rotationVector.y*r,this._rotationVector.z*r,1).normalize(),t.quaternion.multiply(qZ),(this._lastPosition.distanceToSquared(t.position)>VZ||8*(1-this._lastQuaternion.dot(t.quaternion))>VZ)&&(this.dispatchEvent(zZ),this._lastQuaternion.copy(t.quaternion),this._lastPosition.copy(t.position))}}},{key:"_updateMovementVector",value:function(){var e=this._moveState.forward||this.autoForward&&!this._moveState.back?1:0;this._moveVector.x=-this._moveState.left+this._moveState.right,this._moveVector.y=-this._moveState.down+this._moveState.up,this._moveVector.z=-e+this._moveState.back}},{key:"_updateRotationVector",value:function(){this._rotationVector.x=-this._moveState.pitchDown+this._moveState.pitchUp,this._rotationVector.y=-this._moveState.yawRight+this._moveState.yawLeft,this._rotationVector.z=-this._moveState.rollRight+this._moveState.rollLeft}},{key:"_getContainerDimensions",value:function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}}}]),n}(Nl);function GZ(e){if(!e.altKey&&!1!==this.enabled){switch(e.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this._moveState.forward=1;break;case"KeyS":this._moveState.back=1;break;case"KeyA":this._moveState.left=1;break;case"KeyD":this._moveState.right=1;break;case"KeyR":this._moveState.up=1;break;case"KeyF":this._moveState.down=1;break;case"ArrowUp":this._moveState.pitchUp=1;break;case"ArrowDown":this._moveState.pitchDown=1;break;case"ArrowLeft":this._moveState.yawLeft=1;break;case"ArrowRight":this._moveState.yawRight=1;break;case"KeyQ":this._moveState.rollLeft=1;break;case"KeyE":this._moveState.rollRight=1}this._updateMovementVector(),this._updateRotationVector()}}function HZ(e){if(!1!==this.enabled){switch(e.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this._moveState.forward=0;break;case"KeyS":this._moveState.back=0;break;case"KeyA":this._moveState.left=0;break;case"KeyD":this._moveState.right=0;break;case"KeyR":this._moveState.up=0;break;case"KeyF":this._moveState.down=0;break;case"ArrowUp":this._moveState.pitchUp=0;break;case"ArrowDown":this._moveState.pitchDown=0;break;case"ArrowLeft":this._moveState.yawLeft=0;break;case"ArrowRight":this._moveState.yawRight=0;break;case"KeyQ":this._moveState.rollLeft=0;break;case"KeyE":this._moveState.rollRight=0}this._updateMovementVector(),this._updateRotationVector()}}function WZ(e){if(!1!==this.enabled)if(this.dragToLook)this._status++;else{switch(e.button){case 0:this._moveState.forward=1;break;case 2:this._moveState.back=1}this._updateMovementVector()}}function XZ(e){if(!1!==this.enabled&&(!this.dragToLook||this._status>0)){var t=this._getContainerDimensions(),n=t.size[0]/2,r=t.size[1]/2;this._moveState.yawLeft=-(e.pageX-t.offset[0]-n)/n,this._moveState.pitchDown=(e.pageY-t.offset[1]-r)/r,this._updateRotationVector()}}function QZ(e){if(!1!==this.enabled){if(this.dragToLook)this._status--,this._moveState.yawLeft=this._moveState.pitchDown=0;else{switch(e.button){case 0:this._moveState.forward=0;break;case 2:this._moveState.back=0}this._updateMovementVector()}this._updateRotationVector()}}function YZ(){!1!==this.enabled&&(this.dragToLook?(this._status=0,this._moveState.yawLeft=this._moveState.pitchDown=0):(this._moveState.forward=0,this._moveState.back=0,this._updateMovementVector()),this._updateRotationVector())}function KZ(e){!1!==this.enabled&&e.preventDefault()}var ZZ={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\n\t\t}"},JZ=function(){function e(){c(this,e),this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}return p(e,[{key:"setSize",value:function(){}},{key:"render",value:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}},{key:"dispose",value:function(){}}]),e}(),$Z=new nl(-1,1,1,-1,0,1),eJ=new(function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this)).setAttribute("position",new La([-1,3,0,-1,-1,0,3,-1,0],3)),e.setAttribute("uv",new La([0,2,0,0,2,0],2)),e}return p(n)}(qa)),tJ=function(){function e(t){c(this,e),this._mesh=new eo(eJ,t)}return p(e,[{key:"dispose",value:function(){this._mesh.geometry.dispose()}},{key:"render",value:function(e){e.render(this._mesh,$Z)}},{key:"material",get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}]),e}(),nJ=function(e){v(n,e);var t=b(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"tDiffuse";return c(this,n),(r=t.call(this)).textureID=i,r.uniforms=null,r.material=null,e instanceof so?(r.uniforms=e.uniforms,r.material=e):e&&(r.uniforms=oo.clone(e.uniforms),r.material=new so({name:void 0!==e.name?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:r.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),r._fsQuad=new tJ(r.material),r}return p(n,[{key:"render",value:function(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this._fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this._fsQuad.render(e))}},{key:"dispose",value:function(){this.material.dispose(),this._fsQuad.dispose()}}]),n}(JZ),rJ=function(e){v(n,e);var t=b(n);function n(e,r){var i;return c(this,n),(i=t.call(this)).scene=e,i.camera=r,i.clear=!0,i.needsSwap=!1,i.inverse=!1,i}return p(n,[{key:"render",value:function(e,t,n){var r,i,a=e.getContext(),o=e.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0),this.inverse?(r=0,i=1):(r=1,i=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),o.buffers.stencil.setFunc(a.ALWAYS,r,4294967295),o.buffers.stencil.setClear(i),o.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.color.setMask(!0),o.buffers.depth.setMask(!0),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(a.EQUAL,1,4294967295),o.buffers.stencil.setOp(a.KEEP,a.KEEP,a.KEEP),o.buffers.stencil.setLocked(!0)}}]),n}(JZ),iJ=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this)).needsSwap=!1,e}return p(n,[{key:"render",value:function(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}]),n}(JZ),aJ=function(){function e(t,n){if(c(this,e),this.renderer=t,this._pixelRatio=t.getPixelRatio(),void 0===n){var r=t.getSize(new _r);this._width=r.width,this._height=r.height,(n=new Wr(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Xt})).texture.name="EffectComposer.rt1"}else this._width=n.width,this._height=n.height;this.renderTarget1=n,this.renderTarget2=n.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new nJ(ZZ),this.copyPass.material.blending=0,this.clock=new hl}return p(e,[{key:"swapBuffers",value:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}},{key:"addPass",value:function(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}},{key:"insertPass",value:function(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}},{key:"removePass",value:function(e){var t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}},{key:"isLastEnabledPass",value:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}},{key:"render",value:function(e){void 0===e&&(e=this.clock.getDelta());for(var t=this.renderer.getRenderTarget(),n=!1,r=0,i=this.passes.length;r<i;r++){var a=this.passes[r];if(!1!==a.enabled){if(a.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),a.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),a.needsSwap){if(n){var o=this.renderer.getContext(),s=this.renderer.state.buffers.stencil;s.setFunc(o.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),s.setFunc(o.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==rJ&&(a instanceof rJ?n=!0:a instanceof iJ&&(n=!1))}}this.renderer.setRenderTarget(t)}},{key:"reset",value:function(e){if(void 0===e){var t=this.renderer.getSize(new _r);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}},{key:"setSize",value:function(e,t){this._width=e,this._height=t;var n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(var i=0;i<this.passes.length;i++)this.passes[i].setSize(n,r)}},{key:"setPixelRatio",value:function(e){this._pixelRatio=e,this.setSize(this._width,this._height)}},{key:"dispose",value:function(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}]),e}(),oJ=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return c(this,n),(i=t.call(this)).scene=e,i.camera=r,i.overrideMaterial=a,i.clearColor=o,i.clearAlpha=s,i.clear=!0,i.clearDepth=!1,i.needsSwap=!1,i._oldClearColor=new ga,i}return p(n,[{key:"render",value:function(e,t,n){var r,i,a=e.autoClear;e.autoClear=!1,null!==this.overrideMaterial&&(i=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),null!==this.clearColor&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),null!==this.clearAlpha&&(r=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),1==this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),!0===this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),null!==this.clearColor&&e.setClearColor(this._oldClearColor),null!==this.clearAlpha&&e.setClearAlpha(r),null!==this.overrideMaterial&&(this.scene.overrideMaterial=i),e.autoClear=a}}]),n}(JZ);function sJ(){return sJ=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sJ.apply(this,arguments)}function uJ(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,A(e,t)}var lJ=function(e){function t(t){return y(e.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+t+" for more information.")||this)}return uJ(t,e),t}(E(Error));function cJ(e,t){return e.substr(-t.length)===t}var hJ=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/;function fJ(e){return"string"!==typeof e?e:e.match(hJ)?parseFloat(e):e}var dJ=function(e){return function(t,n){void 0===n&&(n="16px");var r=t,i=n;if("string"===typeof t){if(!cJ(t,"px"))throw new lJ(69,e,t);r=fJ(t)}if("string"===typeof n){if(!cJ(n,"px"))throw new lJ(70,e,n);i=fJ(n)}if("string"===typeof r)throw new lJ(71,t,e);if("string"===typeof i)throw new lJ(72,n,e);return""+r/i+e}};dJ("em");dJ("rem");function pJ(e){return Math.round(255*e)}function AJ(e,t,n){return pJ(e)+","+pJ(t)+","+pJ(n)}function vJ(e,t,n,r){if(void 0===r&&(r=AJ),0===t)return r(n,n,n);var i=(e%360+360)%360/60,a=(1-Math.abs(2*n-1))*t,o=a*(1-Math.abs(i%2-1)),s=0,u=0,l=0;i>=0&&i<1?(s=a,u=o):i>=1&&i<2?(s=o,u=a):i>=2&&i<3?(u=a,l=o):i>=3&&i<4?(u=o,l=a):i>=4&&i<5?(s=o,l=a):i>=5&&i<6&&(s=a,l=o);var c=n-a/2;return r(s+c,u+c,l+c)}var mJ={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};var gJ=/^#[a-fA-F0-9]{6}$/,yJ=/^#[a-fA-F0-9]{8}$/,_J=/^#[a-fA-F0-9]{3}$/,bJ=/^#[a-fA-F0-9]{4}$/,xJ=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,wJ=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,TJ=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,SJ=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function EJ(e){if("string"!==typeof e)throw new lJ(3);var t=function(e){if("string"!==typeof e)return e;var t=e.toLowerCase();return mJ[t]?"#"+mJ[t]:e}(e);if(t.match(gJ))return{red:parseInt(""+t[1]+t[2],16),green:parseInt(""+t[3]+t[4],16),blue:parseInt(""+t[5]+t[6],16)};if(t.match(yJ)){var n=parseFloat((parseInt(""+t[7]+t[8],16)/255).toFixed(2));return{red:parseInt(""+t[1]+t[2],16),green:parseInt(""+t[3]+t[4],16),blue:parseInt(""+t[5]+t[6],16),alpha:n}}if(t.match(_J))return{red:parseInt(""+t[1]+t[1],16),green:parseInt(""+t[2]+t[2],16),blue:parseInt(""+t[3]+t[3],16)};if(t.match(bJ)){var r=parseFloat((parseInt(""+t[4]+t[4],16)/255).toFixed(2));return{red:parseInt(""+t[1]+t[1],16),green:parseInt(""+t[2]+t[2],16),blue:parseInt(""+t[3]+t[3],16),alpha:r}}var i=xJ.exec(t);if(i)return{red:parseInt(""+i[1],10),green:parseInt(""+i[2],10),blue:parseInt(""+i[3],10)};var a=wJ.exec(t.substring(0,50));if(a)return{red:parseInt(""+a[1],10),green:parseInt(""+a[2],10),blue:parseInt(""+a[3],10),alpha:parseFloat(""+a[4])>1?parseFloat(""+a[4])/100:parseFloat(""+a[4])};var o=TJ.exec(t);if(o){var s="rgb("+vJ(parseInt(""+o[1],10),parseInt(""+o[2],10)/100,parseInt(""+o[3],10)/100)+")",u=xJ.exec(s);if(!u)throw new lJ(4,t,s);return{red:parseInt(""+u[1],10),green:parseInt(""+u[2],10),blue:parseInt(""+u[3],10)}}var l=SJ.exec(t.substring(0,50));if(l){var c="rgb("+vJ(parseInt(""+l[1],10),parseInt(""+l[2],10)/100,parseInt(""+l[3],10)/100)+")",h=xJ.exec(c);if(!h)throw new lJ(4,t,c);return{red:parseInt(""+h[1],10),green:parseInt(""+h[2],10),blue:parseInt(""+h[3],10),alpha:parseFloat(""+l[4])>1?parseFloat(""+l[4])/100:parseFloat(""+l[4])}}throw new lJ(5)}function kJ(e){return function(e){var t,n=e.red/255,r=e.green/255,i=e.blue/255,a=Math.max(n,r,i),o=Math.min(n,r,i),s=(a+o)/2;if(a===o)return void 0!==e.alpha?{hue:0,saturation:0,lightness:s,alpha:e.alpha}:{hue:0,saturation:0,lightness:s};var u=a-o,l=s>.5?u/(2-a-o):u/(a+o);switch(a){case n:t=(r-i)/u+(r<i?6:0);break;case r:t=(i-n)/u+2;break;default:t=(n-r)/u+4}return t*=60,void 0!==e.alpha?{hue:t,saturation:l,lightness:s,alpha:e.alpha}:{hue:t,saturation:l,lightness:s}}(EJ(e))}var MJ=function(e){return 7===e.length&&e[1]===e[2]&&e[3]===e[4]&&e[5]===e[6]?"#"+e[1]+e[3]+e[5]:e};function CJ(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function RJ(e){return CJ(Math.round(255*e))}function PJ(e,t,n){return MJ("#"+RJ(e)+RJ(t)+RJ(n))}function NJ(e,t,n){return vJ(e,t,n,PJ)}function IJ(e,t,n){if("number"===typeof e&&"number"===typeof t&&"number"===typeof n)return NJ(e,t,n);if("object"===typeof e&&void 0===t&&void 0===n)return NJ(e.hue,e.saturation,e.lightness);throw new lJ(1)}function LJ(e,t,n,r){if("number"===typeof e&&"number"===typeof t&&"number"===typeof n&&"number"===typeof r)return r>=1?NJ(e,t,n):"rgba("+vJ(e,t,n)+","+r+")";if("object"===typeof e&&void 0===t&&void 0===n&&void 0===r)return e.alpha>=1?NJ(e.hue,e.saturation,e.lightness):"rgba("+vJ(e.hue,e.saturation,e.lightness)+","+e.alpha+")";throw new lJ(2)}function DJ(e,t,n){if("number"===typeof e&&"number"===typeof t&&"number"===typeof n)return MJ("#"+CJ(e)+CJ(t)+CJ(n));if("object"===typeof e&&void 0===t&&void 0===n)return MJ("#"+CJ(e.red)+CJ(e.green)+CJ(e.blue));throw new lJ(6)}function OJ(e,t,n,r){if("string"===typeof e&&"number"===typeof t){var i=EJ(e);return"rgba("+i.red+","+i.green+","+i.blue+","+t+")"}if("number"===typeof e&&"number"===typeof t&&"number"===typeof n&&"number"===typeof r)return r>=1?DJ(e,t,n):"rgba("+e+","+t+","+n+","+r+")";if("object"===typeof e&&void 0===t&&void 0===n&&void 0===r)return e.alpha>=1?DJ(e.red,e.green,e.blue):"rgba("+e.red+","+e.green+","+e.blue+","+e.alpha+")";throw new lJ(7)}function UJ(e){if("object"!==typeof e)throw new lJ(8);if(function(e){return"number"===typeof e.red&&"number"===typeof e.green&&"number"===typeof e.blue&&"number"===typeof e.alpha}(e))return OJ(e);if(function(e){return"number"===typeof e.red&&"number"===typeof e.green&&"number"===typeof e.blue&&("number"!==typeof e.alpha||"undefined"===typeof e.alpha)}(e))return DJ(e);if(function(e){return"number"===typeof e.hue&&"number"===typeof e.saturation&&"number"===typeof e.lightness&&"number"===typeof e.alpha}(e))return LJ(e);if(function(e){return"number"===typeof e.hue&&"number"===typeof e.saturation&&"number"===typeof e.lightness&&("number"!==typeof e.alpha||"undefined"===typeof e.alpha)}(e))return IJ(e);throw new lJ(8)}function BJ(e,t,n){return function(){var r=n.concat(Array.prototype.slice.call(arguments));return r.length>=t?e.apply(this,r):BJ(e,t,r)}}function FJ(e){return BJ(e,e.length,[])}FJ((function(e,t){if("transparent"===t)return t;var n=kJ(t);return UJ(sJ({},n,{hue:n.hue+parseFloat(e)}))}));function zJ(e,t,n){return Math.max(e,Math.min(t,n))}FJ((function(e,t){if("transparent"===t)return t;var n=kJ(t);return UJ(sJ({},n,{lightness:zJ(0,1,n.lightness-parseFloat(e))}))}));FJ((function(e,t){if("transparent"===t)return t;var n=kJ(t);return UJ(sJ({},n,{saturation:zJ(0,1,n.saturation-parseFloat(e))}))}));FJ((function(e,t){if("transparent"===t)return t;var n=kJ(t);return UJ(sJ({},n,{lightness:zJ(0,1,n.lightness+parseFloat(e))}))}));var VJ=FJ((function(e,t,n){if("transparent"===t)return n;if("transparent"===n)return t;if(0===e)return n;var r=EJ(t),i=sJ({},r,{alpha:"number"===typeof r.alpha?r.alpha:1}),a=EJ(n),o=sJ({},a,{alpha:"number"===typeof a.alpha?a.alpha:1}),s=i.alpha-o.alpha,u=2*parseFloat(e)-1,l=((u*s===-1?u:u+s)/(1+u*s)+1)/2,c=1-l;return OJ({red:Math.floor(i.red*l+o.red*c),green:Math.floor(i.green*l+o.green*c),blue:Math.floor(i.blue*l+o.blue*c),alpha:i.alpha*parseFloat(e)+o.alpha*(1-parseFloat(e))})})),qJ=VJ;var jJ=FJ((function(e,t){if("transparent"===t)return t;var n=EJ(t);return OJ(sJ({},n,{alpha:zJ(0,1,(100*("number"===typeof n.alpha?n.alpha:1)+100*parseFloat(e))/100)}))})),GJ=jJ;FJ((function(e,t){if("transparent"===t)return t;var n=kJ(t);return UJ(sJ({},n,{saturation:zJ(0,1,n.saturation+parseFloat(e))}))}));FJ((function(e,t){return"transparent"===t?t:UJ(sJ({},kJ(t),{hue:parseFloat(e)}))}));FJ((function(e,t){return"transparent"===t?t:UJ(sJ({},kJ(t),{lightness:parseFloat(e)}))}));FJ((function(e,t){return"transparent"===t?t:UJ(sJ({},kJ(t),{saturation:parseFloat(e)}))}));FJ((function(e,t){return"transparent"===t?t:qJ(parseFloat(e),"rgb(0, 0, 0)",t)}));FJ((function(e,t){return"transparent"===t?t:qJ(parseFloat(e),"rgb(255, 255, 255)",t)}));FJ((function(e,t){if("transparent"===t)return t;var n=EJ(t);return OJ(sJ({},n,{alpha:zJ(0,1,+(100*("number"===typeof n.alpha?n.alpha:1)-100*parseFloat(e)).toFixed(2)/100)}))}));function HJ(){}function WJ(e){return null==e?HJ:function(){return this.querySelector(e)}}function XJ(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}function QJ(){return[]}function YJ(e){return function(t){return t.matches(e)}}var KJ=Array.prototype.find;function ZJ(){return this.firstElementChild}var JJ=Array.prototype.filter;function $J(){return Array.from(this.children)}function e$(e){return new Array(e.length)}function t$(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function n$(e){return function(){return e}}function r$(e,t,n,r,i,a){for(var o,s=0,u=t.length,l=a.length;s<l;++s)(o=t[s])?(o.__data__=a[s],r[s]=o):n[s]=new t$(e,a[s]);for(;s<u;++s)(o=t[s])&&(i[s]=o)}function i$(e,t,n,r,i,a,o){var s,u,l,c=new Map,h=t.length,f=a.length,d=new Array(h);for(s=0;s<h;++s)(u=t[s])&&(d[s]=l=o.call(u,u.__data__,s,t)+"",c.has(l)?i[s]=u:c.set(l,u));for(s=0;s<f;++s)l=o.call(e,a[s],s,a)+"",(u=c.get(l))?(r[s]=u,u.__data__=a[s],c.delete(l)):n[s]=new t$(e,a[s]);for(s=0;s<h;++s)(u=t[s])&&c.get(d[s])===u&&(i[s]=u)}function a$(e){return e.__data__}function o$(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function s$(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}t$.prototype={constructor:t$,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var u$="http://www.w3.org/1999/xhtml",l$={svg:"http://www.w3.org/2000/svg",xhtml:u$,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function c$(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),l$.hasOwnProperty(t)?{space:l$[t],local:e}:e}function h$(e){return function(){this.removeAttribute(e)}}function f$(e){return function(){this.removeAttributeNS(e.space,e.local)}}function d$(e,t){return function(){this.setAttribute(e,t)}}function p$(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function A$(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function v$(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function m$(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function g$(e){return function(){this.style.removeProperty(e)}}function y$(e,t,n){return function(){this.style.setProperty(e,t,n)}}function _$(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function b$(e,t){return e.style.getPropertyValue(t)||m$(e).getComputedStyle(e,null).getPropertyValue(t)}function x$(e){return function(){delete this[e]}}function w$(e,t){return function(){this[e]=t}}function T$(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function S$(e){return e.trim().split(/^|\s+/)}function E$(e){return e.classList||new k$(e)}function k$(e){this._node=e,this._names=S$(e.getAttribute("class")||"")}function M$(e,t){for(var n=E$(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function C$(e,t){for(var n=E$(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function R$(e){return function(){M$(this,e)}}function P$(e){return function(){C$(this,e)}}function N$(e,t){return function(){(t.apply(this,arguments)?M$:C$)(this,e)}}function I$(){this.textContent=""}function L$(e){return function(){this.textContent=e}}function D$(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function O$(){this.innerHTML=""}function U$(e){return function(){this.innerHTML=e}}function B$(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function F$(){this.nextSibling&&this.parentNode.appendChild(this)}function z$(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function V$(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===u$&&t.documentElement.namespaceURI===u$?t.createElement(e):t.createElementNS(n,e)}}function q$(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function j$(e){var t=c$(e);return(t.local?q$:V$)(t)}function G$(){return null}function H$(){var e=this.parentNode;e&&e.removeChild(this)}function W$(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function X$(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Q$(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function Y$(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,a=t.length;r<a;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?t.length=i:delete this.__on}}}function K$(e,t,n){return function(){var r,i=this.__on,a=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var o=0,s=i.length;o<s;++o)if((r=i[o]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=n),void(r.value=t);this.addEventListener(e.type,a,n),r={type:e.type,name:e.name,value:t,listener:a,options:n},i?i.push(r):this.__on=[r]}}function Z$(e,t,n){var r=m$(e),i=r.CustomEvent;"function"===typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function J$(e,t){return function(){return Z$(this,e,t)}}function $$(e,t){return function(){return Z$(this,e,t.apply(this,arguments))}}k$.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var e0=ft().mark(t0);function t0(){var e,t,n,r,i,a,o;return ft().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:e=this._groups,t=0,n=e.length;case 1:if(!(t<n)){s.next=13;break}r=e[t],i=0,a=r.length;case 3:if(!(i<a)){s.next=10;break}if(!(o=r[i])){s.next=7;break}return s.next=7,o;case 7:++i,s.next=3;break;case 10:++t,s.next=1;break;case 13:case"end":return s.stop()}}),e0,this)}var n0=[null];function r0(e,t){this._groups=e,this._parents=t}function i0(){return new r0([[document.documentElement]],n0)}r0.prototype=i0.prototype=We({constructor:r0,select:function(e){"function"!==typeof e&&(e=WJ(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,o,s=t[i],u=s.length,l=r[i]=new Array(u),c=0;c<u;++c)(a=s[c])&&(o=e.call(a,a.__data__,c,s))&&("__data__"in a&&(o.__data__=a.__data__),l[c]=o);return new r0(r,this._parents)},selectAll:function(e){e="function"===typeof e?function(e){return function(){return XJ(e.apply(this,arguments))}}(e):function(e){return null==e?QJ:function(){return this.querySelectorAll(e)}}(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o,s=t[a],u=s.length,l=0;l<u;++l)(o=s[l])&&(r.push(e.call(o,o.__data__,l,s)),i.push(o));return new r0(r,i)},selectChild:function(e){return this.select(null==e?ZJ:function(e){return function(){return KJ.call(this.children,e)}}("function"===typeof e?e:YJ(e)))},selectChildren:function(e){return this.selectAll(null==e?$J:function(e){return function(){return JJ.call(this.children,e)}}("function"===typeof e?e:YJ(e)))},filter:function(e){"function"!==typeof e&&(e=function(e){return function(){return this.matches(e)}}(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,o=t[i],s=o.length,u=r[i]=[],l=0;l<s;++l)(a=o[l])&&e.call(a,a.__data__,l,o)&&u.push(a);return new r0(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,a$);var n=t?i$:r$,r=this._parents,i=this._groups;"function"!==typeof e&&(e=n$(e));for(var a=i.length,o=new Array(a),s=new Array(a),u=new Array(a),l=0;l<a;++l){var c=r[l],h=i[l],f=h.length,d=o$(e.call(c,c&&c.__data__,l,r)),p=d.length,A=s[l]=new Array(p),v=o[l]=new Array(p),m=u[l]=new Array(f);n(c,h,A,v,m,d,t);for(var g,y,_=0,b=0;_<p;++_)if(g=A[_]){for(_>=b&&(b=_+1);!(y=v[b])&&++b<p;);g._next=y||null}}return(o=new r0(o,r))._enter=s,o._exit=u,o},enter:function(){return new r0(this._enter||this._groups.map(e$),this._parents)},exit:function(){return new r0(this._exit||this._groups.map(e$),this._parents)},join:function(e,t,n){var r=this.enter(),i=this,a=this.exit();return"function"===typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(i=t(i))&&(i=i.selection()),null==n?a.remove():n(a),r&&i?r.merge(i).order():i},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,a=r.length,o=Math.min(i,a),s=new Array(i),u=0;u<o;++u)for(var l,c=n[u],h=r[u],f=c.length,d=s[u]=new Array(f),p=0;p<f;++p)(l=c[p]||h[p])&&(d[p]=l);for(;u<i;++u)s[u]=n[u];return new r0(s,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=s$);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,s=n[a],u=s.length,l=i[a]=new Array(u),c=0;c<u;++c)(o=s[c])&&(l[c]=o);l.sort(t)}return new r0(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){var e,t=0,n=k(this);try{for(n.s();!(e=n.n()).done;){e.value;++t}}catch(r){n.e(r)}finally{n.f()}return t},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,a=t[n],o=0,s=a.length;o<s;++o)(i=a[o])&&e.call(i,i.__data__,o,a);return this},attr:function(e,t){var n=c$(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?f$:h$:"function"===typeof t?n.local?v$:A$:n.local?p$:d$)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?g$:"function"===typeof t?_$:y$)(e,t,null==n?"":n)):b$(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?x$:"function"===typeof t?T$:w$)(e,t)):this.node()[e]},classed:function(e,t){var n=S$(e+"");if(arguments.length<2){for(var r=E$(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"===typeof t?N$:t?R$:P$)(n,t))},text:function(e){return arguments.length?this.each(null==e?I$:("function"===typeof e?D$:L$)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?O$:("function"===typeof e?B$:U$)(e)):this.node().innerHTML},raise:function(){return this.each(F$)},lower:function(){return this.each(z$)},append:function(e){var t="function"===typeof e?e:j$(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"===typeof e?e:j$(e),r=null==t?G$:"function"===typeof t?t:WJ(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(H$)},clone:function(e){return this.select(e?X$:W$)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,a=Q$(e+""),o=a.length;if(!(arguments.length<2)){for(s=t?K$:Y$,r=0;r<o;++r)this.each(s(a[r],t,n));return this}var s=this.node().__on;if(s)for(var u,l=0,c=s.length;l<c;++l)for(r=0,u=s[l];r<o;++r)if((i=a[r]).type===u.type&&i.name===u.name)return u.value},dispatch:function(e,t){return this.each(("function"===typeof t?$$:J$)(e,t))}},Symbol.iterator,t0);function a0(e){return"string"===typeof e?new r0([[document.querySelector(e)]],[document.documentElement]):new r0([[e]],n0)}function o0(e,t){if(e=function(e){for(var t;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}var s0,u0,l0,c0,h0,f0,d0,p0,A0,v0,m0,g0,y0={},_0=[],b0=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,x0=Array.isArray;function w0(e,t){for(var n in t)e[n]=t[n];return e}function T0(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function S0(e,t,n,r,i){var a={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==i?++l0:i,__i:-1,__u:0};return null==i&&null!=u0.vnode&&u0.vnode(a),a}function E0(e){return e.children}function k0(e,t){this.props=e,this.context=t}function M0(e,t){if(null==t)return e.__?M0(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?M0(e):null}function C0(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return C0(e)}}function R0(e){(!e.__d&&(e.__d=!0)&&h0.push(e)&&!P0.__r++||f0!=u0.debounceRendering)&&((f0=u0.debounceRendering)||d0)(P0)}function P0(){for(var e,t,n,r,i,a,o,s=1;h0.length;)h0.length>s&&h0.sort(p0),e=h0.shift(),s=h0.length,e.__d&&(n=void 0,i=(r=(t=e).__v).__e,a=[],o=[],t.__P&&((n=w0({},r)).__v=r.__v+1,u0.vnode&&u0.vnode(n),F0(t.__P,n,r,t.__n,t.__P.namespaceURI,32&r.__u?[i]:null,a,null==i?M0(r):i,!!(32&r.__u),o),n.__v=r.__v,n.__.__k[n.__i]=n,z0(a,n,o),n.__e!=i&&C0(n)));P0.__r=0}function N0(e,t,n,r,i,a,o,s,u,l,c){var h,f,d,p,A,v,m=r&&r.__k||_0,g=t.length;for(u=I0(n,t,m,u,g),h=0;h<g;h++)null!=(d=n.__k[h])&&(f=-1==d.__i?y0:m[d.__i]||y0,d.__i=h,v=F0(e,d,f,i,a,o,s,u,l,c),p=d.__e,d.ref&&f.ref!=d.ref&&(f.ref&&j0(f.ref,null,d),c.push(d.ref,d.__c||p,d)),null==A&&null!=p&&(A=p),4&d.__u||f.__k===d.__k?u=L0(d,u,e):"function"==typeof d.type&&void 0!==v?u=v:p&&(u=p.nextSibling),d.__u&=-7);return n.__e=A,u}function I0(e,t,n,r,i){var a,o,s,u,l,c=n.length,h=c,f=0;for(e.__k=new Array(i),a=0;a<i;a++)null!=(o=t[a])&&"boolean"!=typeof o&&"function"!=typeof o?(u=a+f,(o=e.__k[a]="string"==typeof o||"number"==typeof o||"bigint"==typeof o||o.constructor==String?S0(null,o,null,null,null):x0(o)?S0(E0,{children:o},null,null,null):null==o.constructor&&o.__b>0?S0(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=e,o.__b=e.__b+1,s=null,-1!=(l=o.__i=D0(o,n,u,h))&&(h--,(s=n[l])&&(s.__u|=2)),null==s||null==s.__v?(-1==l&&(i>c?f--:i<c&&f++),"function"!=typeof o.type&&(o.__u|=4)):l!=u&&(l==u-1?f--:l==u+1?f++:(l>u?f--:f++,o.__u|=4))):e.__k[a]=null;if(h)for(a=0;a<c;a++)null!=(s=n[a])&&0==(2&s.__u)&&(s.__e==r&&(r=M0(s)),G0(s,s));return r}function L0(e,t,n){var r,i;if("function"==typeof e.type){for(r=e.__k,i=0;r&&i<r.length;i++)r[i]&&(r[i].__=e,t=L0(r[i],t,n));return t}e.__e!=t&&(t&&e.type&&!n.contains(t)&&(t=M0(e)),n.insertBefore(e.__e,t||null),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8==t.nodeType);return t}function D0(e,t,n,r){var i,a,o=e.key,s=e.type,u=t[n];if(null===u&&null==e.key||u&&o==u.key&&s==u.type&&0==(2&u.__u))return n;if(r>(null!=u&&0==(2&u.__u)?1:0))for(i=n-1,a=n+1;i>=0||a<t.length;){if(i>=0){if((u=t[i])&&0==(2&u.__u)&&o==u.key&&s==u.type)return i;i--}if(a<t.length){if((u=t[a])&&0==(2&u.__u)&&o==u.key&&s==u.type)return a;a++}}return-1}function O0(e,t,n){"-"==t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||b0.test(t)?n:n+"px"}function U0(e,t,n,r,i){var a;e:if("style"==t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||O0(e.style,t,"");if(n)for(t in n)r&&n[t]==r[t]||O0(e.style,t,n[t])}else if("o"==t[0]&&"n"==t[1])a=t!=(t=t.replace(A0,"$1")),t=t.toLowerCase()in e||"onFocusOut"==t||"onFocusIn"==t?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=n,n?r?n.u=r.u:(n.u=v0,e.addEventListener(t,a?g0:m0,a)):e.removeEventListener(t,a?g0:m0,a);else{if("http://www.w3.org/2000/svg"==i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&"-"!=t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==n?"":n))}}function B0(e){return function(t){if(this.l){var n=this.l[t.type+e];if(null==t.t)t.t=v0++;else if(t.t<n.u)return;return n(u0.event?u0.event(t):t)}}}function F0(e,t,n,r,i,a,o,s,u,l){var c,h,f,d,p,A,v,m,g,y,_,b,x,w,T,S,E,k=t.type;if(null!=t.constructor)return null;128&n.__u&&(u=!!(32&n.__u),a=[s=t.__e=n.__e]),(c=u0.__b)&&c(t);e:if("function"==typeof k)try{if(m=t.props,g="prototype"in k&&k.prototype.render,y=(c=k.contextType)&&r[c.__c],_=c?y?y.props.value:c.__:r,n.__c?v=(h=t.__c=n.__c).__=h.__E:(g?t.__c=h=new k(m,_):(t.__c=h=new k0(m,_),h.constructor=k,h.render=H0),y&&y.sub(h),h.props=m,h.state||(h.state={}),h.context=_,h.__n=r,f=h.__d=!0,h.__h=[],h._sb=[]),g&&null==h.__s&&(h.__s=h.state),g&&null!=k.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=w0({},h.__s)),w0(h.__s,k.getDerivedStateFromProps(m,h.__s))),d=h.props,p=h.state,h.__v=t,f)g&&null==k.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),g&&null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(g&&null==k.getDerivedStateFromProps&&m!==d&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(m,_),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(m,h.__s,_)||t.__v==n.__v){for(t.__v!=n.__v&&(h.props=m,h.state=h.__s,h.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some((function(e){e&&(e.__=t)})),b=0;b<h._sb.length;b++)h.__h.push(h._sb[b]);h._sb=[],h.__h.length&&o.push(h);break e}null!=h.componentWillUpdate&&h.componentWillUpdate(m,h.__s,_),g&&null!=h.componentDidUpdate&&h.__h.push((function(){h.componentDidUpdate(d,p,A)}))}if(h.context=_,h.props=m,h.__P=e,h.__e=!1,x=u0.__r,w=0,g){for(h.state=h.__s,h.__d=!1,x&&x(t),c=h.render(h.props,h.state,h.context),T=0;T<h._sb.length;T++)h.__h.push(h._sb[T]);h._sb=[]}else do{h.__d=!1,x&&x(t),c=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++w<25);h.state=h.__s,null!=h.getChildContext&&(r=w0(w0({},r),h.getChildContext())),g&&!f&&null!=h.getSnapshotBeforeUpdate&&(A=h.getSnapshotBeforeUpdate(d,p)),S=c,null!=c&&c.type===E0&&null==c.key&&(S=V0(c.props.children)),s=N0(e,x0(S)?S:[S],t,n,r,i,a,o,s,u,l),h.base=t.__e,t.__u&=-161,h.__h.length&&o.push(h),v&&(h.__E=h.__=null)}catch(e){if(t.__v=null,u||null!=a)if(e.then){for(t.__u|=u?160:128;s&&8==s.nodeType&&s.nextSibling;)s=s.nextSibling;a[a.indexOf(s)]=null,t.__e=s}else for(E=a.length;E--;)T0(a[E]);else t.__e=n.__e,t.__k=n.__k;u0.__e(e,t,n)}else null==a&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):s=t.__e=q0(n.__e,t,n,r,i,a,o,u,l);return(c=u0.diffed)&&c(t),128&t.__u?void 0:s}function z0(e,t,n){for(var r=0;r<n.length;r++)j0(n[r],n[++r],n[++r]);u0.__c&&u0.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){u0.__e(e,t.__v)}}))}function V0(e){return"object"!=typeof e||null==e||e.__b&&e.__b>0?e:x0(e)?e.map(V0):w0({},e)}function q0(e,t,n,r,i,a,o,s,u){var l,c,h,f,d,p,A,v=n.props,m=t.props,g=t.type;if("svg"==g?i="http://www.w3.org/2000/svg":"math"==g?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),null!=a)for(l=0;l<a.length;l++)if((d=a[l])&&"setAttribute"in d==!!g&&(g?d.localName==g:3==d.nodeType)){e=d,a[l]=null;break}if(null==e){if(null==g)return document.createTextNode(m);e=document.createElementNS(i,g,m.is&&m),s&&(u0.__m&&u0.__m(t,a),s=!1),a=null}if(null==g)v===m||s&&e.data==m||(e.data=m);else{if(a=a&&s0.call(e.childNodes),v=n.props||y0,!s&&null!=a)for(v={},l=0;l<e.attributes.length;l++)v[(d=e.attributes[l]).name]=d.value;for(l in v)if(d=v[l],"children"==l);else if("dangerouslySetInnerHTML"==l)h=d;else if(!(l in m)){if("value"==l&&"defaultValue"in m||"checked"==l&&"defaultChecked"in m)continue;U0(e,l,null,d,i)}for(l in m)d=m[l],"children"==l?f=d:"dangerouslySetInnerHTML"==l?c=d:"value"==l?p=d:"checked"==l?A=d:s&&"function"!=typeof d||v[l]===d||U0(e,l,d,v[l],i);if(c)s||h&&(c.__html==h.__html||c.__html==e.innerHTML)||(e.innerHTML=c.__html),t.__k=[];else if(h&&(e.innerHTML=""),N0("template"==t.type?e.content:e,x0(f)?f:[f],t,n,r,"foreignObject"==g?"http://www.w3.org/1999/xhtml":i,a,o,a?a[0]:n.__k&&M0(n,0),s,u),null!=a)for(l=a.length;l--;)T0(a[l]);s||(l="value","progress"==g&&null==p?e.removeAttribute("value"):null!=p&&(p!==e[l]||"progress"==g&&!p||"option"==g&&p!=v[l])&&U0(e,l,p,v[l],i),l="checked",null!=A&&A!=e[l]&&U0(e,l,A,v[l],i))}return e}function j0(e,t,n){try{if("function"==typeof e){var r="function"==typeof e.__u;r&&e.__u(),r&&null==t||(e.__u=e(t))}else e.current=t}catch(e){u0.__e(e,n)}}function G0(e,t,n){var r,i;if(u0.unmount&&u0.unmount(e),(r=e.ref)&&(r.current&&r.current!=e.__e||j0(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){u0.__e(e,t)}r.base=r.__P=null}if(r=e.__k)for(i=0;i<r.length;i++)r[i]&&G0(r[i],t,n||"function"!=typeof e.type);n||T0(e.__e),e.__c=e.__=e.__e=void 0}function H0(e,t,n){return this.constructor(e,n)}function W0(e,t,n){var r,i,a,o;t==document&&(t=document.documentElement),u0.__&&u0.__(e,t),i=(r="function"==typeof n)?null:n&&n.__k||t.__k,a=[],o=[],F0(t,e=(!r&&n||t).__k=function(e,t,n){var r,i,a,o={};for(a in t)"key"==a?r=t[a]:"ref"==a?i=t[a]:o[a]=t[a];if(arguments.length>2&&(o.children=arguments.length>3?s0.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(a in e.defaultProps)null==o[a]&&(o[a]=e.defaultProps[a]);return S0(e,o,r,i,null)}(E0,null,[e]),i||y0,y0,t.namespaceURI,!r&&n?[n]:i?null:t.firstChild?s0.call(t.childNodes):null,a,!r&&n?n:i?i.__e:t.firstChild,r,o),z0(a,e,o)}function X0(e,t,n){var r,i,a,o,s=w0({},e.props);for(a in e.type&&e.type.defaultProps&&(o=e.type.defaultProps),t)"key"==a?r=t[a]:"ref"==a?i=t[a]:s[a]=null==t[a]&&null!=o?o[a]:t[a];return arguments.length>2&&(s.children=arguments.length>3?s0.call(arguments,2):n),S0(e.type,s,r||e.key,i||e.ref,null)}function Q0(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Y0(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function K0(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z0(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t);else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Q0(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Q0(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J0(e){return J0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J0(e)}s0=_0.slice,u0={__e:function(e,t,n,r){for(var i,a,o;t=t.__;)if((i=t.__c)&&!i.__)try{if((a=i.constructor)&&null!=a.getDerivedStateFromError&&(i.setState(a.getDerivedStateFromError(e)),o=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,r||{}),o=i.__d),o)return i.__E=i}catch(t){e=t}throw e}},l0=0,c0=function(e){return null!=e&&null==e.constructor},k0.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=w0({},this.state),"function"==typeof e&&(e=e(w0({},n),this.props)),e&&w0(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),R0(this))},k0.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),R0(this))},k0.prototype.render=E0,h0=[],d0="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,p0=function(e,t){return e.__v.__b-t.__v.__b},P0.__r=0,A0=/(PointerCapture)$|Capture$/i,v0=0,m0=B0(!1),g0=B0(!0);var $0=function(e){if("object"!==J0(e))return e;var t,n=X0(e);n.props&&(n.props=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K0(Object(n),!0).forEach((function(t){Y0(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K0(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n.props),null!==n&&void 0!==n&&null!==(t=n.props)&&void 0!==t&&t.children&&(n.props.children=Array.isArray(n.props.children)?n.props.children.map($0):$0(n.props.children)));return n};!function(e,t){void 0===t&&(t={});var n=t.insertAt;if("undefined"!==typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(".float-tooltip-kap {\n  position: absolute;\n  width: max-content; /* prevent shrinking near right edge */\n  max-width: max(50%, 150px);\n  padding: 3px 5px;\n  border-radius: 3px;\n  font: 12px sans-serif;\n  color: #eee;\n  background: rgba(0,0,0,0.6);\n  pointer-events: none;\n}\n");var e1=_c({props:{content:{default:!1},offsetX:{triggerUpdate:!1},offsetY:{triggerUpdate:!1}},init:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.style,i=void 0===r?{}:r,a=!!e&&"object"===J0(e)&&!!e.node&&"function"===typeof e.node,o=a0(a?e.node():e);"static"===o.style("position")&&o.style("position","relative"),t.tooltipEl=o.append("div").attr("class","float-tooltip-kap"),Object.entries(i).forEach((function(e){var n=Z0(e,2),r=n[0],i=n[1];return t.tooltipEl.style(r,i)})),t.tooltipEl.style("left","-10000px").style("display","none");var s="tooltip-".concat(Math.round(1e12*Math.random()));t.mouseInside=!1,o.on("mousemove.".concat(s),(function(e){t.mouseInside=!0;var n=o0(e),r=o.node(),i=r.offsetWidth,a=r.offsetHeight,s=[null===t.offsetX||void 0===t.offsetX?"-".concat(n[0]/i*100,"%"):"number"===typeof t.offsetX?"calc(-50% + ".concat(t.offsetX,"px)"):t.offsetX,null===t.offsetY||void 0===t.offsetY?a>130&&a-n[1]<100?"calc(-100% - 6px)":"21px":"number"===typeof t.offsetY?t.offsetY<0?"calc(-100% - ".concat(Math.abs(t.offsetY),"px)"):"".concat(t.offsetY,"px"):t.offsetY];t.tooltipEl.style("left",n[0]+"px").style("top",n[1]+"px").style("transform","translate(".concat(s.join(","),")")),t.content&&t.tooltipEl.style("display","inline")})),o.on("mouseover.".concat(s),(function(){t.mouseInside=!0,t.content&&t.tooltipEl.style("display","inline")})),o.on("mouseout.".concat(s),(function(){t.mouseInside=!1,t.tooltipEl.style("display","none")}))},update:function(e){var t,n;e.tooltipEl.style("display",e.content&&e.mouseInside?"inline":"none"),e.content?e.content instanceof HTMLElement?(e.tooltipEl.text(""),e.tooltipEl.append((function(){return e.content}))):"string"===typeof e.content?e.tooltipEl.html(e.content):!function(e){return c0(X0(e))}(e.content)?(e.tooltipEl.style("display","none"),console.warn("Tooltip content is invalid, skipping.",e.content,e.content.toString())):(e.tooltipEl.text(""),t=e.content,delete(n=e.tooltipEl.node()).__k,W0($0(t),n)):e.tooltipEl.text("")}});function t1(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function n1(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r1(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t);else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}(e,t)||a1(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i1(e){return function(e){if(Array.isArray(e))return t1(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a1(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a1(e,t){if(e){if("string"==typeof e)return t1(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t1(e,t):void 0}}!function(e,t){void 0===t&&(t={});var n=t.insertAt;if("undefined"!==typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(".scene-nav-info {\n  position: absolute;\n  bottom: 5px;\n  width: 100%;\n  text-align: center;\n  color: slategrey;\n  opacity: 0.7;\n  font-size: 10px;\n  font-family: sans-serif;\n  pointer-events: none;\n  user-select: none;\n}\n\n.scene-container canvas:focus {\n  outline: none;\n}");var o1=window.THREE?window.THREE:{WebGLRenderer:CX,Scene:bo,PerspectiveCamera:fo,Raycaster:wl,SRGBColorSpace:Kn,TextureLoader:qu,Vector2:_r,Vector3:Kr,Box3:$r,Color:ga,Mesh:eo,SphereGeometry:uu,MeshBasicMaterial:xa,BackSide:1,Clock:hl},s1=_c({props:{width:{default:window.innerWidth,onChange:function(e,t,n){isNaN(e)&&(t.width=n)}},height:{default:window.innerHeight,onChange:function(e,t,n){isNaN(e)&&(t.height=n)}},viewOffset:{default:[0,0]},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},lights:{default:[]},enablePointerInteraction:{default:!0,onChange:function(e,t){t.hoverObj=null,t.tooltip&&t.tooltip.content(null)},triggerUpdate:!1},pointerRaycasterThrottleMs:{default:50,triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},pointsHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(e){if(e.initialised){e.controls.update&&e.controls.update(Math.min(1,e.clock.getDelta())),e.postProcessingComposer?e.postProcessingComposer.render():e.renderer.render(e.scene,e.camera),e.extraRenderers.forEach((function(t){return t.render(e.scene,e.camera)}));var t=+new Date;if(e.enablePointerInteraction&&t-e.lastRaycasterCheck>=e.pointerRaycasterThrottleMs){e.lastRaycasterCheck=t;var n=null;if(e.hoverDuringDrag||!e.isPointerDragging){var r=this.intersectingObjects(e.pointerPos.x,e.pointerPos.y);e.hoverOrderComparator&&r.sort((function(t,n){return e.hoverOrderComparator(t.object,n.object)}));var i=r.find((function(t){return e.hoverFilter(t.object)}))||null;n=i?i.object:null,e.intersection=i||null}n!==e.hoverObj&&(e.onHover(n,e.hoverObj,e.intersection),e.tooltip.content(n&&lA(e.tooltipContent)(n,e.intersection)||null),e.hoverObj=n)}e.tweenGroup.update()}return this},getPointerPos:function(e){var t=e.pointerPos;return{x:t.x,y:t.y}},cameraPosition:function(e,t,n,r){var i=e.camera;if(t&&e.initialised){var a=t,o=n||{x:0,y:0,z:0};if(r){var s=Object.assign({},i.position),u=h();e.tweenGroup.add(new kc(s).to(a,r).easing(bc.Quadratic.Out).onUpdate(l).start()),e.tweenGroup.add(new kc(u).to(o,r/3).easing(bc.Quadratic.Out).onUpdate(c).start())}else l(a),c(o);return this}return Object.assign({},i.position,{lookAt:h()});function l(e){var t=e.x,n=e.y,r=e.z;void 0!==t&&(i.position.x=t),void 0!==n&&(i.position.y=n),void 0!==r&&(i.position.z=r)}function c(t){var n=new o1.Vector3(t.x,t.y,t.z);e.controls.target?e.controls.target=n:i.lookAt(n)}function h(){return Object.assign(new o1.Vector3(0,0,-1e3).applyQuaternion(i.quaternion).add(i.position))}},zoomToFit:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];return this.fitToBbox(this.getBbox.apply(this,i),t,n)},fitToBbox:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,i=e.camera;if(t){var a=new o1.Vector3(0,0,0),o=2*Math.max.apply(Math,i1(Object.entries(t).map((function(e){var t=r1(e,2),n=t[0],r=t[1];return Math.max.apply(Math,i1(r.map((function(e){return Math.abs(a[n]-e)}))))})))),s=(1-2*r/e.height)*i.fov,u=o/Math.atan(s*Math.PI/180),l=u/i.aspect,c=Math.max(u,l);if(c>0){var h=a.clone().sub(i.position).normalize().multiplyScalar(-c);this.cameraPosition(h,a,n)}}return this},getBbox:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=new o1.Box3(new o1.Vector3(0,0,0),new o1.Vector3(0,0,0)),r=e.objects.filter(t);return r.length?(r.forEach((function(e){return n.expandByObject(e)})),Object.assign.apply(Object,i1(["x","y","z"].map((function(e){return n1({},e,[n.min[e],n.max[e]])}))))):null},getScreenCoords:function(e,t,n,r){var i=new o1.Vector3(t,n,r);return i.project(this.camera()),{x:(i.x+1)*e.width/2,y:-(i.y-1)*e.height/2}},getSceneCoords:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=new o1.Vector2(t/e.width*2-1,-n/e.height*2+1),a=new o1.Raycaster;return a.setFromCamera(i,e.camera),Object.assign({},a.ray.at(r,new o1.Vector3))},intersectingObjects:function(e,t,n){var r=new o1.Vector2(t/e.width*2-1,-n/e.height*2+1),i=new o1.Raycaster;return i.params.Line.threshold=e.lineHoverPrecision,i.params.Points.threshold=e.pointsHoverPrecision,i.setFromCamera(r,e.camera),i.intersectObjects(e.objects,!0)},renderer:function(e){return e.renderer},scene:function(e){return e.scene},camera:function(e){return e.camera},postProcessingComposer:function(e){return e.postProcessingComposer},controls:function(e){return e.controls},tbControls:function(e){return e.controls}},stateInit:function(){return{scene:new o1.Scene,camera:new o1.PerspectiveCamera,clock:new o1.Clock,tweenGroup:new wc,lastRaycasterCheck:0}},init:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.controlType,i=void 0===r?"trackball":r,a=n.useWebGPU,o=void 0!==a&&a,s=n.rendererConfig,u=void 0===s?{}:s,l=n.extraRenderers,c=void 0===l?[]:l,h=n.waitForLoadComplete,f=void 0===h||h;e.innerHTML="",e.appendChild(t.container=document.createElement("div")),t.container.className="scene-container",t.container.style.position="relative",t.container.appendChild(t.navInfo=document.createElement("div")),t.navInfo.className="scene-nav-info",t.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[i]||"",t.navInfo.style.display=t.showNavInfo?null:"none",t.tooltip=new e1(t.container),t.pointerPos=new o1.Vector2,t.pointerPos.x=-2,t.pointerPos.y=-2,["pointermove","pointerdown"].forEach((function(e){return t.container.addEventListener(e,(function(n){if("pointerdown"===e&&(t.isPointerPressed=!0),!t.isPointerDragging&&"pointermove"===n.type&&(n.pressure>0||t.isPointerPressed)&&("touch"!==n.pointerType||void 0===n.movementX||[n.movementX,n.movementY].some((function(e){return Math.abs(e)>1})))&&(t.isPointerDragging=!0),t.enablePointerInteraction){var r=function(e){var t=e.getBoundingClientRect(),n=window.pageXOffset||document.documentElement.scrollLeft,r=window.pageYOffset||document.documentElement.scrollTop;return{top:t.top+r,left:t.left+n}}(t.container);t.pointerPos.x=n.pageX-r.left,t.pointerPos.y=n.pageY-r.top}}),{passive:!0})})),t.container.addEventListener("pointerup",(function(e){t.isPointerPressed=!1,t.isPointerDragging&&(t.isPointerDragging=!1,!t.clickAfterDrag)||requestAnimationFrame((function(){0===e.button&&t.onClick(t.hoverObj||null,e,t.intersection),2===e.button&&t.onRightClick&&t.onRightClick(t.hoverObj||null,e,t.intersection)}))}),{passive:!0,capture:!0}),t.container.addEventListener("contextmenu",(function(e){t.onRightClick&&e.preventDefault()})),t.renderer=new(o?PG:o1.WebGLRenderer)(Object.assign({antialias:!0,alpha:!0},u)),t.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),t.container.appendChild(t.renderer.domElement),t.extraRenderers=c,t.extraRenderers.forEach((function(e){e.domElement.style.position="absolute",e.domElement.style.top="0px",e.domElement.style.pointerEvents="none",t.container.appendChild(e.domElement)})),t.postProcessingComposer=new aJ(t.renderer),t.postProcessingComposer.addPass(new oJ(t.scene,t.camera)),t.controls=new{trackball:YK,orbit:kZ,fly:jZ}[i](t.camera,t.renderer.domElement),"fly"===i&&(t.controls.movementSpeed=300,t.controls.rollSpeed=Math.PI/6,t.controls.dragToLook=!0),"trackball"!==i&&"orbit"!==i||(t.controls.minDistance=.1,t.controls.maxDistance=t.skyRadius,t.controls.addEventListener("start",(function(){t.controlsEngaged=!0})),t.controls.addEventListener("change",(function(){t.controlsEngaged&&(t.controlsDragging=!0)})),t.controls.addEventListener("end",(function(){t.controlsEngaged=!1,t.controlsDragging=!1}))),[t.renderer,t.postProcessingComposer].concat(i1(t.extraRenderers)).forEach((function(e){return e.setSize(t.width,t.height)})),t.camera.aspect=t.width/t.height,t.camera.updateProjectionMatrix(),t.camera.position.z=1e3,t.scene.add(t.skysphere=new o1.Mesh),t.skysphere.visible=!1,t.loadComplete=t.scene.visible=!f,window.scene=t.scene},update:function(e,t){if(e.width&&e.height&&(t.hasOwnProperty("width")||t.hasOwnProperty("height"))){var n,r=e.width,i=e.height;e.container.style.width="".concat(r,"px"),e.container.style.height="".concat(i,"px"),[e.renderer,e.postProcessingComposer].concat(i1(e.extraRenderers)).forEach((function(e){return e.setSize(r,i)})),e.camera.aspect=r/i;var a=e.viewOffset.slice(0,2);a.some((function(e){return e}))&&(n=e.camera).setViewOffset.apply(n,[r,i].concat(i1(a),[r,i])),e.camera.updateProjectionMatrix()}if(t.hasOwnProperty("viewOffset")){var o,s=e.width,u=e.height,l=e.viewOffset.slice(0,2);l.some((function(e){return e}))?(o=e.camera).setViewOffset.apply(o,[s,u].concat(i1(l),[s,u])):e.camera.clearViewOffset()}if(t.hasOwnProperty("skyRadius")&&e.skyRadius&&(e.controls.hasOwnProperty("maxDistance")&&t.skyRadius&&(e.controls.maxDistance=Math.min(e.controls.maxDistance,e.skyRadius)),e.camera.far=2.5*e.skyRadius,e.camera.updateProjectionMatrix(),e.skysphere.geometry=new o1.SphereGeometry(e.skyRadius)),t.hasOwnProperty("backgroundColor")){var c=EJ(e.backgroundColor).alpha;void 0===c&&(c=1),e.renderer.setClearColor(new o1.Color(GJ(1,e.backgroundColor)),c)}function h(){e.loadComplete=e.scene.visible=!0}t.hasOwnProperty("backgroundImageUrl")&&(e.backgroundImageUrl?(new o1.TextureLoader).load(e.backgroundImageUrl,(function(t){t.colorSpace=o1.SRGBColorSpace,e.skysphere.material=new o1.MeshBasicMaterial({map:t,side:o1.BackSide}),e.skysphere.visible=!0,e.onBackgroundImageLoaded&&setTimeout(e.onBackgroundImageLoaded),!e.loadComplete&&h()})):(e.skysphere.visible=!1,e.skysphere.material.map=null,!e.loadComplete&&h())),t.hasOwnProperty("showNavInfo")&&(e.navInfo.style.display=e.showNavInfo?null:"none"),t.hasOwnProperty("lights")&&((t.lights||[]).forEach((function(t){return e.scene.remove(t)})),e.lights.forEach((function(t){return e.scene.add(t)}))),t.hasOwnProperty("objects")&&((t.objects||[]).forEach((function(t){return e.scene.remove(t)})),e.objects.forEach((function(t){return e.scene.add(t)})))}});function u1(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l1(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h1(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c1(Object(n),!0).forEach((function(t){l1(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c1(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f1(e){return function(e){if(Array.isArray(e))return u1(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return u1(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u1(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d1(e,t){var n=new t;return n._destructor&&n._destructor(),{linkProp:function(t){return{default:n[t](),onChange:function(n,r){r[e][t](n)},triggerUpdate:!1}},linkMethod:function(t){return function(n){for(var r=n[e],i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];var s=r[t].apply(r,a);return s===r?this:s}}}}!function(e,t){void 0===t&&(t={});var n=t.insertAt;if("undefined"!==typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(".scene-container .clickable {\n  cursor: pointer;\n}");var p1=["rendererConfig","waitForGlobeReady"],A1=h1(h1({},window.THREE?window.THREE:{AmbientLight:al,DirectionalLight:il,Vector2:_r,REVISION:dt}),{},{CSS2DRenderer:zl}),v1=d1("globe",MK),m1=Object.assign.apply(Object,f1(["globeImageUrl","bumpImageUrl","globeTileEngineUrl","globeTileEngineMaxLevel","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude","onGlobeReady","pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration","arcsData","arcStartLat","arcStartLng","arcEndLat","arcEndLng","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration","polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration","pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration","heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration","hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration","hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration","tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration","particlesData","particlesList","particleLat","particleLng","particleAltitude","particlesSize","particlesSizeAttenuation","particlesColor","particlesTexture","ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod","labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration","htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlElementVisibilityModifier","htmlTransitionDuration","objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject","customLayerData","customThreeObject","customThreeObjectUpdate"].map((function(e){return l1({},e,v1.linkProp(e))})))),g1=Object.assign.apply(Object,f1(["globeMaterial","getGlobeRadius","getCoords","toGeoCoords"].map((function(e){return l1({},e,v1.linkMethod(e))})))),y1=d1("renderObjs",s1),_1=Object.assign.apply(Object,f1(["width","height","backgroundColor","backgroundImageUrl","enablePointerInteraction"].map((function(e){return l1({},e,y1.linkProp(e))})))),b1=Object.assign.apply(Object,f1(["lights","postProcessingComposer"].map((function(e){return l1({},e,y1.linkMethod(e))})))),x1=_c({props:h1(h1({onZoom:{triggerUpdate:!1},onGlobeClick:{triggerUpdate:!1},onGlobeRightClick:{triggerUpdate:!1},pointLabel:{default:"name",triggerUpdate:!1},onPointClick:{triggerUpdate:!1},onPointRightClick:{triggerUpdate:!1},onPointHover:{triggerUpdate:!1},arcLabel:{default:"name",triggerUpdate:!1},onArcClick:{triggerUpdate:!1},onArcRightClick:{triggerUpdate:!1},onArcHover:{triggerUpdate:!1},polygonLabel:{default:"name",triggerUpdate:!1},onPolygonClick:{triggerUpdate:!1},onPolygonRightClick:{triggerUpdate:!1},onPolygonHover:{triggerUpdate:!1},pathLabel:{default:"name",triggerUpdate:!1},onPathClick:{triggerUpdate:!1},onPathRightClick:{triggerUpdate:!1},onPathHover:{triggerUpdate:!1},onHeatmapClick:{triggerUpdate:!1},onHeatmapRightClick:{triggerUpdate:!1},onHeatmapHover:{triggerUpdate:!1},hexLabel:{triggerUpdate:!1},onHexClick:{triggerUpdate:!1},onHexRightClick:{triggerUpdate:!1},onHexHover:{triggerUpdate:!1},hexPolygonLabel:{triggerUpdate:!1},onHexPolygonClick:{triggerUpdate:!1},onHexPolygonRightClick:{triggerUpdate:!1},onHexPolygonHover:{triggerUpdate:!1},tileLabel:{default:"name",triggerUpdate:!1},onTileClick:{triggerUpdate:!1},onTileRightClick:{triggerUpdate:!1},onTileHover:{triggerUpdate:!1},particleLabel:{default:"name",triggerUpdate:!1},onParticleClick:{triggerUpdate:!1},onParticleRightClick:{triggerUpdate:!1},onParticleHover:{triggerUpdate:!1},labelLabel:{triggerUpdate:!1},onLabelClick:{triggerUpdate:!1},onLabelRightClick:{triggerUpdate:!1},onLabelHover:{triggerUpdate:!1},objectLabel:{default:"name",triggerUpdate:!1},onObjectClick:{triggerUpdate:!1},onObjectRightClick:{triggerUpdate:!1},onObjectHover:{triggerUpdate:!1},customLayerLabel:{default:"name",triggerUpdate:!1},onCustomLayerClick:{triggerUpdate:!1},onCustomLayerRightClick:{triggerUpdate:!1},onCustomLayerHover:{triggerUpdate:!1},pointerEventsFilter:{default:function(){return!0},triggerUpdate:!1},lineHoverPrecision:{default:.2,triggerUpdate:!1,onChange:function(e,t){t.renderObjs.lineHoverPrecision(e),t.renderObjs.pointsHoverPrecision(e)}},globeOffset:{default:[0,0],triggerUpdate:!1,onChange:function(e,t){return Array.isArray(e)&&2===e.length&&t.renderObjs.viewOffset(e.map((function(e){return-e})))}}},m1),_1),methods:h1(h1({pauseAnimation:function(e){var t;return null!==e.animationFrameRequestId&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),null===(t=e.globe)||void 0===t||t.pauseAnimation(),this},resumeAnimation:function(e){var t;return null===e.animationFrameRequestId&&this._animationCycle(),null===(t=e.globe)||void 0===t||t.resumeAnimation(),this},_animationCycle:function(e){e.renderObjs.tick(),e.tweenGroup.update(),e.animationFrameRequestId=requestAnimationFrame(this._animationCycle)},pointOfView:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=a();if(void 0===t.lat&&void 0===t.lng&&void 0===t.altitude)return r;var i=Object.assign({},r,t);if(["lat","lng","altitude"].forEach((function(e){return i[e]=+i[e]})),n){for(;r.lng-i.lng>180;)r.lng-=360;for(;r.lng-i.lng<-180;)r.lng+=360;e.tweenGroup.add(new kc(r).to(i,n).easing(bc.Cubic.InOut).onUpdate(o).start())}else o(i);return this;function a(){return e.globe.toGeoCoords(e.renderObjs.cameraPosition())}function o(t){var n=t.lat,r=t.lng,i=t.altitude;e.renderObjs.cameraPosition(e.globe.getCoords(n,r,i)),e.globe.setPointOfView(e.renderObjs.camera())}},getScreenCoords:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=(t=e.globe).getCoords.apply(t,r);return e.renderObjs.getScreenCoords(a.x,a.y,a.z)},toGlobeCoords:function(e,t,n){var r=e.renderObjs.intersectingObjects(t,n).find((function(e){return"globe"===(e.object.__globeObjType||e.object.parent.__globeObjType)}));if(!r)return null;var i=e.globe.toGeoCoords(r.point);return{lat:i.lat,lng:i.lng}},scene:function(e){return e.renderObjs.scene()},camera:function(e){return e.renderObjs.camera()},renderer:function(e){return e.renderObjs.renderer()},controls:function(e){return e.renderObjs.controls()},_destructor:function(e){e.globe._destructor(),this.pauseAnimation(),this.pointsData([]),this.arcsData([]),this.polygonsData([]),this.pathsData([]),this.heatmapsData([]),this.hexBinPointsData([]),this.hexPolygonsData([]),this.tilesData([]),this.particlesData([]),this.labelsData([]),this.htmlElementsData([]),this.objectsData([]),this.customLayerData([])}},g1),b1),stateInit:function(e){var t=e.rendererConfig,n=e.waitForGlobeReady,r=void 0===n||n,i=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,p1),a=new MK(h1({waitForGlobeReady:r},i));return{globe:a,renderObjs:s1({controlType:"orbit",rendererConfig:t,waitForLoadComplete:r,extraRenderers:[new A1.CSS2DRenderer]}).skyRadius(500*a.getGlobeRadius()).showNavInfo(!1).objects([a]).lights([new A1.AmbientLight(13421772,Math.PI),new A1.DirectionalLight(16777215,.6*Math.PI)]),tweenGroup:new wc}},init:function(e,t){var n=this;e.innerHTML="",e.appendChild(t.container=document.createElement("div")),t.container.style.position="relative";var r=document.createElement("div");t.container.appendChild(r),t.renderObjs(r),t.globe.rendererSize(t.renderObjs.renderer().getSize(new A1.Vector2)),this.pointOfView({altitude:2.5});var i=t.globe.getGlobeRadius(),a=t.renderObjs.controls();t.renderObjs.camera().near=.05,a.minDistance=i+Math.max(.001,1.1*t.renderObjs.camera().near),a.maxDistance=100*i,a.enablePan=!1,a.enableDamping=!0,a.dampingFactor=.1,a.rotateSpeed=.3,a.zoomSpeed=.3,a.zoomToCursor=!0,a.addEventListener("change",(function(){a.target.setScalar(0);var e=n.pointOfView();a.rotateSpeed=.3*e.altitude,a.zoomSpeed=.5*Math.sqrt(e.altitude),t.globe.setPointOfView(t.renderObjs.camera()),t.onZoom&&t.onZoom(e)}));var o=function(e){for(var t=e;t&&!t.hasOwnProperty("__globeObjType");)t=t.parent;return t},s={point:function(e){return e},arc:function(e){return e},polygon:function(e){return e.data},path:function(e){return e},heatmap:function(e){return e},hexbin:function(e){return e},hexPolygon:function(e){return e},tile:function(e){return e},particles:function(e,t){return!t||!t.hasOwnProperty("index")||e.length<=t.index?e:e[t.index]},label:function(e){return e},object:function(e){return e},custom:function(e){return e}};A1.REVISION<155&&(t.renderObjs.renderer().useLegacyLights=!1),t.renderObjs.hoverFilter((function(e){var n=o(e);if(!n)return!1;var r=n.__globeObjType;if("globe"!==r&&!s.hasOwnProperty(r))return!1;var i=s.hasOwnProperty(r)&&n.__data?s[r](n.__data):null;return(!["points","hexBinPoints"].some((function(e){return e===r}))||!Array.isArray(i))&&t.pointerEventsFilter(n,i)})).tooltipContent((function(e,n){var r={point:t.pointLabel,arc:t.arcLabel,polygon:t.polygonLabel,path:t.pathLabel,hexbin:t.hexLabel,hexPolygon:t.hexPolygonLabel,tile:t.tileLabel,particles:t.particleLabel,label:t.labelLabel,object:t.objectLabel,custom:t.customLayerLabel},i=o(e),a=i&&i.__globeObjType;return i&&a&&r.hasOwnProperty(a)&&s.hasOwnProperty(a)&&lA(r[a])(s[a](i.__data,n))||""})).onHover((function(e,n,r){var i={point:t.onPointHover,arc:t.onArcHover,polygon:t.onPolygonHover,path:t.onPathHover,heatmap:t.onHeatmapHover,hexbin:t.onHexHover,hexPolygon:t.onHexPolygonHover,tile:t.onTileHover,particles:t.onParticleHover,label:t.onLabelHover,object:t.onObjectHover,custom:t.onCustomLayerHover},a={globe:t.onGlobeClick,point:t.onPointClick,arc:t.onArcClick,polygon:t.onPolygonClick,path:t.onPathClick,heatmap:t.onHeatmapClick,hexbin:t.onHexClick,hexPolygon:t.onHexPolygonClick,tile:t.onTileClick,particles:t.onParticleClick,label:t.onLabelClick,object:t.onObjectClick,custom:t.onCustomLayerClick},u=o(e);if(u&&!i.hasOwnProperty(u.__globeObjType)&&(u=null),u!==t.hoverObj){var l=t.hoverObj?t.hoverObj.__globeObjType:null,c=t.hoverData,h=u?u.__globeObjType:null,f=u?s[h](u.__data,r):null;l&&l!==h&&i[l]&&i[l](null,c||null),h&&i[h]&&i[h](f,l===h?c:null),t.renderObjs.renderer().domElement.classList[h&&a[h]?"add":"remove"]("clickable"),t.hoverObj=u,t.hoverData=f}})).onClick((function(e,r,i){if(e){var a={globe:t.onGlobeClick,point:t.onPointClick,arc:t.onArcClick,polygon:t.onPolygonClick,path:t.onPathClick,heatmap:t.onHeatmapClick,hexbin:t.onHexClick,hexPolygon:t.onHexPolygonClick,tile:t.onTileClick,particles:t.onParticleClick,label:t.onLabelClick,object:t.onObjectClick,custom:t.onCustomLayerClick},u=o(e),l=u.__globeObjType;if(u&&a.hasOwnProperty(l)&&a[l]){var c=[r],h=null!==i&&void 0!==i&&i.isVector3?i:null===i||void 0===i?void 0:i.point;if("globe"===l){var f=n.toGeoCoords(h),d=f.lat,p=f.lng;c.unshift({lat:d,lng:p})}else c.push(n.toGeoCoords(h));s.hasOwnProperty(l)&&c.unshift(s[l](u.__data,i)),a[l].apply(a,c)}}})).onRightClick((function(e,r,i){if(e){var a={globe:t.onGlobeRightClick,point:t.onPointRightClick,arc:t.onArcRightClick,polygon:t.onPolygonRightClick,path:t.onPathRightClick,heatmap:t.onHeatmapRightClick,hexbin:t.onHexRightClick,hexPolygon:t.onHexPolygonRightClick,tile:t.onTileRightClick,particles:t.onParticleRightClick,label:t.onLabelRightClick,object:t.onObjectRightClick,custom:t.onCustomLayerRightClick},u=o(e),l=u.__globeObjType;if(u&&a.hasOwnProperty(l)&&a[l]){var c=[r],h=null!==i&&void 0!==i&&i.isVector3?i:null===i||void 0===i?void 0:i.point;if("globe"===l){var f=n.toGeoCoords(h),d=f.lat,p=f.lng;c.unshift({lat:d,lng:p})}else c.push(n.toGeoCoords(h));s.hasOwnProperty(l)&&c.unshift(s[l](u.__data,i)),a[l].apply(a,c)}}})),this._animationCycle()}}),w1=n(192),T1=n.n(w1),S1={width:w1.number,height:w1.number,globeOffset:w1.arrayOf(w1.number),backgroundColor:w1.string,backgroundImageUrl:w1.string,globeImageUrl:w1.string,bumpImageUrl:w1.string,globeTileEngineUrl:w1.func,showGlobe:w1.bool,showGraticules:w1.bool,showAtmosphere:w1.bool,atmosphereColor:w1.string,atmosphereAltitude:w1.number,globeMaterial:w1.object,onGlobeReady:w1.func,onGlobeClick:w1.func,onGlobeRightClick:w1.func,pointsData:w1.arrayOf(w1.object),pointLat:w1.oneOfType([w1.number,w1.string,w1.func]),pointLng:w1.oneOfType([w1.number,w1.string,w1.func]),pointColor:w1.oneOfType([w1.string,w1.func]),pointAltitude:w1.oneOfType([w1.number,w1.string,w1.func]),pointRadius:w1.oneOfType([w1.number,w1.string,w1.func]),pointResolution:w1.number,pointsMerge:w1.bool,pointsTransitionDuration:w1.number,pointLabel:w1.oneOfType([w1.string,w1.func]),onPointClick:w1.func,onPointRightClick:w1.func,onPointHover:w1.func,arcsData:w1.arrayOf(w1.object),arcStartLat:w1.oneOfType([w1.number,w1.string,w1.func]),arcStartLng:w1.oneOfType([w1.number,w1.string,w1.func]),arcEndLat:w1.oneOfType([w1.number,w1.string,w1.func]),arcEndLng:w1.oneOfType([w1.number,w1.string,w1.func]),arcColor:w1.oneOfType([w1.string,w1.arrayOf(w1.string),w1.func]),arcAltitude:w1.oneOfType([w1.number,w1.string,w1.func]),arcAltitudeAutoScale:w1.oneOfType([w1.number,w1.string,w1.func]),arcStroke:w1.oneOfType([w1.number,w1.string,w1.func]),arcCurveResolution:w1.number,arcCircularResolution:w1.number,arcDashLength:w1.oneOfType([w1.number,w1.string,w1.func]),arcDashGap:w1.oneOfType([w1.number,w1.string,w1.func]),arcDashInitialGap:w1.oneOfType([w1.number,w1.string,w1.func]),arcDashAnimateTime:w1.oneOfType([w1.number,w1.string,w1.func]),arcsTransitionDuration:w1.number,arcLabel:w1.oneOfType([w1.string,w1.func]),onArcClick:w1.func,onArcRightClick:w1.func,onArcHover:w1.func,polygonsData:w1.arrayOf(w1.object),polygonGeoJsonGeometry:w1.oneOfType([w1.string,w1.func]),polygonCapColor:w1.oneOfType([w1.string,w1.func]),polygonCapMaterial:w1.oneOfType([w1.object,w1.string,w1.func]),polygonSideColor:w1.oneOfType([w1.string,w1.func]),polygonSideMaterial:w1.oneOfType([w1.object,w1.string,w1.func]),polygonStrokeColor:w1.oneOfType([w1.string,w1.func]),polygonAltitude:w1.oneOfType([w1.number,w1.string,w1.func]),polygonCapCurvatureResolution:w1.oneOfType([w1.number,w1.string,w1.func]),polygonsTransitionDuration:w1.number,polygonLabel:w1.oneOfType([w1.string,w1.func]),onPolygonClick:w1.func,onPolygonRightClick:w1.func,onPolygonHover:w1.func,pathsData:w1.array,pathPoints:w1.oneOfType([w1.array,w1.string,w1.func]),pathPointLat:w1.oneOfType([w1.number,w1.string,w1.func]),pathPointLng:w1.oneOfType([w1.number,w1.string,w1.func]),pathPointAlt:w1.oneOfType([w1.number,w1.string,w1.func]),pathResolution:w1.number,pathColor:w1.oneOfType([w1.string,w1.arrayOf(w1.string),w1.func]),pathStroke:w1.oneOfType([w1.number,w1.string,w1.func]),pathDashLength:w1.oneOfType([w1.number,w1.string,w1.func]),pathDashGap:w1.oneOfType([w1.number,w1.string,w1.func]),pathDashInitialGap:w1.oneOfType([w1.number,w1.string,w1.func]),pathDashAnimateTime:w1.oneOfType([w1.number,w1.string,w1.func]),pathTransitionDuration:w1.number,pathLabel:w1.oneOfType([w1.string,w1.func]),onPathClick:w1.func,onPathRightClick:w1.func,onPathHover:w1.func,heatmapsData:w1.array,heatmapPoints:w1.oneOfType([w1.array,w1.string,w1.func]),heatmapPointLat:w1.oneOfType([w1.number,w1.string,w1.func]),heatmapPointLng:w1.oneOfType([w1.number,w1.string,w1.func]),heatmapPointWeight:w1.oneOfType([w1.number,w1.string,w1.func]),heatmapBandwidth:w1.oneOfType([w1.number,w1.string,w1.func]),heatmapColorFn:w1.oneOfType([w1.string,w1.func]),heatmapColorSaturation:w1.oneOfType([w1.number,w1.string,w1.func]),heatmapBaseAltitude:w1.oneOfType([w1.number,w1.string,w1.func]),heatmapTopAltitude:w1.oneOfType([w1.number,w1.string,w1.func]),heatmapsTransitionDuration:w1.number,onHeatmapClick:w1.func,onHeatmapRightClick:w1.func,onHeatmapHover:w1.func,hexBinPointsData:w1.arrayOf(w1.object),hexBinPointLat:w1.oneOfType([w1.number,w1.string,w1.func]),hexBinPointLng:w1.oneOfType([w1.number,w1.string,w1.func]),hexBinPointWeight:w1.oneOfType([w1.number,w1.string,w1.func]),hexBinResolution:w1.number,hexMargin:w1.oneOfType([w1.number,w1.func]),hexTopColor:w1.func,hexSideColor:w1.func,hexAltitude:w1.oneOfType([w1.number,w1.func]),hexTopCurvatureResolution:w1.number,hexBinMerge:w1.bool,hexTransitionDuration:w1.number,hexLabel:w1.oneOfType([w1.string,w1.func]),onHexClick:w1.func,onHexRightClick:w1.func,onHexHover:w1.func,hexPolygonsData:w1.arrayOf(w1.object),hexPolygonGeoJsonGeometry:w1.oneOfType([w1.string,w1.func]),hexPolygonColor:w1.oneOfType([w1.string,w1.func]),hexPolygonAltitude:w1.oneOfType([w1.number,w1.string,w1.func]),hexPolygonResolution:w1.oneOfType([w1.number,w1.string,w1.func]),hexPolygonMargin:w1.oneOfType([w1.number,w1.string,w1.func]),hexPolygonUseDots:w1.oneOfType([w1.bool,w1.string,w1.func]),hexPolygonCurvatureResolution:w1.oneOfType([w1.number,w1.string,w1.func]),hexPolygonDotResolution:w1.oneOfType([w1.number,w1.string,w1.func]),hexPolygonsTransitionDuration:w1.number,hexPolygonLabel:w1.oneOfType([w1.string,w1.func]),onHexPolygonClick:w1.func,onHexPolygonRightClick:w1.func,onHexPolygonHover:w1.func,tilesData:w1.arrayOf(w1.object),tileLat:w1.oneOfType([w1.number,w1.string,w1.func]),tileLng:w1.oneOfType([w1.number,w1.string,w1.func]),tileAltitude:w1.oneOfType([w1.number,w1.string,w1.func]),tileWidth:w1.oneOfType([w1.number,w1.string,w1.func]),tileHeight:w1.oneOfType([w1.number,w1.string,w1.func]),tileUseGlobeProjection:w1.oneOfType([w1.bool,w1.string,w1.func]),tileMaterial:w1.oneOfType([w1.object,w1.string,w1.func]),tileCurvatureResolution:w1.oneOfType([w1.number,w1.string,w1.func]),tilesTransitionDuration:w1.number,tileLabel:w1.oneOfType([w1.string,w1.func]),onTileClick:w1.func,onTileRightClick:w1.func,onTileHover:w1.func,particlesData:w1.arrayOf(w1.object),particlesList:w1.oneOfType([w1.string,w1.func]),particleLat:w1.oneOfType([w1.number,w1.string,w1.func]),particleLng:w1.oneOfType([w1.number,w1.string,w1.func]),particleAltitude:w1.oneOfType([w1.number,w1.string,w1.func]),particlesSize:w1.oneOfType([w1.number,w1.string,w1.func]),particlesSizeAttenuation:w1.oneOfType([w1.bool,w1.string,w1.func]),particlesColor:w1.oneOfType([w1.string,w1.func]),particlesTexture:w1.oneOfType([w1.string,w1.func]),particleLabel:w1.oneOfType([w1.string,w1.func]),onParticleClick:w1.func,onParticleRightClick:w1.func,onParticleHover:w1.func,ringsData:w1.arrayOf(w1.object),ringLat:w1.oneOfType([w1.number,w1.string,w1.func]),ringLng:w1.oneOfType([w1.number,w1.string,w1.func]),ringAltitude:w1.oneOfType([w1.number,w1.string,w1.func]),ringColor:w1.oneOfType([w1.string,w1.arrayOf(w1.string),w1.func]),ringResolution:w1.number,ringMaxRadius:w1.oneOfType([w1.number,w1.string,w1.func]),ringPropagationSpeed:w1.oneOfType([w1.number,w1.string,w1.func]),ringRepeatPeriod:w1.oneOfType([w1.number,w1.string,w1.func]),labelsData:w1.arrayOf(w1.object),labelLat:w1.oneOfType([w1.number,w1.string,w1.func]),labelLng:w1.oneOfType([w1.number,w1.string,w1.func]),labelAltitude:w1.oneOfType([w1.number,w1.string,w1.func]),labelRotation:w1.oneOfType([w1.number,w1.string,w1.func]),labelText:w1.oneOfType([w1.string,w1.func]),labelSize:w1.oneOfType([w1.number,w1.string,w1.func]),labelTypeFace:w1.object,labelColor:w1.oneOfType([w1.string,w1.func]),labelResolution:w1.number,labelIncludeDot:w1.oneOfType([w1.bool,w1.string,w1.func]),labelDotRadius:w1.oneOfType([w1.number,w1.string,w1.func]),labelDotOrientation:w1.oneOfType([w1.string,w1.func]),labelsTransitionDuration:w1.number,labelLabel:w1.oneOfType([w1.string,w1.func]),onLabelClick:w1.func,onLabelRightClick:w1.func,onLabelHover:w1.func,htmlElementsData:w1.arrayOf(w1.object),htmlLat:w1.oneOfType([w1.number,w1.string,w1.func]),htmlLng:w1.oneOfType([w1.number,w1.string,w1.func]),htmlAltitude:w1.oneOfType([w1.number,w1.string,w1.func]),htmlElement:w1.oneOfType([w1.string,w1.func]),htmlElementVisibilityModifier:w1.func,htmlTransitionDuration:w1.number,objectsData:w1.arrayOf(w1.object),objectLat:w1.oneOfType([w1.number,w1.string,w1.func]),objectLng:w1.oneOfType([w1.number,w1.string,w1.func]),objectAltitude:w1.oneOfType([w1.number,w1.string,w1.func]),objectRotation:w1.oneOfType([w1.shape({x:w1.number,y:w1.number,z:w1.number}),w1.string,w1.func]),objectFacesSurface:w1.oneOfType([w1.bool,w1.string,w1.func]),objectThreeObject:w1.oneOfType([w1.object,w1.string,w1.func]),objectLabel:w1.oneOfType([w1.string,w1.func]),onObjectClick:w1.func,onObjectRightClick:w1.func,onObjectHover:w1.func,customLayerData:w1.arrayOf(w1.object),customThreeObject:w1.oneOfType([w1.object,w1.string,w1.func]),customThreeObjectUpdate:w1.oneOfType([w1.string,w1.func]),customLayerLabel:w1.oneOfType([w1.string,w1.func]),onCustomLayerClick:w1.func,onCustomLayerRightClick:w1.func,onCustomLayerHover:w1.func,enablePointerInteraction:w1.bool,pointerEventsFilter:w1.func,lineHoverPrecision:w1.number,onZoom:w1.func},E1=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.wrapperElementType,i=void 0===n?"div":n,a=t.nodeMapper,o=void 0===a?function(e){return e}:a,s=t.methodNames,u=void 0===s?[]:s,l=t.initPropNames,c=void 0===l?[]:l;return(0,r.forwardRef)((function(t,n){var a=(0,r.useRef)(),s=(0,r.useMemo)((function(){var n=Object.fromEntries(c.filter((function(e){return t.hasOwnProperty(e)})).map((function(e){return[e,t[e]]})));return e(n)}),[]);st((function(){s(o(a.current))}),r.useLayoutEffect),st((function(){return s._destructor instanceof Function?s._destructor:void 0}));var l=(0,r.useCallback)((function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return s[e]instanceof Function?s[e].apply(s,n):void 0}),[s]),h=(0,r.useRef)({});return Object.keys(nt(t,[].concat(at(u),at(c)))).filter((function(e){return h.current[e]!==t[e]})).forEach((function(e){return l(e,t[e])})),h.current=t,(0,r.useImperativeHandle)(n,(function(){return Object.fromEntries(u.map((function(e){return[e,function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return l.apply(void 0,[e].concat(n))}]})))}),[l]),r.createElement(i,{ref:a})}))}(x1,{methodNames:["pauseAnimation","resumeAnimation","pointOfView","lights","scene","camera","renderer","postProcessingComposer","controls","getGlobeRadius","getCoords","getScreenCoords","toGeoCoords","toGlobeCoords"],initPropNames:["animateIn","waitForGlobeReady","rendererConfig"]});E1.displayName="Globe",E1.propTypes=S1;var k1=function(){var e=(0,r.useRef)();return(0,r.useEffect)((function(){var t=e.current;t.controls().autoRotate=!0,t.controls().autoRotateSpeed=.5;var n=(new Date).getUTCHours()/24*360;t.pointOfView({lat:0,lng:n},1e3)}),[]),(0,Ye.jsx)("div",{className:"h-screen bg-black",children:(0,Ye.jsx)(E1,{ref:e,globeImageUrl:"//unpkg.com/three-globe/example/img/earth-blue-marble.jpg",backgroundColor:"#0c0c0c"})})},M1=n(939),C1=n.n(M1),R1=n(993),P1=n.n(R1),N1=n(767),I1=n.n(N1);function L1(){return L1=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},L1.apply(this,arguments)}function D1(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,O1(e,t)}function O1(e,t){return O1=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},O1(e,t)}function U1(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t.indexOf(n=a[r])>=0||(i[n]=e[n]);return i}var B1={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title",FRAGMENT:"Symbol(react.fragment)"},F1={rel:["amphtml","canonical","alternate"]},z1={type:["application/ld+json"]},V1={charset:"",name:["robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]},q1=Object.keys(B1).map((function(e){return B1[e]})),j1={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},G1=Object.keys(j1).reduce((function(e,t){return e[j1[t]]=t,e}),{}),H1=function(e,t){for(var n=e.length-1;n>=0;n-=1){var r=e[n];if(Object.prototype.hasOwnProperty.call(r,t))return r[t]}return null},W1=function(e){var t=H1(e,B1.TITLE),n=H1(e,"titleTemplate");if(Array.isArray(t)&&(t=t.join("")),n&&t)return n.replace(/%s/g,(function(){return t}));var r=H1(e,"defaultTitle");return t||r||void 0},X1=function(e){return H1(e,"onChangeClientState")||function(){}},Q1=function(e,t){return t.filter((function(t){return void 0!==t[e]})).map((function(t){return t[e]})).reduce((function(e,t){return L1({},e,t)}),{})},Y1=function(e,t){return t.filter((function(e){return void 0!==e[B1.BASE]})).map((function(e){return e[B1.BASE]})).reverse().reduce((function(t,n){if(!t.length)for(var r=Object.keys(n),i=0;i<r.length;i+=1){var a=r[i].toLowerCase();if(-1!==e.indexOf(a)&&n[a])return t.concat(n)}return t}),[])},K1=function(e,t,n){var r={};return n.filter((function(t){return!!Array.isArray(t[e])||(void 0!==t[e]&&console&&"function"==typeof console.warn&&console.warn("Helmet: "+e+' should be of type "Array". Instead found type "'+typeof t[e]+'"'),!1)})).map((function(t){return t[e]})).reverse().reduce((function(e,n){var i={};n.filter((function(e){for(var n,a=Object.keys(e),o=0;o<a.length;o+=1){var s=a[o],u=s.toLowerCase();-1===t.indexOf(u)||"rel"===n&&"canonical"===e[n].toLowerCase()||"rel"===u&&"stylesheet"===e[u].toLowerCase()||(n=u),-1===t.indexOf(s)||"innerHTML"!==s&&"cssText"!==s&&"itemprop"!==s||(n=s)}if(!n||!e[n])return!1;var l=e[n].toLowerCase();return r[n]||(r[n]={}),i[n]||(i[n]={}),!r[n][l]&&(i[n][l]=!0,!0)})).reverse().forEach((function(t){return e.push(t)}));for(var a=Object.keys(i),o=0;o<a.length;o+=1){var s=a[o],u=L1({},r[s],i[s]);r[s]=u}return e}),[]).reverse()},Z1=function(e,t){if(Array.isArray(e)&&e.length)for(var n=0;n<e.length;n+=1)if(e[n][t])return!0;return!1},J1=function(e){return Array.isArray(e)?e.join(""):e},$1=function(e,t){return Array.isArray(e)?e.reduce((function(e,n){return function(e,t){for(var n=Object.keys(e),r=0;r<n.length;r+=1)if(t[n[r]]&&t[n[r]].includes(e[n[r]]))return!0;return!1}(n,t)?e.priority.push(n):e.default.push(n),e}),{priority:[],default:[]}):{default:e}},e2=function(e,t){var n;return L1({},e,((n={})[t]=void 0,n))},t2=[B1.NOSCRIPT,B1.SCRIPT,B1.STYLE],n2=function(e,t){return void 0===t&&(t=!0),!1===t?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},r2=function(e){return Object.keys(e).reduce((function(t,n){var r=void 0!==e[n]?n+'="'+e[n]+'"':""+n;return t?t+" "+r:r}),"")},i2=function(e,t){return void 0===t&&(t={}),Object.keys(e).reduce((function(t,n){return t[j1[n]||n]=e[n],t}),t)},a2=function(e,t){return t.map((function(t,n){var i,a=((i={key:n})["data-rh"]=!0,i);return Object.keys(t).forEach((function(e){var n=j1[e]||e;"innerHTML"===n||"cssText"===n?a.dangerouslySetInnerHTML={__html:t.innerHTML||t.cssText}:a[n]=t[e]})),r.createElement(e,a)}))},o2=function(e,t,n){switch(e){case B1.TITLE:return{toComponent:function(){return n=t.titleAttributes,(i={key:e=t.title})["data-rh"]=!0,a=i2(n,i),[r.createElement(B1.TITLE,a,e)];var e,n,i,a},toString:function(){return function(e,t,n,r){var i=r2(n),a=J1(t);return i?"<"+e+' data-rh="true" '+i+">"+n2(a,r)+"</"+e+">":"<"+e+' data-rh="true">'+n2(a,r)+"</"+e+">"}(e,t.title,t.titleAttributes,n)}};case"bodyAttributes":case"htmlAttributes":return{toComponent:function(){return i2(t)},toString:function(){return r2(t)}};default:return{toComponent:function(){return a2(e,t)},toString:function(){return function(e,t,n){return t.reduce((function(t,r){var i=Object.keys(r).filter((function(e){return!("innerHTML"===e||"cssText"===e)})).reduce((function(e,t){var i=void 0===r[t]?t:t+'="'+n2(r[t],n)+'"';return e?e+" "+i:i}),""),a=r.innerHTML||r.cssText||"",o=-1===t2.indexOf(e);return t+"<"+e+' data-rh="true" '+i+(o?"/>":">"+a+"</"+e+">")}),"")}(e,t,n)}}}},s2=function(e){var t=e.baseTag,n=e.bodyAttributes,r=e.encode,i=e.htmlAttributes,a=e.noscriptTags,o=e.styleTags,s=e.title,u=void 0===s?"":s,l=e.titleAttributes,c=e.linkTags,h=e.metaTags,f=e.scriptTags,d={toComponent:function(){},toString:function(){return""}};if(e.prioritizeSeoTags){var p=function(e){var t=e.linkTags,n=e.scriptTags,r=e.encode,i=$1(e.metaTags,V1),a=$1(t,F1),o=$1(n,z1);return{priorityMethods:{toComponent:function(){return[].concat(a2(B1.META,i.priority),a2(B1.LINK,a.priority),a2(B1.SCRIPT,o.priority))},toString:function(){return o2(B1.META,i.priority,r)+" "+o2(B1.LINK,a.priority,r)+" "+o2(B1.SCRIPT,o.priority,r)}},metaTags:i.default,linkTags:a.default,scriptTags:o.default}}(e);d=p.priorityMethods,c=p.linkTags,h=p.metaTags,f=p.scriptTags}return{priority:d,base:o2(B1.BASE,t,r),bodyAttributes:o2("bodyAttributes",n,r),htmlAttributes:o2("htmlAttributes",i,r),link:o2(B1.LINK,c,r),meta:o2(B1.META,h,r),noscript:o2(B1.NOSCRIPT,a,r),script:o2(B1.SCRIPT,f,r),style:o2(B1.STYLE,o,r),title:o2(B1.TITLE,{title:u,titleAttributes:l},r)}},u2=[],l2=function(e,t){var n=this;void 0===t&&(t="undefined"!=typeof document),this.instances=[],this.value={setHelmet:function(e){n.context.helmet=e},helmetInstances:{get:function(){return n.canUseDOM?u2:n.instances},add:function(e){(n.canUseDOM?u2:n.instances).push(e)},remove:function(e){var t=(n.canUseDOM?u2:n.instances).indexOf(e);(n.canUseDOM?u2:n.instances).splice(t,1)}}},this.context=e,this.canUseDOM=t,t||(e.helmet=s2({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))},c2=r.createContext({}),h2=T1().shape({setHelmet:T1().func,helmetInstances:T1().shape({get:T1().func,add:T1().func,remove:T1().func})}),f2="undefined"!=typeof document,d2=function(e){function t(n){var r;return(r=e.call(this,n)||this).helmetData=new l2(r.props.context,t.canUseDOM),r}return D1(t,e),t.prototype.render=function(){return r.createElement(c2.Provider,{value:this.helmetData.value},this.props.children)},t}(r.Component);d2.canUseDOM=f2,d2.propTypes={context:T1().shape({helmet:T1().shape()}),children:T1().node.isRequired},d2.defaultProps={context:{}},d2.displayName="HelmetProvider";var p2=function(e,t){var n,r=document.head||document.querySelector(B1.HEAD),i=r.querySelectorAll(e+"[data-rh]"),a=[].slice.call(i),o=[];return t&&t.length&&t.forEach((function(t){var r=document.createElement(e);for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&("innerHTML"===i?r.innerHTML=t.innerHTML:"cssText"===i?r.styleSheet?r.styleSheet.cssText=t.cssText:r.appendChild(document.createTextNode(t.cssText)):r.setAttribute(i,void 0===t[i]?"":t[i]));r.setAttribute("data-rh","true"),a.some((function(e,t){return n=t,r.isEqualNode(e)}))?a.splice(n,1):o.push(r)})),a.forEach((function(e){return e.parentNode.removeChild(e)})),o.forEach((function(e){return r.appendChild(e)})),{oldTags:a,newTags:o}},A2=function(e,t){var n=document.getElementsByTagName(e)[0];if(n){for(var r=n.getAttribute("data-rh"),i=r?r.split(","):[],a=[].concat(i),o=Object.keys(t),s=0;s<o.length;s+=1){var u=o[s],l=t[u]||"";n.getAttribute(u)!==l&&n.setAttribute(u,l),-1===i.indexOf(u)&&i.push(u);var c=a.indexOf(u);-1!==c&&a.splice(c,1)}for(var h=a.length-1;h>=0;h-=1)n.removeAttribute(a[h]);i.length===a.length?n.removeAttribute("data-rh"):n.getAttribute("data-rh")!==o.join(",")&&n.setAttribute("data-rh",o.join(","))}},v2=function(e,t){var n=e.baseTag,r=e.htmlAttributes,i=e.linkTags,a=e.metaTags,o=e.noscriptTags,s=e.onChangeClientState,u=e.scriptTags,l=e.styleTags,c=e.title,h=e.titleAttributes;A2(B1.BODY,e.bodyAttributes),A2(B1.HTML,r),function(e,t){void 0!==e&&document.title!==e&&(document.title=J1(e)),A2(B1.TITLE,t)}(c,h);var f={baseTag:p2(B1.BASE,n),linkTags:p2(B1.LINK,i),metaTags:p2(B1.META,a),noscriptTags:p2(B1.NOSCRIPT,o),scriptTags:p2(B1.SCRIPT,u),styleTags:p2(B1.STYLE,l)},d={},p={};Object.keys(f).forEach((function(e){var t=f[e],n=t.newTags,r=t.oldTags;n.length&&(d[e]=n),r.length&&(p[e]=f[e].oldTags)})),t&&t(),s(e,d,p)},m2=null,g2=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).rendered=!1,t}D1(t,e);var n=t.prototype;return n.shouldComponentUpdate=function(e){return!I1()(e,this.props)},n.componentDidUpdate=function(){this.emitChange()},n.componentWillUnmount=function(){this.props.context.helmetInstances.remove(this),this.emitChange()},n.emitChange=function(){var e,t,n=this.props.context,r=n.setHelmet,i=null,a=(e=n.helmetInstances.get().map((function(e){var t=L1({},e.props);return delete t.context,t})),{baseTag:Y1(["href"],e),bodyAttributes:Q1("bodyAttributes",e),defer:H1(e,"defer"),encode:H1(e,"encodeSpecialCharacters"),htmlAttributes:Q1("htmlAttributes",e),linkTags:K1(B1.LINK,["rel","href"],e),metaTags:K1(B1.META,["name","charset","http-equiv","property","itemprop"],e),noscriptTags:K1(B1.NOSCRIPT,["innerHTML"],e),onChangeClientState:X1(e),scriptTags:K1(B1.SCRIPT,["src","innerHTML"],e),styleTags:K1(B1.STYLE,["cssText"],e),title:W1(e),titleAttributes:Q1("titleAttributes",e),prioritizeSeoTags:Z1(e,"prioritizeSeoTags")});d2.canUseDOM?(t=a,m2&&cancelAnimationFrame(m2),t.defer?m2=requestAnimationFrame((function(){v2(t,(function(){m2=null}))})):(v2(t),m2=null)):s2&&(i=s2(a)),r(i)},n.init=function(){this.rendered||(this.rendered=!0,this.props.context.helmetInstances.add(this),this.emitChange())},n.render=function(){return this.init(),null},t}(r.Component);g2.propTypes={context:h2.isRequired},g2.displayName="HelmetDispatcher";var y2=["children"],_2=["children"],b2=function(e){function t(){return e.apply(this,arguments)||this}D1(t,e);var n=t.prototype;return n.shouldComponentUpdate=function(e){return!C1()(e2(this.props,"helmetData"),e2(e,"helmetData"))},n.mapNestedChildrenToProps=function(e,t){if(!t)return null;switch(e.type){case B1.SCRIPT:case B1.NOSCRIPT:return{innerHTML:t};case B1.STYLE:return{cssText:t};default:throw new Error("<"+e.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")}},n.flattenArrayTypeChildren=function(e){var t,n=e.child,r=e.arrayTypeChildren;return L1({},r,((t={})[n.type]=[].concat(r[n.type]||[],[L1({},e.newChildProps,this.mapNestedChildrenToProps(n,e.nestedChildren))]),t))},n.mapObjectTypeChildren=function(e){var t,n,r=e.child,i=e.newProps,a=e.newChildProps,o=e.nestedChildren;switch(r.type){case B1.TITLE:return L1({},i,((t={})[r.type]=o,t.titleAttributes=L1({},a),t));case B1.BODY:return L1({},i,{bodyAttributes:L1({},a)});case B1.HTML:return L1({},i,{htmlAttributes:L1({},a)});default:return L1({},i,((n={})[r.type]=L1({},a),n))}},n.mapArrayTypeChildrenToProps=function(e,t){var n=L1({},t);return Object.keys(e).forEach((function(t){var r;n=L1({},n,((r={})[t]=e[t],r))})),n},n.warnOnInvalidChildren=function(e,t){return P1()(q1.some((function(t){return e.type===t})),"function"==typeof e.type?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":"Only elements types "+q1.join(", ")+" are allowed. Helmet does not support rendering <"+e.type+"> elements. Refer to our API for more information."),P1()(!t||"string"==typeof t||Array.isArray(t)&&!t.some((function(e){return"string"!=typeof e})),"Helmet expects a string as a child of <"+e.type+">. Did you forget to wrap your children in braces? ( <"+e.type+">{``}</"+e.type+"> ) Refer to our API for more information."),!0},n.mapChildrenToProps=function(e,t){var n=this,i={};return r.Children.forEach(e,(function(e){if(e&&e.props){var r=e.props,a=r.children,o=U1(r,y2),s=Object.keys(o).reduce((function(e,t){return e[G1[t]||t]=o[t],e}),{}),u=e.type;switch("symbol"==typeof u?u=u.toString():n.warnOnInvalidChildren(e,a),u){case B1.FRAGMENT:t=n.mapChildrenToProps(a,t);break;case B1.LINK:case B1.META:case B1.NOSCRIPT:case B1.SCRIPT:case B1.STYLE:i=n.flattenArrayTypeChildren({child:e,arrayTypeChildren:i,newChildProps:s,nestedChildren:a});break;default:t=n.mapObjectTypeChildren({child:e,newProps:t,newChildProps:s,nestedChildren:a})}}})),this.mapArrayTypeChildrenToProps(i,t)},n.render=function(){var e=this.props,t=e.children,n=U1(e,_2),i=L1({},n),a=n.helmetData;return t&&(i=this.mapChildrenToProps(t,i)),!a||a instanceof l2||(a=new l2(a.context,a.instances)),a?r.createElement(g2,L1({},i,{context:a.value,helmetData:void 0})):r.createElement(c2.Consumer,null,(function(e){return r.createElement(g2,L1({},i,{context:e}))}))},t}(r.Component);b2.propTypes={base:T1().object,bodyAttributes:T1().object,children:T1().oneOfType([T1().arrayOf(T1().node),T1().node]),defaultTitle:T1().string,defer:T1().bool,encodeSpecialCharacters:T1().bool,htmlAttributes:T1().object,link:T1().arrayOf(T1().object),meta:T1().arrayOf(T1().object),noscript:T1().arrayOf(T1().object),onChangeClientState:T1().func,script:T1().arrayOf(T1().object),style:T1().arrayOf(T1().object),title:T1().string,titleAttributes:T1().object,titleTemplate:T1().string,prioritizeSeoTags:T1().bool,helmetData:T1().object},b2.defaultProps={defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1},b2.displayName="Helmet";var x2=n(249),w2=n.n(x2),T2="Vedansh Gupta",S2="I\u2019m Vedansh Gupta  Full stack devloper,currently working in Delhi",E2="I\u2019m Vedansh Gupta",k2={first:"I love coding",second:"I code cool websites",third:"I'm just trying......."},M2="I'm a passionate front-end developer crafting modern and cosmic web experiences. Always learning, always building.",C2="A bit about my self",R2="I'm a passionate Tech & Coding enthusiast and a Front-end developer. I'm constantly exploring the exciting world of AI while delving deeper into my field. I thrive on managing Human Resources and creating meaningful connections between organizations. Sharing my work, thoughts, and experiences here fills me with absolute joy!.",P2=[{jobtitle:"Tech HR and Co-lead",where:"GDSC",date:"2024"},{jobtitle:"Website Developer",where:"EIT, Faridabad",date:"2024"},{jobtitle:"Hackathon Organiser",where:"EIT, Faridabad",date:"2024"}],N2=[{name:"React",value:90},{name:"Tailwind CSS",value:85},{name:"Javascript",value:80}],I2=[{title:"UI & UX Design",description:" A creative UI/UX designer blending aesthetics with user-centric design. Turning ideas into intuitive interfaces."},{title:"Website Development",description:"I build responsive and modern websites with seamless user experiences. Crafting pixel-perfect websites that don\u2019t just look good \u2014 they work beautifully."}],L2=[{img:"https://picsum.photos/400/?grayscale",description:"Echiesta.com ",link:"https://github.com/Thevedanshgupta/echiesta.com"},{img:"https://picsum.photos/400/800/?grayscale",description:" Moons.com",link:"https://github.com/Thevedanshgupta/moons"},{img:"https://picsum.photos/400/600/?grayscale",description:"ITSolutionWebsite ",link:"https://github.com/Thevedanshgupta/itsolutionwebsite"},{img:"https://picsum.photos/400/300/?grayscale",description:" Adding Soon..",link:""},{img:"https://picsum.photos/400/550/?grayscale",description:"ImageX ",link:"https://github.com/Thevedanshgupta/imagex"},{img:"https://picsum.photos/400/700/?grayscale",description:"Adding Soon..",link:"#"}],D2={YOUR_EMAIL:"studentvedansh@gmail.com",YOUR_FONE:"+91-8070101188",description:"Have an idea, a project, or just want to say hello? I\u2019m always excited to connect with passionate people. Whether you're looking for a fresh UI/UX design, a responsive website, or a creative mind to collaborate with \u2014 I\u2019m here for it. Let\u2019s turn your vision into reality. Feel free to drop a message!",YOUR_SERVICE_ID:"service_hj8fol7",YOUR_TEMPLATE_ID:"template_c0o4idh",YOUR_USER_ID:"YpPUT8fG97VlQtd-Q"},O2={github:"https://github.com/Thevedanshgupta",instagram:"https://instagram.com/vedanshguptaa",linkedin:"https://www.linkedin.com/in/thevedanshgupta/"},U2=function(){var e=T((0,r.useState)("dark"),2),t=(e[0],e[1]);return(0,r.useEffect)((function(){var e=localStorage.getItem("theme")||"dark";t(e);var n=new MutationObserver((function(){var e=document.documentElement.getAttribute("data-theme");t(e)}));return n.observe(document.documentElement,{attributes:!0}),function(){return n.disconnect()}}),[]),(0,Ye.jsx)(d2,{children:(0,Ye.jsxs)("section",{id:"home",className:"home",children:[(0,Ye.jsxs)(b2,{children:[(0,Ye.jsx)("meta",{charSet:"utf-8"}),(0,Ye.jsx)("title",{children:T2}),(0,Ye.jsx)("meta",{name:"description",content:S2})]}),(0,Ye.jsxs)("div",{className:"home-flex-container",children:[(0,Ye.jsx)("div",{className:"home-text",children:(0,Ye.jsxs)("div",{className:"intro mx-auto",children:[(0,Ye.jsx)("h2",{className:"mb-1x",children:E2}),(0,Ye.jsx)("h1",{className:"fluidz-48 mb-1x",children:(0,Ye.jsx)(w2(),{options:{strings:[k2.first,k2.second,k2.third],autoStart:!0,loop:!0,deleteSpeed:10}})}),(0,Ye.jsx)("p",{className:"mb-1x",children:M2}),(0,Ye.jsxs)("div",{className:"intro_btn-action pb-5",children:[(0,Ye.jsx)(je,{to:"/portfolio",className:"text_2",children:(0,Ye.jsxs)("div",{id:"button_p",className:"ac_btn btn",children:["My Portfolio",(0,Ye.jsx)("div",{className:"ring one"}),(0,Ye.jsx)("div",{className:"ring two"}),(0,Ye.jsx)("div",{className:"ring three"})]})}),(0,Ye.jsx)(je,{to:"/contact",children:(0,Ye.jsxs)("div",{id:"button_h",className:"ac_btn btn",children:["Contact Me",(0,Ye.jsx)("div",{className:"ring one"}),(0,Ye.jsx)("div",{className:"ring two"}),(0,Ye.jsx)("div",{className:"ring three"})]})}),(0,Ye.jsx)("a",{href:"/ResumeVedansh.pdf",target:"_blank",rel:"noopener noreferrer",className:"text_2",children:(0,Ye.jsxs)("div",{id:"button_p",className:"ac_btn btn",children:["Resume",(0,Ye.jsx)("div",{className:"ring one"}),(0,Ye.jsx)("div",{className:"ring two"}),(0,Ye.jsx)("div",{className:"ring three"})]})})]})]})}),(0,Ye.jsx)("div",{className:"home-globe",children:(0,Ye.jsx)(k1,{})})]})]})})};function B2(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}function F2(e,t){if(null==e)return{};var n,r,i=B2(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var z2=n(123),V2=n.n(z2),q2=["xxl","xl","lg","md","sm","xs"],j2=r.createContext({prefixes:{},breakpoints:q2,minBreakpoint:"xs"});j2.Consumer,j2.Provider;function G2(e,t){var n=(0,r.useContext)(j2).prefixes;return e||n[t]||t}function H2(){return(0,r.useContext)(j2).breakpoints}function W2(){return(0,r.useContext)(j2).minBreakpoint}var X2=["bsPrefix","fluid","as","className"],Q2=r.forwardRef((function(e,t){var n=e.bsPrefix,r=e.fluid,i=e.as,a=void 0===i?"div":i,o=e.className,s=F2(e,X2),u=G2(n,"container"),l="string"===typeof r?"-".concat(r):"-fluid";return(0,Ye.jsx)(a,Qe(Qe({ref:t},s),{},{className:V2()(o,r?"".concat(u).concat(l):u)}))}));Q2.displayName="Container",Q2.defaultProps={fluid:!1};var Y2=Q2,K2=["bsPrefix","className","as"],Z2=r.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,i=e.as,a=void 0===i?"div":i,o=F2(e,K2),s=G2(n,"row"),u=H2(),l=W2(),c="".concat(s,"-cols"),h=[];return u.forEach((function(e){var t,n=o[e];delete o[e],t=null!=n&&"object"===typeof n?n.cols:n;var r=e!==l?"-".concat(e):"";null!=t&&h.push("".concat(c).concat(r,"-").concat(t))})),(0,Ye.jsx)(a,Qe(Qe({ref:t},o),{},{className:V2().apply(void 0,[r,s].concat(h))}))}));Z2.displayName="Row";var J2=Z2,$2=["as","bsPrefix","className"],e3=["className"];var t3=r.forwardRef((function(e,t){var n=function(e){var t=e.as,n=e.bsPrefix,r=e.className,i=F2(e,$2);n=G2(n,"col");var a=H2(),o=W2(),s=[],u=[];return a.forEach((function(e){var t,r,a,l=i[e];delete i[e],"object"===typeof l&&null!=l?(t=l.span,r=l.offset,a=l.order):t=l;var c=e!==o?"-".concat(e):"";t&&s.push(!0===t?"".concat(n).concat(c):"".concat(n).concat(c,"-").concat(t)),null!=a&&u.push("order".concat(c,"-").concat(a)),null!=r&&u.push("offset".concat(c,"-").concat(r))})),[Qe(Qe({},i),{},{className:V2().apply(void 0,[r].concat(s,u))}),{as:t,bsPrefix:n,spans:s}]}(e),r=T(n,2),i=r[0],a=i.className,o=F2(i,e3),s=r[1],u=s.as,l=void 0===u?"div":u,c=s.bsPrefix,h=s.spans;return(0,Ye.jsx)(l,Qe(Qe({},o),{},{ref:t,className:V2()(a,!h.length&&c)}))}));t3.displayName="Col";var n3=t3,r3=function(){return(0,Ye.jsx)(d2,{children:(0,Ye.jsxs)(Y2,{className:"About-header",children:[(0,Ye.jsxs)(b2,{children:[(0,Ye.jsx)("meta",{charSet:"utf-8"}),(0,Ye.jsxs)("title",{children:[" Portfolio | ",T2," "]})," ",(0,Ye.jsx)("meta",{name:"description",content:S2})]}),(0,Ye.jsx)(J2,{className:"mb-5 mt-3 pt-md-3",children:(0,Ye.jsxs)(n3,{lg:"8",children:[(0,Ye.jsx)("h1",{className:"display-4 mb-4",children:" Portfolio "})," ",(0,Ye.jsx)("hr",{className:"t_border my-4 ml-0 text-left"})]})}),(0,Ye.jsx)("div",{className:"mb-5 po_items_ho",children:L2.map((function(e,t){return(0,Ye.jsxs)("div",{className:"po_item",children:[(0,Ye.jsx)("img",{src:e.img,alt:""}),(0,Ye.jsxs)("div",{className:"content",children:[(0,Ye.jsx)("p",{children:e.description}),(0,Ye.jsx)("a",{href:e.link,children:"View project"})]})]},t)}))})]})})},i3={_origin:"https://api.emailjs.com"},a3=function(e,t,n){if(!e)throw"The user ID is required. Visit https://dashboard.emailjs.com/admin/integration";if(!t)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!n)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0},o3=p((function e(t){c(this,e),this.status=t.status,this.text=t.responseText})),s3=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(r,i){var a=new XMLHttpRequest;a.addEventListener("load",(function(e){var t=e.target,n=new o3(t);200===n.status||"OK"===n.text?r(n):i(n)})),a.addEventListener("error",(function(e){var t=e.target;i(new o3(t))})),a.open("POST",i3._origin+e,!0),Object.keys(n).forEach((function(e){a.setRequestHeader(e,n[e])})),a.send(t)}))},u3=function(e,t,n,r){var i=r||i3._userID;a3(i,e,t);var a={lib_version:"3.2.0",user_id:i,service_id:e,template_id:t,template_params:n};return s3("/api/v1.0/email/send",JSON.stringify(a),{"Content-type":"application/json"})};function l3(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}function c3(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}function h3(e,t){return Object.keys(t).reduce((function(n,i){var a,o=n,s=o[l3(i)],u=o[i],l=B2(o,[l3(i),i].map(c3)),c=t[i],h=function(e,t,n){var i=(0,r.useRef)(void 0!==e),a=(0,r.useState)(t),o=a[0],s=a[1],u=void 0!==e,l=i.current;return i.current=u,!u&&l&&o!==t&&s(t),[u?e:o,(0,r.useCallback)((function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];n&&n.apply(void 0,[e].concat(r)),s(e)}),[n])]}(u,s,e[c]),f=h[0],d=h[1];return sJ({},l,((a={})[i]=f,a[c]=d,a))}),e)}function f3(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==e&&void 0!==e&&this.setState(e)}function d3(e){this.setState(function(t){var n=this.constructor.getDerivedStateFromProps(e,t);return null!==n&&void 0!==n?n:null}.bind(this))}function p3(e,t){try{var n=this.props,r=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,r)}finally{this.props=n,this.state=r}}f3.__suppressDeprecationWarning=!0,d3.__suppressDeprecationWarning=!0,p3.__suppressDeprecationWarning=!0;var A3=function(e){var t=(0,r.useRef)(e);return(0,r.useEffect)((function(){t.current=e}),[e]),t};function v3(e){var t=A3(e);return(0,r.useCallback)((function(){return t.current&&t.current.apply(t,arguments)}),[t])}var m3="undefined"!==typeof n.g&&n.g.navigator&&"ReactNative"===n.g.navigator.product;"undefined"!==typeof document||m3?r.useLayoutEffect:r.useEffect,new WeakMap;var g3=["as","disabled"];function y3(e){var t=e.tagName,n=e.disabled,r=e.href,i=e.target,a=e.rel,o=e.role,s=e.onClick,u=e.tabIndex,l=void 0===u?0:u,c=e.type;t||(t=null!=r||null!=i||null!=a?"a":"button");var h={tagName:t};if("button"===t)return[{type:c||"button",disabled:n},h];var f=function(e){(n||"a"===t&&function(e){return!e||"#"===e.trim()}(r))&&e.preventDefault(),n?e.stopPropagation():null==s||s(e)};return"a"===t&&(r||(r="#"),n&&(r=void 0)),[{role:null!=o?o:"button",disabled:void 0,tabIndex:n?void 0:l,href:r,target:"a"===t?i:void 0,"aria-disabled":n||void 0,rel:"a"===t?a:void 0,onClick:f,onKeyDown:function(e){" "===e.key&&(e.preventDefault(),f(e))}},h]}var _3=r.forwardRef((function(e,t){var n=e.as,r=e.disabled,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,g3),a=T(y3(Object.assign({tagName:n,disabled:r},i)),2),o=a[0],s=a[1].tagName;return(0,Ye.jsx)(s,Object.assign({},i,o,{ref:t}))}));_3.displayName="Button";var b3=["onKeyDown"];var x3=r.forwardRef((function(e,t){var n,r=e.onKeyDown,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,b3),a=T(y3(Object.assign({tagName:"a"},i)),1)[0],o=v3((function(e){a.onKeyDown(e),null==r||r(e)}));return(n=i.href)&&"#"!==n.trim()&&"button"!==i.role?(0,Ye.jsx)("a",Object.assign({ref:t},i,{onKeyDown:r})):(0,Ye.jsx)("a",Object.assign({ref:t},i,a,{onKeyDown:o}))}));x3.displayName="Anchor";var w3=x3,T3=n(168),S3=!1,E3=r.createContext(null),k3=function(e){return e.scrollTop},M3="unmounted",C3="exited",R3="entering",P3="entered",N3="exiting",I3=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var i,a=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?a?(i=C3,r.appearStatus=R3):i=P3:i=t.unmountOnExit||t.mountOnEnter?M3:C3,r.state={status:i},r.nextCallback=null,r}uJ(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===M3?{status:C3}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==R3&&n!==P3&&(t=R3):n!==R3&&n!==P3||(t=N3)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!==typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===R3){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:T3.findDOMNode(this);n&&k3(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===C3&&this.setState({status:M3})},n.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,i=this.props.nodeRef?[r]:[T3.findDOMNode(this),r],a=i[0],o=i[1],s=this.getTimeouts(),u=r?s.appear:s.enter;!e&&!n||S3?this.safeSetState({status:P3},(function(){t.props.onEntered(a)})):(this.props.onEnter(a,o),this.safeSetState({status:R3},(function(){t.props.onEntering(a,o),t.onTransitionEnd(u,(function(){t.safeSetState({status:P3},(function(){t.props.onEntered(a,o)}))}))})))},n.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:T3.findDOMNode(this);t&&!S3?(this.props.onExit(r),this.safeSetState({status:N3},(function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:C3},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:C3},(function(){e.props.onExited(r)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:T3.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],a=i[0],o=i[1];this.props.addEndListener(a,o)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===M3)return null;var t=this.props,n=t.children,i=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,B2(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return r.createElement(E3.Provider,{value:null},"function"===typeof n?n(e,i):r.cloneElement(r.Children.only(n),i))},t}(r.Component);function L3(){}I3.contextType=E3,I3.propTypes={},I3.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:L3,onEntering:L3,onEntered:L3,onExit:L3,onExiting:L3,onExited:L3},I3.UNMOUNTED=M3,I3.EXITED=C3,I3.ENTERING=R3,I3.ENTERED=P3,I3.EXITING=N3;var D3=I3;function O3(e){var t=function(e){return e&&e.ownerDocument||document}(e);return t&&t.defaultView||window}var U3=/([A-Z])/g;var B3=/^ms-/;function F3(e){return function(e){return e.replace(U3,"-$1").toLowerCase()}(e).replace(B3,"-ms-")}var z3=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;var V3=function(e,t){var n="",r="";if("string"===typeof t)return e.style.getPropertyValue(F3(t))||function(e,t){return O3(e).getComputedStyle(e,t)}(e).getPropertyValue(F3(t));Object.keys(t).forEach((function(i){var a=t[i];a||0===a?!function(e){return!(!e||!z3.test(e))}(i)?n+=F3(i)+": "+a+";":r+=i+"("+a+") ":e.style.removeProperty(F3(i))})),r&&(n+="transform: "+r+";"),e.style.cssText+=";"+n},q3=!("undefined"===typeof window||!window.document||!window.document.createElement),j3=!1,G3=!1;try{var H3={get passive(){return j3=!0},get once(){return G3=j3=!0}};q3&&(window.addEventListener("test",H3,H3),window.removeEventListener("test",H3,!0))}catch(p0){}var W3=function(e,t,n,r){if(r&&"boolean"!==typeof r&&!G3){var i=r.once,a=r.capture,o=n;!G3&&i&&(o=n.__once||function e(r){this.removeEventListener(t,e,a),n.call(this,r)},n.__once=o),e.addEventListener(t,o,j3?r:a)}e.addEventListener(t,n,r)};var X3=function(e,t,n,r){var i=r&&"boolean"!==typeof r?r.capture:r;e.removeEventListener(t,n,i),n.__once&&e.removeEventListener(t,n.__once,i)};var Q3=function(e,t,n,r){return W3(e,t,n,r),function(){X3(e,t,n,r)}};function Y3(e,t,n){void 0===n&&(n=5);var r=!1,i=setTimeout((function(){r||function(e,t,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=!0),e){var i=document.createEvent("HTMLEvents");i.initEvent(t,n,r),e.dispatchEvent(i)}}(e,"transitionend",!0)}),t+n),a=Q3(e,"transitionend",(function(){r=!0}),{once:!0});return function(){clearTimeout(i),a()}}function K3(e,t,n,r){null==n&&(n=function(e){var t=V3(e,"transitionDuration")||"",n=-1===t.indexOf("ms")?1e3:1;return parseFloat(t)*n}(e)||0);var i=Y3(e,n,r),a=Q3(e,"transitionend",t);return function(){i(),a()}}function Z3(e,t){var n=V3(e,t)||"",r=-1===n.indexOf("ms")?1e3:1;return parseFloat(n)*r}function J3(e,t){var n=Z3(e,"transitionDuration"),r=Z3(e,"transitionDelay"),i=K3(e,(function(n){n.target===e&&(i(),t(n))}),n+r)}var $3=function(e){return e&&"function"!==typeof e?function(t){e.current=t}:e};var e4=function(e,t){return(0,r.useMemo)((function(){return function(e,t){var n=$3(e),r=$3(t);return function(e){n&&n(e),r&&r(e)}}(e,t)}),[e,t])};var t4,n4=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children","childRef"],r4=r.forwardRef((function(e,t){var n=e.onEnter,i=e.onEntering,a=e.onEntered,o=e.onExit,s=e.onExiting,u=e.onExited,l=e.addEndListener,c=e.children,h=e.childRef,f=F2(e,n4),d=(0,r.useRef)(null),p=e4(d,h),A=function(e){var t;p((t=e)&&"setState"in t?T3.findDOMNode(t):null!=t?t:null)},v=function(e){return function(t){e&&d.current&&e(d.current,t)}},m=(0,r.useCallback)(v(n),[n]),g=(0,r.useCallback)(v(i),[i]),y=(0,r.useCallback)(v(a),[a]),_=(0,r.useCallback)(v(o),[o]),b=(0,r.useCallback)(v(s),[s]),x=(0,r.useCallback)(v(u),[u]),w=(0,r.useCallback)(v(l),[l]);return(0,Ye.jsx)(D3,Qe(Qe({ref:t},f),{},{onEnter:m,onEntered:y,onEntering:g,onExit:_,onExited:x,onExiting:b,addEndListener:w,nodeRef:d,children:"function"===typeof c?function(e,t){return c(e,Qe(Qe({},t),{},{ref:A}))}:r.cloneElement(c,{ref:A})}))})),i4=r4,a4=["className","children","transitionClasses"],o4=(We(t4={},R3,"show"),We(t4,P3,"show"),t4),s4=r.forwardRef((function(e,t){var n=e.className,i=e.children,a=e.transitionClasses,o=void 0===a?{}:a,s=F2(e,a4),u=(0,r.useCallback)((function(e,t){!function(e){e.offsetHeight}(e),null==s.onEnter||s.onEnter(e,t)}),[s]);return(0,Ye.jsx)(i4,Qe(Qe({ref:t,addEndListener:J3},s),{},{onEnter:u,childRef:i.ref,children:function(e,t){return r.cloneElement(i,Qe(Qe({},t),{},{className:V2()("fade",n,i.props.className,o4[e],o[e])}))}}))}));s4.defaultProps={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1},s4.displayName="Fade";var u4=s4,l4=["className","variant"],c4={"aria-label":T1().string,onClick:T1().func,variant:T1().oneOf(["white"])},h4=r.forwardRef((function(e,t){var n=e.className,r=e.variant,i=F2(e,l4);return(0,Ye.jsx)("button",Qe({ref:t,type:"button",className:V2()("btn-close",r&&"btn-close-".concat(r),n)},i))}));h4.displayName="CloseButton",h4.propTypes=c4,h4.defaultProps={"aria-label":"Close"};var f4=h4,d4=/-(.)/g;var p4=["className","bsPrefix","as"],A4=function(e){return e[0].toUpperCase()+function(e){return e.replace(d4,(function(e,t){return t.toUpperCase()}))}(e).slice(1)};function v4(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.displayName,i=void 0===n?A4(e):n,a=t.Component,o=t.defaultProps,s=r.forwardRef((function(t,n){var r=t.className,i=t.bsPrefix,o=t.as,s=void 0===o?a||"div":o,u=F2(t,p4),l=G2(i,e);return(0,Ye.jsx)(s,Qe({ref:n,className:V2()(r,l)},u))}));return s.defaultProps=o,s.displayName=i,s}var m4,g4=["bsPrefix","show","closeLabel","closeVariant","className","children","variant","onClose","dismissible","transition"],y4=(m4="h4",r.forwardRef((function(e,t){return(0,Ye.jsx)("div",Qe(Qe({},e),{},{ref:t,className:V2()(e.className,m4)}))})));y4.displayName="DivStyledAsH4";var _4=v4("alert-heading",{Component:y4}),b4=v4("alert-link",{Component:w3}),x4={variant:"primary",show:!0,transition:u4,closeLabel:"Close alert"},w4=r.forwardRef((function(e,t){var n=h3(e,{show:"onClose"}),r=n.bsPrefix,i=n.show,a=n.closeLabel,o=n.closeVariant,s=n.className,u=n.children,l=n.variant,c=n.onClose,h=n.dismissible,f=n.transition,d=F2(n,g4),p=G2(r,"alert"),A=v3((function(e){c&&c(!1,e)})),v=!0===f?u4:f,m=(0,Ye.jsxs)("div",Qe(Qe({role:"alert"},v?void 0:d),{},{ref:t,className:V2()(s,p,l&&"".concat(p,"-").concat(l),h&&"".concat(p,"-dismissible")),children:[h&&(0,Ye.jsx)(f4,{onClick:A,"aria-label":a,variant:o}),u]}));return v?(0,Ye.jsx)(v,Qe(Qe({unmountOnExit:!0},d),{},{ref:void 0,in:i,children:m})):i?m:null}));w4.displayName="Alert",w4.defaultProps=x4;var T4=Object.assign(w4,{Link:b4,Heading:_4}),S4=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},E4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,s=o?e[i+1]:0,u=i+2<e.length,l=u?e[i+2]:0,c=a>>2,h=(3&a)<<4|s>>4,f=(15&s)<<2|l>>6,d=63&l;u||(d=64,o||(f=64)),r.push(n[c],n[h],n[f],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(S4(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==s||null==u)throw new k4;var l=a<<2|o>>4;if(r.push(l),64!==s){var c=o<<4&240|s>>2;if(r.push(c),64!==u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},k4=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.apply(this,arguments)).name="DecodeBase64StringError",e}return p(n)}(E(Error)),M4=function(e){return function(e){var t=S4(e);return E4.encodeByteArray(t,!0)}(e).replace(/\./g,"")},C4=function(e){try{return E4.decodeString(e,!0)}catch(p0){console.error("base64Decode failed: ",p0)}return null};var R4=function(){return function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__},P4=function(){try{return R4()||function(){if("undefined"!==typeof process){var e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0}}()||function(){if("undefined"!==typeof document){var e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(p0){return}var t=e&&C4(e[1]);return t&&JSON.parse(t)}}()}catch(p0){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(p0))}},N4=function(e){var t,n;return null===(n=null===(t=P4())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},I4=function(){var e;return null===(e=P4())||void 0===e?void 0:e.config},L4=function(e){var t;return null===(t=P4())||void 0===t?void 0:t["_".concat(e)]},D4=function(){function e(){var t=this;c(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return p(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"===typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),e}();function O4(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function U4(){return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function B4(){try{return"object"===typeof indexedDB}catch(p0){return!1}}var F4=function(e){v(n,e);var t=b(n);function n(e,r,i){var a;return c(this,n),(a=t.call(this,r)).code=e,a.customData=i,a.name="FirebaseError",Object.setPrototypeOf(y(a),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(y(a),z4.prototype.create),a}return p(n)}(E(Error)),z4=function(){function e(t,n,r){c(this,e),this.service=t,this.serviceName=n,this.errors=r}return p(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?V4(r,t):"Error",a="".concat(this.serviceName,": ").concat(i," (").concat(n,")."),o=new F4(n,a,t);return o}}]),e}();function V4(e,t){return e.replace(q4,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}var q4=/\{\$([^}]+)}/g;function j4(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function G4(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var s=e[o],u=t[o];if(H4(s)&&H4(u)){if(!G4(s,u))return!1}else if(s!==u)return!1}for(var l=0,c=r;l<c.length;l++){var h=c[l];if(!n.includes(h))return!1}return!0}function H4(e){return null!==e&&"object"===typeof e}function W4(e){for(var t=[],n=function(){var e=T(i[r],2),n=e[0],a=e[1];Array.isArray(a)?a.forEach((function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))},r=0,i=Object.entries(e);r<i.length;r++)n();return t.length?"&"+t.join("&"):""}function X4(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=T(e.split("="),2),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}})),t}function Q4(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var Y4=function(){function e(t,n){var r=this;c(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then((function(){t(r)})).catch((function(e){r.error(e)}))}return p(e,[{key:"next",value:function(e){this.forEachObserver((function(t){t.next(e)}))}},{key:"error",value:function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)}},{key:"complete",value:function(){this.forEachObserver((function(e){e.complete()})),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=k(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i in e&&"function"===typeof e[i])return!0}}catch(a){r.e(a)}finally{r.f()}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=K4),void 0===r.error&&(r.error=K4),void 0===r.complete&&(r.complete=K4);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(p0){}})),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(p0){"undefined"!==typeof console&&console.error&&console.error(p0)}}))}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))}}]),e}();function K4(){}function Z4(e){return e&&e._delegate?e._delegate:e}var J4=function(){function e(t,n,r){c(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return p(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),$4="[DEFAULT]",e5=function(){function e(t,n){c(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return p(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new D4;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(p0){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(p0){if(r)return null;throw p0}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:$4})}catch(p0){}var t,n=k(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=T(t.value,2),i=r[0],a=r[1],o=this.normalizeInstanceIdentifier(i);try{var s=this.getOrInitializeService({instanceIdentifier:o});a.resolve(s)}catch(p0){}}}catch(u){n.e(u)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$4;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=lt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Array.from(this.instances.values()),e.next=3,Promise.all([].concat(l(t.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))),l(t.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$4;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$4;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=k(this.instancesDeferred.entries());try{for(o.s();!(i=o.n()).done;){var s=T(i.value,2),u=s[0],l=s[1],c=this.normalizeInstanceIdentifier(u);r===c&&l.resolve(a)}}catch(h){o.e(h)}finally{o.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,i=k(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a(e,t)}catch(Bl){}}}catch(o){i.e(o)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===$4?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(Bl){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$4;return this.component?this.component.multipleInstances?e:$4:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}();var t5,n5,r5=function(){function e(t){c(this,e),this.name=t,this.providers=new Map}return p(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new e5(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),i5=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(n5||(n5={}));var a5={debug:n5.DEBUG,verbose:n5.VERBOSE,info:n5.INFO,warn:n5.WARN,error:n5.ERROR,silent:n5.SILENT},o5=n5.INFO,s5=(We(t5={},n5.DEBUG,"log"),We(t5,n5.VERBOSE,"log"),We(t5,n5.INFO,"info"),We(t5,n5.WARN,"warn"),We(t5,n5.ERROR,"error"),t5),u5=function(e,t){if(!(t<e.logLevel)){var n=(new Date).toISOString(),r=s5[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i,a=arguments.length,o=new Array(a>2?a-2:0),s=2;s<a;s++)o[s-2]=arguments[s];(i=console)[r].apply(i,["[".concat(n,"]  ").concat(e.name,":")].concat(o))}},l5=function(){function e(t){c(this,e),this.name=t,this._logLevel=o5,this._logHandler=u5,this._userLogHandler=null,i5.push(this)}return p(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in n5))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"===typeof e?a5[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,n5.DEBUG].concat(t)),this._logHandler.apply(this,[this,n5.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,n5.VERBOSE].concat(t)),this._logHandler.apply(this,[this,n5.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,n5.INFO].concat(t)),this._logHandler.apply(this,[this,n5.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,n5.WARN].concat(t)),this._logHandler.apply(this,[this,n5.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,n5.ERROR].concat(t)),this._logHandler.apply(this,[this,n5.ERROR].concat(t))}}]),e}();var c5,h5;var f5=new WeakMap,d5=new WeakMap,p5=new WeakMap,A5=new WeakMap,v5=new WeakMap;var m5={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return d5.get(e);if("objectStoreNames"===t)return e.objectStoreNames||p5.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return _5(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function g5(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(h5||(h5=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(b5(this),n),_5(f5.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return _5(e.apply(b5(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=e.call.apply(e,[b5(this),t].concat(r));return p5.set(a,t.sort?t.sort():[t]),_5(a)}}function y5(e){return"function"===typeof e?g5(e):(e instanceof IDBTransaction&&function(e){if(!d5.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)}));d5.set(e,t)}}(e),function(e,t){return t.some((function(t){return e instanceof t}))}(e,c5||(c5=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,m5):e)}function _5(e){if(e instanceof IDBRequest)return function(e){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("success",i),e.removeEventListener("error",a)},i=function(){t(_5(e.result)),r()},a=function(){n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)}));return t.then((function(t){t instanceof IDBCursor&&f5.set(t,e)})).catch((function(){})),v5.set(t,e),t}(e);if(A5.has(e))return A5.get(e);var t=y5(e);return t!==e&&(A5.set(e,t),v5.set(t,e)),t}var b5=function(e){return v5.get(e)};var x5,w5,T5=["get","getKey","getAll","getAllKeys","count"],S5=["put","add","delete","clear"],E5=new Map;function k5(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"===typeof t){if(E5.get(t))return E5.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,i=S5.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(i||T5.includes(n))){var a=function(){var e=lt(ft().mark((function e(t){var a,o,s,u,l,c,h=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=this.transaction(t,i?"readwrite":"readonly"),s=o.store,u=h.length,l=new Array(u>1?u-1:0),c=1;c<u;c++)l[c-1]=h[c];return r&&(s=s.index(l.shift())),e.next=6,Promise.all([(a=s)[n].apply(a,l),i&&o.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return E5.set(t,a),a}}}m5=function(e){return Qe(Qe({},e),{},{get:function(t,n,r){return k5(t,n)||e.get(t,n,r)},has:function(t,n){return!!k5(t,n)||e.has(t,n)}})}(m5);var M5=function(){function e(t){c(this,e),this.container=t}return p(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),e}();var C5="@firebase/app",R5="0.11.4",P5=new l5("@firebase/app"),N5="[DEFAULT]",I5=(We(x5={},C5,"fire-core"),We(x5,"@firebase/app-compat","fire-core-compat"),We(x5,"@firebase/analytics","fire-analytics"),We(x5,"@firebase/analytics-compat","fire-analytics-compat"),We(x5,"@firebase/app-check","fire-app-check"),We(x5,"@firebase/app-check-compat","fire-app-check-compat"),We(x5,"@firebase/auth","fire-auth"),We(x5,"@firebase/auth-compat","fire-auth-compat"),We(x5,"@firebase/database","fire-rtdb"),We(x5,"@firebase/data-connect","fire-data-connect"),We(x5,"@firebase/database-compat","fire-rtdb-compat"),We(x5,"@firebase/functions","fire-fn"),We(x5,"@firebase/functions-compat","fire-fn-compat"),We(x5,"@firebase/installations","fire-iid"),We(x5,"@firebase/installations-compat","fire-iid-compat"),We(x5,"@firebase/messaging","fire-fcm"),We(x5,"@firebase/messaging-compat","fire-fcm-compat"),We(x5,"@firebase/performance","fire-perf"),We(x5,"@firebase/performance-compat","fire-perf-compat"),We(x5,"@firebase/remote-config","fire-rc"),We(x5,"@firebase/remote-config-compat","fire-rc-compat"),We(x5,"@firebase/storage","fire-gcs"),We(x5,"@firebase/storage-compat","fire-gcs-compat"),We(x5,"@firebase/firestore","fire-fst"),We(x5,"@firebase/firestore-compat","fire-fst-compat"),We(x5,"@firebase/vertexai","fire-vertex"),We(x5,"fire-js","fire-js"),We(x5,"firebase","fire-js-all"),x5),L5=new Map,D5=new Map,O5=new Map;function U5(e,t){try{e.container.addComponent(t)}catch(p0){P5.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),p0)}}function B5(e){var t=e.name;if(O5.has(t))return P5.debug("There were multiple attempts to register component ".concat(t,".")),!1;O5.set(t,e);var n,r=k(L5.values());try{for(r.s();!(n=r.n()).done;){U5(n.value,e)}}catch(o){r.e(o)}finally{r.f()}var i,a=k(D5.values());try{for(a.s();!(i=a.n()).done;){U5(i.value,e)}}catch(o){a.e(o)}finally{a.f()}return!0}function F5(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function z5(e){return null!==e&&void 0!==e&&void 0!==e.settings}var V5=(We(w5={},"no-app","No Firebase App '{$appName}' has been created - call initializeApp() first"),We(w5,"bad-app-name","Illegal App name: '{$appName}'"),We(w5,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),We(w5,"app-deleted","Firebase App named '{$appName}' already deleted"),We(w5,"server-app-deleted","Firebase Server App has been deleted"),We(w5,"no-options","Need to provide options, when not being deployed to hosting via source."),We(w5,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),We(w5,"invalid-log-argument","First argument to `onLog` must be null or a function."),We(w5,"idb-open","Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}."),We(w5,"idb-get","Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}."),We(w5,"idb-set","Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}."),We(w5,"idb-delete","Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."),We(w5,"finalization-registry-not-supported","FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry."),We(w5,"invalid-server-app-environment","FirebaseServerApp is not for use in browser environments."),w5),q5=new z4("app","Firebase",V5),j5=function(){function e(t,n,r){var i=this;c(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new J4("app",(function(){return i}),"PUBLIC"))}return p(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw q5.create("app-deleted",{appName:this._name})}}]),e}();var G5="11.6.0";function H5(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){var r=t;t={name:r}}var i=Object.assign({name:N5,automaticDataCollectionEnabled:!1},t),a=i.name;if("string"!==typeof a||!a)throw q5.create("bad-app-name",{appName:String(a)});if(n||(n=I4()),!n)throw q5.create("no-options");var o=L5.get(a);if(o){if(G4(n,o.options)&&G4(i,o.config))return o;throw q5.create("duplicate-app",{appName:a})}var s,u=new r5(a),l=k(O5.values());try{for(l.s();!(s=l.n()).done;){var c=s.value;u.addComponent(c)}}catch(f){l.e(f)}finally{l.f()}var h=new j5(n,i,u);return L5.set(a,h),h}function W5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N5,t=L5.get(e);if(!t&&e===N5&&I4())return H5();if(!t)throw q5.create("no-app",{appName:e});return t}function X5(e,t,n){var r,i=null!==(r=I5[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var s=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&s.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void P5.warn(s.join(" "))}B5(new J4("".concat(i,"-version"),(function(){return{library:i,version:t}}),"VERSION"))}var Q5="firebase-heartbeat-store",Y5=null;function K5(){return Y5||(Y5=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,s=indexedDB.open(e,t),u=_5(s);return i&&s.addEventListener("upgradeneeded",(function(e){i(_5(s.result),e.oldVersion,e.newVersion,_5(s.transaction),e)})),r&&s.addEventListener("blocked",(function(e){return r(e.oldVersion,e.newVersion,e)})),u.then((function(e){o&&e.addEventListener("close",(function(){return o()})),a&&e.addEventListener("versionchange",(function(e){return a(e.oldVersion,e.newVersion,e)}))})).catch((function(){})),u}("firebase-heartbeat-database",1,{upgrade:function(e,t){if(0===t)try{e.createObjectStore(Q5)}catch(p0){console.warn(p0)}}}).catch((function(e){throw q5.create("idb-open",{originalErrorMessage:e.message})}))),Y5}function Z5(e){return J5.apply(this,arguments)}function J5(){return J5=lt(ft().mark((function e(t){var n,r,i,a;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,K5();case 3:return n=e.sent,r=n.transaction(Q5),e.next=7,r.objectStore(Q5).get(t6(t));case 7:return i=e.sent,e.next=10,r.done;case 10:return e.abrupt("return",i);case 13:e.prev=13,e.t0=e.catch(0),e.t0 instanceof F4?P5.warn(e.t0.message):(a=q5.create("idb-get",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),P5.warn(a.message));case 16:case"end":return e.stop()}}),e,null,[[0,13]])}))),J5.apply(this,arguments)}function $5(e,t){return e6.apply(this,arguments)}function e6(){return e6=lt(ft().mark((function e(t,n){var r,i,a,o;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,K5();case 3:return r=e.sent,i=r.transaction(Q5,"readwrite"),a=i.objectStore(Q5),e.next=8,a.put(n,t6(t));case 8:return e.next=10,i.done;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),e.t0 instanceof F4?P5.warn(e.t0.message):(o=q5.create("idb-set",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),P5.warn(o.message));case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),e6.apply(this,arguments)}function t6(e){return"".concat(e.name,"!").concat(e.options.appId)}var n6=function(){function e(t){var n=this;c(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new o6(r),this._heartbeatsCachePromise=this._storage.read().then((function(e){return n._heartbeatsCache=e,e}))}return p(e,[{key:"triggerHeartbeat",value:function(){var e=lt(ft().mark((function e(){var t,n,r,i,a,o;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this.container.getProvider("platform-logger").getImmediate(),i=r.getPlatformInfoString(),a=r6(),null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)){e.next=10;break}return e.next=7,this._heartbeatsCachePromise;case 7:if(this._heartbeatsCache=e.sent,null!=(null===(n=this._heartbeatsCache)||void 0===n?void 0:n.heartbeats)){e.next=10;break}return e.abrupt("return");case 10:if(this._heartbeatsCache.lastSentHeartbeatDate!==a&&!this._heartbeatsCache.heartbeats.some((function(e){return e.date===a}))){e.next=14;break}return e.abrupt("return");case 14:this._heartbeatsCache.heartbeats.push({date:a,agent:i}),this._heartbeatsCache.heartbeats.length>30&&(o=u6(this._heartbeatsCache.heartbeats),this._heartbeatsCache.heartbeats.splice(o,1));case 16:return e.abrupt("return",this._storage.overwrite(this._heartbeatsCache));case 19:e.prev=19,e.t0=e.catch(0),P5.warn(e.t0);case 22:case"end":return e.stop()}}),e,this,[[0,19]])})));return function(){return e.apply(this,arguments)}}()},{key:"getHeartbeatsHeader",value:function(){var e=lt(ft().mark((function e(){var t,n,r,i,a,o;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null!==this._heartbeatsCache){e.next=4;break}return e.next=4,this._heartbeatsCachePromise;case 4:if(null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)&&0!==this._heartbeatsCache.heartbeats.length){e.next=6;break}return e.abrupt("return","");case 6:if(n=r6(),r=i6(this._heartbeatsCache.heartbeats),i=r.heartbeatsToSend,a=r.unsentEntries,o=M4(JSON.stringify({version:2,heartbeats:i})),this._heartbeatsCache.lastSentHeartbeatDate=n,!(a.length>0)){e.next=16;break}return this._heartbeatsCache.heartbeats=a,e.next=14,this._storage.overwrite(this._heartbeatsCache);case 14:e.next=18;break;case 16:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache);case 18:return e.abrupt("return",o);case 21:return e.prev=21,e.t0=e.catch(0),P5.warn(e.t0),e.abrupt("return","");case 25:case"end":return e.stop()}}),e,this,[[0,21]])})));return function(){return e.apply(this,arguments)}}()}]),e}();function r6(){return(new Date).toISOString().substring(0,10)}function i6(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],i=e.slice(),a=k(e);try{var o=function(){var e=t.value,a=r.find((function(t){return t.agent===e.agent}));if(a){if(a.dates.push(e.date),s6(r)>n)return a.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),s6(r)>n)return r.pop(),"break";i=i.slice(1)};for(a.s();!(t=a.n()).done;){var s=o();if("break"===s)break}}catch(u){a.e(u)}finally{a.f()}return{heartbeatsToSend:r,unsentEntries:i}}var a6,o6=function(){function e(t){c(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return p(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B4()){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(a){t(a)}})).then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=lt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return",{heartbeats:[]});case 7:return e.next=9,Z5(this.app);case 9:if(!(null===(t=e.sent)||void 0===t?void 0:t.heartbeats)){e.next=14;break}return e.abrupt("return",t);case 14:return e.abrupt("return",{heartbeats:[]});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"overwrite",value:function(){var e=lt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",$5(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:t.heartbeats}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=lt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",$5(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:[].concat(l(r.heartbeats),l(t.heartbeats))}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function s6(e){return M4(JSON.stringify({version:2,heartbeats:e})).length}function u6(e){if(0===e.length)return-1;for(var t=0,n=e[0].date,r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}a6="",B5(new J4("platform-logger",(function(e){return new M5(e)}),"PRIVATE")),B5(new J4("heartbeat",(function(e){return new n6(e)}),"PRIVATE")),X5(C5,R5,a6),X5(C5,R5,"esm2017"),X5("fire-js","");X5("firebase","11.6.0","app");function l6(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;var c6;function h6(){return We({},"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.")}var f6=h6,d6=new z4("auth","Firebase",h6()),p6=new l5("@firebase/auth");function A6(e){if(p6.logLevel<=n5.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];p6.warn.apply(p6,["Auth (".concat(G5,"): ").concat(e)].concat(n))}}function v6(e){if(p6.logLevel<=n5.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];p6.error.apply(p6,["Auth (".concat(G5,"): ").concat(e)].concat(n))}}function m6(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw x6.apply(void 0,[e].concat(n))}function g6(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return x6.apply(void 0,[e].concat(n))}function y6(e,t,n){var r=Object.assign(Object.assign({},f6()),We({},t,n));return new z4("auth","Firebase",r).create(t,{appName:e.name})}function _6(e){return y6(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function b6(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&m6(e,"argument-error"),y6(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function x6(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){var i,a=n[0],o=l(n.slice(1));return o[0]&&(o[0].appName=e.name),(i=e._errorFactory).create.apply(i,[a].concat(l(o)))}return d6.create.apply(d6,[e].concat(n))}function w6(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw x6.apply(void 0,[t].concat(r))}}function T6(e){var t="INTERNAL ASSERTION FAILED: "+e;throw v6(t),new Error(t)}function S6(e,t){e||T6(t)}function E6(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function k6(){return"http:"===M6()||"https:"===M6()}function M6(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function C6(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(k6()||function(){var e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}var R6=function(){function e(t,n){c(this,e),this.shortDelay=t,this.longDelay=n,S6(n>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(O4())||"object"===typeof navigator&&"ReactNative"===navigator.product}return p(e,[{key:"get",value:function(){return C6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}]),e}();function P6(e,t){S6(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var N6=function(){function e(){c(this,e)}return p(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void T6("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}))},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void T6("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void T6("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),I6=(We(c6={},"CREDENTIAL_MISMATCH","custom-token-mismatch"),We(c6,"MISSING_CUSTOM_TOKEN","internal-error"),We(c6,"INVALID_IDENTIFIER","invalid-email"),We(c6,"MISSING_CONTINUE_URI","internal-error"),We(c6,"INVALID_PASSWORD","wrong-password"),We(c6,"MISSING_PASSWORD","missing-password"),We(c6,"INVALID_LOGIN_CREDENTIALS","invalid-credential"),We(c6,"EMAIL_EXISTS","email-already-in-use"),We(c6,"PASSWORD_LOGIN_DISABLED","operation-not-allowed"),We(c6,"INVALID_IDP_RESPONSE","invalid-credential"),We(c6,"INVALID_PENDING_TOKEN","invalid-credential"),We(c6,"FEDERATED_USER_ID_ALREADY_LINKED","credential-already-in-use"),We(c6,"MISSING_REQ_TYPE","internal-error"),We(c6,"EMAIL_NOT_FOUND","user-not-found"),We(c6,"RESET_PASSWORD_EXCEED_LIMIT","too-many-requests"),We(c6,"EXPIRED_OOB_CODE","expired-action-code"),We(c6,"INVALID_OOB_CODE","invalid-action-code"),We(c6,"MISSING_OOB_CODE","internal-error"),We(c6,"CREDENTIAL_TOO_OLD_LOGIN_AGAIN","requires-recent-login"),We(c6,"INVALID_ID_TOKEN","invalid-user-token"),We(c6,"TOKEN_EXPIRED","user-token-expired"),We(c6,"USER_NOT_FOUND","user-token-expired"),We(c6,"TOO_MANY_ATTEMPTS_TRY_LATER","too-many-requests"),We(c6,"PASSWORD_DOES_NOT_MEET_REQUIREMENTS","password-does-not-meet-requirements"),We(c6,"INVALID_CODE","invalid-verification-code"),We(c6,"INVALID_SESSION_INFO","invalid-verification-id"),We(c6,"INVALID_TEMPORARY_PROOF","invalid-credential"),We(c6,"MISSING_SESSION_INFO","missing-verification-id"),We(c6,"SESSION_EXPIRED","code-expired"),We(c6,"MISSING_ANDROID_PACKAGE_NAME","missing-android-pkg-name"),We(c6,"UNAUTHORIZED_DOMAIN","unauthorized-continue-uri"),We(c6,"INVALID_OAUTH_CLIENT_ID","invalid-oauth-client-id"),We(c6,"ADMIN_ONLY_OPERATION","admin-restricted-operation"),We(c6,"INVALID_MFA_PENDING_CREDENTIAL","invalid-multi-factor-session"),We(c6,"MFA_ENROLLMENT_NOT_FOUND","multi-factor-info-not-found"),We(c6,"MISSING_MFA_ENROLLMENT_ID","missing-multi-factor-info"),We(c6,"MISSING_MFA_PENDING_CREDENTIAL","missing-multi-factor-session"),We(c6,"SECOND_FACTOR_EXISTS","second-factor-already-in-use"),We(c6,"SECOND_FACTOR_LIMIT_EXCEEDED","maximum-second-factor-count-exceeded"),We(c6,"BLOCKING_FUNCTION_ERROR_RESPONSE","internal-error"),We(c6,"RECAPTCHA_NOT_ENABLED","recaptcha-not-enabled"),We(c6,"MISSING_RECAPTCHA_TOKEN","missing-recaptcha-token"),We(c6,"INVALID_RECAPTCHA_TOKEN","invalid-recaptcha-token"),We(c6,"INVALID_RECAPTCHA_ACTION","invalid-recaptcha-action"),We(c6,"MISSING_CLIENT_TYPE","missing-client-type"),We(c6,"MISSING_RECAPTCHA_VERSION","missing-recaptcha-version"),We(c6,"INVALID_RECAPTCHA_VERSION","invalid-recaptcha-version"),We(c6,"INVALID_REQ_TYPE","invalid-req-type"),c6),L6=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],D6=new R6(3e4,6e4);function O6(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function U6(e,t,n,r){return B6.apply(this,arguments)}function B6(){return B6=lt(ft().mark((function e(t,n,r,i){var a,o=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>4&&void 0!==o[4]?o[4]:{},e.abrupt("return",F6(t,a,lt(ft().mark((function e(){var a,o,s,u,l;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},o={},i&&("GET"===n?o=i:a={body:JSON.stringify(i)}),s=W4(Object.assign({key:t.config.apiKey},o)).slice(1),e.next=6,t._getAdditionalHeaders();case 6:return(u=e.sent)["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),l=Object.assign({method:n,headers:u},a),U4()||(l.referrerPolicy="no-referrer"),e.t0=N6.fetch(),e.next=14,j6(t,t.config.apiHost,r,s);case 14:return e.t1=e.sent,e.t2=l,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 17:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e)}))),B6.apply(this,arguments)}function F6(e,t,n){return z6.apply(this,arguments)}function z6(){return z6=lt(ft().mark((function e(t,n,r){var i,a,o,s,u,l,c,h,f,d;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,i=Object.assign(Object.assign({},I6),n),e.prev=2,a=new W6(t),e.next=6,Promise.race([r(),a.promise]);case 6:return o=e.sent,a.clearNetworkTimeout(),e.next=10,o.json();case 10:if(!("needConfirmation"in(s=e.sent))){e.next=13;break}throw X6(t,"account-exists-with-different-credential",s);case 13:if(!o.ok||"errorMessage"in s){e.next=17;break}return e.abrupt("return",s);case 17:if(u=o.ok?s.errorMessage:s.error.message,l=u.split(" : "),c=T(l,2),h=c[0],f=c[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==h){e.next=23;break}throw X6(t,"credential-already-in-use",s);case 23:if("EMAIL_EXISTS"!==h){e.next=27;break}throw X6(t,"email-already-in-use",s);case 27:if("USER_DISABLED"!==h){e.next=29;break}throw X6(t,"user-disabled",s);case 29:if(d=i[h]||h.toLowerCase().replace(/[_\s]+/g,"-"),!f){e.next=34;break}throw y6(t,d,f);case 34:m6(t,d);case 35:e.next=42;break;case 37:if(e.prev=37,e.t0=e.catch(2),!(e.t0 instanceof F4)){e.next=41;break}throw e.t0;case 41:m6(t,"network-request-failed",{message:String(e.t0)});case 42:case"end":return e.stop()}}),e,null,[[2,37]])}))),z6.apply(this,arguments)}function V6(e,t,n,r){return q6.apply(this,arguments)}function q6(){return q6=lt(ft().mark((function e(t,n,r,i){var a,o,s=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,U6(t,n,r,i,a);case 3:return"mfaPendingCredential"in(o=e.sent)&&m6(t,"multi-factor-auth-required",{_serverResponse:o}),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)}))),q6.apply(this,arguments)}function j6(e,t,n,r){return G6.apply(this,arguments)}function G6(){return G6=lt(ft().mark((function e(t,n,r,i){var a,o,s,u;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="".concat(n).concat(r,"?").concat(i),s=(o=t).config.emulator?P6(t.config,a):"".concat(t.config.apiScheme,"://").concat(a),!L6.includes(r)){e.next=9;break}return e.next=6,o._persistenceManagerAvailable;case 6:if("COOKIE"!==o._getPersistenceType()){e.next=9;break}return u=o._getPersistence(),e.abrupt("return",u._getFinalTarget(s).toString());case 9:return e.abrupt("return",s);case 10:case"end":return e.stop()}}),e)}))),G6.apply(this,arguments)}function H6(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var W6=function(){function e(t){var n=this;c(this,e),this.auth=t,this.timer=null,this.promise=new Promise((function(e,t){n.timer=setTimeout((function(){return t(g6(n.auth,"network-request-failed"))}),D6.get())}))}return p(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function X6(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=g6(e,t,r);return i.customData._tokenResponse=n,i}function Q6(e){return void 0!==e&&void 0!==e.enterprise}var Y6=function(){function e(t){if(c(this,e),this.siteKey="",this.recaptchaEnforcementState=[],void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}return p(e,[{key:"getProviderEnforcementState",value:function(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;var t,n=k(this.recaptchaEnforcementState);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.provider&&r.provider===e)return H6(r.enforcementState)}}catch(i){n.e(i)}finally{n.f()}return null}},{key:"isProviderEnabled",value:function(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}},{key:"isAnyProviderEnabled",value:function(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}]),e}();function K6(e,t){return Z6.apply(this,arguments)}function Z6(){return Z6=lt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U6(t,"GET","/v2/recaptchaConfig",O6(t,n)));case 1:case"end":return e.stop()}}),e)}))),Z6.apply(this,arguments)}function J6(e,t){return $6.apply(this,arguments)}function $6(){return $6=lt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U6(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}}),e)}))),$6.apply(this,arguments)}function e8(e,t){return t8.apply(this,arguments)}function t8(){return t8=lt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U6(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}}),e)}))),t8.apply(this,arguments)}function n8(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(p0){}}function r8(){return r8=lt(ft().mark((function e(t){var n,r,i,a,o,s,u=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],r=Z4(t),e.next=4,r.getIdToken(n);case 4:return i=e.sent,w6((a=a8(i))&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error"),o="object"===typeof a.firebase?a.firebase:void 0,s=null===o||void 0===o?void 0:o.sign_in_provider,e.abrupt("return",{claims:a,token:i,authTime:n8(i8(a.auth_time)),issuedAtTime:n8(i8(a.iat)),expirationTime:n8(i8(a.exp)),signInProvider:s||null,signInSecondFactor:(null===o||void 0===o?void 0:o.sign_in_second_factor)||null});case 10:case"end":return e.stop()}}),e)}))),r8.apply(this,arguments)}function i8(e){return 1e3*Number(e)}function a8(e){var t=T(e.split("."),3),n=t[0],r=t[1],i=t[2];if(void 0===n||void 0===r||void 0===i)return v6("JWT malformed, contained fewer than 3 sections"),null;try{var a=C4(r);return a?JSON.parse(a):(v6("Failed to decode base64 JWT payload"),null)}catch(p0){return v6("Caught error parsing JWT payload as JSON",null===p0||void 0===p0?void 0:p0.toString()),null}}function o8(e){var t=a8(e);return w6(t,"internal-error"),w6("undefined"!==typeof t.exp,"internal-error"),w6("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}function s8(e,t){return u8.apply(this,arguments)}function u8(){return u8=lt(ft().mark((function e(t,n){var r=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof F4&&l8(e.t0))){e.next=15;break}if(t.auth.currentUser!==t){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[3,9]])}))),u8.apply(this,arguments)}function l8(e){var t=e.code;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}var c8=function(){function e(t){c(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return p(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isRunning){var n=this.getInterval(t);this.timerId=setTimeout(lt(ft().mark((function t(){return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.iteration();case 2:case"end":return t.stop()}}),t)}))),n)}}},{key:"iteration",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.user.getIdToken(!0);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("network-request-failed")&&this.schedule(!0),e.abrupt("return");case 9:this.schedule();case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),h8=function(){function e(t,n){c(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return p(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=n8(this.lastLoginAt),this.creationTime=n8(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function f8(e){return d8.apply(this,arguments)}function d8(){return d8=lt(ft().mark((function e(t){var n,r,i,a,o,s,u,l,c,h,f;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return i=e.sent,e.next=6,s8(t,e8(r,{idToken:i}));case 6:w6(null===(a=e.sent)||void 0===a?void 0:a.users.length,r,"internal-error"),o=a.users[0],t._notifyReloadListener(o),s=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?v8(o.providerUserInfo):[],u=A8(t.providerData,s),l=t.isAnonymous,c=!(t.email&&o.passwordHash)&&!(null===u||void 0===u?void 0:u.length),h=!!l&&c,f={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new h8(o.createdAt,o.lastLoginAt),isAnonymous:h},Object.assign(t,f);case 17:case"end":return e.stop()}}),e)}))),d8.apply(this,arguments)}function p8(){return(p8=lt(ft().mark((function e(t){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Z4(t),e.next=3,f8(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A8(e,t){var n=e.filter((function(e){return!t.some((function(t){return t.providerId===e.providerId}))}));return[].concat(l(n),l(t))}function v8(e){return e.map((function(e){var t=e.providerId,n=l6(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}function m8(e,t){return g8.apply(this,arguments)}function g8(){return g8=lt(ft().mark((function e(t,n){var r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F6(t,{},lt(ft().mark((function e(){var r,i,a,o,s,u;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=W4({grant_type:"refresh_token",refresh_token:n}).slice(1),i=t.config,a=i.tokenApiHost,o=i.apiKey,e.next=4,j6(t,a,"/v1/token","key=".concat(o));case 4:return s=e.sent,e.next=7,t._getAdditionalHeaders();case 7:return(u=e.sent)["Content-Type"]="application/x-www-form-urlencoded",e.abrupt("return",N6.fetch()(s,{method:"POST",headers:u,body:r}));case 10:case"end":return e.stop()}}),e)}))));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}}),e)}))),g8.apply(this,arguments)}function y8(e,t){return _8.apply(this,arguments)}function _8(){return _8=lt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U6(t,"POST","/v2/accounts:revokeToken",O6(t,n)));case 1:case"end":return e.stop()}}),e)}))),_8.apply(this,arguments)}var b8=function(){function e(){c(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return p(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){w6(e.idToken,"internal-error"),w6("undefined"!==typeof e.idToken,"internal-error"),w6("undefined"!==typeof e.refreshToken,"internal-error");var t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):o8(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"updateFromIdToken",value:function(e){w6(0!==e.length,"internal-error");var t=o8(e);this.updateTokensAndExpiration(e,null,t)}},{key:"getToken",value:function(){var e=lt(ft().mark((function e(t){var n=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.length>1&&void 0!==n[1]&&n[1]||!this.accessToken||this.isExpired){e.next=3;break}return e.abrupt("return",this.accessToken);case 3:if(w6(this.refreshToken,t,"user-token-expired"),!this.refreshToken){e.next=8;break}return e.next=7,this.refresh(t,this.refreshToken);case 7:return e.abrupt("return",this.accessToken);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(){var e=lt(ft().mark((function e(t,n){var r,i,a,o;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m8(t,n);case 2:r=e.sent,i=r.accessToken,a=r.refreshToken,o=r.expiresIn,this.updateTokensAndExpiration(i,a,Number(o));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return T6("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new e;return r&&(w6("string"===typeof r,"internal-error",{appName:t}),o.refreshToken=r),i&&(w6("string"===typeof i,"internal-error",{appName:t}),o.accessToken=i),a&&(w6("number"===typeof a,"internal-error",{appName:t}),o.expirationTime=a),o}}]),e}();function x8(e,t){w6("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}var w8=function(){function e(t){c(this,e);var n=t.uid,r=t.auth,i=t.stsTokenManager,a=l6(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new c8(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?l(a.providerData):[],this.metadata=new h8(a.createdAt||void 0,a.lastLoginAt||void 0)}return p(e,[{key:"getIdToken",value:function(){var e=lt(ft().mark((function e(t){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s8(this,this.stsTokenManager.getToken(this.auth,t));case 2:if(w6(n=e.sent,this.auth,"internal-error"),this.accessToken===n){e.next=9;break}return this.accessToken=n,e.next=8,this.auth._persistUserIfCurrent(this);case 8:this.auth._notifyListenersIfCurrent(this);case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getIdTokenResult",value:function(e){return function(e){return r8.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return p8.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(w6(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((function(e){return Object.assign({},e)})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){var n=new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}},{key:"_onReload",value:function(e){w6(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(){var e=lt(ft().mark((function e(t){var n,r,i=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]&&i[1],r=!1,t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),r=!0),!n){e.next=6;break}return e.next=6,f8(this);case 6:return e.next=8,this.auth._persistUserIfCurrent(this);case 8:r&&this.auth._notifyListenersIfCurrent(this);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=lt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!z5(this.auth.app)){e.next=2;break}return e.abrupt("return",Promise.reject(_6(this.auth)));case 2:return e.next=4,this.getIdToken();case 4:return t=e.sent,e.next=7,s8(this,J6(this.auth,{idToken:t}));case 7:return this.stsTokenManager.clearRefreshToken(),e.abrupt("return",this.auth.signOut());case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((function(e){return Object.assign({},e)})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,i,a,o,s,u,l,c,h=null!==(r=n.displayName)&&void 0!==r?r:void 0,f=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,p=null!==(o=n.photoURL)&&void 0!==o?o:void 0,A=null!==(s=n.tenantId)&&void 0!==s?s:void 0,v=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,m=null!==(l=n.createdAt)&&void 0!==l?l:void 0,g=null!==(c=n.lastLoginAt)&&void 0!==c?c:void 0,y=n.uid,_=n.emailVerified,b=n.isAnonymous,x=n.providerData,w=n.stsTokenManager;w6(y&&w,t,"internal-error");var T=b8.fromJSON(this.name,w);w6("string"===typeof y,t,"internal-error"),x8(h,t.name),x8(f,t.name),w6("boolean"===typeof _,t,"internal-error"),w6("boolean"===typeof b,t,"internal-error"),x8(d,t.name),x8(p,t.name),x8(A,t.name),x8(v,t.name),x8(m,t.name),x8(g,t.name);var S=new e({uid:y,auth:t,email:f,emailVerified:_,displayName:h,isAnonymous:b,photoURL:p,phoneNumber:d,tenantId:A,stsTokenManager:T,createdAt:m,lastLoginAt:g});return x&&Array.isArray(x)&&(S.providerData=x.map((function(e){return Object.assign({},e)}))),v&&(S._redirectEventId=v),S}},{key:"_fromIdTokenResponse",value:function(){var t=lt(ft().mark((function t(n,r){var i,a,o,s=arguments;return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=s.length>2&&void 0!==s[2]&&s[2],(a=new b8).updateFromServerResponse(r),o=new e({uid:r.localId,auth:n,stsTokenManager:a,isAnonymous:i}),t.next=6,f8(o);case 6:return t.abrupt("return",o);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"_fromGetAccountInfoResponse",value:function(){var t=lt(ft().mark((function t(n,r,i){var a,o,s,u,l,c;return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return w6(void 0!==(a=r.users[0]).localId,"internal-error"),o=void 0!==a.providerUserInfo?v8(a.providerUserInfo):[],s=!(a.email&&a.passwordHash)&&!(null===o||void 0===o?void 0:o.length),(u=new b8).updateFromIdToken(i),l=new e({uid:a.localId,auth:n,stsTokenManager:u,isAnonymous:s}),c={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new h8(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(null===o||void 0===o?void 0:o.length)},Object.assign(l,c),t.abrupt("return",l);case 10:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()}]),e}(),T8=new Map;function S8(e){S6(e instanceof Function,"Expected a class definition");var t=T8.get(e);return t?(S6(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,T8.set(e,t),t)}var E8=function(){function e(){c(this,e),this.type="NONE",this.storage={}}return p(e,[{key:"_isAvailable",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=lt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.storage[t]=n;case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=lt(ft().mark((function e(t){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.storage[t],e.abrupt("return",void 0===n?null:n);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:delete this.storage[t];case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();E8.type="NONE";var k8=E8;function M8(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}var C8=function(){function e(t,n,r){c(this,e),this.persistence=t,this.auth=n,this.userKey=r;var i=this.auth,a=i.config,o=i.name;this.fullUserKey=M8(this.userKey,a.apiKey,o),this.fullPersistenceKey=M8("persistence",a.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return p(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=lt(ft().mark((function e(){var t,n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.persistence._get(this.fullUserKey);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:if("string"!==typeof t){e.next=12;break}return e.next=8,e8(this.auth,{idToken:t}).catch((function(){}));case 8:if(n=e.sent){e.next=11;break}return e.abrupt("return",null);case 11:return e.abrupt("return",w8._fromGetAccountInfoResponse(this.auth,n,t));case 12:return e.abrupt("return",w8._fromJSON(this.auth,t));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(){var e=lt(ft().mark((function e(t){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.persistence!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getCurrentUser();case 4:return n=e.sent,e.next=7,this.removeCurrentUser();case 7:if(this.persistence=t,!n){e.next=10;break}return e.abrupt("return",this.setCurrentUser(n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(){var t=lt(ft().mark((function t(n,r){var i,a,o,s,u,l,c,h,f,d,p,A,v=arguments;return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=v.length>2&&void 0!==v[2]?v[2]:"authUser",r.length){t.next=3;break}return t.abrupt("return",new e(S8(k8),n,i));case 3:return t.next=5,Promise.all(r.map(function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:return e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:a=t.sent.filter((function(e){return e})),o=a[0]||S8(k8),s=M8(i,n.config.apiKey,n.name),u=null,l=k(r),t.prev=10,l.s();case 12:if((c=l.n()).done){t.next=41;break}return h=c.value,t.prev=14,t.next=17,h._get(s);case 17:if(!(f=t.sent)){t.next=35;break}if(d=void 0,"string"!==typeof f){t.next=31;break}return t.next=23,e8(n,{idToken:f}).catch((function(){}));case 23:if(p=t.sent){t.next=26;break}return t.abrupt("break",41);case 26:return t.next=28,w8._fromGetAccountInfoResponse(n,p,f);case 28:d=t.sent,t.next=32;break;case 31:d=w8._fromJSON(n,f);case 32:return h!==o&&(u=d),o=h,t.abrupt("break",41);case 35:t.next=39;break;case 37:t.prev=37,t.t0=t.catch(14);case 39:t.next=12;break;case 41:t.next=46;break;case 43:t.prev=43,t.t1=t.catch(10),l.e(t.t1);case 46:return t.prev=46,l.f(),t.finish(46);case 49:if(A=a.filter((function(e){return e._shouldAllowMigration})),o._shouldAllowMigration&&A.length){t.next=52;break}return t.abrupt("return",new e(o,n,i));case 52:if(o=A[0],!u){t.next=56;break}return t.next=56,o._set(s,u.toJSON());case 56:return t.next=58,Promise.all(r.map(function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===o){e.next=8;break}return e.prev=1,e.next=4,t._remove(s);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()));case 58:return t.abrupt("return",new e(o,n,i));case 59:case"end":return t.stop()}}),t,null,[[10,43,46,49],[14,37]])})));return function(e,n){return t.apply(this,arguments)}}()}]),e}();function R8(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(L8(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(P8(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(O8(t))return"Blackberry";if(U8(t))return"Webos";if(N8(t))return"Safari";if((t.includes("chrome/")||I8(t))&&!t.includes("edge/"))return"Chrome";if(D8(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null===n||void 0===n?void 0:n.length)?n[1]:"Other"}function P8(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O4();return/firefox\//i.test(e)}function N8(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O4(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function I8(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O4();return/crios\//i.test(e)}function L8(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O4();return/iemobile/i.test(e)}function D8(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O4();return/android/i.test(e)}function O8(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O4();return/blackberry/i.test(e)}function U8(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O4();return/webos/i.test(e)}function B8(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O4();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function F8(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O4();return B8(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}function z8(){return function(){var e=O4();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function V8(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O4();return B8(e)||D8(e)||U8(e)||O8(e)||/windows phone/i.test(e)||L8(e)}function q8(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=R8(O4());break;case"Worker":t="".concat(R8(O4()),"-").concat(e);break;default:t=e}var r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(G5,"/").concat(r)}var j8=function(){function e(t){c(this,e),this.auth=t,this.queue=[]}return p(e,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise((function(n,r){try{n(e(t))}catch(p0){r(p0)}}))};r.onAbort=t,this.queue.push(r);var i=this.queue.length-1;return function(){n.queue[i]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(){var e=lt(ft().mark((function e(t){var n,r,i,a,o,s,u;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.auth.currentUser!==t){e.next=2;break}return e.abrupt("return");case 2:n=[],e.prev=3,r=k(this.queue),e.prev=5,r.s();case 7:if((i=r.n()).done){e.next=14;break}return a=i.value,e.next=11,a(t);case 11:a.onAbort&&n.push(a.onAbort);case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:e.next=30;break;case 24:e.prev=24,e.t1=e.catch(3),n.reverse(),o=k(n);try{for(o.s();!(s=o.n()).done;){u=s.value;try{u()}catch(l){}}}catch(c){o.e(c)}finally{o.f()}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===e.t1||void 0===e.t1?void 0:e.t1.message});case 30:case"end":return e.stop()}}),e,this,[[3,24],[5,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()}]),e}();function G8(e){return H8.apply(this,arguments)}function H8(){return H8=lt(ft().mark((function e(t){var n,r=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",U6(t,"GET","/v2/passwordPolicy",O6(t,n)));case 2:case"end":return e.stop()}}),e)}))),H8.apply(this,arguments)}var W8=function(){function e(t){var n,r,i,a;c(this,e);var o=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(n=o.minPasswordLength)&&void 0!==n?n:6,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),void 0!==o.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),void 0!==o.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),void 0!==o.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),void 0!==o.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(r=t.allowedNonAlphanumericCharacters)||void 0===r?void 0:r.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(a=t.forceUpgradeOnSignin)&&void 0!==a&&a,this.schemaVersion=t.schemaVersion}return p(e,[{key:"validatePassword",value:function(e){var t,n,r,i,a,o,s={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,s),this.validatePasswordCharacterOptions(e,s),s.isValid&&(s.isValid=null===(t=s.meetsMinPasswordLength)||void 0===t||t),s.isValid&&(s.isValid=null===(n=s.meetsMaxPasswordLength)||void 0===n||n),s.isValid&&(s.isValid=null===(r=s.containsLowercaseLetter)||void 0===r||r),s.isValid&&(s.isValid=null===(i=s.containsUppercaseLetter)||void 0===i||i),s.isValid&&(s.isValid=null===(a=s.containsNumericCharacter)||void 0===a||a),s.isValid&&(s.isValid=null===(o=s.containsNonAlphanumericCharacter)||void 0===o||o),s}},{key:"validatePasswordLengthOptions",value:function(e,t){var n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}},{key:"validatePasswordCharacterOptions",value:function(e,t){var n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(var r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}},{key:"updatePasswordCharacterOptionsStatuses",value:function(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}]),e}(),X8=function(){function e(t,n,r,i){var a=this;c(this,e),this.app=t,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Y8(this),this.idTokenSubscription=new Y8(this),this.beforeStateQueue=new j8(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=d6,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise((function(e){return a._resolvePersistenceManagerAvailable=e}))}return p(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=S8(t)),this._initializationPromise=this.queue(lt(ft().mark((function r(){var i,a,o;return ft().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n._deleted){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,C8.create(n,e);case 4:if(n.persistenceManager=r.sent,null===(i=n._resolvePersistenceManagerAvailable)||void 0===i||i.call(n),!n._deleted){r.next=8;break}return r.abrupt("return");case 8:if(!(null===(a=n._popupRedirectResolver)||void 0===a?void 0:a._shouldInitProactively)){r.next=16;break}return r.prev=9,r.next=12,n._popupRedirectResolver._initialize(n);case 12:r.next=16;break;case 14:r.prev=14,r.t0=r.catch(9);case 16:return r.next=18,n.initializeCurrentUser(t);case 18:if(n.lastNotifiedUid=(null===(o=n.currentUser)||void 0===o?void 0:o.uid)||null,!n._deleted){r.next=21;break}return r.abrupt("return");case 21:n._isInitialized=!0;case 22:case"end":return r.stop()}}),r,null,[[9,14]])})))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=lt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._deleted){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.assertedPersistence.getCurrentUser();case 4:if(t=e.sent,this.currentUser||t){e.next=7;break}return e.abrupt("return");case 7:if(!this.currentUser||!t||this.currentUser.uid!==t.uid){e.next=12;break}return this._currentUser._assign(t),e.next=11,this.currentUser.getIdToken();case 11:return e.abrupt("return");case 12:return e.next=14,this._updateCurrentUser(t,!0);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeCurrentUserFromIdToken",value:function(){var e=lt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,e8(this,{idToken:t});case 3:return n=e.sent,e.next=6,w8._fromGetAccountInfoResponse(this,n,t);case 6:return r=e.sent,e.next=9,this.directlySetCurrentUser(r);case 9:e.next=16;break;case 11:return e.prev=11,e.t0=e.catch(0),console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e.t0),e.next=16,this.directlySetCurrentUser(null);case 16:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"initializeCurrentUser",value:function(){var e=lt(ft().mark((function e(t){var n,r,i,a,o,s,u,l,c=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!z5(this.app)){e.next=7;break}if(!(r=this.app.settings.authIdToken)){e.next=6;break}return e.abrupt("return",new Promise((function(e){setTimeout((function(){return c.initializeCurrentUserFromIdToken(r).then(e,e)}))})));case 6:return e.abrupt("return",this.directlySetCurrentUser(null));case 7:return e.next=9,this.assertedPersistence.getCurrentUser();case 9:if(i=e.sent,a=i,o=!1,!t||!this.config.authDomain){e.next=21;break}return e.next=15,this.getOrInitRedirectPersistenceManager();case 15:return s=null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId,u=null===a||void 0===a?void 0:a._redirectEventId,e.next=19,this.tryRedirectSignIn(t);case 19:l=e.sent,s&&s!==u||!(null===l||void 0===l?void 0:l.user)||(a=l.user,o=!0);case 21:if(a){e.next=23;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 23:if(a._redirectEventId){e.next=39;break}if(!o){e.next=34;break}return e.prev=25,e.next=28,this.beforeStateQueue.runMiddleware(a);case 28:e.next=34;break;case 30:e.prev=30,e.t0=e.catch(25),a=i,this._popupRedirectResolver._overrideRedirectResult(this,(function(){return Promise.reject(e.t0)}));case 34:if(!a){e.next=38;break}return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(a));case 38:return e.abrupt("return",this.directlySetCurrentUser(null));case 39:return w6(this._popupRedirectResolver,this,"argument-error"),e.next=42,this.getOrInitRedirectPersistenceManager();case 42:if(!this.redirectUser||this.redirectUser._redirectEventId!==a._redirectEventId){e.next=44;break}return e.abrupt("return",this.directlySetCurrentUser(a));case 44:return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(a));case 45:case"end":return e.stop()}}),e,this,[[25,30]])})));return function(t){return e.apply(this,arguments)}}()},{key:"tryRedirectSignIn",value:function(){var e=lt(ft().mark((function e(t){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.prev=1,e.next=4,this._popupRedirectResolver._completeRedirectFn(this,t,!0);case 4:n=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),e.next=11,this._setRedirectUser(null);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"reloadAndSetCurrentUserOrClear",value:function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f8(t);case 3:e.next=9;break;case 5:if(e.prev=5,e.t0=e.catch(0),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("network-request-failed")){e.next=9;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 9:return e.abrupt("return",this.directlySetCurrentUser(t));case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"===typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._deleted=!0;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateCurrentUser",value:function(){var e=lt(ft().mark((function e(t){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!z5(this.app)){e.next=2;break}return e.abrupt("return",Promise.reject(_6(this)));case 2:return(n=t?Z4(t):null)&&w6(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),e.abrupt("return",this._updateCurrentUser(n&&n._clone(this)));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateCurrentUser",value:function(){var e=lt(ft().mark((function e(t){var n,r=this,i=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]&&i[1],!this._deleted){e.next=3;break}return e.abrupt("return");case 3:if(t&&w6(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),n){e.next=7;break}return e.next=7,this.beforeStateQueue.runMiddleware(t);case 7:return e.abrupt("return",this.queue(lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.directlySetCurrentUser(t);case 2:r.notifyAuthListeners();case 3:case"end":return e.stop()}}),e)})))));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signOut",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!z5(this.app)){e.next=2;break}return e.abrupt("return",Promise.reject(_6(this)));case 2:return e.next=4,this.beforeStateQueue.runMiddleware(null);case 4:if(!this.redirectPersistenceManager&&!this._popupRedirectResolver){e.next=7;break}return e.next=7,this._setRedirectUser(null);case 7:return e.abrupt("return",this._updateCurrentUser(null,!0));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPersistence",value:function(e){var t=this;return z5(this.app)?Promise.reject(_6(this)):this.queue(lt(ft().mark((function n(){return ft().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(S8(e));case 2:case"end":return n.stop()}}),n)}))))}},{key:"_getRecaptchaConfig",value:function(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}},{key:"validatePassword",value:function(){var e=lt(ft().mark((function e(t){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._getPasswordPolicyInternal()){e.next=3;break}return e.next=3,this._updatePasswordPolicy();case 3:if((n=this._getPasswordPolicyInternal()).schemaVersion===this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION){e.next=6;break}return e.abrupt("return",Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})));case 6:return e.abrupt("return",n.validatePassword(t));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getPasswordPolicyInternal",value:function(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}},{key:"_updatePasswordPolicy",value:function(){var e=lt(ft().mark((function e(){var t,n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G8(this);case 2:t=e.sent,n=new W8(t),null===this.tenantId?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getPersistenceType",value:function(){return this.assertedPersistence.persistence.type}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new z4("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"authStateReady",value:function(){var e=this;return new Promise((function(t,n){if(e.currentUser)t();else var r=e.onAuthStateChanged((function(){r(),t()}),n)}))}},{key:"revokeAccessToken",value:function(){var e=lt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.currentUser){e.next=8;break}return e.next=3,this.currentUser.getIdToken();case 3:return n=e.sent,r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:n},null!=this.tenantId&&(r.tenantId=this.tenantId),e.next=8,y8(this,r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(){var e=lt(ft().mark((function e(t,n){var r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getOrInitRedirectPersistenceManager(n);case 2:return r=e.sent,e.abrupt("return",null===t?r.removeCurrentUser():r.setCurrentUser(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getOrInitRedirectPersistenceManager",value:function(){var e=lt(ft().mark((function e(t){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.redirectPersistenceManager){e.next=9;break}return w6(n=t&&S8(t)||this._popupRedirectResolver,this,"argument-error"),e.next=5,C8.create(this,[S8(n._redirectPersistence)],"redirectUser");case 5:return this.redirectPersistenceManager=e.sent,e.next=8,this.redirectPersistenceManager.getCurrentUser();case 8:this.redirectUser=e.sent;case 9:return e.abrupt("return",this.redirectPersistenceManager);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_redirectUserForId",value:function(){var e=lt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isInitialized){e.next=3;break}return e.next=3,this.queue(lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))));case 3:if((null===(n=this._currentUser)||void 0===n?void 0:n._redirectEventId)!==t){e.next=5;break}return e.abrupt("return",this._currentUser);case 5:if((null===(r=this.redirectUser)||void 0===r?void 0:r._redirectEventId)!==t){e.next=7;break}return e.abrupt("return",this.redirectUser);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_persistUserIfCurrent",value:function(){var e=lt(ft().mark((function e(t){var n=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.currentUser){e.next=2;break}return e.abrupt("return",this.queue(lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.directlySetCurrentUser(t));case 1:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"===typeof t?t:t.next.bind(t),o=!1,s=this._isInitialized?Promise.resolve():this._initializationPromise;if(w6(s,this,"internal-error"),s.then((function(){o||a(i.currentUser)})),"function"===typeof t){var u=e.addObserver(t,n,r);return function(){o=!0,u()}}var l=e.addObserver(t);return function(){o=!0,l()}}},{key:"directlySetCurrentUser",value:function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,!t){e.next=8;break}return e.next=6,this.assertedPersistence.setCurrentUser(t);case 6:e.next=10;break;case 8:return e.next=10,this.assertedPersistence.removeCurrentUser();case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return w6(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=q8(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=lt(ft().mark((function e(){var t,n,r,i;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=We({},"X-Client-Version",this.clientVersion),this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId),e.next=4,null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();case 4:return(r=e.sent)&&(n["X-Firebase-Client"]=r),e.next=8,this._getAppCheckToken();case 8:return(i=e.sent)&&(n["X-Firebase-AppCheck"]=i),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getAppCheckToken",value:function(){var e=lt(ft().mark((function e(){var t,n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!z5(this.app)||!this.app.settings.appCheckToken){e.next=2;break}return e.abrupt("return",this.app.settings.appCheckToken);case 2:return e.next=4,null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken();case 4:return(null===(n=e.sent)||void 0===n?void 0:n.error)&&A6("Error while retrieving App Check token: ".concat(n.error)),e.abrupt("return",null===n||void 0===n?void 0:n.token);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Q8(e){return Z4(e)}var Y8=function(){function e(t){var n=this;c(this,e),this.auth=t,this.observer=null,this.addObserver=function(e,t){var n=new Y4(e,t);return n.subscribe.bind(n)}((function(e){return n.observer=e}))}return p(e,[{key:"next",get:function(){return w6(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}(),K8={loadJS:function(){return lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Unable to load external scripts");case 1:case"end":return e.stop()}}),e)})))()},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Z8(e){return K8.loadJS(e)}function J8(){return K8.recaptchaEnterpriseScript}function $8(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}var e7=function(){function e(){c(this,e),this.enterprise=new t7}return p(e,[{key:"ready",value:function(e){e()}},{key:"execute",value:function(e,t){return Promise.resolve("token")}},{key:"render",value:function(e,t){return""}}]),e}(),t7=function(){function e(){c(this,e)}return p(e,[{key:"ready",value:function(e){e()}},{key:"execute",value:function(e,t){return Promise.resolve("token")}},{key:"render",value:function(e,t){return""}}]),e}();var n7="NO_RECAPTCHA",r7=function(){function e(t){c(this,e),this.type="recaptcha-enterprise",this.auth=Q8(t)}return p(e,[{key:"verify",value:function(){var e=lt(ft().mark((function e(){var t,n,r,i,a,o,s=this,u=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=function(e,n,r){var i=window.grecaptcha;Q6(i)?i.enterprise.ready((function(){i.enterprise.execute(e,{action:t}).then((function(e){n(e)})).catch((function(){n(n7)}))})):r(Error("No reCAPTCHA enterprise script loaded."))},i=function(){return i=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=5;break}if(null!=t.tenantId||null==t._agentRecaptchaConfig){e.next=3;break}return e.abrupt("return",t._agentRecaptchaConfig.siteKey);case 3:if(null==t.tenantId||void 0===t._tenantRecaptchaConfigs[t.tenantId]){e.next=5;break}return e.abrupt("return",t._tenantRecaptchaConfigs[t.tenantId].siteKey);case 5:return e.abrupt("return",new Promise(function(){var e=lt(ft().mark((function e(n,r){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:K6(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((function(e){if(void 0!==e.recaptchaKey){var i=new Y6(e);return null==t.tenantId?t._agentRecaptchaConfig=i:t._tenantRecaptchaConfigs[t.tenantId]=i,n(i.siteKey)}r(new Error("recaptcha Enterprise site key undefined"))})).catch((function(e){r(e)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 6:case"end":return e.stop()}}),e)}))),i.apply(this,arguments)},r=function(e){return i.apply(this,arguments)},t=u.length>0&&void 0!==u[0]?u[0]:"verify",n=u.length>1&&void 0!==u[1]&&u[1],!this.auth.settings.appVerificationDisabledForTesting){e.next=8;break}return o=new e7,e.abrupt("return",o.execute("siteKey",{action:"verify"}));case 8:return e.abrupt("return",new Promise((function(e,t){r(s.auth).then((function(r){if(!n&&Q6(window.grecaptcha))a(r,e,t);else{if("undefined"===typeof window)return void t(new Error("RecaptchaVerifier is only supported in browser"));var i=J8();0!==i.length&&(i+=r),Z8(i).then((function(){a(r,e,t)})).catch((function(e){t(e)}))}})).catch((function(e){t(e)}))})));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function i7(e,t,n){return a7.apply(this,arguments)}function a7(){return a7=lt(ft().mark((function e(t,n,r){var i,a,o,s,u,l,c,h,f=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=f.length>3&&void 0!==f[3]&&f[3],a=f.length>4&&void 0!==f[4]&&f[4],o=new r7(t),!a){e.next=7;break}s=n7,e.next=18;break;case 7:return e.prev=7,e.next=10,o.verify(r);case 10:s=e.sent,e.next=18;break;case 13:return e.prev=13,e.t0=e.catch(7),e.next=17,o.verify(r,!0);case 17:s=e.sent;case 18:if(u=Object.assign({},n),"mfaSmsEnrollment"!==r&&"mfaSmsSignIn"!==r){e.next=22;break}return"phoneEnrollmentInfo"in u?(l=u.phoneEnrollmentInfo.phoneNumber,c=u.phoneEnrollmentInfo.recaptchaToken,Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})):"phoneSignInInfo"in u&&(h=u.phoneSignInInfo.recaptchaToken,Object.assign(u,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})),e.abrupt("return",u);case 22:return i?Object.assign(u,{captchaResp:s}):Object.assign(u,{captchaResponse:s}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),e.abrupt("return",u);case 26:case"end":return e.stop()}}),e,null,[[7,13]])}))),a7.apply(this,arguments)}function o7(e,t,n,r,i){return s7.apply(this,arguments)}function s7(){return s7=lt(ft().mark((function e(t,n,r,i,a){var o,s,u,l,c;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("EMAIL_PASSWORD_PROVIDER"!==a){e.next=11;break}if(!(null===(o=t._getRecaptchaConfig())||void 0===o?void 0:o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))){e.next=8;break}return e.next=4,i7(t,n,r,"getOobCode"===r);case 4:return u=e.sent,e.abrupt("return",i(t,u));case 8:return e.abrupt("return",i(t,n).catch(function(){var e=lt(ft().mark((function e(a){var o;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.code!=="auth/".concat("missing-recaptcha-token")){e.next=8;break}return console.log("".concat(r," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.")),e.next=4,i7(t,n,r,"getOobCode"===r);case 4:return o=e.sent,e.abrupt("return",i(t,o));case 8:return e.abrupt("return",Promise.reject(a));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 9:case 23:e.next=26;break;case 11:if("PHONE_PROVIDER"!==a){e.next=25;break}if(!(null===(s=t._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("PHONE_PROVIDER"))){e.next=19;break}return e.next=15,i7(t,n,r);case 15:return l=e.sent,e.abrupt("return",i(t,l).catch(function(){var e=lt(ft().mark((function e(a){var o,s;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("AUDIT"!==(null===(o=t._getRecaptchaConfig())||void 0===o?void 0:o.getProviderEnforcementState("PHONE_PROVIDER"))){e.next=7;break}if(a.code!=="auth/".concat("missing-recaptcha-token")&&a.code!=="auth/".concat("invalid-app-credential")){e.next=7;break}return console.log("Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ".concat(r," flow.")),e.next=5,i7(t,n,r,!1,!0);case 5:return s=e.sent,e.abrupt("return",i(t,s));case 7:return e.abrupt("return",Promise.reject(a));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 19:return e.next=21,i7(t,n,r,!1,!0);case 21:return c=e.sent,e.abrupt("return",i(t,c));case 25:return e.abrupt("return",Promise.reject(a+" provider is not supported."));case 26:case"end":return e.stop()}}),e)}))),s7.apply(this,arguments)}function u7(e){return l7.apply(this,arguments)}function l7(){return l7=lt(ft().mark((function e(t){var n,r,i;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Q8(t),e.next=3,K6(n,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"});case 3:r=e.sent,i=new Y6(r),null==n.tenantId?n._agentRecaptchaConfig=i:n._tenantRecaptchaConfigs[n.tenantId]=i,i.isAnyProviderEnabled()&&new r7(n).verify();case 7:case"end":return e.stop()}}),e)}))),l7.apply(this,arguments)}function c7(e,t){var n=F5(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(G4(n.getOptions(),null!==t&&void 0!==t?t:{}))return r;m6(r,"already-initialized")}return n.initialize({options:t})}function h7(e,t,n){var r=Q8(e);w6(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");var i=!!(null===n||void 0===n?void 0:n.disableWarnings),a=f7(t),o=function(e){var t=f7(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};var r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){var a=i[1];return{host:a,port:d7(r.substr(a.length+1))}}var o=T(r.split(":"),2);return{host:o[0],port:d7(o[1])}}(t),s=o.host,u=o.port,l=null===u?"":":".concat(u),c={url:"".concat(a,"//").concat(s).concat(l,"/")},h=Object.freeze({host:s,port:u,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator)return w6(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void w6(G4(c,r.config.emulator)&&G4(h,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,i||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function f7(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function d7(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}var p7=function(){function e(t,n){c(this,e),this.providerId=t,this.signInMethod=n}return p(e,[{key:"toJSON",value:function(){return T6("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return T6("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return T6("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return T6("not implemented")}}]),e}();function A7(e,t){return v7.apply(this,arguments)}function v7(){return v7=lt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U6(t,"POST","/v1/accounts:signUp",n));case 1:case"end":return e.stop()}}),e)}))),v7.apply(this,arguments)}function m7(e,t){return g7.apply(this,arguments)}function g7(){return g7=lt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V6(t,"POST","/v1/accounts:signInWithPassword",O6(t,n)));case 1:case"end":return e.stop()}}),e)}))),g7.apply(this,arguments)}function y7(e,t){return _7.apply(this,arguments)}function _7(){return _7=lt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V6(t,"POST","/v1/accounts:signInWithEmailLink",O6(t,n)));case 1:case"end":return e.stop()}}),e)}))),_7.apply(this,arguments)}function b7(e,t){return x7.apply(this,arguments)}function x7(){return x7=lt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V6(t,"POST","/v1/accounts:signInWithEmailLink",O6(t,n)));case 1:case"end":return e.stop()}}),e)}))),x7.apply(this,arguments)}var w7=function(e){v(n,e);var t=b(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return c(this,n),(a=t.call(this,"password",i))._email=e,a._password=r,a._tenantId=o,a}return p(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(){var e=lt(ft().mark((function e(t){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?5:6;break;case 3:return n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},e.abrupt("return",o7(t,n,"signInWithPassword",m7,"EMAIL_PASSWORD_PROVIDER"));case 5:return e.abrupt("return",y7(t,{email:this._email,oobCode:this._password}));case 6:m6(t,"internal-error");case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_linkToIdToken",value:function(){var e=lt(ft().mark((function e(t,n){var r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?5:6;break;case 3:return r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},e.abrupt("return",o7(t,r,"signUpPassword",A7,"EMAIL_PASSWORD_PROVIDER"));case 5:return e.abrupt("return",b7(t,{idToken:n,email:this._email,oobCode:this._password}));case 6:m6(t,"internal-error");case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new n(e,t,"emailLink",r)}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(p7);function T7(e,t){return S7.apply(this,arguments)}function S7(){return S7=lt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V6(t,"POST","/v1/accounts:signInWithIdp",O6(t,n)));case 1:case"end":return e.stop()}}),e)}))),S7.apply(this,arguments)}var E7=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return p(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return T7(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,T7(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,T7(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=W4(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):m6("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=l6(t,["providerId","signInMethod"]);if(!r||!i)return null;var o=new n(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),n}(p7);function k7(e,t){return M7.apply(this,arguments)}function M7(){return M7=lt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U6(t,"POST","/v1/accounts:sendVerificationCode",O6(t,n)));case 1:case"end":return e.stop()}}),e)}))),M7.apply(this,arguments)}function C7(){return C7=lt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V6(t,"POST","/v1/accounts:signInWithPhoneNumber",O6(t,n)));case 1:case"end":return e.stop()}}),e)}))),C7.apply(this,arguments)}function R7(){return R7=lt(ft().mark((function e(t,n){var r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V6(t,"POST","/v1/accounts:signInWithPhoneNumber",O6(t,n));case 2:if(!(r=e.sent).temporaryProof){e.next=5;break}throw X6(t,"account-exists-with-different-credential",r);case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),R7.apply(this,arguments)}var P7=We({},"USER_NOT_FOUND","user-not-found");function N7(){return N7=lt(ft().mark((function e(t,n){var r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.assign(Object.assign({},n),{operation:"REAUTH"}),e.abrupt("return",V6(t,"POST","/v1/accounts:signInWithPhoneNumber",O6(t,r),P7));case 2:case"end":return e.stop()}}),e)}))),N7.apply(this,arguments)}var I7=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,"phone","phone")).params=e,r}return p(n,[{key:"_getIdTokenResponse",value:function(e){return function(e,t){return C7.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_linkToIdToken",value:function(e,t){return function(e,t){return R7.apply(this,arguments)}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}},{key:"_getReauthenticationResolver",value:function(e){return function(e,t){return N7.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_makeVerificationRequest",value:function(){var e=this.params,t=e.temporaryProof,n=e.phoneNumber,r=e.verificationId,i=e.verificationCode;return t&&n?{temporaryProof:t,phoneNumber:n}:{sessionInfo:r,code:i}}},{key:"toJSON",value:function(){var e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}}],[{key:"_fromVerification",value:function(e,t){return new n({verificationId:e,verificationCode:t})}},{key:"_fromTokenResponse",value:function(e,t){return new n({phoneNumber:e,temporaryProof:t})}},{key:"fromJSON",value:function(e){"string"===typeof e&&(e=JSON.parse(e));var t=e,r=t.verificationId,i=t.verificationCode,a=t.phoneNumber,o=t.temporaryProof;return i||r||a||o?new n({verificationId:r,verificationCode:i,phoneNumber:a,temporaryProof:o}):null}}]),n}(p7);var L7=function(){function e(t){var n,r,i,a,o,s;c(this,e);var u=X4(Q4(t)),l=null!==(n=u.apiKey)&&void 0!==n?n:null,h=null!==(r=u.oobCode)&&void 0!==r?r:null,f=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=u.mode)&&void 0!==i?i:null);w6(l&&h&&f,"argument-error"),this.apiKey=l,this.operation=f,this.code=h,this.continueUrl=null!==(a=u.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=u.tenantId)&&void 0!==s?s:null}return p(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=X4(Q4(e)).link,n=t?X4(Q4(t)).deep_link_id:null,r=X4(Q4(e)).deep_link_id;return(r?X4(Q4(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(Bl){return null}}}]),e}();var D7=function(){function e(){c(this,e),this.providerId=e.PROVIDER_ID}return p(e,null,[{key:"credential",value:function(e,t){return w7._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=L7.parseLink(t);return w6(n,"argument-error"),w7._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();D7.PROVIDER_ID="password",D7.EMAIL_PASSWORD_SIGN_IN_METHOD="password",D7.EMAIL_LINK_SIGN_IN_METHOD="emailLink";var O7=function(){function e(t){c(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return p(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),U7=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.apply(this,arguments)).scopes=[],e}return p(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return l(this.scopes)}}]),n}(O7),B7=function(e){v(n,e);var t=b(n);function n(){return c(this,n),t.call(this,"facebook.com")}return p(n,null,[{key:"credential",value:function(e){return E7._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(Bl){return null}}}]),n}(U7);B7.FACEBOOK_SIGN_IN_METHOD="facebook.com",B7.PROVIDER_ID="facebook.com";var F7=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return p(n,null,[{key:"credential",value:function(e,t){return E7._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken;if(!r&&!i)return null;try{return n.credential(r,i)}catch(Bl){return null}}}]),n}(U7);F7.GOOGLE_SIGN_IN_METHOD="google.com",F7.PROVIDER_ID="google.com";var z7=function(e){v(n,e);var t=b(n);function n(){return c(this,n),t.call(this,"github.com")}return p(n,null,[{key:"credential",value:function(e){return E7._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(Bl){return null}}}]),n}(U7);z7.GITHUB_SIGN_IN_METHOD="github.com",z7.PROVIDER_ID="github.com";var V7=function(e){v(n,e);var t=b(n);function n(){return c(this,n),t.call(this,"twitter.com")}return p(n,null,[{key:"credential",value:function(e,t){return E7._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthAccessToken,i=t.oauthTokenSecret;if(!r||!i)return null;try{return n.credential(r,i)}catch(Bl){return null}}}]),n}(U7);V7.TWITTER_SIGN_IN_METHOD="twitter.com",V7.PROVIDER_ID="twitter.com";var q7=function(){function e(t){c(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return p(e,null,[{key:"_fromIdTokenResponse",value:function(){var t=lt(ft().mark((function t(n,r,i){var a,o,s,u,l=arguments;return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.length>3&&void 0!==l[3]&&l[3],t.next=3,w8._fromIdTokenResponse(n,i,a);case 3:return o=t.sent,s=j7(i),u=new e({user:o,providerId:s,_tokenResponse:i,operationType:r}),t.abrupt("return",u);case 7:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"_forOperation",value:function(){var t=lt(ft().mark((function t(n,r,i){var a;return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n._updateTokensIfNecessary(i,!0);case 2:return a=j7(i),t.abrupt("return",new e({user:n,providerId:a,_tokenResponse:i,operationType:r}));case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()}]),e}();function j7(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}var G7=function(e){v(n,e);var t=b(n);function n(e,r,i,a){var o,s;return c(this,n),(o=t.call(this,r.code,r.message)).operationType=i,o.user=a,Object.setPrototypeOf(y(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:i},o}return p(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,i){return new n(e,t,r,i)}}]),n}(F4);function H7(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((function(n){if(n.code==="auth/".concat("multi-factor-auth-required"))throw G7._fromErrorAndOperation(e,n,t,r);throw n}))}function W7(e,t){return X7.apply(this,arguments)}function X7(){return X7=lt(ft().mark((function e(t,n){var r,i,a=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]&&a[2],e.t0=s8,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return i=e.sent,e.abrupt("return",q7._forOperation(t,"link",i));case 14:case"end":return e.stop()}}),e)}))),X7.apply(this,arguments)}function Q7(e,t){return Y7.apply(this,arguments)}function Y7(){return Y7=lt(ft().mark((function e(t,n){var r,i,a,o,s,u,l=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=l.length>2&&void 0!==l[2]&&l[2],!z5((i=t.auth).app)){e.next=4;break}return e.abrupt("return",Promise.reject(_6(i)));case 4:return a="reauthenticate",e.prev=5,e.next=8,s8(t,H7(i,a,n,t),r);case 8:return w6((o=e.sent).idToken,i,"internal-error"),w6(s=a8(o.idToken),i,"internal-error"),u=s.sub,w6(t.uid===u,i,"user-mismatch"),e.abrupt("return",q7._forOperation(t,a,o));case 17:throw e.prev=17,e.t0=e.catch(5),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("user-not-found")&&m6(i,"user-mismatch"),e.t0;case 21:case"end":return e.stop()}}),e,null,[[5,17]])}))),Y7.apply(this,arguments)}function K7(e,t){return Z7.apply(this,arguments)}function Z7(){return Z7=lt(ft().mark((function e(t,n){var r,i,a,o,s=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>2&&void 0!==s[2]&&s[2],!z5(t.app)){e.next=3;break}return e.abrupt("return",Promise.reject(_6(t)));case 3:return i="signIn",e.next=6,H7(t,i,n);case 6:return a=e.sent,e.next=9,q7._fromIdTokenResponse(t,i,a);case 9:if(o=e.sent,r){e.next=13;break}return e.next=13,t._updateCurrentUser(o.user);case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)}))),Z7.apply(this,arguments)}function J7(e,t,n,r){return Z4(e).onIdTokenChanged(t,n,r)}function $7(e,t,n){return Z4(e).beforeAuthStateChanged(t,n)}function e9(e,t){return U6(e,"POST","/v2/accounts/mfaEnrollment:start",O6(e,t))}function t9(e,t){return U6(e,"POST","/v2/accounts/mfaEnrollment:start",O6(e,t))}function n9(e,t){return U6(e,"POST","/v2/accounts/mfaEnrollment:finalize",O6(e,t))}new WeakMap;var r9="__sak",i9=function(){function e(t,n){c(this,e),this.storageRetriever=t,this.type=n}return p(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(r9,"1"),this.storage.removeItem(r9),Promise.resolve(!0)):Promise.resolve(!1)}catch(Bl){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}(),a9=function(e){v(n,e);var t=b(n);function n(){var e;return c(this,n),(e=t.call(this,(function(){return window.localStorage}),"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.fallbackToPolling=V8(),e._shouldAllowMigration=!0,e}return p(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],i=this.storage.getItem(r),a=this.localCache[r];i!==a&&e(r,a,i)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;n?this.detachListener():this.stopPolling();var i=function(){var e=t.storage.getItem(r);(n||t.localCache[r]!==e)&&t.notifyListeners(r,e)},a=this.storage.getItem(r);z8()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}else this.forAllChangedKeys((function(e,n,r){t.notifyListeners(e,r)}))}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t?JSON.parse(t):t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval((function(){e.forAllChangedKeys((function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)}))}),1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(){var e=lt(ft().mark((function e(t,r){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ht(m(n.prototype),"_set",this).call(this,t,r);case 2:this.localCache[t]=JSON.stringify(r);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=lt(ft().mark((function e(t){var r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ht(m(n.prototype),"_get",this).call(this,t);case 2:return r=e.sent,this.localCache[t]=JSON.stringify(r),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ht(m(n.prototype),"_remove",this).call(this,t);case 2:delete this.localCache[t];case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(i9);a9.type="LOCAL";var o9=a9;function s9(e){var t,n,r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),i=RegExp("".concat(r,"=([^;]+)"));return null!==(n=null===(t=document.cookie.match(i))||void 0===t?void 0:t[1])&&void 0!==n?n:null}function u9(e){var t="http:"===window.location.protocol;return"".concat(t?"__dev_":"__HOST-","FIREBASE_").concat(e.split(":")[3])}var l9=function(){function e(){c(this,e),this.type="COOKIE",this.listenerUnsubscribes=new Map}return p(e,[{key:"_getFinalTarget",value:function(e){if(void 0===typeof window)return e;var t=new URL("".concat(window.location.origin,"/__cookies__"));return t.searchParams.set("finalTarget",e),t}},{key:"_isAvailable",value:function(){var e=lt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("boolean"!==typeof isSecureContext||isSecureContext){e.next=2;break}return e.abrupt("return",!1);case 2:if("undefined"!==typeof navigator&&"undefined"!==typeof document){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",null===(t=navigator.cookieEnabled)||void 0===t||t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=lt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=lt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._isAvailable()){e.next=2;break}return e.abrupt("return",null);case 2:if(n=u9(t),!window.cookieStore){e.next=8;break}return e.next=6,window.cookieStore.get(n);case 6:return r=e.sent,e.abrupt("return",null===r||void 0===r?void 0:r.value);case 8:return e.abrupt("return",s9(n));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=lt(ft().mark((function e(t){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._isAvailable()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this._get(t);case 4:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return n=u9(t),document.cookie="".concat(n,"=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High"),e.next=11,fetch("/__cookies__",{method:"DELETE"}).catch((function(){}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_addListener",value:function(e,t){if(this._isAvailable()){var n=u9(e);if(window.cookieStore){var r=function(e){var r=e.changed.find((function(e){return e.name===n}));r&&t(r.value),e.deleted.find((function(e){return e.name===n}))&&t(null)};return this.listenerUnsubscribes.set(t,(function(){return window.cookieStore.removeEventListener("change",r)})),window.cookieStore.addEventListener("change",r)}var i=s9(n),a=setInterval((function(){var e=s9(n);e!==i&&(t(e),i=e)}),1e3);this.listenerUnsubscribes.set(t,(function(){return clearInterval(a)}))}}},{key:"_removeListener",value:function(e,t){var n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}]),e}();l9.type="COOKIE";var c9=function(e){v(n,e);var t=b(n);function n(){return c(this,n),t.call(this,(function(){return window.sessionStorage}),"SESSION")}return p(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(i9);c9.type="SESSION";var h9=c9;function f9(e){return Promise.all(e.map(function(){var e=lt(ft().mark((function e(t){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t;case 3:return n=e.sent,e.abrupt("return",{fulfilled:!0,value:n});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t0});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()))}var d9=function(){function e(t){c(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return p(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(){var e=lt(ft().mark((function e(t){var n,r,i,a,o,s,u,l;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=t).data,i=r.eventId,a=r.eventType,o=r.data,null===(s=this.handlersMap[a])||void 0===s?void 0:s.size){e.next=5;break}return e.abrupt("return");case 5:return n.ports[0].postMessage({status:"ack",eventId:i,eventType:a}),u=Array.from(s).map(function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(n.origin,o));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=9,f9(u);case 9:l=e.sent,n.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:l});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find((function(e){return e.isListeningto(t)}));if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();function p9(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}d9.receivers=[];var A9=function(){function e(t){c(this,e),this.target=t,this.handlers=new Set}return p(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(){var e=lt(ft().mark((function e(t,n){var r,i,a,o,s=this,u=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>2&&void 0!==u[2]?u[2]:50,i="undefined"!==typeof MessageChannel?new MessageChannel:null){e.next=4;break}throw new Error("connection_unavailable");case 4:return e.abrupt("return",new Promise((function(e,u){var l=p9("",20);i.port1.start();var c=setTimeout((function(){u(new Error("unsupported_event"))}),r);o={messageChannel:i,onMessage:function(t){var n=t;if(n.data.eventId===l)switch(n.data.status){case"ack":clearTimeout(c),a=setTimeout((function(){u(new Error("timeout"))}),3e3);break;case"done":clearTimeout(a),e(n.data.response);break;default:clearTimeout(c),clearTimeout(a),u(new Error("invalid_response"))}}},s.handlers.add(o),i.port1.addEventListener("message",o.onMessage),s.target.postMessage({eventType:t,eventId:l,data:n},[i.port2])})).finally((function(){o&&s.removeMessageHandler(o)})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function v9(){return window}function m9(e){v9().location.href=e}function g9(){return"undefined"!==typeof v9().WorkerGlobalScope&&"function"===typeof v9().importScripts}function y9(){return _9.apply(this,arguments)}function _9(){return(_9=lt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===navigator||void 0===navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return t=e.sent,e.abrupt("return",t.active);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function b9(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}var x9="firebaseLocalStorageDb",w9="firebaseLocalStorage",T9="fbase_key",S9=function(){function e(t){c(this,e),this.request=t}return p(e,[{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.request.addEventListener("success",(function(){t(e.request.result)})),e.request.addEventListener("error",(function(){n(e.request.error)}))}))}}]),e}();function E9(e,t){return e.transaction([w9],t?"readwrite":"readonly").objectStore(w9)}function k9(){var e=indexedDB.deleteDatabase(x9);return new S9(e).toPromise()}function M9(){var e=indexedDB.open(x9,1);return new Promise((function(t,n){e.addEventListener("error",(function(){n(e.error)})),e.addEventListener("upgradeneeded",(function(){var t=e.result;try{t.createObjectStore(w9,{keyPath:T9})}catch(p0){n(p0)}})),e.addEventListener("success",lt(ft().mark((function n(){var r;return ft().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((r=e.result).objectStoreNames.contains(w9)){n.next=12;break}return r.close(),n.next=5,k9();case 5:return n.t0=t,n.next=8,M9();case 8:n.t1=n.sent,(0,n.t0)(n.t1),n.next=13;break;case 12:t(r);case 13:case"end":return n.stop()}}),n)}))))}))}function C9(e,t,n){return R9.apply(this,arguments)}function R9(){return R9=lt(ft().mark((function e(t,n,r){var i,a;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=E9(t,!0).put((We(i={},T9,n),We(i,"value",r),i)),e.abrupt("return",new S9(a).toPromise());case 2:case"end":return e.stop()}}),e)}))),R9.apply(this,arguments)}function P9(e,t){return N9.apply(this,arguments)}function N9(){return N9=lt(ft().mark((function e(t,n){var r,i;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=E9(t,!1).get(n),e.next=3,new S9(r).toPromise();case 3:return i=e.sent,e.abrupt("return",void 0===i?null:i.value);case 5:case"end":return e.stop()}}),e)}))),N9.apply(this,arguments)}function I9(e,t){var n=E9(e,!0).delete(t);return new S9(n).toPromise()}var L9=function(){function e(){c(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((function(){}),(function(){}))}return p(e,[{key:"_openDb",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.db){e.next=2;break}return e.abrupt("return",this.db);case 2:return e.next=4,M9();case 4:return this.db=e.sent,e.abrupt("return",this.db);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_withRetries",value:function(){var e=lt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:return e.prev=2,e.next=5,this._openDb();case 5:return r=e.sent,e.next=8,t(r);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!(n++>3)){e.next=15;break}throw e.t0;case 15:this.db&&(this.db.close(),this.db=void 0);case 16:e.next=1;break;case 18:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"initializeServiceWorkerMessaging",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",g9()?this.initializeReceiver():this.initializeSender());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeReceiver",value:function(){var e=lt(ft().mark((function e(){var t=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.receiver=d9._getInstance(g9()?self:null),this.receiver._subscribe("keyChanged",function(){var e=lt(ft().mark((function e(n,r){var i;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._poll();case 2:return i=e.sent,e.abrupt("return",{keyProcessed:i.includes(r.key)});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),this.receiver._subscribe("ping",function(){var e=lt(ft().mark((function e(t,n){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeSender",value:function(){var e=lt(ft().mark((function e(){var t,n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y9();case 2:if(this.activeServiceWorker=e.sent,this.activeServiceWorker){e.next=5;break}return e.abrupt("return");case 5:return this.sender=new A9(this.activeServiceWorker),e.next=8,this.sender._send("ping",{},800);case 8:if(r=e.sent){e.next=11;break}return e.abrupt("return");case 11:(null===(t=r[0])||void 0===t?void 0:t.fulfilled)&&(null===(n=r[0])||void 0===n?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyServiceWorker",value:function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sender&&this.activeServiceWorker&&b9()===this.activeServiceWorker){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:case"end":return e.stop()}}),e,this,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_isAvailable",value:function(){var e=lt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,M9();case 5:return t=e.sent,e.next=8,C9(t,r9,"1");case 8:return e.next=10,I9(t,r9);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"_withPendingWrite",value:function(){var e=lt(ft().mark((function e(t){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pendingWrites++,e.prev=1,e.next=4,t();case 4:return e.prev=4,this.pendingWrites--,e.finish(4);case 7:case"end":return e.stop()}}),e,this,[[1,,4,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=lt(ft().mark((function e(t,n){var r=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite(lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._withRetries((function(e){return C9(e,t,n)}));case 2:return r.localCache[t]=n,e.abrupt("return",r.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=lt(ft().mark((function e(t){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){return P9(e,t)}));case 2:return n=e.sent,this.localCache[t]=n,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=lt(ft().mark((function e(t){var n=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite(lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return I9(e,t)}));case 2:return delete n.localCache[t],e.abrupt("return",n.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_poll",value:function(){var e=lt(ft().mark((function e(){var t,n,r,i,a,o,s,u,l,c,h;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){var t=E9(e,!1).getAll();return new S9(t).toPromise()}));case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:if(0===this.pendingWrites){e.next=7;break}return e.abrupt("return",[]);case 7:if(n=[],r=new Set,0!==t.length){i=k(t);try{for(i.s();!(a=i.n()).done;)o=a.value,s=o.fbase_key,u=o.value,r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(u)&&(this.notifyListeners(s,u),n.push(s))}catch(f){i.e(f)}finally{i.f()}}for(l=0,c=Object.keys(this.localCache);l<c.length;l++)h=c[l],this.localCache[h]&&!r.has(h)&&(this.notifyListeners(h,null),n.push(h));return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(lt(ft().mark((function t(){return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}}),t)}))),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();L9.type="LOCAL";var D9=L9;function O9(e,t){return U6(e,"POST","/v2/accounts/mfaSignIn:start",O6(e,t))}function U9(e,t){return U6(e,"POST","/v2/accounts/mfaSignIn:finalize",O6(e,t))}$8("rcb"),new R6(3e4,6e4);var B9="recaptcha";function F9(e,t,n){return z9.apply(this,arguments)}function z9(){return z9=lt(ft().mark((function e(t,n,r){var i,a,o,s,u,l,c,h,f,d,p,A,v,m,g,y;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t._getRecaptchaConfig()){e.next=9;break}return e.prev=1,e.next=4,u7(t);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.");case 9:if(e.prev=9,!("session"in(a="string"===typeof n?{phoneNumber:n}:n))){e.next=36;break}if(o=a.session,!("phoneNumber"in a)){e.next=24;break}return w6("enroll"===o.type,t,"internal-error"),s={idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},u=function(){var e=lt(ft().mark((function e(t,n){var i;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.phoneEnrollmentInfo.captchaResponse!==n7){e.next=6;break}return w6((null===r||void 0===r?void 0:r.type)===B9,t,"argument-error"),e.next=4,V9(t,n,r);case 4:return i=e.sent,e.abrupt("return",e9(t,i));case 6:return e.abrupt("return",e9(t,n));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),l=o7(t,s,"mfaSmsEnrollment",u,"PHONE_PROVIDER"),e.next=20,l.catch((function(e){return Promise.reject(e)}));case 20:return c=e.sent,e.abrupt("return",c.phoneSessionInfo.sessionInfo);case 24:return w6("signin"===o.type,t,"internal-error"),w6(h=(null===(i=a.multiFactorHint)||void 0===i?void 0:i.uid)||a.multiFactorUid,t,"missing-multi-factor-info"),f={mfaPendingCredential:o.credential,mfaEnrollmentId:h,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},d=function(){var e=lt(ft().mark((function e(t,n){var i;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.phoneSignInInfo.captchaResponse!==n7){e.next=6;break}return w6((null===r||void 0===r?void 0:r.type)===B9,t,"argument-error"),e.next=4,V9(t,n,r);case 4:return i=e.sent,e.abrupt("return",O9(t,i));case 6:return e.abrupt("return",O9(t,n));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),p=o7(t,f,"mfaSmsSignIn",d,"PHONE_PROVIDER"),e.next=32,p.catch((function(e){return Promise.reject(e)}));case 32:return A=e.sent,e.abrupt("return",A.phoneResponseInfo.sessionInfo);case 34:e.next=43;break;case 36:return v={phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"},m=function(){var e=lt(ft().mark((function e(t,n){var i;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.captchaResponse!==n7){e.next=6;break}return w6((null===r||void 0===r?void 0:r.type)===B9,t,"argument-error"),e.next=4,V9(t,n,r);case 4:return i=e.sent,e.abrupt("return",k7(t,i));case 6:return e.abrupt("return",k7(t,n));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),g=o7(t,v,"sendVerificationCode",m,"PHONE_PROVIDER"),e.next=41,g.catch((function(e){return Promise.reject(e)}));case 41:return y=e.sent,e.abrupt("return",y.sessionInfo);case 43:return e.prev=43,null===r||void 0===r||r._reset(),e.finish(43);case 46:case"end":return e.stop()}}),e,null,[[1,6],[9,,43,46]])}))),z9.apply(this,arguments)}function V9(e,t,n){return q9.apply(this,arguments)}function q9(){return q9=lt(ft().mark((function e(t,n,r){var i,a,o,s,u,l,c,h,f;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w6(r.type===B9,t,"argument-error"),e.next=3,r.verify();case 3:if(w6("string"===typeof(i=e.sent),t,"argument-error"),!("phoneEnrollmentInfo"in(a=Object.assign({},n)))){e.next=15;break}return o=a.phoneEnrollmentInfo.phoneNumber,s=a.phoneEnrollmentInfo.captchaResponse,u=a.phoneEnrollmentInfo.clientType,l=a.phoneEnrollmentInfo.recaptchaVersion,Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:i,captchaResponse:s,clientType:u,recaptchaVersion:l}}),e.abrupt("return",a);case 15:if(!("phoneSignInInfo"in a)){e.next=23;break}return c=a.phoneSignInInfo.captchaResponse,h=a.phoneSignInInfo.clientType,f=a.phoneSignInInfo.recaptchaVersion,Object.assign(a,{phoneSignInInfo:{recaptchaToken:i,captchaResponse:c,clientType:h,recaptchaVersion:f}}),e.abrupt("return",a);case 23:return Object.assign(a,{recaptchaToken:i}),e.abrupt("return",a);case 25:case"end":return e.stop()}}),e)}))),q9.apply(this,arguments)}var j9=function(){function e(t){c(this,e),this.providerId=e.PROVIDER_ID,this.auth=Q8(t)}return p(e,[{key:"verifyPhoneNumber",value:function(e,t){return F9(this.auth,e,Z4(t))}}],[{key:"credential",value:function(e,t){return I7._fromVerification(e,t)}},{key:"credentialFromResult",value:function(t){var n=t;return e.credentialFromTaggedObject(n)}},{key:"credentialFromError",value:function(t){return e.credentialFromTaggedObject(t.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.phoneNumber,r=t.temporaryProof;return n&&r?I7._fromTokenResponse(n,r):null}}]),e}();function G9(e,t){return t?S8(t):(w6(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}j9.PROVIDER_ID="phone",j9.PHONE_SIGN_IN_METHOD="phone";var H9=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,"custom","custom")).params=e,r}return p(n,[{key:"_getIdTokenResponse",value:function(e){return T7(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return T7(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return T7(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(p7);function W9(e){return K7(e.auth,new H9(e),e.bypassAuthState)}function X9(e){var t=e.auth,n=e.user;return w6(n,t,"internal-error"),Q7(n,new H9(e),e.bypassAuthState)}function Q9(e){return Y9.apply(this,arguments)}function Y9(){return Y9=lt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,w6(r=t.user,n,"internal-error"),e.abrupt("return",W7(r,new H9(t),t.bypassAuthState));case 3:case"end":return e.stop()}}),e)}))),Y9.apply(this,arguments)}var K9=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];c(this,e),this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return p(e,[{key:"execute",value:function(){var e=this;return new Promise(function(){var t=lt(ft().mark((function t(n,r){return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.pendingPromise={resolve:n,reject:r},t.prev=1,t.next=4,e.resolver._initialize(e.auth);case 4:return e.eventManager=t.sent,t.next=7,e.onExecution();case 7:e.eventManager.registerConsumer(e),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),e.reject(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"onAuthEvent",value:function(){var e=lt(ft().mark((function e(t){var n,r,i,a,o,s,u;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.urlResponse,r=t.sessionId,i=t.postBody,a=t.tenantId,o=t.error,s=t.type,!o){e.next=4;break}return this.reject(o),e.abrupt("return");case 4:return u={auth:this.auth,requestUri:n,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState},e.prev=5,e.t0=this,e.next=9,this.getIdpTask(s)(u);case 9:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=16;break;case 13:e.prev=13,e.t2=e.catch(5),this.reject(e.t2);case 16:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return W9;case"linkViaPopup":case"linkViaRedirect":return Q9;case"reauthViaPopup":case"reauthViaRedirect":return X9;default:m6(this.auth,"internal-error")}}},{key:"resolve",value:function(e){S6(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){S6(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),Z9=new R6(2e3,1e4);function J9(){return J9=lt(ft().mark((function e(t,n,r){var i,a,o;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!z5(t.app)){e.next=2;break}return e.abrupt("return",Promise.reject(g6(t,"operation-not-supported-in-this-environment")));case 2:return i=Q8(t),b6(t,n,O7),a=G9(i,r),o=new $9(i,"signInViaPopup",n,a),e.abrupt("return",o.executeNotNull());case 7:case"end":return e.stop()}}),e)}))),J9.apply(this,arguments)}var $9=function(e){v(n,e);var t=b(n);function n(e,r,i,a,o){var s;return c(this,n),(s=t.call(this,e,r,a,o)).provider=i,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=y(s),s}return p(n,[{key:"executeNotNull",value:function(){var e=lt(ft().mark((function e(){var t;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.execute();case 2:return w6(t=e.sent,this.auth,"internal-error"),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=lt(ft().mark((function e(){var t,n=this;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S6(1===this.filter.length,"Popup operations only handle one event"),t=p9(),e.next=4,this.resolver._openPopup(this.auth,this.provider,this.filter[0],t);case 4:this.authWindow=e.sent,this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((function(e){n.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(function(e){e||n.reject(g6(n.auth,"web-storage-unsupported"))})),this.pollUserCancellation();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(g6(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?e.pollId=window.setTimeout((function(){e.pollId=null,e.reject(g6(e.auth,"popup-closed-by-user"))}),8e3):e.pollId=window.setTimeout(t,Z9.get())}()}}]),n}(K9);$9.currentPopupAction=null;var eee=new Map,tee=function(e){v(n,e);var t=b(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return c(this,n),(i=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,a)).eventId=null,i}return p(n,[{key:"execute",value:function(){var e=lt(ft().mark((function e(){var t,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=eee.get(this.auth._key())){e.next=21;break}return e.prev=2,e.next=5,nee(this.resolver,this.auth);case 5:if(!e.sent){e.next=12;break}return e.next=9,ht(m(n.prototype),"execute",this).call(this);case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=null;case 13:r=e.t0,t=function(){return Promise.resolve(r)},e.next=20;break;case 17:e.prev=17,e.t1=e.catch(2),t=function(){return Promise.reject(e.t1)};case 20:eee.set(this.auth._key(),t);case 21:return this.bypassAuthState||eee.set(this.auth._key(),(function(){return Promise.resolve(null)})),e.abrupt("return",t());case 23:case"end":return e.stop()}}),e,this,[[2,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"onAuthEvent",value:function(){var e=lt(ft().mark((function e(t){var r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("signInViaRedirect"!==t.type){e.next=4;break}return e.abrupt("return",ht(m(n.prototype),"onAuthEvent",this).call(this,t));case 4:if("unknown"!==t.type){e.next=7;break}return this.resolve(null),e.abrupt("return");case 7:if(!t.eventId){e.next=17;break}return e.next=10,this.auth._redirectUserForId(t.eventId);case 10:if(!(r=e.sent)){e.next=16;break}return this.user=r,e.abrupt("return",ht(m(n.prototype),"onAuthEvent",this).call(this,t));case 16:this.resolve(null);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=lt(ft().mark((function e(){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"cleanUp",value:function(){}}]),n}(K9);function nee(e,t){return ree.apply(this,arguments)}function ree(){return ree=lt(ft().mark((function e(t,n){var r,i,a;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=oee(n),i=aee(t),e.next=4,i._isAvailable();case 4:if(e.sent){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,i._get(r);case 8:return e.t0=e.sent,a="true"===e.t0,e.next=12,i._remove(r);case 12:return e.abrupt("return",a);case 13:case"end":return e.stop()}}),e)}))),ree.apply(this,arguments)}function iee(e,t){eee.set(e._key(),t)}function aee(e){return S8(e._redirectPersistence)}function oee(e){return M8("pendingRedirect",e.config.apiKey,e.name)}function see(e,t){return uee.apply(this,arguments)}function uee(){return uee=lt(ft().mark((function e(t,n){var r,i,a,o,s,u=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>2&&void 0!==u[2]&&u[2],!z5(t.app)){e.next=3;break}return e.abrupt("return",Promise.reject(_6(t)));case 3:return i=Q8(t),a=G9(i,n),o=new tee(i,a,r),e.next=8,o.execute();case 8:if(!(s=e.sent)||r){e.next=15;break}return delete s.user._redirectEventId,e.next=13,i._persistUserIfCurrent(s.user);case 13:return e.next=15,i._setRedirectUser(null,n);case 15:return e.abrupt("return",s);case 16:case"end":return e.stop()}}),e)}))),uee.apply(this,arguments)}var lee=function(){function e(t){c(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return p(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach((function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return hee(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!hee(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(g6(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(cee(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(cee(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function cee(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((function(e){return e})).join("-")}function hee(e){var t=e.type,n=e.error;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}function fee(e){return dee.apply(this,arguments)}function dee(){return dee=lt(ft().mark((function e(t){var n,r=arguments;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",U6(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}}),e)}))),dee.apply(this,arguments)}var pee=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Aee=/^https?/;function vee(){return vee=lt(ft().mark((function e(t){var n,r,i,a,o;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,fee(t);case 4:n=e.sent,r=n.authorizedDomains,i=k(r),e.prev=7,i.s();case 9:if((a=i.n()).done){e.next=20;break}if(o=a.value,e.prev=11,!mee(o)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),i.e(e.t1);case 25:return e.prev=25,i.f(),e.finish(25);case 28:m6(t,"unauthorized-domain");case 29:case"end":return e.stop()}}),e,null,[[7,22,25,28],[11,16]])}))),vee.apply(this,arguments)}function mee(e){var t=E6(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!Aee.test(r))return!1;if(pee.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}var gee=new R6(3e4,6e4);function yee(){var e=v9().___jsl;if(null===e||void 0===e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=l(e.H[r].L),e.CP)for(var i=0;i<e.CP.length;i++)e.CP[i]=null}}function _ee(e){return new Promise((function(t,n){var r,i,a;function o(){yee(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){yee(),n(g6(e,"network-request-failed"))},timeout:gee.get()})}if(null===(i=null===(r=v9().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=v9().gapi)||void 0===a?void 0:a.load)){var s=$8("iframefcb");return v9()[s]=function(){gapi.load?o():n(g6(e,"network-request-failed"))},Z8("".concat(K8.gapiScript,"?onload=").concat(s)).catch((function(e){return n(e)}))}o()}})).catch((function(e){throw bee=null,e}))}var bee=null;function xee(e){return bee=bee||_ee(e)}var wee=new R6(5e3,15e3),Tee={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},See=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Eee(e){var t=e.config;w6(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?P6(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:G5},i=See.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(W4(r).slice(1))}function kee(e){return Mee.apply(this,arguments)}function Mee(){return Mee=lt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xee(t);case 2:return n=e.sent,w6(r=v9().gapi,t,"internal-error"),e.abrupt("return",n.open({where:document.body,url:Eee(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Tee,dontclear:!0},(function(e){return new Promise(function(){var n=lt(ft().mark((function n(r,i){var a,o,s;return ft().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){v9().clearTimeout(o),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:a=g6(t,"network-request-failed"),o=v9().setTimeout((function(){i(a)}),wee.get()),e.ping(s).then(s,(function(){i(a)}));case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())})));case 6:case"end":return e.stop()}}),e)}))),Mee.apply(this,arguments)}var Cee={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Ree="_blank",Pee="http://localhost",Nee=function(){function e(t){c(this,e),this.window=t,this.associatedEvent=null}return p(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(p0){}}}]),e}();function Iee(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),s="",u=Object.assign(Object.assign({},Cee),{width:r.toString(),height:i.toString(),top:a,left:o}),l=O4().toLowerCase();n&&(s=I8(l)?Ree:n),P8(l)&&(t=t||Pee,u.scrollbars="yes");var c=Object.entries(u).reduce((function(e,t){var n=T(t,2),r=n[0],i=n[1];return"".concat(e).concat(r,"=").concat(i,",")}),"");if(F8(l)&&"_self"!==s)return Lee(t||"",s),new Nee(null);var h=window.open(t||"",s,c);w6(h,e,"popup-blocked");try{h.focus()}catch(p0){}return new Nee(h)}function Lee(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}var Dee=encodeURIComponent("fac");function Oee(e,t,n,r,i,a){return Uee.apply(this,arguments)}function Uee(){return Uee=lt(ft().mark((function e(t,n,r,i,a,o){var s,u,l,c,h,f,d,p,A,v,m,g,y;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w6(t.config.authDomain,t,"auth-domain-config-required"),w6(t.config.apiKey,t,"invalid-api-key"),s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:i,v:G5,eventId:a},n instanceof O7)for(n.setDefaultLanguage(t.languageCode),s.providerId=n.providerId||"",j4(n.getCustomParameters())||(s.customParameters=JSON.stringify(n.getCustomParameters())),u=0,l=Object.entries(o||{});u<l.length;u++)c=T(l[u],2),h=c[0],f=c[1],s[h]=f;for(n instanceof U7&&(d=n.getScopes().filter((function(e){return""!==e}))).length>0&&(s.scopes=d.join(",")),t.tenantId&&(s.tid=t.tenantId),p=s,A=0,v=Object.keys(p);A<v.length;A++)m=v[A],void 0===p[m]&&delete p[m];return e.next=10,t._getAppCheckToken();case 10:return g=e.sent,y=g?"#".concat(Dee,"=").concat(encodeURIComponent(g)):"",e.abrupt("return","".concat(Bee(t),"?").concat(W4(p).slice(1)).concat(y));case 13:case"end":return e.stop()}}),e)}))),Uee.apply(this,arguments)}function Bee(e){var t=e.config;return t.emulator?P6(t,"emulator/auth/handler"):"https://".concat(t.authDomain,"/").concat("__/auth/handler")}var Fee="webStorageSupport",zee=function(){function e(){c(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=h9,this._completeRedirectFn=see,this._overrideRedirectResult=iee}return p(e,[{key:"_openPopup",value:function(){var e=lt(ft().mark((function e(t,n,r,i){var a,o;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S6(null===(a=this.eventManagers[t._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()"),e.next=3,Oee(t,n,r,E6(),i);case 3:return o=e.sent,e.abrupt("return",Iee(t,o,p9()));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_openRedirect",value:function(){var e=lt(ft().mark((function e(t,n,r,i){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._originValidation(t);case 2:return e.next=4,Oee(t,n,r,E6(),i);case 4:return m9(e.sent),e.abrupt("return",new Promise((function(){})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(S6(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch((function(){delete t.eventManagers[n]})),o}},{key:"initAndGetManager",value:function(){var e=lt(ft().mark((function e(t){var n,r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kee(t);case 2:return n=e.sent,r=new lee(t),n.register("authEvent",(function(e){return w6(null===e||void 0===e?void 0:e.authEvent,t,"invalid-auth-event"),{status:r.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:r},this.iframes[t._key()]=n,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(Fee,{type:Fee},(function(n){var r,i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[Fee];void 0!==i&&t(!!i),m6(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return vee.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return V8()||N8()||B8()}}]),e}(),Vee=zee,qee=function(){function e(t){c(this,e),this.factorId=t}return p(e,[{key:"_process",value:function(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return T6("unexpected MultiFactorSessionType")}}}]),e}(),jee=function(e){v(n,e);var t=b(n);function n(e){var r;return c(this,n),(r=t.call(this,"phone")).credential=e,r}return p(n,[{key:"_finalizeEnroll",value:function(e,t,n){return function(e,t){return U6(e,"POST","/v2/accounts/mfaEnrollment:finalize",O6(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},{key:"_finalizeSignIn",value:function(e,t){return function(e,t){return U6(e,"POST","/v2/accounts/mfaSignIn:finalize",O6(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}],[{key:"_fromCredential",value:function(e){return new n(e)}}]),n}(qee);(function(){function e(){c(this,e)}return p(e,null,[{key:"assertion",value:function(e){return jee._fromCredential(e)}}]),e}()).FACTOR_ID="phone";var Gee=function(){function e(){c(this,e)}return p(e,null,[{key:"assertionForEnrollment",value:function(e,t){return Hee._fromSecret(e,t)}},{key:"assertionForSignIn",value:function(e,t){return Hee._fromEnrollmentId(e,t)}},{key:"generateSecret",value:function(){var e=lt(ft().mark((function e(t){var n,r,i;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w6("undefined"!==typeof(null===(n=(r=t).user)||void 0===n?void 0:n.auth),"internal-error"),e.next=4,t9(r.user.auth,{idToken:r.credential,totpEnrollmentInfo:{}});case 4:return i=e.sent,e.abrupt("return",Wee._fromStartTotpMfaEnrollmentResponse(i,r.user.auth));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}();Gee.FACTOR_ID="totp";var Hee=function(e){v(n,e);var t=b(n);function n(e,r,i){var a;return c(this,n),(a=t.call(this,"totp")).otp=e,a.enrollmentId=r,a.secret=i,a}return p(n,[{key:"_finalizeEnroll",value:function(){var e=lt(ft().mark((function e(t,n,r){return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w6("undefined"!==typeof this.secret,t,"argument-error"),e.abrupt("return",n9(t,{idToken:n,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)}));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_finalizeSignIn",value:function(){var e=lt(ft().mark((function e(t,n){var r;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w6(void 0!==this.enrollmentId&&void 0!==this.otp,t,"argument-error"),r={verificationCode:this.otp},e.abrupt("return",U9(t,{mfaPendingCredential:n,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r}));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"_fromSecret",value:function(e,t){return new n(t,void 0,e)}},{key:"_fromEnrollmentId",value:function(e,t){return new n(t,e)}}]),n}(qee),Wee=function(){function e(t,n,r,i,a,o,s){c(this,e),this.sessionInfo=o,this.auth=s,this.secretKey=t,this.hashingAlgorithm=n,this.codeLength=r,this.codeIntervalSeconds=i,this.enrollmentCompletionDeadline=a}return p(e,[{key:"_makeTotpVerificationInfo",value:function(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}},{key:"generateQrCodeUrl",value:function(e,t){var n,r=!1;return(Xee(e)||Xee(t))&&(r=!0),r&&(Xee(e)&&(e=(null===(n=this.auth.currentUser)||void 0===n?void 0:n.email)||"unknownuser"),Xee(t)&&(t=this.auth.name)),"otpauth://totp/".concat(t,":").concat(e,"?secret=").concat(this.secretKey,"&issuer=").concat(t,"&algorithm=").concat(this.hashingAlgorithm,"&digits=").concat(this.codeLength)}}],[{key:"_fromStartTotpMfaEnrollmentResponse",value:function(t,n){return new e(t.totpSessionInfo.sharedSecretKey,t.totpSessionInfo.hashingAlgorithm,t.totpSessionInfo.verificationCodeLength,t.totpSessionInfo.periodSec,new Date(t.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),t.totpSessionInfo.sessionInfo,n)}}]),e}();function Xee(e){return"undefined"===typeof e||0===(null===e||void 0===e?void 0:e.length)}var Qee="@firebase/auth",Yee="1.10.0",Kee=function(){function e(t){c(this,e),this.auth=t,this.internalListeners=new Map}return p(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(){var e=lt(ft().mark((function e(t){var n;return ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertAuthConfigured(),e.next=3,this.auth._initializationPromise;case 3:if(this.auth.currentUser){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,this.auth.currentUser.getIdToken(t);case 7:return n=e.sent,e.abrupt("return",{accessToken:n});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged((function(t){e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){w6(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();var Zee,Jee=L4("authIdTokenMaxAge")||300,$ee=null,ete=function(e){return function(){var t=lt(ft().mark((function t(n){var r,i,a;return ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n,!t.t0){t.next=5;break}return t.next=4,n.getIdTokenResult();case 4:t.t0=t.sent;case 5:if(r=t.t0,!((i=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3)&&i>Jee)){t.next=9;break}return t.abrupt("return");case 9:if(a=null===r||void 0===r?void 0:r.token,$ee!==a){t.next=12;break}return t.abrupt("return");case 12:return $ee=a,t.next=15,fetch(e,{method:a?"POST":"DELETE",headers:a?{Authorization:"Bearer ".concat(a)}:{}});case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};!function(e){K8=e}({loadJS:function(e){return new Promise((function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=g6("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),Zee="Browser",B5(new J4("auth",(function(e,t){var n=t.options,r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),o=r.options,s=o.apiKey,u=o.authDomain;w6(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});var l={apiKey:s,authDomain:u,clientPlatform:Zee,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:q8(Zee)},c=new X8(r,i,a,l);return function(e,t){var n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(S8);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(e,t,n){e.getProvider("auth-internal").initialize()}))),B5(new J4("auth-internal",(function(e){return function(e){return new Kee(e)}(Q8(e.getProvider("auth").getImmediate()))}),"PRIVATE").setInstantiationMode("EXPLICIT")),X5(Qee,Yee,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Zee)),X5(Qee,Yee,"esm2017");var tte=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W5(),t=F5(e,"auth");if(t.isInitialized())return t.getImmediate();var n=c7(e,{popupRedirectResolver:Vee,persistence:[D9,o9,h9]}),r=L4("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){var i=new URL(r,location.origin);if(location.origin===i.origin){var a=ete(i.toString());$7(n,a,(function(){return a(n.currentUser)})),J7(n,(function(e){return a(e)}))}}var o=N4("auth");return o&&h7(n,"http://".concat(o)),n}(H5({apiKey:"YOUR_API_KEY",authDomain:"YOUR_PROJECT_ID.firebaseapp.com",projectId:"YOUR_PROJECT_ID",storageBucket:"YOUR_PROJECT_ID.appspot.com",messagingSenderId:"YOUR_SENDER_ID",appId:"YOUR_APP_ID"})),nte=new F7,rte=function(){var e=T((0,r.useState)({email:"",name:"",message:"",loading:!1,show:!1,alertmessage:"",variant:""}),2),t=e[0],n=e[1],i=T((0,r.useState)(null),2),a=i[0],o=i[1],s=function(e){n(Qe(Qe({},t),{},We({},e.target.name,e.target.value)))};return(0,Ye.jsxs)(d2,{children:[(0,Ye.jsxs)(Y2,{children:[(0,Ye.jsxs)(b2,{children:[(0,Ye.jsx)("meta",{charSet:"utf-8"}),(0,Ye.jsxs)("title",{children:[T2," | Contact"]}),(0,Ye.jsx)("meta",{name:"description",content:S2})]}),(0,Ye.jsx)(J2,{className:"mb-5 mt-3 pt-md-3",children:(0,Ye.jsxs)(n3,{lg:"8",children:[(0,Ye.jsx)("h1",{className:"display-4 mb-4",children:"Contact Me"}),(0,Ye.jsx)("hr",{className:"t_border my-4 ml-0 text-left"})]})}),(0,Ye.jsxs)(J2,{className:"sec_sp",children:[(0,Ye.jsx)(n3,{lg:"12",children:(0,Ye.jsx)(T4,{variant:t.variant,className:"rounded-0 co_alert ".concat(t.show?"d-block":"d-none"),onClose:function(){return n(Qe(Qe({},t),{},{show:!1}))},dismissible:!0,children:(0,Ye.jsx)("p",{className:"my-0",children:t.alertmessage})})}),(0,Ye.jsxs)(n3,{lg:"5",className:"mb-5",children:[(0,Ye.jsx)("h3",{className:"color_sec py-4",children:"Get in touch"}),(0,Ye.jsxs)("address",{children:[(0,Ye.jsx)("strong",{children:"Email:"})," ",(0,Ye.jsx)("a",{href:"mailto:".concat(D2.YOUR_EMAIL),children:D2.YOUR_EMAIL}),(0,Ye.jsx)("br",{}),(0,Ye.jsx)("br",{}),D2.hasOwnProperty("YOUR_FONE")?(0,Ye.jsxs)("p",{children:[(0,Ye.jsx)("strong",{children:"Phone:"})," ",D2.YOUR_FONE]}):""]}),(0,Ye.jsx)("p",{children:D2.description})]}),(0,Ye.jsxs)(n3,{lg:"7",className:"d-flex flex-column align-items-start",children:[(0,Ye.jsx)("button",{onClick:function(){(function(e,t,n){return J9.apply(this,arguments)})(tte,nte).then((function(e){var t=e.user.email;t.endsWith("@gmail.com")?(o(t),alert("Signed in as: ".concat(t))):alert("Only Gmail users are allowed.")})).catch((function(e){console.error(e)}))},className:"btn btn-primary mb-3",children:a?"Signed in as: ".concat(a):"Sign in with Google to Contact"}),(0,Ye.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),a){n(Qe(Qe({},t),{},{loading:!0}));var r={from_name:t.email,user_name:t.name,to_name:D2.YOUR_EMAIL,message:t.message};u3(D2.YOUR_SERVICE_ID,D2.YOUR_TEMPLATE_ID,r,D2.YOUR_USER_ID).then((function(e){console.log(e.text),n(Qe(Qe({},t),{},{loading:!1,alertmessage:"SUCCESS! Thank you for your message",variant:"success",show:!0}))}),(function(e){console.log(e.text),n(Qe(Qe({},t),{},{loading:!1,alertmessage:"Failed to send message. Try again later.",variant:"danger",show:!0})),document.getElementsByClassName("co_alert")[0].scrollIntoView()}))}else alert("Please sign in with Google before sending a message.")},className:"contact__form w-100",children:[(0,Ye.jsxs)(J2,{children:[(0,Ye.jsx)(n3,{lg:"6",className:"form-group",children:(0,Ye.jsx)("input",{className:"form-control",id:"name",name:"name",placeholder:"Name",value:t.name||"",type:"text",required:!0,onChange:s,disabled:!a})}),(0,Ye.jsx)(n3,{lg:"6",className:"form-group",children:(0,Ye.jsx)("input",{className:"form-control rounded-0",id:"email",name:"email",placeholder:"Email",type:"email",value:t.email||"",required:!0,onChange:s,disabled:!a})})]}),(0,Ye.jsx)("textarea",{className:"form-control rounded-0",id:"message",name:"message",placeholder:"Message",rows:"5",value:t.message,onChange:s,required:!0,disabled:!a}),(0,Ye.jsx)("br",{}),(0,Ye.jsx)(J2,{children:(0,Ye.jsx)(n3,{lg:"12",className:"form-group",children:(0,Ye.jsx)("button",{className:"btn ac_btn",type:"submit",disabled:!a,children:t.loading?"Sending...":"Send"})})})]})]})]})]}),(0,Ye.jsx)("div",{className:t.loading?"loading-bar":"d-none"})]})},ite=function(){return(0,Ye.jsx)(d2,{children:(0,Ye.jsxs)(Y2,{className:"About-header",children:[(0,Ye.jsxs)(b2,{children:[(0,Ye.jsx)("meta",{charSet:"utf-8"}),(0,Ye.jsxs)("title",{children:[" About | ",T2]}),(0,Ye.jsx)("meta",{name:"description",content:S2})]}),(0,Ye.jsx)(J2,{className:"mb-5 mt-3 pt-md-3",children:(0,Ye.jsxs)(n3,{lg:"8",children:[(0,Ye.jsx)("h1",{className:"display-4 mb-4",children:"About me"}),(0,Ye.jsx)("hr",{className:"t_border my-4 ml-0 text-left"})]})}),(0,Ye.jsxs)(J2,{className:"sec_sp",children:[(0,Ye.jsx)(n3,{lg:"5",children:(0,Ye.jsx)("h3",{className:"color_sec py-4",children:C2})}),(0,Ye.jsx)(n3,{lg:"7",className:"d-flex align-items-center",children:(0,Ye.jsx)("div",{children:(0,Ye.jsx)("p",{children:R2})})})]}),(0,Ye.jsxs)(J2,{className:" sec_sp",children:[(0,Ye.jsx)(n3,{lg:"5",children:(0,Ye.jsx)("h3",{className:"color_sec py-4",children:"Work Timeline"})}),(0,Ye.jsx)(n3,{lg:"7",children:(0,Ye.jsx)("table",{className:"table caption-top",children:(0,Ye.jsx)("tbody",{children:P2.map((function(e,t){return(0,Ye.jsxs)("tr",{children:[(0,Ye.jsx)("th",{scope:"row",children:e.jobtitle}),(0,Ye.jsx)("td",{children:e.where}),(0,Ye.jsx)("td",{children:e.date})]},t)}))})})})]}),(0,Ye.jsxs)(J2,{className:"sec_sp",children:[(0,Ye.jsx)(n3,{lg:"5",children:(0,Ye.jsx)("h3",{className:"color_sec py-4",children:"Skills"})}),(0,Ye.jsx)(n3,{lg:"7",children:N2.map((function(e,t){return(0,Ye.jsxs)("div",{children:[(0,Ye.jsx)("h3",{className:"progress-title",children:e.name}),(0,Ye.jsx)("div",{className:"progress",children:(0,Ye.jsx)("div",{className:"progress-bar",style:{width:"".concat(e.value,"%")},children:(0,Ye.jsxs)("div",{className:"progress-value",children:[e.value,"%"]})})})]},t)}))})]}),(0,Ye.jsxs)(J2,{className:"sec_sp",children:[(0,Ye.jsx)(n3,{lang:"5",children:(0,Ye.jsx)("h3",{className:"color_sec py-4",children:"Services"})}),(0,Ye.jsx)(n3,{lg:"7",children:I2.map((function(e,t){return(0,Ye.jsxs)("div",{className:"service_ py-4",children:[(0,Ye.jsx)("h5",{className:"service__title",children:e.title}),(0,Ye.jsx)("p",{className:"service_desc",children:e.description})]},t)}))})]})]})})},ate={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ote=r.createContext&&r.createContext(ate),ste=function(){return ste=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ste.apply(this,arguments)},ute=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function lte(e){return e&&e.map((function(e,t){return r.createElement(e.tag,ste({key:t},e.attr),lte(e.child))}))}function cte(e){return function(t){return r.createElement(hte,ste({attr:ste({},e.attr)},t),lte(e.child))}}function hte(e){var t=function(t){var n,i=e.attr,a=e.size,o=e.title,s=ute(e,["attr","size","title"]),u=a||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),r.createElement("svg",ste({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,i,s,{className:n,style:ste(ste({color:e.color||t.color},t.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),o&&r.createElement("title",null,o),e.children)};return void 0!==ote?r.createElement(ote.Consumer,null,(function(e){return t(e)})):t(ate)}var fte={default:function(e){return cte({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8z"}}]})(e)},facebook:function(e){return cte({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"}}]})(e)},github:function(e){return cte({tag:"svg",attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"}}]})(e)},instagram:function(e){return cte({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"}}]})(e)},linkedin:function(e){return cte({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"}}]})(e)},snapchat:function(e){return cte({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M510.846 392.673c-5.211 12.157-27.239 21.089-67.36 27.318-2.064 2.786-3.775 14.686-6.507 23.956-1.625 5.566-5.623 8.869-12.128 8.869l-.297-.005c-9.395 0-19.203-4.323-38.852-4.323-26.521 0-35.662 6.043-56.254 20.588-21.832 15.438-42.771 28.764-74.027 27.399-31.646 2.334-58.025-16.908-72.871-27.404-20.714-14.643-29.828-20.582-56.241-20.582-18.864 0-30.736 4.72-38.852 4.72-8.073 0-11.213-4.922-12.422-9.04-2.703-9.189-4.404-21.263-6.523-24.13-20.679-3.209-67.31-11.344-68.498-32.15a10.627 10.627 0 0 1 8.877-11.069c69.583-11.455 100.924-82.901 102.227-85.934.074-.176.155-.344.237-.515 3.713-7.537 4.544-13.849 2.463-18.753-5.05-11.896-26.872-16.164-36.053-19.796-23.715-9.366-27.015-20.128-25.612-27.504 2.437-12.836 21.725-20.735 33.002-15.453 8.919 4.181 16.843 6.297 23.547 6.297 5.022 0 8.212-1.204 9.96-2.171-2.043-35.936-7.101-87.29 5.687-115.969C158.122 21.304 229.705 15.42 250.826 15.42c.944 0 9.141-.089 10.11-.089 52.148 0 102.254 26.78 126.723 81.643 12.777 28.65 7.749 79.792 5.695 116.009 1.582.872 4.357 1.942 8.599 2.139 6.397-.286 13.815-2.389 22.069-6.257 6.085-2.846 14.406-2.461 20.48.058l.029.01c9.476 3.385 15.439 10.215 15.589 17.87.184 9.747-8.522 18.165-25.878 25.018-2.118.835-4.694 1.655-7.434 2.525-9.797 3.106-24.6 7.805-28.616 17.271-2.079 4.904-1.256 11.211 2.46 18.748.087.168.166.342.239.515 1.301 3.03 32.615 74.46 102.23 85.934 6.427 1.058 11.163 7.877 7.725 15.859z"}}]})(e)},tiktok:function(e){return cte({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448,209.91a210.06,210.06,0,0,1-122.77-39.25V349.38A162.55,162.55,0,1,1,185,188.31V278.2a74.62,74.62,0,1,0,52.23,71.18V0l88,0a121.18,121.18,0,0,0,1.86,22.17h0A122.18,122.18,0,0,0,381,102.39a121.43,121.43,0,0,0,67,20.14Z"}}]})(e)},twitter:function(e){return cte({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"}}]})(e)},twitch:function(e){return cte({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M391.17,103.47H352.54v109.7h38.63ZM285,103H246.37V212.75H285ZM120.83,0,24.31,91.42V420.58H140.14V512l96.53-91.42h77.25L487.69,256V0ZM449.07,237.75l-77.22,73.12H294.61l-67.6,64v-64H140.14V36.58H449.07Z"}}]})(e)},youtube:function(e){return cte({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"}}]})(e)}},dte=function(e){return(0,Ye.jsxs)("div",{className:"stick_follow_icon",children:[(0,Ye.jsx)("ul",{children:Object.entries(O2).map((function(e){var t=T(e,2),n=t[0],r=t[1],i=fte[n]||fte.default;return(0,Ye.jsx)("li",{children:(0,Ye.jsx)("a",{href:r,children:(0,Ye.jsx)(i,{})})},n)}))}),(0,Ye.jsx)("p",{children:"Follow Me"})]})};function pte(e,t){var n=Object.create(null);return e&&r.Children.map(e,(function(e){return e})).forEach((function(e){n[e.key]=function(e){return t&&(0,r.isValidElement)(e)?t(e):e}(e)})),n}function Ate(e,t,n){return null!=n[t]?n[t]:e.props[t]}function vte(e,t,n){var i=pte(e.children),a=function(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var r,i=Object.create(null),a=[];for(var o in e)o in t?a.length&&(i[o]=a,a=[]):a.push(o);var s={};for(var u in t){if(i[u])for(r=0;r<i[u].length;r++){var l=i[u][r];s[i[u][r]]=n(l)}s[u]=n(u)}for(r=0;r<a.length;r++)s[a[r]]=n(a[r]);return s}(t,i);return Object.keys(a).forEach((function(o){var s=a[o];if((0,r.isValidElement)(s)){var u=o in t,l=o in i,c=t[o],h=(0,r.isValidElement)(c)&&!c.props.in;!l||u&&!h?l||!u||h?l&&u&&(0,r.isValidElement)(c)&&(a[o]=(0,r.cloneElement)(s,{onExited:n.bind(null,s),in:c.props.in,exit:Ate(s,"exit",e),enter:Ate(s,"enter",e)})):a[o]=(0,r.cloneElement)(s,{in:!1}):a[o]=(0,r.cloneElement)(s,{onExited:n.bind(null,s),in:!0,exit:Ate(s,"exit",e),enter:Ate(s,"enter",e)})}})),a}var mte=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},gte=function(e){function t(t,n){var r,i=(r=e.call(this,t,n)||this).handleExited.bind(y(r));return r.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},r}uJ(t,e);var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var n,i,a=t.children,o=t.handleExited;return{children:t.firstRender?(n=e,i=o,pte(n.children,(function(e){return(0,r.cloneElement)(e,{onExited:i.bind(null,e),in:!0,appear:Ate(e,"appear",n),enter:Ate(e,"enter",n),exit:Ate(e,"exit",n)})}))):vte(e,a,o),firstRender:!1}},n.handleExited=function(e,t){var n=pte(this.props.children);e.key in n||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var n=sJ({},t.children);return delete n[e.key],{children:n}})))},n.render=function(){var e=this.props,t=e.component,n=e.childFactory,i=B2(e,["component","childFactory"]),a=this.state.contextValue,o=mte(this.state.children).map(n);return delete i.appear,delete i.enter,delete i.exit,null===t?r.createElement(E3.Provider,{value:a},o):r.createElement(E3.Provider,{value:a},r.createElement(t,i,o))},t}(r.Component);gte.propTypes={},gte.defaultProps={component:"div",childFactory:function(e){return e}};var yte=gte;function _te(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}var bte=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return function(e,t){e.classList?e.classList.remove(t):"string"===typeof e.className?e.className=_te(e.className,t):e.setAttribute("class",_te(e.className&&e.className.baseVal||"",t))}(e,t)}))},xte=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,n){var r=t.resolveArguments(e,n),i=r[0],a=r[1];t.removeClasses(i,"exit"),t.addClass(i,a?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,n)},t.onEntering=function(e,n){var r=t.resolveArguments(e,n),i=r[0],a=r[1]?"appear":"enter";t.addClass(i,a,"active"),t.props.onEntering&&t.props.onEntering(e,n)},t.onEntered=function(e,n){var r=t.resolveArguments(e,n),i=r[0],a=r[1]?"appear":"enter";t.removeClasses(i,a),t.addClass(i,a,"done"),t.props.onEntered&&t.props.onEntered(e,n)},t.onExit=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"appear"),t.removeClasses(n,"enter"),t.addClass(n,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var n=t.resolveArguments(e)[0];t.addClass(n,"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"exit"),t.addClass(n,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.resolveArguments=function(e,n){return t.props.nodeRef?[t.props.nodeRef.current,e]:[e,n]},t.getClassNames=function(e){var n=t.props.classNames,r="string"===typeof n,i=r?""+(r&&n?n+"-":"")+e:n[e];return{baseClassName:i,activeClassName:r?i+"-active":n[e+"Active"],doneClassName:r?i+"-done":n[e+"Done"]}},t}uJ(t,e);var n=t.prototype;return n.addClass=function(e,t,n){var r=this.getClassNames(t)[n+"ClassName"],i=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===n&&i&&(r+=" "+i),"active"===n&&e&&k3(e),r&&(this.appliedClasses[t][n]=r,function(e,t){e&&t&&t.split(" ").forEach((function(t){return function(e,t){e.classList?e.classList.add(t):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(e,t)||("string"===typeof e.className?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}(e,t)}))}(e,r))},n.removeClasses=function(e,t){var n=this.appliedClasses[t],r=n.base,i=n.active,a=n.done;this.appliedClasses[t]={},r&&bte(e,r),i&&bte(e,i),a&&bte(e,a)},n.render=function(){var e=this.props,t=(e.classNames,B2(e,["classNames"]));return r.createElement(D3,sJ({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(r.Component);xte.defaultProps={classNames:""},xte.propTypes={};var wte=xte,Tte=Ke((function(e){var t=e.location;return(0,Ye.jsx)(yte,{children:(0,Ye.jsx)(wte,{timeout:{enter:400,exit:400},classNames:"page",unmountOnExit:!0,children:(0,Ye.jsxs)(Oe,{location:t,children:[(0,Ye.jsx)(Le,{exact:!0,path:"/",element:(0,Ye.jsx)(U2,{})}),(0,Ye.jsx)(Le,{path:"/about",element:(0,Ye.jsx)(ite,{})}),(0,Ye.jsx)(Le,{path:"/portfolio",element:(0,Ye.jsx)(r3,{})}),(0,Ye.jsx)(Le,{path:"/contact",element:(0,Ye.jsx)(rte,{})}),(0,Ye.jsx)(Le,{path:"*",element:(0,Ye.jsx)(U2,{})})]})},t.key)})}));var Ste=function(){return(0,Ye.jsxs)("div",{className:"s_c",children:[(0,Ye.jsx)(Tte,{}),(0,Ye.jsx)(dte,{})]})};function Ete(e){return cte({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M8 8.707l3.646 3.647.708-.707L8.707 8l3.647-3.646-.707-.708L8 7.293 4.354 3.646l-.707.708L7.293 8l-3.646 3.646.707.708L8 8.707z"}}]})(e)}function kte(e){return cte({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M15 6H1v1h14V6zm0 3H1v1h14V9z"}}]})(e)}function Mte(e){return cte({tag:"svg",attr:{version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 30 30",style:"enable-background:new 0 0 30 30;"},child:[{tag:"path",attr:{d:"M4.37,14.62c0-0.24,0.08-0.45,0.25-0.62c0.17-0.16,0.38-0.24,0.6-0.24h2.04c0.23,0,0.42,0.08,0.58,0.25\n\tc0.15,0.17,0.23,0.37,0.23,0.61S8,15.06,7.85,15.23c-0.15,0.17-0.35,0.25-0.58,0.25H5.23c-0.23,0-0.43-0.08-0.6-0.25\n\tC4.46,15.06,4.37,14.86,4.37,14.62z M7.23,21.55c0-0.23,0.08-0.43,0.23-0.61l1.47-1.43c0.15-0.16,0.35-0.23,0.59-0.23\n\tc0.24,0,0.44,0.08,0.6,0.23s0.24,0.34,0.24,0.57c0,0.24-0.08,0.46-0.24,0.64L8.7,22.14c-0.41,0.32-0.82,0.32-1.23,0\n\tC7.31,21.98,7.23,21.78,7.23,21.55z M7.23,7.71c0-0.23,0.08-0.43,0.23-0.61C7.66,6.93,7.87,6.85,8.1,6.85\n\tc0.22,0,0.42,0.08,0.59,0.24l1.43,1.47c0.16,0.15,0.24,0.35,0.24,0.59c0,0.24-0.08,0.44-0.24,0.6s-0.36,0.24-0.6,0.24\n\tc-0.24,0-0.44-0.08-0.59-0.24L7.47,8.32C7.31,8.16,7.23,7.95,7.23,7.71z M9.78,14.62c0-0.93,0.23-1.8,0.7-2.6s1.1-1.44,1.91-1.91\n\ts1.67-0.7,2.6-0.7c0.7,0,1.37,0.14,2.02,0.42c0.64,0.28,1.2,0.65,1.66,1.12c0.47,0.47,0.84,1.02,1.11,1.66\n\tc0.27,0.64,0.41,1.32,0.41,2.02c0,0.94-0.23,1.81-0.7,2.61c-0.47,0.8-1.1,1.43-1.9,1.9c-0.8,0.47-1.67,0.7-2.61,0.7\n\ts-1.81-0.23-2.61-0.7c-0.8-0.47-1.43-1.1-1.9-1.9C10.02,16.43,9.78,15.56,9.78,14.62z M11.48,14.62c0,0.98,0.34,1.81,1.03,2.5\n\tc0.68,0.69,1.51,1.04,2.49,1.04s1.81-0.35,2.5-1.04s1.04-1.52,1.04-2.5c0-0.96-0.35-1.78-1.04-2.47c-0.69-0.68-1.52-1.02-2.5-1.02\n\tc-0.97,0-1.8,0.34-2.48,1.02C11.82,12.84,11.48,13.66,11.48,14.62z M14.14,22.4c0-0.24,0.08-0.44,0.25-0.6s0.37-0.24,0.6-0.24\n\tc0.24,0,0.45,0.08,0.61,0.24s0.24,0.36,0.24,0.6v1.99c0,0.24-0.08,0.45-0.25,0.62c-0.17,0.17-0.37,0.25-0.6,0.25\n\ts-0.44-0.08-0.6-0.25c-0.17-0.17-0.25-0.38-0.25-0.62V22.4z M14.14,6.9V4.86c0-0.23,0.08-0.43,0.25-0.6C14.56,4.09,14.76,4,15,4\n\ts0.43,0.08,0.6,0.25c0.17,0.17,0.25,0.37,0.25,0.6V6.9c0,0.23-0.08,0.42-0.25,0.58S15.23,7.71,15,7.71s-0.44-0.08-0.6-0.23\n\tS14.14,7.13,14.14,6.9z M19.66,20.08c0-0.23,0.08-0.42,0.23-0.56c0.15-0.16,0.34-0.23,0.56-0.23c0.24,0,0.44,0.08,0.6,0.23\n\tl1.46,1.43c0.16,0.17,0.24,0.38,0.24,0.61c0,0.23-0.08,0.43-0.24,0.59c-0.4,0.31-0.8,0.31-1.2,0l-1.42-1.42\n\tC19.74,20.55,19.66,20.34,19.66,20.08z M19.66,9.16c0-0.25,0.08-0.45,0.23-0.59l1.42-1.47c0.17-0.16,0.37-0.24,0.59-0.24\n\tc0.24,0,0.44,0.08,0.6,0.25c0.17,0.17,0.25,0.37,0.25,0.6c0,0.25-0.08,0.46-0.24,0.62l-1.46,1.43c-0.18,0.16-0.38,0.24-0.6,0.24\n\tc-0.23,0-0.41-0.08-0.56-0.24S19.66,9.4,19.66,9.16z M21.92,14.62c0-0.24,0.08-0.44,0.24-0.62c0.16-0.16,0.35-0.24,0.57-0.24h2.02\n\tc0.23,0,0.43,0.09,0.6,0.26c0.17,0.17,0.26,0.37,0.26,0.6s-0.09,0.43-0.26,0.6c-0.17,0.17-0.37,0.25-0.6,0.25h-2.02\n\tc-0.23,0-0.43-0.08-0.58-0.25S21.92,14.86,21.92,14.62z"}}]})(e)}function Cte(e){return cte({tag:"svg",attr:{version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 30 30",style:"enable-background:new 0 0 30 30;"},child:[{tag:"path",attr:{d:"M3.74,14.44c0-1.52,0.3-2.98,0.89-4.37s1.4-2.58,2.4-3.59s2.2-1.81,3.59-2.4s2.84-0.89,4.37-0.89s2.98,0.3,4.37,0.89\n\ts2.59,1.4,3.6,2.4s1.81,2.2,2.4,3.59s0.89,2.84,0.89,4.37s-0.3,2.98-0.89,4.37s-1.4,2.59-2.4,3.6s-2.2,1.81-3.6,2.4\n\ts-2.85,0.89-4.37,0.89s-2.98-0.3-4.37-0.89s-2.58-1.4-3.59-2.4s-1.81-2.2-2.4-3.6S3.74,15.97,3.74,14.44z M4.94,14.44\n\tc0,1.33,0.25,2.6,0.75,3.81s1.18,2.26,2.03,3.15s1.87,1.61,3.05,2.17s2.43,0.87,3.74,0.94c-1.24-1.19-2.11-2.63-2.61-4.31\n\ts-0.75-3.6-0.75-5.76c0-1.93,0.31-3.78,0.92-5.54s1.47-3.26,2.56-4.5c-1.77,0.07-3.39,0.56-4.88,1.47S7.09,8,6.23,9.51\n\tS4.94,12.68,4.94,14.44z"}}]})(e)}var Rte=function(){var e=T((0,r.useState)(localStorage.getItem("theme")||"dark"),2),t=e[0],n=e[1];return(0,r.useEffect)((function(){document.documentElement.setAttribute("data-theme",t)}),[t]),(0,Ye.jsx)("div",{className:"nav_ac",onClick:function(){var e="dark"===t?"light":"dark";n(e),localStorage.setItem("theme",e),document.documentElement.setAttribute("data-theme",e)},children:"dark"===t?(0,Ye.jsx)(Cte,{size:28}):(0,Ye.jsx)(Mte,{size:28})})},Pte=function(){var e=T((0,r.useState)("false"),2),t=e[0],n=e[1],i=function(){n(!t),document.body.classList.toggle("ovhidden")};return(0,Ye.jsxs)(Ye.Fragment,{children:[(0,Ye.jsxs)("header",{className:"fixed-top site__header",children:[(0,Ye.jsxs)("div",{className:"d-flex align-items-center justify-content-between",children:[(0,Ye.jsx)(je,{className:"navbar-brand nav_ac",to:"/",children:"Ved"}),(0,Ye.jsxs)("div",{className:"d-flex align-items-center",children:[(0,Ye.jsx)(Rte,{}),(0,Ye.jsx)("button",{className:"menu__button  nav_ac",onClick:i,children:t?(0,Ye.jsx)(kte,{}):(0,Ye.jsx)(Ete,{})})]})]}),(0,Ye.jsxs)("div",{className:"site__navigation ".concat(t?"":"menu__opend"),children:[(0,Ye.jsx)("div",{className:"bg__menu h-100",children:(0,Ye.jsx)("div",{className:"menu__wrapper",children:(0,Ye.jsx)("div",{className:"menu__container p-3",children:(0,Ye.jsxs)("ul",{className:"the_menu",children:[(0,Ye.jsx)("li",{className:"menu_item ",children:(0,Ye.jsx)(je,{onClick:i,to:"/",className:"my-3",children:"Home"})}),(0,Ye.jsx)("li",{className:"menu_item",children:(0,Ye.jsx)(je,{onClick:i,to:"/portfolio",className:"my-3",children:" Portfolio"})}),(0,Ye.jsx)("li",{className:"menu_item",children:(0,Ye.jsx)(je,{onClick:i,to:"/about",className:"my-3",children:"About"})}),(0,Ye.jsx)("li",{className:"menu_item",children:(0,Ye.jsx)(je,{onClick:i,to:"/contact",className:"my-3",children:" Contact"})})]})})})}),(0,Ye.jsxs)("div",{className:"menu_footer d-flex flex-column flex-md-row justify-content-between align-items-md-center position-absolute w-100 p-3",children:[(0,Ye.jsxs)("div",{className:"d-flex",children:[(0,Ye.jsx)("a",{href:O2.instagram,children:"Instagram"}),(0,Ye.jsx)("a",{href:O2.github,children:"Github"}),(0,Ye.jsx)("a",{href:O2.linkedin,children:"Linkedin"})]}),(0,Ye.jsxs)("p",{className:"copyright m-0",children:["copyright __ ","Ved"]})]})]})]}),(0,Ye.jsx)("div",{className:"br-top"}),(0,Ye.jsx)("div",{className:"br-bottom"}),(0,Ye.jsx)("div",{className:"br-left"}),(0,Ye.jsx)("div",{className:"br-right"})]})},Nte=function(){if("undefined"!=typeof navigator){var e=navigator.userAgent;return{info:e,Android:function(){return e.match(/Android/i)},BlackBerry:function(){return e.match(/BlackBerry/i)},IEMobile:function(){return e.match(/IEMobile/i)},iOS:function(){return e.match(/iPhone|iPad|iPod/i)},iPad:function(){return e.match(/Mac/)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2},OperaMini:function(){return e.match(/Opera Mini/i)},any:function(){return Nte.Android()||Nte.BlackBerry()||Nte.iOS()||Nte.iPad()||Nte.OperaMini()||Nte.IEMobile()}}}}();function Ite(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document,i=(0,r.useRef)();(0,r.useEffect)((function(){i.current=t}),[t]),(0,r.useEffect)((function(){if(n&&n.addEventListener){var t=function(e){return i.current(e)};return n.addEventListener(e,t),function(){n.removeEventListener(e,t)}}}),[e,n])}function Lte(e){var t=e.outerStyle,n=e.innerStyle,i=e.color,a=void 0===i?"220, 90, 90":i,o=e.outerAlpha,s=void 0===o?.3:o,u=e.innerSize,l=void 0===u?8:u,c=e.outerSize,h=void 0===c?8:c,f=e.outerScale,d=void 0===f?6:f,p=e.innerScale,A=void 0===p?.6:p,v=e.trailingSpeed,m=void 0===v?8:v,g=e.clickables,y=void 0===g?["a",'input[type="text"]','input[type="email"]','input[type="number"]','input[type="submit"]','input[type="image"]',"label[for]","select","textarea","button",".link"]:g,_=(0,r.useRef)(),b=(0,r.useRef)(),x=(0,r.useRef)(),w=(0,r.useRef)(),S=T((0,r.useState)({x:0,y:0}),2),E=S[0],k=S[1],M=T((0,r.useState)(!1),2),C=M[0],R=M[1],P=T((0,r.useState)(!1),2),N=P[0],I=P[1],L=T((0,r.useState)(!1),2),D=L[0],O=L[1],U=(0,r.useRef)(0),B=(0,r.useRef)(0),F=(0,r.useCallback)((function(e){var t=e.clientX,n=e.clientY;k({x:t,y:n}),b.current.style.top="".concat(n,"px"),b.current.style.left="".concat(t,"px"),U.current=t,B.current=n}),[]),z=(0,r.useCallback)((function(e){void 0!==w.current&&(E.x+=(U.current-E.x)/m,E.y+=(B.current-E.y)/m,_.current.style.top="".concat(E.y,"px"),_.current.style.left="".concat(E.x,"px")),w.current=e,x.current=requestAnimationFrame(z)}),[x]);(0,r.useEffect)((function(){return x.current=requestAnimationFrame(z),function(){return cancelAnimationFrame(x.current)}}),[z]);var V=(0,r.useCallback)((function(){return I(!0)}),[]),q=(0,r.useCallback)((function(){return I(!1)}),[]),j=(0,r.useCallback)((function(){return R(!0)}),[]),G=(0,r.useCallback)((function(){return R(!1)}),[]);Ite("mousemove",F),Ite("mousedown",V),Ite("mouseup",q),Ite("mouseover",j),Ite("mouseout",G),(0,r.useEffect)((function(){N?(b.current.style.transform="translate(-50%, -50%) scale(".concat(A,")"),_.current.style.transform="translate(-50%, -50%) scale(".concat(d,")")):(b.current.style.transform="translate(-50%, -50%) scale(1)",_.current.style.transform="translate(-50%, -50%) scale(1)")}),[A,d,N]),(0,r.useEffect)((function(){D&&(b.current.style.transform="translate(-50%, -50%) scale(".concat(1.2*A,")"),_.current.style.transform="translate(-50%, -50%) scale(".concat(1.4*d,")"))}),[A,d,D]),(0,r.useEffect)((function(){C?(b.current.style.opacity=1,_.current.style.opacity=1):(b.current.style.opacity=0,_.current.style.opacity=0)}),[C]),(0,r.useEffect)((function(){var e=document.querySelectorAll(y.join(","));return e.forEach((function(e){e.style.cursor="none",e.addEventListener("mouseover",(function(){I(!0)})),e.addEventListener("click",(function(){I(!0),O(!1)})),e.addEventListener("mousedown",(function(){O(!0)})),e.addEventListener("mouseup",(function(){I(!0)})),e.addEventListener("mouseout",(function(){I(!1),O(!1)}))})),function(){e.forEach((function(e){e.removeEventListener("mouseover",(function(){I(!0)})),e.removeEventListener("click",(function(){I(!0),O(!1)})),e.removeEventListener("mousedown",(function(){O(!0)})),e.removeEventListener("mouseup",(function(){I(!0)})),e.removeEventListener("mouseout",(function(){I(!1),O(!1)}))}))}}),[N,y]);var H={cursorInner:Qe(Qe({zIndex:999,display:"block",position:"fixed",borderRadius:"50%",width:l,height:l,pointerEvents:"none",backgroundColor:"rgba(".concat(a,", 1)")},n&&n),{},{transition:"opacity 0.15s ease-in-out, transform 0.25s ease-in-out"}),cursorOuter:Qe({zIndex:999,display:"block",position:"fixed",borderRadius:"50%",pointerEvents:"none",width:h,height:h,backgroundColor:"rgba(".concat(a,", ").concat(s,")"),transition:"opacity 0.15s ease-in-out, transform 0.15s ease-in-out",willChange:"transform"},t&&t)};return document.body.style.cursor="none",(0,Ye.jsxs)(r.Fragment,{children:[(0,Ye.jsx)("div",{ref:_,style:H.cursorOuter}),(0,Ye.jsx)("div",{ref:b,style:H.cursorInner})]})}var Dte=function(e){var t=e.outerStyle,n=e.innerStyle,i=e.color,a=e.outerAlpha,o=e.innerSize,s=e.innerScale,u=e.outerSize,l=e.outerScale,c=e.trailingSpeed,h=e.clickables;return"undefined"!==typeof navigator&&Nte.any()?(0,Ye.jsx)(r.Fragment,{}):(0,Ye.jsx)(Lte,{outerStyle:t,innerStyle:n,color:i,outerAlpha:a,innerSize:o,innerScale:s,outerSize:u,outerScale:l,trailingSpeed:c,clickables:h})};var Ote=Ke((function(e){var t=xe().pathname;return(0,r.useEffect)((function(){window.scrollTo(0,0)}),[t]),e.children}));function Ute(){return(0,Ye.jsxs)(qe,{basename:"/",children:[(0,Ye.jsx)("div",{className:"cursor__dot",children:(0,Ye.jsx)(Dte,{innerSize:15,outerSize:15,color:"255, 255 ,255",outerAlpha:.4,innerScale:.7,outerScale:5})}),(0,Ye.jsxs)(Ote,{children:[(0,Ye.jsx)(Pte,{}),(0,Ye.jsx)(Ste,{})]})]})}a.createRoot(document.getElementById("root")).render((0,Ye.jsx)(Ute,{}))}()}();